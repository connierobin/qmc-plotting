Rank =    0  Free Memory = 88342 MB
Rank =    1  Free Memory = 88342 MB
Rank =    2  Free Memory = 88342 MB
Rank =    3  Free Memory = 88342 MB
Rank =    4  Free Memory = 88342 MB
Rank =    5  Free Memory = 88342 MB
Rank =    6  Free Memory = 88342 MB
Rank =    7  Free Memory = 88342 MB
Rank =    8  Free Memory = 88342 MB
Rank =    9  Free Memory = 88342 MB
Rank =   10  Free Memory = 88341 MB
Rank =   11  Free Memory = 88341 MB
Rank =   12  Free Memory = 88341 MB
Rank =   13  Free Memory = 88341 MB
Rank =   14  Free Memory = 88341 MB
Rank =   15  Free Memory = 88325 MB
Rank =   16  Free Memory = 88325 MB
Rank =   17  Free Memory = 88325 MB
Rank =   18  Free Memory = 88325 MB
Rank =   19  Free Memory = 88324 MB
Rank =   20  Free Memory = 88324 MB
Rank =   21  Free Memory = 88324 MB
Rank =   22  Free Memory = 88324 MB
Rank =   23  Free Memory = 88324 MB
Rank =   24  Free Memory = 88324 MB
Rank =   25  Free Memory = 88324 MB
Rank =   26  Free Memory = 88324 MB
Rank =   27  Free Memory = 88324 MB
Rank =   28  Free Memory = 88324 MB
Rank =   29  Free Memory = 88324 MB
Rank =   30  Free Memory = 88324 MB
Rank =   31  Free Memory = 88324 MB
Rank =   32  Free Memory = 88338 MB
Rank =   33  Free Memory = 88338 MB
Rank =   34  Free Memory = 88338 MB
Rank =   35  Free Memory = 88338 MB
Rank =   36  Free Memory = 88338 MB
Rank =   37  Free Memory = 88338 MB
Rank =   38  Free Memory = 88338 MB
Rank =   39  Free Memory = 88338 MB
Rank =   40  Free Memory = 88338 MB
Rank =   41  Free Memory = 88338 MB
Rank =   42  Free Memory = 88338 MB
Rank =   43  Free Memory = 88338 MB
Rank =   44  Free Memory = 88338 MB
Rank =   45  Free Memory = 88338 MB
Rank =   46  Free Memory = 88338 MB
Rank =   47  Free Memory = 88338 MB
Rank =   48  Free Memory = 88338 MB
Rank =   49  Free Memory = 88338 MB
Rank =   50  Free Memory = 88338 MB
Rank =   51  Free Memory = 88338 MB
Rank =   52  Free Memory = 88338 MB
Rank =   53  Free Memory = 88338 MB
Rank =   54  Free Memory = 88338 MB
Rank =   55  Free Memory = 88338 MB
Rank =   56  Free Memory = 88338 MB
Rank =   57  Free Memory = 88337 MB
Rank =   58  Free Memory = 88337 MB
Rank =   59  Free Memory = 88337 MB
Rank =   60  Free Memory = 88337 MB
Rank =   61  Free Memory = 88337 MB
Rank =   62  Free Memory = 88337 MB
Rank =   63  Free Memory = 88337 MB
Rank =   64  Free Memory = 88341 MB
Rank =   65  Free Memory = 88341 MB
Rank =   66  Free Memory = 88341 MB
Rank =   67  Free Memory = 88341 MB
Rank =   68  Free Memory = 88341 MB
Rank =   69  Free Memory = 88341 MB
Rank =   70  Free Memory = 88341 MB
Rank =   71  Free Memory = 88341 MB
Rank =   72  Free Memory = 88341 MB
Rank =   73  Free Memory = 88341 MB
Rank =   74  Free Memory = 88341 MB
Rank =   75  Free Memory = 88341 MB
Rank =   76  Free Memory = 88341 MB
Rank =   77  Free Memory = 88341 MB
Rank =   78  Free Memory = 88341 MB
Rank =   79  Free Memory = 88341 MB
Rank =   80  Free Memory = 88341 MB
Rank =   81  Free Memory = 88341 MB
Rank =   82  Free Memory = 88341 MB
Rank =   83  Free Memory = 88341 MB
Rank =   84  Free Memory = 88341 MB
Rank =   85  Free Memory = 88341 MB
Rank =   86  Free Memory = 88341 MB
Rank =   87  Free Memory = 88341 MB
Rank =   88  Free Memory = 88341 MB
Rank =   89  Free Memory = 88341 MB
Rank =   90  Free Memory = 88341 MB
Rank =   91  Free Memory = 88341 MB
Rank =   92  Free Memory = 88341 MB
Rank =   93  Free Memory = 88341 MB
Rank =   94  Free Memory = 88341 MB
Rank =   95  Free Memory = 88341 MB
Rank =   96  Free Memory = 83762 MB
Rank =   97  Free Memory = 83762 MB
Rank =   98  Free Memory = 83761 MB
Rank =   99  Free Memory = 83761 MB
Rank =  100  Free Memory = 83761 MB
Rank =  101  Free Memory = 83761 MB
Rank =  102  Free Memory = 83761 MB
Rank =  103  Free Memory = 83761 MB
Rank =  104  Free Memory = 83761 MB
Rank =  105  Free Memory = 83761 MB
Rank =  106  Free Memory = 83761 MB
Rank =  107  Free Memory = 83761 MB
Rank =  108  Free Memory = 83761 MB
Rank =  109  Free Memory = 83761 MB
Rank =  110  Free Memory = 83761 MB
Rank =  111  Free Memory = 83761 MB
Rank =  112  Free Memory = 83761 MB
Rank =  113  Free Memory = 83761 MB
Rank =  114  Free Memory = 83761 MB
Rank =  115  Free Memory = 83761 MB
Rank =  116  Free Memory = 83761 MB
Rank =  117  Free Memory = 83761 MB
Rank =  118  Free Memory = 83761 MB
Rank =  119  Free Memory = 83761 MB
Rank =  120  Free Memory = 83761 MB
Rank =  121  Free Memory = 83761 MB
Rank =  122  Free Memory = 83761 MB
Rank =  123  Free Memory = 83761 MB
Rank =  124  Free Memory = 83761 MB
Rank =  125  Free Memory = 83761 MB
Rank =  126  Free Memory = 83761 MB
Rank =  127  Free Memory = 83761 MB
  Input file(s): opt_h2o_1b1_gvptt_run002f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002f.xml

  Project = H2O
  date    = 2023-03-15 14:22:44 PDT
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 804

  Range of prime numbers to use as seeds over processors and threads = 6199-7331


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.079106e-01    1         1  ON     0
     uu_1                 1.414872e-01    1         1  ON     1
     uu_2                 4.040895e-02    1         1  ON     2
     uu_3                -2.117369e-02    1         1  ON     3
     uu_4                -6.482637e-02    1         1  ON     4
     uu_5                -9.747604e-02    1         1  ON     5
     uu_6                -1.234263e-01    1         1  ON     6
     uu_7                -1.357650e-01    1         1  ON     7
     uu_8                -1.274547e-01    1         1  ON     8
     uu_9                -9.752215e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.441986e-01    1         1  ON     0
     ud_1                 1.786068e-01    1         1  ON     1
     ud_2                 5.890248e-02    1         1  ON     2
     ud_3                -1.150622e-02    1         1  ON     3
     ud_4                -6.773906e-02    1         1  ON     4
     ud_5                -1.076700e-01    1         1  ON     5
     ud_6                -1.339874e-01    1         1  ON     6
     ud_7                -1.490558e-01    1         1  ON     7
     ud_8                -1.486638e-01    1         1  ON     8
     ud_9                -1.365741e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.579714e-01    1         1  ON     0
     eO_1                -4.375032e-01    1         1  ON     1
     eO_2                -1.674494e-02    1         1  ON     2
     eO_3                 3.017912e-01    1         1  ON     3
     eO_4                 5.193468e-01    1         1  ON     4
     eO_5                 4.742369e-01    1         1  ON     5
     eO_6                 2.434598e-01    1         1  ON     6
     eO_7                -5.259146e-02    1         1  ON     7
     eO_8                -2.083772e-01    1         1  ON     8
     eO_9                -6.722369e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.347049e-01    1         1  ON     0
     eH1_1                -1.361568e-01    1         1  ON     1
     eH1_2                -9.078380e-02    1         1  ON     2
     eH1_3                -3.803666e-02    1         1  ON     3
     eH1_4                 9.029770e-03    1         1  ON     4
     eH1_5                 4.302983e-02    1         1  ON     5
     eH1_6                 9.881430e-02    1         1  ON     6
     eH1_7                 1.472428e-01    1         1  ON     7
     eH1_8                 1.604259e-01    1         1  ON     8
     eH1_9                 4.550580e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.317643e-01    1         1  ON     0
     eH2_1                -1.330733e-01    1         1  ON     1
     eH2_2                -8.772362e-02    1         1  ON     2
     eH2_3                -3.473919e-02    1         1  ON     3
     eH2_4                 1.200354e-02    1         1  ON     4
     eH2_5                 4.604128e-02    1         1  ON     5
     eH2_6                 1.020763e-01    1         1  ON     6
     eH2_7                 1.493255e-01    1         1  ON     7
     eH2_8                 1.660445e-01    1         1  ON     8
     eH2_9                 2.950543e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.341907e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.2981e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.114473
====================================================
  Execution time = 2.1684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334919789055
                                         uncertainty =       0.003280040583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334919789055
                                         uncertainty =       0.003280040583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409327372
  error estimate for blocks of size 2^( 2) =       0.000422150761
  error estimate for blocks of size 2^( 3) =       0.000435946489
  error estimate for blocks of size 2^( 4) =       0.000448976949
  error estimate for blocks of size 2^( 5) =       0.000459197570
  error estimate for blocks of size 2^( 6) =       0.000469316769
  error estimate for blocks of size 2^( 7) =       0.000478016203

      target function =                  N/A
              le_mean =     -16.905867872300
             les_mean =     286.143466143445
             stat err =       0.000463876873
             autocorr =       1.284292263523
              std dev =       0.578876321276
             le_variance =       0.335097795334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690586787230e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867872300       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905869964411       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868142279       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905869923642       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873194720       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905874925065       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873885449       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873091988       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905873650832       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905873475455       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905873647556       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.190616e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867872300       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868660476       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905867667128       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868308138       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869140128       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869192366       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905869392979       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905869203118       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905869310063       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.266233e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905867872300       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868097941       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905867774072       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905867932683       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868110160       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868133766       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868168816       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868165561       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 8.135481e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7428e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.079614e-01                 1 1 ON  0
uu_1  1.415082e-01                 1 1 ON  1
uu_2  4.043738e-02                 1 1 ON  2
uu_3  -2.114432e-02                1 1 ON  3
uu_4  -6.479245e-02                1 1 ON  4
uu_5  -9.759773e-02                1 1 ON  5
uu_6  -1.234526e-01                1 1 ON  6
uu_7  -1.357766e-01                1 1 ON  7
uu_8  -1.275911e-01                1 1 ON  8
uu_9  -9.760428e-02                1 1 ON  9
ud_0  4.444264e-01                 1 1 ON  10
ud_1  1.788373e-01                 1 1 ON  11
ud_2  5.889483e-02                 1 1 ON  12
ud_3  -1.165154e-02                1 1 ON  13
ud_4  -6.770329e-02                1 1 ON  14
ud_5  -1.078262e-01                1 1 ON  15
ud_6  -1.340107e-01                1 1 ON  16
ud_7  -1.491135e-01                1 1 ON  17
ud_8  -1.486729e-01                1 1 ON  18
ud_9  -1.366218e-01                1 1 ON  19
eO_0  -7.582417e-01                1 1 ON  20
eO_1  -4.376260e-01                1 1 ON  21
eO_2  -1.670144e-02                1 1 ON  22
eO_3  3.018064e-01                 1 1 ON  23
eO_4  5.196734e-01                 1 1 ON  24
eO_5  4.743843e-01                 1 1 ON  25
eO_6  2.435697e-01                 1 1 ON  26
eO_7  -5.255496e-02                1 1 ON  27
eO_8  -2.085151e-01                1 1 ON  28
eO_9  -6.735115e-02                1 1 ON  29
eH1_0 -2.348691e-01                1 1 ON  30
eH1_1 -1.363116e-01                1 1 ON  31
eH1_2 -9.087597e-02                1 1 ON  32
eH1_3 -3.802552e-02                1 1 ON  33
eH1_4 9.032543e-03                 1 1 ON  34
eH1_5 4.291815e-02                 1 1 ON  35
eH1_6 9.890616e-02                 1 1 ON  36
eH1_7 1.473683e-01                 1 1 ON  37
eH1_8 1.605846e-01                 1 1 ON  38
eH1_9 4.565068e-02                 1 1 ON  39
eH2_0 -2.319473e-01                1 1 ON  40
eH2_1 -1.331432e-01                1 1 ON  41
eH2_2 -8.778172e-02                1 1 ON  42
eH2_3 -3.480046e-02                1 1 ON  43
eH2_4 1.208764e-02                 1 1 ON  44
eH2_5 4.596816e-02                 1 1 ON  45
eH2_6 1.019470e-01                 1 1 ON  46
eH2_7 1.494214e-01                 1 1 ON  47
eH2_8 1.662566e-01                 1 1 ON  48
eH2_9 2.971470e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.296398
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7584e-01
  Total weights = 2.0000e+06
  Execution time = 1.9045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375487167474
                                         uncertainty =       0.042090451103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375487167474
                                         uncertainty =       0.042090451103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433402313
  error estimate for blocks of size 2^( 2) =       0.000445815853
  error estimate for blocks of size 2^( 3) =       0.000458399135
  error estimate for blocks of size 2^( 4) =       0.000469599971
  error estimate for blocks of size 2^( 5) =       0.000480476710
  error estimate for blocks of size 2^( 6) =       0.000487718683
  error estimate for blocks of size 2^( 7) =       0.000495254804

      target function =                  N/A
              le_mean =     -16.905166979364
             les_mean =     286.160345542847
             stat err =       0.000483262542
             autocorr =       1.243322570076
              std dev =       0.612923429563
             le_variance =       0.375675130507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376000790384
                                         uncertainty =       0.042134343356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376000790384
                                         uncertainty =       0.042134343356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433698700
  error estimate for blocks of size 2^( 2) =       0.000446093551
  error estimate for blocks of size 2^( 3) =       0.000458648178
  error estimate for blocks of size 2^( 4) =       0.000469826843
  error estimate for blocks of size 2^( 5) =       0.000480693797
  error estimate for blocks of size 2^( 6) =       0.000487919963
  error estimate for blocks of size 2^( 7) =       0.000495452154

      target function =                  N/A
              le_mean =     -16.905173132882
             les_mean =     286.161067588985
             stat err =       0.000483473189
             autocorr =       1.242706445211
              std dev =       0.613342583201
             le_variance =       0.376189124368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375827790063
                                         uncertainty =       0.042118514549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375827790063
                                         uncertainty =       0.042118514549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433598908
  error estimate for blocks of size 2^( 2) =       0.000445998596
  error estimate for blocks of size 2^( 3) =       0.000458560847
  error estimate for blocks of size 2^( 4) =       0.000469747069
  error estimate for blocks of size 2^( 5) =       0.000480618241
  error estimate for blocks of size 2^( 6) =       0.000487849773
  error estimate for blocks of size 2^( 7) =       0.000495386344

      target function =                  N/A
              le_mean =     -16.905171625940
             les_mean =     286.160843541285
             stat err =       0.000483400357
             autocorr =       1.242903963771
              std dev =       0.613201456940
             le_variance =       0.376016026793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375530157964
                                         uncertainty =       0.042093978858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375530157964
                                         uncertainty =       0.042093978858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433427131
  error estimate for blocks of size 2^( 2) =       0.000445838727
  error estimate for blocks of size 2^( 3) =       0.000458419056
  error estimate for blocks of size 2^( 4) =       0.000469617961
  error estimate for blocks of size 2^( 5) =       0.000480494023
  error estimate for blocks of size 2^( 6) =       0.000487734571
  error estimate for blocks of size 2^( 7) =       0.000495271053

      target function =                  N/A
              le_mean =     -16.905167510521
             les_mean =     286.160406526602
             stat err =       0.000483279402
             autocorr =       1.243266936948
              std dev =       0.612958526900
             le_variance =       0.375718155700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905166979364        initial
     2.5000e-01     2.5000e+00             1.1906e-03       -16.905173132882  <--
     1.0000e+00     1.0000e+01             3.2662e-04       -16.905171625940
     4.0000e+00     4.0000e+01             8.1355e-05       -16.905167510521

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.081117e-01 1 1  ON 0
 uu_1                 1.415992e-01 1 1  ON 1
 uu_2                 4.052306e-02 1 1  ON 2
 uu_3                -2.109132e-02 1 1  ON 3
 uu_4                -6.477951e-02 1 1  ON 4
 uu_5                -9.782464e-02 1 1  ON 5
 uu_6                -1.235883e-01 1 1  ON 6
 uu_7                -1.358465e-01 1 1  ON 7
 uu_8                -1.279520e-01 1 1  ON 8
 uu_9                -9.784255e-02 1 1  ON 9
 ud_0                 4.449266e-01 1 1  ON 10
 ud_1                 1.792325e-01 1 1  ON 11
 ud_2                 5.899308e-02 1 1  ON 12
 ud_3                -1.182316e-02 1 1  ON 13
 ud_4                -6.775240e-02 1 1  ON 14
 ud_5                -1.080923e-01 1 1  ON 15
 ud_6                -1.341179e-01 1 1  ON 16
 ud_7                -1.492424e-01 1 1  ON 17
 ud_8                -1.486768e-01 1 1  ON 18
 ud_9                -1.367500e-01 1 1  ON 19
 eO_0                -7.588854e-01 1 1  ON 20
 eO_1                -4.379881e-01 1 1  ON 21
 eO_2                -1.673367e-02 1 1  ON 22
 eO_3                 3.018906e-01 1 1  ON 23
 eO_4                 5.205374e-01 1 1  ON 24
 eO_5                 4.748587e-01 1 1  ON 25
 eO_6                 2.439064e-01 1 1  ON 26
 eO_7                -5.243000e-02 1 1  ON 27
 eO_8                -2.089179e-01 1 1  ON 28
 eO_9                -6.773181e-02 1 1  ON 29
eH1_0                -2.353394e-01 1 1  ON 30
eH1_1                -1.366877e-01 1 1  ON 31
eH1_2                -9.112312e-02 1 1  ON 32
eH1_3                -3.809998e-02 1 1  ON 33
eH1_4                 9.005881e-03 1 1  ON 34
eH1_5                 4.261902e-02 1 1  ON 35
eH1_6                 9.913682e-02 1 1  ON 36
eH1_7                 1.477401e-01 1 1  ON 37
eH1_8                 1.610716e-01 1 1  ON 38
eH1_9                 4.609014e-02 1 1  ON 39
eH2_0                -2.324276e-01 1 1  ON 40
eH2_1                -1.333854e-01 1 1  ON 41
eH2_2                -8.795411e-02 1 1  ON 42
eH2_3                -3.493733e-02 1 1  ON 43
eH2_4                 1.218509e-02 1 1  ON 44
eH2_5                 4.578713e-02 1 1  ON 45
eH2_6                 1.016019e-01 1 1  ON 46
eH2_7                 1.497003e-01 1 1  ON 47
eH2_8                 1.668882e-01 1 1  ON 48
eH2_9                 3.034338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.182281
====================================================
  Execution time = 2.1034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3280e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332858970942
                                         uncertainty =       0.002823934654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332858970942
                                         uncertainty =       0.002823934654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407921270
  error estimate for blocks of size 2^( 2) =       0.000420579199
  error estimate for blocks of size 2^( 3) =       0.000433620300
  error estimate for blocks of size 2^( 4) =       0.000446050689
  error estimate for blocks of size 2^( 5) =       0.000455219841
  error estimate for blocks of size 2^( 6) =       0.000463140129
  error estimate for blocks of size 2^( 7) =       0.000468042675

      target function =                  N/A
              le_mean =     -16.905235605276
             les_mean =     286.119790227815
             stat err =       0.000458113334
             autocorr =       1.261226720977
              std dev =       0.576887791803
             le_variance =       0.332799524331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690523560528e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905235605276       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905235340798       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905237978112       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905242596304       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905247350695       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905250350955       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905248996697       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905249757361       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905251505778       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905252749119       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905252562951       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905252718323       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905251947793       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905251947381       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.128455e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905235605276       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905235466985       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236777001       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905238733055       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905240895852       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905240809508       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905240684917       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905240827787       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905241220873       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905241155440       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905241277310       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.301931e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905235605276       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905235557728       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236020553       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905236494286       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905237132143       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905237015430       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905236957426       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905237007614       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905237099087       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.595430e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6501e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.234119
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4881e-01
  Total weights = 2.0000e+06
  Execution time = 1.9174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348274889143
                                         uncertainty =       0.013061368245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348274889143
                                         uncertainty =       0.013061368245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417417973
  error estimate for blocks of size 2^( 2) =       0.000429938137
  error estimate for blocks of size 2^( 3) =       0.000443025237
  error estimate for blocks of size 2^( 4) =       0.000455745339
  error estimate for blocks of size 2^( 5) =       0.000466473618
  error estimate for blocks of size 2^( 6) =       0.000476469161
  error estimate for blocks of size 2^( 7) =       0.000482379591

      target function =                  N/A
              le_mean =     -16.905440372271
             les_mean =     286.142389533977
             stat err =       0.000470266927
             autocorr =       1.269248284441
              std dev =       0.590318158109
             le_variance =       0.348475527793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349067628256
                                         uncertainty =       0.013114634535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349067628256
                                         uncertainty =       0.013114634535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417892378
  error estimate for blocks of size 2^( 2) =       0.000430380877
  error estimate for blocks of size 2^( 3) =       0.000443419760
  error estimate for blocks of size 2^( 4) =       0.000456089140
  error estimate for blocks of size 2^( 5) =       0.000466787019
  error estimate for blocks of size 2^( 6) =       0.000476781263
  error estimate for blocks of size 2^( 7) =       0.000482689006

      target function =                  N/A
              le_mean =     -16.905444449731
             les_mean =     286.143319947561
             stat err =       0.000470586607
             autocorr =       1.268090432656
              std dev =       0.590989068650
             le_variance =       0.349268079264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348951278936
                                         uncertainty =       0.013084050782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348951278936
                                         uncertainty =       0.013084050782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417822701
  error estimate for blocks of size 2^( 2) =       0.000430313834
  error estimate for blocks of size 2^( 3) =       0.000443359561
  error estimate for blocks of size 2^( 4) =       0.000456039971
  error estimate for blocks of size 2^( 5) =       0.000466744005
  error estimate for blocks of size 2^( 6) =       0.000476736597
  error estimate for blocks of size 2^( 7) =       0.000482642443

      target function =                  N/A
              le_mean =     -16.905445041222
             les_mean =     286.143223486568
             stat err =       0.000470540754
             autocorr =       1.268266212871
              std dev =       0.590890530788
             le_variance =       0.349151619375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348389463184
                                         uncertainty =       0.013063603917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348389463184
                                         uncertainty =       0.013063603917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417486537
  error estimate for blocks of size 2^( 2) =       0.000430001148
  error estimate for blocks of size 2^( 3) =       0.000443080720
  error estimate for blocks of size 2^( 4) =       0.000455793682
  error estimate for blocks of size 2^( 5) =       0.000466517787
  error estimate for blocks of size 2^( 6) =       0.000476512318
  error estimate for blocks of size 2^( 7) =       0.000482422270

      target function =                  N/A
              le_mean =     -16.905440717260
             les_mean =     286.142515687889
             stat err =       0.000470311514
             autocorr =       1.269072028205
              std dev =       0.590415122941
             le_variance =       0.348590017397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905440372271        initial
     6.2500e-02     6.2500e-01             3.1285e-03       -16.905444449731
     2.5000e-01     2.5000e+00             9.3019e-04       -16.905445041222  <--
     1.0000e+00     1.0000e+01             2.5954e-04       -16.905440717260

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0003e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8312
    reference variance = 0.281989
====================================================
  Execution time = 2.1011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4166e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340344434296
                                         uncertainty =       0.004476695900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340344434296
                                         uncertainty =       0.004476695900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413317277
  error estimate for blocks of size 2^( 2) =       0.000425860958
  error estimate for blocks of size 2^( 3) =       0.000438901637
  error estimate for blocks of size 2^( 4) =       0.000451678680
  error estimate for blocks of size 2^( 5) =       0.000461948345
  error estimate for blocks of size 2^( 6) =       0.000470365836
  error estimate for blocks of size 2^( 7) =       0.000474931889

      target function =                  N/A
              le_mean =     -16.905812993382
             les_mean =     286.148175139583
             stat err =       0.000464731187
             autocorr =       1.264260348905
              std dev =       0.584518898944
             le_variance =       0.341662343223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581299338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812993382       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815013812       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817002309       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905818478931       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905821813116       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905825151436       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905823660161       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905823286057       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905824021971       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905825065835       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905825169208       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905825993966       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905825888408       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.317767e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812993382       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905814028046       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815340614       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815655891       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816936913       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905817658533       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905817547528       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905816921079       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905816980155       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905817245061       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.765584e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812993382       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905813343925       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905813854539       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905813917292       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905814324417       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905814389868       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905814396419       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905814246748       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905814233490       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.193583e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6479e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.085009e-01 1 1  ON 0
 uu_1                 1.420355e-01 1 1  ON 1
 uu_2                 4.083136e-02 1 1  ON 2
 uu_3                -2.077038e-02 1 1  ON 3
 uu_4                -6.469008e-02 1 1  ON 4
 uu_5                -9.775439e-02 1 1  ON 5
 uu_6                -1.237237e-01 1 1  ON 6
 uu_7                -1.362991e-01 1 1  ON 7
 uu_8                -1.291159e-01 1 1  ON 8
 uu_9                -9.900470e-02 1 1  ON 9
 ud_0                 4.461592e-01 1 1  ON 10
 ud_1                 1.803077e-01 1 1  ON 11
 ud_2                 5.948531e-02 1 1  ON 12
 ud_3                -1.156134e-02 1 1  ON 13
 ud_4                -6.783370e-02 1 1  ON 14
 ud_5                -1.080307e-01 1 1  ON 15
 ud_6                -1.338343e-01 1 1  ON 16
 ud_7                -1.494035e-01 1 1  ON 17
 ud_8                -1.498976e-01 1 1  ON 18
 ud_9                -1.379947e-01 1 1  ON 19
 eO_0                -7.603298e-01 1 1  ON 20
 eO_1                -4.387831e-01 1 1  ON 21
 eO_2                -1.684347e-02 1 1  ON 22
 eO_3                 3.025800e-01 1 1  ON 23
 eO_4                 5.219973e-01 1 1  ON 24
 eO_5                 4.765206e-01 1 1  ON 25
 eO_6                 2.449714e-01 1 1  ON 26
 eO_7                -5.207172e-02 1 1  ON 27
 eO_8                -2.103326e-01 1 1  ON 28
 eO_9                -6.898161e-02 1 1  ON 29
eH1_0                -2.368285e-01 1 1  ON 30
eH1_1                -1.374072e-01 1 1  ON 31
eH1_2                -9.160644e-02 1 1  ON 32
eH1_3                -3.817610e-02 1 1  ON 33
eH1_4                 8.952490e-03 1 1  ON 34
eH1_5                 4.257792e-02 1 1  ON 35
eH1_6                 9.867974e-02 1 1  ON 36
eH1_7                 1.481112e-01 1 1  ON 37
eH1_8                 1.626099e-01 1 1  ON 38
eH1_9                 4.741657e-02 1 1  ON 39
eH2_0                -2.336327e-01 1 1  ON 40
eH2_1                -1.341700e-01 1 1  ON 41
eH2_2                -8.832009e-02 1 1  ON 42
eH2_3                -3.488281e-02 1 1  ON 43
eH2_4                 1.217250e-02 1 1  ON 44
eH2_5                 4.573191e-02 1 1  ON 45
eH2_6                 1.015400e-01 1 1  ON 46
eH2_7                 1.499118e-01 1 1  ON 47
eH2_8                 1.680052e-01 1 1  ON 48
eH2_9                 3.165491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8999
    reference variance = 0.216178
====================================================
  Execution time = 2.2818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336940205575
                                         uncertainty =       0.003152804376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336940205575
                                         uncertainty =       0.003152804376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447256
  error estimate for blocks of size 2^( 2) =       0.000423666853
  error estimate for blocks of size 2^( 3) =       0.000437227910
  error estimate for blocks of size 2^( 4) =       0.000449730979
  error estimate for blocks of size 2^( 5) =       0.000460041885
  error estimate for blocks of size 2^( 6) =       0.000468276409
  error estimate for blocks of size 2^( 7) =       0.000473244722

      target function =                  N/A
              le_mean =     -16.905693957884
             les_mean =     286.139421928997
             stat err =       0.000462823499
             autocorr =       1.271499193091
              std dev =       0.580460076008
             le_variance =       0.336933899839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337435721181
                                         uncertainty =       0.003157515457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337435721181
                                         uncertainty =       0.003157515457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410748922
  error estimate for blocks of size 2^( 2) =       0.000423949124
  error estimate for blocks of size 2^( 3) =       0.000437479249
  error estimate for blocks of size 2^( 4) =       0.000449952036
  error estimate for blocks of size 2^( 5) =       0.000460239705
  error estimate for blocks of size 2^( 6) =       0.000468469146
  error estimate for blocks of size 2^( 7) =       0.000473440725

      target function =                  N/A
              le_mean =     -16.905692191472
             les_mean =     286.139857658203
             stat err =       0.000463025403
             autocorr =       1.270740209581
              std dev =       0.580886696443
             le_variance =       0.337429354104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337324838238
                                         uncertainty =       0.003156495927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337324838238
                                         uncertainty =       0.003156495927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410681440
  error estimate for blocks of size 2^( 2) =       0.000423885535
  error estimate for blocks of size 2^( 3) =       0.000437423876
  error estimate for blocks of size 2^( 4) =       0.000449906073
  error estimate for blocks of size 2^( 5) =       0.000460202270
  error estimate for blocks of size 2^( 6) =       0.000468436058
  error estimate for blocks of size 2^( 7) =       0.000473407868

      target function =                  N/A
              le_mean =     -16.905691904814
             les_mean =     286.139737102051
             stat err =       0.000462988067
             autocorr =       1.270952860916
              std dev =       0.580791262159
             le_variance =       0.337318490200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008060637
                                         uncertainty =       0.003153445280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008060637
                                         uncertainty =       0.003153445280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488577
  error estimate for blocks of size 2^( 2) =       0.000423705243
  error estimate for blocks of size 2^( 3) =       0.000437262132
  error estimate for blocks of size 2^( 4) =       0.000449761625
  error estimate for blocks of size 2^( 5) =       0.000460070119
  error estimate for blocks of size 2^( 6) =       0.000468304781
  error estimate for blocks of size 2^( 7) =       0.000473274094

      target function =                  N/A
              le_mean =     -16.905693392222
             les_mean =     286.139470647090
             stat err =       0.000462852655
             autocorr =       1.271403392529
              std dev =       0.580518512849
             le_variance =       0.337001743760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905693957884        initial  <--
     6.2500e-02     6.2500e-01             3.3178e-03       -16.905692191472
     2.5000e-01     2.5000e+00             8.7656e-04       -16.905691904814
     1.0000e+00     1.0000e+01             2.1936e-04       -16.905693392222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3357
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9370e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8415
    reference variance = 0.265664
====================================================
  Execution time = 2.3345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337297163619
                                         uncertainty =       0.003457530333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337297163619
                                         uncertainty =       0.003457530333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410629306
  error estimate for blocks of size 2^( 2) =       0.000423229353
  error estimate for blocks of size 2^( 3) =       0.000436607585
  error estimate for blocks of size 2^( 4) =       0.000449121915
  error estimate for blocks of size 2^( 5) =       0.000460158486
  error estimate for blocks of size 2^( 6) =       0.000468605638
  error estimate for blocks of size 2^( 7) =       0.000473380257

      target function =                  N/A
              le_mean =     -16.905993213942
             les_mean =     286.149839234394
             stat err =       0.000462816574
             autocorr =       1.270334007901
              std dev =       0.580717533018
             le_variance =       0.337232853154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599321394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993213942       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994121604       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994897466       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995698849       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995643787       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995053447       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995241677       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905995359242       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905995396129       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.139364e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993213942       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993495387       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993756291       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993938253       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993931703       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993903259       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993837683       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905993871371       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.022484e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993213942       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905993288801       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905993360432       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905993401930       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993401936       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905993403860       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993388296       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905993393182       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.566437e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8899e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.083069e-01 1 1  ON 0
 uu_1                 1.418232e-01 1 1  ON 1
 uu_2                 4.070555e-02 1 1  ON 2
 uu_3                -2.081447e-02 1 1  ON 3
 uu_4                -6.477792e-02 1 1  ON 4
 uu_5                -9.789579e-02 1 1  ON 5
 uu_6                -1.234948e-01 1 1  ON 6
 uu_7                -1.362345e-01 1 1  ON 7
 uu_8                -1.288931e-01 1 1  ON 8
 uu_9                -9.825658e-02 1 1  ON 9
 ud_0                 4.457418e-01 1 1  ON 10
 ud_1                 1.799465e-01 1 1  ON 11
 ud_2                 5.929626e-02 1 1  ON 12
 ud_3                -1.169035e-02 1 1  ON 13
 ud_4                -6.783031e-02 1 1  ON 14
 ud_5                -1.080272e-01 1 1  ON 15
 ud_6                -1.341997e-01 1 1  ON 16
 ud_7                -1.496136e-01 1 1  ON 17
 ud_8                -1.492033e-01 1 1  ON 18
 ud_9                -1.371720e-01 1 1  ON 19
 eO_0                -7.596911e-01 1 1  ON 20
 eO_1                -4.383947e-01 1 1  ON 21
 eO_2                -1.689307e-02 1 1  ON 22
 eO_3                 3.023287e-01 1 1  ON 23
 eO_4                 5.215100e-01 1 1  ON 24
 eO_5                 4.756992e-01 1 1  ON 25
 eO_6                 2.444375e-01 1 1  ON 26
 eO_7                -5.233801e-02 1 1  ON 27
 eO_8                -2.096564e-01 1 1  ON 28
 eO_9                -6.837718e-02 1 1  ON 29
eH1_0                -2.363293e-01 1 1  ON 30
eH1_1                -1.369836e-01 1 1  ON 31
eH1_2                -9.140347e-02 1 1  ON 32
eH1_3                -3.798068e-02 1 1  ON 33
eH1_4                 8.918249e-03 1 1  ON 34
eH1_5                 4.248665e-02 1 1  ON 35
eH1_6                 9.878711e-02 1 1  ON 36
eH1_7                 1.479051e-01 1 1  ON 37
eH1_8                 1.619486e-01 1 1  ON 38
eH1_9                 4.696204e-02 1 1  ON 39
eH2_0                -2.330058e-01 1 1  ON 40
eH2_1                -1.338187e-01 1 1  ON 41
eH2_2                -8.818277e-02 1 1  ON 42
eH2_3                -3.495316e-02 1 1  ON 43
eH2_4                 1.231867e-02 1 1  ON 44
eH2_5                 4.594444e-02 1 1  ON 45
eH2_6                 1.017739e-01 1 1  ON 46
eH2_7                 1.496725e-01 1 1  ON 47
eH2_8                 1.672332e-01 1 1  ON 48
eH2_9                 3.097471e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.168595
====================================================
  Execution time = 2.1373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2493e-01
  Total weights = 2.0000e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324898016210
                                         uncertainty =       0.001942610043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324898016210
                                         uncertainty =       0.001942610043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403056729
  error estimate for blocks of size 2^( 2) =       0.000416536243
  error estimate for blocks of size 2^( 3) =       0.000429872312
  error estimate for blocks of size 2^( 4) =       0.000442783295
  error estimate for blocks of size 2^( 5) =       0.000452340085
  error estimate for blocks of size 2^( 6) =       0.000459803968
  error estimate for blocks of size 2^( 7) =       0.000461235333

      target function =                  N/A
              le_mean =     -16.905327352765
             les_mean =     286.115002194668
             stat err =       0.000454040670
             autocorr =       1.268986963938
              std dev =       0.570008292022
             le_variance =       0.324909452974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324981953445
                                         uncertainty =       0.001942838523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324981953445
                                         uncertainty =       0.001942838523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403108764
  error estimate for blocks of size 2^( 2) =       0.000416587475
  error estimate for blocks of size 2^( 3) =       0.000429920956
  error estimate for blocks of size 2^( 4) =       0.000442830579
  error estimate for blocks of size 2^( 5) =       0.000452385639
  error estimate for blocks of size 2^( 6) =       0.000459846133
  error estimate for blocks of size 2^( 7) =       0.000461277538

      target function =                  N/A
              le_mean =     -16.905326894555
             les_mean =     286.115070599715
             stat err =       0.000454084972
             autocorr =       1.268906958833
              std dev =       0.570081880481
             le_variance =       0.324993350453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324947447075
                                         uncertainty =       0.001942704480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324947447075
                                         uncertainty =       0.001942704480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403087362
  error estimate for blocks of size 2^( 2) =       0.000416566506
  error estimate for blocks of size 2^( 3) =       0.000429901233
  error estimate for blocks of size 2^( 4) =       0.000442811736
  error estimate for blocks of size 2^( 5) =       0.000452367498
  error estimate for blocks of size 2^( 6) =       0.000459829310
  error estimate for blocks of size 2^( 7) =       0.000461260893

      target function =                  N/A
              le_mean =     -16.905327077283
             les_mean =     286.115042270487
             stat err =       0.000454067359
             autocorr =       1.268943258792
              std dev =       0.570051614365
             le_variance =       0.324958843040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324904377685
                                         uncertainty =       0.001942619553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324904377685
                                         uncertainty =       0.001942619553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403060671
  error estimate for blocks of size 2^( 2) =       0.000416540145
  error estimate for blocks of size 2^( 3) =       0.000429876047
  error estimate for blocks of size 2^( 4) =       0.000442786984
  error estimate for blocks of size 2^( 5) =       0.000452343644
  error estimate for blocks of size 2^( 6) =       0.000459807263
  error estimate for blocks of size 2^( 7) =       0.000461238673

      target function =                  N/A
              le_mean =     -16.905327308214
             les_mean =     286.115007043738
             stat err =       0.000454044141
             autocorr =       1.268981543735
              std dev =       0.570013866804
             le_variance =       0.324915808349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905327352765        initial  <--
     6.2500e-01     6.2500e+00             4.1394e-04       -16.905326894555
     2.5000e+00     2.5000e+01             1.0225e-04       -16.905327077283
     1.0000e+01     1.0000e+02             2.5664e-05       -16.905327308214

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8943
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.7614
    reference variance = 1.35915
====================================================
  Execution time = 2.1047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344045691253
                                         uncertainty =       0.006203171824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344045691253
                                         uncertainty =       0.006203171824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414779381
  error estimate for blocks of size 2^( 2) =       0.000427326720
  error estimate for blocks of size 2^( 3) =       0.000440771840
  error estimate for blocks of size 2^( 4) =       0.000453270486
  error estimate for blocks of size 2^( 5) =       0.000463158425
  error estimate for blocks of size 2^( 6) =       0.000471230675
  error estimate for blocks of size 2^( 7) =       0.000476850975

      target function =                  N/A
              le_mean =     -16.905799101371
             les_mean =     286.150126954381
             stat err =       0.000466127640
             autocorr =       1.262918700033
              std dev =       0.586586626609
             le_variance =       0.344083870517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579910137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799101371       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799109403       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799076447       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799141784       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799269425       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799256572       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799245636       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799244372       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.595627e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799101371       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799103414       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799094884       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799111437       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799143774       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799139772       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799137029       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799136790       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.150817e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799101371       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799101884       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799099732       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799103884       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799111992       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799110945       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799110253       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799110198       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.878290e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6660e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.083095e-01 1 1  ON 0
 uu_1                 1.418361e-01 1 1  ON 1
 uu_2                 4.068962e-02 1 1  ON 2
 uu_3                -2.080719e-02 1 1  ON 3
 uu_4                -6.473379e-02 1 1  ON 4
 uu_5                -9.793723e-02 1 1  ON 5
 uu_6                -1.234392e-01 1 1  ON 6
 uu_7                -1.362306e-01 1 1  ON 7
 uu_8                -1.288520e-01 1 1  ON 8
 uu_9                -9.826125e-02 1 1  ON 9
 ud_0                 4.456956e-01 1 1  ON 10
 ud_1                 1.799389e-01 1 1  ON 11
 ud_2                 5.928039e-02 1 1  ON 12
 ud_3                -1.165580e-02 1 1  ON 13
 ud_4                -6.783126e-02 1 1  ON 14
 ud_5                -1.080222e-01 1 1  ON 15
 ud_6                -1.341304e-01 1 1  ON 16
 ud_7                -1.495926e-01 1 1  ON 17
 ud_8                -1.492281e-01 1 1  ON 18
 ud_9                -1.372135e-01 1 1  ON 19
 eO_0                -7.596431e-01 1 1  ON 20
 eO_1                -4.383781e-01 1 1  ON 21
 eO_2                -1.685658e-02 1 1  ON 22
 eO_3                 3.022926e-01 1 1  ON 23
 eO_4                 5.214750e-01 1 1  ON 24
 eO_5                 4.756555e-01 1 1  ON 25
 eO_6                 2.443946e-01 1 1  ON 26
 eO_7                -5.235362e-02 1 1  ON 27
 eO_8                -2.096267e-01 1 1  ON 28
 eO_9                -6.833903e-02 1 1  ON 29
eH1_0                -2.362340e-01 1 1  ON 30
eH1_1                -1.369014e-01 1 1  ON 31
eH1_2                -9.138384e-02 1 1  ON 32
eH1_3                -3.798517e-02 1 1  ON 33
eH1_4                 8.901091e-03 1 1  ON 34
eH1_5                 4.250298e-02 1 1  ON 35
eH1_6                 9.881226e-02 1 1  ON 36
eH1_7                 1.478852e-01 1 1  ON 37
eH1_8                 1.618659e-01 1 1  ON 38
eH1_9                 4.686774e-02 1 1  ON 39
eH2_0                -2.329727e-01 1 1  ON 40
eH2_1                -1.337681e-01 1 1  ON 41
eH2_2                -8.815386e-02 1 1  ON 42
eH2_3                -3.494049e-02 1 1  ON 43
eH2_4                 1.228101e-02 1 1  ON 44
eH2_5                 4.599494e-02 1 1  ON 45
eH2_6                 1.017783e-01 1 1  ON 46
eH2_7                 1.496341e-01 1 1  ON 47
eH2_8                 1.671796e-01 1 1  ON 48
eH2_9                 3.091733e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9138
    reference variance = 0.220307
====================================================
  Execution time = 2.0940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3669e-01
  Total weights = 2.0000e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336724197797
                                         uncertainty =       0.004753018883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336724197797
                                         uncertainty =       0.004753018883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410298015
  error estimate for blocks of size 2^( 2) =       0.000423146183
  error estimate for blocks of size 2^( 3) =       0.000435693818
  error estimate for blocks of size 2^( 4) =       0.000447037926
  error estimate for blocks of size 2^( 5) =       0.000457576268
  error estimate for blocks of size 2^( 6) =       0.000466835656
  error estimate for blocks of size 2^( 7) =       0.000470236614

      target function =                  N/A
              le_mean =     -16.905954414545
             les_mean =     286.147983419755
             stat err =       0.000460421616
             autocorr =       1.259251796268
              std dev =       0.580249016748
             le_variance =       0.336688921437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336742250484
                                         uncertainty =       0.004753244951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336742250484
                                         uncertainty =       0.004753244951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410309010
  error estimate for blocks of size 2^( 2) =       0.000423156572
  error estimate for blocks of size 2^( 3) =       0.000435703250
  error estimate for blocks of size 2^( 4) =       0.000447046470
  error estimate for blocks of size 2^( 5) =       0.000457584607
  error estimate for blocks of size 2^( 6) =       0.000466843910
  error estimate for blocks of size 2^( 7) =       0.000470244745

      target function =                  N/A
              le_mean =     -16.905954368776
             les_mean =     286.147999918458
             stat err =       0.000460429933
             autocorr =       1.259229797443
              std dev =       0.580264566958
             le_variance =       0.336706967667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336733420412
                                         uncertainty =       0.004753134315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336733420412
                                         uncertainty =       0.004753134315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410303632
  error estimate for blocks of size 2^( 2) =       0.000423151491
  error estimate for blocks of size 2^( 3) =       0.000435698638
  error estimate for blocks of size 2^( 4) =       0.000447042292
  error estimate for blocks of size 2^( 5) =       0.000457580534
  error estimate for blocks of size 2^( 6) =       0.000466839878
  error estimate for blocks of size 2^( 7) =       0.000470240773

      target function =                  N/A
              le_mean =     -16.905954389209
             les_mean =     286.147991782489
             stat err =       0.000460425869
             autocorr =       1.259240579095
              std dev =       0.580256961029
             le_variance =       0.336698140822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336725356318
                                         uncertainty =       0.004753033381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336725356318
                                         uncertainty =       0.004753033381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410298720
  error estimate for blocks of size 2^( 2) =       0.000423146850
  error estimate for blocks of size 2^( 3) =       0.000435694424
  error estimate for blocks of size 2^( 4) =       0.000447038475
  error estimate for blocks of size 2^( 5) =       0.000457576804
  error estimate for blocks of size 2^( 6) =       0.000466836186
  error estimate for blocks of size 2^( 7) =       0.000470237136

      target function =                  N/A
              le_mean =     -16.905954411249
             les_mean =     286.147984466428
             stat err =       0.000460422150
             autocorr =       1.259250387369
              std dev =       0.580250014696
             le_variance =       0.336690079555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905954414545        initial  <--
     6.2500e+00     6.2500e+01             4.5956e-05       -16.905954368776
     2.5000e+01     2.5000e+02             1.1508e-05       -16.905954389209
     1.0000e+02     1.0000e+03             2.8783e-06       -16.905954411249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4525
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9743
    reference variance = 0.287099
====================================================
  Execution time = 2.0801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4346e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493306717
                                         uncertainty =       0.007188135217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493306717
                                         uncertainty =       0.007188135217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414404648
  error estimate for blocks of size 2^( 2) =       0.000426551480
  error estimate for blocks of size 2^( 3) =       0.000440189878
  error estimate for blocks of size 2^( 4) =       0.000452214272
  error estimate for blocks of size 2^( 5) =       0.000462601039
  error estimate for blocks of size 2^( 6) =       0.000470882137
  error estimate for blocks of size 2^( 7) =       0.000475345584

      target function =                  N/A
              le_mean =     -16.905493477250
             les_mean =     286.139171962351
             stat err =       0.000465260758
             autocorr =       1.260502211097
              std dev =       0.586056673671
             le_variance =       0.343462424754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549347725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905493477250       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905493476627       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905493476922       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905493486587       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905493488650       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905493486899       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905493489362       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905493489921       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.948489e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905493477250       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905493477094       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905493477153       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905493479588       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905493480042       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905493479633       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905493480268       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905493480405       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.241602e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905493477250       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905493477211       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905493477224       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905493477834       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905493477944       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905493477844       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905493478003       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905493478039       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.106822e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6449e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.083076e-01 1 1  ON 0
 uu_1                 1.418340e-01 1 1  ON 1
 uu_2                 4.068497e-02 1 1  ON 2
 uu_3                -2.080744e-02 1 1  ON 3
 uu_4                -6.473426e-02 1 1  ON 4
 uu_5                -9.793607e-02 1 1  ON 5
 uu_6                -1.234368e-01 1 1  ON 6
 uu_7                -1.362240e-01 1 1  ON 7
 uu_8                -1.288476e-01 1 1  ON 8
 uu_9                -9.825900e-02 1 1  ON 9
 ud_0                 4.456893e-01 1 1  ON 10
 ud_1                 1.799367e-01 1 1  ON 11
 ud_2                 5.927777e-02 1 1  ON 12
 ud_3                -1.165628e-02 1 1  ON 13
 ud_4                -6.783087e-02 1 1  ON 14
 ud_5                -1.080204e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495929e-01 1 1  ON 17
 ud_8                -1.492249e-01 1 1  ON 18
 ud_9                -1.372088e-01 1 1  ON 19
 eO_0                -7.596343e-01 1 1  ON 20
 eO_1                -4.383760e-01 1 1  ON 21
 eO_2                -1.685549e-02 1 1  ON 22
 eO_3                 3.022900e-01 1 1  ON 23
 eO_4                 5.214679e-01 1 1  ON 24
 eO_5                 4.756449e-01 1 1  ON 25
 eO_6                 2.443879e-01 1 1  ON 26
 eO_7                -5.235223e-02 1 1  ON 27
 eO_8                -2.096191e-01 1 1  ON 28
 eO_9                -6.833358e-02 1 1  ON 29
eH1_0                -2.362302e-01 1 1  ON 30
eH1_1                -1.368991e-01 1 1  ON 31
eH1_2                -9.137820e-02 1 1  ON 32
eH1_3                -3.798118e-02 1 1  ON 33
eH1_4                 8.899424e-03 1 1  ON 34
eH1_5                 4.250237e-02 1 1  ON 35
eH1_6                 9.881536e-02 1 1  ON 36
eH1_7                 1.478832e-01 1 1  ON 37
eH1_8                 1.618590e-01 1 1  ON 38
eH1_9                 4.686021e-02 1 1  ON 39
eH2_0                -2.329661e-01 1 1  ON 40
eH2_1                -1.337633e-01 1 1  ON 41
eH2_2                -8.815040e-02 1 1  ON 42
eH2_3                -3.494105e-02 1 1  ON 43
eH2_4                 1.228340e-02 1 1  ON 44
eH2_5                 4.599475e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496314e-01 1 1  ON 47
eH2_8                 1.671751e-01 1 1  ON 48
eH2_9                 3.091111e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.294425
====================================================
  Execution time = 2.0326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336693910444
                                         uncertainty =       0.005811122022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336693910444
                                         uncertainty =       0.005811122022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410328473
  error estimate for blocks of size 2^( 2) =       0.000423587099
  error estimate for blocks of size 2^( 3) =       0.000437380816
  error estimate for blocks of size 2^( 4) =       0.000450156793
  error estimate for blocks of size 2^( 5) =       0.000462164222
  error estimate for blocks of size 2^( 6) =       0.000469097872
  error estimate for blocks of size 2^( 7) =       0.000475142679

      target function =                  N/A
              le_mean =     -16.905462005017
             les_mean =     286.131384345641
             stat err =       0.000464140392
             autocorr =       1.279485655159
              std dev =       0.580292091064
             le_variance =       0.336738910951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336697960223
                                         uncertainty =       0.005811132365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336697960223
                                         uncertainty =       0.005811132365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410330940
  error estimate for blocks of size 2^( 2) =       0.000423589434
  error estimate for blocks of size 2^( 3) =       0.000437383012
  error estimate for blocks of size 2^( 4) =       0.000450158900
  error estimate for blocks of size 2^( 5) =       0.000462166319
  error estimate for blocks of size 2^( 6) =       0.000469099950
  error estimate for blocks of size 2^( 7) =       0.000475144825

      target function =                  N/A
              le_mean =     -16.905461982825
             les_mean =     286.131387645625
             stat err =       0.000464142499
             autocorr =       1.279481882029
              std dev =       0.580295580948
             le_variance =       0.336742961268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336695943759
                                         uncertainty =       0.005811127256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336695943759
                                         uncertainty =       0.005811127256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329712
  error estimate for blocks of size 2^( 2) =       0.000423588271
  error estimate for blocks of size 2^( 3) =       0.000437381918
  error estimate for blocks of size 2^( 4) =       0.000450157851
  error estimate for blocks of size 2^( 5) =       0.000462165275
  error estimate for blocks of size 2^( 6) =       0.000469098916
  error estimate for blocks of size 2^( 7) =       0.000475143756

      target function =                  N/A
              le_mean =     -16.905461993834
             les_mean =     286.131386001133
             stat err =       0.000464141450
             autocorr =       1.279483761712
              std dev =       0.580293843269
             le_variance =       0.336740944536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336694164867
                                         uncertainty =       0.005811122678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336694164867
                                         uncertainty =       0.005811122678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410328628
  error estimate for blocks of size 2^( 2) =       0.000423587246
  error estimate for blocks of size 2^( 3) =       0.000437380954
  error estimate for blocks of size 2^( 4) =       0.000450156926
  error estimate for blocks of size 2^( 5) =       0.000462164354
  error estimate for blocks of size 2^( 6) =       0.000469098003
  error estimate for blocks of size 2^( 7) =       0.000475142813

      target function =                  N/A
              le_mean =     -16.905462003615
             les_mean =     286.131384552720
             stat err =       0.000464140524
             autocorr =       1.279485418261
              std dev =       0.580292310313
             le_variance =       0.336739165408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905462005017        initial  <--
     6.2500e+01     6.2500e+02             4.9485e-06       -16.905461982825
     2.5000e+02     2.5000e+03             1.2416e-06       -16.905461993834
     1.0000e+03     1.0000e+04             3.1068e-07       -16.905462003615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8522
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.17022
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335567413044
                                         uncertainty =       0.004122413892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335567413044
                                         uncertainty =       0.004122413892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409722205
  error estimate for blocks of size 2^( 2) =       0.000423030491
  error estimate for blocks of size 2^( 3) =       0.000436629930
  error estimate for blocks of size 2^( 4) =       0.000448594673
  error estimate for blocks of size 2^( 5) =       0.000459686207
  error estimate for blocks of size 2^( 6) =       0.000468075238
  error estimate for blocks of size 2^( 7) =       0.000474744052

      target function =                  N/A
              le_mean =     -16.905064211931
             les_mean =     286.116940412299
             stat err =       0.000462775043
             autocorr =       1.275736132175
              std dev =       0.579434699220
             le_variance =       0.335744570660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690506421193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905064211931       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905064212424       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905064212324       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905064212385       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905064211519       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905064211673       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905064212263       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905064211985       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.358706e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905064211931       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905064212054       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905064212029       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905064212044       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905064211828       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905064211866       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905064212014       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905064211947       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.089690e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905064211931       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905064211962       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905064211956       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905064211959       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905064211907       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905064211907       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905064211948       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905064211948       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 2.724234e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6123e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068480e-02 1 1  ON 2
 uu_3                -2.080716e-02 1 1  ON 3
 uu_4                -6.473431e-02 1 1  ON 4
 uu_5                -9.793579e-02 1 1  ON 5
 uu_6                -1.234359e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288474e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456882e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927746e-02 1 1  ON 12
 ud_3                -1.165629e-02 1 1  ON 13
 ud_4                -6.783082e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495929e-01 1 1  ON 17
 ud_8                -1.492242e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383758e-01 1 1  ON 21
 eO_2                -1.685558e-02 1 1  ON 22
 eO_3                 3.022899e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756441e-01 1 1  ON 25
 eO_6                 2.443874e-01 1 1  ON 26
 eO_7                -5.235251e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833305e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368990e-01 1 1  ON 31
eH1_2                -9.137787e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899473e-03 1 1  ON 34
eH1_5                 4.250214e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618587e-01 1 1  ON 38
eH1_9                 4.685989e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814997e-02 1 1  ON 42
eH2_3                -3.494030e-02 1 1  ON 43
eH2_4                 1.228325e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091030e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9519
    reference variance = 0.220122
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3786e-01
  Total weights = 2.0000e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337750996304
                                         uncertainty =       0.003680535329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337750996304
                                         uncertainty =       0.003680535329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411009848
  error estimate for blocks of size 2^( 2) =       0.000423800252
  error estimate for blocks of size 2^( 3) =       0.000437456245
  error estimate for blocks of size 2^( 4) =       0.000449975261
  error estimate for blocks of size 2^( 5) =       0.000460887909
  error estimate for blocks of size 2^( 6) =       0.000468140981
  error estimate for blocks of size 2^( 7) =       0.000471918129

      target function =                  N/A
              le_mean =     -16.905999443300
             les_mean =     286.150675198233
             stat err =       0.000462730570
             autocorr =       1.267511558742
              std dev =       0.581255701317
             le_variance =       0.337858190313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751325357
                                         uncertainty =       0.003680539907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751325357
                                         uncertainty =       0.003680539907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411010048
  error estimate for blocks of size 2^( 2) =       0.000423800442
  error estimate for blocks of size 2^( 3) =       0.000437456425
  error estimate for blocks of size 2^( 4) =       0.000449975436
  error estimate for blocks of size 2^( 5) =       0.000460888079
  error estimate for blocks of size 2^( 6) =       0.000468141149
  error estimate for blocks of size 2^( 7) =       0.000471918287

      target function =                  N/A
              le_mean =     -16.905999442889
             les_mean =     286.150675513546
             stat err =       0.000462730738
             autocorr =       1.267511241843
              std dev =       0.581255984494
             le_variance =       0.337858519510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751160890
                                         uncertainty =       0.003680537619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751160890
                                         uncertainty =       0.003680537619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411009948
  error estimate for blocks of size 2^( 2) =       0.000423800347
  error estimate for blocks of size 2^( 3) =       0.000437456335
  error estimate for blocks of size 2^( 4) =       0.000449975349
  error estimate for blocks of size 2^( 5) =       0.000460887994
  error estimate for blocks of size 2^( 6) =       0.000468141065
  error estimate for blocks of size 2^( 7) =       0.000471918208

      target function =                  N/A
              le_mean =     -16.905999443095
             les_mean =     286.150675355954
             stat err =       0.000462730654
             autocorr =       1.267511400240
              std dev =       0.581255842956
             le_variance =       0.337858354971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751016879
                                         uncertainty =       0.003680535615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337751016879
                                         uncertainty =       0.003680535615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411009861
  error estimate for blocks of size 2^( 2) =       0.000423800263
  error estimate for blocks of size 2^( 3) =       0.000437456256
  error estimate for blocks of size 2^( 4) =       0.000449975272
  error estimate for blocks of size 2^( 5) =       0.000460887920
  error estimate for blocks of size 2^( 6) =       0.000468140992
  error estimate for blocks of size 2^( 7) =       0.000471918139

      target function =                  N/A
              le_mean =     -16.905999443274
             les_mean =     286.150675217950
             stat err =       0.000462730581
             autocorr =       1.267511538924
              std dev =       0.581255719023
             le_variance =       0.337858210897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905999443300        initial  <--
     6.2500e+02     6.2500e+03             4.3587e-07       -16.905999442889
     2.5000e+03     2.5000e+04             1.0897e-07       -16.905999443095
     1.0000e+04     1.0000e+05             2.7242e-08       -16.905999443274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8409
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080712e-02 1 1  ON 3
 uu_4                -6.473430e-02 1 1  ON 4
 uu_5                -9.793578e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137784e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250223e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618585e-01 1 1  ON 38
eH1_9                 4.685979e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228328e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.283321
====================================================
  Execution time = 2.0654e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335534972955
                                         uncertainty =       0.003502059516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335534972955
                                         uncertainty =       0.003502059516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409662315
  error estimate for blocks of size 2^( 2) =       0.000422551603
  error estimate for blocks of size 2^( 3) =       0.000436092569
  error estimate for blocks of size 2^( 4) =       0.000448022828
  error estimate for blocks of size 2^( 5) =       0.000458942839
  error estimate for blocks of size 2^( 6) =       0.000468090900
  error estimate for blocks of size 2^( 7) =       0.000474007514

      target function =                  N/A
              le_mean =     -16.905979901933
             les_mean =     286.147802702189
             stat err =       0.000462266020
             autocorr =       1.273303435651
              std dev =       0.579350002541
             le_variance =       0.335646425445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597990193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979901933       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979901992       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905979901998       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905979902032       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905979902071       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905979902130       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905979902149       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905979902135       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.606240e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979901933       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979901948       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905979901949       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905979901970       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905979901971       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905979901994       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905979901993       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905979901978       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.151601e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979901933       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979901937       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905979901937       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905979901914       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905979901942       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905979901959       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905979901946       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905979901906       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 2.879027e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139659 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6207e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068476e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825878e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165625e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235254e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833301e-02 1 1  ON 29
eH1_0                -2.362295e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250222e-02 1 1  ON 35
eH1_6                 9.881534e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685980e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814994e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228327e-02 1 1  ON 44
eH2_5                 4.599479e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671743e-01 1 1  ON 48
eH2_9                 3.091022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.240331
====================================================
  Execution time = 2.0496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4050e-01
  Total weights = 2.0000e+06
  Execution time = 1.8842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532721893
                                         uncertainty =       0.003830810060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532721893
                                         uncertainty =       0.003830810060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412611621
  error estimate for blocks of size 2^( 2) =       0.000425508695
  error estimate for blocks of size 2^( 3) =       0.000438469178
  error estimate for blocks of size 2^( 4) =       0.000450858963
  error estimate for blocks of size 2^( 5) =       0.000461777212
  error estimate for blocks of size 2^( 6) =       0.000469239041
  error estimate for blocks of size 2^( 7) =       0.000473045376

      target function =                  N/A
              le_mean =     -16.905108393802
             les_mean =     286.123186335967
             stat err =       0.000463730148
             autocorr =       1.263129129370
              std dev =       0.583520950789
             le_variance =       0.340496700009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532756279
                                         uncertainty =       0.003830810598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532756279
                                         uncertainty =       0.003830810598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412611642
  error estimate for blocks of size 2^( 2) =       0.000425508715
  error estimate for blocks of size 2^( 3) =       0.000438469197
  error estimate for blocks of size 2^( 4) =       0.000450858981
  error estimate for blocks of size 2^( 5) =       0.000461777229
  error estimate for blocks of size 2^( 6) =       0.000469239058
  error estimate for blocks of size 2^( 7) =       0.000473045392

      target function =                  N/A
              le_mean =     -16.905108393895
             les_mean =     286.123186373488
             stat err =       0.000463730165
             autocorr =       1.263129093863
              std dev =       0.583520980249
             le_variance =       0.340496734391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532739087
                                         uncertainty =       0.003830810329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532739087
                                         uncertainty =       0.003830810329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412611632
  error estimate for blocks of size 2^( 2) =       0.000425508705
  error estimate for blocks of size 2^( 3) =       0.000438469188
  error estimate for blocks of size 2^( 4) =       0.000450858972
  error estimate for blocks of size 2^( 5) =       0.000461777221
  error estimate for blocks of size 2^( 6) =       0.000469239049
  error estimate for blocks of size 2^( 7) =       0.000473045384

      target function =                  N/A
              le_mean =     -16.905108393849
             les_mean =     286.123186354728
             stat err =       0.000463730156
             autocorr =       1.263129111620
              std dev =       0.583520965520
             le_variance =       0.340496717201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532724042
                                         uncertainty =       0.003830810094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340532724042
                                         uncertainty =       0.003830810094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412611623
  error estimate for blocks of size 2^( 2) =       0.000425508696
  error estimate for blocks of size 2^( 3) =       0.000438469180
  error estimate for blocks of size 2^( 4) =       0.000450858964
  error estimate for blocks of size 2^( 5) =       0.000461777213
  error estimate for blocks of size 2^( 6) =       0.000469239042
  error estimate for blocks of size 2^( 7) =       0.000473045377

      target function =                  N/A
              le_mean =     -16.905108393808
             les_mean =     286.123186338312
             stat err =       0.000463730149
             autocorr =       1.263129127150
              std dev =       0.583520952630
             le_variance =       0.340496702158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905108393802        initial
     6.2500e+03     6.2500e+04             4.6062e-08       -16.905108393895  <--
     2.5000e+04     2.5000e+05             1.1516e-08       -16.905108393849
     1.0000e+05     1.0000e+06             2.8790e-09       -16.905108393808

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 3.3368e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.187322
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3960e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392772639
                                         uncertainty =       0.003401599526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392772639
                                         uncertainty =       0.003401599526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412067553
  error estimate for blocks of size 2^( 2) =       0.000425183167
  error estimate for blocks of size 2^( 3) =       0.000438321241
  error estimate for blocks of size 2^( 4) =       0.000451373078
  error estimate for blocks of size 2^( 5) =       0.000461894717
  error estimate for blocks of size 2^( 6) =       0.000470902449
  error estimate for blocks of size 2^( 7) =       0.000477371507

      target function =                  N/A
              le_mean =     -16.905643208208
             les_mean =     286.140371449992
             stat err =       0.000465385438
             autocorr =       1.275524316083
              std dev =       0.582751522143
             le_variance =       0.339599336560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564320821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643208208       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905643208576       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905643208517       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905643208487       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905643208725       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905643208448       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905643208613       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.572700e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643208208       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905643208300       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905643208285       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905643208278       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905643208337       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905643208268       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905643208312       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.931885e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643208208       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905643208231       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905643208227       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905643208226       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905643208232       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905643208218       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905643208192       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 9.829798e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9682e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068478e-02 1 1  ON 2
 uu_3                -2.080715e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234359e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495929e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756441e-01 1 1  ON 25
 eO_6                 2.443874e-01 1 1  ON 26
 eO_7                -5.235252e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833305e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368990e-01 1 1  ON 31
eH1_2                -9.137786e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899470e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881535e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685985e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814996e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228325e-02 1 1  ON 44
eH2_5                 4.599477e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091028e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9716
    reference variance = 0.314063
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3603e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948359743
                                         uncertainty =       0.003036597095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948359743
                                         uncertainty =       0.003036597095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894747
  error estimate for blocks of size 2^( 2) =       0.000422794688
  error estimate for blocks of size 2^( 3) =       0.000436204035
  error estimate for blocks of size 2^( 4) =       0.000448147336
  error estimate for blocks of size 2^( 5) =       0.000459300093
  error estimate for blocks of size 2^( 6) =       0.000468652930
  error estimate for blocks of size 2^( 7) =       0.000472921275

      target function =                  N/A
              le_mean =     -16.906193996789
             les_mean =     286.155422695691
             stat err =       0.000462255409
             autocorr =       1.271801397708
              std dev =       0.579678709852
             le_variance =       0.336027406656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948390058
                                         uncertainty =       0.003036597254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948390058
                                         uncertainty =       0.003036597254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894765
  error estimate for blocks of size 2^( 2) =       0.000422794705
  error estimate for blocks of size 2^( 3) =       0.000436204049
  error estimate for blocks of size 2^( 4) =       0.000448147348
  error estimate for blocks of size 2^( 5) =       0.000459300104
  error estimate for blocks of size 2^( 6) =       0.000468652942
  error estimate for blocks of size 2^( 7) =       0.000472921286

      target function =                  N/A
              le_mean =     -16.906193996278
             les_mean =     286.155422708696
             stat err =       0.000462255420
             autocorr =       1.271801346924
              std dev =       0.579678735965
             le_variance =       0.336027436930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948374899
                                         uncertainty =       0.003036597174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948374899
                                         uncertainty =       0.003036597174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894756
  error estimate for blocks of size 2^( 2) =       0.000422794696
  error estimate for blocks of size 2^( 3) =       0.000436204042
  error estimate for blocks of size 2^( 4) =       0.000448147342
  error estimate for blocks of size 2^( 5) =       0.000459300099
  error estimate for blocks of size 2^( 6) =       0.000468652936
  error estimate for blocks of size 2^( 7) =       0.000472921280

      target function =                  N/A
              le_mean =     -16.906193996533
             les_mean =     286.155422702190
             stat err =       0.000462255414
             autocorr =       1.271801372323
              std dev =       0.579678722908
             le_variance =       0.336027421792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948361638
                                         uncertainty =       0.003036597105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948361638
                                         uncertainty =       0.003036597105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894748
  error estimate for blocks of size 2^( 2) =       0.000422794689
  error estimate for blocks of size 2^( 3) =       0.000436204036
  error estimate for blocks of size 2^( 4) =       0.000448147337
  error estimate for blocks of size 2^( 5) =       0.000459300094
  error estimate for blocks of size 2^( 6) =       0.000468652931
  error estimate for blocks of size 2^( 7) =       0.000472921275

      target function =                  N/A
              le_mean =     -16.906193996757
             les_mean =     286.155422696503
             stat err =       0.000462255409
             autocorr =       1.271801394538
              std dev =       0.579678711484
             le_variance =       0.336027408548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906193996789        initial  <--
     1.5625e+03     1.5625e+04             1.5727e-07       -16.906193996278
     6.2500e+03     6.2500e+04             3.9319e-08       -16.906193996533
     2.5000e+04     2.5000e+05             9.8298e-09       -16.906193996757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9911
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8808
    reference variance = 0.223807
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3464e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334668370106
                                         uncertainty =       0.003766585572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334668370106
                                         uncertainty =       0.003766585572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409046637
  error estimate for blocks of size 2^( 2) =       0.000422024282
  error estimate for blocks of size 2^( 3) =       0.000436169351
  error estimate for blocks of size 2^( 4) =       0.000448796729
  error estimate for blocks of size 2^( 5) =       0.000459774072
  error estimate for blocks of size 2^( 6) =       0.000469881452
  error estimate for blocks of size 2^( 7) =       0.000477771277

      target function =                  N/A
              le_mean =     -16.905686718369
             les_mean =     286.136881555356
             stat err =       0.000464055882
             autocorr =       1.287048494588
              std dev =       0.578479302164
             le_variance =       0.334638303032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568671837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686718369       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686718409       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686718433       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686718486       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686718527       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686718516       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686718516       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686718510       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.574323e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686718369       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686718379       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686718385       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686718399       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686718423       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686718446       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686718399       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686718357       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 3.935813e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686718369       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686718372       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686718373       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686718376       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686718443       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686718534       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686717691       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686717659       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 9.839529e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6231e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080714e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899477e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494032e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9475
    reference variance = 0.187907
====================================================
  Execution time = 2.0167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4591e-01
  Total weights = 2.0000e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968405753
                                         uncertainty =       0.004030305989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968405753
                                         uncertainty =       0.004030305989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415879078
  error estimate for blocks of size 2^( 2) =       0.000428659876
  error estimate for blocks of size 2^( 3) =       0.000442535565
  error estimate for blocks of size 2^( 4) =       0.000455436965
  error estimate for blocks of size 2^( 5) =       0.000467581631
  error estimate for blocks of size 2^( 6) =       0.000475782573
  error estimate for blocks of size 2^( 7) =       0.000482599010

      target function =                  N/A
              le_mean =     -16.905483927591
             les_mean =     286.141297468595
             stat err =       0.000470350045
             autocorr =       1.279110999103
              std dev =       0.588141832808
             le_variance =       0.345910815499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968410491
                                         uncertainty =       0.004030306009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968410491
                                         uncertainty =       0.004030306009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415879081
  error estimate for blocks of size 2^( 2) =       0.000428659879
  error estimate for blocks of size 2^( 3) =       0.000442535567
  error estimate for blocks of size 2^( 4) =       0.000455436967
  error estimate for blocks of size 2^( 5) =       0.000467581633
  error estimate for blocks of size 2^( 6) =       0.000475782575
  error estimate for blocks of size 2^( 7) =       0.000482599012

      target function =                  N/A
              le_mean =     -16.905483927577
             les_mean =     286.141297472845
             stat err =       0.000470350047
             autocorr =       1.279110992857
              std dev =       0.588141836834
             le_variance =       0.345910820234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968408122
                                         uncertainty =       0.004030305999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968408122
                                         uncertainty =       0.004030305999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415879080
  error estimate for blocks of size 2^( 2) =       0.000428659877
  error estimate for blocks of size 2^( 3) =       0.000442535566
  error estimate for blocks of size 2^( 4) =       0.000455436966
  error estimate for blocks of size 2^( 5) =       0.000467581632
  error estimate for blocks of size 2^( 6) =       0.000475782574
  error estimate for blocks of size 2^( 7) =       0.000482599011

      target function =                  N/A
              le_mean =     -16.905483927584
             les_mean =     286.141297470720
             stat err =       0.000470350046
             autocorr =       1.279110995979
              std dev =       0.588141834821
             le_variance =       0.345910817866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968406049
                                         uncertainty =       0.004030305991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345968406049
                                         uncertainty =       0.004030305991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415879078
  error estimate for blocks of size 2^( 2) =       0.000428659876
  error estimate for blocks of size 2^( 3) =       0.000442535565
  error estimate for blocks of size 2^( 4) =       0.000455436965
  error estimate for blocks of size 2^( 5) =       0.000467581631
  error estimate for blocks of size 2^( 6) =       0.000475782573
  error estimate for blocks of size 2^( 7) =       0.000482599010

      target function =                  N/A
              le_mean =     -16.905483927590
             les_mean =     286.141297468860
             stat err =       0.000470350045
             autocorr =       1.279110998711
              std dev =       0.588141833060
             le_variance =       0.345910815795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905483927591        initial  <--
     1.5625e+04     1.5625e+05             1.5743e-08       -16.905483927577
     6.2500e+04     6.2500e+05             3.9358e-09       -16.905483927584
     2.5000e+05     2.5000e+06             9.8395e-10       -16.905483927590

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6903
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.226345
====================================================
  Execution time = 2.0426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3552e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454568471
                                         uncertainty =       0.003398716965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454568471
                                         uncertainty =       0.003398716965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409584249
  error estimate for blocks of size 2^( 2) =       0.000422553385
  error estimate for blocks of size 2^( 3) =       0.000435646618
  error estimate for blocks of size 2^( 4) =       0.000448006798
  error estimate for blocks of size 2^( 5) =       0.000459704112
  error estimate for blocks of size 2^( 6) =       0.000469067307
  error estimate for blocks of size 2^( 7) =       0.000472356430

      target function =                  N/A
              le_mean =     -16.905431865237
             les_mean =     286.129144896042
             stat err =       0.000462283662
             autocorr =       1.273886092762
              std dev =       0.579239599504
             le_variance =       0.335518513633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690543186524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905431865237       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905431865238       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905431865234       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905431865236       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905431865184       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905431865116       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431865338       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905431865241       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.032663e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905431865237       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905431865237       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905431865236       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905431865229       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905431864724       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905431865208       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431865413       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905431864751       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 5.081666e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905431865237       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905431865237       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905431865237       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905431865806       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905431866393       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905431865386       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431864875       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905431863880       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 1.270418e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5888e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337628e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.205602
====================================================
  Execution time = 2.0473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.0000e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730657953
                                         uncertainty =       0.006673322493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730657953
                                         uncertainty =       0.006673322493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411534492
  error estimate for blocks of size 2^( 2) =       0.000424456086
  error estimate for blocks of size 2^( 3) =       0.000437980783
  error estimate for blocks of size 2^( 4) =       0.000450543786
  error estimate for blocks of size 2^( 5) =       0.000461260432
  error estimate for blocks of size 2^( 6) =       0.000472535595
  error estimate for blocks of size 2^( 7) =       0.000477156732

      target function =                  N/A
              le_mean =     -16.904860433144
             les_mean =     286.113027370648
             stat err =       0.000465374136
             autocorr =       1.278768723041
              std dev =       0.581997659721
             le_variance =       0.338721275921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730659289
                                         uncertainty =       0.006673322538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730659289
                                         uncertainty =       0.006673322538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411534493
  error estimate for blocks of size 2^( 2) =       0.000424456087
  error estimate for blocks of size 2^( 3) =       0.000437980783
  error estimate for blocks of size 2^( 4) =       0.000450543787
  error estimate for blocks of size 2^( 5) =       0.000461260433
  error estimate for blocks of size 2^( 6) =       0.000472535595
  error estimate for blocks of size 2^( 7) =       0.000477156733

      target function =                  N/A
              le_mean =     -16.904860433147
             les_mean =     286.113027372071
             stat err =       0.000465374137
             autocorr =       1.278768721585
              std dev =       0.581997660870
             le_variance =       0.338721277258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730658621
                                         uncertainty =       0.006673322516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730658621
                                         uncertainty =       0.006673322516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411534492
  error estimate for blocks of size 2^( 2) =       0.000424456086
  error estimate for blocks of size 2^( 3) =       0.000437980783
  error estimate for blocks of size 2^( 4) =       0.000450543786
  error estimate for blocks of size 2^( 5) =       0.000461260432
  error estimate for blocks of size 2^( 6) =       0.000472535595
  error estimate for blocks of size 2^( 7) =       0.000477156733

      target function =                  N/A
              le_mean =     -16.904860433146
             les_mean =     286.113027371359
             stat err =       0.000465374137
             autocorr =       1.278768722311
              std dev =       0.581997660296
             le_variance =       0.338721276590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730658037
                                         uncertainty =       0.006673322496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730658037
                                         uncertainty =       0.006673322496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411534492
  error estimate for blocks of size 2^( 2) =       0.000424456086
  error estimate for blocks of size 2^( 3) =       0.000437980783
  error estimate for blocks of size 2^( 4) =       0.000450543786
  error estimate for blocks of size 2^( 5) =       0.000461260432
  error estimate for blocks of size 2^( 6) =       0.000472535595
  error estimate for blocks of size 2^( 7) =       0.000477156732

      target function =                  N/A
              le_mean =     -16.904860433144
             les_mean =     286.113027370736
             stat err =       0.000465374136
             autocorr =       1.278768722953
              std dev =       0.581997659793
             le_variance =       0.338721276005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904860433144        initial
     1.5625e+05     1.5625e+06             2.0327e-09       -16.904860433147  <--
     6.2500e+05     6.2500e+06             5.0817e-10       -16.904860433146
     2.5000e+06     2.5000e+07             1.2704e-10       -16.904860433144

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 2.9884e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9653
    reference variance = 0.647636
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337748969463
                                         uncertainty =       0.003485478785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337748969463
                                         uncertainty =       0.003485478785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410916924
  error estimate for blocks of size 2^( 2) =       0.000423919017
  error estimate for blocks of size 2^( 3) =       0.000436915095
  error estimate for blocks of size 2^( 4) =       0.000449218648
  error estimate for blocks of size 2^( 5) =       0.000459134465
  error estimate for blocks of size 2^( 6) =       0.000465777657
  error estimate for blocks of size 2^( 7) =       0.000470914360

      target function =                  N/A
              le_mean =     -16.905203548141
             les_mean =     286.123612272125
             stat err =       0.000461261283
             autocorr =       1.260044687638
              std dev =       0.581124286976
             le_variance =       0.337705436914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520354814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905203548141       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905203548147       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905203548144       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905203548158       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905203548134       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905203548132       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905203548146       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905203548160       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 8.674994e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905203548141       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905203548142       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905203548141       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905203548016       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905203548150       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905203548136       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905203548095       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905203547999       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.168757e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905203548141       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905203548141       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905203548141       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905203548142       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905203548387       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905203548490       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905203547254       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905203548516       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 5.421899e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6119e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8838
    reference variance = 0.245969
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4795e-01
  Total weights = 2.0000e+06
  Execution time = 1.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978193309
                                         uncertainty =       0.005797902647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978193309
                                         uncertainty =       0.005797902647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417104672
  error estimate for blocks of size 2^( 2) =       0.000429565119
  error estimate for blocks of size 2^( 3) =       0.000442837135
  error estimate for blocks of size 2^( 4) =       0.000455641891
  error estimate for blocks of size 2^( 5) =       0.000467057094
  error estimate for blocks of size 2^( 6) =       0.000475544470
  error estimate for blocks of size 2^( 7) =       0.000479186662

      target function =                  N/A
              le_mean =     -16.905942203839
             les_mean =     286.158834240841
             stat err =       0.000469357529
             autocorr =       1.266244198462
              std dev =       0.589875084466
             le_variance =       0.347952615273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978198118
                                         uncertainty =       0.005797902802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978198118
                                         uncertainty =       0.005797902802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417104675
  error estimate for blocks of size 2^( 2) =       0.000429565122
  error estimate for blocks of size 2^( 3) =       0.000442837137
  error estimate for blocks of size 2^( 4) =       0.000455641893
  error estimate for blocks of size 2^( 5) =       0.000467057096
  error estimate for blocks of size 2^( 6) =       0.000475544472
  error estimate for blocks of size 2^( 7) =       0.000479186665

      target function =                  N/A
              le_mean =     -16.905942203807
             les_mean =     286.158834244569
             stat err =       0.000469357532
             autocorr =       1.266244194276
              std dev =       0.589875088542
             le_variance =       0.347952620083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978195713
                                         uncertainty =       0.005797902724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978195713
                                         uncertainty =       0.005797902724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417104674
  error estimate for blocks of size 2^( 2) =       0.000429565121
  error estimate for blocks of size 2^( 3) =       0.000442837136
  error estimate for blocks of size 2^( 4) =       0.000455641892
  error estimate for blocks of size 2^( 5) =       0.000467057095
  error estimate for blocks of size 2^( 6) =       0.000475544471
  error estimate for blocks of size 2^( 7) =       0.000479186664

      target function =                  N/A
              le_mean =     -16.905942203823
             les_mean =     286.158834242705
             stat err =       0.000469357530
             autocorr =       1.266244196365
              std dev =       0.589875086504
             le_variance =       0.347952617678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978193609
                                         uncertainty =       0.005797902656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347978193609
                                         uncertainty =       0.005797902656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417104672
  error estimate for blocks of size 2^( 2) =       0.000429565119
  error estimate for blocks of size 2^( 3) =       0.000442837135
  error estimate for blocks of size 2^( 4) =       0.000455641891
  error estimate for blocks of size 2^( 5) =       0.000467057094
  error estimate for blocks of size 2^( 6) =       0.000475544470
  error estimate for blocks of size 2^( 7) =       0.000479186663

      target function =                  N/A
              le_mean =     -16.905942203837
             les_mean =     286.158834241074
             stat err =       0.000469357529
             autocorr =       1.266244198198
              std dev =       0.589875084720
             le_variance =       0.347952615574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905942203839        initial  <--
     3.9062e+04     3.9062e+05             8.6750e-09       -16.905942203807
     1.5625e+05     1.5625e+06             2.1688e-09       -16.905942203823
     6.2500e+05     6.2500e+06             5.4219e-10       -16.905942203837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9297
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.189502
====================================================
  Execution time = 2.0981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3609e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335933052366
                                         uncertainty =       0.003871629750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335933052366
                                         uncertainty =       0.003871629750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409934706
  error estimate for blocks of size 2^( 2) =       0.000423185490
  error estimate for blocks of size 2^( 3) =       0.000437295697
  error estimate for blocks of size 2^( 4) =       0.000451347971
  error estimate for blocks of size 2^( 5) =       0.000463670163
  error estimate for blocks of size 2^( 6) =       0.000472749651
  error estimate for blocks of size 2^( 7) =       0.000478814919

      target function =                  N/A
              le_mean =     -16.905209874471
             les_mean =     286.122213657449
             stat err =       0.000466645676
             autocorr =       1.295821306197
              std dev =       0.579735220243
             le_variance =       0.336092925590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520987447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209874471       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905209874471       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905209874473       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905209874472       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905209874324       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905209874432       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905209874312       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905209874544       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 8.974129e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209874471       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905209874471       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905209874471       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905209874471       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905209874825       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905209874210       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905209874420       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905209874156       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.243533e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209874471       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905209874471       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905209874471       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905209874471       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905209874297       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905209876083       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905209870041       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905209871204       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 5.608799e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6441e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.360025
====================================================
  Execution time = 1.9978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919716
                                         uncertainty =       0.004518059456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919716
                                         uncertainty =       0.004518059456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500680
  error estimate for blocks of size 2^( 2) =       0.000424100881
  error estimate for blocks of size 2^( 3) =       0.000437064209
  error estimate for blocks of size 2^( 4) =       0.000449029321
  error estimate for blocks of size 2^( 5) =       0.000458804415
  error estimate for blocks of size 2^( 6) =       0.000466219505
  error estimate for blocks of size 2^( 7) =       0.000469647815

      target function =                  N/A
              le_mean =     -16.905204941031
             les_mean =     286.124619548826
             stat err =       0.000460925264
             autocorr =       1.254642256863
              std dev =       0.581949843103
             le_variance =       0.338665619888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661920265
                                         uncertainty =       0.004518059463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661920265
                                         uncertainty =       0.004518059463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500681
  error estimate for blocks of size 2^( 2) =       0.000424100882
  error estimate for blocks of size 2^( 3) =       0.000437064210
  error estimate for blocks of size 2^( 4) =       0.000449029322
  error estimate for blocks of size 2^( 5) =       0.000458804415
  error estimate for blocks of size 2^( 6) =       0.000466219505
  error estimate for blocks of size 2^( 7) =       0.000469647815

      target function =                  N/A
              le_mean =     -16.905204941031
             les_mean =     286.124619549358
             stat err =       0.000460925264
             autocorr =       1.254642256301
              std dev =       0.581949843575
             le_variance =       0.338665620437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919990
                                         uncertainty =       0.004518059459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919990
                                         uncertainty =       0.004518059459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500681
  error estimate for blocks of size 2^( 2) =       0.000424100881
  error estimate for blocks of size 2^( 3) =       0.000437064210
  error estimate for blocks of size 2^( 4) =       0.000449029321
  error estimate for blocks of size 2^( 5) =       0.000458804415
  error estimate for blocks of size 2^( 6) =       0.000466219505
  error estimate for blocks of size 2^( 7) =       0.000469647815

      target function =                  N/A
              le_mean =     -16.905204941031
             les_mean =     286.124619549092
             stat err =       0.000460925264
             autocorr =       1.254642256578
              std dev =       0.581949843339
             le_variance =       0.338665620162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919750
                                         uncertainty =       0.004518059456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338661919750
                                         uncertainty =       0.004518059456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500680
  error estimate for blocks of size 2^( 2) =       0.000424100881
  error estimate for blocks of size 2^( 3) =       0.000437064210
  error estimate for blocks of size 2^( 4) =       0.000449029321
  error estimate for blocks of size 2^( 5) =       0.000458804415
  error estimate for blocks of size 2^( 6) =       0.000466219505
  error estimate for blocks of size 2^( 7) =       0.000469647815

      target function =                  N/A
              le_mean =     -16.905204941031
             les_mean =     286.124619548859
             stat err =       0.000460925264
             autocorr =       1.254642256820
              std dev =       0.581949843133
             le_variance =       0.338665619922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905204941031        initial  <--
     3.9062e+05     3.9062e+06             8.9741e-10       -16.905204941031
     1.5625e+06     1.5625e+07             2.2435e-10       -16.905204941031
     6.2500e+06     6.2500e+07             5.6088e-11       -16.905204941031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3750
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0531
    reference variance = 2.51141
====================================================
  Execution time = 2.2417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3803e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895944200
                                         uncertainty =       0.003318352225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895944200
                                         uncertainty =       0.003318352225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411116192
  error estimate for blocks of size 2^( 2) =       0.000423837313
  error estimate for blocks of size 2^( 3) =       0.000436893891
  error estimate for blocks of size 2^( 4) =       0.000447898712
  error estimate for blocks of size 2^( 5) =       0.000457576144
  error estimate for blocks of size 2^( 6) =       0.000464499025
  error estimate for blocks of size 2^( 7) =       0.000467444834

      target function =                  N/A
              le_mean =     -16.906179891364
             les_mean =     286.156951397269
             stat err =       0.000459354679
             autocorr =       1.248438416542
              std dev =       0.581406094849
             le_variance =       0.338033047128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617989136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179891364       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179891364       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179891365       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906179891365       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906179891205       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906179893746       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906179886393       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906179891768       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.606049e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179891364       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179891364       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179891364       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906179891364       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906179891628       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906179868091       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906179894191       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906179887246       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.651492e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179891364       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179891364       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179891364       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906179891935       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906179929801       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906179902001       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906179666616       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906179855610       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.128249e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7934e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0422
    reference variance = 1.2797
====================================================
  Execution time = 2.2198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4812e-01
  Total weights = 2.0000e+06
  Execution time = 1.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350816
                                         uncertainty =       0.008057698689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350816
                                         uncertainty =       0.008057698689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417206404
  error estimate for blocks of size 2^( 2) =       0.000430005380
  error estimate for blocks of size 2^( 3) =       0.000442851146
  error estimate for blocks of size 2^( 4) =       0.000455163738
  error estimate for blocks of size 2^( 5) =       0.000465111961
  error estimate for blocks of size 2^( 6) =       0.000472668762
  error estimate for blocks of size 2^( 7) =       0.000476904375

      target function =                  N/A
              le_mean =     -16.906735865663
             les_mean =     286.185839823795
             stat err =       0.000467462209
             autocorr =       1.255425893956
              std dev =       0.590018954404
             le_variance =       0.348122366556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350825
                                         uncertainty =       0.008057698688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350825
                                         uncertainty =       0.008057698688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417206404
  error estimate for blocks of size 2^( 2) =       0.000430005380
  error estimate for blocks of size 2^( 3) =       0.000442851146
  error estimate for blocks of size 2^( 4) =       0.000455163738
  error estimate for blocks of size 2^( 5) =       0.000465111961
  error estimate for blocks of size 2^( 6) =       0.000472668762
  error estimate for blocks of size 2^( 7) =       0.000476904375

      target function =                  N/A
              le_mean =     -16.906735865663
             les_mean =     286.185839823807
             stat err =       0.000467462209
             autocorr =       1.255425893925
              std dev =       0.590018954412
             le_variance =       0.348122366566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350820
                                         uncertainty =       0.008057698688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350820
                                         uncertainty =       0.008057698688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417206404
  error estimate for blocks of size 2^( 2) =       0.000430005380
  error estimate for blocks of size 2^( 3) =       0.000442851146
  error estimate for blocks of size 2^( 4) =       0.000455163738
  error estimate for blocks of size 2^( 5) =       0.000465111961
  error estimate for blocks of size 2^( 6) =       0.000472668762
  error estimate for blocks of size 2^( 7) =       0.000476904375

      target function =                  N/A
              le_mean =     -16.906735865663
             les_mean =     286.185839823801
             stat err =       0.000467462209
             autocorr =       1.255425893939
              std dev =       0.590018954408
             le_variance =       0.348122366561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350816
                                         uncertainty =       0.008057698689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347875350816
                                         uncertainty =       0.008057698689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417206404
  error estimate for blocks of size 2^( 2) =       0.000430005380
  error estimate for blocks of size 2^( 3) =       0.000442851146
  error estimate for blocks of size 2^( 4) =       0.000455163738
  error estimate for blocks of size 2^( 5) =       0.000465111961
  error estimate for blocks of size 2^( 6) =       0.000472668762
  error estimate for blocks of size 2^( 7) =       0.000476904375

      target function =                  N/A
              le_mean =     -16.906735865663
             les_mean =     286.185839823796
             stat err =       0.000467462209
             autocorr =       1.255425893951
              std dev =       0.590018954405
             le_variance =       0.348122366557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906735865663        initial
     3.9062e+06     3.9062e+07             6.6060e-11       -16.906735865663  <--
     1.5625e+07     1.5625e+08             1.6515e-11       -16.906735865663
     6.2500e+07     6.2500e+08             4.1282e-12       -16.906735865663

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 3.1571e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.134391
====================================================
  Execution time = 2.0563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3710e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096605058
                                         uncertainty =       0.003346742634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096605058
                                         uncertainty =       0.003346742634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410549793
  error estimate for blocks of size 2^( 2) =       0.000423497003
  error estimate for blocks of size 2^( 3) =       0.000437473979
  error estimate for blocks of size 2^( 4) =       0.000449962167
  error estimate for blocks of size 2^( 5) =       0.000461902389
  error estimate for blocks of size 2^( 6) =       0.000469448339
  error estimate for blocks of size 2^( 7) =       0.000474100985

      target function =                  N/A
              le_mean =     -16.905267333467
             les_mean =     286.125165712336
             stat err =       0.000463853470
             autocorr =       1.276526822287
              std dev =       0.580605085162
             le_variance =       0.337102264916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690526733347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905267333467       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905267333467       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905267333468       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905267333631       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267333288       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905267333664       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905267333315       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905267333193       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.050073e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905267333467       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905267333467       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905267333467       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905267333567       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267335468       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905267334617       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905267333000       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905267333654       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.625193e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905267333467       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905267333467       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905267333467       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905267345052       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267339545       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905267342377       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905267330804       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905267335500       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.906314e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6113e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9795
    reference variance = 0.450596
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4166e-01
  Total weights = 2.0000e+06
  Execution time = 1.8545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854507
                                         uncertainty =       0.006458443781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854507
                                         uncertainty =       0.006458443781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413315210
  error estimate for blocks of size 2^( 2) =       0.000425775061
  error estimate for blocks of size 2^( 3) =       0.000438855118
  error estimate for blocks of size 2^( 4) =       0.000450216539
  error estimate for blocks of size 2^( 5) =       0.000460518299
  error estimate for blocks of size 2^( 6) =       0.000467631193
  error estimate for blocks of size 2^( 7) =       0.000471925244

      target function =                  N/A
              le_mean =     -16.905252513985
             les_mean =     286.129221316163
             stat err =       0.000462572819
             autocorr =       1.252556844472
              std dev =       0.584515975320
             le_variance =       0.341658925404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854735
                                         uncertainty =       0.006458443786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854735
                                         uncertainty =       0.006458443786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413315210
  error estimate for blocks of size 2^( 2) =       0.000425775061
  error estimate for blocks of size 2^( 3) =       0.000438855119
  error estimate for blocks of size 2^( 4) =       0.000450216539
  error estimate for blocks of size 2^( 5) =       0.000460518299
  error estimate for blocks of size 2^( 6) =       0.000467631194
  error estimate for blocks of size 2^( 7) =       0.000471925244

      target function =                  N/A
              le_mean =     -16.905252513986
             les_mean =     286.129221316426
             stat err =       0.000462572819
             autocorr =       1.252556844266
              std dev =       0.584515975515
             le_variance =       0.341658925632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854621
                                         uncertainty =       0.006458443784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854621
                                         uncertainty =       0.006458443784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413315210
  error estimate for blocks of size 2^( 2) =       0.000425775061
  error estimate for blocks of size 2^( 3) =       0.000438855119
  error estimate for blocks of size 2^( 4) =       0.000450216539
  error estimate for blocks of size 2^( 5) =       0.000460518299
  error estimate for blocks of size 2^( 6) =       0.000467631193
  error estimate for blocks of size 2^( 7) =       0.000471925244

      target function =                  N/A
              le_mean =     -16.905252513985
             les_mean =     286.129221316295
             stat err =       0.000462572819
             autocorr =       1.252556844371
              std dev =       0.584515975417
             le_variance =       0.341658925518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854522
                                         uncertainty =       0.006458443781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341567854522
                                         uncertainty =       0.006458443781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413315210
  error estimate for blocks of size 2^( 2) =       0.000425775061
  error estimate for blocks of size 2^( 3) =       0.000438855118
  error estimate for blocks of size 2^( 4) =       0.000450216539
  error estimate for blocks of size 2^( 5) =       0.000460518299
  error estimate for blocks of size 2^( 6) =       0.000467631193
  error estimate for blocks of size 2^( 7) =       0.000471925244

      target function =                  N/A
              le_mean =     -16.905252513985
             les_mean =     286.129221316180
             stat err =       0.000462572819
             autocorr =       1.252556844456
              std dev =       0.584515975332
             le_variance =       0.341658925418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905252513985        initial
     9.7656e+05     9.7656e+06             3.0501e-10       -16.905252513986  <--
     3.9062e+06     3.9062e+07             7.6252e-11       -16.905252513985
     1.5625e+07     1.5625e+08             1.9063e-11       -16.905252513985

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9547e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.276069
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3830e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338360894824
                                         uncertainty =       0.005421345991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338360894824
                                         uncertainty =       0.005421345991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411279867
  error estimate for blocks of size 2^( 2) =       0.000423558685
  error estimate for blocks of size 2^( 3) =       0.000436638474
  error estimate for blocks of size 2^( 4) =       0.000448265177
  error estimate for blocks of size 2^( 5) =       0.000459195440
  error estimate for blocks of size 2^( 6) =       0.000466465372
  error estimate for blocks of size 2^( 7) =       0.000467087023

      target function =                  N/A
              le_mean =     -16.906372020082
             les_mean =     286.163716969842
             stat err =       0.000460253253
             autocorr =       1.252330140101
              std dev =       0.581637565486
             le_variance =       0.338302257584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637202008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906372020082       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906372020082       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906372020082       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906372020005       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906372019986       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906372019995       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906372020444       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906372020059       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.090365e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906372020082       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906372020082       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906372020082       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906372020477       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906372019220       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906372020225       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906372020222       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906372021590       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.725912e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906372020082       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906372020082       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906372020082       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906372020261       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906372019918       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906372021283       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906372021319       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906372020951       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.814785e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6213e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9702
    reference variance = 0.692712
====================================================
  Execution time = 2.0287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3877e-01
  Total weights = 2.0000e+06
  Execution time = 1.8583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409200
                                         uncertainty =       0.004709266793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409200
                                         uncertainty =       0.004709266793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411562298
  error estimate for blocks of size 2^( 2) =       0.000424272852
  error estimate for blocks of size 2^( 3) =       0.000437100200
  error estimate for blocks of size 2^( 4) =       0.000449547881
  error estimate for blocks of size 2^( 5) =       0.000459815132
  error estimate for blocks of size 2^( 6) =       0.000466936617
  error estimate for blocks of size 2^( 7) =       0.000472328668

      target function =                  N/A
              le_mean =     -16.906659565876
             les_mean =     286.173904557758
             stat err =       0.000462157074
             autocorr =       1.260979549351
              std dev =       0.582036983966
             le_variance =       0.338767050705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409686
                                         uncertainty =       0.004709266798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409686
                                         uncertainty =       0.004709266798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411562299
  error estimate for blocks of size 2^( 2) =       0.000424272852
  error estimate for blocks of size 2^( 3) =       0.000437100200
  error estimate for blocks of size 2^( 4) =       0.000449547881
  error estimate for blocks of size 2^( 5) =       0.000459815132
  error estimate for blocks of size 2^( 6) =       0.000466936618
  error estimate for blocks of size 2^( 7) =       0.000472328668

      target function =                  N/A
              le_mean =     -16.906659565874
             les_mean =     286.173904558182
             stat err =       0.000462157075
             autocorr =       1.260979548808
              std dev =       0.582036984384
             le_variance =       0.338767051191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409443
                                         uncertainty =       0.004709266796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409443
                                         uncertainty =       0.004709266796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411562298
  error estimate for blocks of size 2^( 2) =       0.000424272852
  error estimate for blocks of size 2^( 3) =       0.000437100200
  error estimate for blocks of size 2^( 4) =       0.000449547881
  error estimate for blocks of size 2^( 5) =       0.000459815132
  error estimate for blocks of size 2^( 6) =       0.000466936618
  error estimate for blocks of size 2^( 7) =       0.000472328668

      target function =                  N/A
              le_mean =     -16.906659565875
             les_mean =     286.173904557970
             stat err =       0.000462157075
             autocorr =       1.260979549080
              std dev =       0.582036984175
             le_variance =       0.338767050948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409230
                                         uncertainty =       0.004709266794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720409230
                                         uncertainty =       0.004709266794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411562298
  error estimate for blocks of size 2^( 2) =       0.000424272852
  error estimate for blocks of size 2^( 3) =       0.000437100200
  error estimate for blocks of size 2^( 4) =       0.000449547881
  error estimate for blocks of size 2^( 5) =       0.000459815132
  error estimate for blocks of size 2^( 6) =       0.000466936617
  error estimate for blocks of size 2^( 7) =       0.000472328668

      target function =                  N/A
              le_mean =     -16.906659565876
             les_mean =     286.173904557785
             stat err =       0.000462157074
             autocorr =       1.260979549321
              std dev =       0.582036983993
             le_variance =       0.338767050735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906659565876        initial  <--
     2.4414e+05     2.4414e+06             1.0904e-09       -16.906659565874
     9.7656e+05     9.7656e+06             2.7259e-10       -16.906659565875
     3.9062e+06     3.9062e+07             6.8148e-11       -16.906659565876

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6424
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.156024
====================================================
  Execution time = 2.0692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4446e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344531813593
                                         uncertainty =       0.004615379149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344531813593
                                         uncertainty =       0.004615379149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415008563
  error estimate for blocks of size 2^( 2) =       0.000427697478
  error estimate for blocks of size 2^( 3) =       0.000440638721
  error estimate for blocks of size 2^( 4) =       0.000453469362
  error estimate for blocks of size 2^( 5) =       0.000464055230
  error estimate for blocks of size 2^( 6) =       0.000473042290
  error estimate for blocks of size 2^( 7) =       0.000480146665

      target function =                  N/A
              le_mean =     -16.905536303445
             les_mean =     286.141621749097
             stat err =       0.000467678387
             autocorr =       1.269932054012
              std dev =       0.586910737870
             le_variance =       0.344464214227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553630345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536303445       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536303445       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536303445       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536303445       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536304480       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536300867       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905536301343       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536303363       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.062865e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536303445       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536303445       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536303445       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536303445       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536301913       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536306797       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905536299085       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536302908       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.657155e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905536303445       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905536303445       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905536303445       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905536303445       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905536303863       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905536303445       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905536280068       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905536303956       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 6.642683e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6228e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.383515
====================================================
  Execution time = 2.0214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3832e-01
  Total weights = 2.0000e+06
  Execution time = 1.8549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924812
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924812
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411290171
  error estimate for blocks of size 2^( 2) =       0.000424548122
  error estimate for blocks of size 2^( 3) =       0.000438270448
  error estimate for blocks of size 2^( 4) =       0.000452258466
  error estimate for blocks of size 2^( 5) =       0.000466010365
  error estimate for blocks of size 2^( 6) =       0.000476003444
  error estimate for blocks of size 2^( 7) =       0.000484715541

      target function =                  N/A
              le_mean =     -16.905634765403
             les_mean =     286.138805862180
             stat err =       0.000469746954
             autocorr =       1.304461550187
              std dev =       0.581652138420
             le_variance =       0.338319210129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924826
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924826
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411290171
  error estimate for blocks of size 2^( 2) =       0.000424548122
  error estimate for blocks of size 2^( 3) =       0.000438270448
  error estimate for blocks of size 2^( 4) =       0.000452258466
  error estimate for blocks of size 2^( 5) =       0.000466010365
  error estimate for blocks of size 2^( 6) =       0.000476003444
  error estimate for blocks of size 2^( 7) =       0.000484715541

      target function =                  N/A
              le_mean =     -16.905634765404
             les_mean =     286.138805862208
             stat err =       0.000469746954
             autocorr =       1.304461550163
              std dev =       0.581652138432
             le_variance =       0.338319210143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924819
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924819
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411290171
  error estimate for blocks of size 2^( 2) =       0.000424548122
  error estimate for blocks of size 2^( 3) =       0.000438270448
  error estimate for blocks of size 2^( 4) =       0.000452258466
  error estimate for blocks of size 2^( 5) =       0.000466010365
  error estimate for blocks of size 2^( 6) =       0.000476003444
  error estimate for blocks of size 2^( 7) =       0.000484715541

      target function =                  N/A
              le_mean =     -16.905634765403
             les_mean =     286.138805862194
             stat err =       0.000469746954
             autocorr =       1.304461550169
              std dev =       0.581652138426
             le_variance =       0.338319210136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924813
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338309924813
                                         uncertainty =       0.004508627364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411290171
  error estimate for blocks of size 2^( 2) =       0.000424548122
  error estimate for blocks of size 2^( 3) =       0.000438270448
  error estimate for blocks of size 2^( 4) =       0.000452258466
  error estimate for blocks of size 2^( 5) =       0.000466010365
  error estimate for blocks of size 2^( 6) =       0.000476003444
  error estimate for blocks of size 2^( 7) =       0.000484715541

      target function =                  N/A
              le_mean =     -16.905634765403
             les_mean =     286.138805862182
             stat err =       0.000469746954
             autocorr =       1.304461550185
              std dev =       0.581652138421
             le_variance =       0.338319210130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905634765403        initial
     2.4414e+06     2.4414e+07             1.0629e-10       -16.905634765404  <--
     9.7656e+06     9.7656e+07             2.6572e-11       -16.905634765403
     3.9062e+07     3.9062e+08             6.6427e-12       -16.905634765403

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 2.9613e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.216632
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336848469114
                                         uncertainty =       0.003102715705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336848469114
                                         uncertainty =       0.003102715705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410346229
  error estimate for blocks of size 2^( 2) =       0.000423087935
  error estimate for blocks of size 2^( 3) =       0.000436065732
  error estimate for blocks of size 2^( 4) =       0.000448309513
  error estimate for blocks of size 2^( 5) =       0.000460432272
  error estimate for blocks of size 2^( 6) =       0.000467257676
  error estimate for blocks of size 2^( 7) =       0.000472826453

      target function =                  N/A
              le_mean =     -16.905018981754
             les_mean =     286.116434659926
             stat err =       0.000462206478
             autocorr =       1.268735709954
              std dev =       0.580317201910
             le_variance =       0.336768054833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690501898175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905018981754       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905018981755       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905018981756       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905018981755       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905018982169       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905018981754       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905018981422       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905018981797       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.666382e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905018981754       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905018981755       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905018981755       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905018981728       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905018981736       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905018982010       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905018981760       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905018977379       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.166598e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905018981754       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905018981754       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905018981754       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905018981867       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905018986256       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905018981754       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905018981690       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905018984924       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.916496e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6093e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8524
    reference variance = 0.156515
====================================================
  Execution time = 2.0051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.0000e+06
  Execution time = 1.8505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389644
                                         uncertainty =       0.003208541260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389644
                                         uncertainty =       0.003208541260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410905344
  error estimate for blocks of size 2^( 2) =       0.000424136321
  error estimate for blocks of size 2^( 3) =       0.000437889503
  error estimate for blocks of size 2^( 4) =       0.000450493202
  error estimate for blocks of size 2^( 5) =       0.000463123409
  error estimate for blocks of size 2^( 6) =       0.000472021030
  error estimate for blocks of size 2^( 7) =       0.000476119785

      target function =                  N/A
              le_mean =     -16.905659106600
             les_mean =     286.138996062480
             stat err =       0.000465439356
             autocorr =       1.283047186916
              std dev =       0.581107909734
             le_variance =       0.337686402756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389989
                                         uncertainty =       0.003208541264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389989
                                         uncertainty =       0.003208541264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410905344
  error estimate for blocks of size 2^( 2) =       0.000424136321
  error estimate for blocks of size 2^( 3) =       0.000437889504
  error estimate for blocks of size 2^( 4) =       0.000450493202
  error estimate for blocks of size 2^( 5) =       0.000463123409
  error estimate for blocks of size 2^( 6) =       0.000472021030
  error estimate for blocks of size 2^( 7) =       0.000476119785

      target function =                  N/A
              le_mean =     -16.905659106598
             les_mean =     286.138996062772
             stat err =       0.000465439357
             autocorr =       1.283047186586
              std dev =       0.581107910031
             le_variance =       0.337686403100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389817
                                         uncertainty =       0.003208541262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389817
                                         uncertainty =       0.003208541262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410905344
  error estimate for blocks of size 2^( 2) =       0.000424136321
  error estimate for blocks of size 2^( 3) =       0.000437889504
  error estimate for blocks of size 2^( 4) =       0.000450493202
  error estimate for blocks of size 2^( 5) =       0.000463123409
  error estimate for blocks of size 2^( 6) =       0.000472021030
  error estimate for blocks of size 2^( 7) =       0.000476119785

      target function =                  N/A
              le_mean =     -16.905659106599
             les_mean =     286.138996062626
             stat err =       0.000465439357
             autocorr =       1.283047186750
              std dev =       0.581107909882
             le_variance =       0.337686402928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389666
                                         uncertainty =       0.003208541260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337762389666
                                         uncertainty =       0.003208541260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410905344
  error estimate for blocks of size 2^( 2) =       0.000424136321
  error estimate for blocks of size 2^( 3) =       0.000437889503
  error estimate for blocks of size 2^( 4) =       0.000450493202
  error estimate for blocks of size 2^( 5) =       0.000463123409
  error estimate for blocks of size 2^( 6) =       0.000472021030
  error estimate for blocks of size 2^( 7) =       0.000476119785

      target function =                  N/A
              le_mean =     -16.905659106600
             les_mean =     286.138996062498
             stat err =       0.000465439356
             autocorr =       1.283047186909
              std dev =       0.581107909753
             le_variance =       0.337686402777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905659106600        initial  <--
     6.1035e+05     6.1035e+06             4.6664e-10       -16.905659106598
     2.4414e+06     2.4414e+07             1.1666e-10       -16.905659106599
     9.7656e+06     9.7656e+07             2.9165e-11       -16.905659106600

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4010
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9194
    reference variance = 0.153956
====================================================
  Execution time = 2.1108e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3979e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339720940971
                                         uncertainty =       0.007167239847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339720940971
                                         uncertainty =       0.007167239847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412185540
  error estimate for blocks of size 2^( 2) =       0.000424679032
  error estimate for blocks of size 2^( 3) =       0.000437629749
  error estimate for blocks of size 2^( 4) =       0.000449810280
  error estimate for blocks of size 2^( 5) =       0.000458712167
  error estimate for blocks of size 2^( 6) =       0.000464209914
  error estimate for blocks of size 2^( 7) =       0.000470305978

      target function =                  N/A
              le_mean =     -16.905349759913
             les_mean =     286.130644173311
             stat err =       0.000460759585
             autocorr =       1.249577662096
              std dev =       0.582918380398
             le_variance =       0.339793838206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534975991e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349759913       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349759913       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349759913       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349759782       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349759184       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349759901       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349759759       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349760766       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.529444e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349759913       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349759913       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349759913       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349759786       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349752540       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349758929       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349781184       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349775152       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.132321e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349759913       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349759913       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349759913       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349759913       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349760746       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349756199       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349766744       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349725300       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 2.830904e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9840e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9206
    reference variance = 0.180085
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4328e-01
  Total weights = 2.0000e+06
  Execution time = 1.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958336
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958336
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414297004
  error estimate for blocks of size 2^( 2) =       0.000427422649
  error estimate for blocks of size 2^( 3) =       0.000441391994
  error estimate for blocks of size 2^( 4) =       0.000453774256
  error estimate for blocks of size 2^( 5) =       0.000465222059
  error estimate for blocks of size 2^( 6) =       0.000474334063
  error estimate for blocks of size 2^( 7) =       0.000478554328

      target function =                  N/A
              le_mean =     -16.905573459556
             les_mean =     286.141697840026
             stat err =       0.000467971177
             autocorr =       1.275894084112
              std dev =       0.585904442073
             le_variance =       0.343284015240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958364
                                         uncertainty =       0.004240836780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958364
                                         uncertainty =       0.004240836780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414297004
  error estimate for blocks of size 2^( 2) =       0.000427422649
  error estimate for blocks of size 2^( 3) =       0.000441391994
  error estimate for blocks of size 2^( 4) =       0.000453774256
  error estimate for blocks of size 2^( 5) =       0.000465222059
  error estimate for blocks of size 2^( 6) =       0.000474334063
  error estimate for blocks of size 2^( 7) =       0.000478554328

      target function =                  N/A
              le_mean =     -16.905573459556
             les_mean =     286.141697840061
             stat err =       0.000467971177
             autocorr =       1.275894084076
              std dev =       0.585904442096
             le_variance =       0.343284015268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958350
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958350
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414297004
  error estimate for blocks of size 2^( 2) =       0.000427422649
  error estimate for blocks of size 2^( 3) =       0.000441391994
  error estimate for blocks of size 2^( 4) =       0.000453774256
  error estimate for blocks of size 2^( 5) =       0.000465222059
  error estimate for blocks of size 2^( 6) =       0.000474334063
  error estimate for blocks of size 2^( 7) =       0.000478554328

      target function =                  N/A
              le_mean =     -16.905573459556
             les_mean =     286.141697840043
             stat err =       0.000467971177
             autocorr =       1.275894084095
              std dev =       0.585904442084
             le_variance =       0.343284015254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958338
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020958338
                                         uncertainty =       0.004240836779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414297004
  error estimate for blocks of size 2^( 2) =       0.000427422649
  error estimate for blocks of size 2^( 3) =       0.000441391994
  error estimate for blocks of size 2^( 4) =       0.000453774256
  error estimate for blocks of size 2^( 5) =       0.000465222059
  error estimate for blocks of size 2^( 6) =       0.000474334063
  error estimate for blocks of size 2^( 7) =       0.000478554328

      target function =                  N/A
              le_mean =     -16.905573459556
             les_mean =     286.141697840028
             stat err =       0.000467971177
             autocorr =       1.275894084100
              std dev =       0.585904442074
             le_variance =       0.343284015242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905573459556        initial
     6.1035e+06     6.1035e+07             4.5294e-11       -16.905573459556  <--
     2.4414e+07     2.4414e+08             1.1323e-11       -16.905573459556
     9.7656e+07     9.7656e+08             2.8309e-12       -16.905573459556

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 3.3250e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080206e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.943
    reference variance = 0.304477
====================================================
  Execution time = 2.0797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344414990807
                                         uncertainty =       0.008114736093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344414990807
                                         uncertainty =       0.008114736093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414986770
  error estimate for blocks of size 2^( 2) =       0.000428114540
  error estimate for blocks of size 2^( 3) =       0.000442032955
  error estimate for blocks of size 2^( 4) =       0.000454591345
  error estimate for blocks of size 2^( 5) =       0.000465830255
  error estimate for blocks of size 2^( 6) =       0.000474083576
  error estimate for blocks of size 2^( 7) =       0.000481318439

      target function =                  N/A
              le_mean =     -16.905149816212
             les_mean =     286.128518174111
             stat err =       0.000468955904
             autocorr =       1.277013572908
              std dev =       0.586879917673
             le_variance =       0.344428037768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690514981621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905149816212       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905149816212       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905149816212       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905149816576       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905149816362       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905149816053       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905149816360       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905149816103       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.874226e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905149816212       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905149816212       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905149816212       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905149816212       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905149815661       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905149813471       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905149816886       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905149817987       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.685561e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905149816212       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905149816212       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905149816212       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905149816212       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905149834597       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905149826024       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905149819510       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905149814757       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.171360e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6309e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783080e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9192
    reference variance = 0.353927
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.0000e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512272
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512272
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408393664
  error estimate for blocks of size 2^( 2) =       0.000421282706
  error estimate for blocks of size 2^( 3) =       0.000434053589
  error estimate for blocks of size 2^( 4) =       0.000446137992
  error estimate for blocks of size 2^( 5) =       0.000456940686
  error estimate for blocks of size 2^( 6) =       0.000464688757
  error estimate for blocks of size 2^( 7) =       0.000469671145

      target function =                  N/A
              le_mean =     -16.905239154399
             les_mean =     286.120681470114
             stat err =       0.000459359645
             autocorr =       1.265166511396
              std dev =       0.577555858325
             le_variance =       0.333570769486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512367
                                         uncertainty =       0.002921603053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512367
                                         uncertainty =       0.002921603053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408393664
  error estimate for blocks of size 2^( 2) =       0.000421282706
  error estimate for blocks of size 2^( 3) =       0.000434053589
  error estimate for blocks of size 2^( 4) =       0.000446137992
  error estimate for blocks of size 2^( 5) =       0.000456940686
  error estimate for blocks of size 2^( 6) =       0.000464688757
  error estimate for blocks of size 2^( 7) =       0.000469671145

      target function =                  N/A
              le_mean =     -16.905239154400
             les_mean =     286.120681470258
             stat err =       0.000459359645
             autocorr =       1.265166511302
              std dev =       0.577555858408
             le_variance =       0.333570769581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512319
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512319
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408393664
  error estimate for blocks of size 2^( 2) =       0.000421282706
  error estimate for blocks of size 2^( 3) =       0.000434053589
  error estimate for blocks of size 2^( 4) =       0.000446137992
  error estimate for blocks of size 2^( 5) =       0.000456940686
  error estimate for blocks of size 2^( 6) =       0.000464688757
  error estimate for blocks of size 2^( 7) =       0.000469671145

      target function =                  N/A
              le_mean =     -16.905239154399
             les_mean =     286.120681470186
             stat err =       0.000459359645
             autocorr =       1.265166511341
              std dev =       0.577555858366
             le_variance =       0.333570769533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512278
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333516512278
                                         uncertainty =       0.002921603052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408393664
  error estimate for blocks of size 2^( 2) =       0.000421282706
  error estimate for blocks of size 2^( 3) =       0.000434053589
  error estimate for blocks of size 2^( 4) =       0.000446137992
  error estimate for blocks of size 2^( 5) =       0.000456940686
  error estimate for blocks of size 2^( 6) =       0.000464688757
  error estimate for blocks of size 2^( 7) =       0.000469671145

      target function =                  N/A
              le_mean =     -16.905239154399
             les_mean =     286.120681470123
             stat err =       0.000459359645
             autocorr =       1.265166511382
              std dev =       0.577555858331
             le_variance =       0.333570769492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905239154399        initial
     1.5259e+06     1.5259e+07             1.8742e-10       -16.905239154400  <--
     6.1035e+06     6.1035e+07             4.6856e-11       -16.905239154399
     2.4414e+07     2.4414e+08             1.1714e-11       -16.905239154399

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 2.9880e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9789
    reference variance = 0.551333
====================================================
  Execution time = 2.0596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339975042273
                                         uncertainty =       0.006947536060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339975042273
                                         uncertainty =       0.006947536060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412296382
  error estimate for blocks of size 2^( 2) =       0.000424898940
  error estimate for blocks of size 2^( 3) =       0.000437669709
  error estimate for blocks of size 2^( 4) =       0.000450171634
  error estimate for blocks of size 2^( 5) =       0.000462164287
  error estimate for blocks of size 2^( 6) =       0.000471075011
  error estimate for blocks of size 2^( 7) =       0.000479181615

      target function =                  N/A
              le_mean =     -16.905197017166
             les_mean =     286.125662632421
             stat err =       0.000465648137
             autocorr =       1.275547663546
              std dev =       0.583075135127
             le_variance =       0.339976613204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519701717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197017166       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197017167       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197017167       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197017172       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197017313       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197017226       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197016951       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197017326       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.561581e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197017166       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197017166       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197017166       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197017478       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197017214       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197016142       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197016789       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197017424       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.890395e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197017166       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197017166       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197017166       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197012124       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197015933       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197021744       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197014998       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197016209       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.725989e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9232
    reference variance = 0.190874
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4289e-01
  Total weights = 2.0000e+06
  Execution time = 1.8616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166728
                                         uncertainty =       0.006619344472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166728
                                         uncertainty =       0.006619344472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414058877
  error estimate for blocks of size 2^( 2) =       0.000427001320
  error estimate for blocks of size 2^( 3) =       0.000439358243
  error estimate for blocks of size 2^( 4) =       0.000452619427
  error estimate for blocks of size 2^( 5) =       0.000464382697
  error estimate for blocks of size 2^( 6) =       0.000471853249
  error estimate for blocks of size 2^( 7) =       0.000474510498

      target function =                  N/A
              le_mean =     -16.905659058996
             les_mean =     286.144197554151
             stat err =       0.000465841468
             autocorr =       1.265762112641
              std dev =       0.585567678896
             le_variance =       0.342889506568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166651
                                         uncertainty =       0.006619344474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166651
                                         uncertainty =       0.006619344474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414058877
  error estimate for blocks of size 2^( 2) =       0.000427001320
  error estimate for blocks of size 2^( 3) =       0.000439358243
  error estimate for blocks of size 2^( 4) =       0.000452619427
  error estimate for blocks of size 2^( 5) =       0.000464382697
  error estimate for blocks of size 2^( 6) =       0.000471853248
  error estimate for blocks of size 2^( 7) =       0.000474510498

      target function =                  N/A
              le_mean =     -16.905659058996
             les_mean =     286.144197554071
             stat err =       0.000465841468
             autocorr =       1.265762112670
              std dev =       0.585567678831
             le_variance =       0.342889506491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166690
                                         uncertainty =       0.006619344473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166690
                                         uncertainty =       0.006619344473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414058877
  error estimate for blocks of size 2^( 2) =       0.000427001320
  error estimate for blocks of size 2^( 3) =       0.000439358243
  error estimate for blocks of size 2^( 4) =       0.000452619427
  error estimate for blocks of size 2^( 5) =       0.000464382697
  error estimate for blocks of size 2^( 6) =       0.000471853249
  error estimate for blocks of size 2^( 7) =       0.000474510498

      target function =                  N/A
              le_mean =     -16.905659058996
             les_mean =     286.144197554111
             stat err =       0.000465841468
             autocorr =       1.265762112652
              std dev =       0.585567678864
             le_variance =       0.342889506530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166723
                                         uncertainty =       0.006619344472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342992166723
                                         uncertainty =       0.006619344472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414058877
  error estimate for blocks of size 2^( 2) =       0.000427001320
  error estimate for blocks of size 2^( 3) =       0.000439358243
  error estimate for blocks of size 2^( 4) =       0.000452619427
  error estimate for blocks of size 2^( 5) =       0.000464382697
  error estimate for blocks of size 2^( 6) =       0.000471853249
  error estimate for blocks of size 2^( 7) =       0.000474510498

      target function =                  N/A
              le_mean =     -16.905659058996
             les_mean =     286.144197554146
             stat err =       0.000465841468
             autocorr =       1.265762112640
              std dev =       0.585567678892
             le_variance =       0.342889506563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905659058996        initial  <--
     3.8147e+05     3.8147e+06             7.5616e-10       -16.905659058996
     1.5259e+06     1.5259e+07             1.8904e-10       -16.905659058996
     6.1035e+06     6.1035e+07             4.7260e-11       -16.905659058996

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6979
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.306262
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345809818593
                                         uncertainty =       0.005794220226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345809818593
                                         uncertainty =       0.005794220226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415813160
  error estimate for blocks of size 2^( 2) =       0.000427982863
  error estimate for blocks of size 2^( 3) =       0.000441027424
  error estimate for blocks of size 2^( 4) =       0.000452840674
  error estimate for blocks of size 2^( 5) =       0.000464493078
  error estimate for blocks of size 2^( 6) =       0.000474889417
  error estimate for blocks of size 2^( 7) =       0.000481350503

      target function =                  N/A
              le_mean =     -16.905297487677
             les_mean =     286.134884142194
             stat err =       0.000468393418
             autocorr =       1.268893307098
              std dev =       0.588048610447
             le_variance =       0.345801168248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529748768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297487677       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297487677       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297487677       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905297487677       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905297487795       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905297488046       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905297484934       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905297487954       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.318714e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297487677       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297487677       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297487677       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905297487677       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905297489097       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905297493233       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905297479233       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905297486205       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.579687e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297487677       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297487677       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297487677       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905297506567       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905297492210       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905297477904       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905297487032       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905297502307       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.949211e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5776e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.34974
====================================================
  Execution time = 1.9856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2927e-01
  Total weights = 2.0000e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955192
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955192
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405755331
  error estimate for blocks of size 2^( 2) =       0.000419114858
  error estimate for blocks of size 2^( 3) =       0.000432834239
  error estimate for blocks of size 2^( 4) =       0.000446200864
  error estimate for blocks of size 2^( 5) =       0.000457409981
  error estimate for blocks of size 2^( 6) =       0.000465234669
  error estimate for blocks of size 2^( 7) =       0.000468147550

      target function =                  N/A
              le_mean =     -16.905383686514
             les_mean =     286.121272201384
             stat err =       0.000459248266
             autocorr =       1.281051475356
              std dev =       0.573824692525
             le_variance =       0.329274777752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955255
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955255
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405755331
  error estimate for blocks of size 2^( 2) =       0.000419114858
  error estimate for blocks of size 2^( 3) =       0.000432834239
  error estimate for blocks of size 2^( 4) =       0.000446200864
  error estimate for blocks of size 2^( 5) =       0.000457409981
  error estimate for blocks of size 2^( 6) =       0.000465234669
  error estimate for blocks of size 2^( 7) =       0.000468147550

      target function =                  N/A
              le_mean =     -16.905383686515
             les_mean =     286.121272201449
             stat err =       0.000459248266
             autocorr =       1.281051475282
              std dev =       0.573824692580
             le_variance =       0.329274777815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955223
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955223
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405755331
  error estimate for blocks of size 2^( 2) =       0.000419114858
  error estimate for blocks of size 2^( 3) =       0.000432834239
  error estimate for blocks of size 2^( 4) =       0.000446200864
  error estimate for blocks of size 2^( 5) =       0.000457409981
  error estimate for blocks of size 2^( 6) =       0.000465234669
  error estimate for blocks of size 2^( 7) =       0.000468147550

      target function =                  N/A
              le_mean =     -16.905383686515
             les_mean =     286.121272201417
             stat err =       0.000459248266
             autocorr =       1.281051475317
              std dev =       0.573824692553
             le_variance =       0.329274777783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955195
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329317955195
                                         uncertainty =       0.002632957896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405755331
  error estimate for blocks of size 2^( 2) =       0.000419114858
  error estimate for blocks of size 2^( 3) =       0.000432834239
  error estimate for blocks of size 2^( 4) =       0.000446200864
  error estimate for blocks of size 2^( 5) =       0.000457409981
  error estimate for blocks of size 2^( 6) =       0.000465234669
  error estimate for blocks of size 2^( 7) =       0.000468147549

      target function =                  N/A
              le_mean =     -16.905383686514
             les_mean =     286.121272201388
             stat err =       0.000459248266
             autocorr =       1.281051475342
              std dev =       0.573824692529
             le_variance =       0.329274777756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905383686514        initial
     3.8147e+06     3.8147e+07             6.3187e-11       -16.905383686515  <--
     1.5259e+07     1.5259e+08             1.5797e-11       -16.905383686515
     6.1035e+07     6.1035e+08             3.9492e-12       -16.905383686514

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.9222e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.236207
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956995911
                                         uncertainty =       0.004612470177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956995911
                                         uncertainty =       0.004612470177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411150594
  error estimate for blocks of size 2^( 2) =       0.000424171876
  error estimate for blocks of size 2^( 3) =       0.000437095214
  error estimate for blocks of size 2^( 4) =       0.000448555587
  error estimate for blocks of size 2^( 5) =       0.000458246251
  error estimate for blocks of size 2^( 6) =       0.000465946358
  error estimate for blocks of size 2^( 7) =       0.000470566294

      target function =                  N/A
              le_mean =     -16.905767239175
             les_mean =     286.143055398174
             stat err =       0.000460828623
             autocorr =       1.256252814677
              std dev =       0.581454746345
             le_variance =       0.338089622047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576723918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905767239175       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905767239176       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905767239177       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905767239179       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905767239754       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767239264       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905767237822       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905767238835       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.236717e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905767239175       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905767239175       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905767239176       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905767234717       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905767239134       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767236194       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905767239732       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905767240927       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 8.091754e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905767239175       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905767239175       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905767239175       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905767239175       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905767239764       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767225623       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905767234321       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905767233183       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 2.022935e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5794e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8321
    reference variance = 0.246653
====================================================
  Execution time = 2.0120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132171
                                         uncertainty =       0.003865268653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132171
                                         uncertainty =       0.003865268653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411720849
  error estimate for blocks of size 2^( 2) =       0.000424464553
  error estimate for blocks of size 2^( 3) =       0.000438083544
  error estimate for blocks of size 2^( 4) =       0.000450692264
  error estimate for blocks of size 2^( 5) =       0.000461456965
  error estimate for blocks of size 2^( 6) =       0.000471328824
  error estimate for blocks of size 2^( 7) =       0.000474723289

      target function =                  N/A
              le_mean =     -16.905909901573
             les_mean =     286.148817546312
             stat err =       0.000464550336
             autocorr =       1.273092138477
              std dev =       0.582261209181
             le_variance =       0.339028115717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132286
                                         uncertainty =       0.003865268654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132286
                                         uncertainty =       0.003865268654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411720850
  error estimate for blocks of size 2^( 2) =       0.000424464553
  error estimate for blocks of size 2^( 3) =       0.000438083544
  error estimate for blocks of size 2^( 4) =       0.000450692264
  error estimate for blocks of size 2^( 5) =       0.000461456965
  error estimate for blocks of size 2^( 6) =       0.000471328824
  error estimate for blocks of size 2^( 7) =       0.000474723290

      target function =                  N/A
              le_mean =     -16.905909901573
             les_mean =     286.148817546408
             stat err =       0.000464550336
             autocorr =       1.273092138352
              std dev =       0.582261209280
             le_variance =       0.339028115832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132229
                                         uncertainty =       0.003865268654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132229
                                         uncertainty =       0.003865268654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411720849
  error estimate for blocks of size 2^( 2) =       0.000424464553
  error estimate for blocks of size 2^( 3) =       0.000438083544
  error estimate for blocks of size 2^( 4) =       0.000450692264
  error estimate for blocks of size 2^( 5) =       0.000461456965
  error estimate for blocks of size 2^( 6) =       0.000471328824
  error estimate for blocks of size 2^( 7) =       0.000474723290

      target function =                  N/A
              le_mean =     -16.905909901573
             les_mean =     286.148817546360
             stat err =       0.000464550336
             autocorr =       1.273092138417
              std dev =       0.582261209231
             le_variance =       0.339028115775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132178
                                         uncertainty =       0.003865268653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339146132178
                                         uncertainty =       0.003865268653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411720849
  error estimate for blocks of size 2^( 2) =       0.000424464553
  error estimate for blocks of size 2^( 3) =       0.000438083544
  error estimate for blocks of size 2^( 4) =       0.000450692264
  error estimate for blocks of size 2^( 5) =       0.000461456965
  error estimate for blocks of size 2^( 6) =       0.000471328824
  error estimate for blocks of size 2^( 7) =       0.000474723289

      target function =                  N/A
              le_mean =     -16.905909901573
             les_mean =     286.148817546318
             stat err =       0.000464550336
             autocorr =       1.273092138471
              std dev =       0.582261209187
             le_variance =       0.339028115724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905909901573        initial  <--
     9.5367e+05     9.5367e+06             3.2367e-10       -16.905909901573
     3.8147e+06     3.8147e+07             8.0918e-11       -16.905909901573
     1.5259e+07     1.5259e+08             2.0229e-11       -16.905909901573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5004
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8113
    reference variance = 0.373717
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340557931347
                                         uncertainty =       0.003186797760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340557931347
                                         uncertainty =       0.003186797760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412679882
  error estimate for blocks of size 2^( 2) =       0.000425639141
  error estimate for blocks of size 2^( 3) =       0.000438936491
  error estimate for blocks of size 2^( 4) =       0.000451639084
  error estimate for blocks of size 2^( 5) =       0.000462506580
  error estimate for blocks of size 2^( 6) =       0.000470815577
  error estimate for blocks of size 2^( 7) =       0.000473940968

      target function =                  N/A
              le_mean =     -16.906209708017
             les_mean =     286.160535891804
             stat err =       0.000464725552
             autocorr =       1.268137975071
              std dev =       0.583617486590
             le_variance =       0.340609370654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620970802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209708017       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209708017       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906209708017       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906209708017       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906209707693       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209709181       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906209703848       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906209707994       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.552813e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209708017       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209708017       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906209708017       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906209700119       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906209712129       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209649713       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906209701355       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906209704328       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 6.381817e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209708017       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209708017       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906209708017       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906209709936       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906209878276       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209752066       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906209716838       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906209866015       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.595751e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5976e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9105
    reference variance = 0.199579
====================================================
  Execution time = 2.2135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4270e-01
  Total weights = 2.0000e+06
  Execution time = 1.8533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703397
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703397
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946456
  error estimate for blocks of size 2^( 2) =       0.000426516906
  error estimate for blocks of size 2^( 3) =       0.000440293886
  error estimate for blocks of size 2^( 4) =       0.000452375538
  error estimate for blocks of size 2^( 5) =       0.000463520947
  error estimate for blocks of size 2^( 6) =       0.000474334601
  error estimate for blocks of size 2^( 7) =       0.000482032078

      target function =                  N/A
              le_mean =     -16.905780659589
             les_mean =     286.148122875876
             stat err =       0.000468065791
             autocorr =       1.278572812035
              std dev =       0.585408692352
             le_variance =       0.342703337081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703405
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703405
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946456
  error estimate for blocks of size 2^( 2) =       0.000426516906
  error estimate for blocks of size 2^( 3) =       0.000440293886
  error estimate for blocks of size 2^( 4) =       0.000452375538
  error estimate for blocks of size 2^( 5) =       0.000463520947
  error estimate for blocks of size 2^( 6) =       0.000474334601
  error estimate for blocks of size 2^( 7) =       0.000482032078

      target function =                  N/A
              le_mean =     -16.905780659589
             les_mean =     286.148122875882
             stat err =       0.000468065791
             autocorr =       1.278572812024
              std dev =       0.585408692358
             le_variance =       0.342703337089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703401
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703401
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946456
  error estimate for blocks of size 2^( 2) =       0.000426516906
  error estimate for blocks of size 2^( 3) =       0.000440293886
  error estimate for blocks of size 2^( 4) =       0.000452375538
  error estimate for blocks of size 2^( 5) =       0.000463520947
  error estimate for blocks of size 2^( 6) =       0.000474334601
  error estimate for blocks of size 2^( 7) =       0.000482032078

      target function =                  N/A
              le_mean =     -16.905780659589
             les_mean =     286.148122875879
             stat err =       0.000468065791
             autocorr =       1.278572812042
              std dev =       0.585408692355
             le_variance =       0.342703337085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703398
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689703398
                                         uncertainty =       0.003702640360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946456
  error estimate for blocks of size 2^( 2) =       0.000426516906
  error estimate for blocks of size 2^( 3) =       0.000440293886
  error estimate for blocks of size 2^( 4) =       0.000452375538
  error estimate for blocks of size 2^( 5) =       0.000463520947
  error estimate for blocks of size 2^( 6) =       0.000474334601
  error estimate for blocks of size 2^( 7) =       0.000482032078

      target function =                  N/A
              le_mean =     -16.905780659589
             les_mean =     286.148122875876
             stat err =       0.000468065791
             autocorr =       1.278572812033
              std dev =       0.585408692352
             le_variance =       0.342703337082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905780659589        initial  <--
     9.5367e+06     9.5367e+07             2.5528e-11       -16.905780659589
     3.8147e+07     3.8147e+08             6.3818e-12       -16.905780659589
     1.5259e+08     1.5259e+09             1.5958e-12       -16.905780659589

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4954
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.185411
====================================================
  Execution time = 2.2757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334373926663
                                         uncertainty =       0.004158133781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334373926663
                                         uncertainty =       0.004158133781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408828012
  error estimate for blocks of size 2^( 2) =       0.000421740609
  error estimate for blocks of size 2^( 3) =       0.000435244042
  error estimate for blocks of size 2^( 4) =       0.000447742413
  error estimate for blocks of size 2^( 5) =       0.000460532456
  error estimate for blocks of size 2^( 6) =       0.000469106081
  error estimate for blocks of size 2^( 7) =       0.000472682516

      target function =                  N/A
              le_mean =     -16.905356502331
             les_mean =     286.125358990270
             stat err =       0.000462515866
             autocorr =       1.279888041860
              std dev =       0.578170118991
             le_variance =       0.334280686495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690535650233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905356502331       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905356502331       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905356502331       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905356508159       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905356511725       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905356481880       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905356506771       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.432800e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905356502331       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905356502331       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905356502331       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905356276976       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905356665356       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905356531327       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905356544997       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.081960e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905356502331       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905356502331       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905356502331       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905355163064       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905356500564       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905356328830       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905356954115       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.519471e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8272e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8358
    reference variance = 0.258443
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4026e-01
  Total weights = 2.0000e+06
  Execution time = 1.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061120
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061120
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469557
  error estimate for blocks of size 2^( 2) =       0.000425437674
  error estimate for blocks of size 2^( 3) =       0.000438793661
  error estimate for blocks of size 2^( 4) =       0.000450977841
  error estimate for blocks of size 2^( 5) =       0.000461974559
  error estimate for blocks of size 2^( 6) =       0.000469625669
  error estimate for blocks of size 2^( 7) =       0.000473968191

      target function =                  N/A
              le_mean =     -16.906022620974
             les_mean =     286.153862960910
             stat err =       0.000464136565
             autocorr =       1.266215916086
              std dev =       0.583320040942
             le_variance =       0.340262270165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061122
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061122
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469557
  error estimate for blocks of size 2^( 2) =       0.000425437674
  error estimate for blocks of size 2^( 3) =       0.000438793661
  error estimate for blocks of size 2^( 4) =       0.000450977841
  error estimate for blocks of size 2^( 5) =       0.000461974559
  error estimate for blocks of size 2^( 6) =       0.000469625669
  error estimate for blocks of size 2^( 7) =       0.000473968191

      target function =                  N/A
              le_mean =     -16.906022620974
             les_mean =     286.153862960912
             stat err =       0.000464136565
             autocorr =       1.266215916086
              std dev =       0.583320040944
             le_variance =       0.340262270167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061121
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061121
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469557
  error estimate for blocks of size 2^( 2) =       0.000425437674
  error estimate for blocks of size 2^( 3) =       0.000438793661
  error estimate for blocks of size 2^( 4) =       0.000450977841
  error estimate for blocks of size 2^( 5) =       0.000461974559
  error estimate for blocks of size 2^( 6) =       0.000469625669
  error estimate for blocks of size 2^( 7) =       0.000473968191

      target function =                  N/A
              le_mean =     -16.906022620974
             les_mean =     286.153862960911
             stat err =       0.000464136565
             autocorr =       1.266215916087
              std dev =       0.583320040943
             le_variance =       0.340262270166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061120
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340257061120
                                         uncertainty =       0.003433943234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469557
  error estimate for blocks of size 2^( 2) =       0.000425437674
  error estimate for blocks of size 2^( 3) =       0.000438793661
  error estimate for blocks of size 2^( 4) =       0.000450977841
  error estimate for blocks of size 2^( 5) =       0.000461974559
  error estimate for blocks of size 2^( 6) =       0.000469625669
  error estimate for blocks of size 2^( 7) =       0.000473968191

      target function =                  N/A
              le_mean =     -16.906022620974
             les_mean =     286.153862960910
             stat err =       0.000464136565
             autocorr =       1.266215916086
              std dev =       0.583320040942
             le_variance =       0.340262270165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906022620974        initial  <--
     9.5367e+07     9.5367e+08             2.4328e-12       -16.906022620974
     3.8147e+08     3.8147e+09             6.0820e-13       -16.906022620974
     1.5259e+09     1.5259e+10             1.5195e-13       -16.906022620974

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0033
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.218712
====================================================
  Execution time = 2.1035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333298598418
                                         uncertainty =       0.003246923217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333298598418
                                         uncertainty =       0.003246923217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408179288
  error estimate for blocks of size 2^( 2) =       0.000421091163
  error estimate for blocks of size 2^( 3) =       0.000434956488
  error estimate for blocks of size 2^( 4) =       0.000447141146
  error estimate for blocks of size 2^( 5) =       0.000460575607
  error estimate for blocks of size 2^( 6) =       0.000469938154
  error estimate for blocks of size 2^( 7) =       0.000474095864

      target function =                  N/A
              le_mean =     -16.904928029424
             les_mean =     286.109812175395
             stat err =       0.000462937693
             autocorr =       1.286302634264
              std dev =       0.577252684712
             le_variance =       0.333220662008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690492802942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904928029424       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904928029424       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904928029424       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904927986653       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904928586459       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904928113603       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904929968544       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904928097644       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.400490e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904928029424       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904928029424       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904928029424       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904928029424       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904927188408       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904928099117       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904926866009       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904931799368       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 5.985739e-14

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904928029424       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904928029424       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904928029424       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904928029424       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904933043346       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904927808438       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904929907057       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904921739033       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 1.509050e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6610e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0255
    reference variance = 1.30237
====================================================
  Execution time = 2.0350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4397e-01
  Total weights = 2.0000e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712030
  error estimate for blocks of size 2^( 2) =       0.000427847973
  error estimate for blocks of size 2^( 3) =       0.000441202582
  error estimate for blocks of size 2^( 4) =       0.000454204667
  error estimate for blocks of size 2^( 5) =       0.000464259707
  error estimate for blocks of size 2^( 6) =       0.000470961677
  error estimate for blocks of size 2^( 7) =       0.000472756752

      target function =                  N/A
              le_mean =     -16.905313200470
             les_mean =     286.133586369494
             stat err =       0.000465545701
             autocorr =       1.260176492703
              std dev =       0.586491377167
             le_variance =       0.343972135491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712030
  error estimate for blocks of size 2^( 2) =       0.000427847973
  error estimate for blocks of size 2^( 3) =       0.000441202582
  error estimate for blocks of size 2^( 4) =       0.000454204667
  error estimate for blocks of size 2^( 5) =       0.000464259707
  error estimate for blocks of size 2^( 6) =       0.000470961677
  error estimate for blocks of size 2^( 7) =       0.000472756752

      target function =                  N/A
              le_mean =     -16.905313200470
             les_mean =     286.133586369494
             stat err =       0.000465545701
             autocorr =       1.260176492705
              std dev =       0.586491377167
             le_variance =       0.343972135492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712030
  error estimate for blocks of size 2^( 2) =       0.000427847973
  error estimate for blocks of size 2^( 3) =       0.000441202582
  error estimate for blocks of size 2^( 4) =       0.000454204667
  error estimate for blocks of size 2^( 5) =       0.000464259707
  error estimate for blocks of size 2^( 6) =       0.000470961677
  error estimate for blocks of size 2^( 7) =       0.000472756752

      target function =                  N/A
              le_mean =     -16.905313200470
             les_mean =     286.133586369494
             stat err =       0.000465545701
             autocorr =       1.260176492703
              std dev =       0.586491377167
             le_variance =       0.343972135492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942654173
                                         uncertainty =       0.006778483451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712030
  error estimate for blocks of size 2^( 2) =       0.000427847973
  error estimate for blocks of size 2^( 3) =       0.000441202582
  error estimate for blocks of size 2^( 4) =       0.000454204667
  error estimate for blocks of size 2^( 5) =       0.000464259707
  error estimate for blocks of size 2^( 6) =       0.000470961677
  error estimate for blocks of size 2^( 7) =       0.000472756752

      target function =                  N/A
              le_mean =     -16.905313200470
             les_mean =     286.133586369494
             stat err =       0.000465545701
             autocorr =       1.260176492709
              std dev =       0.586491377167
             le_variance =       0.343972135491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905313200470        initial  <--
     9.5367e+08     9.5367e+09             2.4005e-13       -16.905313200470
     3.8147e+09     3.8147e+10             5.9857e-14       -16.905313200470
     1.5259e+10     1.5259e+11             1.5091e-14       -16.905313200470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7106
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.429907
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341217023363
                                         uncertainty =       0.008835826262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341217023363
                                         uncertainty =       0.008835826262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413038222
  error estimate for blocks of size 2^( 2) =       0.000426033667
  error estimate for blocks of size 2^( 3) =       0.000438644256
  error estimate for blocks of size 2^( 4) =       0.000450363282
  error estimate for blocks of size 2^( 5) =       0.000459206251
  error estimate for blocks of size 2^( 6) =       0.000465049057
  error estimate for blocks of size 2^( 7) =       0.000470588479

      target function =                  N/A
              le_mean =     -16.905592270125
             les_mean =     286.140250978773
             stat err =       0.000461301767
             autocorr =       1.247354080019
              std dev =       0.584124255321
             le_variance =       0.341201145655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559227013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592270125       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592270125       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592270125       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592270125       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905589797647       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601448252       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905589068278       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905586538875       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 2.742337e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592270125       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592270125       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592270125       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592270125       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905549197298       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905593711091       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905597068239       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567025032       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905591305629       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 6.640695e-15

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592270125       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592270125       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592270125       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634402500       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905585345002       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905576363847       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603387258       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904513593951       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905557768042       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905091996793       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905460464305       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.901734574955       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904293621744       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903664800446       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904846125460       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910073894057       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.900433360703       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.896496326576       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907601598217       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910094184255       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912238360167       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903558591115       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.886256083276       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.919510023210       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.902567805457       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.898209918643       residual = 8.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.899865566791       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.896089918997       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.935227931961       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903965058610       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.883045287176       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.871689476257       residual = 1.51e-01           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.891956767957       residual = 2.02e-02           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 1.723898e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6278e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8938
    reference variance = 0.395571
====================================================
  Execution time = 2.0001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5897e-01
  Total weights = 2.0000e+06
  Execution time = 1.8532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423659640
  error estimate for blocks of size 2^( 2) =       0.000436095359
  error estimate for blocks of size 2^( 3) =       0.000448201795
  error estimate for blocks of size 2^( 4) =       0.000460005494
  error estimate for blocks of size 2^( 5) =       0.000470890283
  error estimate for blocks of size 2^( 6) =       0.000477618798
  error estimate for blocks of size 2^( 7) =       0.000479865244

      target function =                  N/A
              le_mean =     -16.906072236375
             les_mean =     286.174253263696
             stat err =       0.000472094955
             autocorr =       1.241722447898
              std dev =       0.599145209162
             le_variance =       0.358974981662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423659640
  error estimate for blocks of size 2^( 2) =       0.000436095359
  error estimate for blocks of size 2^( 3) =       0.000448201795
  error estimate for blocks of size 2^( 4) =       0.000460005494
  error estimate for blocks of size 2^( 5) =       0.000470890283
  error estimate for blocks of size 2^( 6) =       0.000477618798
  error estimate for blocks of size 2^( 7) =       0.000479865244

      target function =                  N/A
              le_mean =     -16.906072236375
             les_mean =     286.174253263696
             stat err =       0.000472094955
             autocorr =       1.241722447900
              std dev =       0.599145209162
             le_variance =       0.358974981662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423659640
  error estimate for blocks of size 2^( 2) =       0.000436095359
  error estimate for blocks of size 2^( 3) =       0.000448201795
  error estimate for blocks of size 2^( 4) =       0.000460005494
  error estimate for blocks of size 2^( 5) =       0.000470890283
  error estimate for blocks of size 2^( 6) =       0.000477618798
  error estimate for blocks of size 2^( 7) =       0.000479865244

      target function =                  N/A
              le_mean =     -16.906072236375
             les_mean =     286.174253263696
             stat err =       0.000472094955
             autocorr =       1.241722447897
              std dev =       0.599145209162
             le_variance =       0.358974981662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359086063411
                                         uncertainty =       0.015560810379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423659640
  error estimate for blocks of size 2^( 2) =       0.000436095359
  error estimate for blocks of size 2^( 3) =       0.000448201795
  error estimate for blocks of size 2^( 4) =       0.000460005494
  error estimate for blocks of size 2^( 5) =       0.000470890283
  error estimate for blocks of size 2^( 6) =       0.000477618798
  error estimate for blocks of size 2^( 7) =       0.000479865244

      target function =                  N/A
              le_mean =     -16.906072236375
             les_mean =     286.174253263696
             stat err =       0.000472094955
             autocorr =       1.241722447898
              std dev =       0.599145209162
             le_variance =       0.358974981662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906072236375        initial  <--
     9.5367e+09     9.5367e+10             2.7423e-14       -16.906072236375
     3.8147e+10     3.8147e+11             6.6407e-15       -16.906072236375
     1.5259e+11     1.5259e+12             1.7239e-15       -16.906072236375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3547
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8289
    reference variance = 0.226025
====================================================
  Execution time = 2.1239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351274651898
                                         uncertainty =       0.015376228841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351274651898
                                         uncertainty =       0.015376228841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419047125
  error estimate for blocks of size 2^( 2) =       0.000431571226
  error estimate for blocks of size 2^( 3) =       0.000444712376
  error estimate for blocks of size 2^( 4) =       0.000456959649
  error estimate for blocks of size 2^( 5) =       0.000466578131
  error estimate for blocks of size 2^( 6) =       0.000473686694
  error estimate for blocks of size 2^( 7) =       0.000476712019

      target function =                  N/A
              le_mean =     -16.905357961921
             les_mean =     286.142328630662
             stat err =       0.000468484123
             autocorr =       1.249867640257
              std dev =       0.592622127132
             le_variance =       0.351200985566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690535796192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905357961921       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905357961921       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905357961921       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905358447736       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905377051005       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905371374030       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905382447362       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905468755744       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905410059953       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905498657980       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905483357754       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905367673046       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904739776898       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903998535768       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.902630559474       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905214639270       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906566619157       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908692783130       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904174220448       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905192518430       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907817283182       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903827558615       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.908320682163       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901811010056       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.901217120203       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902751546627       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.898874780781       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905694426639       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909076523126       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904456295196       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.896842464152       residual = 9.87e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.875540517568       residual = 1.21e-01           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 4.295468e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905357961921       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905357961921       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905357961921       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905357961921       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905121204168       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905235480518       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903966678848       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909407666210       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905330907203       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909330971781       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918901648374       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.899239658232       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.898281772298       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.900832934820       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.898341971638       residual = 6.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.931482359430       residual = 8.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908247543856       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907298048063       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906805734822       residual = 9.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.918363263014       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.861110848253       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.918578714606       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.929482671902       residual = 9.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893600576871       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903136559814       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.874127936396       residual = 9.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.881729941431       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.891065536062       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.919960190404       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.900848439500       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.945537434486       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.922362251117       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.854630997750       residual = 3.44e-01           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.900605956982       residual = 2.00e-02           smallest_sin_value = 9.97e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 6.922701e-16

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905357961921       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905357961921       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905357961921       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905357961921       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905265691967       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905352451476       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.891362583677       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904585570940       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904411234398       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903272779177       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908961987969       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.921053425192       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914509953441       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.921521924744       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892065747223       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.842274349728       residual = 5.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.840717971312       residual = 6.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910514540726       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.733335411676       residual = 4.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.980031869646       residual = 8.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.734862922395       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.830383285763       residual = 7.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.928720760007       residual = 8.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.772584007341       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.991650377954       residual = 9.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.800907198348       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.588813458365       residual = 1.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913824093939       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.757201490758       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.866587241238       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.144279867379       residual = 7.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.885930431822       residual = 5.60e-02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.675149086477       residual = 7.14e+00           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.24e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 1.767494e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6778e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.0147
    reference variance = 0.642784
====================================================
  Execution time = 2.0128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4572e-01
  Total weights = 2.0000e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415762559
  error estimate for blocks of size 2^( 2) =       0.000428510027
  error estimate for blocks of size 2^( 3) =       0.000441585148
  error estimate for blocks of size 2^( 4) =       0.000455108621
  error estimate for blocks of size 2^( 5) =       0.000466318420
  error estimate for blocks of size 2^( 6) =       0.000474540405
  error estimate for blocks of size 2^( 7) =       0.000480891928

      target function =                  N/A
              le_mean =     -16.905200850023
             les_mean =     286.131532618090
             stat err =       0.000469214844
             autocorr =       1.273657715842
              std dev =       0.587977049992
             le_variance =       0.345717011317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415762559
  error estimate for blocks of size 2^( 2) =       0.000428510027
  error estimate for blocks of size 2^( 3) =       0.000441585148
  error estimate for blocks of size 2^( 4) =       0.000455108621
  error estimate for blocks of size 2^( 5) =       0.000466318420
  error estimate for blocks of size 2^( 6) =       0.000474540405
  error estimate for blocks of size 2^( 7) =       0.000480891928

      target function =                  N/A
              le_mean =     -16.905200850023
             les_mean =     286.131532618090
             stat err =       0.000469214844
             autocorr =       1.273657715842
              std dev =       0.587977049992
             le_variance =       0.345717011317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415762559
  error estimate for blocks of size 2^( 2) =       0.000428510027
  error estimate for blocks of size 2^( 3) =       0.000441585148
  error estimate for blocks of size 2^( 4) =       0.000455108621
  error estimate for blocks of size 2^( 5) =       0.000466318420
  error estimate for blocks of size 2^( 6) =       0.000474540405
  error estimate for blocks of size 2^( 7) =       0.000480891928

      target function =                  N/A
              le_mean =     -16.905200850023
             les_mean =     286.131532618090
             stat err =       0.000469214844
             autocorr =       1.273657715841
              std dev =       0.587977049992
             le_variance =       0.345717011317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345688639970
                                         uncertainty =       0.005457681516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415762559
  error estimate for blocks of size 2^( 2) =       0.000428510027
  error estimate for blocks of size 2^( 3) =       0.000441585148
  error estimate for blocks of size 2^( 4) =       0.000455108621
  error estimate for blocks of size 2^( 5) =       0.000466318420
  error estimate for blocks of size 2^( 6) =       0.000474540405
  error estimate for blocks of size 2^( 7) =       0.000480891928

      target function =                  N/A
              le_mean =     -16.905200850023
             les_mean =     286.131532618090
             stat err =       0.000469214844
             autocorr =       1.273657715842
              std dev =       0.587977049992
             le_variance =       0.345717011317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905200850023        initial  <--
     9.5367e+10     9.5367e+11             4.2955e-15       -16.905200850023
     3.8147e+11     3.8147e+12             6.9227e-16       -16.905200850023
     1.5259e+12     1.5259e+13             1.7675e-16       -16.905200850023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5028
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.22932
====================================================
  Execution time = 2.1245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332243129923
                                         uncertainty =       0.002891414066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332243129923
                                         uncertainty =       0.002891414066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407587090
  error estimate for blocks of size 2^( 2) =       0.000420591346
  error estimate for blocks of size 2^( 3) =       0.000434096603
  error estimate for blocks of size 2^( 4) =       0.000447770496
  error estimate for blocks of size 2^( 5) =       0.000459485567
  error estimate for blocks of size 2^( 6) =       0.000468590671
  error estimate for blocks of size 2^( 7) =       0.000473014248

      target function =                  N/A
              le_mean =     -16.905324691971
             les_mean =     286.122257245927
             stat err =       0.000462215246
             autocorr =       1.286019915080
              std dev =       0.576415189840
             le_variance =       0.332254471078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532469197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324691971       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324691971       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324691971       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905244502968       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905432431211       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905435225627       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905228445353       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905552464906       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904551828131       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904521295120       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918250653719       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907434515033       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.929989334155       residual = 7.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.923875228332       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.974858751393       residual = 6.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.927299602479       residual = 5.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911299595051       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.962435748676       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.840075931305       residual = 5.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.955439406280       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.896550662281       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.941770876395       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.892186471391       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.909673532469       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.928074582790       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.886721414510       residual = 7.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.860181462044       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.744894672358       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.938740616127       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.724640124268       residual = 4.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.854586956102       residual = 3.35e-01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.648845016573       residual = 9.10e+00           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -17.102967426647       residual = 5.21e+00           smallest_sin_value = 9.98e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 1.892605e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324691971       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324691971       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324691971       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907413465552       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905324691971       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.900897190020       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906289766176       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.897235383004       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915918163103       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.855613212573       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908731310321       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.899290404605       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.900341493513       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.717441998761       residual = 4.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905094646110       residual = 8.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.105274903614       residual = 5.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.845496615302       residual = 4.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.733344313055       residual = 3.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.899940791150       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.463825492245       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.063278556066       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.585537087476       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.587883645571       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908988984319       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.088311253676       residual = 4.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.986511748540       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.312006296947       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.424604497134       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.857486925915       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.973257687596       residual = 8.11e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.318762303101       residual = 4.33e+01           smallest_sin_value = 9.97e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.029030578867       residual = 2.21e+00           smallest_sin_value = 9.91e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.42e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905324691971       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905324691971       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905324691971       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909132956923       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905137876529       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.921828275725       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.849428014701       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.040671985169       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.865236823713       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.134414584279       residual = 6.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.793376888952       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.667468664230       residual = 7.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.000725792225       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.479180682011       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.567114011275       residual = 5.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.438594714642       residual = 3.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.086402877868       residual = 9.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.355360176609       residual = 2.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.718638960574       residual = 4.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.996315117368       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -15.710136431324       residual = 1.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.504448408900       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.748656312238       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.384693211541       residual = 3.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.958635409949       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.539720803582       residual = 5.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.229593182003       residual = 1.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -15.076576266086       residual = 4.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.644443844011       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.532463231170       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.839080815400       residual = 1.26e+02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.044329413968       residual = 7.18e+00           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6810e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9536
    reference variance = 0.321745
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3632e-01
  Total weights = 2.0000e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073486
  error estimate for blocks of size 2^( 2) =       0.000423062113
  error estimate for blocks of size 2^( 3) =       0.000436607618
  error estimate for blocks of size 2^( 4) =       0.000450063853
  error estimate for blocks of size 2^( 5) =       0.000462025801
  error estimate for blocks of size 2^( 6) =       0.000469000855
  error estimate for blocks of size 2^( 7) =       0.000475038050

      target function =                  N/A
              le_mean =     -16.905412741972
             les_mean =     286.129300336265
             stat err =       0.000464032140
             autocorr =       1.280479832722
              std dev =       0.579931485592
             le_variance =       0.336320527981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073486
  error estimate for blocks of size 2^( 2) =       0.000423062113
  error estimate for blocks of size 2^( 3) =       0.000436607618
  error estimate for blocks of size 2^( 4) =       0.000450063853
  error estimate for blocks of size 2^( 5) =       0.000462025801
  error estimate for blocks of size 2^( 6) =       0.000469000855
  error estimate for blocks of size 2^( 7) =       0.000475038050

      target function =                  N/A
              le_mean =     -16.905412741972
             les_mean =     286.129300336265
             stat err =       0.000464032140
             autocorr =       1.280479832722
              std dev =       0.579931485592
             le_variance =       0.336320527981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073486
  error estimate for blocks of size 2^( 2) =       0.000423062113
  error estimate for blocks of size 2^( 3) =       0.000436607618
  error estimate for blocks of size 2^( 4) =       0.000450063853
  error estimate for blocks of size 2^( 5) =       0.000462025801
  error estimate for blocks of size 2^( 6) =       0.000469000855
  error estimate for blocks of size 2^( 7) =       0.000475038050

      target function =                  N/A
              le_mean =     -16.905412741972
             les_mean =     286.129300336265
             stat err =       0.000464032140
             autocorr =       1.280479832722
              std dev =       0.579931485592
             le_variance =       0.336320527981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434173444
                                         uncertainty =       0.003143430545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073486
  error estimate for blocks of size 2^( 2) =       0.000423062113
  error estimate for blocks of size 2^( 3) =       0.000436607618
  error estimate for blocks of size 2^( 4) =       0.000450063853
  error estimate for blocks of size 2^( 5) =       0.000462025801
  error estimate for blocks of size 2^( 6) =       0.000469000855
  error estimate for blocks of size 2^( 7) =       0.000475038050

      target function =                  N/A
              le_mean =     -16.905412741972
             les_mean =     286.129300336265
             stat err =       0.000464032140
             autocorr =       1.280479832722
              std dev =       0.579931485592
             le_variance =       0.336320527981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905412741972        initial  <--
     9.5367e+11     9.5367e+12             1.8926e-16       -16.905412741972
     3.8147e+12     3.8147e+13             0.0000e+00       -16.905412741972
     1.5259e+13     1.5259e+14             0.0000e+00       -16.905412741972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7480
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8944
    reference variance = 0.193898
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333845757904
                                         uncertainty =       0.002524426972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333845757904
                                         uncertainty =       0.002524426972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408549594
  error estimate for blocks of size 2^( 2) =       0.000421213319
  error estimate for blocks of size 2^( 3) =       0.000434164313
  error estimate for blocks of size 2^( 4) =       0.000447129594
  error estimate for blocks of size 2^( 5) =       0.000458751547
  error estimate for blocks of size 2^( 6) =       0.000467991336
  error estimate for blocks of size 2^( 7) =       0.000471981729

      target function =                  N/A
              le_mean =     -16.905534478514
             les_mean =     286.130921378404
             stat err =       0.000461463551
             autocorr =       1.275807768412
              std dev =       0.577776376379
             le_variance =       0.333825541102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553447851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534478514       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534478514       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534478514       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905534478514       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.901570012111       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915133094496       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905588143848       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.890621953483       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908894189215       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.901134166391       residual = 6.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.916952244497       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.895643734038       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.915319424658       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.971964891597       residual = 8.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.013500295251       residual = 2.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.949560132698       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218688683163       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.762707415786       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.570390999788       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.247213922025       residual = 5.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.372488013811       residual = 3.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.230480225715       residual = 1.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.752033952117       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.418990542001       residual = 3.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.918565615949       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.719596231147       residual = 3.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.955489152022       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.924234540083       residual = 9.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.294542068307       residual = 2.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.175387296170       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.654858190293       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -18.731766030889       residual = 4.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.141702181107       residual = 9.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.276440777144       residual = 5.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.422693263717       residual = 4.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.547729337521       residual = 7.71e+01           smallest_sin_value = 9.96e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.31e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 3.431364e-18

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534478514       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534478514       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534478514       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905534478514       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.896646852642       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.942434292946       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892673520955       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.753740741788       residual = 3.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.764854068133       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.144929410185       residual = 6.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.785734536993       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.668479103988       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.575676138033       residual = 6.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.323584915793       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.603698687797       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.031912066652       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -15.388191707412       residual = 2.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -15.633596933865       residual = 2.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -19.244141895748       residual = 7.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.426221408504       residual = 4.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -19.422540224140       residual = 8.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -14.513154629366       residual = 7.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.646874785823       residual = 2.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -20.169448350436       residual = 1.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -11.737836565536       residual = 3.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -19.142747836535       residual = 5.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.279735699291       residual = 3.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -24.521862178915       residual = 7.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -11.146267836285       residual = 4.53e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -21.202917449407       residual = 2.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -18.841544624875       residual = 4.83e+02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -14.181370601414       residual = 1.35e+03           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 4.957944e-18

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534478514       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534478514       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534478514       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905534478514       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.013549731116       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.770270849150       residual = 2.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.193912736902       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.241746387210       residual = 2.13e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.447581795393       residual = 3.30e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.187633271005       residual = 1.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.212744031072       residual = 6.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.770101419933       residual = 9.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.790016770849       residual = 6.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.928757177806       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.657148887065       residual = 7.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -14.812961963195       residual = 6.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.774465662869       residual = 2.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -13.174092822755       residual = 1.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 2.144602e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.235942
====================================================
  Execution time = 2.2186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4336e-01
  Total weights = 2.0000e+06
  Execution time = 1.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414343123
  error estimate for blocks of size 2^( 2) =       0.000426993733
  error estimate for blocks of size 2^( 3) =       0.000439876518
  error estimate for blocks of size 2^( 4) =       0.000452564092
  error estimate for blocks of size 2^( 5) =       0.000463041429
  error estimate for blocks of size 2^( 6) =       0.000470586070
  error estimate for blocks of size 2^( 7) =       0.000474939966

      target function =                  N/A
              le_mean =     -16.905986356193
             les_mean =     286.155734952039
             stat err =       0.000465282889
             autocorr =       1.260996531197
              std dev =       0.585969664700
             le_variance =       0.343360447949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414343123
  error estimate for blocks of size 2^( 2) =       0.000426993733
  error estimate for blocks of size 2^( 3) =       0.000439876518
  error estimate for blocks of size 2^( 4) =       0.000452564092
  error estimate for blocks of size 2^( 5) =       0.000463041429
  error estimate for blocks of size 2^( 6) =       0.000470586070
  error estimate for blocks of size 2^( 7) =       0.000474939966

      target function =                  N/A
              le_mean =     -16.905986356193
             les_mean =     286.155734952039
             stat err =       0.000465282889
             autocorr =       1.260996531191
              std dev =       0.585969664700
             le_variance =       0.343360447949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414343123
  error estimate for blocks of size 2^( 2) =       0.000426993733
  error estimate for blocks of size 2^( 3) =       0.000439876518
  error estimate for blocks of size 2^( 4) =       0.000452564092
  error estimate for blocks of size 2^( 5) =       0.000463041429
  error estimate for blocks of size 2^( 6) =       0.000470586070
  error estimate for blocks of size 2^( 7) =       0.000474939966

      target function =                  N/A
              le_mean =     -16.905986356193
             les_mean =     286.155734952039
             stat err =       0.000465282889
             autocorr =       1.260996531201
              std dev =       0.585969664700
             le_variance =       0.343360447949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343493544866
                                         uncertainty =       0.004685774887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414343123
  error estimate for blocks of size 2^( 2) =       0.000426993733
  error estimate for blocks of size 2^( 3) =       0.000439876518
  error estimate for blocks of size 2^( 4) =       0.000452564092
  error estimate for blocks of size 2^( 5) =       0.000463041429
  error estimate for blocks of size 2^( 6) =       0.000470586070
  error estimate for blocks of size 2^( 7) =       0.000474939966

      target function =                  N/A
              le_mean =     -16.905986356193
             les_mean =     286.155734952039
             stat err =       0.000465282889
             autocorr =       1.260996531197
              std dev =       0.585969664700
             le_variance =       0.343360447949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905986356193        initial  <--
     9.5367e+12     9.5367e+13             3.4314e-18       -16.905986356193
     3.8147e+13     3.8147e+14             4.9579e-18       -16.905986356193
     1.5259e+14     1.5259e+15             2.1446e-19       -16.905986356193

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5455
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.185383
====================================================
  Execution time = 2.1003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4239e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342439680220
                                         uncertainty =       0.006528828771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342439680220
                                         uncertainty =       0.006528828771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413757554
  error estimate for blocks of size 2^( 2) =       0.000427015910
  error estimate for blocks of size 2^( 3) =       0.000440504791
  error estimate for blocks of size 2^( 4) =       0.000454186262
  error estimate for blocks of size 2^( 5) =       0.000466552554
  error estimate for blocks of size 2^( 6) =       0.000474340604
  error estimate for blocks of size 2^( 7) =       0.000481584860

      target function =                  N/A
              le_mean =     -16.905844355740
             les_mean =     286.149963835490
             stat err =       0.000469166070
             autocorr =       1.285764179120
              std dev =       0.585141543715
             le_variance =       0.342390626181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584435574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905844355740       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6543e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.25857
====================================================
  Execution time = 2.0213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3744e-01
  Total weights = 2.0000e+06
  Execution time = 1.8528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410753403
  error estimate for blocks of size 2^( 2) =       0.000423777235
  error estimate for blocks of size 2^( 3) =       0.000436761656
  error estimate for blocks of size 2^( 4) =       0.000449024657
  error estimate for blocks of size 2^( 5) =       0.000459418870
  error estimate for blocks of size 2^( 6) =       0.000467648636
  error estimate for blocks of size 2^( 7) =       0.000471642266

      target function =                  N/A
              le_mean =     -16.904925664255
             les_mean =     286.113948261662
             stat err =       0.000461933607
             autocorr =       1.264726965756
              std dev =       0.580893033532
             le_variance =       0.337436716406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410753403
  error estimate for blocks of size 2^( 2) =       0.000423777235
  error estimate for blocks of size 2^( 3) =       0.000436761656
  error estimate for blocks of size 2^( 4) =       0.000449024657
  error estimate for blocks of size 2^( 5) =       0.000459418870
  error estimate for blocks of size 2^( 6) =       0.000467648636
  error estimate for blocks of size 2^( 7) =       0.000471642266

      target function =                  N/A
              le_mean =     -16.904925664255
             les_mean =     286.113948261662
             stat err =       0.000461933607
             autocorr =       1.264726965756
              std dev =       0.580893033532
             le_variance =       0.337436716406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410753403
  error estimate for blocks of size 2^( 2) =       0.000423777235
  error estimate for blocks of size 2^( 3) =       0.000436761656
  error estimate for blocks of size 2^( 4) =       0.000449024657
  error estimate for blocks of size 2^( 5) =       0.000459418870
  error estimate for blocks of size 2^( 6) =       0.000467648636
  error estimate for blocks of size 2^( 7) =       0.000471642266

      target function =                  N/A
              le_mean =     -16.904925664255
             les_mean =     286.113948261662
             stat err =       0.000461933607
             autocorr =       1.264726965756
              std dev =       0.580893033532
             le_variance =       0.337436716406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337489086507
                                         uncertainty =       0.006298695465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410753403
  error estimate for blocks of size 2^( 2) =       0.000423777235
  error estimate for blocks of size 2^( 3) =       0.000436761656
  error estimate for blocks of size 2^( 4) =       0.000449024657
  error estimate for blocks of size 2^( 5) =       0.000459418870
  error estimate for blocks of size 2^( 6) =       0.000467648636
  error estimate for blocks of size 2^( 7) =       0.000471642266

      target function =                  N/A
              le_mean =     -16.904925664255
             les_mean =     286.113948261662
             stat err =       0.000461933607
             autocorr =       1.264726965756
              std dev =       0.580893033532
             le_variance =       0.337436716406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904925664255        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -16.904925664255
     3.8147e+14     3.8147e+15             0.0000e+00       -16.904925664255
     1.5259e+15     1.5259e+16             0.0000e+00       -16.904925664255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5769
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8829
    reference variance = 0.180932
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339311995339
                                         uncertainty =       0.004389181403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339311995339
                                         uncertainty =       0.004389181403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411830006
  error estimate for blocks of size 2^( 2) =       0.000424126578
  error estimate for blocks of size 2^( 3) =       0.000436981825
  error estimate for blocks of size 2^( 4) =       0.000448580416
  error estimate for blocks of size 2^( 5) =       0.000457886446
  error estimate for blocks of size 2^( 6) =       0.000464451396
  error estimate for blocks of size 2^( 7) =       0.000466419577

      target function =                  N/A
              le_mean =     -16.905926717886
             les_mean =     286.149565928288
             stat err =       0.000459334459
             autocorr =       1.244004872865
              std dev =       0.582415579610
             le_variance =       0.339207907372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592671789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926717886       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926717886       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926717886       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912439048847       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.896298676976       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -13.370072046356       residual = 1.37e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.687189143796       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.814294365169       residual = 9.73e+00           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 4.225077e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926717886       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926717886       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926717886       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.990236311905       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.882170984929       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 1.056269e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926717886       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926717886       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926717886       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 2.640673e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6115e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.190295
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3703e-01
  Total weights = 2.0000e+06
  Execution time = 1.8606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410504383
  error estimate for blocks of size 2^( 2) =       0.000423633958
  error estimate for blocks of size 2^( 3) =       0.000437273499
  error estimate for blocks of size 2^( 4) =       0.000449876056
  error estimate for blocks of size 2^( 5) =       0.000460818995
  error estimate for blocks of size 2^( 6) =       0.000469263967
  error estimate for blocks of size 2^( 7) =       0.000474480713

      target function =                  N/A
              le_mean =     -16.905577432064
             les_mean =     286.135575839996
             stat err =       0.000463609933
             autocorr =       1.275468879704
              std dev =       0.580540865926
             le_variance =       0.337027697010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410504383
  error estimate for blocks of size 2^( 2) =       0.000423633958
  error estimate for blocks of size 2^( 3) =       0.000437273499
  error estimate for blocks of size 2^( 4) =       0.000449876056
  error estimate for blocks of size 2^( 5) =       0.000460818995
  error estimate for blocks of size 2^( 6) =       0.000469263967
  error estimate for blocks of size 2^( 7) =       0.000474480713

      target function =                  N/A
              le_mean =     -16.905577432064
             les_mean =     286.135575839996
             stat err =       0.000463609933
             autocorr =       1.275468879704
              std dev =       0.580540865926
             le_variance =       0.337027697010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410504383
  error estimate for blocks of size 2^( 2) =       0.000423633958
  error estimate for blocks of size 2^( 3) =       0.000437273499
  error estimate for blocks of size 2^( 4) =       0.000449876056
  error estimate for blocks of size 2^( 5) =       0.000460818995
  error estimate for blocks of size 2^( 6) =       0.000469263967
  error estimate for blocks of size 2^( 7) =       0.000474480713

      target function =                  N/A
              le_mean =     -16.905577432064
             les_mean =     286.135575839996
             stat err =       0.000463609933
             autocorr =       1.275468879704
              std dev =       0.580540865926
             le_variance =       0.337027697010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337062181065
                                         uncertainty =       0.003075554397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410504383
  error estimate for blocks of size 2^( 2) =       0.000423633958
  error estimate for blocks of size 2^( 3) =       0.000437273499
  error estimate for blocks of size 2^( 4) =       0.000449876056
  error estimate for blocks of size 2^( 5) =       0.000460818995
  error estimate for blocks of size 2^( 6) =       0.000469263967
  error estimate for blocks of size 2^( 7) =       0.000474480713

      target function =                  N/A
              le_mean =     -16.905577432064
             les_mean =     286.135575839996
             stat err =       0.000463609933
             autocorr =       1.275468879704
              std dev =       0.580540865926
             le_variance =       0.337027697010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905577432064        initial  <--
     9.5367e+14     9.5367e+15             4.2251e-20       -16.905577432064
     3.8147e+15     3.8147e+16             1.0563e-20       -16.905577432064
     1.5259e+16     1.5259e+17             2.6407e-21       -16.905577432064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7634
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9721
    reference variance = 0.319234
====================================================
  Execution time = 2.0375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3705e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337037845584
                                         uncertainty =       0.003023258021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337037845584
                                         uncertainty =       0.003023258021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410515600
  error estimate for blocks of size 2^( 2) =       0.000423236259
  error estimate for blocks of size 2^( 3) =       0.000435912144
  error estimate for blocks of size 2^( 4) =       0.000448023803
  error estimate for blocks of size 2^( 5) =       0.000458519879
  error estimate for blocks of size 2^( 6) =       0.000466762881
  error estimate for blocks of size 2^( 7) =       0.000470431592

      target function =                  N/A
              le_mean =     -16.905599928392
             les_mean =     286.136354886376
             stat err =       0.000460934539
             autocorr =       1.260721540321
              std dev =       0.580556729405
             le_variance =       0.337046116057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559992839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599928392       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5832e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.7686
    reference variance = 0.29843
====================================================
  Execution time = 2.0066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3662e-01
  Total weights = 2.0000e+06
  Execution time = 1.8572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410254276
  error estimate for blocks of size 2^( 2) =       0.000423087344
  error estimate for blocks of size 2^( 3) =       0.000436895320
  error estimate for blocks of size 2^( 4) =       0.000449641866
  error estimate for blocks of size 2^( 5) =       0.000460803703
  error estimate for blocks of size 2^( 6) =       0.000468614284
  error estimate for blocks of size 2^( 7) =       0.000475199513

      target function =                  N/A
              le_mean =     -16.905074221965
             les_mean =     286.118151423722
             stat err =       0.000463564842
             autocorr =       1.276776109463
              std dev =       0.580187161091
             le_variance =       0.336617141895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410254276
  error estimate for blocks of size 2^( 2) =       0.000423087344
  error estimate for blocks of size 2^( 3) =       0.000436895320
  error estimate for blocks of size 2^( 4) =       0.000449641866
  error estimate for blocks of size 2^( 5) =       0.000460803703
  error estimate for blocks of size 2^( 6) =       0.000468614284
  error estimate for blocks of size 2^( 7) =       0.000475199513

      target function =                  N/A
              le_mean =     -16.905074221965
             les_mean =     286.118151423722
             stat err =       0.000463564842
             autocorr =       1.276776109463
              std dev =       0.580187161091
             le_variance =       0.336617141895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410254276
  error estimate for blocks of size 2^( 2) =       0.000423087344
  error estimate for blocks of size 2^( 3) =       0.000436895320
  error estimate for blocks of size 2^( 4) =       0.000449641866
  error estimate for blocks of size 2^( 5) =       0.000460803703
  error estimate for blocks of size 2^( 6) =       0.000468614284
  error estimate for blocks of size 2^( 7) =       0.000475199513

      target function =                  N/A
              le_mean =     -16.905074221965
             les_mean =     286.118151423722
             stat err =       0.000463564842
             autocorr =       1.276776109463
              std dev =       0.580187161091
             le_variance =       0.336617141895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676233709
                                         uncertainty =       0.003808549545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410254276
  error estimate for blocks of size 2^( 2) =       0.000423087344
  error estimate for blocks of size 2^( 3) =       0.000436895320
  error estimate for blocks of size 2^( 4) =       0.000449641866
  error estimate for blocks of size 2^( 5) =       0.000460803703
  error estimate for blocks of size 2^( 6) =       0.000468614284
  error estimate for blocks of size 2^( 7) =       0.000475199513

      target function =                  N/A
              le_mean =     -16.905074221965
             les_mean =     286.118151423722
             stat err =       0.000463564842
             autocorr =       1.276776109463
              std dev =       0.580187161091
             le_variance =       0.336617141895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905074221965        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -16.905074221965
     3.8147e+16     3.8147e+17             0.0000e+00       -16.905074221965
     1.5259e+17     1.5259e+18             0.0000e+00       -16.905074221965

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4753
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.247594
====================================================
  Execution time = 2.0547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335903755155
                                         uncertainty =       0.004000665476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335903755155
                                         uncertainty =       0.004000665476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409797050
  error estimate for blocks of size 2^( 2) =       0.000422515781
  error estimate for blocks of size 2^( 3) =       0.000435423808
  error estimate for blocks of size 2^( 4) =       0.000447028546
  error estimate for blocks of size 2^( 5) =       0.000457763006
  error estimate for blocks of size 2^( 6) =       0.000467321492
  error estimate for blocks of size 2^( 7) =       0.000474930480

      target function =                  N/A
              le_mean =     -16.906272119146
             les_mean =     286.157904043082
             stat err =       0.000461760881
             autocorr =       1.269686847425
              std dev =       0.579540545952
             le_variance =       0.335867244402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627211915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272119146       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272119146       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272119146       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272119146       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 1.376579e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272119146       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272119146       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272119146       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272119145       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 3.441446e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272119146       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272119146       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272119146       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272119149       residual = 8.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 8.603616e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6043e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.0113
    reference variance = 1.03179
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4356e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414465591
  error estimate for blocks of size 2^( 2) =       0.000427083068
  error estimate for blocks of size 2^( 3) =       0.000440838219
  error estimate for blocks of size 2^( 4) =       0.000452845357
  error estimate for blocks of size 2^( 5) =       0.000462288173
  error estimate for blocks of size 2^( 6) =       0.000469536469
  error estimate for blocks of size 2^( 7) =       0.000474934402

      target function =                  N/A
              le_mean =     -16.905315836729
             les_mean =     286.133266820145
             stat err =       0.000464901100
             autocorr =       1.258184079114
              std dev =       0.586142860039
             le_variance =       0.343563452374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414465591
  error estimate for blocks of size 2^( 2) =       0.000427083068
  error estimate for blocks of size 2^( 3) =       0.000440838219
  error estimate for blocks of size 2^( 4) =       0.000452845357
  error estimate for blocks of size 2^( 5) =       0.000462288173
  error estimate for blocks of size 2^( 6) =       0.000469536469
  error estimate for blocks of size 2^( 7) =       0.000474934402

      target function =                  N/A
              le_mean =     -16.905315836729
             les_mean =     286.133266820145
             stat err =       0.000464901100
             autocorr =       1.258184079114
              std dev =       0.586142860039
             le_variance =       0.343563452374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414465591
  error estimate for blocks of size 2^( 2) =       0.000427083068
  error estimate for blocks of size 2^( 3) =       0.000440838219
  error estimate for blocks of size 2^( 4) =       0.000452845357
  error estimate for blocks of size 2^( 5) =       0.000462288173
  error estimate for blocks of size 2^( 6) =       0.000469536469
  error estimate for blocks of size 2^( 7) =       0.000474934402

      target function =                  N/A
              le_mean =     -16.905315836729
             les_mean =     286.133266820145
             stat err =       0.000464901100
             autocorr =       1.258184079114
              std dev =       0.586142860039
             le_variance =       0.343563452374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343632951749
                                         uncertainty =       0.006727514375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414465591
  error estimate for blocks of size 2^( 2) =       0.000427083068
  error estimate for blocks of size 2^( 3) =       0.000440838219
  error estimate for blocks of size 2^( 4) =       0.000452845357
  error estimate for blocks of size 2^( 5) =       0.000462288173
  error estimate for blocks of size 2^( 6) =       0.000469536469
  error estimate for blocks of size 2^( 7) =       0.000474934402

      target function =                  N/A
              le_mean =     -16.905315836729
             les_mean =     286.133266820145
             stat err =       0.000464901100
             autocorr =       1.258184079114
              std dev =       0.586142860039
             le_variance =       0.343563452374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905315836729        initial  <--
     9.5367e+16     9.5367e+17             1.3766e-21       -16.905315836729
     3.8147e+17     3.8147e+18             3.4414e-22       -16.905315836729
     1.5259e+18     1.5259e+19             8.6036e-23       -16.905315836729

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2060
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9497
    reference variance = 0.236848
====================================================
  Execution time = 2.2317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3705e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055396322
                                         uncertainty =       0.003579381405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055396322
                                         uncertainty =       0.003579381405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410520735
  error estimate for blocks of size 2^( 2) =       0.000423654095
  error estimate for blocks of size 2^( 3) =       0.000437204463
  error estimate for blocks of size 2^( 4) =       0.000450111058
  error estimate for blocks of size 2^( 5) =       0.000461194105
  error estimate for blocks of size 2^( 6) =       0.000468791156
  error estimate for blocks of size 2^( 7) =       0.000475927856

      target function =                  N/A
              le_mean =     -16.906071835746
             les_mean =     286.152319295326
             stat err =       0.000464006044
             autocorr =       1.277547563957
              std dev =       0.580563991697
             le_variance =       0.337054548455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607183575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071835746       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071835746       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071835746       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 4.256229e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071835746       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071835746       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071835746       residual = 7.76e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906071835747       residual = 7.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 1.064057e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071835746       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071835746       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071835746       residual = 7.76e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 2.660143e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7812e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9588
    reference variance = 0.305597
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.0000e+06
  Execution time = 2.1789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604455
  error estimate for blocks of size 2^( 2) =       0.000424138912
  error estimate for blocks of size 2^( 3) =       0.000436860521
  error estimate for blocks of size 2^( 4) =       0.000449082846
  error estimate for blocks of size 2^( 5) =       0.000458241065
  error estimate for blocks of size 2^( 6) =       0.000464394821
  error estimate for blocks of size 2^( 7) =       0.000469092922

      target function =                  N/A
              le_mean =     -16.905733901950
             les_mean =     286.142675048047
             stat err =       0.000460202913
             autocorr =       1.250082267949
              std dev =       0.582096601893
             le_variance =       0.338836453935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604455
  error estimate for blocks of size 2^( 2) =       0.000424138912
  error estimate for blocks of size 2^( 3) =       0.000436860521
  error estimate for blocks of size 2^( 4) =       0.000449082846
  error estimate for blocks of size 2^( 5) =       0.000458241065
  error estimate for blocks of size 2^( 6) =       0.000464394821
  error estimate for blocks of size 2^( 7) =       0.000469092922

      target function =                  N/A
              le_mean =     -16.905733901950
             les_mean =     286.142675048047
             stat err =       0.000460202913
             autocorr =       1.250082267949
              std dev =       0.582096601893
             le_variance =       0.338836453935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604455
  error estimate for blocks of size 2^( 2) =       0.000424138912
  error estimate for blocks of size 2^( 3) =       0.000436860521
  error estimate for blocks of size 2^( 4) =       0.000449082846
  error estimate for blocks of size 2^( 5) =       0.000458241065
  error estimate for blocks of size 2^( 6) =       0.000464394821
  error estimate for blocks of size 2^( 7) =       0.000469092922

      target function =                  N/A
              le_mean =     -16.905733901950
             les_mean =     286.142675048047
             stat err =       0.000460202913
             autocorr =       1.250082267949
              std dev =       0.582096601893
             le_variance =       0.338836453935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807926447
                                         uncertainty =       0.005567685675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604455
  error estimate for blocks of size 2^( 2) =       0.000424138912
  error estimate for blocks of size 2^( 3) =       0.000436860521
  error estimate for blocks of size 2^( 4) =       0.000449082846
  error estimate for blocks of size 2^( 5) =       0.000458241065
  error estimate for blocks of size 2^( 6) =       0.000464394821
  error estimate for blocks of size 2^( 7) =       0.000469092922

      target function =                  N/A
              le_mean =     -16.905733901950
             les_mean =     286.142675048047
             stat err =       0.000460202913
             autocorr =       1.250082267949
              std dev =       0.582096601893
             le_variance =       0.338836453935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905733901950        initial  <--
     9.5367e+17     9.5367e+18             4.2562e-23       -16.905733901950
     3.8147e+18     3.8147e+19             1.0641e-23       -16.905733901950
     1.5259e+19     1.5259e+20             2.6601e-24       -16.905733901950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0015
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9187
    reference variance = 0.288942
====================================================
  Execution time = 2.0200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801329804
                                         uncertainty =       0.004378505973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801329804
                                         uncertainty =       0.004378505973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410969481
  error estimate for blocks of size 2^( 2) =       0.000424125825
  error estimate for blocks of size 2^( 3) =       0.000437876458
  error estimate for blocks of size 2^( 4) =       0.000450682385
  error estimate for blocks of size 2^( 5) =       0.000462293058
  error estimate for blocks of size 2^( 6) =       0.000469728741
  error estimate for blocks of size 2^( 7) =       0.000473732274

      target function =                  N/A
              le_mean =     -16.904931644008
             les_mean =     286.114505548854
             stat err =       0.000464109115
             autocorr =       1.275325521741
              std dev =       0.581198614225
             le_variance =       0.337791829177


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690493164401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931644008       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5755e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.222841
====================================================
  Execution time = 2.0678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3704e-01
  Total weights = 2.0000e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410510975
  error estimate for blocks of size 2^( 2) =       0.000423347960
  error estimate for blocks of size 2^( 3) =       0.000436437060
  error estimate for blocks of size 2^( 4) =       0.000449352739
  error estimate for blocks of size 2^( 5) =       0.000458986664
  error estimate for blocks of size 2^( 6) =       0.000466725408
  error estimate for blocks of size 2^( 7) =       0.000470700102

      target function =                  N/A
              le_mean =     -16.905355371443
             les_mean =     286.128078587990
             stat err =       0.000461441228
             autocorr =       1.263523268047
              std dev =       0.580550188803
             le_variance =       0.337038521719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410510975
  error estimate for blocks of size 2^( 2) =       0.000423347960
  error estimate for blocks of size 2^( 3) =       0.000436437060
  error estimate for blocks of size 2^( 4) =       0.000449352739
  error estimate for blocks of size 2^( 5) =       0.000458986664
  error estimate for blocks of size 2^( 6) =       0.000466725408
  error estimate for blocks of size 2^( 7) =       0.000470700102

      target function =                  N/A
              le_mean =     -16.905355371443
             les_mean =     286.128078587990
             stat err =       0.000461441228
             autocorr =       1.263523268047
              std dev =       0.580550188803
             le_variance =       0.337038521719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410510975
  error estimate for blocks of size 2^( 2) =       0.000423347960
  error estimate for blocks of size 2^( 3) =       0.000436437060
  error estimate for blocks of size 2^( 4) =       0.000449352739
  error estimate for blocks of size 2^( 5) =       0.000458986664
  error estimate for blocks of size 2^( 6) =       0.000466725408
  error estimate for blocks of size 2^( 7) =       0.000470700102

      target function =                  N/A
              le_mean =     -16.905355371443
             les_mean =     286.128078587990
             stat err =       0.000461441228
             autocorr =       1.263523268047
              std dev =       0.580550188803
             le_variance =       0.337038521719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336889773646
                                         uncertainty =       0.004694667835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410510975
  error estimate for blocks of size 2^( 2) =       0.000423347960
  error estimate for blocks of size 2^( 3) =       0.000436437060
  error estimate for blocks of size 2^( 4) =       0.000449352739
  error estimate for blocks of size 2^( 5) =       0.000458986664
  error estimate for blocks of size 2^( 6) =       0.000466725408
  error estimate for blocks of size 2^( 7) =       0.000470700102

      target function =                  N/A
              le_mean =     -16.905355371443
             les_mean =     286.128078587990
             stat err =       0.000461441228
             autocorr =       1.263523268047
              std dev =       0.580550188803
             le_variance =       0.337038521719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905355371443        initial  <--
     9.5367e+18     9.5367e+19             0.0000e+00       -16.905355371443
     3.8147e+19     3.8147e+20             0.0000e+00       -16.905355371443
     1.5259e+20     1.5259e+21             0.0000e+00       -16.905355371443

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0456
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8534
    reference variance = 0.131652
====================================================
  Execution time = 2.0857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335436850688
                                         uncertainty =       0.003323032452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335436850688
                                         uncertainty =       0.003323032452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409552348
  error estimate for blocks of size 2^( 2) =       0.000422378908
  error estimate for blocks of size 2^( 3) =       0.000435403597
  error estimate for blocks of size 2^( 4) =       0.000447380671
  error estimate for blocks of size 2^( 5) =       0.000457434589
  error estimate for blocks of size 2^( 6) =       0.000466259253
  error estimate for blocks of size 2^( 7) =       0.000471278344

      target function =                  N/A
              le_mean =     -16.905453912802
             les_mean =     286.129838082049
             stat err =       0.000460588214
             autocorr =       1.264756154283
              std dev =       0.579194485402
             le_variance =       0.335466251920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545391280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905453912802       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6314e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.894
    reference variance = 0.175364
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4540e-01
  Total weights = 2.0000e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415569902
  error estimate for blocks of size 2^( 2) =       0.000428274619
  error estimate for blocks of size 2^( 3) =       0.000440901025
  error estimate for blocks of size 2^( 4) =       0.000452910655
  error estimate for blocks of size 2^( 5) =       0.000462874063
  error estimate for blocks of size 2^( 6) =       0.000471748589
  error estimate for blocks of size 2^( 7) =       0.000477427640

      target function =                  N/A
              le_mean =     -16.906092040723
             les_mean =     286.161344603518
             stat err =       0.000466240237
             autocorr =       1.258726366912
              std dev =       0.587704591469
             le_variance =       0.345396686833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415569902
  error estimate for blocks of size 2^( 2) =       0.000428274619
  error estimate for blocks of size 2^( 3) =       0.000440901025
  error estimate for blocks of size 2^( 4) =       0.000452910655
  error estimate for blocks of size 2^( 5) =       0.000462874063
  error estimate for blocks of size 2^( 6) =       0.000471748589
  error estimate for blocks of size 2^( 7) =       0.000477427640

      target function =                  N/A
              le_mean =     -16.906092040723
             les_mean =     286.161344603518
             stat err =       0.000466240237
             autocorr =       1.258726366912
              std dev =       0.587704591469
             le_variance =       0.345396686833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415569902
  error estimate for blocks of size 2^( 2) =       0.000428274619
  error estimate for blocks of size 2^( 3) =       0.000440901025
  error estimate for blocks of size 2^( 4) =       0.000452910655
  error estimate for blocks of size 2^( 5) =       0.000462874063
  error estimate for blocks of size 2^( 6) =       0.000471748589
  error estimate for blocks of size 2^( 7) =       0.000477427640

      target function =                  N/A
              le_mean =     -16.906092040723
             les_mean =     286.161344603518
             stat err =       0.000466240237
             autocorr =       1.258726366912
              std dev =       0.587704591469
             le_variance =       0.345396686833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450732002
                                         uncertainty =       0.005404856217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415569902
  error estimate for blocks of size 2^( 2) =       0.000428274619
  error estimate for blocks of size 2^( 3) =       0.000440901025
  error estimate for blocks of size 2^( 4) =       0.000452910655
  error estimate for blocks of size 2^( 5) =       0.000462874063
  error estimate for blocks of size 2^( 6) =       0.000471748589
  error estimate for blocks of size 2^( 7) =       0.000477427640

      target function =                  N/A
              le_mean =     -16.906092040723
             les_mean =     286.161344603518
             stat err =       0.000466240237
             autocorr =       1.258726366912
              std dev =       0.587704591469
             le_variance =       0.345396686833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906092040723        initial  <--
     9.5367e+19     9.5367e+20             0.0000e+00       -16.906092040723
     3.8147e+20     3.8147e+21             0.0000e+00       -16.906092040723
     1.5259e+21     1.5259e+22             0.0000e+00       -16.906092040723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8382
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9887
    reference variance = 0.216929
====================================================
  Execution time = 2.0245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736084388
                                         uncertainty =       0.002848213182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334736084388
                                         uncertainty =       0.002848213182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409054683
  error estimate for blocks of size 2^( 2) =       0.000422003053
  error estimate for blocks of size 2^( 3) =       0.000435571891
  error estimate for blocks of size 2^( 4) =       0.000448610892
  error estimate for blocks of size 2^( 5) =       0.000458802381
  error estimate for blocks of size 2^( 6) =       0.000465278976
  error estimate for blocks of size 2^( 7) =       0.000472967686

      target function =                  N/A
              le_mean =     -16.905747909049
             les_mean =     286.138963664565
             stat err =       0.000461414984
             autocorr =       1.272391175301
              std dev =       0.578490680643
             le_variance =       0.334651467590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574790905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747909049       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747909049       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747909049       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747909049       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5841e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.279054
====================================================
  Execution time = 2.0256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4052e-01
  Total weights = 2.0000e+06
  Execution time = 1.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412626418
  error estimate for blocks of size 2^( 2) =       0.000425856910
  error estimate for blocks of size 2^( 3) =       0.000438848505
  error estimate for blocks of size 2^( 4) =       0.000451395611
  error estimate for blocks of size 2^( 5) =       0.000461776480
  error estimate for blocks of size 2^( 6) =       0.000468832535
  error estimate for blocks of size 2^( 7) =       0.000477715407

      target function =                  N/A
              le_mean =     -16.905841020739
             les_mean =     286.147981569355
             stat err =       0.000464930008
             autocorr =       1.269582997210
              std dev =       0.583541876067
             le_variance =       0.340521121123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412626418
  error estimate for blocks of size 2^( 2) =       0.000425856910
  error estimate for blocks of size 2^( 3) =       0.000438848505
  error estimate for blocks of size 2^( 4) =       0.000451395611
  error estimate for blocks of size 2^( 5) =       0.000461776480
  error estimate for blocks of size 2^( 6) =       0.000468832535
  error estimate for blocks of size 2^( 7) =       0.000477715407

      target function =                  N/A
              le_mean =     -16.905841020739
             les_mean =     286.147981569355
             stat err =       0.000464930008
             autocorr =       1.269582997210
              std dev =       0.583541876067
             le_variance =       0.340521121123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412626418
  error estimate for blocks of size 2^( 2) =       0.000425856910
  error estimate for blocks of size 2^( 3) =       0.000438848505
  error estimate for blocks of size 2^( 4) =       0.000451395611
  error estimate for blocks of size 2^( 5) =       0.000461776480
  error estimate for blocks of size 2^( 6) =       0.000468832535
  error estimate for blocks of size 2^( 7) =       0.000477715407

      target function =                  N/A
              le_mean =     -16.905841020739
             les_mean =     286.147981569355
             stat err =       0.000464930008
             autocorr =       1.269582997210
              std dev =       0.583541876067
             le_variance =       0.340521121123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506247348
                                         uncertainty =       0.004496721126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412626418
  error estimate for blocks of size 2^( 2) =       0.000425856910
  error estimate for blocks of size 2^( 3) =       0.000438848505
  error estimate for blocks of size 2^( 4) =       0.000451395611
  error estimate for blocks of size 2^( 5) =       0.000461776480
  error estimate for blocks of size 2^( 6) =       0.000468832535
  error estimate for blocks of size 2^( 7) =       0.000477715407

      target function =                  N/A
              le_mean =     -16.905841020739
             les_mean =     286.147981569355
             stat err =       0.000464930008
             autocorr =       1.269582997210
              std dev =       0.583541876067
             le_variance =       0.340521121123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905841020739        initial  <--
     9.5367e+20     9.5367e+21             0.0000e+00       -16.905841020739
     3.8147e+21     3.8147e+22             0.0000e+00       -16.905841020739
     1.5259e+22     1.5259e+23             0.0000e+00       -16.905841020739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7922
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.277959
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841788133
                                         uncertainty =       0.003710421383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841788133
                                         uncertainty =       0.003710421383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411029115
  error estimate for blocks of size 2^( 2) =       0.000423636296
  error estimate for blocks of size 2^( 3) =       0.000436802760
  error estimate for blocks of size 2^( 4) =       0.000449474616
  error estimate for blocks of size 2^( 5) =       0.000459465873
  error estimate for blocks of size 2^( 6) =       0.000467921612
  error estimate for blocks of size 2^( 7) =       0.000474075498

      target function =                  N/A
              le_mean =     -16.905976616837
             les_mean =     286.149935067279
             stat err =       0.000462734400
             autocorr =       1.267413707787
              std dev =       0.581282949319
             le_variance =       0.337889867169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597661684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905976616837       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905976616837       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905976616838       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905976616837       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905976616837       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905976616838       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905976616837       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905976616837       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905976616838       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5873e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.342321
====================================================
  Execution time = 2.0641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3801e-01
  Total weights = 2.0000e+06
  Execution time = 1.8622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104729
  error estimate for blocks of size 2^( 2) =       0.000423863980
  error estimate for blocks of size 2^( 3) =       0.000436512985
  error estimate for blocks of size 2^( 4) =       0.000449451855
  error estimate for blocks of size 2^( 5) =       0.000460487488
  error estimate for blocks of size 2^( 6) =       0.000468340277
  error estimate for blocks of size 2^( 7) =       0.000472262287

      target function =                  N/A
              le_mean =     -16.905413965172
             les_mean =     286.131035360734
             stat err =       0.000462635477
             autocorr =       1.266405889928
              std dev =       0.581389882869
             le_variance =       0.338014195902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104729
  error estimate for blocks of size 2^( 2) =       0.000423863980
  error estimate for blocks of size 2^( 3) =       0.000436512985
  error estimate for blocks of size 2^( 4) =       0.000449451855
  error estimate for blocks of size 2^( 5) =       0.000460487488
  error estimate for blocks of size 2^( 6) =       0.000468340277
  error estimate for blocks of size 2^( 7) =       0.000472262287

      target function =                  N/A
              le_mean =     -16.905413965172
             les_mean =     286.131035360734
             stat err =       0.000462635477
             autocorr =       1.266405889928
              std dev =       0.581389882869
             le_variance =       0.338014195902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104729
  error estimate for blocks of size 2^( 2) =       0.000423863980
  error estimate for blocks of size 2^( 3) =       0.000436512985
  error estimate for blocks of size 2^( 4) =       0.000449451855
  error estimate for blocks of size 2^( 5) =       0.000460487488
  error estimate for blocks of size 2^( 6) =       0.000468340277
  error estimate for blocks of size 2^( 7) =       0.000472262287

      target function =                  N/A
              le_mean =     -16.905413965172
             les_mean =     286.131035360734
             stat err =       0.000462635477
             autocorr =       1.266405889928
              std dev =       0.581389882869
             le_variance =       0.338014195902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133565974
                                         uncertainty =       0.003500924570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104729
  error estimate for blocks of size 2^( 2) =       0.000423863980
  error estimate for blocks of size 2^( 3) =       0.000436512985
  error estimate for blocks of size 2^( 4) =       0.000449451855
  error estimate for blocks of size 2^( 5) =       0.000460487488
  error estimate for blocks of size 2^( 6) =       0.000468340277
  error estimate for blocks of size 2^( 7) =       0.000472262287

      target function =                  N/A
              le_mean =     -16.905413965172
             les_mean =     286.131035360734
             stat err =       0.000462635477
             autocorr =       1.266405889928
              std dev =       0.581389882869
             le_variance =       0.338014195902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905413965172        initial  <--
     9.5367e+21     9.5367e+22             0.0000e+00       -16.905413965172
     3.8147e+22     3.8147e+23             0.0000e+00       -16.905413965172
     1.5259e+23     1.5259e+24             0.0000e+00       -16.905413965172

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0349
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.823076
====================================================
  Execution time = 2.0260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4996e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350007173782
                                         uncertainty =       0.007430814922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350007173782
                                         uncertainty =       0.007430814922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418309114
  error estimate for blocks of size 2^( 2) =       0.000431258603
  error estimate for blocks of size 2^( 3) =       0.000444720788
  error estimate for blocks of size 2^( 4) =       0.000457080929
  error estimate for blocks of size 2^( 5) =       0.000468872871
  error estimate for blocks of size 2^( 6) =       0.000478664911
  error estimate for blocks of size 2^( 7) =       0.000483066994

      target function =                  N/A
              le_mean =     -16.906228005530
             les_mean =     286.170510228905
             stat err =       0.000471921426
             autocorr =       1.272754783308
              std dev =       0.591578421603
             le_variance =       0.349965028906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622800553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906228005530       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906228005530       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906228005530       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906228005530       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906228005530       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906228005530       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906228005530       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906228005530       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906228005530       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906228005530       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+24 is 5.521114e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5832e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.32425
====================================================
  Execution time = 2.2033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4496e-01
  Total weights = 2.0000e+06
  Execution time = 1.8557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415308264
  error estimate for blocks of size 2^( 2) =       0.000428467825
  error estimate for blocks of size 2^( 3) =       0.000441789833
  error estimate for blocks of size 2^( 4) =       0.000454676767
  error estimate for blocks of size 2^( 5) =       0.000465626791
  error estimate for blocks of size 2^( 6) =       0.000474756474
  error estimate for blocks of size 2^( 7) =       0.000478362140

      target function =                  N/A
              le_mean =     -16.906147053293
             les_mean =     286.162769923603
             stat err =       0.000468355543
             autocorr =       1.271774703929
              std dev =       0.587334579699
             le_variance =       0.344961908510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415308264
  error estimate for blocks of size 2^( 2) =       0.000428467825
  error estimate for blocks of size 2^( 3) =       0.000441789833
  error estimate for blocks of size 2^( 4) =       0.000454676767
  error estimate for blocks of size 2^( 5) =       0.000465626791
  error estimate for blocks of size 2^( 6) =       0.000474756474
  error estimate for blocks of size 2^( 7) =       0.000478362140

      target function =                  N/A
              le_mean =     -16.906147053293
             les_mean =     286.162769923603
             stat err =       0.000468355543
             autocorr =       1.271774703929
              std dev =       0.587334579699
             le_variance =       0.344961908510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415308264
  error estimate for blocks of size 2^( 2) =       0.000428467825
  error estimate for blocks of size 2^( 3) =       0.000441789833
  error estimate for blocks of size 2^( 4) =       0.000454676767
  error estimate for blocks of size 2^( 5) =       0.000465626791
  error estimate for blocks of size 2^( 6) =       0.000474756474
  error estimate for blocks of size 2^( 7) =       0.000478362140

      target function =                  N/A
              le_mean =     -16.906147053293
             les_mean =     286.162769923603
             stat err =       0.000468355543
             autocorr =       1.271774703929
              std dev =       0.587334579699
             le_variance =       0.344961908510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344926118498
                                         uncertainty =       0.004925958845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415308264
  error estimate for blocks of size 2^( 2) =       0.000428467825
  error estimate for blocks of size 2^( 3) =       0.000441789833
  error estimate for blocks of size 2^( 4) =       0.000454676767
  error estimate for blocks of size 2^( 5) =       0.000465626791
  error estimate for blocks of size 2^( 6) =       0.000474756474
  error estimate for blocks of size 2^( 7) =       0.000478362140

      target function =                  N/A
              le_mean =     -16.906147053293
             les_mean =     286.162769923603
             stat err =       0.000468355543
             autocorr =       1.271774703929
              std dev =       0.587334579699
             le_variance =       0.344961908510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906147053293        initial  <--
     9.5367e+22     9.5367e+23             0.0000e+00       -16.906147053293
     3.8147e+23     3.8147e+24             0.0000e+00       -16.906147053293
     1.5259e+24     1.5259e+25             5.5211e-29       -16.906147053293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4010
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.083072e-01 1 1  ON 0
 uu_1                 1.418335e-01 1 1  ON 1
 uu_2                 4.068477e-02 1 1  ON 2
 uu_3                -2.080713e-02 1 1  ON 3
 uu_4                -6.473429e-02 1 1  ON 4
 uu_5                -9.793577e-02 1 1  ON 5
 uu_6                -1.234358e-01 1 1  ON 6
 uu_7                -1.362238e-01 1 1  ON 7
 uu_8                -1.288475e-01 1 1  ON 8
 uu_9                -9.825879e-02 1 1  ON 9
 ud_0                 4.456881e-01 1 1  ON 10
 ud_1                 1.799366e-01 1 1  ON 11
 ud_2                 5.927749e-02 1 1  ON 12
 ud_3                -1.165626e-02 1 1  ON 13
 ud_4                -6.783081e-02 1 1  ON 14
 ud_5                -1.080207e-01 1 1  ON 15
 ud_6                -1.341316e-01 1 1  ON 16
 ud_7                -1.495930e-01 1 1  ON 17
 ud_8                -1.492243e-01 1 1  ON 18
 ud_9                -1.372082e-01 1 1  ON 19
 eO_0                -7.596337e-01 1 1  ON 20
 eO_1                -4.383757e-01 1 1  ON 21
 eO_2                -1.685553e-02 1 1  ON 22
 eO_3                 3.022898e-01 1 1  ON 23
 eO_4                 5.214676e-01 1 1  ON 24
 eO_5                 4.756440e-01 1 1  ON 25
 eO_6                 2.443873e-01 1 1  ON 26
 eO_7                -5.235253e-02 1 1  ON 27
 eO_8                -2.096183e-01 1 1  ON 28
 eO_9                -6.833303e-02 1 1  ON 29
eH1_0                -2.362296e-01 1 1  ON 30
eH1_1                -1.368989e-01 1 1  ON 31
eH1_2                -9.137783e-02 1 1  ON 32
eH1_3                -3.798124e-02 1 1  ON 33
eH1_4                 8.899478e-03 1 1  ON 34
eH1_5                 4.250220e-02 1 1  ON 35
eH1_6                 9.881533e-02 1 1  ON 36
eH1_7                 1.478830e-01 1 1  ON 37
eH1_8                 1.618586e-01 1 1  ON 38
eH1_9                 4.685982e-02 1 1  ON 39
eH2_0                -2.329655e-01 1 1  ON 40
eH2_1                -1.337629e-01 1 1  ON 41
eH2_2                -8.814995e-02 1 1  ON 42
eH2_3                -3.494031e-02 1 1  ON 43
eH2_4                 1.228326e-02 1 1  ON 44
eH2_5                 4.599478e-02 1 1  ON 45
eH2_6                 1.017750e-01 1 1  ON 46
eH2_7                 1.496309e-01 1 1  ON 47
eH2_8                 1.671744e-01 1 1  ON 48
eH2_9                 3.091025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7238e+01 secs
  Total Execution time = 2.2807e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
