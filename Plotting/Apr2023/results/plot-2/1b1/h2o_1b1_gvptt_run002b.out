Rank =    0  Free Memory = 28925 MB
Rank =    1  Free Memory = 28925 MB
Rank =    2  Free Memory = 28924 MB
Rank =    3  Free Memory = 28924 MB
Rank =    4  Free Memory = 28924 MB
Rank =    5  Free Memory = 28924 MB
Rank =    6  Free Memory = 28922 MB
Rank =    7  Free Memory = 28922 MB
Rank =    8  Free Memory = 28922 MB
Rank =    9  Free Memory = 28922 MB
Rank =   10  Free Memory = 28921 MB
Rank =   11  Free Memory = 28921 MB
Rank =   12  Free Memory = 28921 MB
Rank =   13  Free Memory = 28921 MB
Rank =   14  Free Memory = 28921 MB
Rank =   15  Free Memory = 28907 MB
Rank =   16  Free Memory = 28907 MB
Rank =   17  Free Memory = 28907 MB
Rank =   18  Free Memory = 28907 MB
Rank =   19  Free Memory = 28907 MB
Rank =   20  Free Memory = 28907 MB
Rank =   21  Free Memory = 28907 MB
Rank =   22  Free Memory = 28907 MB
Rank =   23  Free Memory = 28907 MB
Rank =   24  Free Memory = 28907 MB
Rank =   25  Free Memory = 28907 MB
Rank =   26  Free Memory = 28907 MB
Rank =   27  Free Memory = 28907 MB
Rank =   28  Free Memory = 28907 MB
Rank =   29  Free Memory = 28907 MB
Rank =   30  Free Memory = 28907 MB
Rank =   31  Free Memory = 28907 MB
Rank =   32  Free Memory = 76948 MB
Rank =   33  Free Memory = 76948 MB
Rank =   34  Free Memory = 76948 MB
Rank =   35  Free Memory = 76948 MB
Rank =   36  Free Memory = 76948 MB
Rank =   37  Free Memory = 76948 MB
Rank =   38  Free Memory = 76948 MB
Rank =   39  Free Memory = 76948 MB
Rank =   40  Free Memory = 76948 MB
Rank =   41  Free Memory = 76948 MB
Rank =   42  Free Memory = 76947 MB
Rank =   43  Free Memory = 76947 MB
Rank =   44  Free Memory = 76947 MB
Rank =   45  Free Memory = 76947 MB
Rank =   46  Free Memory = 76947 MB
Rank =   47  Free Memory = 76947 MB
Rank =   48  Free Memory = 76947 MB
Rank =   49  Free Memory = 76947 MB
Rank =   50  Free Memory = 76947 MB
Rank =   51  Free Memory = 76947 MB
Rank =   52  Free Memory = 76947 MB
Rank =   53  Free Memory = 76947 MB
Rank =   54  Free Memory = 76947 MB
Rank =   55  Free Memory = 76947 MB
Rank =   56  Free Memory = 76947 MB
Rank =   57  Free Memory = 76947 MB
Rank =   58  Free Memory = 76947 MB
Rank =   59  Free Memory = 76947 MB
Rank =   60  Free Memory = 76947 MB
Rank =   61  Free Memory = 76947 MB
Rank =   62  Free Memory = 76947 MB
Rank =   63  Free Memory = 76947 MB
Rank =   64  Free Memory = 26849 MB
Rank =   65  Free Memory = 26849 MB
Rank =   66  Free Memory = 26849 MB
Rank =   67  Free Memory = 26849 MB
Rank =   68  Free Memory = 26849 MB
Rank =   69  Free Memory = 26848 MB
Rank =   70  Free Memory = 26848 MB
Rank =   71  Free Memory = 26848 MB
Rank =   72  Free Memory = 26848 MB
Rank =   73  Free Memory = 26848 MB
Rank =   74  Free Memory = 26848 MB
Rank =   75  Free Memory = 26848 MB
Rank =   76  Free Memory = 26848 MB
Rank =   77  Free Memory = 26848 MB
Rank =   78  Free Memory = 26848 MB
Rank =   79  Free Memory = 26848 MB
Rank =   80  Free Memory = 26848 MB
Rank =   81  Free Memory = 26848 MB
Rank =   82  Free Memory = 26848 MB
Rank =   83  Free Memory = 26848 MB
Rank =   84  Free Memory = 26848 MB
Rank =   85  Free Memory = 26848 MB
Rank =   86  Free Memory = 26848 MB
Rank =   87  Free Memory = 26848 MB
Rank =   88  Free Memory = 26848 MB
Rank =   89  Free Memory = 26848 MB
Rank =   90  Free Memory = 26848 MB
Rank =   91  Free Memory = 26848 MB
Rank =   92  Free Memory = 26848 MB
Rank =   93  Free Memory = 26848 MB
Rank =   94  Free Memory = 26848 MB
Rank =   95  Free Memory = 26848 MB
Rank =   96  Free Memory = 89821 MB
Rank =   97  Free Memory = 89820 MB
Rank =   98  Free Memory = 89820 MB
Rank =   99  Free Memory = 89820 MB
Rank =  100  Free Memory = 89820 MB
Rank =  101  Free Memory = 89820 MB
Rank =  102  Free Memory = 89820 MB
Rank =  103  Free Memory = 89820 MB
Rank =  104  Free Memory = 89820 MB
Rank =  105  Free Memory = 89820 MB
Rank =  106  Free Memory = 89820 MB
Rank =  107  Free Memory = 89820 MB
Rank =  108  Free Memory = 89820 MB
Rank =  109  Free Memory = 89820 MB
Rank =  110  Free Memory = 89820 MB
Rank =  111  Free Memory = 89820 MB
Rank =  112  Free Memory = 89820 MB
Rank =  113  Free Memory = 89820 MB
Rank =  114  Free Memory = 89820 MB
Rank =  115  Free Memory = 89820 MB
Rank =  116  Free Memory = 89820 MB
Rank =  117  Free Memory = 89820 MB
Rank =  118  Free Memory = 89820 MB
Rank =  119  Free Memory = 89820 MB
Rank =  120  Free Memory = 89820 MB
Rank =  121  Free Memory = 89820 MB
Rank =  122  Free Memory = 89820 MB
Rank =  123  Free Memory = 89820 MB
Rank =  124  Free Memory = 89820 MB
Rank =  125  Free Memory = 89820 MB
Rank =  126  Free Memory = 89820 MB
Rank =  127  Free Memory = 89820 MB
  Input file(s): opt_h2o_1b1_gvptt_run002b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002b.xml

  Project = H2O
  date    = 2023-03-12 23:31:42 PDT
  host    = n0052.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 846

  Range of prime numbers to use as seeds over processors and threads = 6563-7691


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.092499e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.0061e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.87
    reference variance = 0.244034
====================================================
  Execution time = 3.8144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320295363907
                                         uncertainty =       0.002326877495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320295363907
                                         uncertainty =       0.002326877495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400266829
  error estimate for blocks of size 2^( 2) =       0.000414484737
  error estimate for blocks of size 2^( 3) =       0.000429123530
  error estimate for blocks of size 2^( 4) =       0.000442533045
  error estimate for blocks of size 2^( 5) =       0.000454226009
  error estimate for blocks of size 2^( 6) =       0.000461147244
  error estimate for blocks of size 2^( 7) =       0.000465582384

      target function =                  N/A
              le_mean =     -16.904702283907
             les_mean =     286.089386216148
             stat err =       0.000455872171
             autocorr =       1.297140324613
              std dev =       0.566062778185
             le_variance =       0.320427068846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690470228391e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904702283907       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904948138298       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905095871738       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905142855816       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905199547495       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905234547562       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905235995981       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241279999       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905242664945       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905242170976       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905241782247       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905241493361       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905242061626       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.237492e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904702283907       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904803951106       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904873547317       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904891175458       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904915157475       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904920353233       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904922988263       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904922269059       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904923103710       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904922939207       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904923122779       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904923019403       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.250148e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904702283907       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904732669214       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904755216002       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904760624963       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904767830834       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904769153940       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904769446333       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904769471550       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904769397128       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904769489688       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904769455105       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.190631e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.748113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8761e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.026035e-01                 1 1 ON  0
uu_1  1.393595e-01                 1 1 ON  1
uu_2  4.122313e-02                 1 1 ON  2
uu_3  -1.927698e-02                1 1 ON  3
uu_4  -6.294698e-02                1 1 ON  4
uu_5  -9.575864e-02                1 1 ON  5
uu_6  -1.206307e-01                1 1 ON  6
uu_7  -1.311736e-01                1 1 ON  7
uu_8  -1.205044e-01                1 1 ON  8
uu_9  -9.275879e-02                1 1 ON  9
ud_0  4.149163e-01                 1 1 ON  10
ud_1  1.607854e-01                 1 1 ON  11
ud_2  5.909242e-02                 1 1 ON  12
ud_3  5.243940e-04                 1 1 ON  13
ud_4  -5.748957e-02                1 1 ON  14
ud_5  -1.017053e-01                1 1 ON  15
ud_6  -1.291079e-01                1 1 ON  16
ud_7  -1.438903e-01                1 1 ON  17
ud_8  -1.427873e-01                1 1 ON  18
ud_9  -1.345648e-01                1 1 ON  19
eO_0  -7.085602e-01                1 1 ON  20
eO_1  -4.143066e-01                1 1 ON  21
eO_2  -2.871693e-02                1 1 ON  22
eO_3  2.715403e-01                 1 1 ON  23
eO_4  4.919985e-01                 1 1 ON  24
eO_5  4.591006e-01                 1 1 ON  25
eO_6  2.358934e-01                 1 1 ON  26
eO_7  -5.592480e-02                1 1 ON  27
eO_8  -1.961011e-01                1 1 ON  28
eO_9  -5.782735e-02                1 1 ON  29
eH1_0 -2.111436e-01                1 1 ON  30
eH1_1 -1.275063e-01                1 1 ON  31
eH1_2 -8.819680e-02                1 1 ON  32
eH1_3 -3.704812e-02                1 1 ON  33
eH1_4 1.187588e-02                 1 1 ON  34
eH1_5 4.481941e-02                 1 1 ON  35
eH1_6 9.480299e-02                 1 1 ON  36
eH1_7 1.382148e-01                 1 1 ON  37
eH1_8 1.458542e-01                 1 1 ON  38
eH1_9 3.297183e-02                 1 1 ON  39
eH2_0 -2.100832e-01                1 1 ON  40
eH2_1 -1.265263e-01                1 1 ON  41
eH2_2 -8.712668e-02                1 1 ON  42
eH2_3 -3.594687e-02                1 1 ON  43
eH2_4 1.319428e-02                 1 1 ON  44
eH2_5 4.803049e-02                 1 1 ON  45
eH2_6 1.004697e-01                 1 1 ON  46
eH2_7 1.494449e-01                 1 1 ON  47
eH2_8 1.539006e-01                 1 1 ON  48
eH2_9 1.318669e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8412
    reference variance = 0.183265
====================================================
  Execution time = 3.6070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2738e-01
  Total weights = 2.0000e+06
  Execution time = 3.3874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326256909156
                                         uncertainty =       0.003767451874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326256909156
                                         uncertainty =       0.003767451874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403929108
  error estimate for blocks of size 2^( 2) =       0.000417683275
  error estimate for blocks of size 2^( 3) =       0.000432330569
  error estimate for blocks of size 2^( 4) =       0.000445746284
  error estimate for blocks of size 2^( 5) =       0.000457742633
  error estimate for blocks of size 2^( 6) =       0.000464026708
  error estimate for blocks of size 2^( 7) =       0.000464248065

      target function =                  N/A
              le_mean =     -16.904610421119
             les_mean =     286.092170775133
             stat err =       0.000457940922
             autocorr =       1.285312136591
              std dev =       0.571242022699
             le_variance =       0.326317448497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330345474138
                                         uncertainty =       0.003960235493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330345474138
                                         uncertainty =       0.003960235493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406452773
  error estimate for blocks of size 2^( 2) =       0.000419506810
  error estimate for blocks of size 2^( 3) =       0.000433509634
  error estimate for blocks of size 2^( 4) =       0.000446511821
  error estimate for blocks of size 2^( 5) =       0.000458251986
  error estimate for blocks of size 2^( 6) =       0.000464409905
  error estimate for blocks of size 2^( 7) =       0.000464928227

      target function =                  N/A
              le_mean =     -16.904650571166
             les_mean =     286.097618481802
             stat err =       0.000458525485
             autocorr =       1.272643532406
              std dev =       0.574811024400
             le_variance =       0.330407713771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329019823077
                                         uncertainty =       0.003908657095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329019823077
                                         uncertainty =       0.003908657095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405636349
  error estimate for blocks of size 2^( 2) =       0.000418822531
  error estimate for blocks of size 2^( 3) =       0.000432950071
  error estimate for blocks of size 2^( 4) =       0.000446028154
  error estimate for blocks of size 2^( 5) =       0.000457819376
  error estimate for blocks of size 2^( 6) =       0.000464006876
  error estimate for blocks of size 2^( 7) =       0.000464505057

      target function =                  N/A
              le_mean =     -16.904609006811
             les_mean =     286.094887203069
             stat err =       0.000458089866
             autocorr =       1.275344867584
              std dev =       0.573656425456
             le_variance =       0.329081694468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462070971
                                         uncertainty =       0.003787131502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462070971
                                         uncertainty =       0.003787131502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404056186
  error estimate for blocks of size 2^( 2) =       0.000417716290
  error estimate for blocks of size 2^( 3) =       0.000432280895
  error estimate for blocks of size 2^( 4) =       0.000445643417
  error estimate for blocks of size 2^( 5) =       0.000457608323
  error estimate for blocks of size 2^( 6) =       0.000463878632
  error estimate for blocks of size 2^( 7) =       0.000464145038

      target function =                  N/A
              le_mean =     -16.904585067099
             les_mean =     286.091518930475
             stat err =       0.000457818853
             autocorr =       1.283819077470
              std dev =       0.571421738254
             le_variance =       0.326522802949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904610421119        initial
     2.5000e-01     2.5000e+00             1.2375e-02       -16.904650571166  <--
     1.0000e+00     1.0000e+01             4.2501e-03       -16.904609006811
     4.0000e+00     4.0000e+01             1.1906e-03       -16.904585067099

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.3137e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.027371e-01 1 1  ON 0
 uu_1                 1.391329e-01 1 1  ON 1
 uu_2                 4.060384e-02 1 1  ON 2
 uu_3                -1.937543e-02 1 1  ON 3
 uu_4                -6.255666e-02 1 1  ON 4
 uu_5                -9.539975e-02 1 1  ON 5
 uu_6                -1.206673e-01 1 1  ON 6
 uu_7                -1.314744e-01 1 1  ON 7
 uu_8                -1.210259e-01 1 1  ON 8
 uu_9                -9.274185e-02 1 1  ON 9
 ud_0                 4.211496e-01 1 1  ON 10
 ud_1                 1.642738e-01 1 1  ON 11
 ud_2                 5.744907e-02 1 1  ON 12
 ud_3                -3.119992e-03 1 1  ON 13
 ud_4                -5.900634e-02 1 1  ON 14
 ud_5                -1.021692e-01 1 1  ON 15
 ud_6                -1.296938e-01 1 1  ON 16
 ud_7                -1.445698e-01 1 1  ON 17
 ud_8                -1.435734e-01 1 1  ON 18
 ud_9                -1.348112e-01 1 1  ON 19
 eO_0                -7.166849e-01 1 1  ON 20
 eO_1                -4.161262e-01 1 1  ON 21
 eO_2                -2.382964e-02 1 1  ON 22
 eO_3                 2.767021e-01 1 1  ON 23
 eO_4                 4.938476e-01 1 1  ON 24
 eO_5                 4.584231e-01 1 1  ON 25
 eO_6                 2.355350e-01 1 1  ON 26
 eO_7                -5.592077e-02 1 1  ON 27
 eO_8                -1.965765e-01 1 1  ON 28
 eO_9                -5.822111e-02 1 1  ON 29
eH1_0                -2.139767e-01 1 1  ON 30
eH1_1                -1.278501e-01 1 1  ON 31
eH1_2                -8.764877e-02 1 1  ON 32
eH1_3                -3.643896e-02 1 1  ON 33
eH1_4                 1.231213e-02 1 1  ON 34
eH1_5                 4.515065e-02 1 1  ON 35
eH1_6                 9.512020e-02 1 1  ON 36
eH1_7                 1.383903e-01 1 1  ON 37
eH1_8                 1.463342e-01 1 1  ON 38
eH1_9                 3.337238e-02 1 1  ON 39
eH2_0                -2.129963e-01 1 1  ON 40
eH2_1                -1.266953e-01 1 1  ON 41
eH2_2                -8.634551e-02 1 1  ON 42
eH2_3                -3.509187e-02 1 1  ON 43
eH2_4                 1.373049e-02 1 1  ON 44
eH2_5                 4.832590e-02 1 1  ON 45
eH2_6                 1.002629e-01 1 1  ON 46
eH2_7                 1.490438e-01 1 1  ON 47
eH2_8                 1.543501e-01 1 1  ON 48
eH2_9                 1.395957e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0190e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6856e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.248648
====================================================
  Execution time = 3.7272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0058e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324523164353
                                         uncertainty =       0.002923320619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324523164353
                                         uncertainty =       0.002923320619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402911032
  error estimate for blocks of size 2^( 2) =       0.000416335238
  error estimate for blocks of size 2^( 3) =       0.000430476033
  error estimate for blocks of size 2^( 4) =       0.000442626642
  error estimate for blocks of size 2^( 5) =       0.000453609526
  error estimate for blocks of size 2^( 6) =       0.000460121738
  error estimate for blocks of size 2^( 7) =       0.000462135899

      target function =                  N/A
              le_mean =     -16.905114703161
             les_mean =     286.107577564446
             stat err =       0.000454623451
             autocorr =       1.273166934081
              std dev =       0.569802246179
             le_variance =       0.324674599751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690511470316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905114703161       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905182794419       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277893978       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337309523       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905371248769       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403730994       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905414205442       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905433252128       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905436943306       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905439273110       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905441391947       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905441631381       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905440824923       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905440715854       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905441127086       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905441451899       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905441268699       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.839429e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905114703161       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905156499575       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905217941803       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241867148       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267002572       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905280514907       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905283751185       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905286285316       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905289053372       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905288062887       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905288557266       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905288569953       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905288406028       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.962304e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905114703161       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905131128062       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905157083278       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905163525176       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905175982575       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905178286858       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905178328378       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905178587714       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905179276595       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905179065661       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905179155402       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.600493e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.754740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7341e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.032501e-01 1 1  ON 0
 uu_1                 1.389452e-01 1 1  ON 1
 uu_2                 3.991774e-02 1 1  ON 2
 uu_3                -1.953635e-02 1 1  ON 3
 uu_4                -6.253530e-02 1 1  ON 4
 uu_5                -9.510685e-02 1 1  ON 5
 uu_6                -1.207055e-01 1 1  ON 6
 uu_7                -1.317948e-01 1 1  ON 7
 uu_8                -1.218171e-01 1 1  ON 8
 uu_9                -9.278654e-02 1 1  ON 9
 ud_0                 4.271096e-01 1 1  ON 10
 ud_1                 1.673793e-01 1 1  ON 11
 ud_2                 5.647952e-02 1 1  ON 12
 ud_3                -6.388245e-03 1 1  ON 13
 ud_4                -6.106287e-02 1 1  ON 14
 ud_5                -1.025207e-01 1 1  ON 15
 ud_6                -1.301854e-01 1 1  ON 16
 ud_7                -1.454926e-01 1 1  ON 17
 ud_8                -1.447268e-01 1 1  ON 18
 ud_9                -1.349399e-01 1 1  ON 19
 eO_0                -7.246472e-01 1 1  ON 20
 eO_1                -4.185435e-01 1 1  ON 21
 eO_2                -1.958612e-02 1 1  ON 22
 eO_3                 2.819534e-01 1 1  ON 23
 eO_4                 4.961132e-01 1 1  ON 24
 eO_5                 4.582530e-01 1 1  ON 25
 eO_6                 2.355834e-01 1 1  ON 26
 eO_7                -5.595762e-02 1 1  ON 27
 eO_8                -1.973395e-01 1 1  ON 28
 eO_9                -5.867984e-02 1 1  ON 29
eH1_0                -2.174348e-01 1 1  ON 30
eH1_1                -1.283195e-01 1 1  ON 31
eH1_2                -8.685654e-02 1 1  ON 32
eH1_3                -3.565414e-02 1 1  ON 33
eH1_4                 1.269144e-02 1 1  ON 34
eH1_5                 4.552979e-02 1 1  ON 35
eH1_6                 9.491899e-02 1 1  ON 36
eH1_7                 1.385309e-01 1 1  ON 37
eH1_8                 1.469941e-01 1 1  ON 38
eH1_9                 3.422627e-02 1 1  ON 39
eH2_0                -2.163272e-01 1 1  ON 40
eH2_1                -1.271799e-01 1 1  ON 41
eH2_2                -8.565753e-02 1 1  ON 42
eH2_3                -3.427899e-02 1 1  ON 43
eH2_4                 1.439236e-02 1 1  ON 44
eH2_5                 4.858961e-02 1 1  ON 45
eH2_6                 1.002851e-01 1 1  ON 46
eH2_7                 1.487561e-01 1 1  ON 47
eH2_8                 1.550028e-01 1 1  ON 48
eH2_9                 1.486304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8959
    reference variance = 0.273979
====================================================
  Execution time = 3.6208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3101e-01
  Total weights = 2.0000e+06
  Execution time = 3.3722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327484045553
                                         uncertainty =       0.003125825292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327484045553
                                         uncertainty =       0.003125825292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404616532
  error estimate for blocks of size 2^( 2) =       0.000417907561
  error estimate for blocks of size 2^( 3) =       0.000431461619
  error estimate for blocks of size 2^( 4) =       0.000444471198
  error estimate for blocks of size 2^( 5) =       0.000455008547
  error estimate for blocks of size 2^( 6) =       0.000461701276
  error estimate for blocks of size 2^( 7) =       0.000468076608

      target function =                  N/A
              le_mean =     -16.905586675273
             les_mean =     286.126289747227
             stat err =       0.000457314407
             autocorr =       1.277445910915
              std dev =       0.572214186970
             le_variance =       0.327429075770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334670043736
                                         uncertainty =       0.003256154376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334670043736
                                         uncertainty =       0.003256154376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032321
  error estimate for blocks of size 2^( 2) =       0.000421842731
  error estimate for blocks of size 2^( 3) =       0.000434966295
  error estimate for blocks of size 2^( 4) =       0.000447664623
  error estimate for blocks of size 2^( 5) =       0.000458054666
  error estimate for blocks of size 2^( 6) =       0.000464673947
  error estimate for blocks of size 2^( 7) =       0.000471069014

      target function =                  N/A
              le_mean =     -16.905602010175
             les_mean =     286.133994037762
             stat err =       0.000460365563
             autocorr =       1.266748520572
              std dev =       0.578459055282
             le_variance =       0.334614878638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335437475762
                                         uncertainty =       0.003262980765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335437475762
                                         uncertainty =       0.003262980765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409501183
  error estimate for blocks of size 2^( 2) =       0.000422275815
  error estimate for blocks of size 2^( 3) =       0.000435382363
  error estimate for blocks of size 2^( 4) =       0.000448079172
  error estimate for blocks of size 2^( 5) =       0.000458492508
  error estimate for blocks of size 2^( 6) =       0.000465124211
  error estimate for blocks of size 2^( 7) =       0.000471537478

      target function =                  N/A
              le_mean =     -16.905629448381
             les_mean =     286.135689315532
             stat err =       0.000460808342
             autocorr =       1.266281740818
              std dev =       0.579122126365
             le_variance =       0.335382437246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328760633239
                                         uncertainty =       0.003150333149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328760633239
                                         uncertainty =       0.003150333149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405404503
  error estimate for blocks of size 2^( 2) =       0.000418577097
  error estimate for blocks of size 2^( 3) =       0.000432032464
  error estimate for blocks of size 2^( 4) =       0.000444977265
  error estimate for blocks of size 2^( 5) =       0.000455491388
  error estimate for blocks of size 2^( 6) =       0.000462171753
  error estimate for blocks of size 2^( 7) =       0.000468556282

      target function =                  N/A
              le_mean =     -16.905551012260
             les_mean =     286.126360485108
             stat err =       0.000457799172
             autocorr =       1.275184046268
              std dev =       0.573328545716
             le_variance =       0.328705621333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905586675273        initial
     6.2500e-02     6.2500e-01             1.8394e-02       -16.905602010175
     2.5000e-01     2.5000e+00             7.9623e-03       -16.905629448381  <--
     1.0000e+00     1.0000e+01             2.6005e-03       -16.905551012260

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.3238e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.032501e-01 1 1  ON 0
 uu_1                 1.389452e-01 1 1  ON 1
 uu_2                 3.991774e-02 1 1  ON 2
 uu_3                -1.953635e-02 1 1  ON 3
 uu_4                -6.253530e-02 1 1  ON 4
 uu_5                -9.510685e-02 1 1  ON 5
 uu_6                -1.207055e-01 1 1  ON 6
 uu_7                -1.317948e-01 1 1  ON 7
 uu_8                -1.218171e-01 1 1  ON 8
 uu_9                -9.278654e-02 1 1  ON 9
 ud_0                 4.271096e-01 1 1  ON 10
 ud_1                 1.673793e-01 1 1  ON 11
 ud_2                 5.647952e-02 1 1  ON 12
 ud_3                -6.388245e-03 1 1  ON 13
 ud_4                -6.106287e-02 1 1  ON 14
 ud_5                -1.025207e-01 1 1  ON 15
 ud_6                -1.301854e-01 1 1  ON 16
 ud_7                -1.454926e-01 1 1  ON 17
 ud_8                -1.447268e-01 1 1  ON 18
 ud_9                -1.349399e-01 1 1  ON 19
 eO_0                -7.246472e-01 1 1  ON 20
 eO_1                -4.185435e-01 1 1  ON 21
 eO_2                -1.958612e-02 1 1  ON 22
 eO_3                 2.819534e-01 1 1  ON 23
 eO_4                 4.961132e-01 1 1  ON 24
 eO_5                 4.582530e-01 1 1  ON 25
 eO_6                 2.355834e-01 1 1  ON 26
 eO_7                -5.595762e-02 1 1  ON 27
 eO_8                -1.973395e-01 1 1  ON 28
 eO_9                -5.867984e-02 1 1  ON 29
eH1_0                -2.174348e-01 1 1  ON 30
eH1_1                -1.283195e-01 1 1  ON 31
eH1_2                -8.685654e-02 1 1  ON 32
eH1_3                -3.565414e-02 1 1  ON 33
eH1_4                 1.269144e-02 1 1  ON 34
eH1_5                 4.552979e-02 1 1  ON 35
eH1_6                 9.491899e-02 1 1  ON 36
eH1_7                 1.385309e-01 1 1  ON 37
eH1_8                 1.469941e-01 1 1  ON 38
eH1_9                 3.422627e-02 1 1  ON 39
eH2_0                -2.163272e-01 1 1  ON 40
eH2_1                -1.271799e-01 1 1  ON 41
eH2_2                -8.565753e-02 1 1  ON 42
eH2_3                -3.427899e-02 1 1  ON 43
eH2_4                 1.439236e-02 1 1  ON 44
eH2_5                 4.858961e-02 1 1  ON 45
eH2_6                 1.002851e-01 1 1  ON 46
eH2_7                 1.487561e-01 1 1  ON 47
eH2_8                 1.550028e-01 1 1  ON 48
eH2_9                 1.486304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0058e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.279615
====================================================
  Execution time = 3.6967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0116e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331643772351
                                         uncertainty =       0.005149404118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331643772351
                                         uncertainty =       0.005149404118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407156483
  error estimate for blocks of size 2^( 2) =       0.000420027100
  error estimate for blocks of size 2^( 3) =       0.000433576582
  error estimate for blocks of size 2^( 4) =       0.000446641118
  error estimate for blocks of size 2^( 5) =       0.000456284862
  error estimate for blocks of size 2^( 6) =       0.000462532114
  error estimate for blocks of size 2^( 7) =       0.000468641758

      target function =                  N/A
              le_mean =     -16.904626398875
             les_mean =     286.097946322537
             stat err =       0.000458524963
             autocorr =       1.268245299779
              std dev =       0.575806219804
             le_variance =       0.331552802764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690462639888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904626398875       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904656853598       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904681669783       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904727469522       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904742780053       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904759635502       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904765190512       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904764053870       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904768073480       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904773690798       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904776822100       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904774287286       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904775951982       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904777611258       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904777339977       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904777103493       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904777215240       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.347865e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904626398875       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904644693223       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904660085707       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904680852897       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904688923641       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904694884796       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904697564215       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904696697813       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904696020234       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904697288979       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904697706018       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904697413753       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904697456404       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.489874e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904626398875       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904633442798       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904639727635       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904643787380       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904648356463       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904649848515       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904650807752       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904650879143       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904650549613       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904650608504       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904650653143       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.728249e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.761379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7095e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.036905e-01 1 1  ON 0
 uu_1                 1.388984e-01 1 1  ON 1
 uu_2                 3.959090e-02 1 1  ON 2
 uu_3                -1.985795e-02 1 1  ON 3
 uu_4                -6.236013e-02 1 1  ON 4
 uu_5                -9.494084e-02 1 1  ON 5
 uu_6                -1.206867e-01 1 1  ON 6
 uu_7                -1.321517e-01 1 1  ON 7
 uu_8                -1.224745e-01 1 1  ON 8
 uu_9                -9.302077e-02 1 1  ON 9
 ud_0                 4.307354e-01 1 1  ON 10
 ud_1                 1.693853e-01 1 1  ON 11
 ud_2                 5.639434e-02 1 1  ON 12
 ud_3                -8.174550e-03 1 1  ON 13
 ud_4                -6.261899e-02 1 1  ON 14
 ud_5                -1.031710e-01 1 1  ON 15
 ud_6                -1.303403e-01 1 1  ON 16
 ud_7                -1.460163e-01 1 1  ON 17
 ud_8                -1.454068e-01 1 1  ON 18
 ud_9                -1.351736e-01 1 1  ON 19
 eO_0                -7.301371e-01 1 1  ON 20
 eO_1                -4.208558e-01 1 1  ON 21
 eO_2                -1.735253e-02 1 1  ON 22
 eO_3                 2.857592e-01 1 1  ON 23
 eO_4                 4.987267e-01 1 1  ON 24
 eO_5                 4.587810e-01 1 1  ON 25
 eO_6                 2.354674e-01 1 1  ON 26
 eO_7                -5.584094e-02 1 1  ON 27
 eO_8                -1.981674e-01 1 1  ON 28
 eO_9                -5.918175e-02 1 1  ON 29
eH1_0                -2.202614e-01 1 1  ON 30
eH1_1                -1.290179e-01 1 1  ON 31
eH1_2                -8.664599e-02 1 1  ON 32
eH1_3                -3.513490e-02 1 1  ON 33
eH1_4                 1.253459e-02 1 1  ON 34
eH1_5                 4.586854e-02 1 1  ON 35
eH1_6                 9.558051e-02 1 1  ON 36
eH1_7                 1.391752e-01 1 1  ON 37
eH1_8                 1.477485e-01 1 1  ON 38
eH1_9                 3.475170e-02 1 1  ON 39
eH2_0                -2.188304e-01 1 1  ON 40
eH2_1                -1.275550e-01 1 1  ON 41
eH2_2                -8.514017e-02 1 1  ON 42
eH2_3                -3.358334e-02 1 1  ON 43
eH2_4                 1.452658e-02 1 1  ON 44
eH2_5                 4.839395e-02 1 1  ON 45
eH2_6                 1.004343e-01 1 1  ON 46
eH2_7                 1.486553e-01 1 1  ON 47
eH2_8                 1.557163e-01 1 1  ON 48
eH2_9                 1.580206e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8522
    reference variance = 0.220447
====================================================
  Execution time = 3.7042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4224e-01
  Total weights = 2.0000e+06
  Execution time = 3.6679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340128662975
                                         uncertainty =       0.009999667622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340128662975
                                         uncertainty =       0.009999667622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341904
  error estimate for blocks of size 2^( 2) =       0.000425088778
  error estimate for blocks of size 2^( 3) =       0.000438107579
  error estimate for blocks of size 2^( 4) =       0.000450078892
  error estimate for blocks of size 2^( 5) =       0.000460026653
  error estimate for blocks of size 2^( 6) =       0.000466833437
  error estimate for blocks of size 2^( 7) =       0.000472896776

      target function =                  N/A
              le_mean =     -16.906124230931
             les_mean =     286.157088032448
             stat err =       0.000462458940
             autocorr =       1.257857417923
              std dev =       0.583139512282
             le_variance =       0.340051690785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344733859835
                                         uncertainty =       0.010046412856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344733859835
                                         uncertainty =       0.010046412856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415123814
  error estimate for blocks of size 2^( 2) =       0.000427657305
  error estimate for blocks of size 2^( 3) =       0.000440462970
  error estimate for blocks of size 2^( 4) =       0.000452273764
  error estimate for blocks of size 2^( 5) =       0.000462071809
  error estimate for blocks of size 2^( 6) =       0.000468740391
  error estimate for blocks of size 2^( 7) =       0.000474658140

      target function =                  N/A
              le_mean =     -16.906096616756
             les_mean =     286.160758204436
             stat err =       0.000464436026
             autocorr =       1.251689200433
              std dev =       0.587073727628
             le_variance =       0.344655561671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344750384756
                                         uncertainty =       0.010018332824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344750384756
                                         uncertainty =       0.010018332824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415133977
  error estimate for blocks of size 2^( 2) =       0.000427661175
  error estimate for blocks of size 2^( 3) =       0.000440465920
  error estimate for blocks of size 2^( 4) =       0.000452295013
  error estimate for blocks of size 2^( 5) =       0.000462113013
  error estimate for blocks of size 2^( 6) =       0.000468792302
  error estimate for blocks of size 2^( 7) =       0.000474730548

      target function =                  N/A
              le_mean =     -16.906098194535
             les_mean =     286.160828427956
             stat err =       0.000464482719
             autocorr =       1.251879598250
              std dev =       0.587088099892
             le_variance =       0.344672437035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340897621127
                                         uncertainty =       0.010000612386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340897621127
                                         uncertainty =       0.010000612386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412807768
  error estimate for blocks of size 2^( 2) =       0.000425508276
  error estimate for blocks of size 2^( 3) =       0.000438483074
  error estimate for blocks of size 2^( 4) =       0.000450427133
  error estimate for blocks of size 2^( 5) =       0.000460353268
  error estimate for blocks of size 2^( 6) =       0.000467137959
  error estimate for blocks of size 2^( 7) =       0.000473181181

      target function =                  N/A
              le_mean =     -16.906106676051
             les_mean =     286.157263278601
             stat err =       0.000462774885
             autocorr =       1.256735378518
              std dev =       0.583798344456
             le_variance =       0.340820506990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906124230931        initial  <--
     6.2500e-02     6.2500e-01             1.3479e-02       -16.906096616756
     2.5000e-01     2.5000e+00             5.4899e-03       -16.906098194535
     1.0000e+00     1.0000e+01             1.7282e-03       -16.906106676051

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5133
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.032501e-01 1 1  ON 0
 uu_1                 1.389452e-01 1 1  ON 1
 uu_2                 3.991774e-02 1 1  ON 2
 uu_3                -1.953635e-02 1 1  ON 3
 uu_4                -6.253530e-02 1 1  ON 4
 uu_5                -9.510685e-02 1 1  ON 5
 uu_6                -1.207055e-01 1 1  ON 6
 uu_7                -1.317948e-01 1 1  ON 7
 uu_8                -1.218171e-01 1 1  ON 8
 uu_9                -9.278654e-02 1 1  ON 9
 ud_0                 4.271096e-01 1 1  ON 10
 ud_1                 1.673793e-01 1 1  ON 11
 ud_2                 5.647952e-02 1 1  ON 12
 ud_3                -6.388245e-03 1 1  ON 13
 ud_4                -6.106287e-02 1 1  ON 14
 ud_5                -1.025207e-01 1 1  ON 15
 ud_6                -1.301854e-01 1 1  ON 16
 ud_7                -1.454926e-01 1 1  ON 17
 ud_8                -1.447268e-01 1 1  ON 18
 ud_9                -1.349399e-01 1 1  ON 19
 eO_0                -7.246472e-01 1 1  ON 20
 eO_1                -4.185435e-01 1 1  ON 21
 eO_2                -1.958612e-02 1 1  ON 22
 eO_3                 2.819534e-01 1 1  ON 23
 eO_4                 4.961132e-01 1 1  ON 24
 eO_5                 4.582530e-01 1 1  ON 25
 eO_6                 2.355834e-01 1 1  ON 26
 eO_7                -5.595762e-02 1 1  ON 27
 eO_8                -1.973395e-01 1 1  ON 28
 eO_9                -5.867984e-02 1 1  ON 29
eH1_0                -2.174348e-01 1 1  ON 30
eH1_1                -1.283195e-01 1 1  ON 31
eH1_2                -8.685654e-02 1 1  ON 32
eH1_3                -3.565414e-02 1 1  ON 33
eH1_4                 1.269144e-02 1 1  ON 34
eH1_5                 4.552979e-02 1 1  ON 35
eH1_6                 9.491899e-02 1 1  ON 36
eH1_7                 1.385309e-01 1 1  ON 37
eH1_8                 1.469941e-01 1 1  ON 38
eH1_9                 3.422627e-02 1 1  ON 39
eH2_0                -2.163272e-01 1 1  ON 40
eH2_1                -1.271799e-01 1 1  ON 41
eH2_2                -8.565753e-02 1 1  ON 42
eH2_3                -3.427899e-02 1 1  ON 43
eH2_4                 1.439236e-02 1 1  ON 44
eH2_5                 4.858961e-02 1 1  ON 45
eH2_6                 1.002851e-01 1 1  ON 46
eH2_7                 1.487561e-01 1 1  ON 47
eH2_8                 1.550028e-01 1 1  ON 48
eH2_9                 1.486304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0161e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.328757
====================================================
  Execution time = 3.9375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0045e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328920447176
                                         uncertainty =       0.003364607196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328920447176
                                         uncertainty =       0.003364607196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405584948
  error estimate for blocks of size 2^( 2) =       0.000418625696
  error estimate for blocks of size 2^( 3) =       0.000431909730
  error estimate for blocks of size 2^( 4) =       0.000444701735
  error estimate for blocks of size 2^( 5) =       0.000455684338
  error estimate for blocks of size 2^( 6) =       0.000464182816
  error estimate for blocks of size 2^( 7) =       0.000468352865

      target function =                  N/A
              le_mean =     -16.905205579485
             les_mean =     286.114973819859
             stat err =       0.000458230439
             autocorr =       1.276451186139
              std dev =       0.573583733824
             le_variance =       0.328998299707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520557948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905205579485       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905215340922       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905229319046       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905235838068       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905238070351       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905239603803       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905240348771       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905240589657       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905241748772       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905241458302       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905241470824       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.719844e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905205579485       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905208605417       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905213141455       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905214727325       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905215798340       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905216007174       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905216015970       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905215995286       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905216223898       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905216197259       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.756443e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905205579485       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905206384244       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905207611132       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905207999690       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905208324319       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905208357155       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905208330755       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905208338304       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905208379447       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.012792e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.765002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9429e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.032905e-01 1 1  ON 0
 uu_1                 1.389331e-01 1 1  ON 1
 uu_2                 3.988337e-02 1 1  ON 2
 uu_3                -1.958347e-02 1 1  ON 3
 uu_4                -6.241549e-02 1 1  ON 4
 uu_5                -9.508452e-02 1 1  ON 5
 uu_6                -1.207070e-01 1 1  ON 6
 uu_7                -1.318503e-01 1 1  ON 7
 uu_8                -1.219220e-01 1 1  ON 8
 uu_9                -9.280726e-02 1 1  ON 9
 ud_0                 4.276547e-01 1 1  ON 10
 ud_1                 1.676917e-01 1 1  ON 11
 ud_2                 5.642379e-02 1 1  ON 12
 ud_3                -6.714998e-03 1 1  ON 13
 ud_4                -6.122694e-02 1 1  ON 14
 ud_5                -1.025975e-01 1 1  ON 15
 ud_6                -1.302008e-01 1 1  ON 16
 ud_7                -1.455301e-01 1 1  ON 17
 ud_8                -1.448487e-01 1 1  ON 18
 ud_9                -1.349981e-01 1 1  ON 19
 eO_0                -7.254229e-01 1 1  ON 20
 eO_1                -4.187569e-01 1 1  ON 21
 eO_2                -1.918693e-02 1 1  ON 22
 eO_3                 2.824485e-01 1 1  ON 23
 eO_4                 4.963665e-01 1 1  ON 24
 eO_5                 4.582436e-01 1 1  ON 25
 eO_6                 2.356036e-01 1 1  ON 26
 eO_7                -5.595084e-02 1 1  ON 27
 eO_8                -1.974415e-01 1 1  ON 28
 eO_9                -5.874356e-02 1 1  ON 29
eH1_0                -2.177418e-01 1 1  ON 30
eH1_1                -1.284044e-01 1 1  ON 31
eH1_2                -8.679317e-02 1 1  ON 32
eH1_3                -3.557464e-02 1 1  ON 33
eH1_4                 1.274987e-02 1 1  ON 34
eH1_5                 4.557299e-02 1 1  ON 35
eH1_6                 9.494370e-02 1 1  ON 36
eH1_7                 1.385457e-01 1 1  ON 37
eH1_8                 1.470441e-01 1 1  ON 38
eH1_9                 3.428056e-02 1 1  ON 39
eH2_0                -2.166395e-01 1 1  ON 40
eH2_1                -1.272210e-01 1 1  ON 41
eH2_2                -8.559170e-02 1 1  ON 42
eH2_3                -3.418192e-02 1 1  ON 43
eH2_4                 1.442656e-02 1 1  ON 44
eH2_5                 4.862383e-02 1 1  ON 45
eH2_6                 1.002607e-01 1 1  ON 46
eH2_7                 1.487485e-01 1 1  ON 47
eH2_8                 1.550728e-01 1 1  ON 48
eH2_9                 1.494214e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8533
    reference variance = 0.235098
====================================================
  Execution time = 3.6037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2722e-01
  Total weights = 2.0000e+06
  Execution time = 3.3900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326940844214
                                         uncertainty =       0.003158001747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326940844214
                                         uncertainty =       0.003158001747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404293585
  error estimate for blocks of size 2^( 2) =       0.000417592505
  error estimate for blocks of size 2^( 3) =       0.000431190423
  error estimate for blocks of size 2^( 4) =       0.000444790578
  error estimate for blocks of size 2^( 5) =       0.000455347357
  error estimate for blocks of size 2^( 6) =       0.000464162133
  error estimate for blocks of size 2^( 7) =       0.000469255090

      target function =                  N/A
              le_mean =     -16.905699853273
             les_mean =     286.129593971634
             stat err =       0.000458388789
             autocorr =       1.285506491789
              std dev =       0.571757471418
             le_variance =       0.326906606123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328023694626
                                         uncertainty =       0.003162975194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328023694626
                                         uncertainty =       0.003162975194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404962420
  error estimate for blocks of size 2^( 2) =       0.000418194122
  error estimate for blocks of size 2^( 3) =       0.000431721734
  error estimate for blocks of size 2^( 4) =       0.000445275045
  error estimate for blocks of size 2^( 5) =       0.000455784697
  error estimate for blocks of size 2^( 6) =       0.000464602330
  error estimate for blocks of size 2^( 7) =       0.000469684654

      target function =                  N/A
              le_mean =     -16.905701354283
             les_mean =     286.130727239663
             stat err =       0.000458836682
             autocorr =       1.283768791305
              std dev =       0.572703346820
             le_variance =       0.327989123459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579765182
                                         uncertainty =       0.003160907452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579765182
                                         uncertainty =       0.003160907452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404688337
  error estimate for blocks of size 2^( 2) =       0.000417945897
  error estimate for blocks of size 2^( 3) =       0.000431500961
  error estimate for blocks of size 2^( 4) =       0.000445072354
  error estimate for blocks of size 2^( 5) =       0.000455599895
  error estimate for blocks of size 2^( 6) =       0.000464416564
  error estimate for blocks of size 2^( 7) =       0.000469503402

      target function =                  N/A
              le_mean =     -16.905699072496
             les_mean =     286.130206265875
             stat err =       0.000458648054
             autocorr =       1.284451569627
              std dev =       0.572315734422
             le_variance =       0.327545299867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327024985267
                                         uncertainty =       0.003158389918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327024985267
                                         uncertainty =       0.003158389918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404345592
  error estimate for blocks of size 2^( 2) =       0.000417638816
  error estimate for blocks of size 2^( 3) =       0.000431230900
  error estimate for blocks of size 2^( 4) =       0.000444827126
  error estimate for blocks of size 2^( 5) =       0.000455379981
  error estimate for blocks of size 2^( 6) =       0.000464195031
  error estimate for blocks of size 2^( 7) =       0.000469287139

      target function =                  N/A
              le_mean =     -16.905699443621
             les_mean =     286.129664230488
             stat err =       0.000458422320
             autocorr =       1.285363851867
              std dev =       0.571831020453
             le_variance =       0.326990715952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905699853273        initial
     6.2500e-01     6.2500e+00             2.7198e-03       -16.905701354283  <--
     2.5000e+00     2.5000e+01             7.7564e-04       -16.905699072496
     1.0000e+01     1.0000e+02             2.0128e-04       -16.905699443621

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 5.3097e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.034528e-01 1 1  ON 0
 uu_1                 1.389408e-01 1 1  ON 1
 uu_2                 3.979801e-02 1 1  ON 2
 uu_3                -1.969303e-02 1 1  ON 3
 uu_4                -6.222046e-02 1 1  ON 4
 uu_5                -9.501235e-02 1 1  ON 5
 uu_6                -1.207110e-01 1 1  ON 6
 uu_7                -1.320001e-01 1 1  ON 7
 uu_8                -1.222227e-01 1 1  ON 8
 uu_9                -9.287285e-02 1 1  ON 9
 ud_0                 4.289683e-01 1 1  ON 10
 ud_1                 1.684314e-01 1 1  ON 11
 ud_2                 5.637281e-02 1 1  ON 12
 ud_3                -7.421336e-03 1 1  ON 13
 ud_4                -6.171230e-02 1 1  ON 14
 ud_5                -1.028106e-01 1 1  ON 15
 ud_6                -1.302352e-01 1 1  ON 16
 ud_7                -1.456035e-01 1 1  ON 17
 ud_8                -1.451702e-01 1 1  ON 18
 ud_9                -1.351634e-01 1 1  ON 19
 eO_0                -7.273671e-01 1 1  ON 20
 eO_1                -4.194019e-01 1 1  ON 21
 eO_2                -1.830066e-02 1 1  ON 22
 eO_3                 2.837351e-01 1 1  ON 23
 eO_4                 4.971514e-01 1 1  ON 24
 eO_5                 4.582974e-01 1 1  ON 25
 eO_6                 2.356747e-01 1 1  ON 26
 eO_7                -5.592438e-02 1 1  ON 27
 eO_8                -1.977408e-01 1 1  ON 28
 eO_9                -5.893352e-02 1 1  ON 29
eH1_0                -2.185771e-01 1 1  ON 30
eH1_1                -1.286402e-01 1 1  ON 31
eH1_2                -8.664005e-02 1 1  ON 32
eH1_3                -3.538250e-02 1 1  ON 33
eH1_4                 1.288969e-02 1 1  ON 34
eH1_5                 4.569359e-02 1 1  ON 35
eH1_6                 9.503220e-02 1 1  ON 36
eH1_7                 1.385971e-01 1 1  ON 37
eH1_8                 1.471951e-01 1 1  ON 38
eH1_9                 3.444411e-02 1 1  ON 39
eH2_0                -2.174767e-01 1 1  ON 40
eH2_1                -1.273478e-01 1 1  ON 41
eH2_2                -8.542112e-02 1 1  ON 42
eH2_3                -3.395055e-02 1 1  ON 43
eH2_4                 1.450357e-02 1 1  ON 44
eH2_5                 4.871349e-02 1 1  ON 45
eH2_6                 1.002094e-01 1 1  ON 46
eH2_7                 1.487338e-01 1 1  ON 47
eH2_8                 1.552822e-01 1 1  ON 48
eH2_9                 1.517930e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0253e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8068
    reference variance = 0.233915
====================================================
  Execution time = 3.7942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569727312
                                         uncertainty =       0.004797814300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569727312
                                         uncertainty =       0.004797814300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407717494
  error estimate for blocks of size 2^( 2) =       0.000420508601
  error estimate for blocks of size 2^( 3) =       0.000434056417
  error estimate for blocks of size 2^( 4) =       0.000445815780
  error estimate for blocks of size 2^( 5) =       0.000454954664
  error estimate for blocks of size 2^( 6) =       0.000461445688
  error estimate for blocks of size 2^( 7) =       0.000466414707

      target function =                  N/A
              le_mean =     -16.904692237114
             les_mean =     286.101086575591
             stat err =       0.000457157710
             autocorr =       1.257226144293
              std dev =       0.576599610036
             le_variance =       0.332467110294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690469223711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904692237114       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904705074688       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904715320008       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904721404092       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904727304616       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904733108713       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904737864941       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904736903202       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904738207939       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904738750389       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904739226020       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904739282525       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904739223081       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 6.859746e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904692237114       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904697789804       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904702408452       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904704104321       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904705856798       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904707790603       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904708754491       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904708534506       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904708427304       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904708633203       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904708672696       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.285740e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904692237114       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904693935254       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904695421372       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904695791038       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904696172197       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904696687632       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904696898911       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904696869589       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904696831831       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904696861660       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.398638e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.769573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7915e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.037926e-01 1 1  ON 0
 uu_1                 1.388658e-01 1 1  ON 1
 uu_2                 3.974287e-02 1 1  ON 2
 uu_3                -1.984013e-02 1 1  ON 3
 uu_4                -6.219194e-02 1 1  ON 4
 uu_5                -9.501608e-02 1 1  ON 5
 uu_6                -1.208015e-01 1 1  ON 6
 uu_7                -1.322149e-01 1 1  ON 7
 uu_8                -1.224527e-01 1 1  ON 8
 uu_9                -9.295156e-02 1 1  ON 9
 ud_0                 4.304102e-01 1 1  ON 10
 ud_1                 1.693448e-01 1 1  ON 11
 ud_2                 5.634824e-02 1 1  ON 12
 ud_3                -8.046199e-03 1 1  ON 13
 ud_4                -6.233998e-02 1 1  ON 14
 ud_5                -1.029618e-01 1 1  ON 15
 ud_6                -1.302919e-01 1 1  ON 16
 ud_7                -1.459184e-01 1 1  ON 17
 ud_8                -1.454867e-01 1 1  ON 18
 ud_9                -1.353545e-01 1 1  ON 19
 eO_0                -7.296528e-01 1 1  ON 20
 eO_1                -4.203372e-01 1 1  ON 21
 eO_2                -1.744211e-02 1 1  ON 22
 eO_3                 2.853378e-01 1 1  ON 23
 eO_4                 4.982770e-01 1 1  ON 24
 eO_5                 4.585276e-01 1 1  ON 25
 eO_6                 2.356999e-01 1 1  ON 26
 eO_7                -5.596055e-02 1 1  ON 27
 eO_8                -1.981081e-01 1 1  ON 28
 eO_9                -5.914068e-02 1 1  ON 29
eH1_0                -2.196558e-01 1 1  ON 30
eH1_1                -1.288430e-01 1 1  ON 31
eH1_2                -8.657352e-02 1 1  ON 32
eH1_3                -3.513386e-02 1 1  ON 33
eH1_4                 1.281033e-02 1 1  ON 34
eH1_5                 4.583468e-02 1 1  ON 35
eH1_6                 9.530756e-02 1 1  ON 36
eH1_7                 1.388119e-01 1 1  ON 37
eH1_8                 1.474013e-01 1 1  ON 38
eH1_9                 3.464258e-02 1 1  ON 39
eH2_0                -2.185128e-01 1 1  ON 40
eH2_1                -1.275308e-01 1 1  ON 41
eH2_2                -8.526698e-02 1 1  ON 42
eH2_3                -3.372447e-02 1 1  ON 43
eH2_4                 1.457230e-02 1 1  ON 44
eH2_5                 4.884367e-02 1 1  ON 45
eH2_6                 1.002817e-01 1 1  ON 46
eH2_7                 1.486633e-01 1 1  ON 47
eH2_8                 1.555609e-01 1 1  ON 48
eH2_9                 1.550745e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.197205
====================================================
  Execution time = 3.6684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5652e-01
  Total weights = 2.0000e+06
  Execution time = 3.3619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355521039130
                                         uncertainty =       0.017454248723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355521039130
                                         uncertainty =       0.017454248723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421597196
  error estimate for blocks of size 2^( 2) =       0.000434208882
  error estimate for blocks of size 2^( 3) =       0.000446944063
  error estimate for blocks of size 2^( 4) =       0.000458708200
  error estimate for blocks of size 2^( 5) =       0.000469461277
  error estimate for blocks of size 2^( 6) =       0.000478073264
  error estimate for blocks of size 2^( 7) =       0.000482532542

      target function =                  N/A
              le_mean =     -16.904790474913
             les_mean =     286.127429213919
             stat err =       0.000472193821
             autocorr =       1.254426363140
              std dev =       0.596228472104
             le_variance =       0.355488390947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358259889715
                                         uncertainty =       0.017743319284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358259889715
                                         uncertainty =       0.017743319284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423218454
  error estimate for blocks of size 2^( 2) =       0.000435713985
  error estimate for blocks of size 2^( 3) =       0.000448312423
  error estimate for blocks of size 2^( 4) =       0.000459950948
  error estimate for blocks of size 2^( 5) =       0.000470670567
  error estimate for blocks of size 2^( 6) =       0.000479234263
  error estimate for blocks of size 2^( 7) =       0.000483639608

      target function =                  N/A
              le_mean =     -16.904801554822
             les_mean =     286.130543149219
             stat err =       0.000473373846
             autocorr =       1.251063418376
              std dev =       0.598521278168
             le_variance =       0.358227720420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357627347541
                                         uncertainty =       0.017668291340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357627347541
                                         uncertainty =       0.017668291340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422844681
  error estimate for blocks of size 2^( 2) =       0.000435361820
  error estimate for blocks of size 2^( 3) =       0.000447991152
  error estimate for blocks of size 2^( 4) =       0.000459660508
  error estimate for blocks of size 2^( 5) =       0.000470393513
  error estimate for blocks of size 2^( 6) =       0.000478974835
  error estimate for blocks of size 2^( 7) =       0.000483395651

      target function =                  N/A
              le_mean =     -16.904795062010
             les_mean =     286.129691158465
             stat err =       0.000473106127
             autocorr =       1.251858955061
              std dev =       0.597992682830
             le_variance =       0.357595248718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355821427148
                                         uncertainty =       0.017485288714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355821427148
                                         uncertainty =       0.017485288714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421775342
  error estimate for blocks of size 2^( 2) =       0.000434371931
  error estimate for blocks of size 2^( 3) =       0.000447090705
  error estimate for blocks of size 2^( 4) =       0.000458840539
  error estimate for blocks of size 2^( 5) =       0.000469590793
  error estimate for blocks of size 2^( 6) =       0.000478198691
  error estimate for blocks of size 2^( 7) =       0.000482652816

      target function =                  N/A
              le_mean =     -16.904789296772
             les_mean =     286.127689867774
             stat err =       0.000472320710
             autocorr =       1.254040624435
              std dev =       0.596480408251
             le_variance =       0.355788877428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904790474913        initial
     1.5625e-01     1.5625e+00             6.8597e-03       -16.904801554822  <--
     6.2500e-01     6.2500e+00             2.2857e-03       -16.904795062010
     2.5000e+00     2.5000e+01             6.3986e-04       -16.904789296772

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 5.3698e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.045386e-01 1 1  ON 0
 uu_1                 1.391005e-01 1 1  ON 1
 uu_2                 3.971422e-02 1 1  ON 2
 uu_3                -2.014742e-02 1 1  ON 3
 uu_4                -6.246555e-02 1 1  ON 4
 uu_5                -9.520567e-02 1 1  ON 5
 uu_6                -1.210695e-01 1 1  ON 6
 uu_7                -1.327319e-01 1 1  ON 7
 uu_8                -1.231002e-01 1 1  ON 8
 uu_9                -9.322719e-02 1 1  ON 9
 ud_0                 4.328999e-01 1 1  ON 10
 ud_1                 1.709761e-01 1 1  ON 11
 ud_2                 5.676151e-02 1 1  ON 12
 ud_3                -8.793790e-03 1 1  ON 13
 ud_4                -6.342619e-02 1 1  ON 14
 ud_5                -1.035174e-01 1 1  ON 15
 ud_6                -1.304730e-01 1 1  ON 16
 ud_7                -1.464395e-01 1 1  ON 17
 ud_8                -1.462254e-01 1 1  ON 18
 ud_9                -1.359054e-01 1 1  ON 19
 eO_0                -7.342268e-01 1 1  ON 20
 eO_1                -4.226705e-01 1 1  ON 21
 eO_2                -1.645473e-02 1 1  ON 22
 eO_3                 2.884626e-01 1 1  ON 23
 eO_4                 5.013565e-01 1 1  ON 24
 eO_5                 4.597706e-01 1 1  ON 25
 eO_6                 2.359794e-01 1 1  ON 26
 eO_7                -5.605294e-02 1 1  ON 27
 eO_8                -1.991765e-01 1 1  ON 28
 eO_9                -5.975383e-02 1 1  ON 29
eH1_0                -2.219520e-01 1 1  ON 30
eH1_1                -1.294544e-01 1 1  ON 31
eH1_2                -8.666167e-02 1 1  ON 32
eH1_3                -3.491484e-02 1 1  ON 33
eH1_4                 1.259052e-02 1 1  ON 34
eH1_5                 4.604573e-02 1 1  ON 35
eH1_6                 9.612454e-02 1 1  ON 36
eH1_7                 1.395307e-01 1 1  ON 37
eH1_8                 1.480317e-01 1 1  ON 38
eH1_9                 3.523332e-02 1 1  ON 39
eH2_0                -2.206843e-01 1 1  ON 40
eH2_1                -1.280397e-01 1 1  ON 41
eH2_2                -8.518327e-02 1 1  ON 42
eH2_3                -3.344851e-02 1 1  ON 43
eH2_4                 1.460661e-02 1 1  ON 44
eH2_5                 4.905113e-02 1 1  ON 45
eH2_6                 1.005939e-01 1 1  ON 46
eH2_7                 1.485693e-01 1 1  ON 47
eH2_8                 1.563671e-01 1 1  ON 48
eH2_9                 1.646884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0162e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8995
    reference variance = 0.226362
====================================================
  Execution time = 3.7115e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068297182
                                         uncertainty =       0.003030581453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068297182
                                         uncertainty =       0.003030581453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405695251
  error estimate for blocks of size 2^( 2) =       0.000418950998
  error estimate for blocks of size 2^( 3) =       0.000432402985
  error estimate for blocks of size 2^( 4) =       0.000444679981
  error estimate for blocks of size 2^( 5) =       0.000456042890
  error estimate for blocks of size 2^( 6) =       0.000465750196
  error estimate for blocks of size 2^( 7) =       0.000474492027

      target function =                  N/A
              le_mean =     -16.905734039825
             les_mean =     286.133020534393
             stat err =       0.000460241274
             autocorr =       1.286978457508
              std dev =       0.573739726419
             le_variance =       0.329177273671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573403983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734039825       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905741855256       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748437713       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905761756770       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905774458599       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905786025418       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905786996637       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905786516698       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905790121482       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905789673856       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905789168216       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905790011677       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905791342310       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905791823391       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905791853263       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905791703746       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905791820909       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.085244e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734039825       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738964245       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743372869       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751602550       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756888256       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761680185       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760875686       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760435057       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760924323       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905760714741       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905760507591       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905760641307       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905760720471       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 4.429496e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734039825       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905736025762       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738107250       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905741019712       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742571340       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905743309068       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905743841261       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743442086       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905743408387       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905743379714       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.410413e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.776158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7214e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.054333e-01 1 1  ON 0
 uu_1                 1.397564e-01 1 1  ON 1
 uu_2                 3.985091e-02 1 1  ON 2
 uu_3                -2.050960e-02 1 1  ON 3
 uu_4                -6.299764e-02 1 1  ON 4
 uu_5                -9.532472e-02 1 1  ON 5
 uu_6                -1.209094e-01 1 1  ON 6
 uu_7                -1.325486e-01 1 1  ON 7
 uu_8                -1.239612e-01 1 1  ON 8
 uu_9                -9.434762e-02 1 1  ON 9
 ud_0                 4.352663e-01 1 1  ON 10
 ud_1                 1.723435e-01 1 1  ON 11
 ud_2                 5.735915e-02 1 1  ON 12
 ud_3                -9.349704e-03 1 1  ON 13
 ud_4                -6.432704e-02 1 1  ON 14
 ud_5                -1.043088e-01 1 1  ON 15
 ud_6                -1.309493e-01 1 1  ON 16
 ud_7                -1.462863e-01 1 1  ON 17
 ud_8                -1.467470e-01 1 1  ON 18
 ud_9                -1.367483e-01 1 1  ON 19
 eO_0                -7.386563e-01 1 1  ON 20
 eO_1                -4.252665e-01 1 1  ON 21
 eO_2                -1.556184e-02 1 1  ON 22
 eO_3                 2.910551e-01 1 1  ON 23
 eO_4                 5.045544e-01 1 1  ON 24
 eO_5                 4.615379e-01 1 1  ON 25
 eO_6                 2.364725e-01 1 1  ON 26
 eO_7                -5.558321e-02 1 1  ON 27
 eO_8                -2.005167e-01 1 1  ON 28
 eO_9                -6.069218e-02 1 1  ON 29
eH1_0                -2.240979e-01 1 1  ON 30
eH1_1                -1.302465e-01 1 1  ON 31
eH1_2                -8.691386e-02 1 1  ON 32
eH1_3                -3.492110e-02 1 1  ON 33
eH1_4                 1.237637e-02 1 1  ON 34
eH1_5                 4.623450e-02 1 1  ON 35
eH1_6                 9.665258e-02 1 1  ON 36
eH1_7                 1.401594e-01 1 1  ON 37
eH1_8                 1.492440e-01 1 1  ON 38
eH1_9                 3.622826e-02 1 1  ON 39
eH2_0                -2.230131e-01 1 1  ON 40
eH2_1                -1.284740e-01 1 1  ON 41
eH2_2                -8.515435e-02 1 1  ON 42
eH2_3                -3.284029e-02 1 1  ON 43
eH2_4                 1.502912e-02 1 1  ON 44
eH2_5                 4.905227e-02 1 1  ON 45
eH2_6                 1.010103e-01 1 1  ON 46
eH2_7                 1.482123e-01 1 1  ON 47
eH2_8                 1.570001e-01 1 1  ON 48
eH2_9                 1.756431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.344685
====================================================
  Execution time = 3.8331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.0000e+06
  Execution time = 3.3737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339165455750
                                         uncertainty =       0.003570174808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339165455750
                                         uncertainty =       0.003570174808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411748703
  error estimate for blocks of size 2^( 2) =       0.000424843721
  error estimate for blocks of size 2^( 3) =       0.000437977287
  error estimate for blocks of size 2^( 4) =       0.000450549246
  error estimate for blocks of size 2^( 5) =       0.000460547289
  error estimate for blocks of size 2^( 6) =       0.000468928763
  error estimate for blocks of size 2^( 7) =       0.000472868542

      target function =                  N/A
              le_mean =     -16.905336549259
             les_mean =     286.129477663076
             stat err =       0.000463223460
             autocorr =       1.265658712158
              std dev =       0.582300600126
             le_variance =       0.339073988908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342267623006
                                         uncertainty =       0.003601933907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342267623006
                                         uncertainty =       0.003601933907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413628013
  error estimate for blocks of size 2^( 2) =       0.000426602738
  error estimate for blocks of size 2^( 3) =       0.000439600386
  error estimate for blocks of size 2^( 4) =       0.000452053950
  error estimate for blocks of size 2^( 5) =       0.000461968019
  error estimate for blocks of size 2^( 6) =       0.000470317663
  error estimate for blocks of size 2^( 7) =       0.000474246912

      target function =                  N/A
              le_mean =     -16.905356174520
             les_mean =     286.133243482641
             stat err =       0.000464646636
             autocorr =       1.261902228804
              std dev =       0.584958345827
             le_variance =       0.342176266353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342287331759
                                         uncertainty =       0.003603628310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342287331759
                                         uncertainty =       0.003603628310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413639915
  error estimate for blocks of size 2^( 2) =       0.000426607554
  error estimate for blocks of size 2^( 3) =       0.000439612989
  error estimate for blocks of size 2^( 4) =       0.000452082234
  error estimate for blocks of size 2^( 5) =       0.000462008610
  error estimate for blocks of size 2^( 6) =       0.000470369039
  error estimate for blocks of size 2^( 7) =       0.000474296306

      target function =                  N/A
              le_mean =     -16.905359841401
             les_mean =     286.133387155353
             stat err =       0.000464689047
             autocorr =       1.262059968167
              std dev =       0.584975178266
             le_variance =       0.342195959187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339737730620
                                         uncertainty =       0.003576653972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339737730620
                                         uncertainty =       0.003576653972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412096039
  error estimate for blocks of size 2^( 2) =       0.000425164510
  error estimate for blocks of size 2^( 3) =       0.000438273496
  error estimate for blocks of size 2^( 4) =       0.000450826910
  error estimate for blocks of size 2^( 5) =       0.000460812605
  error estimate for blocks of size 2^( 6) =       0.000469190530
  error estimate for blocks of size 2^( 7) =       0.000473126194

      target function =                  N/A
              le_mean =     -16.905337137119
             les_mean =     286.130069840107
             stat err =       0.000463489060
             autocorr =       1.264975444488
              std dev =       0.582791806960
             le_variance =       0.339646290260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905336549259        initial
     3.9062e-02     3.9062e-01             1.0852e-02       -16.905356174520
     1.5625e-01     1.5625e+00             4.4295e-03       -16.905359841401  <--
     6.2500e-01     6.2500e+00             1.4104e-03       -16.905337137119

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 5.5337e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.054333e-01 1 1  ON 0
 uu_1                 1.397564e-01 1 1  ON 1
 uu_2                 3.985091e-02 1 1  ON 2
 uu_3                -2.050960e-02 1 1  ON 3
 uu_4                -6.299764e-02 1 1  ON 4
 uu_5                -9.532472e-02 1 1  ON 5
 uu_6                -1.209094e-01 1 1  ON 6
 uu_7                -1.325486e-01 1 1  ON 7
 uu_8                -1.239612e-01 1 1  ON 8
 uu_9                -9.434762e-02 1 1  ON 9
 ud_0                 4.352663e-01 1 1  ON 10
 ud_1                 1.723435e-01 1 1  ON 11
 ud_2                 5.735915e-02 1 1  ON 12
 ud_3                -9.349704e-03 1 1  ON 13
 ud_4                -6.432704e-02 1 1  ON 14
 ud_5                -1.043088e-01 1 1  ON 15
 ud_6                -1.309493e-01 1 1  ON 16
 ud_7                -1.462863e-01 1 1  ON 17
 ud_8                -1.467470e-01 1 1  ON 18
 ud_9                -1.367483e-01 1 1  ON 19
 eO_0                -7.386563e-01 1 1  ON 20
 eO_1                -4.252665e-01 1 1  ON 21
 eO_2                -1.556184e-02 1 1  ON 22
 eO_3                 2.910551e-01 1 1  ON 23
 eO_4                 5.045544e-01 1 1  ON 24
 eO_5                 4.615379e-01 1 1  ON 25
 eO_6                 2.364725e-01 1 1  ON 26
 eO_7                -5.558321e-02 1 1  ON 27
 eO_8                -2.005167e-01 1 1  ON 28
 eO_9                -6.069218e-02 1 1  ON 29
eH1_0                -2.240979e-01 1 1  ON 30
eH1_1                -1.302465e-01 1 1  ON 31
eH1_2                -8.691386e-02 1 1  ON 32
eH1_3                -3.492110e-02 1 1  ON 33
eH1_4                 1.237637e-02 1 1  ON 34
eH1_5                 4.623450e-02 1 1  ON 35
eH1_6                 9.665258e-02 1 1  ON 36
eH1_7                 1.401594e-01 1 1  ON 37
eH1_8                 1.492440e-01 1 1  ON 38
eH1_9                 3.622826e-02 1 1  ON 39
eH2_0                -2.230131e-01 1 1  ON 40
eH2_1                -1.284740e-01 1 1  ON 41
eH2_2                -8.515435e-02 1 1  ON 42
eH2_3                -3.284029e-02 1 1  ON 43
eH2_4                 1.502912e-02 1 1  ON 44
eH2_5                 4.905227e-02 1 1  ON 45
eH2_6                 1.010103e-01 1 1  ON 46
eH2_7                 1.482123e-01 1 1  ON 47
eH2_8                 1.570001e-01 1 1  ON 48
eH2_9                 1.756431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0256e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8611
    reference variance = 0.316232
====================================================
  Execution time = 3.9590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357544573642
                                         uncertainty =       0.023698844105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357544573642
                                         uncertainty =       0.023698844105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422842454
  error estimate for blocks of size 2^( 2) =       0.000435108921
  error estimate for blocks of size 2^( 3) =       0.000448286453
  error estimate for blocks of size 2^( 4) =       0.000461028996
  error estimate for blocks of size 2^( 5) =       0.000472071298
  error estimate for blocks of size 2^( 6) =       0.000480325539
  error estimate for blocks of size 2^( 7) =       0.000486144717

      target function =                  N/A
              le_mean =     -16.905191682475
             les_mean =     286.143097124771
             stat err =       0.000474892638
             autocorr =       1.261344457818
              std dev =       0.597989533649
             le_variance =       0.357591482353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519168247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191682475       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197843463       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905199841836       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905211477080       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905214572403       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905212115442       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905212390160       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905214144290       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905221109368       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905219908561       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905220587002       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905222548615       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905223181167       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905222363002       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905222981886       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905223252065       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905222605941       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 9.011826e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191682475       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905195580543       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197357649       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905203632675       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905204835217       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905203431888       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905201940242       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905202604105       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905203974352       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905204281295       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905203919564       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905204167073       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905204176319       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.404003e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191682475       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905193261155       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905194306766       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196379602       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196726125       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196084089       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905195721095       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905195485011       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905195895806       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905195896897       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.047568e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.782671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9529e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.058872e-01 1 1  ON 0
 uu_1                 1.397504e-01 1 1  ON 1
 uu_2                 3.953634e-02 1 1  ON 2
 uu_3                -2.091028e-02 1 1  ON 3
 uu_4                -6.378918e-02 1 1  ON 4
 uu_5                -9.624818e-02 1 1  ON 5
 uu_6                -1.215188e-01 1 1  ON 6
 uu_7                -1.327421e-01 1 1  ON 7
 uu_8                -1.237578e-01 1 1  ON 8
 uu_9                -9.409883e-02 1 1  ON 9
 ud_0                 4.366639e-01 1 1  ON 10
 ud_1                 1.733678e-01 1 1  ON 11
 ud_2                 5.771524e-02 1 1  ON 12
 ud_3                -9.756749e-03 1 1  ON 13
 ud_4                -6.517815e-02 1 1  ON 14
 ud_5                -1.051693e-01 1 1  ON 15
 ud_6                -1.312159e-01 1 1  ON 16
 ud_7                -1.466566e-01 1 1  ON 17
 ud_8                -1.471132e-01 1 1  ON 18
 ud_9                -1.369106e-01 1 1  ON 19
 eO_0                -7.420603e-01 1 1  ON 20
 eO_1                -4.272756e-01 1 1  ON 21
 eO_2                -1.573399e-02 1 1  ON 22
 eO_3                 2.929199e-01 1 1  ON 23
 eO_4                 5.072923e-01 1 1  ON 24
 eO_5                 4.630825e-01 1 1  ON 25
 eO_6                 2.368383e-01 1 1  ON 26
 eO_7                -5.468350e-02 1 1  ON 27
 eO_8                -2.013872e-01 1 1  ON 28
 eO_9                -6.163280e-02 1 1  ON 29
eH1_0                -2.263482e-01 1 1  ON 30
eH1_1                -1.312275e-01 1 1  ON 31
eH1_2                -8.737504e-02 1 1  ON 32
eH1_3                -3.510361e-02 1 1  ON 33
eH1_4                 1.223034e-02 1 1  ON 34
eH1_5                 4.608084e-02 1 1  ON 35
eH1_6                 9.780779e-02 1 1  ON 36
eH1_7                 1.407943e-01 1 1  ON 37
eH1_8                 1.504192e-01 1 1  ON 38
eH1_9                 3.747089e-02 1 1  ON 39
eH2_0                -2.243976e-01 1 1  ON 40
eH2_1                -1.291644e-01 1 1  ON 41
eH2_2                -8.572901e-02 1 1  ON 42
eH2_3                -3.324381e-02 1 1  ON 43
eH2_4                 1.493702e-02 1 1  ON 44
eH2_5                 4.879579e-02 1 1  ON 45
eH2_6                 1.009630e-01 1 1  ON 46
eH2_7                 1.483990e-01 1 1  ON 47
eH2_8                 1.583817e-01 1 1  ON 48
eH2_9                 1.918598e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9273
    reference variance = 0.289787
====================================================
  Execution time = 3.6068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3554e-01
  Total weights = 2.0000e+06
  Execution time = 3.3927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334562428327
                                         uncertainty =       0.003654326887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334562428327
                                         uncertainty =       0.003654326887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409006781
  error estimate for blocks of size 2^( 2) =       0.000421643266
  error estimate for blocks of size 2^( 3) =       0.000435247308
  error estimate for blocks of size 2^( 4) =       0.000447483923
  error estimate for blocks of size 2^( 5) =       0.000457725271
  error estimate for blocks of size 2^( 6) =       0.000464437678
  error estimate for blocks of size 2^( 7) =       0.000466905242

      target function =                  N/A
              le_mean =     -16.905463287239
             les_mean =     286.129261883179
             stat err =       0.000459138029
             autocorr =       1.260159486279
              std dev =       0.578422937211
             le_variance =       0.334573094292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336787468961
                                         uncertainty =       0.003681724155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336787468961
                                         uncertainty =       0.003681724155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410365373
  error estimate for blocks of size 2^( 2) =       0.000422948273
  error estimate for blocks of size 2^( 3) =       0.000436469006
  error estimate for blocks of size 2^( 4) =       0.000448631520
  error estimate for blocks of size 2^( 5) =       0.000458775748
  error estimate for blocks of size 2^( 6) =       0.000465437025
  error estimate for blocks of size 2^( 7) =       0.000467919663

      target function =                  N/A
              le_mean =     -16.905458425828
             les_mean =     286.131323897550
             stat err =       0.000460190989
             autocorr =       1.257577637805
              std dev =       0.580344275872
             le_variance =       0.336799478538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336528951366
                                         uncertainty =       0.003678307215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336528951366
                                         uncertainty =       0.003678307215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410207821
  error estimate for blocks of size 2^( 2) =       0.000422792572
  error estimate for blocks of size 2^( 3) =       0.000436324607
  error estimate for blocks of size 2^( 4) =       0.000448506774
  error estimate for blocks of size 2^( 5) =       0.000458678417
  error estimate for blocks of size 2^( 6) =       0.000465352028
  error estimate for blocks of size 2^( 7) =       0.000467846317

      target function =                  N/A
              le_mean =     -16.905458208826
             les_mean =     286.131057994378
             stat err =       0.000460095884
             autocorr =       1.258023704687
              std dev =       0.580121463389
             le_variance =       0.336540912284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334886987827
                                         uncertainty =       0.003658498537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334886987827
                                         uncertainty =       0.003658498537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409205262
  error estimate for blocks of size 2^( 2) =       0.000421831843
  error estimate for blocks of size 2^( 3) =       0.000435422921
  error estimate for blocks of size 2^( 4) =       0.000447650296
  error estimate for blocks of size 2^( 5) =       0.000457881117
  error estimate for blocks of size 2^( 6) =       0.000464587801
  error estimate for blocks of size 2^( 7) =       0.000467062249

      target function =                  N/A
              le_mean =     -16.905460183849
             les_mean =     286.129481753085
             stat err =       0.000459295366
             autocorr =       1.259800300270
              std dev =       0.578703631247
             le_variance =       0.334897892819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905463287239        initial  <--
     3.9062e-02     3.9062e-01             9.0118e-03       -16.905458425828
     1.5625e-01     1.5625e+00             3.4040e-03       -16.905458208826
     6.2500e-01     6.2500e+00             1.0476e-03       -16.905460183849

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1116
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.054333e-01 1 1  ON 0
 uu_1                 1.397564e-01 1 1  ON 1
 uu_2                 3.985091e-02 1 1  ON 2
 uu_3                -2.050960e-02 1 1  ON 3
 uu_4                -6.299764e-02 1 1  ON 4
 uu_5                -9.532472e-02 1 1  ON 5
 uu_6                -1.209094e-01 1 1  ON 6
 uu_7                -1.325486e-01 1 1  ON 7
 uu_8                -1.239612e-01 1 1  ON 8
 uu_9                -9.434762e-02 1 1  ON 9
 ud_0                 4.352663e-01 1 1  ON 10
 ud_1                 1.723435e-01 1 1  ON 11
 ud_2                 5.735915e-02 1 1  ON 12
 ud_3                -9.349704e-03 1 1  ON 13
 ud_4                -6.432704e-02 1 1  ON 14
 ud_5                -1.043088e-01 1 1  ON 15
 ud_6                -1.309493e-01 1 1  ON 16
 ud_7                -1.462863e-01 1 1  ON 17
 ud_8                -1.467470e-01 1 1  ON 18
 ud_9                -1.367483e-01 1 1  ON 19
 eO_0                -7.386563e-01 1 1  ON 20
 eO_1                -4.252665e-01 1 1  ON 21
 eO_2                -1.556184e-02 1 1  ON 22
 eO_3                 2.910551e-01 1 1  ON 23
 eO_4                 5.045544e-01 1 1  ON 24
 eO_5                 4.615379e-01 1 1  ON 25
 eO_6                 2.364725e-01 1 1  ON 26
 eO_7                -5.558321e-02 1 1  ON 27
 eO_8                -2.005167e-01 1 1  ON 28
 eO_9                -6.069218e-02 1 1  ON 29
eH1_0                -2.240979e-01 1 1  ON 30
eH1_1                -1.302465e-01 1 1  ON 31
eH1_2                -8.691386e-02 1 1  ON 32
eH1_3                -3.492110e-02 1 1  ON 33
eH1_4                 1.237637e-02 1 1  ON 34
eH1_5                 4.623450e-02 1 1  ON 35
eH1_6                 9.665258e-02 1 1  ON 36
eH1_7                 1.401594e-01 1 1  ON 37
eH1_8                 1.492440e-01 1 1  ON 38
eH1_9                 3.622826e-02 1 1  ON 39
eH2_0                -2.230131e-01 1 1  ON 40
eH2_1                -1.284740e-01 1 1  ON 41
eH2_2                -8.515435e-02 1 1  ON 42
eH2_3                -3.284029e-02 1 1  ON 43
eH2_4                 1.502912e-02 1 1  ON 44
eH2_5                 4.905227e-02 1 1  ON 45
eH2_6                 1.010103e-01 1 1  ON 46
eH2_7                 1.482123e-01 1 1  ON 47
eH2_8                 1.570001e-01 1 1  ON 48
eH2_9                 1.756431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0265e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8132
    reference variance = 0.42115
====================================================
  Execution time = 3.6999e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0105e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334777166407
                                         uncertainty =       0.004045348188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334777166407
                                         uncertainty =       0.004045348188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409100049
  error estimate for blocks of size 2^( 2) =       0.000422157824
  error estimate for blocks of size 2^( 3) =       0.000435492004
  error estimate for blocks of size 2^( 4) =       0.000448712612
  error estimate for blocks of size 2^( 5) =       0.000460540581
  error estimate for blocks of size 2^( 6) =       0.000467033911
  error estimate for blocks of size 2^( 7) =       0.000472985107

      target function =                  N/A
              le_mean =     -16.905747473098
             les_mean =     286.139023156644
             stat err =       0.000462318053
             autocorr =       1.277093346217
              std dev =       0.578554837383
             le_variance =       0.334725699859


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574747310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747473098       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750982925       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751292393       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751234170       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905752448031       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753732272       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753855177       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905753969017       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905753900373       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905754078125       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.742573e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747473098       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748667200       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748748166       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748546942       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748878991       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749208694       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749359348       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749391278       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749359793       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 4.833232e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747473098       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747801226       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747822140       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905747760700       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905747839244       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905747931916       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905747968988       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905747979619       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.240065e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.785805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7116e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.054725e-01 1 1  ON 0
 uu_1                 1.397522e-01 1 1  ON 1
 uu_2                 3.977277e-02 1 1  ON 2
 uu_3                -2.054987e-02 1 1  ON 3
 uu_4                -6.310304e-02 1 1  ON 4
 uu_5                -9.537455e-02 1 1  ON 5
 uu_6                -1.209442e-01 1 1  ON 6
 uu_7                -1.325005e-01 1 1  ON 7
 uu_8                -1.239133e-01 1 1  ON 8
 uu_9                -9.434205e-02 1 1  ON 9
 ud_0                 4.354750e-01 1 1  ON 10
 ud_1                 1.724970e-01 1 1  ON 11
 ud_2                 5.738082e-02 1 1  ON 12
 ud_3                -9.403690e-03 1 1  ON 13
 ud_4                -6.445926e-02 1 1  ON 14
 ud_5                -1.044281e-01 1 1  ON 15
 ud_6                -1.309801e-01 1 1  ON 16
 ud_7                -1.463342e-01 1 1  ON 17
 ud_8                -1.467475e-01 1 1  ON 18
 ud_9                -1.367597e-01 1 1  ON 19
 eO_0                -7.391396e-01 1 1  ON 20
 eO_1                -4.255582e-01 1 1  ON 21
 eO_2                -1.553403e-02 1 1  ON 22
 eO_3                 2.913842e-01 1 1  ON 23
 eO_4                 5.048866e-01 1 1  ON 24
 eO_5                 4.617126e-01 1 1  ON 25
 eO_6                 2.364984e-01 1 1  ON 26
 eO_7                -5.552122e-02 1 1  ON 27
 eO_8                -2.005994e-01 1 1  ON 28
 eO_9                -6.077678e-02 1 1  ON 29
eH1_0                -2.242794e-01 1 1  ON 30
eH1_1                -1.302971e-01 1 1  ON 31
eH1_2                -8.697006e-02 1 1  ON 32
eH1_3                -3.491338e-02 1 1  ON 33
eH1_4                 1.233624e-02 1 1  ON 34
eH1_5                 4.617928e-02 1 1  ON 35
eH1_6                 9.667677e-02 1 1  ON 36
eH1_7                 1.402405e-01 1 1  ON 37
eH1_8                 1.493857e-01 1 1  ON 38
eH1_9                 3.634130e-02 1 1  ON 39
eH2_0                -2.232232e-01 1 1  ON 40
eH2_1                -1.285492e-01 1 1  ON 41
eH2_2                -8.519341e-02 1 1  ON 42
eH2_3                -3.285720e-02 1 1  ON 43
eH2_4                 1.500938e-02 1 1  ON 44
eH2_5                 4.909206e-02 1 1  ON 45
eH2_6                 1.010733e-01 1 1  ON 46
eH2_7                 1.482084e-01 1 1  ON 47
eH2_8                 1.571115e-01 1 1  ON 48
eH2_9                 1.770811e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.279809
====================================================
  Execution time = 3.6256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.0000e+06
  Execution time = 3.3694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339167994034
                                         uncertainty =       0.004318232456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339167994034
                                         uncertainty =       0.004318232456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411780480
  error estimate for blocks of size 2^( 2) =       0.000424563048
  error estimate for blocks of size 2^( 3) =       0.000437413295
  error estimate for blocks of size 2^( 4) =       0.000449332961
  error estimate for blocks of size 2^( 5) =       0.000459390828
  error estimate for blocks of size 2^( 6) =       0.000468060783
  error estimate for blocks of size 2^( 7) =       0.000474809254

      target function =                  N/A
              le_mean =     -16.904620549512
             les_mean =     286.105322080302
             stat err =       0.000462898457
             autocorr =       1.263688272675
              std dev =       0.582345539068
             le_variance =       0.339126326872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339690288914
                                         uncertainty =       0.004328216742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339690288914
                                         uncertainty =       0.004328216742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412097402
  error estimate for blocks of size 2^( 2) =       0.000424864735
  error estimate for blocks of size 2^( 3) =       0.000437694126
  error estimate for blocks of size 2^( 4) =       0.000449596193
  error estimate for blocks of size 2^( 5) =       0.000459634795
  error estimate for blocks of size 2^( 6) =       0.000468294411
  error estimate for blocks of size 2^( 7) =       0.000475036256

      target function =                  N/A
              le_mean =     -16.904622675218
             les_mean =     286.105916159776
             stat err =       0.000463140414
             autocorr =       1.263064720652
              std dev =       0.582793735486
             le_variance =       0.339648538122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339496334638
                                         uncertainty =       0.004324259333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339496334638
                                         uncertainty =       0.004324259333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411979745
  error estimate for blocks of size 2^( 2) =       0.000424752140
  error estimate for blocks of size 2^( 3) =       0.000437589172
  error estimate for blocks of size 2^( 4) =       0.000449497691
  error estimate for blocks of size 2^( 5) =       0.000459544894
  error estimate for blocks of size 2^( 6) =       0.000468207992
  error estimate for blocks of size 2^( 7) =       0.000474952930

      target function =                  N/A
              le_mean =     -16.904621777398
             les_mean =     286.105691887119
             stat err =       0.000463050877
             autocorr =       1.263297664658
              std dev =       0.582627342283
             le_variance =       0.339454619976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339211894242
                                         uncertainty =       0.004319032542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339211894242
                                         uncertainty =       0.004319032542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411807128
  error estimate for blocks of size 2^( 2) =       0.000424588308
  error estimate for blocks of size 2^( 3) =       0.000437436799
  error estimate for blocks of size 2^( 4) =       0.000449354961
  error estimate for blocks of size 2^( 5) =       0.000459411463
  error estimate for blocks of size 2^( 6) =       0.000468080444
  error estimate for blocks of size 2^( 7) =       0.000474828412

      target function =                  N/A
              le_mean =     -16.904620699247
             les_mean =     286.105371037849
             stat err =       0.000462918820
             autocorr =       1.263635897609
              std dev =       0.582383226097
             le_variance =       0.339170222039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904620549512        initial
     3.9062e-01     3.9062e+00             1.7426e-03       -16.904622675218  <--
     1.5625e+00     1.5625e+01             4.8332e-04       -16.904621777398
     6.2500e+00     6.2500e+01             1.2401e-04       -16.904620699247

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 5.3246e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.055797e-01 1 1  ON 0
 uu_1                 1.397374e-01 1 1  ON 1
 uu_2                 3.962081e-02 1 1  ON 2
 uu_3                -2.071481e-02 1 1  ON 3
 uu_4                -6.337076e-02 1 1  ON 4
 uu_5                -9.555421e-02 1 1  ON 5
 uu_6                -1.210381e-01 1 1  ON 6
 uu_7                -1.323974e-01 1 1  ON 7
 uu_8                -1.237854e-01 1 1  ON 8
 uu_9                -9.432224e-02 1 1  ON 9
 ud_0                 4.359770e-01 1 1  ON 10
 ud_1                 1.728584e-01 1 1  ON 11
 ud_2                 5.750654e-02 1 1  ON 12
 ud_3                -9.532278e-03 1 1  ON 13
 ud_4                -6.476862e-02 1 1  ON 14
 ud_5                -1.047426e-01 1 1  ON 15
 ud_6                -1.310869e-01 1 1  ON 16
 ud_7                -1.464620e-01 1 1  ON 17
 ud_8                -1.467567e-01 1 1  ON 18
 ud_9                -1.367912e-01 1 1  ON 19
 eO_0                -7.403989e-01 1 1  ON 20
 eO_1                -4.263787e-01 1 1  ON 21
 eO_2                -1.555310e-02 1 1  ON 22
 eO_3                 2.922184e-01 1 1  ON 23
 eO_4                 5.058376e-01 1 1  ON 24
 eO_5                 4.622647e-01 1 1  ON 25
 eO_6                 2.366047e-01 1 1  ON 26
 eO_7                -5.534070e-02 1 1  ON 27
 eO_8                -2.008452e-01 1 1  ON 28
 eO_9                -6.102816e-02 1 1  ON 29
eH1_0                -2.247542e-01 1 1  ON 30
eH1_1                -1.304705e-01 1 1  ON 31
eH1_2                -8.712204e-02 1 1  ON 32
eH1_3                -3.494592e-02 1 1  ON 33
eH1_4                 1.220817e-02 1 1  ON 34
eH1_5                 4.601648e-02 1 1  ON 35
eH1_6                 9.674607e-02 1 1  ON 36
eH1_7                 1.404851e-01 1 1  ON 37
eH1_8                 1.498081e-01 1 1  ON 38
eH1_9                 3.668003e-02 1 1  ON 39
eH2_0                -2.237807e-01 1 1  ON 40
eH2_1                -1.287769e-01 1 1  ON 41
eH2_2                -8.531416e-02 1 1  ON 42
eH2_3                -3.292321e-02 1 1  ON 43
eH2_4                 1.492675e-02 1 1  ON 44
eH2_5                 4.917175e-02 1 1  ON 45
eH2_6                 1.012603e-01 1 1  ON 46
eH2_7                 1.482136e-01 1 1  ON 47
eH2_8                 1.574444e-01 1 1  ON 48
eH2_9                 1.813686e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0037e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9383
    reference variance = 0.40651
====================================================
  Execution time = 3.7245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395389366002
                                         uncertainty =       0.058547511461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395389366002
                                         uncertainty =       0.058547511461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444550430
  error estimate for blocks of size 2^( 2) =       0.000456525226
  error estimate for blocks of size 2^( 3) =       0.000469040324
  error estimate for blocks of size 2^( 4) =       0.000480566745
  error estimate for blocks of size 2^( 5) =       0.000490342659
  error estimate for blocks of size 2^( 6) =       0.000498000038
  error estimate for blocks of size 2^( 7) =       0.000501131919

      target function =                  N/A
              le_mean =     -16.905560025308
             les_mean =     286.193209741375
             stat err =       0.000492510340
             autocorr =       1.227407115485
              std dev =       0.628689247333
             le_variance =       0.395250169712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556002531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905560025308       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562523741       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905564304956       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905565100482       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905562896126       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905571287051       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905572484767       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905571879498       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905572108998       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905572869507       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905573085465       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905573814326       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905573985466       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 4.341034e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905560025308       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905561198496       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905561740803       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905562122560       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905561459621       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905563665083       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905564139331       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905563765048       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905563884933       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905563914518       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.354843e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905560025308       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905560401122       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905560543286       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905560658956       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905560522507       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905560909248       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905561110166       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905561066810       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905561099134       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.671151e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.790055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7145e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.056728e-01 1 1  ON 0
 uu_1                 1.398811e-01 1 1  ON 1
 uu_2                 3.969935e-02 1 1  ON 2
 uu_3                -2.076529e-02 1 1  ON 3
 uu_4                -6.345827e-02 1 1  ON 4
 uu_5                -9.577741e-02 1 1  ON 5
 uu_6                -1.210873e-01 1 1  ON 6
 uu_7                -1.323298e-01 1 1  ON 7
 uu_8                -1.240081e-01 1 1  ON 8
 uu_9                -9.457158e-02 1 1  ON 9
 ud_0                 4.365138e-01 1 1  ON 10
 ud_1                 1.731947e-01 1 1  ON 11
 ud_2                 5.782740e-02 1 1  ON 12
 ud_3                -9.477976e-03 1 1  ON 13
 ud_4                -6.497431e-02 1 1  ON 14
 ud_5                -1.049486e-01 1 1  ON 15
 ud_6                -1.311509e-01 1 1  ON 16
 ud_7                -1.465713e-01 1 1  ON 17
 ud_8                -1.470960e-01 1 1  ON 18
 ud_9                -1.371115e-01 1 1  ON 19
 eO_0                -7.417537e-01 1 1  ON 20
 eO_1                -4.272926e-01 1 1  ON 21
 eO_2                -1.577914e-02 1 1  ON 22
 eO_3                 2.931470e-01 1 1  ON 23
 eO_4                 5.071097e-01 1 1  ON 24
 eO_5                 4.630655e-01 1 1  ON 25
 eO_6                 2.367217e-01 1 1  ON 26
 eO_7                -5.509257e-02 1 1  ON 27
 eO_8                -2.012550e-01 1 1  ON 28
 eO_9                -6.140530e-02 1 1  ON 29
eH1_0                -2.256060e-01 1 1  ON 30
eH1_1                -1.308353e-01 1 1  ON 31
eH1_2                -8.719765e-02 1 1  ON 32
eH1_3                -3.498950e-02 1 1  ON 33
eH1_4                 1.196311e-02 1 1  ON 34
eH1_5                 4.588972e-02 1 1  ON 35
eH1_6                 9.737682e-02 1 1  ON 36
eH1_7                 1.409500e-01 1 1  ON 37
eH1_8                 1.501504e-01 1 1  ON 38
eH1_9                 3.700770e-02 1 1  ON 39
eH2_0                -2.242457e-01 1 1  ON 40
eH2_1                -1.291147e-01 1 1  ON 41
eH2_2                -8.521333e-02 1 1  ON 42
eH2_3                -3.284920e-02 1 1  ON 43
eH2_4                 1.457543e-02 1 1  ON 44
eH2_5                 4.916367e-02 1 1  ON 45
eH2_6                 1.012512e-01 1 1  ON 46
eH2_7                 1.481352e-01 1 1  ON 47
eH2_8                 1.579178e-01 1 1  ON 48
eH2_9                 1.875346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9704
    reference variance = 0.1565
====================================================
  Execution time = 3.8636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3803e-01
  Total weights = 2.0000e+06
  Execution time = 3.3665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337879296545
                                         uncertainty =       0.003812415914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337879296545
                                         uncertainty =       0.003812415914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411010465
  error estimate for blocks of size 2^( 2) =       0.000424116153
  error estimate for blocks of size 2^( 3) =       0.000437014376
  error estimate for blocks of size 2^( 4) =       0.000449226732
  error estimate for blocks of size 2^( 5) =       0.000459008489
  error estimate for blocks of size 2^( 6) =       0.000466873409
  error estimate for blocks of size 2^( 7) =       0.000471130895

      target function =                  N/A
              le_mean =     -16.904758276067
             les_mean =     286.108711407604
             stat err =       0.000461559881
             autocorr =       1.261102383260
              std dev =       0.581256573530
             le_variance =       0.337859204272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338480589749
                                         uncertainty =       0.003824367731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338480589749
                                         uncertainty =       0.003824367731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411376187
  error estimate for blocks of size 2^( 2) =       0.000424468520
  error estimate for blocks of size 2^( 3) =       0.000437336405
  error estimate for blocks of size 2^( 4) =       0.000449513120
  error estimate for blocks of size 2^( 5) =       0.000459268865
  error estimate for blocks of size 2^( 6) =       0.000467109401
  error estimate for blocks of size 2^( 7) =       0.000471347026

      target function =                  N/A
              le_mean =     -16.904766575636
             les_mean =     286.109593541369
             stat err =       0.000461809603
             autocorr =       1.260223642152
              std dev =       0.581773782379
             le_variance =       0.338460733864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218266373
                                         uncertainty =       0.003821337259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338218266373
                                         uncertainty =       0.003821337259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411216702
  error estimate for blocks of size 2^( 2) =       0.000424315812
  error estimate for blocks of size 2^( 3) =       0.000437198157
  error estimate for blocks of size 2^( 4) =       0.000449393123
  error estimate for blocks of size 2^( 5) =       0.000459165792
  error estimate for blocks of size 2^( 6) =       0.000467019136
  error estimate for blocks of size 2^( 7) =       0.000471262366

      target function =                  N/A
              le_mean =     -16.904764959649
             les_mean =     286.109276523467
             stat err =       0.000461710104
             autocorr =       1.260657951195
              std dev =       0.581548236674
             le_variance =       0.338198351578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337920682747
                                         uncertainty =       0.003813866502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337920682747
                                         uncertainty =       0.003813866502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411035660
  error estimate for blocks of size 2^( 2) =       0.000424140595
  error estimate for blocks of size 2^( 3) =       0.000437036885
  error estimate for blocks of size 2^( 4) =       0.000449247316
  error estimate for blocks of size 2^( 5) =       0.000459028530
  error estimate for blocks of size 2^( 6) =       0.000466892186
  error estimate for blocks of size 2^( 7) =       0.000471147475

      target function =                  N/A
              le_mean =     -16.904759099852
             les_mean =     286.108780682060
             stat err =       0.000461578877
             autocorr =       1.261051577353
              std dev =       0.581292204480
             le_variance =       0.337900626990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904758276067        initial
     9.7656e-02     9.7656e-01             4.3410e-03       -16.904766575636  <--
     3.9062e-01     3.9062e+00             1.3548e-03       -16.904764959649
     1.5625e+00     1.5625e+01             3.6712e-04       -16.904759099852

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 5.5599e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.061091e-01 1 1  ON 0
 uu_1                 1.403456e-01 1 1  ON 1
 uu_2                 3.993827e-02 1 1  ON 2
 uu_3                -2.083336e-02 1 1  ON 3
 uu_4                -6.378521e-02 1 1  ON 4
 uu_5                -9.628475e-02 1 1  ON 5
 uu_6                -1.214148e-01 1 1  ON 6
 uu_7                -1.324793e-01 1 1  ON 7
 uu_8                -1.245460e-01 1 1  ON 8
 uu_9                -9.526146e-02 1 1  ON 9
 ud_0                 4.376418e-01 1 1  ON 10
 ud_1                 1.741400e-01 1 1  ON 11
 ud_2                 5.852979e-02 1 1  ON 12
 ud_3                -9.222402e-03 1 1  ON 13
 ud_4                -6.520504e-02 1 1  ON 14
 ud_5                -1.053904e-01 1 1  ON 15
 ud_6                -1.314081e-01 1 1  ON 16
 ud_7                -1.469182e-01 1 1  ON 17
 ud_8                -1.478951e-01 1 1  ON 18
 ud_9                -1.380188e-01 1 1  ON 19
 eO_0                -7.447399e-01 1 1  ON 20
 eO_1                -4.294908e-01 1 1  ON 21
 eO_2                -1.645265e-02 1 1  ON 22
 eO_3                 2.948065e-01 1 1  ON 23
 eO_4                 5.100756e-01 1 1  ON 24
 eO_5                 4.655185e-01 1 1  ON 25
 eO_6                 2.373924e-01 1 1  ON 26
 eO_7                -5.440343e-02 1 1  ON 27
 eO_8                -2.024550e-01 1 1  ON 28
 eO_9                -6.252823e-02 1 1  ON 29
eH1_0                -2.273061e-01 1 1  ON 30
eH1_1                -1.318255e-01 1 1  ON 31
eH1_2                -8.779549e-02 1 1  ON 32
eH1_3                -3.546005e-02 1 1  ON 33
eH1_4                 1.138853e-02 1 1  ON 34
eH1_5                 4.546798e-02 1 1  ON 35
eH1_6                 9.878466e-02 1 1  ON 36
eH1_7                 1.423778e-01 1 1  ON 37
eH1_8                 1.512415e-01 1 1  ON 38
eH1_9                 3.800669e-02 1 1  ON 39
eH2_0                -2.252503e-01 1 1  ON 40
eH2_1                -1.297988e-01 1 1  ON 41
eH2_2                -8.544517e-02 1 1  ON 42
eH2_3                -3.302006e-02 1 1  ON 43
eH2_4                 1.393137e-02 1 1  ON 44
eH2_5                 4.880594e-02 1 1  ON 45
eH2_6                 1.012552e-01 1 1  ON 46
eH2_7                 1.480696e-01 1 1  ON 47
eH2_8                 1.592917e-01 1 1  ON 48
eH2_9                 2.057404e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0275e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8984
    reference variance = 0.192237
====================================================
  Execution time = 3.9462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3597e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989350558
                                         uncertainty =       0.002941253280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989350558
                                         uncertainty =       0.002941253280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409858990
  error estimate for blocks of size 2^( 2) =       0.000422888276
  error estimate for blocks of size 2^( 3) =       0.000436365374
  error estimate for blocks of size 2^( 4) =       0.000450053438
  error estimate for blocks of size 2^( 5) =       0.000461510037
  error estimate for blocks of size 2^( 6) =       0.000469852315
  error estimate for blocks of size 2^( 7) =       0.000472380727

      target function =                  N/A
              le_mean =     -16.904657556089
             les_mean =     286.103415704294
             stat err =       0.000463449129
             autocorr =       1.278601500359
              std dev =       0.579628142560
             le_variance =       0.335968783647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690465755609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904657556089       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904661781847       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904663633378       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904670365888       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904668763979       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904675187118       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904684710841       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904688974822       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904694734280       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904692386136       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904691375982       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904691934921       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904692009811       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904692579682       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904693088037       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904693252943       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904693089709       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.048392e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904657556089       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904660892859       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904661730493       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904665993860       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904664792320       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904667664601       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904671192667       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904671580906       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904672046057       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904671000071       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904671207655       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904670929146       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904671054245       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.277051e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904657556089       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904659368079       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904659550361       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904661012529       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904661717565       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904661254122       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904662054460       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904662409257       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904662225536       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904662246941       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 9.953026e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.796616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9465e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.064425e-01 1 1  ON 0
 uu_1                 1.404686e-01 1 1  ON 1
 uu_2                 3.966775e-02 1 1  ON 2
 uu_3                -2.135514e-02 1 1  ON 3
 uu_4                -6.430570e-02 1 1  ON 4
 uu_5                -9.637606e-02 1 1  ON 5
 uu_6                -1.214541e-01 1 1  ON 6
 uu_7                -1.327870e-01 1 1  ON 7
 uu_8                -1.250356e-01 1 1  ON 8
 uu_9                -9.558250e-02 1 1  ON 9
 ud_0                 4.390158e-01 1 1  ON 10
 ud_1                 1.752864e-01 1 1  ON 11
 ud_2                 5.921640e-02 1 1  ON 12
 ud_3                -9.104603e-03 1 1  ON 13
 ud_4                -6.538924e-02 1 1  ON 14
 ud_5                -1.061963e-01 1 1  ON 15
 ud_6                -1.325932e-01 1 1  ON 16
 ud_7                -1.475806e-01 1 1  ON 17
 ud_8                -1.483095e-01 1 1  ON 18
 ud_9                -1.380347e-01 1 1  ON 19
 eO_0                -7.479861e-01 1 1  ON 20
 eO_1                -4.318314e-01 1 1  ON 21
 eO_2                -1.753684e-02 1 1  ON 22
 eO_3                 2.957853e-01 1 1  ON 23
 eO_4                 5.126948e-01 1 1  ON 24
 eO_5                 4.687955e-01 1 1  ON 25
 eO_6                 2.393730e-01 1 1  ON 26
 eO_7                -5.367970e-02 1 1  ON 27
 eO_8                -2.038028e-01 1 1  ON 28
 eO_9                -6.383792e-02 1 1  ON 29
eH1_0                -2.289270e-01 1 1  ON 30
eH1_1                -1.328412e-01 1 1  ON 31
eH1_2                -8.891013e-02 1 1  ON 32
eH1_3                -3.627013e-02 1 1  ON 33
eH1_4                 1.067856e-02 1 1  ON 34
eH1_5                 4.499193e-02 1 1  ON 35
eH1_6                 9.937556e-02 1 1  ON 36
eH1_7                 1.444140e-01 1 1  ON 37
eH1_8                 1.531348e-01 1 1  ON 38
eH1_9                 3.947847e-02 1 1  ON 39
eH2_0                -2.265656e-01 1 1  ON 40
eH2_1                -1.309431e-01 1 1  ON 41
eH2_2                -8.660587e-02 1 1  ON 42
eH2_3                -3.381771e-02 1 1  ON 43
eH2_4                 1.318207e-02 1 1  ON 44
eH2_5                 4.749567e-02 1 1  ON 45
eH2_6                 1.008717e-01 1 1  ON 46
eH2_7                 1.494513e-01 1 1  ON 47
eH2_8                 1.619228e-01 1 1  ON 48
eH2_9                 2.316650e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8748
    reference variance = 0.334703
====================================================
  Execution time = 3.6158e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4779e-01
  Total weights = 2.0000e+06
  Execution time = 3.3633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346897066389
                                         uncertainty =       0.006133750185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346897066389
                                         uncertainty =       0.006133750185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416468988
  error estimate for blocks of size 2^( 2) =       0.000429285863
  error estimate for blocks of size 2^( 3) =       0.000442459386
  error estimate for blocks of size 2^( 4) =       0.000455701567
  error estimate for blocks of size 2^( 5) =       0.000468438090
  error estimate for blocks of size 2^( 6) =       0.000477999629
  error estimate for blocks of size 2^( 7) =       0.000485621739

      target function =                  N/A
              le_mean =     -16.905902835083
             les_mean =     286.156443331013
             stat err =       0.000471940256
             autocorr =       1.284129176065
              std dev =       0.588976090495
             le_variance =       0.346892835175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348733916471
                                         uncertainty =       0.006154451322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348733916471
                                         uncertainty =       0.006154451322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417570537
  error estimate for blocks of size 2^( 2) =       0.000430356413
  error estimate for blocks of size 2^( 3) =       0.000443461721
  error estimate for blocks of size 2^( 4) =       0.000456615664
  error estimate for blocks of size 2^( 5) =       0.000469256480
  error estimate for blocks of size 2^( 6) =       0.000478770357
  error estimate for blocks of size 2^( 7) =       0.000486350983

      target function =                  N/A
              le_mean =     -16.905901751901
             les_mean =     286.158244177558
             stat err =       0.000472748371
             autocorr =       1.281741321570
              std dev =       0.590533916887
             le_variance =       0.348730306994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348711266182
                                         uncertainty =       0.006155852178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348711266182
                                         uncertainty =       0.006155852178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417557112
  error estimate for blocks of size 2^( 2) =       0.000430338467
  error estimate for blocks of size 2^( 3) =       0.000443450201
  error estimate for blocks of size 2^( 4) =       0.000456618688
  error estimate for blocks of size 2^( 5) =       0.000469277660
  error estimate for blocks of size 2^( 6) =       0.000478808897
  error estimate for blocks of size 2^( 7) =       0.000486409379

      target function =                  N/A
              le_mean =     -16.905900192085
             les_mean =     286.158169013349
             stat err =       0.000472778656
             autocorr =       1.281987982160
              std dev =       0.590514930336
             le_variance =       0.348707882950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347229864352
                                         uncertainty =       0.006138320202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347229864352
                                         uncertainty =       0.006138320202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416668844
  error estimate for blocks of size 2^( 2) =       0.000429477880
  error estimate for blocks of size 2^( 3) =       0.000442639376
  error estimate for blocks of size 2^( 4) =       0.000455867739
  error estimate for blocks of size 2^( 5) =       0.000468591306
  error estimate for blocks of size 2^( 6) =       0.000478149248
  error estimate for blocks of size 2^( 7) =       0.000485770182

      target function =                  N/A
              le_mean =     -16.905901260482
             les_mean =     286.156723105866
             stat err =       0.000472094619
             autocorr =       1.283736961494
              std dev =       0.589258729515
             le_variance =       0.347225850310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905902835083        initial  <--
     2.4414e-02     2.4414e-01             1.0484e-02       -16.905901751901
     9.7656e-02     9.7656e-01             3.2771e-03       -16.905900192085
     3.9062e-01     3.9062e+00             9.9530e-04       -16.905901260482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2129
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.061091e-01 1 1  ON 0
 uu_1                 1.403456e-01 1 1  ON 1
 uu_2                 3.993827e-02 1 1  ON 2
 uu_3                -2.083336e-02 1 1  ON 3
 uu_4                -6.378521e-02 1 1  ON 4
 uu_5                -9.628475e-02 1 1  ON 5
 uu_6                -1.214148e-01 1 1  ON 6
 uu_7                -1.324793e-01 1 1  ON 7
 uu_8                -1.245460e-01 1 1  ON 8
 uu_9                -9.526146e-02 1 1  ON 9
 ud_0                 4.376418e-01 1 1  ON 10
 ud_1                 1.741400e-01 1 1  ON 11
 ud_2                 5.852979e-02 1 1  ON 12
 ud_3                -9.222402e-03 1 1  ON 13
 ud_4                -6.520504e-02 1 1  ON 14
 ud_5                -1.053904e-01 1 1  ON 15
 ud_6                -1.314081e-01 1 1  ON 16
 ud_7                -1.469182e-01 1 1  ON 17
 ud_8                -1.478951e-01 1 1  ON 18
 ud_9                -1.380188e-01 1 1  ON 19
 eO_0                -7.447399e-01 1 1  ON 20
 eO_1                -4.294908e-01 1 1  ON 21
 eO_2                -1.645265e-02 1 1  ON 22
 eO_3                 2.948065e-01 1 1  ON 23
 eO_4                 5.100756e-01 1 1  ON 24
 eO_5                 4.655185e-01 1 1  ON 25
 eO_6                 2.373924e-01 1 1  ON 26
 eO_7                -5.440343e-02 1 1  ON 27
 eO_8                -2.024550e-01 1 1  ON 28
 eO_9                -6.252823e-02 1 1  ON 29
eH1_0                -2.273061e-01 1 1  ON 30
eH1_1                -1.318255e-01 1 1  ON 31
eH1_2                -8.779549e-02 1 1  ON 32
eH1_3                -3.546005e-02 1 1  ON 33
eH1_4                 1.138853e-02 1 1  ON 34
eH1_5                 4.546798e-02 1 1  ON 35
eH1_6                 9.878466e-02 1 1  ON 36
eH1_7                 1.423778e-01 1 1  ON 37
eH1_8                 1.512415e-01 1 1  ON 38
eH1_9                 3.800669e-02 1 1  ON 39
eH2_0                -2.252503e-01 1 1  ON 40
eH2_1                -1.297988e-01 1 1  ON 41
eH2_2                -8.544517e-02 1 1  ON 42
eH2_3                -3.302006e-02 1 1  ON 43
eH2_4                 1.393137e-02 1 1  ON 44
eH2_5                 4.880594e-02 1 1  ON 45
eH2_6                 1.012552e-01 1 1  ON 46
eH2_7                 1.480696e-01 1 1  ON 47
eH2_8                 1.592917e-01 1 1  ON 48
eH2_9                 2.057404e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0268e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9697
    reference variance = 0.348713
====================================================
  Execution time = 3.7177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3862e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338712038137
                                         uncertainty =       0.003431894532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338712038137
                                         uncertainty =       0.003431894532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411474691
  error estimate for blocks of size 2^( 2) =       0.000424352560
  error estimate for blocks of size 2^( 3) =       0.000437864163
  error estimate for blocks of size 2^( 4) =       0.000452198738
  error estimate for blocks of size 2^( 5) =       0.000463997158
  error estimate for blocks of size 2^( 6) =       0.000473786289
  error estimate for blocks of size 2^( 7) =       0.000478433149

      target function =                  N/A
              le_mean =     -16.905857990816
             les_mean =     286.146657079071
             stat err =       0.000467103833
             autocorr =       1.288666703482
              std dev =       0.581913088659
             le_variance =       0.338622842752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585799082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857990816       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905859511559       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864369665       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905867546371       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905867080642       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905867451974       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905867158903       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905867358776       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905867479990       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905867327838       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905867276763       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.433656e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857990816       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858553039       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860556453       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905861372175       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905861277226       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861343709       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905861190253       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905861164874       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905861212437       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.077003e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857990816       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858150484       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858759133       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858962231       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858949808       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858959687       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858915836       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858905585       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905858913512       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.047810e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.800297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7071e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.061624e-01 1 1  ON 0
 uu_1                 1.404680e-01 1 1  ON 1
 uu_2                 3.992443e-02 1 1  ON 2
 uu_3                -2.083954e-02 1 1  ON 3
 uu_4                -6.383019e-02 1 1  ON 4
 uu_5                -9.625326e-02 1 1  ON 5
 uu_6                -1.215378e-01 1 1  ON 6
 uu_7                -1.325863e-01 1 1  ON 7
 uu_8                -1.246095e-01 1 1  ON 8
 uu_9                -9.533163e-02 1 1  ON 9
 ud_0                 4.379295e-01 1 1  ON 10
 ud_1                 1.743409e-01 1 1  ON 11
 ud_2                 5.853901e-02 1 1  ON 12
 ud_3                -9.260422e-03 1 1  ON 13
 ud_4                -6.530865e-02 1 1  ON 14
 ud_5                -1.054960e-01 1 1  ON 15
 ud_6                -1.315678e-01 1 1  ON 16
 ud_7                -1.469779e-01 1 1  ON 17
 ud_8                -1.478216e-01 1 1  ON 18
 ud_9                -1.380580e-01 1 1  ON 19
 eO_0                -7.451476e-01 1 1  ON 20
 eO_1                -4.297510e-01 1 1  ON 21
 eO_2                -1.642962e-02 1 1  ON 22
 eO_3                 2.949168e-01 1 1  ON 23
 eO_4                 5.104235e-01 1 1  ON 24
 eO_5                 4.658343e-01 1 1  ON 25
 eO_6                 2.375093e-01 1 1  ON 26
 eO_7                -5.434940e-02 1 1  ON 27
 eO_8                -2.025966e-01 1 1  ON 28
 eO_9                -6.266118e-02 1 1  ON 29
eH1_0                -2.275021e-01 1 1  ON 30
eH1_1                -1.318890e-01 1 1  ON 31
eH1_2                -8.793332e-02 1 1  ON 32
eH1_3                -3.557828e-02 1 1  ON 33
eH1_4                 1.141415e-02 1 1  ON 34
eH1_5                 4.538794e-02 1 1  ON 35
eH1_6                 9.880469e-02 1 1  ON 36
eH1_7                 1.425093e-01 1 1  ON 37
eH1_8                 1.514433e-01 1 1  ON 38
eH1_9                 3.820363e-02 1 1  ON 39
eH2_0                -2.254926e-01 1 1  ON 40
eH2_1                -1.298746e-01 1 1  ON 41
eH2_2                -8.551434e-02 1 1  ON 42
eH2_3                -3.307272e-02 1 1  ON 43
eH2_4                 1.403406e-02 1 1  ON 44
eH2_5                 4.865167e-02 1 1  ON 45
eH2_6                 1.012750e-01 1 1  ON 46
eH2_7                 1.481198e-01 1 1  ON 47
eH2_8                 1.594898e-01 1 1  ON 48
eH2_9                 2.079817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8213
    reference variance = 0.399294
====================================================
  Execution time = 3.6124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4104e-01
  Total weights = 2.0000e+06
  Execution time = 3.3664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340550676038
                                         uncertainty =       0.006198569469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340550676038
                                         uncertainty =       0.006198569469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412787396
  error estimate for blocks of size 2^( 2) =       0.000425046175
  error estimate for blocks of size 2^( 3) =       0.000438878664
  error estimate for blocks of size 2^( 4) =       0.000452506990
  error estimate for blocks of size 2^( 5) =       0.000465402997
  error estimate for blocks of size 2^( 6) =       0.000473655880
  error estimate for blocks of size 2^( 7) =       0.000479201564

      target function =                  N/A
              le_mean =     -16.905310053996
             les_mean =     286.130294720408
             stat err =       0.000467691858
             autocorr =       1.283709519244
              std dev =       0.583769534206
             le_variance =       0.340786869067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341238955795
                                         uncertainty =       0.006215553551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341238955795
                                         uncertainty =       0.006215553551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413204048
  error estimate for blocks of size 2^( 2) =       0.000425439588
  error estimate for blocks of size 2^( 3) =       0.000439242460
  error estimate for blocks of size 2^( 4) =       0.000452840739
  error estimate for blocks of size 2^( 5) =       0.000465715115
  error estimate for blocks of size 2^( 6) =       0.000473954163
  error estimate for blocks of size 2^( 7) =       0.000479489025

      target function =                  N/A
              le_mean =     -16.905309335941
             les_mean =     286.130958743869
             stat err =       0.000467999760
             autocorr =       1.282809378417
              std dev =       0.584358768868
             le_variance =       0.341475170753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341052594551
                                         uncertainty =       0.006211135410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341052594551
                                         uncertainty =       0.006211135410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413091237
  error estimate for blocks of size 2^( 2) =       0.000425331945
  error estimate for blocks of size 2^( 3) =       0.000439142836
  error estimate for blocks of size 2^( 4) =       0.000452750746
  error estimate for blocks of size 2^( 5) =       0.000465632088
  error estimate for blocks of size 2^( 6) =       0.000473875460
  error estimate for blocks of size 2^( 7) =       0.000479414643

      target function =                  N/A
              le_mean =     -16.905309177172
             les_mean =     286.130766945238
             stat err =       0.000467918234
             autocorr =       1.283062979725
              std dev =       0.584199229799
             le_variance =       0.341288740098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623084981
                                         uncertainty =       0.006200391549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623084981
                                         uncertainty =       0.006200391549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412831242
  error estimate for blocks of size 2^( 2) =       0.000425087304
  error estimate for blocks of size 2^( 3) =       0.000438916618
  error estimate for blocks of size 2^( 4) =       0.000452542032
  error estimate for blocks of size 2^( 5) =       0.000465435947
  error estimate for blocks of size 2^( 6) =       0.000473687436
  error estimate for blocks of size 2^( 7) =       0.000479232209

      target function =                  N/A
              le_mean =     -16.905309821664
             les_mean =     286.130359264436
             stat err =       0.000467724406
             autocorr =       1.283615498281
              std dev =       0.583831541134
             le_variance =       0.340859268423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905310053996        initial  <--
     2.4414e-01     2.4414e+00             1.4337e-03       -16.905309335941
     9.7656e-01     9.7656e+00             4.0770e-04       -16.905309177172
     3.9062e+00     3.9062e+01             1.0478e-04       -16.905309821664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1109
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.061091e-01 1 1  ON 0
 uu_1                 1.403456e-01 1 1  ON 1
 uu_2                 3.993827e-02 1 1  ON 2
 uu_3                -2.083336e-02 1 1  ON 3
 uu_4                -6.378521e-02 1 1  ON 4
 uu_5                -9.628475e-02 1 1  ON 5
 uu_6                -1.214148e-01 1 1  ON 6
 uu_7                -1.324793e-01 1 1  ON 7
 uu_8                -1.245460e-01 1 1  ON 8
 uu_9                -9.526146e-02 1 1  ON 9
 ud_0                 4.376418e-01 1 1  ON 10
 ud_1                 1.741400e-01 1 1  ON 11
 ud_2                 5.852979e-02 1 1  ON 12
 ud_3                -9.222402e-03 1 1  ON 13
 ud_4                -6.520504e-02 1 1  ON 14
 ud_5                -1.053904e-01 1 1  ON 15
 ud_6                -1.314081e-01 1 1  ON 16
 ud_7                -1.469182e-01 1 1  ON 17
 ud_8                -1.478951e-01 1 1  ON 18
 ud_9                -1.380188e-01 1 1  ON 19
 eO_0                -7.447399e-01 1 1  ON 20
 eO_1                -4.294908e-01 1 1  ON 21
 eO_2                -1.645265e-02 1 1  ON 22
 eO_3                 2.948065e-01 1 1  ON 23
 eO_4                 5.100756e-01 1 1  ON 24
 eO_5                 4.655185e-01 1 1  ON 25
 eO_6                 2.373924e-01 1 1  ON 26
 eO_7                -5.440343e-02 1 1  ON 27
 eO_8                -2.024550e-01 1 1  ON 28
 eO_9                -6.252823e-02 1 1  ON 29
eH1_0                -2.273061e-01 1 1  ON 30
eH1_1                -1.318255e-01 1 1  ON 31
eH1_2                -8.779549e-02 1 1  ON 32
eH1_3                -3.546005e-02 1 1  ON 33
eH1_4                 1.138853e-02 1 1  ON 34
eH1_5                 4.546798e-02 1 1  ON 35
eH1_6                 9.878466e-02 1 1  ON 36
eH1_7                 1.423778e-01 1 1  ON 37
eH1_8                 1.512415e-01 1 1  ON 38
eH1_9                 3.800669e-02 1 1  ON 39
eH2_0                -2.252503e-01 1 1  ON 40
eH2_1                -1.297988e-01 1 1  ON 41
eH2_2                -8.544517e-02 1 1  ON 42
eH2_3                -3.302006e-02 1 1  ON 43
eH2_4                 1.393137e-02 1 1  ON 44
eH2_5                 4.880594e-02 1 1  ON 45
eH2_6                 1.012552e-01 1 1  ON 46
eH2_7                 1.480696e-01 1 1  ON 47
eH2_8                 1.592917e-01 1 1  ON 48
eH2_9                 2.057404e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0019e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9229
    reference variance = 0.184287
====================================================
  Execution time = 3.7682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3927e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339309970336
                                         uncertainty =       0.004964995670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339309970336
                                         uncertainty =       0.004964995670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864869
  error estimate for blocks of size 2^( 2) =       0.000424398523
  error estimate for blocks of size 2^( 3) =       0.000437064139
  error estimate for blocks of size 2^( 4) =       0.000448896517
  error estimate for blocks of size 2^( 5) =       0.000459349798
  error estimate for blocks of size 2^( 6) =       0.000466917186
  error estimate for blocks of size 2^( 7) =       0.000469813403

      target function =                  N/A
              le_mean =     -16.905361466719
             les_mean =     286.130511491476
             stat err =       0.000461244226
             autocorr =       1.254158386014
              std dev =       0.582464883651
             le_variance =       0.339265340686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690536146672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905361466719       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905361606414       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905361676268       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905361886730       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905361910201       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905361944627       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905362017367       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905362057345       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.786665e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905361466719       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905361503957       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905361522053       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905361572352       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905361576502       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905361582996       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905361600654       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905361611106       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.573209e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905361466719       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905361476185       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905361480758       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905361493150       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905361494060       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905361495500       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905361499856       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905361502478       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.150602e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.802961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7508e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.061158e-01 1 1  ON 0
 uu_1                 1.403597e-01 1 1  ON 1
 uu_2                 3.993714e-02 1 1  ON 2
 uu_3                -2.083424e-02 1 1  ON 3
 uu_4                -6.378595e-02 1 1  ON 4
 uu_5                -9.628798e-02 1 1  ON 5
 uu_6                -1.214202e-01 1 1  ON 6
 uu_7                -1.324884e-01 1 1  ON 7
 uu_8                -1.245626e-01 1 1  ON 8
 uu_9                -9.527390e-02 1 1  ON 9
 ud_0                 4.376567e-01 1 1  ON 10
 ud_1                 1.741654e-01 1 1  ON 11
 ud_2                 5.853028e-02 1 1  ON 12
 ud_3                -9.228551e-03 1 1  ON 13
 ud_4                -6.520946e-02 1 1  ON 14
 ud_5                -1.053936e-01 1 1  ON 15
 ud_6                -1.314221e-01 1 1  ON 16
 ud_7                -1.469119e-01 1 1  ON 17
 ud_8                -1.479023e-01 1 1  ON 18
 ud_9                -1.380287e-01 1 1  ON 19
 eO_0                -7.447857e-01 1 1  ON 20
 eO_1                -4.295124e-01 1 1  ON 21
 eO_2                -1.645377e-02 1 1  ON 22
 eO_3                 2.948315e-01 1 1  ON 23
 eO_4                 5.101050e-01 1 1  ON 24
 eO_5                 4.655457e-01 1 1  ON 25
 eO_6                 2.374093e-01 1 1  ON 26
 eO_7                -5.439589e-02 1 1  ON 27
 eO_8                -2.024745e-01 1 1  ON 28
 eO_9                -6.254431e-02 1 1  ON 29
eH1_0                -2.273286e-01 1 1  ON 30
eH1_1                -1.318384e-01 1 1  ON 31
eH1_2                -8.780036e-02 1 1  ON 32
eH1_3                -3.547172e-02 1 1  ON 33
eH1_4                 1.139563e-02 1 1  ON 34
eH1_5                 4.545429e-02 1 1  ON 35
eH1_6                 9.878403e-02 1 1  ON 36
eH1_7                 1.423926e-01 1 1  ON 37
eH1_8                 1.512646e-01 1 1  ON 38
eH1_9                 3.802774e-02 1 1  ON 39
eH2_0                -2.252694e-01 1 1  ON 40
eH2_1                -1.297980e-01 1 1  ON 41
eH2_2                -8.545732e-02 1 1  ON 42
eH2_3                -3.301968e-02 1 1  ON 43
eH2_4                 1.392861e-02 1 1  ON 44
eH2_5                 4.880640e-02 1 1  ON 45
eH2_6                 1.012631e-01 1 1  ON 46
eH2_7                 1.480688e-01 1 1  ON 47
eH2_8                 1.593026e-01 1 1  ON 48
eH2_9                 2.059026e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.206685
====================================================
  Execution time = 3.8915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4109e-01
  Total weights = 2.0000e+06
  Execution time = 3.3686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341171615315
                                         uncertainty =       0.008822710571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341171615315
                                         uncertainty =       0.008822710571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412965856
  error estimate for blocks of size 2^( 2) =       0.000426462479
  error estimate for blocks of size 2^( 3) =       0.000439204214
  error estimate for blocks of size 2^( 4) =       0.000451022475
  error estimate for blocks of size 2^( 5) =       0.000461301039
  error estimate for blocks of size 2^( 6) =       0.000469592457
  error estimate for blocks of size 2^( 7) =       0.000471614225

      target function =                  N/A
              le_mean =     -16.905016109341
             les_mean =     286.120651083105
             stat err =       0.000463382549
             autocorr =       1.259073423841
              std dev =       0.584021914444
             le_variance =       0.341081596551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341223110653
                                         uncertainty =       0.008826309463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341223110653
                                         uncertainty =       0.008826309463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412996986
  error estimate for blocks of size 2^( 2) =       0.000426491960
  error estimate for blocks of size 2^( 3) =       0.000439230703
  error estimate for blocks of size 2^( 4) =       0.000451045785
  error estimate for blocks of size 2^( 5) =       0.000461322957
  error estimate for blocks of size 2^( 6) =       0.000469611968
  error estimate for blocks of size 2^( 7) =       0.000471633082

      target function =                  N/A
              le_mean =     -16.905016382355
             les_mean =     286.120711737892
             stat err =       0.000463403448
             autocorr =       1.258997181707
              std dev =       0.584065938720
             le_variance =       0.341133020773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341196663658
                                         uncertainty =       0.008824594739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341196663658
                                         uncertainty =       0.008824594739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412980996
  error estimate for blocks of size 2^( 2) =       0.000426476795
  error estimate for blocks of size 2^( 3) =       0.000439216990
  error estimate for blocks of size 2^( 4) =       0.000451033571
  error estimate for blocks of size 2^( 5) =       0.000461311462
  error estimate for blocks of size 2^( 6) =       0.000469601524
  error estimate for blocks of size 2^( 7) =       0.000471622990

      target function =                  N/A
              le_mean =     -16.905016256385
             les_mean =     286.120681064562
             stat err =       0.000463392387
             autocorr =       1.259034567389
              std dev =       0.584043325855
             le_variance =       0.341106606475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341174706302
                                         uncertainty =       0.008822949059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341174706302
                                         uncertainty =       0.008822949059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412967724
  error estimate for blocks of size 2^( 2) =       0.000426464244
  error estimate for blocks of size 2^( 3) =       0.000439205785
  error estimate for blocks of size 2^( 4) =       0.000451023833
  error estimate for blocks of size 2^( 5) =       0.000461302314
  error estimate for blocks of size 2^( 6) =       0.000469593557
  error estimate for blocks of size 2^( 7) =       0.000471615288

      target function =                  N/A
              le_mean =     -16.905016127458
             les_mean =     286.120654781694
             stat err =       0.000463383748
             autocorr =       1.259068547557
              std dev =       0.584024556533
             le_variance =       0.341084682634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905016109341        initial
     2.4414e+00     2.4414e+01             1.7867e-04       -16.905016382355  <--
     9.7656e+00     9.7656e+01             4.5732e-05       -16.905016256385
     3.9062e+01     3.9062e+02             1.1506e-05       -16.905016127458

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 5.5895e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.061374e-01 1 1  ON 0
 uu_1                 1.403987e-01 1 1  ON 1
 uu_2                 3.993616e-02 1 1  ON 2
 uu_3                -2.083682e-02 1 1  ON 3
 uu_4                -6.378907e-02 1 1  ON 4
 uu_5                -9.629741e-02 1 1  ON 5
 uu_6                -1.214363e-01 1 1  ON 6
 uu_7                -1.325154e-01 1 1  ON 7
 uu_8                -1.246119e-01 1 1  ON 8
 uu_9                -9.531113e-02 1 1  ON 9
 ud_0                 4.377049e-01 1 1  ON 10
 ud_1                 1.742330e-01 1 1  ON 11
 ud_2                 5.853597e-02 1 1  ON 12
 ud_3                -9.245975e-03 1 1  ON 13
 ud_4                -6.522358e-02 1 1  ON 14
 ud_5                -1.054033e-01 1 1  ON 15
 ud_6                -1.314620e-01 1 1  ON 16
 ud_7                -1.468944e-01 1 1  ON 17
 ud_8                -1.479239e-01 1 1  ON 18
 ud_9                -1.380584e-01 1 1  ON 19
 eO_0                -7.449186e-01 1 1  ON 20
 eO_1                -4.295761e-01 1 1  ON 21
 eO_2                -1.645974e-02 1 1  ON 22
 eO_3                 2.949036e-01 1 1  ON 23
 eO_4                 5.101938e-01 1 1  ON 24
 eO_5                 4.656272e-01 1 1  ON 25
 eO_6                 2.374594e-01 1 1  ON 26
 eO_7                -5.437356e-02 1 1  ON 27
 eO_8                -2.025328e-01 1 1  ON 28
 eO_9                -6.259227e-02 1 1  ON 29
eH1_0                -2.273950e-01 1 1  ON 30
eH1_1                -1.318766e-01 1 1  ON 31
eH1_2                -8.781582e-02 1 1  ON 32
eH1_3                -3.550445e-02 1 1  ON 33
eH1_4                 1.141429e-02 1 1  ON 34
eH1_5                 4.541426e-02 1 1  ON 35
eH1_6                 9.878224e-02 1 1  ON 36
eH1_7                 1.424365e-01 1 1  ON 37
eH1_8                 1.513336e-01 1 1  ON 38
eH1_9                 3.809051e-02 1 1  ON 39
eH2_0                -2.253253e-01 1 1  ON 40
eH2_1                -1.297984e-01 1 1  ON 41
eH2_2                -8.549070e-02 1 1  ON 42
eH2_3                -3.301944e-02 1 1  ON 43
eH2_4                 1.392054e-02 1 1  ON 44
eH2_5                 4.880786e-02 1 1  ON 45
eH2_6                 1.012870e-01 1 1  ON 46
eH2_7                 1.480665e-01 1 1  ON 47
eH2_8                 1.593351e-01 1 1  ON 48
eH2_9                 2.063857e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0341e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8804
    reference variance = 0.329347
====================================================
  Execution time = 3.9039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334614678462
                                         uncertainty =       0.002905640026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334614678462
                                         uncertainty =       0.002905640026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409087567
  error estimate for blocks of size 2^( 2) =       0.000422339374
  error estimate for blocks of size 2^( 3) =       0.000435811783
  error estimate for blocks of size 2^( 4) =       0.000447734325
  error estimate for blocks of size 2^( 5) =       0.000458639561
  error estimate for blocks of size 2^( 6) =       0.000465907647
  error estimate for blocks of size 2^( 7) =       0.000472600257

      target function =                  N/A
              le_mean =     -16.906131231556
             les_mean =     286.151978326292
             stat err =       0.000461220447
             autocorr =       1.271114122417
              std dev =       0.578537185552
             le_variance =       0.334705275067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613123156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131231556       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906131377796       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132211193       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132069828       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132042235       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132006624       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132618261       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132693154       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906132774161       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 7.492786e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131231556       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906131276158       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131566427       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906131584386       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906131590448       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906131514945       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906131642365       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906131651878       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 2.024116e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131231556       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906131243355       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131323796       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906131333093       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906131337344       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906131315496       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906131342604       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906131343693       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 5.186196e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.805775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8961e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.061398e-01 1 1  ON 0
 uu_1                 1.404335e-01 1 1  ON 1
 uu_2                 3.993963e-02 1 1  ON 2
 uu_3                -2.086776e-02 1 1  ON 3
 uu_4                -6.385278e-02 1 1  ON 4
 uu_5                -9.625583e-02 1 1  ON 5
 uu_6                -1.214709e-01 1 1  ON 6
 uu_7                -1.325488e-01 1 1  ON 7
 uu_8                -1.246273e-01 1 1  ON 8
 uu_9                -9.531808e-02 1 1  ON 9
 ud_0                 4.377852e-01 1 1  ON 10
 ud_1                 1.742915e-01 1 1  ON 11
 ud_2                 5.852710e-02 1 1  ON 12
 ud_3                -9.282816e-03 1 1  ON 13
 ud_4                -6.526265e-02 1 1  ON 14
 ud_5                -1.054538e-01 1 1  ON 15
 ud_6                -1.314916e-01 1 1  ON 16
 ud_7                -1.469215e-01 1 1  ON 17
 ud_8                -1.479043e-01 1 1  ON 18
 ud_9                -1.380444e-01 1 1  ON 19
 eO_0                -7.451210e-01 1 1  ON 20
 eO_1                -4.296757e-01 1 1  ON 21
 eO_2                -1.646419e-02 1 1  ON 22
 eO_3                 2.950082e-01 1 1  ON 23
 eO_4                 5.103319e-01 1 1  ON 24
 eO_5                 4.657340e-01 1 1  ON 25
 eO_6                 2.374916e-01 1 1  ON 26
 eO_7                -5.434017e-02 1 1  ON 27
 eO_8                -2.025815e-01 1 1  ON 28
 eO_9                -6.264596e-02 1 1  ON 29
eH1_0                -2.274842e-01 1 1  ON 30
eH1_1                -1.319158e-01 1 1  ON 31
eH1_2                -8.785262e-02 1 1  ON 32
eH1_3                -3.553146e-02 1 1  ON 33
eH1_4                 1.143525e-02 1 1  ON 34
eH1_5                 4.536070e-02 1 1  ON 35
eH1_6                 9.881773e-02 1 1  ON 36
eH1_7                 1.424955e-01 1 1  ON 37
eH1_8                 1.513963e-01 1 1  ON 38
eH1_9                 3.815440e-02 1 1  ON 39
eH2_0                -2.254101e-01 1 1  ON 40
eH2_1                -1.298296e-01 1 1  ON 41
eH2_2                -8.556614e-02 1 1  ON 42
eH2_3                -3.302377e-02 1 1  ON 43
eH2_4                 1.396289e-02 1 1  ON 44
eH2_5                 4.876193e-02 1 1  ON 45
eH2_6                 1.013120e-01 1 1  ON 46
eH2_7                 1.480834e-01 1 1  ON 47
eH2_8                 1.593932e-01 1 1  ON 48
eH2_9                 2.073475e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.250902
====================================================
  Execution time = 3.6179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4467e-01
  Total weights = 2.0000e+06
  Execution time = 3.3693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576262782
                                         uncertainty =       0.006615068641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576262782
                                         uncertainty =       0.006615068641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415085650
  error estimate for blocks of size 2^( 2) =       0.000427815163
  error estimate for blocks of size 2^( 3) =       0.000440830392
  error estimate for blocks of size 2^( 4) =       0.000452873350
  error estimate for blocks of size 2^( 5) =       0.000464114071
  error estimate for blocks of size 2^( 6) =       0.000472111322
  error estimate for blocks of size 2^( 7) =       0.000477259187

      target function =                  N/A
              le_mean =     -16.905275967759
             les_mean =     286.132947567164
             stat err =       0.000466589482
             autocorr =       1.263555874672
              std dev =       0.587019755533
             le_variance =       0.344592193387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851738960
                                         uncertainty =       0.006620400386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344851738960
                                         uncertainty =       0.006620400386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415251628
  error estimate for blocks of size 2^( 2) =       0.000427973067
  error estimate for blocks of size 2^( 3) =       0.000440977925
  error estimate for blocks of size 2^( 4) =       0.000453012880
  error estimate for blocks of size 2^( 5) =       0.000464246041
  error estimate for blocks of size 2^( 6) =       0.000472236085
  error estimate for blocks of size 2^( 7) =       0.000477374721

      target function =                  N/A
              le_mean =     -16.905274915448
             les_mean =     286.133187624208
             stat err =       0.000466717432
             autocorr =       1.263238505666
              std dev =       0.587254484669
             le_variance =       0.344867829764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344738527377
                                         uncertainty =       0.006618392618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344738527377
                                         uncertainty =       0.006618392618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415183421
  error estimate for blocks of size 2^( 2) =       0.000427907813
  error estimate for blocks of size 2^( 3) =       0.000440916807
  error estimate for blocks of size 2^( 4) =       0.000452955188
  error estimate for blocks of size 2^( 5) =       0.000464191597
  error estimate for blocks of size 2^( 6) =       0.000472184571
  error estimate for blocks of size 2^( 7) =       0.000477327152

      target function =                  N/A
              le_mean =     -16.905275193594
             les_mean =     286.133083744223
             stat err =       0.000466664627
             autocorr =       1.263367674845
              std dev =       0.587158024252
             le_variance =       0.344754545444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344597001928
                                         uncertainty =       0.006615509369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344597001928
                                         uncertainty =       0.006615509369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415098148
  error estimate for blocks of size 2^( 2) =       0.000427826983
  error estimate for blocks of size 2^( 3) =       0.000440841395
  error estimate for blocks of size 2^( 4) =       0.000452883767
  error estimate for blocks of size 2^( 5) =       0.000464123929
  error estimate for blocks of size 2^( 6) =       0.000472120607
  error estimate for blocks of size 2^( 7) =       0.000477267781

      target function =                  N/A
              le_mean =     -16.905275855903
             les_mean =     286.132964536105
             stat err =       0.000466599021
             autocorr =       1.263531447850
              std dev =       0.587037430013
             le_variance =       0.344612944236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905275967759        initial  <--
     6.1035e-01     6.1035e+00             7.4928e-04       -16.905274915448
     2.4414e+00     2.4414e+01             2.0241e-04       -16.905275193594
     9.7656e+00     9.7656e+01             5.1862e-05       -16.905275855903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1469
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.061374e-01 1 1  ON 0
 uu_1                 1.403987e-01 1 1  ON 1
 uu_2                 3.993616e-02 1 1  ON 2
 uu_3                -2.083682e-02 1 1  ON 3
 uu_4                -6.378907e-02 1 1  ON 4
 uu_5                -9.629741e-02 1 1  ON 5
 uu_6                -1.214363e-01 1 1  ON 6
 uu_7                -1.325154e-01 1 1  ON 7
 uu_8                -1.246119e-01 1 1  ON 8
 uu_9                -9.531113e-02 1 1  ON 9
 ud_0                 4.377049e-01 1 1  ON 10
 ud_1                 1.742330e-01 1 1  ON 11
 ud_2                 5.853597e-02 1 1  ON 12
 ud_3                -9.245975e-03 1 1  ON 13
 ud_4                -6.522358e-02 1 1  ON 14
 ud_5                -1.054033e-01 1 1  ON 15
 ud_6                -1.314620e-01 1 1  ON 16
 ud_7                -1.468944e-01 1 1  ON 17
 ud_8                -1.479239e-01 1 1  ON 18
 ud_9                -1.380584e-01 1 1  ON 19
 eO_0                -7.449186e-01 1 1  ON 20
 eO_1                -4.295761e-01 1 1  ON 21
 eO_2                -1.645974e-02 1 1  ON 22
 eO_3                 2.949036e-01 1 1  ON 23
 eO_4                 5.101938e-01 1 1  ON 24
 eO_5                 4.656272e-01 1 1  ON 25
 eO_6                 2.374594e-01 1 1  ON 26
 eO_7                -5.437356e-02 1 1  ON 27
 eO_8                -2.025328e-01 1 1  ON 28
 eO_9                -6.259227e-02 1 1  ON 29
eH1_0                -2.273950e-01 1 1  ON 30
eH1_1                -1.318766e-01 1 1  ON 31
eH1_2                -8.781582e-02 1 1  ON 32
eH1_3                -3.550445e-02 1 1  ON 33
eH1_4                 1.141429e-02 1 1  ON 34
eH1_5                 4.541426e-02 1 1  ON 35
eH1_6                 9.878224e-02 1 1  ON 36
eH1_7                 1.424365e-01 1 1  ON 37
eH1_8                 1.513336e-01 1 1  ON 38
eH1_9                 3.809051e-02 1 1  ON 39
eH2_0                -2.253253e-01 1 1  ON 40
eH2_1                -1.297984e-01 1 1  ON 41
eH2_2                -8.549070e-02 1 1  ON 42
eH2_3                -3.301944e-02 1 1  ON 43
eH2_4                 1.392054e-02 1 1  ON 44
eH2_5                 4.880786e-02 1 1  ON 45
eH2_6                 1.012870e-01 1 1  ON 46
eH2_7                 1.480665e-01 1 1  ON 47
eH2_8                 1.593351e-01 1 1  ON 48
eH2_9                 2.063857e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.245557
====================================================
  Execution time = 3.7154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4235e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342418643060
                                         uncertainty =       0.004591846951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342418643060
                                         uncertainty =       0.004591846951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413731008
  error estimate for blocks of size 2^( 2) =       0.000426570561
  error estimate for blocks of size 2^( 3) =       0.000440158300
  error estimate for blocks of size 2^( 4) =       0.000453516099
  error estimate for blocks of size 2^( 5) =       0.000465452843
  error estimate for blocks of size 2^( 6) =       0.000474767415
  error estimate for blocks of size 2^( 7) =       0.000482698928

      target function =                  N/A
              le_mean =     -16.905759748241
             les_mean =     286.147059187986
             stat err =       0.000469108821
             autocorr =       1.285615372116
              std dev =       0.585104002662
             le_variance =       0.342346693931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575974824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759748241       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759768203       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759770360       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759948574       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759981387       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760048559       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760059836       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760039959       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 7.133212e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759748241       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759753345       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759753557       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759799720       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759807453       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759823654       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759826670       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759821953       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.798503e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759748241       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759749524       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759749556       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759761202       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759763104       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759767116       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759767882       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759766721       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.506147e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.808430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7127e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.061395e-01 1 1  ON 0
 uu_1                 1.403994e-01 1 1  ON 1
 uu_2                 3.993520e-02 1 1  ON 2
 uu_3                -2.083801e-02 1 1  ON 3
 uu_4                -6.379494e-02 1 1  ON 4
 uu_5                -9.629754e-02 1 1  ON 5
 uu_6                -1.214377e-01 1 1  ON 6
 uu_7                -1.325219e-01 1 1  ON 7
 uu_8                -1.246144e-01 1 1  ON 8
 uu_9                -9.530991e-02 1 1  ON 9
 ud_0                 4.377111e-01 1 1  ON 10
 ud_1                 1.742346e-01 1 1  ON 11
 ud_2                 5.853788e-02 1 1  ON 12
 ud_3                -9.248149e-03 1 1  ON 13
 ud_4                -6.522875e-02 1 1  ON 14
 ud_5                -1.054105e-01 1 1  ON 15
 ud_6                -1.314648e-01 1 1  ON 16
 ud_7                -1.468942e-01 1 1  ON 17
 ud_8                -1.479207e-01 1 1  ON 18
 ud_9                -1.380552e-01 1 1  ON 19
 eO_0                -7.449366e-01 1 1  ON 20
 eO_1                -4.295848e-01 1 1  ON 21
 eO_2                -1.646365e-02 1 1  ON 22
 eO_3                 2.949112e-01 1 1  ON 23
 eO_4                 5.102089e-01 1 1  ON 24
 eO_5                 4.656367e-01 1 1  ON 25
 eO_6                 2.374643e-01 1 1  ON 26
 eO_7                -5.437071e-02 1 1  ON 27
 eO_8                -2.025369e-01 1 1  ON 28
 eO_9                -6.259679e-02 1 1  ON 29
eH1_0                -2.274024e-01 1 1  ON 30
eH1_1                -1.318826e-01 1 1  ON 31
eH1_2                -8.781859e-02 1 1  ON 32
eH1_3                -3.550372e-02 1 1  ON 33
eH1_4                 1.141322e-02 1 1  ON 34
eH1_5                 4.541044e-02 1 1  ON 35
eH1_6                 9.878401e-02 1 1  ON 36
eH1_7                 1.424394e-01 1 1  ON 37
eH1_8                 1.513408e-01 1 1  ON 38
eH1_9                 3.809820e-02 1 1  ON 39
eH2_0                -2.253371e-01 1 1  ON 40
eH2_1                -1.298016e-01 1 1  ON 41
eH2_2                -8.549714e-02 1 1  ON 42
eH2_3                -3.302263e-02 1 1  ON 43
eH2_4                 1.392057e-02 1 1  ON 44
eH2_5                 4.880083e-02 1 1  ON 45
eH2_6                 1.012928e-01 1 1  ON 46
eH2_7                 1.480676e-01 1 1  ON 47
eH2_8                 1.593431e-01 1 1  ON 48
eH2_9                 2.065197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.198031
====================================================
  Execution time = 3.6187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5469e-01
  Total weights = 2.0000e+06
  Execution time = 3.3694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354762159377
                                         uncertainty =       0.012883862468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354762159377
                                         uncertainty =       0.012883862468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421121015
  error estimate for blocks of size 2^( 2) =       0.000433565232
  error estimate for blocks of size 2^( 3) =       0.000447129593
  error estimate for blocks of size 2^( 4) =       0.000460333686
  error estimate for blocks of size 2^( 5) =       0.000470862804
  error estimate for blocks of size 2^( 6) =       0.000481414409
  error estimate for blocks of size 2^( 7) =       0.000487706340

      target function =                  N/A
              le_mean =     -16.905668406756
             les_mean =     286.156309919646
             stat err =       0.000475079310
             autocorr =       1.272677614942
              std dev =       0.595555050186
             le_variance =       0.354685817802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354784979198
                                         uncertainty =       0.012884371350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354784979198
                                         uncertainty =       0.012884371350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421134553
  error estimate for blocks of size 2^( 2) =       0.000433578327
  error estimate for blocks of size 2^( 3) =       0.000447142154
  error estimate for blocks of size 2^( 4) =       0.000460345396
  error estimate for blocks of size 2^( 5) =       0.000470873890
  error estimate for blocks of size 2^( 6) =       0.000481424776
  error estimate for blocks of size 2^( 7) =       0.000487716446

      target function =                  N/A
              le_mean =     -16.905668473725
             les_mean =     286.156334989093
             stat err =       0.000475090127
             autocorr =       1.272653745370
              std dev =       0.595574195998
             le_variance =       0.354708622938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354773786122
                                         uncertainty =       0.012884119392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354773786122
                                         uncertainty =       0.012884119392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421127912
  error estimate for blocks of size 2^( 2) =       0.000433571905
  error estimate for blocks of size 2^( 3) =       0.000447135998
  error estimate for blocks of size 2^( 4) =       0.000460339662
  error estimate for blocks of size 2^( 5) =       0.000470868471
  error estimate for blocks of size 2^( 6) =       0.000481419714
  error estimate for blocks of size 2^( 7) =       0.000487711508

      target function =                  N/A
              le_mean =     -16.905668439420
             les_mean =     286.156322643124
             stat err =       0.000475084839
             autocorr =       1.272665548859
              std dev =       0.595564804917
             le_variance =       0.354697436856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354763619467
                                         uncertainty =       0.012883894660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354763619467
                                         uncertainty =       0.012883894660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421121881
  error estimate for blocks of size 2^( 2) =       0.000433566070
  error estimate for blocks of size 2^( 3) =       0.000447130397
  error estimate for blocks of size 2^( 4) =       0.000460334436
  error estimate for blocks of size 2^( 5) =       0.000470863516
  error estimate for blocks of size 2^( 6) =       0.000481415076
  error estimate for blocks of size 2^( 7) =       0.000487706989

      target function =                  N/A
              le_mean =     -16.905668410763
             les_mean =     286.156311514255
             stat err =       0.000475080004
             autocorr =       1.272676102412
              std dev =       0.595556275190
             le_variance =       0.354687276918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905668406756        initial
     6.1035e+00     6.1035e+01             7.1332e-05       -16.905668473725  <--
     2.4414e+01     2.4414e+02             1.7985e-05       -16.905668439420
     9.7656e+01     9.7656e+02             4.5061e-06       -16.905668410763

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 5.3157e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.061459e-01 1 1  ON 0
 uu_1                 1.404016e-01 1 1  ON 1
 uu_2                 3.993246e-02 1 1  ON 2
 uu_3                -2.084177e-02 1 1  ON 3
 uu_4                -6.381207e-02 1 1  ON 4
 uu_5                -9.629846e-02 1 1  ON 5
 uu_6                -1.214420e-01 1 1  ON 6
 uu_7                -1.325412e-01 1 1  ON 7
 uu_8                -1.246218e-01 1 1  ON 8
 uu_9                -9.530627e-02 1 1  ON 9
 ud_0                 4.377293e-01 1 1  ON 10
 ud_1                 1.742399e-01 1 1  ON 11
 ud_2                 5.854324e-02 1 1  ON 12
 ud_3                -9.254491e-03 1 1  ON 13
 ud_4                -6.524422e-02 1 1  ON 14
 ud_5                -1.054317e-01 1 1  ON 15
 ud_6                -1.314732e-01 1 1  ON 16
 ud_7                -1.468939e-01 1 1  ON 17
 ud_8                -1.479110e-01 1 1  ON 18
 ud_9                -1.380456e-01 1 1  ON 19
 eO_0                -7.449899e-01 1 1  ON 20
 eO_1                -4.296115e-01 1 1  ON 21
 eO_2                -1.647515e-02 1 1  ON 22
 eO_3                 2.949338e-01 1 1  ON 23
 eO_4                 5.102539e-01 1 1  ON 24
 eO_5                 4.656651e-01 1 1  ON 25
 eO_6                 2.374789e-01 1 1  ON 26
 eO_7                -5.436217e-02 1 1  ON 27
 eO_8                -2.025491e-01 1 1  ON 28
 eO_9                -6.261029e-02 1 1  ON 29
eH1_0                -2.274247e-01 1 1  ON 30
eH1_1                -1.319003e-01 1 1  ON 31
eH1_2                -8.782688e-02 1 1  ON 32
eH1_3                -3.550184e-02 1 1  ON 33
eH1_4                 1.141010e-02 1 1  ON 34
eH1_5                 4.539896e-02 1 1  ON 35
eH1_6                 9.878926e-02 1 1  ON 36
eH1_7                 1.424483e-01 1 1  ON 37
eH1_8                 1.513624e-01 1 1  ON 38
eH1_9                 3.812122e-02 1 1  ON 39
eH2_0                -2.253723e-01 1 1  ON 40
eH2_1                -1.298114e-01 1 1  ON 41
eH2_2                -8.551607e-02 1 1  ON 42
eH2_3                -3.303231e-02 1 1  ON 43
eH2_4                 1.392047e-02 1 1  ON 44
eH2_5                 4.877989e-02 1 1  ON 45
eH2_6                 1.013102e-01 1 1  ON 46
eH2_7                 1.480707e-01 1 1  ON 47
eH2_8                 1.593669e-01 1 1  ON 48
eH2_9                 2.069206e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.7954
    reference variance = 0.300465
====================================================
  Execution time = 3.7053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4270e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342455270628
                                         uncertainty =       0.004612035746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342455270628
                                         uncertainty =       0.004612035746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413942098
  error estimate for blocks of size 2^( 2) =       0.000427122144
  error estimate for blocks of size 2^( 3) =       0.000440708306
  error estimate for blocks of size 2^( 4) =       0.000453730908
  error estimate for blocks of size 2^( 5) =       0.000464354820
  error estimate for blocks of size 2^( 6) =       0.000473429810
  error estimate for blocks of size 2^( 7) =       0.000478084748

      target function =                  N/A
              le_mean =     -16.904842287894
             les_mean =     286.116388728097
             stat err =       0.000467400072
             autocorr =       1.274965275764
              std dev =       0.585402528920
             le_variance =       0.342696120866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690484228789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904842287894       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904843043948       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904842594501       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904842635679       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904842554725       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904842869390       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904842992837       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904842988487       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.856495e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904842287894       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904842500760       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904842381411       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904842378690       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904842350259       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904842423023       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904842449735       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904842445163       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.259259e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904842287894       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904842342844       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904842312548       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904842310871       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904842303080       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904842320819       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904842327132       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904842325798       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.360102e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.811147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6948e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.061737e-01 1 1  ON 0
 uu_1                 1.404264e-01 1 1  ON 1
 uu_2                 3.993207e-02 1 1  ON 2
 uu_3                -2.084266e-02 1 1  ON 3
 uu_4                -6.383864e-02 1 1  ON 4
 uu_5                -9.629241e-02 1 1  ON 5
 uu_6                -1.214729e-01 1 1  ON 6
 uu_7                -1.325798e-01 1 1  ON 7
 uu_8                -1.246317e-01 1 1  ON 8
 uu_9                -9.530572e-02 1 1  ON 9
 ud_0                 4.377819e-01 1 1  ON 10
 ud_1                 1.742518e-01 1 1  ON 11
 ud_2                 5.853959e-02 1 1  ON 12
 ud_3                -9.266254e-03 1 1  ON 13
 ud_4                -6.525426e-02 1 1  ON 14
 ud_5                -1.054393e-01 1 1  ON 15
 ud_6                -1.314906e-01 1 1  ON 16
 ud_7                -1.469042e-01 1 1  ON 17
 ud_8                -1.479176e-01 1 1  ON 18
 ud_9                -1.380404e-01 1 1  ON 19
 eO_0                -7.450298e-01 1 1  ON 20
 eO_1                -4.296554e-01 1 1  ON 21
 eO_2                -1.648658e-02 1 1  ON 22
 eO_3                 2.949745e-01 1 1  ON 23
 eO_4                 5.102922e-01 1 1  ON 24
 eO_5                 4.657061e-01 1 1  ON 25
 eO_6                 2.374968e-01 1 1  ON 26
 eO_7                -5.435886e-02 1 1  ON 27
 eO_8                -2.025740e-01 1 1  ON 28
 eO_9                -6.262978e-02 1 1  ON 29
eH1_0                -2.274599e-01 1 1  ON 30
eH1_1                -1.319185e-01 1 1  ON 31
eH1_2                -8.784570e-02 1 1  ON 32
eH1_3                -3.552029e-02 1 1  ON 33
eH1_4                 1.142334e-02 1 1  ON 34
eH1_5                 4.538941e-02 1 1  ON 35
eH1_6                 9.880427e-02 1 1  ON 36
eH1_7                 1.424745e-01 1 1  ON 37
eH1_8                 1.513847e-01 1 1  ON 38
eH1_9                 3.814430e-02 1 1  ON 39
eH2_0                -2.253862e-01 1 1  ON 40
eH2_1                -1.298306e-01 1 1  ON 41
eH2_2                -8.554033e-02 1 1  ON 42
eH2_3                -3.305578e-02 1 1  ON 43
eH2_4                 1.393044e-02 1 1  ON 44
eH2_5                 4.876143e-02 1 1  ON 45
eH2_6                 1.013180e-01 1 1  ON 46
eH2_7                 1.480817e-01 1 1  ON 47
eH2_8                 1.593915e-01 1 1  ON 48
eH2_9                 2.073295e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.152787
====================================================
  Execution time = 3.8916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4907e-01
  Total weights = 2.0000e+06
  Execution time = 3.3664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349140857547
                                         uncertainty =       0.006708860941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349140857547
                                         uncertainty =       0.006708860941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417740757
  error estimate for blocks of size 2^( 2) =       0.000430607249
  error estimate for blocks of size 2^( 3) =       0.000443363328
  error estimate for blocks of size 2^( 4) =       0.000457139371
  error estimate for blocks of size 2^( 5) =       0.000468367329
  error estimate for blocks of size 2^( 6) =       0.000478141782
  error estimate for blocks of size 2^( 7) =       0.000483030022

      target function =                  N/A
              le_mean =     -16.904799284069
             les_mean =     286.121253339703
             stat err =       0.000471669626
             autocorr =       1.274858904505
              std dev =       0.590774643632
             le_variance =       0.349014679559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349341543371
                                         uncertainty =       0.006711330995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349341543371
                                         uncertainty =       0.006711330995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417860812
  error estimate for blocks of size 2^( 2) =       0.000430721831
  error estimate for blocks of size 2^( 3) =       0.000443471482
  error estimate for blocks of size 2^( 4) =       0.000457242551
  error estimate for blocks of size 2^( 5) =       0.000468466353
  error estimate for blocks of size 2^( 6) =       0.000478238389
  error estimate for blocks of size 2^( 7) =       0.000483129982

      target function =                  N/A
              le_mean =     -16.904800047606
             les_mean =     286.121479791157
             stat err =       0.000471769318
             autocorr =       1.274665110654
              std dev =       0.590944427355
             le_variance =       0.349215316222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349255954965
                                         uncertainty =       0.006710283792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349255954965
                                         uncertainty =       0.006710283792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417809615
  error estimate for blocks of size 2^( 2) =       0.000430672948
  error estimate for blocks of size 2^( 3) =       0.000443425399
  error estimate for blocks of size 2^( 4) =       0.000457198704
  error estimate for blocks of size 2^( 5) =       0.000468424356
  error estimate for blocks of size 2^( 6) =       0.000478197354
  error estimate for blocks of size 2^( 7) =       0.000483087453

      target function =                  N/A
              le_mean =     -16.904799756935
             les_mean =     286.121384396215
             stat err =       0.000471726967
             autocorr =       1.274748610286
              std dev =       0.590872023975
             le_variance =       0.349129748716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155779989
                                         uncertainty =       0.006709045696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155779989
                                         uncertainty =       0.006709045696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417749685
  error estimate for blocks of size 2^( 2) =       0.000430615766
  error estimate for blocks of size 2^( 3) =       0.000443371376
  error estimate for blocks of size 2^( 4) =       0.000457147067
  error estimate for blocks of size 2^( 5) =       0.000468374727
  error estimate for blocks of size 2^( 6) =       0.000478148988
  error estimate for blocks of size 2^( 7) =       0.000483037467

      target function =                  N/A
              le_mean =     -16.904799344141
             les_mean =     286.121270289489
             stat err =       0.000471677062
             autocorr =       1.274844609611
              std dev =       0.590787269950
             le_variance =       0.349029598335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904799284069        initial
     1.5259e+00     1.5259e+01             1.8565e-04       -16.904800047606  <--
     6.1035e+00     6.1035e+01             5.2593e-05       -16.904799756935
     2.4414e+01     2.4414e+02             1.3601e-05       -16.904799344141

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 5.5891e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.062528e-01 1 1  ON 0
 uu_1                 1.404897e-01 1 1  ON 1
 uu_2                 3.993704e-02 1 1  ON 2
 uu_3                -2.084868e-02 1 1  ON 3
 uu_4                -6.390594e-02 1 1  ON 4
 uu_5                -9.628610e-02 1 1  ON 5
 uu_6                -1.215572e-01 1 1  ON 6
 uu_7                -1.326909e-01 1 1  ON 7
 uu_8                -1.246623e-01 1 1  ON 8
 uu_9                -9.530427e-02 1 1  ON 9
 ud_0                 4.379150e-01 1 1  ON 10
 ud_1                 1.742889e-01 1 1  ON 11
 ud_2                 5.853676e-02 1 1  ON 12
 ud_3                -9.296388e-03 1 1  ON 13
 ud_4                -6.528325e-02 1 1  ON 14
 ud_5                -1.054614e-01 1 1  ON 15
 ud_6                -1.315361e-01 1 1  ON 16
 ud_7                -1.469334e-01 1 1  ON 17
 ud_8                -1.479375e-01 1 1  ON 18
 ud_9                -1.380249e-01 1 1  ON 19
 eO_0                -7.451572e-01 1 1  ON 20
 eO_1                -4.297733e-01 1 1  ON 21
 eO_2                -1.652403e-02 1 1  ON 22
 eO_3                 2.950900e-01 1 1  ON 23
 eO_4                 5.104091e-01 1 1  ON 24
 eO_5                 4.658296e-01 1 1  ON 25
 eO_6                 2.375517e-01 1 1  ON 26
 eO_7                -5.434893e-02 1 1  ON 27
 eO_8                -2.026487e-01 1 1  ON 28
 eO_9                -6.268794e-02 1 1  ON 29
eH1_0                -2.275642e-01 1 1  ON 30
eH1_1                -1.319760e-01 1 1  ON 31
eH1_2                -8.790231e-02 1 1  ON 32
eH1_3                -3.557109e-02 1 1  ON 33
eH1_4                 1.145670e-02 1 1  ON 34
eH1_5                 4.536368e-02 1 1  ON 35
eH1_6                 9.884990e-02 1 1  ON 36
eH1_7                 1.425533e-01 1 1  ON 37
eH1_8                 1.514515e-01 1 1  ON 38
eH1_9                 3.821321e-02 1 1  ON 39
eH2_0                -2.254288e-01 1 1  ON 40
eH2_1                -1.298904e-01 1 1  ON 41
eH2_2                -8.561152e-02 1 1  ON 42
eH2_3                -3.312262e-02 1 1  ON 43
eH2_4                 1.395414e-02 1 1  ON 44
eH2_5                 4.871000e-02 1 1  ON 45
eH2_6                 1.013422e-01 1 1  ON 46
eH2_7                 1.481147e-01 1 1  ON 47
eH2_8                 1.594651e-01 1 1  ON 48
eH2_9                 2.085501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.395413
====================================================
  Execution time = 3.9672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983783201
                                         uncertainty =       0.005487871002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983783201
                                         uncertainty =       0.005487871002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412328773
  error estimate for blocks of size 2^( 2) =       0.000424793862
  error estimate for blocks of size 2^( 3) =       0.000438194702
  error estimate for blocks of size 2^( 4) =       0.000450541665
  error estimate for blocks of size 2^( 5) =       0.000462026922
  error estimate for blocks of size 2^( 6) =       0.000470083474
  error estimate for blocks of size 2^( 7) =       0.000477385579

      target function =                  N/A
              le_mean =     -16.905768163753
             les_mean =     286.145027069848
             stat err =       0.000465009410
             autocorr =       1.271850896375
              std dev =       0.583120942259
             le_variance =       0.340030033302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576816375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768163753       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905767099171       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905769032010       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905770207500       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905771848640       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905770558997       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905770666611       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905770654938       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905770732327       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 1.008726e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768163753       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905767785634       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905768326498       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905768708289       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905769335381       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905769052686       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905768886369       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905768928889       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.821992e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768163753       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905768058112       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905768196017       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905768298393       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905768467093       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905768403514       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905768356382       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905768366579       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 7.337062e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.813986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9652e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.063071e-01 1 1  ON 0
 uu_1                 1.405672e-01 1 1  ON 1
 uu_2                 3.993959e-02 1 1  ON 2
 uu_3                -2.087865e-02 1 1  ON 3
 uu_4                -6.391084e-02 1 1  ON 4
 uu_5                -9.628332e-02 1 1  ON 5
 uu_6                -1.215949e-01 1 1  ON 6
 uu_7                -1.327725e-01 1 1  ON 7
 uu_8                -1.247158e-01 1 1  ON 8
 uu_9                -9.535064e-02 1 1  ON 9
 ud_0                 4.379793e-01 1 1  ON 10
 ud_1                 1.744024e-01 1 1  ON 11
 ud_2                 5.858249e-02 1 1  ON 12
 ud_3                -9.326620e-03 1 1  ON 13
 ud_4                -6.530958e-02 1 1  ON 14
 ud_5                -1.054828e-01 1 1  ON 15
 ud_6                -1.315619e-01 1 1  ON 16
 ud_7                -1.469503e-01 1 1  ON 17
 ud_8                -1.479813e-01 1 1  ON 18
 ud_9                -1.380593e-01 1 1  ON 19
 eO_0                -7.454394e-01 1 1  ON 20
 eO_1                -4.299037e-01 1 1  ON 21
 eO_2                -1.657871e-02 1 1  ON 22
 eO_3                 2.952539e-01 1 1  ON 23
 eO_4                 5.106096e-01 1 1  ON 24
 eO_5                 4.660586e-01 1 1  ON 25
 eO_6                 2.376422e-01 1 1  ON 26
 eO_7                -5.432909e-02 1 1  ON 27
 eO_8                -2.027723e-01 1 1  ON 28
 eO_9                -6.278455e-02 1 1  ON 29
eH1_0                -2.276736e-01 1 1  ON 30
eH1_1                -1.320577e-01 1 1  ON 31
eH1_2                -8.795982e-02 1 1  ON 32
eH1_3                -3.554771e-02 1 1  ON 33
eH1_4                 1.145718e-02 1 1  ON 34
eH1_5                 4.533549e-02 1 1  ON 35
eH1_6                 9.884841e-02 1 1  ON 36
eH1_7                 1.426273e-01 1 1  ON 37
eH1_8                 1.515732e-01 1 1  ON 38
eH1_9                 3.828674e-02 1 1  ON 39
eH2_0                -2.255645e-01 1 1  ON 40
eH2_1                -1.299246e-01 1 1  ON 41
eH2_2                -8.570923e-02 1 1  ON 42
eH2_3                -3.317535e-02 1 1  ON 43
eH2_4                 1.395075e-02 1 1  ON 44
eH2_5                 4.864330e-02 1 1  ON 45
eH2_6                 1.013386e-01 1 1  ON 46
eH2_7                 1.481960e-01 1 1  ON 47
eH2_8                 1.596081e-01 1 1  ON 48
eH2_9                 2.100914e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8777
    reference variance = 0.16686
====================================================
  Execution time = 3.6178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4076e-01
  Total weights = 2.0000e+06
  Execution time = 3.3878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340820546180
                                         uncertainty =       0.003959929926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340820546180
                                         uncertainty =       0.003959929926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412748329
  error estimate for blocks of size 2^( 2) =       0.000425762881
  error estimate for blocks of size 2^( 3) =       0.000438798976
  error estimate for blocks of size 2^( 4) =       0.000451143955
  error estimate for blocks of size 2^( 5) =       0.000462869937
  error estimate for blocks of size 2^( 6) =       0.000469629970
  error estimate for blocks of size 2^( 7) =       0.000475141766

      target function =                  N/A
              le_mean =     -16.905191861864
             les_mean =     286.126234082675
             stat err =       0.000464696407
             autocorr =       1.267558410769
              std dev =       0.583714285080
             le_variance =       0.340722366606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341040190525
                                         uncertainty =       0.003959834875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341040190525
                                         uncertainty =       0.003959834875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412881388
  error estimate for blocks of size 2^( 2) =       0.000425890858
  error estimate for blocks of size 2^( 3) =       0.000438914519
  error estimate for blocks of size 2^( 4) =       0.000451248369
  error estimate for blocks of size 2^( 5) =       0.000462965599
  error estimate for blocks of size 2^( 6) =       0.000469728893
  error estimate for blocks of size 2^( 7) =       0.000475237692

      target function =                  N/A
              le_mean =     -16.905191523932
             les_mean =     286.126442370752
             stat err =       0.000464795138
             autocorr =       1.267279887287
              std dev =       0.583902457949
             le_variance =       0.340942080399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340905659437
                                         uncertainty =       0.003958425481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340905659437
                                         uncertainty =       0.003958425481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412799928
  error estimate for blocks of size 2^( 2) =       0.000425812444
  error estimate for blocks of size 2^( 3) =       0.000438841986
  error estimate for blocks of size 2^( 4) =       0.000451181490
  error estimate for blocks of size 2^( 5) =       0.000462902431
  error estimate for blocks of size 2^( 6) =       0.000469666185
  error estimate for blocks of size 2^( 7) =       0.000475176867

      target function =                  N/A
              le_mean =     -16.905191541968
             les_mean =     286.126308460716
             stat err =       0.000464731743
             autocorr =       1.267434283293
              std dev =       0.583787256189
             le_variance =       0.340807560489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340828593037
                                         uncertainty =       0.003959634932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340828593037
                                         uncertainty =       0.003959634932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412753211
  error estimate for blocks of size 2^( 2) =       0.000425767556
  error estimate for blocks of size 2^( 3) =       0.000438802831
  error estimate for blocks of size 2^( 4) =       0.000451147141
  error estimate for blocks of size 2^( 5) =       0.000462872465
  error estimate for blocks of size 2^( 6) =       0.000469633081
  error estimate for blocks of size 2^( 7) =       0.000475144758

      target function =                  N/A
              le_mean =     -16.905191786580
             les_mean =     286.126239597288
             stat err =       0.000464699361
             autocorr =       1.267544543441
              std dev =       0.583721189097
             le_variance =       0.340730426601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905191861864        initial  <--
     3.8147e-01     3.8147e+00             1.0087e-03       -16.905191523932
     1.5259e+00     1.5259e+01             2.8220e-04       -16.905191541968
     6.1035e+00     6.1035e+01             7.3371e-05       -16.905191786580

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1338
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.062528e-01 1 1  ON 0
 uu_1                 1.404897e-01 1 1  ON 1
 uu_2                 3.993704e-02 1 1  ON 2
 uu_3                -2.084868e-02 1 1  ON 3
 uu_4                -6.390594e-02 1 1  ON 4
 uu_5                -9.628610e-02 1 1  ON 5
 uu_6                -1.215572e-01 1 1  ON 6
 uu_7                -1.326909e-01 1 1  ON 7
 uu_8                -1.246623e-01 1 1  ON 8
 uu_9                -9.530427e-02 1 1  ON 9
 ud_0                 4.379150e-01 1 1  ON 10
 ud_1                 1.742889e-01 1 1  ON 11
 ud_2                 5.853676e-02 1 1  ON 12
 ud_3                -9.296388e-03 1 1  ON 13
 ud_4                -6.528325e-02 1 1  ON 14
 ud_5                -1.054614e-01 1 1  ON 15
 ud_6                -1.315361e-01 1 1  ON 16
 ud_7                -1.469334e-01 1 1  ON 17
 ud_8                -1.479375e-01 1 1  ON 18
 ud_9                -1.380249e-01 1 1  ON 19
 eO_0                -7.451572e-01 1 1  ON 20
 eO_1                -4.297733e-01 1 1  ON 21
 eO_2                -1.652403e-02 1 1  ON 22
 eO_3                 2.950900e-01 1 1  ON 23
 eO_4                 5.104091e-01 1 1  ON 24
 eO_5                 4.658296e-01 1 1  ON 25
 eO_6                 2.375517e-01 1 1  ON 26
 eO_7                -5.434893e-02 1 1  ON 27
 eO_8                -2.026487e-01 1 1  ON 28
 eO_9                -6.268794e-02 1 1  ON 29
eH1_0                -2.275642e-01 1 1  ON 30
eH1_1                -1.319760e-01 1 1  ON 31
eH1_2                -8.790231e-02 1 1  ON 32
eH1_3                -3.557109e-02 1 1  ON 33
eH1_4                 1.145670e-02 1 1  ON 34
eH1_5                 4.536368e-02 1 1  ON 35
eH1_6                 9.884990e-02 1 1  ON 36
eH1_7                 1.425533e-01 1 1  ON 37
eH1_8                 1.514515e-01 1 1  ON 38
eH1_9                 3.821321e-02 1 1  ON 39
eH2_0                -2.254288e-01 1 1  ON 40
eH2_1                -1.298904e-01 1 1  ON 41
eH2_2                -8.561152e-02 1 1  ON 42
eH2_3                -3.312262e-02 1 1  ON 43
eH2_4                 1.395414e-02 1 1  ON 44
eH2_5                 4.871000e-02 1 1  ON 45
eH2_6                 1.013422e-01 1 1  ON 46
eH2_7                 1.481147e-01 1 1  ON 47
eH2_8                 1.594651e-01 1 1  ON 48
eH2_9                 2.085501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0279e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.336361
====================================================
  Execution time = 3.6972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3516e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335163991607
                                         uncertainty =       0.003614047071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335163991607
                                         uncertainty =       0.003614047071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409365996
  error estimate for blocks of size 2^( 2) =       0.000421772025
  error estimate for blocks of size 2^( 3) =       0.000434571168
  error estimate for blocks of size 2^( 4) =       0.000446504925
  error estimate for blocks of size 2^( 5) =       0.000457473771
  error estimate for blocks of size 2^( 6) =       0.000466976809
  error estimate for blocks of size 2^( 7) =       0.000471962608

      target function =                  N/A
              le_mean =     -16.905778525027
             les_mean =     286.140508406641
             stat err =       0.000460729528
             autocorr =       1.266684816374
              std dev =       0.578930943177
             le_variance =       0.335161036968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577852503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778525027       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778404047       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778227106       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777929554       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778227582       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778326144       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778379601       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778418935       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.201326e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778525027       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778493837       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778443084       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778363890       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778435915       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778459558       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778474120       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778483826       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.061731e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778525027       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778517168       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778504030       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778483905       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778501718       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778507539       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778511249       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778513664       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.693157e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.816643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6799e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.062552e-01 1 1  ON 0
 uu_1                 1.404959e-01 1 1  ON 1
 uu_2                 3.993097e-02 1 1  ON 2
 uu_3                -2.084799e-02 1 1  ON 3
 uu_4                -6.390897e-02 1 1  ON 4
 uu_5                -9.628337e-02 1 1  ON 5
 uu_6                -1.215644e-01 1 1  ON 6
 uu_7                -1.326916e-01 1 1  ON 7
 uu_8                -1.246600e-01 1 1  ON 8
 uu_9                -9.531026e-02 1 1  ON 9
 ud_0                 4.379278e-01 1 1  ON 10
 ud_1                 1.743100e-01 1 1  ON 11
 ud_2                 5.853701e-02 1 1  ON 12
 ud_3                -9.296262e-03 1 1  ON 13
 ud_4                -6.528752e-02 1 1  ON 14
 ud_5                -1.054657e-01 1 1  ON 15
 ud_6                -1.315427e-01 1 1  ON 16
 ud_7                -1.469405e-01 1 1  ON 17
 ud_8                -1.479462e-01 1 1  ON 18
 ud_9                -1.380322e-01 1 1  ON 19
 eO_0                -7.451879e-01 1 1  ON 20
 eO_1                -4.297862e-01 1 1  ON 21
 eO_2                -1.651911e-02 1 1  ON 22
 eO_3                 2.951058e-01 1 1  ON 23
 eO_4                 5.104251e-01 1 1  ON 24
 eO_5                 4.658432e-01 1 1  ON 25
 eO_6                 2.375620e-01 1 1  ON 26
 eO_7                -5.434241e-02 1 1  ON 27
 eO_8                -2.026607e-01 1 1  ON 28
 eO_9                -6.269799e-02 1 1  ON 29
eH1_0                -2.275798e-01 1 1  ON 30
eH1_1                -1.319811e-01 1 1  ON 31
eH1_2                -8.790499e-02 1 1  ON 32
eH1_3                -3.556693e-02 1 1  ON 33
eH1_4                 1.145581e-02 1 1  ON 34
eH1_5                 4.536269e-02 1 1  ON 35
eH1_6                 9.884558e-02 1 1  ON 36
eH1_7                 1.425582e-01 1 1  ON 37
eH1_8                 1.514624e-01 1 1  ON 38
eH1_9                 3.822408e-02 1 1  ON 39
eH2_0                -2.254426e-01 1 1  ON 40
eH2_1                -1.298977e-01 1 1  ON 41
eH2_2                -8.561555e-02 1 1  ON 42
eH2_3                -3.312629e-02 1 1  ON 43
eH2_4                 1.395501e-02 1 1  ON 44
eH2_5                 4.870558e-02 1 1  ON 45
eH2_6                 1.013531e-01 1 1  ON 46
eH2_7                 1.481185e-01 1 1  ON 47
eH2_8                 1.594703e-01 1 1  ON 48
eH2_9                 2.086755e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9091
    reference variance = 0.187381
====================================================
  Execution time = 3.5985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3226e-01
  Total weights = 2.0000e+06
  Execution time = 3.3745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331994717835
                                         uncertainty =       0.003094628578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331994717835
                                         uncertainty =       0.003094628578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407585344
  error estimate for blocks of size 2^( 2) =       0.000420678178
  error estimate for blocks of size 2^( 3) =       0.000434435566
  error estimate for blocks of size 2^( 4) =       0.000447285066
  error estimate for blocks of size 2^( 5) =       0.000459209983
  error estimate for blocks of size 2^( 6) =       0.000468491156
  error estimate for blocks of size 2^( 7) =       0.000474768320

      target function =                  N/A
              le_mean =     -16.904653190447
             les_mean =     286.099550949194
             stat err =       0.000462438631
             autocorr =       1.287274287404
              std dev =       0.576412721951
             le_variance =       0.332251626027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332029887360
                                         uncertainty =       0.003095271276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332029887360
                                         uncertainty =       0.003095271276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407606920
  error estimate for blocks of size 2^( 2) =       0.000420698460
  error estimate for blocks of size 2^( 3) =       0.000434453716
  error estimate for blocks of size 2^( 4) =       0.000447301564
  error estimate for blocks of size 2^( 5) =       0.000459225596
  error estimate for blocks of size 2^( 6) =       0.000468507039
  error estimate for blocks of size 2^( 7) =       0.000474784242

      target function =                  N/A
              le_mean =     -16.904653487663
             les_mean =     286.099596173908
             stat err =       0.000462454610
             autocorr =       1.287226968112
              std dev =       0.576443234051
             le_variance =       0.332286802083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332012020172
                                         uncertainty =       0.003094959936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332012020172
                                         uncertainty =       0.003094959936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407595959
  error estimate for blocks of size 2^( 2) =       0.000420688144
  error estimate for blocks of size 2^( 3) =       0.000434444420
  error estimate for blocks of size 2^( 4) =       0.000447293074
  error estimate for blocks of size 2^( 5) =       0.000459217556
  error estimate for blocks of size 2^( 6) =       0.000468498893
  error estimate for blocks of size 2^( 7) =       0.000474776126

      target function =                  N/A
              le_mean =     -16.904653361141
             les_mean =     286.099574026305
             stat err =       0.000462446412
             autocorr =       1.287250557423
              std dev =       0.576427733639
             le_variance =       0.332268932108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331996866542
                                         uncertainty =       0.003094670340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331996866542
                                         uncertainty =       0.003094670340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407586663
  error estimate for blocks of size 2^( 2) =       0.000420679415
  error estimate for blocks of size 2^( 3) =       0.000434436663
  error estimate for blocks of size 2^( 4) =       0.000447286056
  error estimate for blocks of size 2^( 5) =       0.000459210918
  error estimate for blocks of size 2^( 6) =       0.000468492114
  error estimate for blocks of size 2^( 7) =       0.000474769288

      target function =                  N/A
              le_mean =     -16.904653212271
             les_mean =     286.099553836240
             stat err =       0.000462439594
             autocorr =       1.287271320594
              std dev =       0.576414586231
             le_variance =       0.332253775220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904653190447        initial
     3.8147e+00     3.8147e+01             1.2013e-04       -16.904653487663  <--
     1.5259e+01     1.5259e+02             3.0617e-05       -16.904653361141
     6.1035e+01     6.1035e+02             7.6932e-06       -16.904653212271

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 5.2959e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.062626e-01 1 1  ON 0
 uu_1                 1.405130e-01 1 1  ON 1
 uu_2                 3.991507e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391744e-02 1 1  ON 4
 uu_5                -9.627620e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326937e-01 1 1  ON 7
 uu_8                -1.246533e-01 1 1  ON 8
 uu_9                -9.532819e-02 1 1  ON 9
 ud_0                 4.379682e-01 1 1  ON 10
 ud_1                 1.743683e-01 1 1  ON 11
 ud_2                 5.854062e-02 1 1  ON 12
 ud_3                -9.296871e-03 1 1  ON 13
 ud_4                -6.529979e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469616e-01 1 1  ON 17
 ud_8                -1.479722e-01 1 1  ON 18
 ud_9                -1.380540e-01 1 1  ON 19
 eO_0                -7.452774e-01 1 1  ON 20
 eO_1                -4.298245e-01 1 1  ON 21
 eO_2                -1.650630e-02 1 1  ON 22
 eO_3                 2.951526e-01 1 1  ON 23
 eO_4                 5.104729e-01 1 1  ON 24
 eO_5                 4.658840e-01 1 1  ON 25
 eO_6                 2.375929e-01 1 1  ON 26
 eO_7                -5.432300e-02 1 1  ON 27
 eO_8                -2.026967e-01 1 1  ON 28
 eO_9                -6.272799e-02 1 1  ON 29
eH1_0                -2.276260e-01 1 1  ON 30
eH1_1                -1.319962e-01 1 1  ON 31
eH1_2                -8.791255e-02 1 1  ON 32
eH1_3                -3.555527e-02 1 1  ON 33
eH1_4                 1.145346e-02 1 1  ON 34
eH1_5                 4.535966e-02 1 1  ON 35
eH1_6                 9.883261e-02 1 1  ON 36
eH1_7                 1.425728e-01 1 1  ON 37
eH1_8                 1.514949e-01 1 1  ON 38
eH1_9                 3.825651e-02 1 1  ON 39
eH2_0                -2.254836e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562752e-02 1 1  ON 42
eH2_3                -3.313729e-02 1 1  ON 43
eH2_4                 1.395725e-02 1 1  ON 44
eH2_5                 4.869268e-02 1 1  ON 45
eH2_6                 1.013857e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594858e-01 1 1  ON 48
eH2_9                 2.090492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9678
    reference variance = 0.621413
====================================================
  Execution time = 3.6866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339313202780
                                         uncertainty =       0.003759744768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339313202780
                                         uncertainty =       0.003759744768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411899481
  error estimate for blocks of size 2^( 2) =       0.000425026911
  error estimate for blocks of size 2^( 3) =       0.000438450755
  error estimate for blocks of size 2^( 4) =       0.000450388028
  error estimate for blocks of size 2^( 5) =       0.000459728932
  error estimate for blocks of size 2^( 6) =       0.000466482941
  error estimate for blocks of size 2^( 7) =       0.000471572515

      target function =                  N/A
              le_mean =     -16.905181270544
             les_mean =     286.124475985542
             stat err =       0.000462043104
             autocorr =       1.258295072654
              std dev =       0.582513832670
             le_variance =       0.339322365252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690518127054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905181270544       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905181415647       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905181640888       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905181523937       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905181851547       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905181973301       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905182018235       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905182005881       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905182015415       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.981346e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905181270544       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905181311048       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905181377690       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905181345189       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905181445178       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905181471784       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905181486724       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905181476718       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.036948e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905181270544       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905181280974       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905181298512       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905181290198       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905181316563       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905181323154       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905181327405       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905181324633       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.625220e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.819490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6729e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.062785e-01 1 1  ON 0
 uu_1                 1.405236e-01 1 1  ON 1
 uu_2                 3.994358e-02 1 1  ON 2
 uu_3                -2.086012e-02 1 1  ON 3
 uu_4                -6.394286e-02 1 1  ON 4
 uu_5                -9.629250e-02 1 1  ON 5
 uu_6                -1.215634e-01 1 1  ON 6
 uu_7                -1.327550e-01 1 1  ON 7
 uu_8                -1.246705e-01 1 1  ON 8
 uu_9                -9.533986e-02 1 1  ON 9
 ud_0                 4.379853e-01 1 1  ON 10
 ud_1                 1.744392e-01 1 1  ON 11
 ud_2                 5.854054e-02 1 1  ON 12
 ud_3                -9.278856e-03 1 1  ON 13
 ud_4                -6.532743e-02 1 1  ON 14
 ud_5                -1.054900e-01 1 1  ON 15
 ud_6                -1.315881e-01 1 1  ON 16
 ud_7                -1.469606e-01 1 1  ON 17
 ud_8                -1.479804e-01 1 1  ON 18
 ud_9                -1.380741e-01 1 1  ON 19
 eO_0                -7.453811e-01 1 1  ON 20
 eO_1                -4.298899e-01 1 1  ON 21
 eO_2                -1.651787e-02 1 1  ON 22
 eO_3                 2.952147e-01 1 1  ON 23
 eO_4                 5.105684e-01 1 1  ON 24
 eO_5                 4.659514e-01 1 1  ON 25
 eO_6                 2.376262e-01 1 1  ON 26
 eO_7                -5.431208e-02 1 1  ON 27
 eO_8                -2.027410e-01 1 1  ON 28
 eO_9                -6.276563e-02 1 1  ON 29
eH1_0                -2.277027e-01 1 1  ON 30
eH1_1                -1.320372e-01 1 1  ON 31
eH1_2                -8.794127e-02 1 1  ON 32
eH1_3                -3.555924e-02 1 1  ON 33
eH1_4                 1.144901e-02 1 1  ON 34
eH1_5                 4.535612e-02 1 1  ON 35
eH1_6                 9.885966e-02 1 1  ON 36
eH1_7                 1.425952e-01 1 1  ON 37
eH1_8                 1.515607e-01 1 1  ON 38
eH1_9                 3.830459e-02 1 1  ON 39
eH2_0                -2.255448e-01 1 1  ON 40
eH2_1                -1.299339e-01 1 1  ON 41
eH2_2                -8.565502e-02 1 1  ON 42
eH2_3                -3.315863e-02 1 1  ON 43
eH2_4                 1.397158e-02 1 1  ON 44
eH2_5                 4.868065e-02 1 1  ON 45
eH2_6                 1.013998e-01 1 1  ON 46
eH2_7                 1.481440e-01 1 1  ON 47
eH2_8                 1.595237e-01 1 1  ON 48
eH2_9                 2.095707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.385547
====================================================
  Execution time = 3.8480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3938e-01
  Total weights = 2.0000e+06
  Execution time = 3.3657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414273590
                                         uncertainty =       0.005062415115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414273590
                                         uncertainty =       0.005062415115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411938695
  error estimate for blocks of size 2^( 2) =       0.000424593442
  error estimate for blocks of size 2^( 3) =       0.000438471258
  error estimate for blocks of size 2^( 4) =       0.000451566830
  error estimate for blocks of size 2^( 5) =       0.000462844719
  error estimate for blocks of size 2^( 6) =       0.000472779195
  error estimate for blocks of size 2^( 7) =       0.000480212206

      target function =                  N/A
              le_mean =     -16.905258303938
             les_mean =     286.127145129536
             stat err =       0.000466850737
             autocorr =       1.284372272883
              std dev =       0.582569288886
             le_variance =       0.339386976353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339441264493
                                         uncertainty =       0.005063142729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339441264493
                                         uncertainty =       0.005063142729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411955004
  error estimate for blocks of size 2^( 2) =       0.000424607676
  error estimate for blocks of size 2^( 3) =       0.000438481687
  error estimate for blocks of size 2^( 4) =       0.000451573254
  error estimate for blocks of size 2^( 5) =       0.000462847138
  error estimate for blocks of size 2^( 6) =       0.000472781065
  error estimate for blocks of size 2^( 7) =       0.000480211425

      target function =                  N/A
              le_mean =     -16.905257390277
             les_mean =     286.127141112796
             stat err =       0.000466853220
             autocorr =       1.284284237621
              std dev =       0.582592354045
             le_variance =       0.339413850991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339406127824
                                         uncertainty =       0.005062432169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339406127824
                                         uncertainty =       0.005062432169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411933707
  error estimate for blocks of size 2^( 2) =       0.000424587765
  error estimate for blocks of size 2^( 3) =       0.000438463977
  error estimate for blocks of size 2^( 4) =       0.000451557751
  error estimate for blocks of size 2^( 5) =       0.000462833819
  error estimate for blocks of size 2^( 6) =       0.000472768432
  error estimate for blocks of size 2^( 7) =       0.000480199848

      target function =                  N/A
              le_mean =     -16.905257517494
             les_mean =     286.127110321743
             stat err =       0.000466839963
             autocorr =       1.284344085018
              std dev =       0.582562235866
             le_variance =       0.339378758657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339412253276
                                         uncertainty =       0.005062403522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339412253276
                                         uncertainty =       0.005062403522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411937463
  error estimate for blocks of size 2^( 2) =       0.000424592137
  error estimate for blocks of size 2^( 3) =       0.000438469762
  error estimate for blocks of size 2^( 4) =       0.000451565113
  error estimate for blocks of size 2^( 5) =       0.000462842782
  error estimate for blocks of size 2^( 6) =       0.000472777298
  error estimate for blocks of size 2^( 7) =       0.000480210090

      target function =                  N/A
              le_mean =     -16.905258186515
             les_mean =     286.127139129369
             stat err =       0.000466848821
             autocorr =       1.284369408916
              std dev =       0.582567546569
             le_variance =       0.339384946316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905258303938        initial  <--
     9.5367e-01     9.5367e+00             3.9813e-04       -16.905257390277
     3.8147e+00     3.8147e+01             1.0369e-04       -16.905257517494
     1.5259e+01     1.5259e+02             2.6252e-05       -16.905258186515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.4393
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.062626e-01 1 1  ON 0
 uu_1                 1.405130e-01 1 1  ON 1
 uu_2                 3.991507e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391744e-02 1 1  ON 4
 uu_5                -9.627620e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326937e-01 1 1  ON 7
 uu_8                -1.246533e-01 1 1  ON 8
 uu_9                -9.532819e-02 1 1  ON 9
 ud_0                 4.379682e-01 1 1  ON 10
 ud_1                 1.743683e-01 1 1  ON 11
 ud_2                 5.854062e-02 1 1  ON 12
 ud_3                -9.296871e-03 1 1  ON 13
 ud_4                -6.529979e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469616e-01 1 1  ON 17
 ud_8                -1.479722e-01 1 1  ON 18
 ud_9                -1.380540e-01 1 1  ON 19
 eO_0                -7.452774e-01 1 1  ON 20
 eO_1                -4.298245e-01 1 1  ON 21
 eO_2                -1.650630e-02 1 1  ON 22
 eO_3                 2.951526e-01 1 1  ON 23
 eO_4                 5.104729e-01 1 1  ON 24
 eO_5                 4.658840e-01 1 1  ON 25
 eO_6                 2.375929e-01 1 1  ON 26
 eO_7                -5.432300e-02 1 1  ON 27
 eO_8                -2.026967e-01 1 1  ON 28
 eO_9                -6.272799e-02 1 1  ON 29
eH1_0                -2.276260e-01 1 1  ON 30
eH1_1                -1.319962e-01 1 1  ON 31
eH1_2                -8.791255e-02 1 1  ON 32
eH1_3                -3.555527e-02 1 1  ON 33
eH1_4                 1.145346e-02 1 1  ON 34
eH1_5                 4.535966e-02 1 1  ON 35
eH1_6                 9.883261e-02 1 1  ON 36
eH1_7                 1.425728e-01 1 1  ON 37
eH1_8                 1.514949e-01 1 1  ON 38
eH1_9                 3.825651e-02 1 1  ON 39
eH2_0                -2.254836e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562752e-02 1 1  ON 42
eH2_3                -3.313729e-02 1 1  ON 43
eH2_4                 1.395725e-02 1 1  ON 44
eH2_5                 4.869268e-02 1 1  ON 45
eH2_6                 1.013857e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594858e-01 1 1  ON 48
eH2_9                 2.090492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0217e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.146464
====================================================
  Execution time = 3.9413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3356e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333672629792
                                         uncertainty =       0.003246844724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333672629792
                                         uncertainty =       0.003246844724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408387116
  error estimate for blocks of size 2^( 2) =       0.000420999799
  error estimate for blocks of size 2^( 3) =       0.000434239719
  error estimate for blocks of size 2^( 4) =       0.000446039004
  error estimate for blocks of size 2^( 5) =       0.000455983377
  error estimate for blocks of size 2^( 6) =       0.000464508171
  error estimate for blocks of size 2^( 7) =       0.000470014600

      target function =                  N/A
              le_mean =     -16.904755137654
             les_mean =     286.104306170843
             stat err =       0.000459136288
             autocorr =       1.263977001241
              std dev =       0.577546598640
             le_variance =       0.333560073600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475513765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904755137654       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904755251341       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904755202747       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904755190478       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904755089955       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904755111828       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904755108764       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904755125751       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.633151e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904755137654       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904755166331       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904755153989       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904755150986       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904755125220       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904755130766       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904755129986       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904755133942       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 9.147494e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904755137654       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904755144839       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904755141741       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904755140995       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904755134513       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904755135903       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904755135707       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904755136678       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.290937e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.822159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9380e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.062681e-01 1 1  ON 0
 uu_1                 1.405141e-01 1 1  ON 1
 uu_2                 3.991393e-02 1 1  ON 2
 uu_3                -2.084781e-02 1 1  ON 3
 uu_4                -6.391966e-02 1 1  ON 4
 uu_5                -9.627587e-02 1 1  ON 5
 uu_6                -1.215830e-01 1 1  ON 6
 uu_7                -1.326962e-01 1 1  ON 7
 uu_8                -1.246577e-01 1 1  ON 8
 uu_9                -9.533049e-02 1 1  ON 9
 ud_0                 4.379735e-01 1 1  ON 10
 ud_1                 1.743723e-01 1 1  ON 11
 ud_2                 5.854378e-02 1 1  ON 12
 ud_3                -9.296483e-03 1 1  ON 13
 ud_4                -6.530109e-02 1 1  ON 14
 ud_5                -1.054814e-01 1 1  ON 15
 ud_6                -1.315668e-01 1 1  ON 16
 ud_7                -1.469648e-01 1 1  ON 17
 ud_8                -1.479746e-01 1 1  ON 18
 ud_9                -1.380539e-01 1 1  ON 19
 eO_0                -7.452843e-01 1 1  ON 20
 eO_1                -4.298320e-01 1 1  ON 21
 eO_2                -1.651057e-02 1 1  ON 22
 eO_3                 2.951617e-01 1 1  ON 23
 eO_4                 5.104793e-01 1 1  ON 24
 eO_5                 4.658893e-01 1 1  ON 25
 eO_6                 2.375978e-01 1 1  ON 26
 eO_7                -5.432253e-02 1 1  ON 27
 eO_8                -2.027009e-01 1 1  ON 28
 eO_9                -6.273111e-02 1 1  ON 29
eH1_0                -2.276341e-01 1 1  ON 30
eH1_1                -1.319980e-01 1 1  ON 31
eH1_2                -8.791385e-02 1 1  ON 32
eH1_3                -3.555563e-02 1 1  ON 33
eH1_4                 1.145269e-02 1 1  ON 34
eH1_5                 4.535689e-02 1 1  ON 35
eH1_6                 9.883459e-02 1 1  ON 36
eH1_7                 1.425761e-01 1 1  ON 37
eH1_8                 1.514998e-01 1 1  ON 38
eH1_9                 3.826073e-02 1 1  ON 39
eH2_0                -2.254887e-01 1 1  ON 40
eH2_1                -1.299170e-01 1 1  ON 41
eH2_2                -8.563043e-02 1 1  ON 42
eH2_3                -3.313772e-02 1 1  ON 43
eH2_4                 1.395650e-02 1 1  ON 44
eH2_5                 4.868952e-02 1 1  ON 45
eH2_6                 1.013849e-01 1 1  ON 46
eH2_7                 1.481304e-01 1 1  ON 47
eH2_8                 1.594899e-01 1 1  ON 48
eH2_9                 2.091077e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.378927
====================================================
  Execution time = 3.6088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3537e-01
  Total weights = 2.0000e+06
  Execution time = 3.3769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335457004651
                                         uncertainty =       0.003852227193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335457004651
                                         uncertainty =       0.003852227193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409489408
  error estimate for blocks of size 2^( 2) =       0.000422369169
  error estimate for blocks of size 2^( 3) =       0.000435395694
  error estimate for blocks of size 2^( 4) =       0.000448069919
  error estimate for blocks of size 2^( 5) =       0.000459312247
  error estimate for blocks of size 2^( 6) =       0.000466813466
  error estimate for blocks of size 2^( 7) =       0.000471453522

      target function =                  N/A
              le_mean =     -16.905150272954
             les_mean =     286.119468733707
             stat err =       0.000461412289
             autocorr =       1.269676170093
              std dev =       0.579105474194
             le_variance =       0.335363150241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470693711
                                         uncertainty =       0.003852385102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470693711
                                         uncertainty =       0.003852385102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409497761
  error estimate for blocks of size 2^( 2) =       0.000422377245
  error estimate for blocks of size 2^( 3) =       0.000435403281
  error estimate for blocks of size 2^( 4) =       0.000448076952
  error estimate for blocks of size 2^( 5) =       0.000459318653
  error estimate for blocks of size 2^( 6) =       0.000466819765
  error estimate for blocks of size 2^( 7) =       0.000471459737

      target function =                  N/A
              le_mean =     -16.905150099205
             les_mean =     286.119476541872
             stat err =       0.000461418777
             autocorr =       1.269660075031
              std dev =       0.579117287697
             le_variance =       0.335376832910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335463933788
                                         uncertainty =       0.003852307548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335463933788
                                         uncertainty =       0.003852307548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409493636
  error estimate for blocks of size 2^( 2) =       0.000422373257
  error estimate for blocks of size 2^( 3) =       0.000435399535
  error estimate for blocks of size 2^( 4) =       0.000448073479
  error estimate for blocks of size 2^( 5) =       0.000459315489
  error estimate for blocks of size 2^( 6) =       0.000466816654
  error estimate for blocks of size 2^( 7) =       0.000471456660

      target function =                  N/A
              le_mean =     -16.905150183571
             les_mean =     286.119472637561
             stat err =       0.000461415570
             autocorr =       1.269668009013
              std dev =       0.579111454003
             le_variance =       0.335370076158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335457873331
                                         uncertainty =       0.003852237283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335457873331
                                         uncertainty =       0.003852237283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409489938
  error estimate for blocks of size 2^( 2) =       0.000422369682
  error estimate for blocks of size 2^( 3) =       0.000435396176
  error estimate for blocks of size 2^( 4) =       0.000448070366
  error estimate for blocks of size 2^( 5) =       0.000459312653
  error estimate for blocks of size 2^( 6) =       0.000466813865
  error estimate for blocks of size 2^( 7) =       0.000471453915

      target function =                  N/A
              le_mean =     -16.905150261662
             les_mean =     286.119469220190
             stat err =       0.000461412700
             autocorr =       1.269675146117
              std dev =       0.579106223864
             le_variance =       0.335364018518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905150272954        initial  <--
     9.5367e+00     9.5367e+01             3.6332e-05       -16.905150099205
     3.8147e+01     3.8147e+02             9.1475e-06       -16.905150183571
     1.5259e+02     1.5259e+03             2.2909e-06       -16.905150261662

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0802
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.062626e-01 1 1  ON 0
 uu_1                 1.405130e-01 1 1  ON 1
 uu_2                 3.991507e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391744e-02 1 1  ON 4
 uu_5                -9.627620e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326937e-01 1 1  ON 7
 uu_8                -1.246533e-01 1 1  ON 8
 uu_9                -9.532819e-02 1 1  ON 9
 ud_0                 4.379682e-01 1 1  ON 10
 ud_1                 1.743683e-01 1 1  ON 11
 ud_2                 5.854062e-02 1 1  ON 12
 ud_3                -9.296871e-03 1 1  ON 13
 ud_4                -6.529979e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469616e-01 1 1  ON 17
 ud_8                -1.479722e-01 1 1  ON 18
 ud_9                -1.380540e-01 1 1  ON 19
 eO_0                -7.452774e-01 1 1  ON 20
 eO_1                -4.298245e-01 1 1  ON 21
 eO_2                -1.650630e-02 1 1  ON 22
 eO_3                 2.951526e-01 1 1  ON 23
 eO_4                 5.104729e-01 1 1  ON 24
 eO_5                 4.658840e-01 1 1  ON 25
 eO_6                 2.375929e-01 1 1  ON 26
 eO_7                -5.432300e-02 1 1  ON 27
 eO_8                -2.026967e-01 1 1  ON 28
 eO_9                -6.272799e-02 1 1  ON 29
eH1_0                -2.276260e-01 1 1  ON 30
eH1_1                -1.319962e-01 1 1  ON 31
eH1_2                -8.791255e-02 1 1  ON 32
eH1_3                -3.555527e-02 1 1  ON 33
eH1_4                 1.145346e-02 1 1  ON 34
eH1_5                 4.535966e-02 1 1  ON 35
eH1_6                 9.883261e-02 1 1  ON 36
eH1_7                 1.425728e-01 1 1  ON 37
eH1_8                 1.514949e-01 1 1  ON 38
eH1_9                 3.825651e-02 1 1  ON 39
eH2_0                -2.254836e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562752e-02 1 1  ON 42
eH2_3                -3.313729e-02 1 1  ON 43
eH2_4                 1.395725e-02 1 1  ON 44
eH2_5                 4.869268e-02 1 1  ON 45
eH2_6                 1.013857e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594858e-01 1 1  ON 48
eH2_9                 2.090492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.216548
====================================================
  Execution time = 3.7056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3446e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334327583423
                                         uncertainty =       0.003331239244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334327583423
                                         uncertainty =       0.003331239244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408937770
  error estimate for blocks of size 2^( 2) =       0.000421711910
  error estimate for blocks of size 2^( 3) =       0.000434810955
  error estimate for blocks of size 2^( 4) =       0.000447043137
  error estimate for blocks of size 2^( 5) =       0.000458198673
  error estimate for blocks of size 2^( 6) =       0.000466352460
  error estimate for blocks of size 2^( 7) =       0.000471898306

      target function =                  N/A
              le_mean =     -16.906113452746
             les_mean =     286.151132109354
             stat err =       0.000460873144
             autocorr =       1.270130526781
              std dev =       0.578325340506
             le_variance =       0.334460199471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611345275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906113452746       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906113459206       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906113460329       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906113465907       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906113466572       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906113465969       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906113469363       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906113468499       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.983846e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906113452746       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906113454363       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906113454644       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906113456038       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906113456204       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906113456053       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906113456901       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906113456687       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.965850e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906113452746       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906113453150       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906113453220       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906113453569       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906113453610       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906113453572       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906113453785       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906113453733       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.491853e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.824817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7035e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.062631e-01 1 1  ON 0
 uu_1                 1.405134e-01 1 1  ON 1
 uu_2                 3.991505e-02 1 1  ON 2
 uu_3                -2.084699e-02 1 1  ON 3
 uu_4                -6.391772e-02 1 1  ON 4
 uu_5                -9.627586e-02 1 1  ON 5
 uu_6                -1.215852e-01 1 1  ON 6
 uu_7                -1.326939e-01 1 1  ON 7
 uu_8                -1.246537e-01 1 1  ON 8
 uu_9                -9.532871e-02 1 1  ON 9
 ud_0                 4.379689e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854076e-02 1 1  ON 12
 ud_3                -9.296777e-03 1 1  ON 13
 ud_4                -6.529984e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315626e-01 1 1  ON 16
 ud_7                -1.469615e-01 1 1  ON 17
 ud_8                -1.479727e-01 1 1  ON 18
 ud_9                -1.380544e-01 1 1  ON 19
 eO_0                -7.452784e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650630e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104736e-01 1 1  ON 24
 eO_5                 4.658846e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432266e-02 1 1  ON 27
 eO_8                -2.026973e-01 1 1  ON 28
 eO_9                -6.272847e-02 1 1  ON 29
eH1_0                -2.276266e-01 1 1  ON 30
eH1_1                -1.319967e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555518e-02 1 1  ON 33
eH1_4                 1.145349e-02 1 1  ON 34
eH1_5                 4.535972e-02 1 1  ON 35
eH1_6                 9.883266e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514953e-01 1 1  ON 38
eH1_9                 3.825688e-02 1 1  ON 39
eH2_0                -2.254842e-01 1 1  ON 40
eH2_1                -1.299195e-01 1 1  ON 41
eH2_2                -8.562754e-02 1 1  ON 42
eH2_3                -3.313727e-02 1 1  ON 43
eH2_4                 1.395724e-02 1 1  ON 44
eH2_5                 4.869244e-02 1 1  ON 45
eH2_6                 1.013856e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594862e-01 1 1  ON 48
eH2_9                 2.090541e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9656
    reference variance = 0.242742
====================================================
  Execution time = 3.6272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3316e-01
  Total weights = 2.0000e+06
  Execution time = 3.3633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329831893278
                                         uncertainty =       0.002524831091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329831893278
                                         uncertainty =       0.002524831091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408142308
  error estimate for blocks of size 2^( 2) =       0.000421017951
  error estimate for blocks of size 2^( 3) =       0.000434660968
  error estimate for blocks of size 2^( 4) =       0.000447033284
  error estimate for blocks of size 2^( 5) =       0.000458584502
  error estimate for blocks of size 2^( 6) =       0.000466039226
  error estimate for blocks of size 2^( 7) =       0.000471451824

      target function =                  N/A
              le_mean =     -16.905020186021
             les_mean =     286.112867610515
             stat err =       0.000460777209
             autocorr =       1.274555487895
              std dev =       0.577200387478
             le_variance =       0.333160287304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329834118770
                                         uncertainty =       0.002524847414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329834118770
                                         uncertainty =       0.002524847414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408143685
  error estimate for blocks of size 2^( 2) =       0.000421019252
  error estimate for blocks of size 2^( 3) =       0.000434662173
  error estimate for blocks of size 2^( 4) =       0.000447034421
  error estimate for blocks of size 2^( 5) =       0.000458585628
  error estimate for blocks of size 2^( 6) =       0.000466040328
  error estimate for blocks of size 2^( 7) =       0.000471452886

      target function =                  N/A
              le_mean =     -16.905020171038
             les_mean =     286.112869351225
             stat err =       0.000460778316
             autocorr =       1.274553014054
              std dev =       0.577202334199
             le_variance =       0.333162534605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329833008327
                                         uncertainty =       0.002524839266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329833008327
                                         uncertainty =       0.002524839266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408142998
  error estimate for blocks of size 2^( 2) =       0.000421018603
  error estimate for blocks of size 2^( 3) =       0.000434661572
  error estimate for blocks of size 2^( 4) =       0.000447033854
  error estimate for blocks of size 2^( 5) =       0.000458585066
  error estimate for blocks of size 2^( 6) =       0.000466039778
  error estimate for blocks of size 2^( 7) =       0.000471452356

      target function =                  N/A
              le_mean =     -16.905020178503
             les_mean =     286.112868482266
             stat err =       0.000460777764
             autocorr =       1.274554248488
              std dev =       0.577201362822
             le_variance =       0.333161413244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329832032730
                                         uncertainty =       0.002524832114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329832032730
                                         uncertainty =       0.002524832114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408142394
  error estimate for blocks of size 2^( 2) =       0.000421018032
  error estimate for blocks of size 2^( 3) =       0.000434661044
  error estimate for blocks of size 2^( 4) =       0.000447033355
  error estimate for blocks of size 2^( 5) =       0.000458584573
  error estimate for blocks of size 2^( 6) =       0.000466039295
  error estimate for blocks of size 2^( 7) =       0.000471451891

      target function =                  N/A
              le_mean =     -16.905020185081
             les_mean =     286.112867719517
             stat err =       0.000460777278
             autocorr =       1.274555332885
              std dev =       0.577200509456
             le_variance =       0.333160428117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905020186021        initial  <--
     9.5367e+01     9.5367e+02             3.9838e-06       -16.905020171038
     3.8147e+02     3.8147e+03             9.9659e-07       -16.905020178503
     1.5259e+03     1.5259e+04             2.4919e-07       -16.905020185081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2212
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.062626e-01 1 1  ON 0
 uu_1                 1.405130e-01 1 1  ON 1
 uu_2                 3.991507e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391744e-02 1 1  ON 4
 uu_5                -9.627620e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326937e-01 1 1  ON 7
 uu_8                -1.246533e-01 1 1  ON 8
 uu_9                -9.532819e-02 1 1  ON 9
 ud_0                 4.379682e-01 1 1  ON 10
 ud_1                 1.743683e-01 1 1  ON 11
 ud_2                 5.854062e-02 1 1  ON 12
 ud_3                -9.296871e-03 1 1  ON 13
 ud_4                -6.529979e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469616e-01 1 1  ON 17
 ud_8                -1.479722e-01 1 1  ON 18
 ud_9                -1.380540e-01 1 1  ON 19
 eO_0                -7.452774e-01 1 1  ON 20
 eO_1                -4.298245e-01 1 1  ON 21
 eO_2                -1.650630e-02 1 1  ON 22
 eO_3                 2.951526e-01 1 1  ON 23
 eO_4                 5.104729e-01 1 1  ON 24
 eO_5                 4.658840e-01 1 1  ON 25
 eO_6                 2.375929e-01 1 1  ON 26
 eO_7                -5.432300e-02 1 1  ON 27
 eO_8                -2.026967e-01 1 1  ON 28
 eO_9                -6.272799e-02 1 1  ON 29
eH1_0                -2.276260e-01 1 1  ON 30
eH1_1                -1.319962e-01 1 1  ON 31
eH1_2                -8.791255e-02 1 1  ON 32
eH1_3                -3.555527e-02 1 1  ON 33
eH1_4                 1.145346e-02 1 1  ON 34
eH1_5                 4.535966e-02 1 1  ON 35
eH1_6                 9.883261e-02 1 1  ON 36
eH1_7                 1.425728e-01 1 1  ON 37
eH1_8                 1.514949e-01 1 1  ON 38
eH1_9                 3.825651e-02 1 1  ON 39
eH2_0                -2.254836e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562752e-02 1 1  ON 42
eH2_3                -3.313729e-02 1 1  ON 43
eH2_4                 1.395725e-02 1 1  ON 44
eH2_5                 4.869268e-02 1 1  ON 45
eH2_6                 1.013857e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594858e-01 1 1  ON 48
eH2_9                 2.090492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0026e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9527
    reference variance = 0.187314
====================================================
  Execution time = 3.7059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339138186965
                                         uncertainty =       0.004406328098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339138186965
                                         uncertainty =       0.004406328098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411792369
  error estimate for blocks of size 2^( 2) =       0.000424192375
  error estimate for blocks of size 2^( 3) =       0.000437895735
  error estimate for blocks of size 2^( 4) =       0.000450780282
  error estimate for blocks of size 2^( 5) =       0.000461346316
  error estimate for blocks of size 2^( 6) =       0.000468713196
  error estimate for blocks of size 2^( 7) =       0.000471695824

      target function =                  N/A
              le_mean =     -16.905933250275
             les_mean =     286.149724804019
             stat err =       0.000463133904
             autocorr =       1.264901074298
              std dev =       0.582362353565
             le_variance =       0.339145910850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593325027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933250275       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933251336       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933251505       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933252400       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933251750       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933252214       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933252403       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933252404       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.965971e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933250275       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933250540       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933250582       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933250806       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933250643       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933250760       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933250806       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933250806       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 9.915623e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933250275       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933250341       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933250352       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933250408       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933250373       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933250396       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933250410       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933250421       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.478949e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.827442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7064e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.062626e-01 1 1  ON 0
 uu_1                 1.405131e-01 1 1  ON 1
 uu_2                 3.991508e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391745e-02 1 1  ON 4
 uu_5                -9.627622e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326937e-01 1 1  ON 7
 uu_8                -1.246533e-01 1 1  ON 8
 uu_9                -9.532821e-02 1 1  ON 9
 ud_0                 4.379683e-01 1 1  ON 10
 ud_1                 1.743684e-01 1 1  ON 11
 ud_2                 5.854063e-02 1 1  ON 12
 ud_3                -9.296878e-03 1 1  ON 13
 ud_4                -6.529977e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469616e-01 1 1  ON 17
 ud_8                -1.479722e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452775e-01 1 1  ON 20
 eO_1                -4.298246e-01 1 1  ON 21
 eO_2                -1.650631e-02 1 1  ON 22
 eO_3                 2.951526e-01 1 1  ON 23
 eO_4                 5.104729e-01 1 1  ON 24
 eO_5                 4.658840e-01 1 1  ON 25
 eO_6                 2.375930e-01 1 1  ON 26
 eO_7                -5.432298e-02 1 1  ON 27
 eO_8                -2.026968e-01 1 1  ON 28
 eO_9                -6.272804e-02 1 1  ON 29
eH1_0                -2.276260e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791257e-02 1 1  ON 32
eH1_3                -3.555524e-02 1 1  ON 33
eH1_4                 1.145344e-02 1 1  ON 34
eH1_5                 4.535966e-02 1 1  ON 35
eH1_6                 9.883260e-02 1 1  ON 36
eH1_7                 1.425728e-01 1 1  ON 37
eH1_8                 1.514950e-01 1 1  ON 38
eH1_9                 3.825656e-02 1 1  ON 39
eH2_0                -2.254836e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562754e-02 1 1  ON 42
eH2_3                -3.313731e-02 1 1  ON 43
eH2_4                 1.395724e-02 1 1  ON 44
eH2_5                 4.869266e-02 1 1  ON 45
eH2_6                 1.013857e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594858e-01 1 1  ON 48
eH2_9                 2.090496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.161161
====================================================
  Execution time = 3.8576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3787e-01
  Total weights = 2.0000e+06
  Execution time = 3.3788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768217366
                                         uncertainty =       0.003210933117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768217366
                                         uncertainty =       0.003210933117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411015301
  error estimate for blocks of size 2^( 2) =       0.000423971848
  error estimate for blocks of size 2^( 3) =       0.000437574090
  error estimate for blocks of size 2^( 4) =       0.000449938380
  error estimate for blocks of size 2^( 5) =       0.000460154591
  error estimate for blocks of size 2^( 6) =       0.000467577722
  error estimate for blocks of size 2^( 7) =       0.000471360097

      target function =                  N/A
              le_mean =     -16.905681977510
             les_mean =     286.139950110716
             stat err =       0.000462257697
             autocorr =       1.264888733621
              std dev =       0.581263412693
             le_variance =       0.337867154935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768321380
                                         uncertainty =       0.003210934264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768321380
                                         uncertainty =       0.003210934264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411015364
  error estimate for blocks of size 2^( 2) =       0.000423971906
  error estimate for blocks of size 2^( 3) =       0.000437574143
  error estimate for blocks of size 2^( 4) =       0.000449938429
  error estimate for blocks of size 2^( 5) =       0.000460154634
  error estimate for blocks of size 2^( 6) =       0.000467577766
  error estimate for blocks of size 2^( 7) =       0.000471360138

      target function =                  N/A
              le_mean =     -16.905681978148
             les_mean =     286.139950236371
             stat err =       0.000462257742
             autocorr =       1.264888586702
              std dev =       0.581263502237
             le_variance =       0.337867259033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768269370
                                         uncertainty =       0.003210933691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768269370
                                         uncertainty =       0.003210933691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411015332
  error estimate for blocks of size 2^( 2) =       0.000423971877
  error estimate for blocks of size 2^( 3) =       0.000437574116
  error estimate for blocks of size 2^( 4) =       0.000449938404
  error estimate for blocks of size 2^( 5) =       0.000460154613
  error estimate for blocks of size 2^( 6) =       0.000467577744
  error estimate for blocks of size 2^( 7) =       0.000471360117

      target function =                  N/A
              le_mean =     -16.905681977829
             les_mean =     286.139950173539
             stat err =       0.000462257720
             autocorr =       1.264888660159
              std dev =       0.581263457462
             le_variance =       0.337867206981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768223866
                                         uncertainty =       0.003210933189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337768223866
                                         uncertainty =       0.003210933189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411015305
  error estimate for blocks of size 2^( 2) =       0.000423971851
  error estimate for blocks of size 2^( 3) =       0.000437574093
  error estimate for blocks of size 2^( 4) =       0.000449938383
  error estimate for blocks of size 2^( 5) =       0.000460154594
  error estimate for blocks of size 2^( 6) =       0.000467577725
  error estimate for blocks of size 2^( 7) =       0.000471360099

      target function =                  N/A
              le_mean =     -16.905681977550
             les_mean =     286.139950118569
             stat err =       0.000462257700
             autocorr =       1.264888724437
              std dev =       0.581263418289
             le_variance =       0.337867161441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905681977510        initial
     9.5367e+02     9.5367e+03             3.9660e-07       -16.905681978148  <--
     3.8147e+03     3.8147e+04             9.9156e-08       -16.905681977829
     1.5259e+04     1.5259e+05             2.4789e-08       -16.905681977550

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 5.8498e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405131e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084701e-02 1 1  ON 3
 uu_4                -6.391747e-02 1 1  ON 4
 uu_5                -9.627627e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532829e-02 1 1  ON 9
 ud_0                 4.379684e-01 1 1  ON 10
 ud_1                 1.743685e-01 1 1  ON 11
 ud_2                 5.854068e-02 1 1  ON 12
 ud_3                -9.296899e-03 1 1  ON 13
 ud_4                -6.529974e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479723e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452778e-01 1 1  ON 20
 eO_1                -4.298248e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951528e-01 1 1  ON 23
 eO_4                 5.104732e-01 1 1  ON 24
 eO_5                 4.658843e-01 1 1  ON 25
 eO_6                 2.375931e-01 1 1  ON 26
 eO_7                -5.432291e-02 1 1  ON 27
 eO_8                -2.026969e-01 1 1  ON 28
 eO_9                -6.272817e-02 1 1  ON 29
eH1_0                -2.276262e-01 1 1  ON 30
eH1_1                -1.319964e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555514e-02 1 1  ON 33
eH1_4                 1.145338e-02 1 1  ON 34
eH1_5                 4.535964e-02 1 1  ON 35
eH1_6                 9.883258e-02 1 1  ON 36
eH1_7                 1.425729e-01 1 1  ON 37
eH1_8                 1.514951e-01 1 1  ON 38
eH1_9                 3.825670e-02 1 1  ON 39
eH2_0                -2.254838e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562763e-02 1 1  ON 42
eH2_3                -3.313737e-02 1 1  ON 43
eH2_4                 1.395719e-02 1 1  ON 44
eH2_5                 4.869260e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594860e-01 1 1  ON 48
eH2_9                 2.090511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0557e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.199504
====================================================
  Execution time = 3.7274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3581e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0055e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335571731894
                                         uncertainty =       0.003057599303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335571731894
                                         uncertainty =       0.003057599303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409759364
  error estimate for blocks of size 2^( 2) =       0.000422654443
  error estimate for blocks of size 2^( 3) =       0.000436016229
  error estimate for blocks of size 2^( 4) =       0.000447790943
  error estimate for blocks of size 2^( 5) =       0.000457815214
  error estimate for blocks of size 2^( 6) =       0.000464419170
  error estimate for blocks of size 2^( 7) =       0.000468054730

      target function =                  N/A
              le_mean =     -16.905331627900
             les_mean =     286.126042754595
             stat err =       0.000459520014
             autocorr =       1.257624787135
              std dev =       0.579487250268
             le_variance =       0.335805473224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533162790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905331627900       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905331629202       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905331634224       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905331635180       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905331633789       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905331632824       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905331634302       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905331634995       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.617734e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905331627900       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905331628226       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905331629482       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905331629723       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905331629374       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905331629131       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905331629500       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905331629672       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.045242e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905331627900       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905331627981       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905331628295       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905331628356       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905331628269       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905331628208       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905331628301       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905331628346       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.011367e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.830100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7336e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.062628e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991508e-02 1 1  ON 2
 uu_3                -2.084703e-02 1 1  ON 3
 uu_4                -6.391759e-02 1 1  ON 4
 uu_5                -9.627632e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326939e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532826e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743687e-01 1 1  ON 11
 ud_2                 5.854073e-02 1 1  ON 12
 ud_3                -9.296903e-03 1 1  ON 13
 ud_4                -6.529986e-02 1 1  ON 14
 ud_5                -1.054788e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469619e-01 1 1  ON 17
 ud_8                -1.479723e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452782e-01 1 1  ON 20
 eO_1                -4.298250e-01 1 1  ON 21
 eO_2                -1.650639e-02 1 1  ON 22
 eO_3                 2.951530e-01 1 1  ON 23
 eO_4                 5.104735e-01 1 1  ON 24
 eO_5                 4.658846e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432285e-02 1 1  ON 27
 eO_8                -2.026971e-01 1 1  ON 28
 eO_9                -6.272830e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319965e-01 1 1  ON 31
eH1_2                -8.791277e-02 1 1  ON 32
eH1_3                -3.555517e-02 1 1  ON 33
eH1_4                 1.145337e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883273e-02 1 1  ON 36
eH1_7                 1.425729e-01 1 1  ON 37
eH1_8                 1.514953e-01 1 1  ON 38
eH1_9                 3.825687e-02 1 1  ON 39
eH2_0                -2.254841e-01 1 1  ON 40
eH2_1                -1.299197e-01 1 1  ON 41
eH2_2                -8.562768e-02 1 1  ON 42
eH2_3                -3.313740e-02 1 1  ON 43
eH2_4                 1.395718e-02 1 1  ON 44
eH2_5                 4.869252e-02 1 1  ON 45
eH2_6                 1.013859e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090536e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.544048
====================================================
  Execution time = 3.6113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4631e-01
  Total weights = 2.0000e+06
  Execution time = 3.3688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350455407
                                         uncertainty =       0.006231991055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350455407
                                         uncertainty =       0.006231991055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416121000
  error estimate for blocks of size 2^( 2) =       0.000428683876
  error estimate for blocks of size 2^( 3) =       0.000441585368
  error estimate for blocks of size 2^( 4) =       0.000454240406
  error estimate for blocks of size 2^( 5) =       0.000463670302
  error estimate for blocks of size 2^( 6) =       0.000470724249
  error estimate for blocks of size 2^( 7) =       0.000475169005

      target function =                  N/A
              le_mean =     -16.905277258556
             les_mean =     286.134712389121
             stat err =       0.000465950991
             autocorr =       1.253837374672
              std dev =       0.588483962094
             le_variance =       0.346313373642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350600993
                                         uncertainty =       0.006232004685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350600993
                                         uncertainty =       0.006232004685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416121088
  error estimate for blocks of size 2^( 2) =       0.000428683957
  error estimate for blocks of size 2^( 3) =       0.000441585440
  error estimate for blocks of size 2^( 4) =       0.000454240469
  error estimate for blocks of size 2^( 5) =       0.000463670357
  error estimate for blocks of size 2^( 6) =       0.000470724306
  error estimate for blocks of size 2^( 7) =       0.000475169043

      target function =                  N/A
              le_mean =     -16.905277255420
             les_mean =     286.134712428743
             stat err =       0.000465951044
             autocorr =       1.253837133408
              std dev =       0.588484085838
             le_variance =       0.346313519284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350528001
                                         uncertainty =       0.006231997875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350528001
                                         uncertainty =       0.006231997875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416121044
  error estimate for blocks of size 2^( 2) =       0.000428683916
  error estimate for blocks of size 2^( 3) =       0.000441585404
  error estimate for blocks of size 2^( 4) =       0.000454240437
  error estimate for blocks of size 2^( 5) =       0.000463670329
  error estimate for blocks of size 2^( 6) =       0.000470724277
  error estimate for blocks of size 2^( 7) =       0.000475169024

      target function =                  N/A
              le_mean =     -16.905277256986
             les_mean =     286.134712408677
             stat err =       0.000465951017
             autocorr =       1.253837254189
              std dev =       0.588484023796
             le_variance =       0.346313446263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350464475
                                         uncertainty =       0.006231991908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346350464475
                                         uncertainty =       0.006231991908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416121006
  error estimate for blocks of size 2^( 2) =       0.000428683881
  error estimate for blocks of size 2^( 3) =       0.000441585373
  error estimate for blocks of size 2^( 4) =       0.000454240410
  error estimate for blocks of size 2^( 5) =       0.000463670305
  error estimate for blocks of size 2^( 6) =       0.000470724253
  error estimate for blocks of size 2^( 7) =       0.000475169007

      target function =                  N/A
              le_mean =     -16.905277258359
             les_mean =     286.134712391556
             stat err =       0.000465950994
             autocorr =       1.253837359610
              std dev =       0.588483969801
             le_variance =       0.346313382713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905277258556        initial  <--
     2.3842e+02     2.3842e+03             1.6177e-06       -16.905277255420
     9.5367e+02     9.5367e+03             4.0452e-07       -16.905277256986
     3.8147e+03     3.8147e+04             1.0114e-07       -16.905277258359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0859
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405131e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084701e-02 1 1  ON 3
 uu_4                -6.391747e-02 1 1  ON 4
 uu_5                -9.627627e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532829e-02 1 1  ON 9
 ud_0                 4.379684e-01 1 1  ON 10
 ud_1                 1.743685e-01 1 1  ON 11
 ud_2                 5.854068e-02 1 1  ON 12
 ud_3                -9.296899e-03 1 1  ON 13
 ud_4                -6.529974e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479723e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452778e-01 1 1  ON 20
 eO_1                -4.298248e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951528e-01 1 1  ON 23
 eO_4                 5.104732e-01 1 1  ON 24
 eO_5                 4.658843e-01 1 1  ON 25
 eO_6                 2.375931e-01 1 1  ON 26
 eO_7                -5.432291e-02 1 1  ON 27
 eO_8                -2.026969e-01 1 1  ON 28
 eO_9                -6.272817e-02 1 1  ON 29
eH1_0                -2.276262e-01 1 1  ON 30
eH1_1                -1.319964e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555514e-02 1 1  ON 33
eH1_4                 1.145338e-02 1 1  ON 34
eH1_5                 4.535964e-02 1 1  ON 35
eH1_6                 9.883258e-02 1 1  ON 36
eH1_7                 1.425729e-01 1 1  ON 37
eH1_8                 1.514951e-01 1 1  ON 38
eH1_9                 3.825670e-02 1 1  ON 39
eH2_0                -2.254838e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562763e-02 1 1  ON 42
eH2_3                -3.313737e-02 1 1  ON 43
eH2_4                 1.395719e-02 1 1  ON 44
eH2_5                 4.869260e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594860e-01 1 1  ON 48
eH2_9                 2.090511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0043e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9496
    reference variance = 0.221515
====================================================
  Execution time = 3.6981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339454529379
                                         uncertainty =       0.004233522132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339454529379
                                         uncertainty =       0.004233522132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411926825
  error estimate for blocks of size 2^( 2) =       0.000424885677
  error estimate for blocks of size 2^( 3) =       0.000438624761
  error estimate for blocks of size 2^( 4) =       0.000451102641
  error estimate for blocks of size 2^( 5) =       0.000461024240
  error estimate for blocks of size 2^( 6) =       0.000468338133
  error estimate for blocks of size 2^( 7) =       0.000474861143

      target function =                  N/A
              le_mean =     -16.904901890211
             les_mean =     286.115075166073
             stat err =       0.000463831539
             autocorr =       1.267886574667
              std dev =       0.582552502438
             le_variance =       0.339367418097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690490189021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901890211       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901890527       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904901890529       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904901890264       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904901890045       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904901890099       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904901890147       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904901890169       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.746884e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901890211       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901890290       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904901890291       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904901890223       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904901890170       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904901890211       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904901890202       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904901890202       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.367239e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901890211       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901890231       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904901890231       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904901890212       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904901890187       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904901890202       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904901890204       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904901890205       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.091812e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.832717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6855e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405131e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084702e-02 1 1  ON 3
 uu_4                -6.391748e-02 1 1  ON 4
 uu_5                -9.627628e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532829e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854068e-02 1 1  ON 12
 ud_3                -9.296899e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479723e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452778e-01 1 1  ON 20
 eO_1                -4.298248e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951528e-01 1 1  ON 23
 eO_4                 5.104732e-01 1 1  ON 24
 eO_5                 4.658843e-01 1 1  ON 25
 eO_6                 2.375931e-01 1 1  ON 26
 eO_7                -5.432291e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272818e-02 1 1  ON 29
eH1_0                -2.276263e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555516e-02 1 1  ON 33
eH1_4                 1.145338e-02 1 1  ON 34
eH1_5                 4.535964e-02 1 1  ON 35
eH1_6                 9.883258e-02 1 1  ON 36
eH1_7                 1.425729e-01 1 1  ON 37
eH1_8                 1.514951e-01 1 1  ON 38
eH1_9                 3.825671e-02 1 1  ON 39
eH2_0                -2.254838e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562764e-02 1 1  ON 42
eH2_3                -3.313737e-02 1 1  ON 43
eH2_4                 1.395718e-02 1 1  ON 44
eH2_5                 4.869259e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594860e-01 1 1  ON 48
eH2_9                 2.090514e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9383
    reference variance = 0.168817
====================================================
  Execution time = 3.6261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3426e-01
  Total weights = 2.0000e+06
  Execution time = 3.3744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252716055
                                         uncertainty =       0.003386116168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252716055
                                         uncertainty =       0.003386116168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408816307
  error estimate for blocks of size 2^( 2) =       0.000421966609
  error estimate for blocks of size 2^( 3) =       0.000435650707
  error estimate for blocks of size 2^( 4) =       0.000449465679
  error estimate for blocks of size 2^( 5) =       0.000461466971
  error estimate for blocks of size 2^( 6) =       0.000471101439
  error estimate for blocks of size 2^( 7) =       0.000475978344

      target function =                  N/A
              le_mean =     -16.905054644963
             les_mean =     286.115133927068
             stat err =       0.000464503108
             autocorr =       1.290983907036
              std dev =       0.578153565248
             le_variance =       0.334261545009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252759676
                                         uncertainty =       0.003386116892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252759676
                                         uncertainty =       0.003386116892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408816333
  error estimate for blocks of size 2^( 2) =       0.000421966634
  error estimate for blocks of size 2^( 3) =       0.000435650730
  error estimate for blocks of size 2^( 4) =       0.000449465700
  error estimate for blocks of size 2^( 5) =       0.000461466991
  error estimate for blocks of size 2^( 6) =       0.000471101460
  error estimate for blocks of size 2^( 7) =       0.000475978365

      target function =                  N/A
              le_mean =     -16.905054645050
             les_mean =     286.115133973585
             stat err =       0.000464503129
             autocorr =       1.290983852877
              std dev =       0.578153602947
             le_variance =       0.334261588601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252737864
                                         uncertainty =       0.003386116530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252737864
                                         uncertainty =       0.003386116530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408816320
  error estimate for blocks of size 2^( 2) =       0.000421966622
  error estimate for blocks of size 2^( 3) =       0.000435650719
  error estimate for blocks of size 2^( 4) =       0.000449465690
  error estimate for blocks of size 2^( 5) =       0.000461466981
  error estimate for blocks of size 2^( 6) =       0.000471101449
  error estimate for blocks of size 2^( 7) =       0.000475978354

      target function =                  N/A
              le_mean =     -16.905054645006
             les_mean =     286.115133950325
             stat err =       0.000464503119
             autocorr =       1.290983879963
              std dev =       0.578153584096
             le_variance =       0.334261566803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252718781
                                         uncertainty =       0.003386116213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252718781
                                         uncertainty =       0.003386116213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408816308
  error estimate for blocks of size 2^( 2) =       0.000421966611
  error estimate for blocks of size 2^( 3) =       0.000435650709
  error estimate for blocks of size 2^( 4) =       0.000449465681
  error estimate for blocks of size 2^( 5) =       0.000461466972
  error estimate for blocks of size 2^( 6) =       0.000471101441
  error estimate for blocks of size 2^( 7) =       0.000475978345

      target function =                  N/A
              le_mean =     -16.905054644969
             les_mean =     286.115133929975
             stat err =       0.000464503110
             autocorr =       1.290983903652
              std dev =       0.578153567604
             le_variance =       0.334261547734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905054644963        initial
     2.3842e+03     2.3842e+04             1.7469e-07       -16.905054645050  <--
     9.5367e+03     9.5367e+04             4.3672e-08       -16.905054645006
     3.8147e+04     3.8147e+05             1.0918e-08       -16.905054644969

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 5.3271e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391749e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532830e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296897e-03 1 1  ON 13
 ud_4                -6.529971e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452779e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650633e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104733e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432289e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272822e-02 1 1  ON 29
eH1_0                -2.276263e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535963e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825673e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562767e-02 1 1  ON 42
eH2_3                -3.313740e-02 1 1  ON 43
eH2_4                 1.395717e-02 1 1  ON 44
eH2_5                 4.869257e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594860e-01 1 1  ON 48
eH2_9                 2.090522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0013e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.19812
====================================================
  Execution time = 3.7415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0324e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794273444
                                         uncertainty =       0.005188667296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794273444
                                         uncertainty =       0.005188667296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409817694
  error estimate for blocks of size 2^( 2) =       0.000423098924
  error estimate for blocks of size 2^( 3) =       0.000436334412
  error estimate for blocks of size 2^( 4) =       0.000448955803
  error estimate for blocks of size 2^( 5) =       0.000460739189
  error estimate for blocks of size 2^( 6) =       0.000468346385
  error estimate for blocks of size 2^( 7) =       0.000474827526

      target function =                  N/A
              le_mean =     -16.905246897849
             les_mean =     286.123273594099
             stat err =       0.000463217226
             autocorr =       1.277579668330
              std dev =       0.579569741124
             le_variance =       0.335901084827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690524689785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905246897849       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905246898294       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905246898144       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905246897224       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905246897862       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905246899751       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905246899943       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905246899955       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.929412e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905246897849       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905246897960       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905246897923       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905246897693       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905246897854       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905246898323       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905246898374       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905246898379       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.482316e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905246897849       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905246897877       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905246897867       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905246897810       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905246897850       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905246897968       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905246897980       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905246897980       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.705766e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.835372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9747e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.062628e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991513e-02 1 1  ON 2
 uu_3                -2.084711e-02 1 1  ON 3
 uu_4                -6.391749e-02 1 1  ON 4
 uu_5                -9.627632e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246535e-01 1 1  ON 8
 uu_9                -9.532835e-02 1 1  ON 9
 ud_0                 4.379686e-01 1 1  ON 10
 ud_1                 1.743687e-01 1 1  ON 11
 ud_2                 5.854072e-02 1 1  ON 12
 ud_3                -9.296914e-03 1 1  ON 13
 ud_4                -6.529971e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315625e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380542e-01 1 1  ON 19
 eO_0                -7.452781e-01 1 1  ON 20
 eO_1                -4.298250e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951530e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658845e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432286e-02 1 1  ON 27
 eO_8                -2.026971e-01 1 1  ON 28
 eO_9                -6.272828e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555525e-02 1 1  ON 33
eH1_4                 1.145337e-02 1 1  ON 34
eH1_5                 4.535958e-02 1 1  ON 35
eH1_6                 9.883261e-02 1 1  ON 36
eH1_7                 1.425731e-01 1 1  ON 37
eH1_8                 1.514953e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299195e-01 1 1  ON 41
eH2_2                -8.562769e-02 1 1  ON 42
eH2_3                -3.313743e-02 1 1  ON 43
eH2_4                 1.395715e-02 1 1  ON 44
eH2_5                 4.869251e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481298e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7863
    reference variance = 0.284908
====================================================
  Execution time = 3.5949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3852e-01
  Total weights = 2.0000e+06
  Execution time = 3.3641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561042607
                                         uncertainty =       0.004123650750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561042607
                                         uncertainty =       0.004123650750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411414291
  error estimate for blocks of size 2^( 2) =       0.000424548513
  error estimate for blocks of size 2^( 3) =       0.000437700056
  error estimate for blocks of size 2^( 4) =       0.000449937603
  error estimate for blocks of size 2^( 5) =       0.000460960555
  error estimate for blocks of size 2^( 6) =       0.000469461583
  error estimate for blocks of size 2^( 7) =       0.000473034154

      target function =                  N/A
              le_mean =     -16.905254014157
             les_mean =     286.126136551147
             stat err =       0.000463348474
             autocorr =       1.268401441874
              std dev =       0.581827669702
             le_variance =       0.338523437231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561337534
                                         uncertainty =       0.004123653885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561337534
                                         uncertainty =       0.004123653885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411414470
  error estimate for blocks of size 2^( 2) =       0.000424548684
  error estimate for blocks of size 2^( 3) =       0.000437700218
  error estimate for blocks of size 2^( 4) =       0.000449937754
  error estimate for blocks of size 2^( 5) =       0.000460960698
  error estimate for blocks of size 2^( 6) =       0.000469461722
  error estimate for blocks of size 2^( 7) =       0.000473034299

      target function =                  N/A
              le_mean =     -16.905254014059
             les_mean =     286.126136842651
             stat err =       0.000463348618
             autocorr =       1.268401130001
              std dev =       0.581827923073
             le_variance =       0.338523732068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561190105
                                         uncertainty =       0.004123652318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561190105
                                         uncertainty =       0.004123652318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411414380
  error estimate for blocks of size 2^( 2) =       0.000424548598
  error estimate for blocks of size 2^( 3) =       0.000437700137
  error estimate for blocks of size 2^( 4) =       0.000449937678
  error estimate for blocks of size 2^( 5) =       0.000460960626
  error estimate for blocks of size 2^( 6) =       0.000469461652
  error estimate for blocks of size 2^( 7) =       0.000473034227

      target function =                  N/A
              le_mean =     -16.905254014108
             les_mean =     286.126136696927
             stat err =       0.000463348546
             autocorr =       1.268401285907
              std dev =       0.581827796418
             le_variance =       0.338523584684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561061045
                                         uncertainty =       0.004123650946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338561061045
                                         uncertainty =       0.004123650946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411414302
  error estimate for blocks of size 2^( 2) =       0.000424548523
  error estimate for blocks of size 2^( 3) =       0.000437700066
  error estimate for blocks of size 2^( 4) =       0.000449937612
  error estimate for blocks of size 2^( 5) =       0.000460960564
  error estimate for blocks of size 2^( 6) =       0.000469461592
  error estimate for blocks of size 2^( 7) =       0.000473034163

      target function =                  N/A
              le_mean =     -16.905254014151
             les_mean =     286.126136569370
             stat err =       0.000463348483
             autocorr =       1.268401422379
              std dev =       0.581827685542
             le_variance =       0.338523455663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905254014157        initial  <--
     5.9605e+02     5.9605e+03             5.9294e-07       -16.905254014059
     2.3842e+03     2.3842e+04             1.4823e-07       -16.905254014108
     9.5367e+03     9.5367e+04             3.7058e-08       -16.905254014151

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.6640
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391749e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532830e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296897e-03 1 1  ON 13
 ud_4                -6.529971e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452779e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650633e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104733e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432289e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272822e-02 1 1  ON 29
eH1_0                -2.276263e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535963e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825673e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562767e-02 1 1  ON 42
eH2_3                -3.313740e-02 1 1  ON 43
eH2_4                 1.395717e-02 1 1  ON 44
eH2_5                 4.869257e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594860e-01 1 1  ON 48
eH2_9                 2.090522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0642e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.227539
====================================================
  Execution time = 3.6881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4277e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0021e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342342331320
                                         uncertainty =       0.003590584879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342342331320
                                         uncertainty =       0.003590584879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413986087
  error estimate for blocks of size 2^( 2) =       0.000426879643
  error estimate for blocks of size 2^( 3) =       0.000440444690
  error estimate for blocks of size 2^( 4) =       0.000453912061
  error estimate for blocks of size 2^( 5) =       0.000464407405
  error estimate for blocks of size 2^( 6) =       0.000477685376
  error estimate for blocks of size 2^( 7) =       0.000485820379

      target function =                  N/A
              le_mean =     -16.905191047385
             les_mean =     286.128253136888
             stat err =       0.000470456305
             autocorr =       1.291418775138
              std dev =       0.585464738221
             le_variance =       0.342768959701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519104738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191047385       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191047374       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191047532       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191047562       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191047531       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191047561       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191047584       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191047580       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 8.337333e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191047385       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191047382       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191047421       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191047429       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191047436       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191047437       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191047434       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191047434       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.084366e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191047385       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191047384       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191047394       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191047392       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191047399       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191047426       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191047386       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191047322       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 5.210934e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.838055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6910e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391750e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215850e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532830e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296900e-03 1 1  ON 13
 ud_4                -6.529972e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469617e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650633e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104733e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432289e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272823e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791264e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535963e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825674e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562768e-02 1 1  ON 42
eH2_3                -3.313740e-02 1 1  ON 43
eH2_4                 1.395717e-02 1 1  ON 44
eH2_5                 4.869256e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9813
    reference variance = 0.342706
====================================================
  Execution time = 3.6355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.0000e+06
  Execution time = 3.3717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450553735
                                         uncertainty =       0.003928014137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450553735
                                         uncertainty =       0.003928014137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409513310
  error estimate for blocks of size 2^( 2) =       0.000422396755
  error estimate for blocks of size 2^( 3) =       0.000435641288
  error estimate for blocks of size 2^( 4) =       0.000448317973
  error estimate for blocks of size 2^( 5) =       0.000459269253
  error estimate for blocks of size 2^( 6) =       0.000467164339
  error estimate for blocks of size 2^( 7) =       0.000472093478

      target function =                  N/A
              le_mean =     -16.905418956508
             les_mean =     286.128592229642
             stat err =       0.000461711261
             autocorr =       1.271173673542
              std dev =       0.579139277105
             le_variance =       0.335402302285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450580168
                                         uncertainty =       0.003928014526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450580168
                                         uncertainty =       0.003928014526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409513326
  error estimate for blocks of size 2^( 2) =       0.000422396770
  error estimate for blocks of size 2^( 3) =       0.000435641302
  error estimate for blocks of size 2^( 4) =       0.000448317986
  error estimate for blocks of size 2^( 5) =       0.000459269266
  error estimate for blocks of size 2^( 6) =       0.000467164353
  error estimate for blocks of size 2^( 7) =       0.000472093492

      target function =                  N/A
              le_mean =     -16.905418956578
             les_mean =     286.128592258434
             stat err =       0.000461711274
             autocorr =       1.271173647621
              std dev =       0.579139299909
             le_variance =       0.335402328699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450566952
                                         uncertainty =       0.003928014331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450566952
                                         uncertainty =       0.003928014331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409513318
  error estimate for blocks of size 2^( 2) =       0.000422396762
  error estimate for blocks of size 2^( 3) =       0.000435641295
  error estimate for blocks of size 2^( 4) =       0.000448317980
  error estimate for blocks of size 2^( 5) =       0.000459269259
  error estimate for blocks of size 2^( 6) =       0.000467164346
  error estimate for blocks of size 2^( 7) =       0.000472093485

      target function =                  N/A
              le_mean =     -16.905418956543
             les_mean =     286.128592244038
             stat err =       0.000461711268
             autocorr =       1.271173660583
              std dev =       0.579139288507
             le_variance =       0.335402315492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450555388
                                         uncertainty =       0.003928014161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335450555388
                                         uncertainty =       0.003928014161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409513311
  error estimate for blocks of size 2^( 2) =       0.000422396756
  error estimate for blocks of size 2^( 3) =       0.000435641289
  error estimate for blocks of size 2^( 4) =       0.000448317974
  error estimate for blocks of size 2^( 5) =       0.000459269254
  error estimate for blocks of size 2^( 6) =       0.000467164340
  error estimate for blocks of size 2^( 7) =       0.000472093479

      target function =                  N/A
              le_mean =     -16.905418956512
             les_mean =     286.128592231441
             stat err =       0.000461711262
             autocorr =       1.271173671922
              std dev =       0.579139278530
             le_variance =       0.335402303936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905418956508        initial
     5.9605e+03     5.9605e+04             8.3373e-08       -16.905418956578  <--
     2.3842e+04     2.3842e+05             2.0844e-08       -16.905418956543
     9.5367e+04     9.5367e+05             5.2109e-09       -16.905418956512

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 5.3345e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0026e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.216998
====================================================
  Execution time = 3.6749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4198e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037949305
                                         uncertainty =       0.005050142231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037949305
                                         uncertainty =       0.005050142231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413508543
  error estimate for blocks of size 2^( 2) =       0.000425929977
  error estimate for blocks of size 2^( 3) =       0.000438759722
  error estimate for blocks of size 2^( 4) =       0.000451390976
  error estimate for blocks of size 2^( 5) =       0.000462070238
  error estimate for blocks of size 2^( 6) =       0.000470295474
  error estimate for blocks of size 2^( 7) =       0.000474174363

      target function =                  N/A
              le_mean =     -16.905321109050
             les_mean =     286.131860259330
             stat err =       0.000464482763
             autocorr =       1.261741044204
              std dev =       0.584789389636
             le_variance =       0.341978630231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532110905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905321109050       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905321108960       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905321109668       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905321109988       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905321110367       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905321110654       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905321110423       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905321110415       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.612916e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905321109050       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905321109027       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905321109205       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905321109284       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905321109379       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905321109449       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905321109393       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905321109388       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 6.532458e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905321109050       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905321109044       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905321109089       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905321109109       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905321109134       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905321109151       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905321109122       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905321109143       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.633125e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.840736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6590e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391753e-02 1 1  ON 4
 uu_5                -9.627631e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532832e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743687e-01 1 1  ON 11
 ud_2                 5.854070e-02 1 1  ON 12
 ud_3                -9.296904e-03 1 1  ON 13
 ud_4                -6.529975e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452781e-01 1 1  ON 20
 eO_1                -4.298250e-01 1 1  ON 21
 eO_2                -1.650635e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658845e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026971e-01 1 1  ON 28
 eO_9                -6.272826e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319964e-01 1 1  ON 31
eH1_2                -8.791267e-02 1 1  ON 32
eH1_3                -3.555524e-02 1 1  ON 33
eH1_4                 1.145339e-02 1 1  ON 34
eH1_5                 4.535960e-02 1 1  ON 35
eH1_6                 9.883258e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514953e-01 1 1  ON 38
eH1_9                 3.825680e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313742e-02 1 1  ON 43
eH2_4                 1.395713e-02 1 1  ON 44
eH2_5                 4.869256e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090530e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9446
    reference variance = 0.38726
====================================================
  Execution time = 3.6358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3374e-01
  Total weights = 2.0000e+06
  Execution time = 3.3763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779292255
                                         uncertainty =       0.002991688818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779292255
                                         uncertainty =       0.002991688818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408499020
  error estimate for blocks of size 2^( 2) =       0.000421031994
  error estimate for blocks of size 2^( 3) =       0.000434638687
  error estimate for blocks of size 2^( 4) =       0.000447709169
  error estimate for blocks of size 2^( 5) =       0.000459143173
  error estimate for blocks of size 2^( 6) =       0.000465724721
  error estimate for blocks of size 2^( 7) =       0.000471092196

      target function =                  N/A
              le_mean =     -16.904879411855
             les_mean =     286.108690660676
             stat err =       0.000460917315
             autocorr =       1.273104369489
              std dev =       0.577704853887
             le_variance =       0.333742898205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779340615
                                         uncertainty =       0.002991689163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779340615
                                         uncertainty =       0.002991689163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408499049
  error estimate for blocks of size 2^( 2) =       0.000421032022
  error estimate for blocks of size 2^( 3) =       0.000434638712
  error estimate for blocks of size 2^( 4) =       0.000447709190
  error estimate for blocks of size 2^( 5) =       0.000459143192
  error estimate for blocks of size 2^( 6) =       0.000465724737
  error estimate for blocks of size 2^( 7) =       0.000471092213

      target function =                  N/A
              le_mean =     -16.904879411570
             les_mean =     286.108690699399
             stat err =       0.000460917333
             autocorr =       1.273104287979
              std dev =       0.577704895714
             le_variance =       0.333742946532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779316434
                                         uncertainty =       0.002991688990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779316434
                                         uncertainty =       0.002991688990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408499034
  error estimate for blocks of size 2^( 2) =       0.000421032008
  error estimate for blocks of size 2^( 3) =       0.000434638700
  error estimate for blocks of size 2^( 4) =       0.000447709179
  error estimate for blocks of size 2^( 5) =       0.000459143183
  error estimate for blocks of size 2^( 6) =       0.000465724729
  error estimate for blocks of size 2^( 7) =       0.000471092205

      target function =                  N/A
              le_mean =     -16.904879411712
             les_mean =     286.108690680035
             stat err =       0.000460917324
             autocorr =       1.273104328737
              std dev =       0.577704874799
             le_variance =       0.333742922367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779295277
                                         uncertainty =       0.002991688840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333779295277
                                         uncertainty =       0.002991688840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408499022
  error estimate for blocks of size 2^( 2) =       0.000421031996
  error estimate for blocks of size 2^( 3) =       0.000434638689
  error estimate for blocks of size 2^( 4) =       0.000447709170
  error estimate for blocks of size 2^( 5) =       0.000459143175
  error estimate for blocks of size 2^( 6) =       0.000465724722
  error estimate for blocks of size 2^( 7) =       0.000471092197

      target function =                  N/A
              le_mean =     -16.904879411837
             les_mean =     286.108690663096
             stat err =       0.000460917316
             autocorr =       1.273104364390
              std dev =       0.577704856501
             le_variance =       0.333742901225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904879411855        initial  <--
     1.4901e+03     1.4901e+04             2.6129e-07       -16.904879411570
     5.9605e+03     5.9605e+04             6.5325e-08       -16.904879411712
     2.3842e+04     2.3842e+05             1.6331e-08       -16.904879411837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3828
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.30842
====================================================
  Execution time = 3.7871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3421e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0014e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334238880758
                                         uncertainty =       0.002779601109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334238880758
                                         uncertainty =       0.002779601109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784225
  error estimate for blocks of size 2^( 2) =       0.000421190791
  error estimate for blocks of size 2^( 3) =       0.000434418707
  error estimate for blocks of size 2^( 4) =       0.000446014382
  error estimate for blocks of size 2^( 5) =       0.000456692929
  error estimate for blocks of size 2^( 6) =       0.000465046370
  error estimate for blocks of size 2^( 7) =       0.000470148451

      target function =                  N/A
              le_mean =     -16.905388712400
             les_mean =     286.126376434798
             stat err =       0.000459475533
             autocorr =       1.263387352674
              std dev =       0.578108194513
             le_variance =       0.334209084563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538871240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388712400       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905388712449       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905388712535       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905388712544       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905388712533       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905388712515       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905388712528       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905388712532       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.874963e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388712400       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905388712412       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905388712434       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905388712436       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905388712433       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905388712408       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905388712442       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905388712439       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 7.187438e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388712400       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905388712403       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905388712408       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905388712415       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905388712412       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905388712383       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905388712349       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905388712241       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.796861e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.843384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7893e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650633e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319964e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090527e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8207
    reference variance = 0.277868
====================================================
  Execution time = 3.6679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5394e-01
  Total weights = 2.0000e+06
  Execution time = 3.4987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998608614
                                         uncertainty =       0.014596095248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998608614
                                         uncertainty =       0.014596095248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420677405
  error estimate for blocks of size 2^( 2) =       0.000433145717
  error estimate for blocks of size 2^( 3) =       0.000445722913
  error estimate for blocks of size 2^( 4) =       0.000457751478
  error estimate for blocks of size 2^( 5) =       0.000469609699
  error estimate for blocks of size 2^( 6) =       0.000478487970
  error estimate for blocks of size 2^( 7) =       0.000485043576

      target function =                  N/A
              le_mean =     -16.905696899050
             les_mean =     286.156526423815
             stat err =       0.000472723181
             autocorr =       1.262744324846
              std dev =       0.594927691595
             le_variance =       0.353938958226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998613042
                                         uncertainty =       0.014596094576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998613042
                                         uncertainty =       0.014596094576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420677408
  error estimate for blocks of size 2^( 2) =       0.000433145719
  error estimate for blocks of size 2^( 3) =       0.000445722915
  error estimate for blocks of size 2^( 4) =       0.000457751479
  error estimate for blocks of size 2^( 5) =       0.000469609700
  error estimate for blocks of size 2^( 6) =       0.000478487972
  error estimate for blocks of size 2^( 7) =       0.000485043578

      target function =                  N/A
              le_mean =     -16.905696898999
             les_mean =     286.156526426504
             stat err =       0.000472723182
             autocorr =       1.262744317971
              std dev =       0.594927695316
             le_variance =       0.353938962654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998610828
                                         uncertainty =       0.014596094912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998610828
                                         uncertainty =       0.014596094912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420677406
  error estimate for blocks of size 2^( 2) =       0.000433145718
  error estimate for blocks of size 2^( 3) =       0.000445722914
  error estimate for blocks of size 2^( 4) =       0.000457751479
  error estimate for blocks of size 2^( 5) =       0.000469609699
  error estimate for blocks of size 2^( 6) =       0.000478487971
  error estimate for blocks of size 2^( 7) =       0.000485043577

      target function =                  N/A
              le_mean =     -16.905696899025
             les_mean =     286.156526425159
             stat err =       0.000472723181
             autocorr =       1.262744321399
              std dev =       0.594927693455
             le_variance =       0.353938960440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998608890
                                         uncertainty =       0.014596095206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353998608890
                                         uncertainty =       0.014596095206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420677405
  error estimate for blocks of size 2^( 2) =       0.000433145717
  error estimate for blocks of size 2^( 3) =       0.000445722913
  error estimate for blocks of size 2^( 4) =       0.000457751478
  error estimate for blocks of size 2^( 5) =       0.000469609699
  error estimate for blocks of size 2^( 6) =       0.000478487970
  error estimate for blocks of size 2^( 7) =       0.000485043576

      target function =                  N/A
              le_mean =     -16.905696899047
             les_mean =     286.156526423983
             stat err =       0.000472723181
             autocorr =       1.262744324414
              std dev =       0.594927691827
             le_variance =       0.353938958503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905696899050        initial  <--
     1.4901e+04     1.4901e+05             2.8750e-08       -16.905696898999
     5.9605e+04     5.9605e+05             7.1874e-09       -16.905696899025
     2.3842e+05     2.3842e+06             1.7969e-09       -16.905696899047

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.0184
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0392e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.385634
====================================================
  Execution time = 3.7417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4098e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341037828736
                                         uncertainty =       0.007830441238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341037828736
                                         uncertainty =       0.007830441238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903793
  error estimate for blocks of size 2^( 2) =       0.000425377955
  error estimate for blocks of size 2^( 3) =       0.000438899795
  error estimate for blocks of size 2^( 4) =       0.000450028300
  error estimate for blocks of size 2^( 5) =       0.000460927953
  error estimate for blocks of size 2^( 6) =       0.000466733206
  error estimate for blocks of size 2^( 7) =       0.000471779074

      target function =                  N/A
              le_mean =     -16.905646393934
             les_mean =     286.141858910525
             stat err =       0.000462367133
             autocorr =       1.253938295716
              std dev =       0.583934143787
             le_variance =       0.340979084280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564639393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646393934       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905646393933       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905646393939       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905646393957       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905646393917       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905646393830       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905646393932       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905646393824       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.527423e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646393934       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905646393934       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905646393935       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905646393936       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905646394797       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905646393855       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905646393767       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905646393767       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 6.318556e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646393934       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905646393934       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905646393934       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905646393935       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905646393935       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905646393947       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905646393773       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905646390399       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.579636e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.846104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7324e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9587
    reference variance = 0.610642
====================================================
  Execution time = 3.6067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3955e-01
  Total weights = 2.0000e+06
  Execution time = 3.3653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864101
                                         uncertainty =       0.003425003326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864101
                                         uncertainty =       0.003425003326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412039244
  error estimate for blocks of size 2^( 2) =       0.000425011042
  error estimate for blocks of size 2^( 3) =       0.000438590515
  error estimate for blocks of size 2^( 4) =       0.000451200638
  error estimate for blocks of size 2^( 5) =       0.000462264262
  error estimate for blocks of size 2^( 6) =       0.000470617075
  error estimate for blocks of size 2^( 7) =       0.000475749037

      target function =                  N/A
              le_mean =     -16.904689753214
             les_mean =     286.108088159402
             stat err =       0.000464957753
             autocorr =       1.273355959968
              std dev =       0.582711486728
             le_variance =       0.339552676765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627865011
                                         uncertainty =       0.003425003341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627865011
                                         uncertainty =       0.003425003341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412039244
  error estimate for blocks of size 2^( 2) =       0.000425011043
  error estimate for blocks of size 2^( 3) =       0.000438590515
  error estimate for blocks of size 2^( 4) =       0.000451200639
  error estimate for blocks of size 2^( 5) =       0.000462264263
  error estimate for blocks of size 2^( 6) =       0.000470617076
  error estimate for blocks of size 2^( 7) =       0.000475749038

      target function =                  N/A
              le_mean =     -16.904689753211
             les_mean =     286.108088160200
             stat err =       0.000464957754
             autocorr =       1.273355958869
              std dev =       0.582711487508
             le_variance =       0.339552677674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864556
                                         uncertainty =       0.003425003334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864556
                                         uncertainty =       0.003425003334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412039244
  error estimate for blocks of size 2^( 2) =       0.000425011043
  error estimate for blocks of size 2^( 3) =       0.000438590515
  error estimate for blocks of size 2^( 4) =       0.000451200638
  error estimate for blocks of size 2^( 5) =       0.000462264263
  error estimate for blocks of size 2^( 6) =       0.000470617075
  error estimate for blocks of size 2^( 7) =       0.000475749038

      target function =                  N/A
              le_mean =     -16.904689753212
             les_mean =     286.108088159801
             stat err =       0.000464957753
             autocorr =       1.273355959424
              std dev =       0.582711487118
             le_variance =       0.339552677219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864158
                                         uncertainty =       0.003425003327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627864158
                                         uncertainty =       0.003425003327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412039244
  error estimate for blocks of size 2^( 2) =       0.000425011042
  error estimate for blocks of size 2^( 3) =       0.000438590515
  error estimate for blocks of size 2^( 4) =       0.000451200638
  error estimate for blocks of size 2^( 5) =       0.000462264262
  error estimate for blocks of size 2^( 6) =       0.000470617075
  error estimate for blocks of size 2^( 7) =       0.000475749037

      target function =                  N/A
              le_mean =     -16.904689753214
             les_mean =     286.108088159452
             stat err =       0.000464957753
             autocorr =       1.273355959896
              std dev =       0.582711486777
             le_variance =       0.339552676822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904689753214        initial  <--
     1.4901e+05     1.4901e+06             2.5274e-09       -16.904689753211
     5.9605e+05     5.9605e+06             6.3186e-10       -16.904689753212
     2.3842e+06     2.3842e+07             1.5796e-10       -16.904689753214

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0232
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0035e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.213272
====================================================
  Execution time = 3.6865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4448e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344570289191
                                         uncertainty =       0.005554637124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344570289191
                                         uncertainty =       0.005554637124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415020842
  error estimate for blocks of size 2^( 2) =       0.000427575505
  error estimate for blocks of size 2^( 3) =       0.000440596357
  error estimate for blocks of size 2^( 4) =       0.000451663030
  error estimate for blocks of size 2^( 5) =       0.000461529520
  error estimate for blocks of size 2^( 6) =       0.000469162888
  error estimate for blocks of size 2^( 7) =       0.000475724558

      target function =                  N/A
              le_mean =     -16.905684676629
             les_mean =     286.146658812530
             stat err =       0.000464519999
             autocorr =       1.252763288149
              std dev =       0.586928103924
             le_variance =       0.344484599176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568467663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684676629       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684676629       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684676629       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684676627       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684676021       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684676643       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684677236       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684675585       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.473025e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684676629       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684676629       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684676629       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684676629       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684679454       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684672827       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684675069       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684677195       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 6.182549e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905684676629       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684676629       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684676629       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905684676629       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684680875       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684687754       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905684676836       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684681676       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.545655e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.848732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6778e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9611
    reference variance = 0.275351
====================================================
  Execution time = 3.6210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4505e-01
  Total weights = 2.0000e+06
  Execution time = 3.3880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683438
                                         uncertainty =       0.008682053447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683438
                                         uncertainty =       0.008682053447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415358702
  error estimate for blocks of size 2^( 2) =       0.000428055278
  error estimate for blocks of size 2^( 3) =       0.000442036644
  error estimate for blocks of size 2^( 4) =       0.000454420024
  error estimate for blocks of size 2^( 5) =       0.000466267221
  error estimate for blocks of size 2^( 6) =       0.000476288571
  error estimate for blocks of size 2^( 7) =       0.000482427865

      target function =                  N/A
              le_mean =     -16.905563288843
             les_mean =     286.143115643498
             stat err =       0.000469850920
             autocorr =       1.279597949899
              std dev =       0.587405909853
             le_variance =       0.345045702930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683484
                                         uncertainty =       0.008682053451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683484
                                         uncertainty =       0.008682053451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415358702
  error estimate for blocks of size 2^( 2) =       0.000428055278
  error estimate for blocks of size 2^( 3) =       0.000442036644
  error estimate for blocks of size 2^( 4) =       0.000454420024
  error estimate for blocks of size 2^( 5) =       0.000466267221
  error estimate for blocks of size 2^( 6) =       0.000476288571
  error estimate for blocks of size 2^( 7) =       0.000482427865

      target function =                  N/A
              le_mean =     -16.905563288844
             les_mean =     286.143115643576
             stat err =       0.000469850920
             autocorr =       1.279597949818
              std dev =       0.587405909892
             le_variance =       0.345045702976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683461
                                         uncertainty =       0.008682053449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683461
                                         uncertainty =       0.008682053449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415358702
  error estimate for blocks of size 2^( 2) =       0.000428055278
  error estimate for blocks of size 2^( 3) =       0.000442036644
  error estimate for blocks of size 2^( 4) =       0.000454420024
  error estimate for blocks of size 2^( 5) =       0.000466267221
  error estimate for blocks of size 2^( 6) =       0.000476288571
  error estimate for blocks of size 2^( 7) =       0.000482427865

      target function =                  N/A
              le_mean =     -16.905563288844
             les_mean =     286.143115643537
             stat err =       0.000469850920
             autocorr =       1.279597949856
              std dev =       0.587405909873
             le_variance =       0.345045702953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683441
                                         uncertainty =       0.008682053448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345149683441
                                         uncertainty =       0.008682053448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415358702
  error estimate for blocks of size 2^( 2) =       0.000428055278
  error estimate for blocks of size 2^( 3) =       0.000442036644
  error estimate for blocks of size 2^( 4) =       0.000454420024
  error estimate for blocks of size 2^( 5) =       0.000466267221
  error estimate for blocks of size 2^( 6) =       0.000476288571
  error estimate for blocks of size 2^( 7) =       0.000482427865

      target function =                  N/A
              le_mean =     -16.905563288844
             les_mean =     286.143115643503
             stat err =       0.000469850920
             autocorr =       1.279597949880
              std dev =       0.587405909855
             le_variance =       0.345045702933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905563288843        initial
     1.4901e+06     1.4901e+07             2.4730e-10       -16.905563288844  <--
     5.9605e+06     5.9605e+07             6.1825e-11       -16.905563288844
     2.3842e+07     2.3842e+08             1.5457e-11       -16.905563288844

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 5.3214e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.532048
====================================================
  Execution time = 3.8652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613632345
                                         uncertainty =       0.003044493294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338613632345
                                         uncertainty =       0.003044493294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411423323
  error estimate for blocks of size 2^( 2) =       0.000424114880
  error estimate for blocks of size 2^( 3) =       0.000437071834
  error estimate for blocks of size 2^( 4) =       0.000449374593
  error estimate for blocks of size 2^( 5) =       0.000460259786
  error estimate for blocks of size 2^( 6) =       0.000467860118
  error estimate for blocks of size 2^( 7) =       0.000473574670

      target function =                  N/A
              le_mean =     -16.905756117643
             les_mean =     286.143128040647
             stat err =       0.000462767292
             autocorr =       1.265165955306
              std dev =       0.581840442654
             le_variance =       0.338538300708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575611764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756117643       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756117643       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756117643       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756117742       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756117519       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756117601       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756117668       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905756117601       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.137329e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756117643       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756117643       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756117643       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756117639       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756117302       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756116945       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756117719       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905756117934       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.843322e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756117643       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756117643       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756117643       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756117927       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756117485       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756119167       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756117608       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905756115000       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 7.108300e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.851394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8394e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.22506
====================================================
  Execution time = 3.6342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.0000e+06
  Execution time = 3.5870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779849
                                         uncertainty =       0.003670403408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779849
                                         uncertainty =       0.003670403408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411486695
  error estimate for blocks of size 2^( 2) =       0.000423945460
  error estimate for blocks of size 2^( 3) =       0.000437011723
  error estimate for blocks of size 2^( 4) =       0.000449746600
  error estimate for blocks of size 2^( 5) =       0.000460469683
  error estimate for blocks of size 2^( 6) =       0.000468397430
  error estimate for blocks of size 2^( 7) =       0.000474211606

      target function =                  N/A
              le_mean =     -16.905850887640
             les_mean =     286.146436666594
             stat err =       0.000463206330
             autocorr =       1.267177273540
              std dev =       0.581930065204
             le_variance =       0.338642600789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771780099
                                         uncertainty =       0.003670403411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771780099
                                         uncertainty =       0.003670403411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411486695
  error estimate for blocks of size 2^( 2) =       0.000423945460
  error estimate for blocks of size 2^( 3) =       0.000437011723
  error estimate for blocks of size 2^( 4) =       0.000449746600
  error estimate for blocks of size 2^( 5) =       0.000460469683
  error estimate for blocks of size 2^( 6) =       0.000468397430
  error estimate for blocks of size 2^( 7) =       0.000474211606

      target function =                  N/A
              le_mean =     -16.905850887640
             les_mean =     286.146436666830
             stat err =       0.000463206330
             autocorr =       1.267177273249
              std dev =       0.581930065418
             le_variance =       0.338642601038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779974
                                         uncertainty =       0.003670403409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779974
                                         uncertainty =       0.003670403409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411486695
  error estimate for blocks of size 2^( 2) =       0.000423945460
  error estimate for blocks of size 2^( 3) =       0.000437011723
  error estimate for blocks of size 2^( 4) =       0.000449746600
  error estimate for blocks of size 2^( 5) =       0.000460469683
  error estimate for blocks of size 2^( 6) =       0.000468397430
  error estimate for blocks of size 2^( 7) =       0.000474211606

      target function =                  N/A
              le_mean =     -16.905850887640
             les_mean =     286.146436666712
             stat err =       0.000463206330
             autocorr =       1.267177273394
              std dev =       0.581930065311
             le_variance =       0.338642600913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779865
                                         uncertainty =       0.003670403408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771779865
                                         uncertainty =       0.003670403408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411486695
  error estimate for blocks of size 2^( 2) =       0.000423945460
  error estimate for blocks of size 2^( 3) =       0.000437011723
  error estimate for blocks of size 2^( 4) =       0.000449746600
  error estimate for blocks of size 2^( 5) =       0.000460469683
  error estimate for blocks of size 2^( 6) =       0.000468397430
  error estimate for blocks of size 2^( 7) =       0.000474211606

      target function =                  N/A
              le_mean =     -16.905850887640
             les_mean =     286.146436666608
             stat err =       0.000463206330
             autocorr =       1.267177273535
              std dev =       0.581930065217
             le_variance =       0.338642600804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905850887640        initial  <--
     3.7253e+05     3.7253e+06             1.1373e-09       -16.905850887640
     1.4901e+06     1.4901e+07             2.8433e-10       -16.905850887640
     5.9605e+06     5.9605e+07             7.1083e-11       -16.905850887640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9663
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0237e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.204252
====================================================
  Execution time = 3.7006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335619032656
                                         uncertainty =       0.003709004735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335619032656
                                         uncertainty =       0.003709004735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409599281
  error estimate for blocks of size 2^( 2) =       0.000422251295
  error estimate for blocks of size 2^( 3) =       0.000435241026
  error estimate for blocks of size 2^( 4) =       0.000447971157
  error estimate for blocks of size 2^( 5) =       0.000459641633
  error estimate for blocks of size 2^( 6) =       0.000467123000
  error estimate for blocks of size 2^( 7) =       0.000473831697

      target function =                  N/A
              le_mean =     -16.906067730977
             les_mean =     286.150669097908
             stat err =       0.000462141872
             autocorr =       1.273011326980
              std dev =       0.579260857724
             le_variance =       0.335543141291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606773098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067730977       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067730977       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067730977       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067730977       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067730709       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067730798       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067731762       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067730595       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.201172e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067730977       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067730977       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067730977       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067729051       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067733778       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067706502       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067719536       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067737256       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 3.003007e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067730977       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067730977       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067730977       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067747208       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067666148       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067830184       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067736268       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067716434       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 7.506765e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.854049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6867e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825676e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9729
    reference variance = 0.357554
====================================================
  Execution time = 3.6287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3343e-01
  Total weights = 2.0000e+06
  Execution time = 3.3719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766012
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766012
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408307119
  error estimate for blocks of size 2^( 2) =       0.000421185536
  error estimate for blocks of size 2^( 3) =       0.000434632969
  error estimate for blocks of size 2^( 4) =       0.000447206437
  error estimate for blocks of size 2^( 5) =       0.000459202128
  error estimate for blocks of size 2^( 6) =       0.000466601765
  error estimate for blocks of size 2^( 7) =       0.000471467225

      target function =                  N/A
              le_mean =     -16.905685703116
             les_mean =     286.135638333218
             stat err =       0.000461119389
             autocorr =       1.275418939856
              std dev =       0.577433465772
             le_variance =       0.333429407394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766030
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766030
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408307119
  error estimate for blocks of size 2^( 2) =       0.000421185536
  error estimate for blocks of size 2^( 3) =       0.000434632969
  error estimate for blocks of size 2^( 4) =       0.000447206437
  error estimate for blocks of size 2^( 5) =       0.000459202128
  error estimate for blocks of size 2^( 6) =       0.000466601765
  error estimate for blocks of size 2^( 7) =       0.000471467225

      target function =                  N/A
              le_mean =     -16.905685703116
             les_mean =     286.135638333250
             stat err =       0.000461119389
             autocorr =       1.275418939824
              std dev =       0.577433465788
             le_variance =       0.333429407412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766021
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766021
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408307119
  error estimate for blocks of size 2^( 2) =       0.000421185536
  error estimate for blocks of size 2^( 3) =       0.000434632969
  error estimate for blocks of size 2^( 4) =       0.000447206437
  error estimate for blocks of size 2^( 5) =       0.000459202128
  error estimate for blocks of size 2^( 6) =       0.000466601765
  error estimate for blocks of size 2^( 7) =       0.000471467225

      target function =                  N/A
              le_mean =     -16.905685703116
             les_mean =     286.135638333234
             stat err =       0.000461119389
             autocorr =       1.275418939842
              std dev =       0.577433465780
             le_variance =       0.333429407403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766013
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333501766013
                                         uncertainty =       0.003046921259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408307119
  error estimate for blocks of size 2^( 2) =       0.000421185536
  error estimate for blocks of size 2^( 3) =       0.000434632969
  error estimate for blocks of size 2^( 4) =       0.000447206437
  error estimate for blocks of size 2^( 5) =       0.000459202128
  error estimate for blocks of size 2^( 6) =       0.000466601765
  error estimate for blocks of size 2^( 7) =       0.000471467225

      target function =                  N/A
              le_mean =     -16.905685703116
             les_mean =     286.135638333220
             stat err =       0.000461119389
             autocorr =       1.275418939859
              std dev =       0.577433465773
             le_variance =       0.333429407395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905685703116        initial
     3.7253e+06     3.7253e+07             1.2012e-10       -16.905685703116  <--
     1.4901e+07     1.4901e+08             3.0030e-11       -16.905685703116
     5.9605e+07     5.9605e+08             7.5068e-12       -16.905685703116

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 5.3260e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0013e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.826
    reference variance = 0.171394
====================================================
  Execution time = 3.6585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3110e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331147232656
                                         uncertainty =       0.003778374504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331147232656
                                         uncertainty =       0.003778374504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406875620
  error estimate for blocks of size 2^( 2) =       0.000419279250
  error estimate for blocks of size 2^( 3) =       0.000432770373
  error estimate for blocks of size 2^( 4) =       0.000444053586
  error estimate for blocks of size 2^( 5) =       0.000453443642
  error estimate for blocks of size 2^( 6) =       0.000460461084
  error estimate for blocks of size 2^( 7) =       0.000464393111

      target function =                  N/A
              le_mean =     -16.905303018165
             les_mean =     286.120365510533
             stat err =       0.000455587856
             autocorr =       1.253778859337
              std dev =       0.575409019831
             le_variance =       0.331095540103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530301816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905303018165       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905303018166       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905303018166       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905303018142       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905303018152       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905303019554       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905303019407       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905303018367       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 4.731544e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905303018165       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905303018165       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905303018165       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905303018208       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905303020016       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905303017741       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905303013190       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905303019395       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.182891e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905303018165       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905303018165       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905303018165       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905303018165       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905303018476       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905303018061       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905303014523       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905303010270       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.957226e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.856675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6477e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8242
    reference variance = 0.236992
====================================================
  Execution time = 3.6382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3495e-01
  Total weights = 2.0000e+06
  Execution time = 3.3718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415242
                                         uncertainty =       0.003041665029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415242
                                         uncertainty =       0.003041665029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409236132
  error estimate for blocks of size 2^( 2) =       0.000421646526
  error estimate for blocks of size 2^( 3) =       0.000434779872
  error estimate for blocks of size 2^( 4) =       0.000446747767
  error estimate for blocks of size 2^( 5) =       0.000456683876
  error estimate for blocks of size 2^( 6) =       0.000463223973
  error estimate for blocks of size 2^( 7) =       0.000469370901

      target function =                  N/A
              le_mean =     -16.905611088970
             les_mean =     286.134634547273
             stat err =       0.000459006629
             autocorr =       1.258027033933
              std dev =       0.578747287879
             le_variance =       0.334948423227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415340
                                         uncertainty =       0.003041665031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415340
                                         uncertainty =       0.003041665031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409236132
  error estimate for blocks of size 2^( 2) =       0.000421646526
  error estimate for blocks of size 2^( 3) =       0.000434779872
  error estimate for blocks of size 2^( 4) =       0.000446747767
  error estimate for blocks of size 2^( 5) =       0.000456683876
  error estimate for blocks of size 2^( 6) =       0.000463223974
  error estimate for blocks of size 2^( 7) =       0.000469370901

      target function =                  N/A
              le_mean =     -16.905611088970
             les_mean =     286.134634547352
             stat err =       0.000459006629
             autocorr =       1.258027033778
              std dev =       0.578747287964
             le_variance =       0.334948423325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415291
                                         uncertainty =       0.003041665030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415291
                                         uncertainty =       0.003041665030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409236132
  error estimate for blocks of size 2^( 2) =       0.000421646526
  error estimate for blocks of size 2^( 3) =       0.000434779872
  error estimate for blocks of size 2^( 4) =       0.000446747767
  error estimate for blocks of size 2^( 5) =       0.000456683876
  error estimate for blocks of size 2^( 6) =       0.000463223973
  error estimate for blocks of size 2^( 7) =       0.000469370901

      target function =                  N/A
              le_mean =     -16.905611088970
             les_mean =     286.134634547312
             stat err =       0.000459006629
             autocorr =       1.258027033856
              std dev =       0.578747287921
             le_variance =       0.334948423276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415248
                                         uncertainty =       0.003041665029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334980415248
                                         uncertainty =       0.003041665029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409236132
  error estimate for blocks of size 2^( 2) =       0.000421646526
  error estimate for blocks of size 2^( 3) =       0.000434779872
  error estimate for blocks of size 2^( 4) =       0.000446747767
  error estimate for blocks of size 2^( 5) =       0.000456683876
  error estimate for blocks of size 2^( 6) =       0.000463223973
  error estimate for blocks of size 2^( 7) =       0.000469370901

      target function =                  N/A
              le_mean =     -16.905611088970
             les_mean =     286.134634547278
             stat err =       0.000459006629
             autocorr =       1.258027033929
              std dev =       0.578747287884
             le_variance =       0.334948423233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905611088970        initial  <--
     9.3132e+05     9.3132e+06             4.7315e-10       -16.905611088970
     3.7253e+06     3.7253e+07             1.1829e-10       -16.905611088970
     1.4901e+07     1.4901e+08             2.9572e-11       -16.905611088970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3662
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.892
    reference variance = 0.269865
====================================================
  Execution time = 3.8521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339750980590
                                         uncertainty =       0.003997430003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339750980590
                                         uncertainty =       0.003997430003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412130136
  error estimate for blocks of size 2^( 2) =       0.000425157198
  error estimate for blocks of size 2^( 3) =       0.000439052045
  error estimate for blocks of size 2^( 4) =       0.000451881939
  error estimate for blocks of size 2^( 5) =       0.000463001846
  error estimate for blocks of size 2^( 6) =       0.000471015888
  error estimate for blocks of size 2^( 7) =       0.000472301004

      target function =                  N/A
              le_mean =     -16.904418899678
             les_mean =     286.099080664549
             stat err =       0.000464550169
             autocorr =       1.270563865665
              std dev =       0.582840028310
             le_variance =       0.339702498600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690441889968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418899678       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418899678       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418899678       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418899755       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904418897421       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904418900456       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904418896361       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904418901890       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.973023e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418899678       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418899678       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418899678       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418903723       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904418915966       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904418901613       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904418912578       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904418891942       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 9.932172e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418899678       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418899678       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418899678       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418812843       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904418928350       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904418881092       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904418852719       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904418841750       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.483316e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.859321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8422e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.179716
====================================================
  Execution time = 3.7190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6556e-01
  Total weights = 2.0000e+06
  Execution time = 3.5287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725399
                                         uncertainty =       0.032135304624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725399
                                         uncertainty =       0.032135304624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427527333
  error estimate for blocks of size 2^( 2) =       0.000439967864
  error estimate for blocks of size 2^( 3) =       0.000453065865
  error estimate for blocks of size 2^( 4) =       0.000464791924
  error estimate for blocks of size 2^( 5) =       0.000475016176
  error estimate for blocks of size 2^( 6) =       0.000483446862
  error estimate for blocks of size 2^( 7) =       0.000489762111

      target function =                  N/A
              le_mean =     -16.905700750440
             les_mean =     286.168276921893
             stat err =       0.000478254268
             autocorr =       1.251382098468
              std dev =       0.604614952885
             le_variance =       0.365559241252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725442
                                         uncertainty =       0.032135304632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725442
                                         uncertainty =       0.032135304632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427527333
  error estimate for blocks of size 2^( 2) =       0.000439967864
  error estimate for blocks of size 2^( 3) =       0.000453065865
  error estimate for blocks of size 2^( 4) =       0.000464791924
  error estimate for blocks of size 2^( 5) =       0.000475016176
  error estimate for blocks of size 2^( 6) =       0.000483446862
  error estimate for blocks of size 2^( 7) =       0.000489762111

      target function =                  N/A
              le_mean =     -16.905700750440
             les_mean =     286.168276921939
             stat err =       0.000478254268
             autocorr =       1.251382098418
              std dev =       0.604614952920
             le_variance =       0.365559241294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725421
                                         uncertainty =       0.032135304628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725421
                                         uncertainty =       0.032135304628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427527333
  error estimate for blocks of size 2^( 2) =       0.000439967864
  error estimate for blocks of size 2^( 3) =       0.000453065865
  error estimate for blocks of size 2^( 4) =       0.000464791924
  error estimate for blocks of size 2^( 5) =       0.000475016176
  error estimate for blocks of size 2^( 6) =       0.000483446862
  error estimate for blocks of size 2^( 7) =       0.000489762111

      target function =                  N/A
              le_mean =     -16.905700750440
             les_mean =     286.168276921916
             stat err =       0.000478254268
             autocorr =       1.251382098448
              std dev =       0.604614952903
             le_variance =       0.365559241273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725402
                                         uncertainty =       0.032135304624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365585725402
                                         uncertainty =       0.032135304624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427527333
  error estimate for blocks of size 2^( 2) =       0.000439967864
  error estimate for blocks of size 2^( 3) =       0.000453065865
  error estimate for blocks of size 2^( 4) =       0.000464791924
  error estimate for blocks of size 2^( 5) =       0.000475016176
  error estimate for blocks of size 2^( 6) =       0.000483446862
  error estimate for blocks of size 2^( 7) =       0.000489762111

      target function =                  N/A
              le_mean =     -16.905700750440
             les_mean =     286.168276921896
             stat err =       0.000478254268
             autocorr =       1.251382098470
              std dev =       0.604614952887
             le_variance =       0.365559241255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905700750440        initial
     9.3132e+06     9.3132e+07             3.9730e-11       -16.905700750440  <--
     3.7253e+07     3.7253e+08             9.9322e-12       -16.905700750440
     1.4901e+08     1.4901e+09             2.4833e-12       -16.905700750440

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 5.4328e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0276e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9553
    reference variance = 0.201882
====================================================
  Execution time = 3.6708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335362365201
                                         uncertainty =       0.003588965106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335362365201
                                         uncertainty =       0.003588965106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409467996
  error estimate for blocks of size 2^( 2) =       0.000422283932
  error estimate for blocks of size 2^( 3) =       0.000435452860
  error estimate for blocks of size 2^( 4) =       0.000447321619
  error estimate for blocks of size 2^( 5) =       0.000457725757
  error estimate for blocks of size 2^( 6) =       0.000466482211
  error estimate for blocks of size 2^( 7) =       0.000471439348

      target function =                  N/A
              le_mean =     -16.905013589268
             les_mean =     286.114812364892
             stat err =       0.000460742234
             autocorr =       1.266123651397
              std dev =       0.579075193063
             le_variance =       0.335328079221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690501358927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905013589268       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905013589268       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905013589268       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905013589268       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905013589899       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905013589300       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905013587695       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905013591884       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.510448e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905013589268       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905013589268       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905013589268       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905013589268       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905013589729       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905013586282       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905013586175       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905013582108       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.776122e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905013589268       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905013589268       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905013589268       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905013589268       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905013591093       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905013591464       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905013546551       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905013528183       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 9.440496e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.862027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6582e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9845
    reference variance = 0.420776
====================================================
  Execution time = 3.6063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3163e-01
  Total weights = 2.0000e+06
  Execution time = 3.3831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572387
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572387
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407201100
  error estimate for blocks of size 2^( 2) =       0.000419934062
  error estimate for blocks of size 2^( 3) =       0.000433330030
  error estimate for blocks of size 2^( 4) =       0.000446142116
  error estimate for blocks of size 2^( 5) =       0.000455602137
  error estimate for blocks of size 2^( 6) =       0.000465579925
  error estimate for blocks of size 2^( 7) =       0.000470898266

      target function =                  N/A
              le_mean =     -16.905735082532
             les_mean =     286.135503986543
             stat err =       0.000459555611
             autocorr =       1.273673934613
              std dev =       0.575869318156
             le_variance =       0.331625471594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572427
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572427
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407201100
  error estimate for blocks of size 2^( 2) =       0.000419934062
  error estimate for blocks of size 2^( 3) =       0.000433330030
  error estimate for blocks of size 2^( 4) =       0.000446142116
  error estimate for blocks of size 2^( 5) =       0.000455602137
  error estimate for blocks of size 2^( 6) =       0.000465579925
  error estimate for blocks of size 2^( 7) =       0.000470898266

      target function =                  N/A
              le_mean =     -16.905735082532
             les_mean =     286.135503986580
             stat err =       0.000459555611
             autocorr =       1.273673934559
              std dev =       0.575869318191
             le_variance =       0.331625471633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572407
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572407
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407201100
  error estimate for blocks of size 2^( 2) =       0.000419934062
  error estimate for blocks of size 2^( 3) =       0.000433330030
  error estimate for blocks of size 2^( 4) =       0.000446142116
  error estimate for blocks of size 2^( 5) =       0.000455602137
  error estimate for blocks of size 2^( 6) =       0.000465579925
  error estimate for blocks of size 2^( 7) =       0.000470898266

      target function =                  N/A
              le_mean =     -16.905735082532
             les_mean =     286.135503986562
             stat err =       0.000459555611
             autocorr =       1.273673934585
              std dev =       0.575869318174
             le_variance =       0.331625471614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572390
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331697572390
                                         uncertainty =       0.002664406002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407201100
  error estimate for blocks of size 2^( 2) =       0.000419934062
  error estimate for blocks of size 2^( 3) =       0.000433330030
  error estimate for blocks of size 2^( 4) =       0.000446142116
  error estimate for blocks of size 2^( 5) =       0.000455602137
  error estimate for blocks of size 2^( 6) =       0.000465579925
  error estimate for blocks of size 2^( 7) =       0.000470898266

      target function =                  N/A
              le_mean =     -16.905735082532
             les_mean =     286.135503986545
             stat err =       0.000459555611
             autocorr =       1.273673934609
              std dev =       0.575869318159
             le_variance =       0.331625471596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905735082532        initial  <--
     2.3283e+06     2.3283e+07             1.5104e-10       -16.905735082532
     9.3132e+06     9.3132e+07             3.7761e-11       -16.905735082532
     3.7253e+07     3.7253e+08             9.4405e-12       -16.905735082532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0492
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9349
    reference variance = 0.25135
====================================================
  Execution time = 3.6396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333490295291
                                         uncertainty =       0.002642171914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333490295291
                                         uncertainty =       0.002642171914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390564
  error estimate for blocks of size 2^( 2) =       0.000421182410
  error estimate for blocks of size 2^( 3) =       0.000434206776
  error estimate for blocks of size 2^( 4) =       0.000445168393
  error estimate for blocks of size 2^( 5) =       0.000455428190
  error estimate for blocks of size 2^( 6) =       0.000462208345
  error estimate for blocks of size 2^( 7) =       0.000467555260

      target function =                  N/A
              le_mean =     -16.905547074032
             les_mean =     286.131087410641
             stat err =       0.000457590047
             autocorr =       1.255456708300
              std dev =       0.577551474007
             le_variance =       0.333565705128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554707403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547074032       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547074032       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547074032       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547074032       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547074116       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547074032       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547078578       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547075157       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.411482e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547074032       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547074032       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547074032       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547075568       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547047926       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547098846       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905546968358       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547060496       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.528173e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547074032       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547074032       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547074032       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547074032       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547074032       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547074191       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547103162       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547119515       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.821977e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.864693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6157e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8741
    reference variance = 0.239564
====================================================
  Execution time = 3.6374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.0000e+06
  Execution time = 3.3674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531298
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531298
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558418
  error estimate for blocks of size 2^( 2) =       0.000422447920
  error estimate for blocks of size 2^( 3) =       0.000435440346
  error estimate for blocks of size 2^( 4) =       0.000447908524
  error estimate for blocks of size 2^( 5) =       0.000459360149
  error estimate for blocks of size 2^( 6) =       0.000466481642
  error estimate for blocks of size 2^( 7) =       0.000474505162

      target function =                  N/A
              le_mean =     -16.905529386968
             les_mean =     286.132399881277
             stat err =       0.000462063870
             autocorr =       1.272835584409
              std dev =       0.579203069209
             le_variance =       0.335476195381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531304
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531304
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558418
  error estimate for blocks of size 2^( 2) =       0.000422447920
  error estimate for blocks of size 2^( 3) =       0.000435440346
  error estimate for blocks of size 2^( 4) =       0.000447908524
  error estimate for blocks of size 2^( 5) =       0.000459360149
  error estimate for blocks of size 2^( 6) =       0.000466481642
  error estimate for blocks of size 2^( 7) =       0.000474505162

      target function =                  N/A
              le_mean =     -16.905529386968
             les_mean =     286.132399881283
             stat err =       0.000462063870
             autocorr =       1.272835584395
              std dev =       0.579203069213
             le_variance =       0.335476195386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531301
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531301
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558418
  error estimate for blocks of size 2^( 2) =       0.000422447920
  error estimate for blocks of size 2^( 3) =       0.000435440346
  error estimate for blocks of size 2^( 4) =       0.000447908524
  error estimate for blocks of size 2^( 5) =       0.000459360149
  error estimate for blocks of size 2^( 6) =       0.000466481642
  error estimate for blocks of size 2^( 7) =       0.000474505162

      target function =                  N/A
              le_mean =     -16.905529386968
             les_mean =     286.132399881280
             stat err =       0.000462063870
             autocorr =       1.272835584400
              std dev =       0.579203069211
             le_variance =       0.335476195383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531299
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469531299
                                         uncertainty =       0.003503790826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558418
  error estimate for blocks of size 2^( 2) =       0.000422447920
  error estimate for blocks of size 2^( 3) =       0.000435440346
  error estimate for blocks of size 2^( 4) =       0.000447908524
  error estimate for blocks of size 2^( 5) =       0.000459360149
  error estimate for blocks of size 2^( 6) =       0.000466481642
  error estimate for blocks of size 2^( 7) =       0.000474505162

      target function =                  N/A
              le_mean =     -16.905529386968
             les_mean =     286.132399881277
             stat err =       0.000462063870
             autocorr =       1.272835584400
              std dev =       0.579203069209
             le_variance =       0.335476195381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905529386968        initial
     2.3283e+07     2.3283e+08             1.4115e-11       -16.905529386968
     9.3132e+07     9.3132e+08             3.5282e-12       -16.905529386968  <--
     3.7253e+08     3.7253e+09             8.8220e-13       -16.905529386968

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 5.3332e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8757
    reference variance = 0.214427
====================================================
  Execution time = 3.9106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4051e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340294321628
                                         uncertainty =       0.004976894771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340294321628
                                         uncertainty =       0.004976894771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412617862
  error estimate for blocks of size 2^( 2) =       0.000425332644
  error estimate for blocks of size 2^( 3) =       0.000438261656
  error estimate for blocks of size 2^( 4) =       0.000450210703
  error estimate for blocks of size 2^( 5) =       0.000461347615
  error estimate for blocks of size 2^( 6) =       0.000469778106
  error estimate for blocks of size 2^( 7) =       0.000477117289

      target function =                  N/A
              le_mean =     -16.904910053408
             les_mean =     286.116490743499
             stat err =       0.000464613428
             autocorr =       1.267907196661
              std dev =       0.583529776404
             le_variance =       0.340506999951


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690491005341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904910053408       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904910053408       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904910053408       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904910050830       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904910049672       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904910050529       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904910057379       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904910053290       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.799018e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904910053408       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904910053408       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904910053408       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904910078143       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904910074819       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904909926277       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904910108192       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904910067466       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 4.497482e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904910053408       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904910053408       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904910053408       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904910053408       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904910061337       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904909998239       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904909929225       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904910129340       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.124426e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.867333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8969e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8804
    reference variance = 0.219447
====================================================
  Execution time = 3.8275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4274e-01
  Total weights = 2.0000e+06
  Execution time = 3.5271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118035
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118035
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413970166
  error estimate for blocks of size 2^( 2) =       0.000426948395
  error estimate for blocks of size 2^( 3) =       0.000440599286
  error estimate for blocks of size 2^( 4) =       0.000453552322
  error estimate for blocks of size 2^( 5) =       0.000465064114
  error estimate for blocks of size 2^( 6) =       0.000472897125
  error estimate for blocks of size 2^( 7) =       0.000479299553

      target function =                  N/A
              le_mean =     -16.905010009905
             les_mean =     286.122105859924
             stat err =       0.000467703279
             autocorr =       1.276446869028
              std dev =       0.585442222863
             le_variance =       0.342742596311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118045
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118045
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413970166
  error estimate for blocks of size 2^( 2) =       0.000426948395
  error estimate for blocks of size 2^( 3) =       0.000440599286
  error estimate for blocks of size 2^( 4) =       0.000453552322
  error estimate for blocks of size 2^( 5) =       0.000465064114
  error estimate for blocks of size 2^( 6) =       0.000472897125
  error estimate for blocks of size 2^( 7) =       0.000479299553

      target function =                  N/A
              le_mean =     -16.905010009905
             les_mean =     286.122105859935
             stat err =       0.000467703279
             autocorr =       1.276446869024
              std dev =       0.585442222872
             le_variance =       0.342742596321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118040
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118040
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413970166
  error estimate for blocks of size 2^( 2) =       0.000426948395
  error estimate for blocks of size 2^( 3) =       0.000440599286
  error estimate for blocks of size 2^( 4) =       0.000453552322
  error estimate for blocks of size 2^( 5) =       0.000465064114
  error estimate for blocks of size 2^( 6) =       0.000472897125
  error estimate for blocks of size 2^( 7) =       0.000479299553

      target function =                  N/A
              le_mean =     -16.905010009905
             les_mean =     286.122105859930
             stat err =       0.000467703279
             autocorr =       1.276446869031
              std dev =       0.585442222868
             le_variance =       0.342742596316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118036
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342765118036
                                         uncertainty =       0.008418924017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413970166
  error estimate for blocks of size 2^( 2) =       0.000426948395
  error estimate for blocks of size 2^( 3) =       0.000440599286
  error estimate for blocks of size 2^( 4) =       0.000453552322
  error estimate for blocks of size 2^( 5) =       0.000465064114
  error estimate for blocks of size 2^( 6) =       0.000472897125
  error estimate for blocks of size 2^( 7) =       0.000479299553

      target function =                  N/A
              le_mean =     -16.905010009905
             les_mean =     286.122105859925
             stat err =       0.000467703279
             autocorr =       1.276446869030
              std dev =       0.585442222864
             le_variance =       0.342742596312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905010009905        initial  <--
     2.3283e+07     2.3283e+08             1.7990e-11       -16.905010009905
     9.3132e+07     9.3132e+08             4.4975e-12       -16.905010009905
     3.7253e+08     3.7253e+09             1.1244e-12       -16.905010009905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.4411
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0442e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.165709
====================================================
  Execution time = 3.6417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3697e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336976983867
                                         uncertainty =       0.003533641444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336976983867
                                         uncertainty =       0.003533641444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410471209
  error estimate for blocks of size 2^( 2) =       0.000423674852
  error estimate for blocks of size 2^( 3) =       0.000437269137
  error estimate for blocks of size 2^( 4) =       0.000450300842
  error estimate for blocks of size 2^( 5) =       0.000462237773
  error estimate for blocks of size 2^( 6) =       0.000469909251
  error estimate for blocks of size 2^( 7) =       0.000475967450

      target function =                  N/A
              le_mean =     -16.905177955675
             les_mean =     286.122014772073
             stat err =       0.000464603829
             autocorr =       1.281150549450
              std dev =       0.580493951332
             le_variance =       0.336973227533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690517795567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177955675       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905177955675       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905177955675       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905177947233       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905177932877       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905177999930       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905177957008       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905177996701       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.555464e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177955675       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905177955675       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905177955675       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905177986141       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905178125128       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905177917068       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905179076624       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905177456184       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 3.892030e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177955675       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905177955675       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905177955675       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905177976851       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905173337980       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905176143391       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905179819517       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905178703121       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 9.722389e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.869980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6233e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.128032
====================================================
  Execution time = 3.6216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4169e-01
  Total weights = 2.0000e+06
  Execution time = 3.3682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555464
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555464
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413332131
  error estimate for blocks of size 2^( 2) =       0.000426041468
  error estimate for blocks of size 2^( 3) =       0.000439791990
  error estimate for blocks of size 2^( 4) =       0.000453324302
  error estimate for blocks of size 2^( 5) =       0.000465000549
  error estimate for blocks of size 2^( 6) =       0.000472544525
  error estimate for blocks of size 2^( 7) =       0.000479640630

      target function =                  N/A
              le_mean =     -16.905197917772
             les_mean =     286.127403368817
             stat err =       0.000467627502
             autocorr =       1.279975790360
              std dev =       0.584539905081
             le_variance =       0.341686900632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413332131
  error estimate for blocks of size 2^( 2) =       0.000426041468
  error estimate for blocks of size 2^( 3) =       0.000439791990
  error estimate for blocks of size 2^( 4) =       0.000453324302
  error estimate for blocks of size 2^( 5) =       0.000465000549
  error estimate for blocks of size 2^( 6) =       0.000472544525
  error estimate for blocks of size 2^( 7) =       0.000479640630

      target function =                  N/A
              le_mean =     -16.905197917772
             les_mean =     286.127403368818
             stat err =       0.000467627502
             autocorr =       1.279975790362
              std dev =       0.584539905082
             le_variance =       0.341686900633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413332131
  error estimate for blocks of size 2^( 2) =       0.000426041468
  error estimate for blocks of size 2^( 3) =       0.000439791990
  error estimate for blocks of size 2^( 4) =       0.000453324302
  error estimate for blocks of size 2^( 5) =       0.000465000549
  error estimate for blocks of size 2^( 6) =       0.000472544525
  error estimate for blocks of size 2^( 7) =       0.000479640630

      target function =                  N/A
              le_mean =     -16.905197917772
             les_mean =     286.127403368818
             stat err =       0.000467627502
             autocorr =       1.279975790360
              std dev =       0.584539905081
             le_variance =       0.341686900633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341715555465
                                         uncertainty =       0.007864579834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413332131
  error estimate for blocks of size 2^( 2) =       0.000426041468
  error estimate for blocks of size 2^( 3) =       0.000439791990
  error estimate for blocks of size 2^( 4) =       0.000453324302
  error estimate for blocks of size 2^( 5) =       0.000465000549
  error estimate for blocks of size 2^( 6) =       0.000472544525
  error estimate for blocks of size 2^( 7) =       0.000479640630

      target function =                  N/A
              le_mean =     -16.905197917772
             les_mean =     286.127403368817
             stat err =       0.000467627502
             autocorr =       1.279975790367
              std dev =       0.584539905081
             le_variance =       0.341686900632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905197917772        initial
     2.3283e+08     2.3283e+09             1.5555e-12       -16.905197917772  <--
     9.3132e+08     9.3132e+09             3.8920e-13       -16.905197917772
     3.7253e+09     3.7253e+10             9.7224e-14       -16.905197917772

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 5.3205e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.199514
====================================================
  Execution time = 3.6647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335591087302
                                         uncertainty =       0.004036654431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335591087302
                                         uncertainty =       0.004036654431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409612772
  error estimate for blocks of size 2^( 2) =       0.000422430882
  error estimate for blocks of size 2^( 3) =       0.000435772164
  error estimate for blocks of size 2^( 4) =       0.000448172876
  error estimate for blocks of size 2^( 5) =       0.000459508262
  error estimate for blocks of size 2^( 6) =       0.000468342432
  error estimate for blocks of size 2^( 7) =       0.000475600280

      target function =                  N/A
              le_mean =     -16.905159502887
             les_mean =     286.119982896520
             stat err =       0.000462905962
             autocorr =       1.277140183143
              std dev =       0.579279937712
             le_variance =       0.335565246236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690515950289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905159502887       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905159502887       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905159502888       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905159502888       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905159502888       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905159502888       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905159520805       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905159459341       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 7.181052e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905159502887       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905159502887       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905159502887       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905159499266       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905159360735       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905159519509       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905159521456       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905159743256       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.795297e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905159502887       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905159502887       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905159502887       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905159502887       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905159494228       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905159443295       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905159908333       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905159931046       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 4.488308e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.872656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6554e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8158
    reference variance = 0.308237
====================================================
  Execution time = 3.6211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.0000e+06
  Execution time = 3.3643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232458
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232458
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410909319
  error estimate for blocks of size 2^( 2) =       0.000423399936
  error estimate for blocks of size 2^( 3) =       0.000436574247
  error estimate for blocks of size 2^( 4) =       0.000448309907
  error estimate for blocks of size 2^( 5) =       0.000459216478
  error estimate for blocks of size 2^( 6) =       0.000465384264
  error estimate for blocks of size 2^( 7) =       0.000470017248

      target function =                  N/A
              le_mean =     -16.905182407597
             les_mean =     286.122885002258
             stat err =       0.000460731974
             autocorr =       1.257201018466
              std dev =       0.581113531907
             le_variance =       0.337692936966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232461
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232461
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410909319
  error estimate for blocks of size 2^( 2) =       0.000423399936
  error estimate for blocks of size 2^( 3) =       0.000436574247
  error estimate for blocks of size 2^( 4) =       0.000448309907
  error estimate for blocks of size 2^( 5) =       0.000459216478
  error estimate for blocks of size 2^( 6) =       0.000465384264
  error estimate for blocks of size 2^( 7) =       0.000470017248

      target function =                  N/A
              le_mean =     -16.905182407597
             les_mean =     286.122885002260
             stat err =       0.000460731974
             autocorr =       1.257201018467
              std dev =       0.581113531909
             le_variance =       0.337692936968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232460
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232460
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410909319
  error estimate for blocks of size 2^( 2) =       0.000423399936
  error estimate for blocks of size 2^( 3) =       0.000436574247
  error estimate for blocks of size 2^( 4) =       0.000448309907
  error estimate for blocks of size 2^( 5) =       0.000459216478
  error estimate for blocks of size 2^( 6) =       0.000465384264
  error estimate for blocks of size 2^( 7) =       0.000470017248

      target function =                  N/A
              le_mean =     -16.905182407597
             les_mean =     286.122885002259
             stat err =       0.000460731974
             autocorr =       1.257201018472
              std dev =       0.581113531908
             le_variance =       0.337692936967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232459
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757232459
                                         uncertainty =       0.003698439940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410909319
  error estimate for blocks of size 2^( 2) =       0.000423399936
  error estimate for blocks of size 2^( 3) =       0.000436574247
  error estimate for blocks of size 2^( 4) =       0.000448309907
  error estimate for blocks of size 2^( 5) =       0.000459216478
  error estimate for blocks of size 2^( 6) =       0.000465384264
  error estimate for blocks of size 2^( 7) =       0.000470017248

      target function =                  N/A
              le_mean =     -16.905182407597
             les_mean =     286.122885002258
             stat err =       0.000460731974
             autocorr =       1.257201018472
              std dev =       0.581113531907
             le_variance =       0.337692936966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905182407597        initial
     5.8208e+07     5.8208e+08             7.1811e-12       -16.905182407597
     2.3283e+08     2.3283e+09             1.7953e-12       -16.905182407597
     9.3132e+08     9.3132e+09             4.4883e-13       -16.905182407597  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+08     and shift_s =   9.3132e+09
*****************************************************************************

  Execution time = 5.3211e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9192
    reference variance = 0.204024
====================================================
  Execution time = 3.9222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334953743959
                                         uncertainty =       0.004281794567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334953743959
                                         uncertainty =       0.004281794567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409211249
  error estimate for blocks of size 2^( 2) =       0.000422019821
  error estimate for blocks of size 2^( 3) =       0.000435711531
  error estimate for blocks of size 2^( 4) =       0.000448556279
  error estimate for blocks of size 2^( 5) =       0.000460282611
  error estimate for blocks of size 2^( 6) =       0.000468249630
  error estimate for blocks of size 2^( 7) =       0.000475240530

      target function =                  N/A
              le_mean =     -16.905476753768
             les_mean =     286.130051797259
             stat err =       0.000463082263
             autocorr =       1.280622611875
              std dev =       0.578712098139
             le_variance =       0.334907692532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547675377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476753768       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476753768       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476753768       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476725396       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476746428       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905476498387       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476647302       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905476767898       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.880483e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476753768       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476753768       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476753768       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476745432       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476951475       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905477204096       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476769642       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905476011376       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 4.699865e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476753768       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476753768       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476753768       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476753768       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476753768       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905478562398       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476915308       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905479238553       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 1.174289e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.878810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9159e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.837
    reference variance = 0.27087
====================================================
  Execution time = 3.8820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.0000e+06
  Execution time = 3.3841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206989
  error estimate for blocks of size 2^( 2) =       0.000422145265
  error estimate for blocks of size 2^( 3) =       0.000435213728
  error estimate for blocks of size 2^( 4) =       0.000448276350
  error estimate for blocks of size 2^( 5) =       0.000459550711
  error estimate for blocks of size 2^( 6) =       0.000468015601
  error estimate for blocks of size 2^( 7) =       0.000475843305

      target function =                  N/A
              le_mean =     -16.905281022828
             les_mean =     286.123427012717
             stat err =       0.000462921492
             autocorr =       1.279760211087
              std dev =       0.578706073385
             le_variance =       0.334900719373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206989
  error estimate for blocks of size 2^( 2) =       0.000422145265
  error estimate for blocks of size 2^( 3) =       0.000435213728
  error estimate for blocks of size 2^( 4) =       0.000448276350
  error estimate for blocks of size 2^( 5) =       0.000459550711
  error estimate for blocks of size 2^( 6) =       0.000468015601
  error estimate for blocks of size 2^( 7) =       0.000475843305

      target function =                  N/A
              le_mean =     -16.905281022828
             les_mean =     286.123427012717
             stat err =       0.000462921492
             autocorr =       1.279760211090
              std dev =       0.578706073386
             le_variance =       0.334900719374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206989
  error estimate for blocks of size 2^( 2) =       0.000422145265
  error estimate for blocks of size 2^( 3) =       0.000435213728
  error estimate for blocks of size 2^( 4) =       0.000448276350
  error estimate for blocks of size 2^( 5) =       0.000459550711
  error estimate for blocks of size 2^( 6) =       0.000468015601
  error estimate for blocks of size 2^( 7) =       0.000475843305

      target function =                  N/A
              le_mean =     -16.905281022828
             les_mean =     286.123427012717
             stat err =       0.000462921492
             autocorr =       1.279760211085
              std dev =       0.578706073386
             le_variance =       0.334900719374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334878357532
                                         uncertainty =       0.003465854483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206989
  error estimate for blocks of size 2^( 2) =       0.000422145265
  error estimate for blocks of size 2^( 3) =       0.000435213728
  error estimate for blocks of size 2^( 4) =       0.000448276350
  error estimate for blocks of size 2^( 5) =       0.000459550711
  error estimate for blocks of size 2^( 6) =       0.000468015601
  error estimate for blocks of size 2^( 7) =       0.000475843305

      target function =                  N/A
              le_mean =     -16.905281022828
             les_mean =     286.123427012717
             stat err =       0.000462921492
             autocorr =       1.279760211089
              std dev =       0.578706073385
             le_variance =       0.334900719373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905281022828        initial  <--
     2.3283e+08     2.3283e+09             1.8805e-12       -16.905281022828
     9.3132e+08     9.3132e+09             4.6999e-13       -16.905281022828
     3.7253e+09     3.7253e+10             1.1743e-13       -16.905281022828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.8589
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0503e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.327463
====================================================
  Execution time = 3.6569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339653979541
                                         uncertainty =       0.006651515696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339653979541
                                         uncertainty =       0.006651515696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412135103
  error estimate for blocks of size 2^( 2) =       0.000424090933
  error estimate for blocks of size 2^( 3) =       0.000436566007
  error estimate for blocks of size 2^( 4) =       0.000448637348
  error estimate for blocks of size 2^( 5) =       0.000458285314
  error estimate for blocks of size 2^( 6) =       0.000465115969
  error estimate for blocks of size 2^( 7) =       0.000468532476

      target function =                  N/A
              le_mean =     -16.905611671724
             les_mean =     286.139416511794
             stat err =       0.000460142777
             autocorr =       1.246539384730
              std dev =       0.582847052416
             le_variance =       0.339710686510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561167172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611671724       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611671724       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611671724       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611671724       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611671724       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610627649       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611137411       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612228225       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.878517e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611671724       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611671724       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611671724       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905610046418       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905616119924       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611671724       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608823332       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905619932637       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905593762000       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905504281422       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905500960572       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905611067251       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905533747813       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905480166834       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905652079923       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905347299561       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905612069566       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 4.573532e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611671724       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611671724       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611671724       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611671724       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905615105155       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905615318052       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905569051627       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566576268       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905685833511       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905557108514       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905331114584       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905532259664       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905324516155       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905897723249       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906602995446       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906613155407       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904433528391       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904645533195       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905475689774       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905508816300       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909669663151       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904194006132       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905479867692       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907257103727       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904062073534       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906846210771       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905997030658       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906323489845       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909630201786       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905890882973       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.909037004100       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.912757418971       residual = 6.52e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.908999407920       residual = 1.38e-03           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 1.032788e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.951907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6593e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.178904
====================================================
  Execution time = 3.6681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3458e-01
  Total weights = 2.0000e+06
  Execution time = 3.3763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409012405
  error estimate for blocks of size 2^( 2) =       0.000421508380
  error estimate for blocks of size 2^( 3) =       0.000434741664
  error estimate for blocks of size 2^( 4) =       0.000446584561
  error estimate for blocks of size 2^( 5) =       0.000457934789
  error estimate for blocks of size 2^( 6) =       0.000466213910
  error estimate for blocks of size 2^( 7) =       0.000470962365

      target function =                  N/A
              le_mean =     -16.905787456897
             les_mean =     286.140231665775
             stat err =       0.000460423906
             autocorr =       1.267193013803
              std dev =       0.578430890672
             le_variance =       0.334582295283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409012405
  error estimate for blocks of size 2^( 2) =       0.000421508380
  error estimate for blocks of size 2^( 3) =       0.000434741664
  error estimate for blocks of size 2^( 4) =       0.000446584561
  error estimate for blocks of size 2^( 5) =       0.000457934789
  error estimate for blocks of size 2^( 6) =       0.000466213910
  error estimate for blocks of size 2^( 7) =       0.000470962365

      target function =                  N/A
              le_mean =     -16.905787456897
             les_mean =     286.140231665775
             stat err =       0.000460423906
             autocorr =       1.267193013801
              std dev =       0.578430890672
             le_variance =       0.334582295283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409012405
  error estimate for blocks of size 2^( 2) =       0.000421508380
  error estimate for blocks of size 2^( 3) =       0.000434741664
  error estimate for blocks of size 2^( 4) =       0.000446584561
  error estimate for blocks of size 2^( 5) =       0.000457934789
  error estimate for blocks of size 2^( 6) =       0.000466213910
  error estimate for blocks of size 2^( 7) =       0.000470962365

      target function =                  N/A
              le_mean =     -16.905787456897
             les_mean =     286.140231665775
             stat err =       0.000460423906
             autocorr =       1.267193013801
              std dev =       0.578430890672
             le_variance =       0.334582295283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394618810
                                         uncertainty =       0.004363341553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409012405
  error estimate for blocks of size 2^( 2) =       0.000421508380
  error estimate for blocks of size 2^( 3) =       0.000434741664
  error estimate for blocks of size 2^( 4) =       0.000446584561
  error estimate for blocks of size 2^( 5) =       0.000457934789
  error estimate for blocks of size 2^( 6) =       0.000466213910
  error estimate for blocks of size 2^( 7) =       0.000470962365

      target function =                  N/A
              le_mean =     -16.905787456897
             les_mean =     286.140231665775
             stat err =       0.000460423906
             autocorr =       1.267193013803
              std dev =       0.578430890672
             le_variance =       0.334582295283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905787456897        initial  <--
     2.3283e+09     2.3283e+10             1.8785e-13       -16.905787456897
     9.3132e+09     9.3132e+10             4.5735e-14       -16.905787456897
     3.7253e+10     3.7253e+11             1.0328e-14       -16.905787456897

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6786
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.062627e-01 1 1  ON 0
 uu_1                 1.405132e-01 1 1  ON 1
 uu_2                 3.991511e-02 1 1  ON 2
 uu_3                -2.084707e-02 1 1  ON 3
 uu_4                -6.391752e-02 1 1  ON 4
 uu_5                -9.627630e-02 1 1  ON 5
 uu_6                -1.215851e-01 1 1  ON 6
 uu_7                -1.326938e-01 1 1  ON 7
 uu_8                -1.246534e-01 1 1  ON 8
 uu_9                -9.532831e-02 1 1  ON 9
 ud_0                 4.379685e-01 1 1  ON 10
 ud_1                 1.743686e-01 1 1  ON 11
 ud_2                 5.854069e-02 1 1  ON 12
 ud_3                -9.296908e-03 1 1  ON 13
 ud_4                -6.529973e-02 1 1  ON 14
 ud_5                -1.054789e-01 1 1  ON 15
 ud_6                -1.315624e-01 1 1  ON 16
 ud_7                -1.469618e-01 1 1  ON 17
 ud_8                -1.479724e-01 1 1  ON 18
 ud_9                -1.380541e-01 1 1  ON 19
 eO_0                -7.452780e-01 1 1  ON 20
 eO_1                -4.298249e-01 1 1  ON 21
 eO_2                -1.650634e-02 1 1  ON 22
 eO_3                 2.951529e-01 1 1  ON 23
 eO_4                 5.104734e-01 1 1  ON 24
 eO_5                 4.658844e-01 1 1  ON 25
 eO_6                 2.375932e-01 1 1  ON 26
 eO_7                -5.432288e-02 1 1  ON 27
 eO_8                -2.026970e-01 1 1  ON 28
 eO_9                -6.272824e-02 1 1  ON 29
eH1_0                -2.276264e-01 1 1  ON 30
eH1_1                -1.319963e-01 1 1  ON 31
eH1_2                -8.791265e-02 1 1  ON 32
eH1_3                -3.555523e-02 1 1  ON 33
eH1_4                 1.145340e-02 1 1  ON 34
eH1_5                 4.535961e-02 1 1  ON 35
eH1_6                 9.883257e-02 1 1  ON 36
eH1_7                 1.425730e-01 1 1  ON 37
eH1_8                 1.514952e-01 1 1  ON 38
eH1_9                 3.825677e-02 1 1  ON 39
eH2_0                -2.254839e-01 1 1  ON 40
eH2_1                -1.299196e-01 1 1  ON 41
eH2_2                -8.562770e-02 1 1  ON 42
eH2_3                -3.313741e-02 1 1  ON 43
eH2_4                 1.395716e-02 1 1  ON 44
eH2_5                 4.869255e-02 1 1  ON 45
eH2_6                 1.013858e-01 1 1  ON 46
eH2_7                 1.481299e-01 1 1  ON 47
eH2_8                 1.594861e-01 1 1  ON 48
eH2_9                 2.090526e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0028e+02 secs
  Total Execution time = 4.0661e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
