Rank =    0  Free Memory = 80330 MB
Rank =    1  Free Memory = 80330 MB
Rank =    2  Free Memory = 80330 MB
Rank =    3  Free Memory = 80330 MB
Rank =    4  Free Memory = 80330 MB
Rank =    5  Free Memory = 80330 MB
Rank =    6  Free Memory = 80330 MB
Rank =    7  Free Memory = 80329 MB
Rank =    8  Free Memory = 80329 MB
Rank =    9  Free Memory = 80329 MB
Rank =   10  Free Memory = 80329 MB
Rank =   11  Free Memory = 80329 MB
Rank =   12  Free Memory = 80329 MB
Rank =   13  Free Memory = 80328 MB
Rank =   14  Free Memory = 80328 MB
Rank =   15  Free Memory = 80314 MB
Rank =   16  Free Memory = 80314 MB
Rank =   17  Free Memory = 80314 MB
Rank =   18  Free Memory = 80314 MB
Rank =   19  Free Memory = 80314 MB
Rank =   20  Free Memory = 80314 MB
Rank =   21  Free Memory = 80314 MB
Rank =   22  Free Memory = 80314 MB
Rank =   23  Free Memory = 80314 MB
Rank =   24  Free Memory = 80314 MB
Rank =   25  Free Memory = 80314 MB
Rank =   26  Free Memory = 80313 MB
Rank =   27  Free Memory = 80313 MB
Rank =   28  Free Memory = 80313 MB
Rank =   29  Free Memory = 80313 MB
Rank =   30  Free Memory = 80313 MB
Rank =   31  Free Memory = 80313 MB
Rank =   32  Free Memory = 79316 MB
Rank =   33  Free Memory = 79316 MB
Rank =   34  Free Memory = 79316 MB
Rank =   35  Free Memory = 79316 MB
Rank =   36  Free Memory = 79316 MB
Rank =   37  Free Memory = 79316 MB
Rank =   38  Free Memory = 79316 MB
Rank =   39  Free Memory = 79316 MB
Rank =   40  Free Memory = 79316 MB
Rank =   41  Free Memory = 79316 MB
Rank =   42  Free Memory = 79316 MB
Rank =   43  Free Memory = 79316 MB
Rank =   44  Free Memory = 79316 MB
Rank =   45  Free Memory = 79316 MB
Rank =   46  Free Memory = 79316 MB
Rank =   47  Free Memory = 79316 MB
Rank =   48  Free Memory = 79316 MB
Rank =   49  Free Memory = 79315 MB
Rank =   50  Free Memory = 79315 MB
Rank =   51  Free Memory = 79315 MB
Rank =   52  Free Memory = 79315 MB
Rank =   53  Free Memory = 79315 MB
Rank =   54  Free Memory = 79315 MB
Rank =   55  Free Memory = 79315 MB
Rank =   56  Free Memory = 79315 MB
Rank =   57  Free Memory = 79315 MB
Rank =   58  Free Memory = 79315 MB
Rank =   59  Free Memory = 79315 MB
Rank =   60  Free Memory = 79315 MB
Rank =   61  Free Memory = 79315 MB
Rank =   62  Free Memory = 79315 MB
Rank =   63  Free Memory = 79315 MB
Rank =   64  Free Memory = 73550 MB
Rank =   65  Free Memory = 73550 MB
Rank =   66  Free Memory = 73550 MB
Rank =   67  Free Memory = 73550 MB
Rank =   68  Free Memory = 73550 MB
Rank =   69  Free Memory = 73550 MB
Rank =   70  Free Memory = 73550 MB
Rank =   71  Free Memory = 73550 MB
Rank =   72  Free Memory = 73550 MB
Rank =   73  Free Memory = 73550 MB
Rank =   74  Free Memory = 73550 MB
Rank =   75  Free Memory = 73550 MB
Rank =   76  Free Memory = 73550 MB
Rank =   77  Free Memory = 73550 MB
Rank =   78  Free Memory = 73550 MB
Rank =   79  Free Memory = 73550 MB
Rank =   80  Free Memory = 73550 MB
Rank =   81  Free Memory = 73550 MB
Rank =   82  Free Memory = 73550 MB
Rank =   83  Free Memory = 73550 MB
Rank =   84  Free Memory = 73549 MB
Rank =   85  Free Memory = 73549 MB
Rank =   86  Free Memory = 73549 MB
Rank =   87  Free Memory = 73549 MB
Rank =   88  Free Memory = 73549 MB
Rank =   89  Free Memory = 73549 MB
Rank =   90  Free Memory = 73549 MB
Rank =   91  Free Memory = 73549 MB
Rank =   92  Free Memory = 73549 MB
Rank =   93  Free Memory = 73549 MB
Rank =   94  Free Memory = 73549 MB
Rank =   95  Free Memory = 73549 MB
Rank =   96  Free Memory = 83013 MB
Rank =   97  Free Memory = 83013 MB
Rank =   98  Free Memory = 83013 MB
Rank =   99  Free Memory = 83013 MB
Rank =  100  Free Memory = 83013 MB
Rank =  101  Free Memory = 83013 MB
Rank =  102  Free Memory = 83013 MB
Rank =  103  Free Memory = 83013 MB
Rank =  104  Free Memory = 83013 MB
Rank =  105  Free Memory = 83013 MB
Rank =  106  Free Memory = 83013 MB
Rank =  107  Free Memory = 83013 MB
Rank =  108  Free Memory = 83013 MB
Rank =  109  Free Memory = 83013 MB
Rank =  110  Free Memory = 83013 MB
Rank =  111  Free Memory = 83013 MB
Rank =  112  Free Memory = 83013 MB
Rank =  113  Free Memory = 83013 MB
Rank =  114  Free Memory = 83013 MB
Rank =  115  Free Memory = 83013 MB
Rank =  116  Free Memory = 83013 MB
Rank =  117  Free Memory = 83013 MB
Rank =  118  Free Memory = 83013 MB
Rank =  119  Free Memory = 83013 MB
Rank =  120  Free Memory = 83013 MB
Rank =  121  Free Memory = 83013 MB
Rank =  122  Free Memory = 83013 MB
Rank =  123  Free Memory = 83013 MB
Rank =  124  Free Memory = 83013 MB
Rank =  125  Free Memory = 83013 MB
Rank =  126  Free Memory = 83013 MB
Rank =  127  Free Memory = 83013 MB
  Input file(s): opt_h2o_1b1_gvptt_run003f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003f.xml

  Project = H2O
  date    = 2023-04-09 18:31:34 PDT
  host    = n0102.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 758

  Range of prime numbers to use as seeds over processors and threads = 5791-6907


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.080664e-01    1         1  ON     0
     uu_1                 1.418071e-01    1         1  ON     1
     uu_2                 4.090951e-02    1         1  ON     2
     uu_3                -2.057438e-02    1         1  ON     3
     uu_4                -6.445347e-02    1         1  ON     4
     uu_5                -9.747226e-02    1         1  ON     5
     uu_6                -1.230425e-01    1         1  ON     6
     uu_7                -1.349013e-01    1         1  ON     7
     uu_8                -1.267506e-01    1         1  ON     8
     uu_9                -9.655172e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.416350e-01    1         1  ON     0
     ud_1                 1.772624e-01    1         1  ON     1
     ud_2                 5.928216e-02    1         1  ON     2
     ud_3                -9.624490e-03    1         1  ON     3
     ud_4                -6.543535e-02    1         1  ON     4
     ud_5                -1.056736e-01    1         1  ON     5
     ud_6                -1.320250e-01    1         1  ON     6
     ud_7                -1.477392e-01    1         1  ON     7
     ud_8                -1.491215e-01    1         1  ON     8
     ud_9                -1.396760e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.493555e-01    1         1  ON     0
     eO_1                -4.319862e-01    1         1  ON     1
     eO_2                -1.731857e-02    1         1  ON     2
     eO_3                 2.961856e-01    1         1  ON     3
     eO_4                 5.144017e-01    1         1  ON     4
     eO_5                 4.707484e-01    1         1  ON     5
     eO_6                 2.415668e-01    1         1  ON     6
     eO_7                -5.325537e-02    1         1  ON     7
     eO_8                -2.066159e-01    1         1  ON     8
     eO_9                -6.607660e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.327718e-01    1         1  ON     0
     eH1_1                -1.347906e-01    1         1  ON     1
     eH1_2                -8.948991e-02    1         1  ON     2
     eH1_3                -3.620913e-02    1         1  ON     3
     eH1_4                 1.124569e-02    1         1  ON     4
     eH1_5                 4.432652e-02    1         1  ON     5
     eH1_6                 9.878778e-02    1         1  ON     6
     eH1_7                 1.443376e-01    1         1  ON     7
     eH1_8                 1.566873e-01    1         1  ON     8
     eH1_9                 4.240952e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.305154e-01    1         1  ON     0
     eH2_1                -1.320979e-01    1         1  ON     1
     eH2_2                -8.663022e-02    1         1  ON     2
     eH2_3                -3.358775e-02    1         1  ON     3
     eH2_4                 1.351577e-02    1         1  ON     4
     eH2_5                 4.810275e-02    1         1  ON     5
     eH2_6                 1.028102e-01    1         1  ON     6
     eH2_7                 1.500306e-01    1         1  ON     7
     eH2_8                 1.618705e-01    1         1  ON     8
     eH2_9                 2.459313e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 3.755380e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.4992e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9151
    reference variance = 0.193989
====================================================
  Execution time = 2.1982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336630140786
                                         uncertainty =       0.005694618974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336630140786
                                         uncertainty =       0.005694618974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410261018
  error estimate for blocks of size 2^( 2) =       0.000423324295
  error estimate for blocks of size 2^( 3) =       0.000436389910
  error estimate for blocks of size 2^( 4) =       0.000448124129
  error estimate for blocks of size 2^( 5) =       0.000458709238
  error estimate for blocks of size 2^( 6) =       0.000466298958
  error estimate for blocks of size 2^( 7) =       0.000468859140

      target function =                  N/A
              le_mean =     -16.906087639131
             les_mean =     286.152427299744
             stat err =       0.000460497866
             autocorr =       1.259896117755
              std dev =       0.580196696040
             le_variance =       0.336628206096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690608763913e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087639131       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099840199       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097923841       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906096185253       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906097443108       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906099699511       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906102634634       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906101720564       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906102051210       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906102297659       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906102031076       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.385543e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087639131       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092163384       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091414568       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906090973364       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091179010       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091499815       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092629328       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092269012       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906092260869       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.085510e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087639131       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906088925610       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906088731746       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906088602893       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906088671395       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906088784350       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089000719       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906088898318       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906088901905       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.085706e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7722e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.080876e-01                 1 1 ON  0
uu_1  1.418648e-01                 1 1 ON  1
uu_2  4.096463e-02                 1 1 ON  2
uu_3  -2.050593e-02                1 1 ON  3
uu_4  -6.445425e-02                1 1 ON  4
uu_5  -9.742469e-02                1 1 ON  5
uu_6  -1.230763e-01                1 1 ON  6
uu_7  -1.350109e-01                1 1 ON  7
uu_8  -1.269374e-01                1 1 ON  8
uu_9  -9.668471e-02                1 1 ON  9
ud_0  4.420436e-01                 1 1 ON  10
ud_1  1.776111e-01                 1 1 ON  11
ud_2  5.925551e-02                 1 1 ON  12
ud_3  -9.793043e-03                1 1 ON  13
ud_4  -6.559565e-02                1 1 ON  14
ud_5  -1.057370e-01                1 1 ON  15
ud_6  -1.320711e-01                1 1 ON  16
ud_7  -1.478429e-01                1 1 ON  17
ud_8  -1.493102e-01                1 1 ON  18
ud_9  -1.396792e-01                1 1 ON  19
eO_0  -7.497224e-01                1 1 ON  20
eO_1  -4.319751e-01                1 1 ON  21
eO_2  -1.728077e-02                1 1 ON  22
eO_3  2.964095e-01                 1 1 ON  23
eO_4  5.145743e-01                 1 1 ON  24
eO_5  4.709061e-01                 1 1 ON  25
eO_6  2.416849e-01                 1 1 ON  26
eO_7  -5.322594e-02                1 1 ON  27
eO_8  -2.068556e-01                1 1 ON  28
eO_9  -6.620900e-02                1 1 ON  29
eH1_0 -2.331760e-01                1 1 ON  30
eH1_1 -1.348909e-01                1 1 ON  31
eH1_2 -8.935902e-02                1 1 ON  32
eH1_3 -3.618021e-02                1 1 ON  33
eH1_4 1.136648e-02                 1 1 ON  34
eH1_5 4.426206e-02                 1 1 ON  35
eH1_6 9.884402e-02                 1 1 ON  36
eH1_7 1.443901e-01                 1 1 ON  37
eH1_8 1.567302e-01                 1 1 ON  38
eH1_9 4.251235e-02                 1 1 ON  39
eH2_0 -2.309025e-01                1 1 ON  40
eH2_1 -1.322910e-01                1 1 ON  41
eH2_2 -8.659454e-02                1 1 ON  42
eH2_3 -3.356944e-02                1 1 ON  43
eH2_4 1.352499e-02                 1 1 ON  44
eH2_5 4.805543e-02                 1 1 ON  45
eH2_6 1.028173e-01                 1 1 ON  46
eH2_7 1.500777e-01                 1 1 ON  47
eH2_8 1.621129e-01                 1 1 ON  48
eH2_9 2.485263e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.465032
====================================================
  Execution time = 2.0557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3121e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330978377710
                                         uncertainty =       0.003472071505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330978377710
                                         uncertainty =       0.003472071505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406811654
  error estimate for blocks of size 2^( 2) =       0.000419728998
  error estimate for blocks of size 2^( 3) =       0.000433181827
  error estimate for blocks of size 2^( 4) =       0.000445942260
  error estimate for blocks of size 2^( 5) =       0.000457784546
  error estimate for blocks of size 2^( 6) =       0.000466238240
  error estimate for blocks of size 2^( 7) =       0.000470584264

      target function =                  N/A
              le_mean =     -16.905788402073
             les_mean =     286.136672773901
             stat err =       0.000460137328
             autocorr =       1.279346425377
              std dev =       0.575318558476
             le_variance =       0.330991443727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616626754
                                         uncertainty =       0.003482241502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616626754
                                         uncertainty =       0.003482241502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407203634
  error estimate for blocks of size 2^( 2) =       0.000420079291
  error estimate for blocks of size 2^( 3) =       0.000433487772
  error estimate for blocks of size 2^( 4) =       0.000446211031
  error estimate for blocks of size 2^( 5) =       0.000458041625
  error estimate for blocks of size 2^( 6) =       0.000466477615
  error estimate for blocks of size 2^( 7) =       0.000470875443

      target function =                  N/A
              le_mean =     -16.905799433961
             les_mean =     286.137683934915
             stat err =       0.000460401428
             autocorr =       1.278350760362
              std dev =       0.575872902127
             le_variance =       0.331629599404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331416929388
                                         uncertainty =       0.003479350863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331416929388
                                         uncertainty =       0.003479350863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407080981
  error estimate for blocks of size 2^( 2) =       0.000419967704
  error estimate for blocks of size 2^( 3) =       0.000433388599
  error estimate for blocks of size 2^( 4) =       0.000446120289
  error estimate for blocks of size 2^( 5) =       0.000457953765
  error estimate for blocks of size 2^( 6) =       0.000466391890
  error estimate for blocks of size 2^( 7) =       0.000470774061

      target function =                  N/A
              le_mean =     -16.905795169329
             les_mean =     286.137339991642
             stat err =       0.000460310001
             autocorr =       1.278613239400
              std dev =       0.575699444210
             le_variance =       0.331429850063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331035352813
                                         uncertainty =       0.003473072426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331035352813
                                         uncertainty =       0.003473072426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406846649
  error estimate for blocks of size 2^( 2) =       0.000419759538
  error estimate for blocks of size 2^( 3) =       0.000433207753
  error estimate for blocks of size 2^( 4) =       0.000445963891
  error estimate for blocks of size 2^( 5) =       0.000457804857
  error estimate for blocks of size 2^( 6) =       0.000466256206
  error estimate for blocks of size 2^( 7) =       0.000470607441

      target function =                  N/A
              le_mean =     -16.905788945738
             les_mean =     286.136748103972
             stat err =       0.000460158099
             autocorr =       1.279241833785
              std dev =       0.575368048880
             le_variance =       0.331048391672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905788402073        initial
     2.5000e-01     2.5000e+00             1.3855e-03       -16.905799433961  <--
     1.0000e+00     1.0000e+01             4.0855e-04       -16.905795169329
     4.0000e+00     4.0000e+01             1.0857e-04       -16.905788945738

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0044e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.082696e-01 1 1  ON 0
 uu_1                 1.420208e-01 1 1  ON 1
 uu_2                 4.110521e-02 1 1  ON 2
 uu_3                -2.037592e-02 1 1  ON 3
 uu_4                -6.445770e-02 1 1  ON 4
 uu_5                -9.737335e-02 1 1  ON 5
 uu_6                -1.231856e-01 1 1  ON 6
 uu_7                -1.352821e-01 1 1  ON 7
 uu_8                -1.274470e-01 1 1  ON 8
 uu_9                -9.708634e-02 1 1  ON 9
 ud_0                 4.428884e-01 1 1  ON 10
 ud_1                 1.782083e-01 1 1  ON 11
 ud_2                 5.938157e-02 1 1  ON 12
 ud_3                -1.003266e-02 1 1  ON 13
 ud_4                -6.591407e-02 1 1  ON 14
 ud_5                -1.059438e-01 1 1  ON 15
 ud_6                -1.321969e-01 1 1  ON 16
 ud_7                -1.480453e-01 1 1  ON 17
 ud_8                -1.497783e-01 1 1  ON 18
 ud_9                -1.396903e-01 1 1  ON 19
 eO_0                -7.504876e-01 1 1  ON 20
 eO_1                -4.320843e-01 1 1  ON 21
 eO_2                -1.719929e-02 1 1  ON 22
 eO_3                 2.968067e-01 1 1  ON 23
 eO_4                 5.150877e-01 1 1  ON 24
 eO_5                 4.714259e-01 1 1  ON 25
 eO_6                 2.420753e-01 1 1  ON 26
 eO_7                -5.310431e-02 1 1  ON 27
 eO_8                -2.075678e-01 1 1  ON 28
 eO_9                -6.660987e-02 1 1  ON 29
eH1_0                -2.341456e-01 1 1  ON 30
eH1_1                -1.351336e-01 1 1  ON 31
eH1_2                -8.918538e-02 1 1  ON 32
eH1_3                -3.609176e-02 1 1  ON 33
eH1_4                 1.157790e-02 1 1  ON 34
eH1_5                 4.412370e-02 1 1  ON 35
eH1_6                 9.900413e-02 1 1  ON 36
eH1_7                 1.445490e-01 1 1  ON 37
eH1_8                 1.568723e-01 1 1  ON 38
eH1_9                 4.282671e-02 1 1  ON 39
eH2_0                -2.319010e-01 1 1  ON 40
eH2_1                -1.327641e-01 1 1  ON 41
eH2_2                -8.664444e-02 1 1  ON 42
eH2_3                -3.357971e-02 1 1  ON 43
eH2_4                 1.347972e-02 1 1  ON 44
eH2_5                 4.791048e-02 1 1  ON 45
eH2_6                 1.028477e-01 1 1  ON 46
eH2_7                 1.502261e-01 1 1  ON 47
eH2_8                 1.628467e-01 1 1  ON 48
eH2_9                 2.563706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8207e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.191913
====================================================
  Execution time = 2.1169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152743795
                                         uncertainty =       0.003385104520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152743795
                                         uncertainty =       0.003385104520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409328481
  error estimate for blocks of size 2^( 2) =       0.000422330330
  error estimate for blocks of size 2^( 3) =       0.000436192939
  error estimate for blocks of size 2^( 4) =       0.000449525867
  error estimate for blocks of size 2^( 5) =       0.000460107507
  error estimate for blocks of size 2^( 6) =       0.000467343742
  error estimate for blocks of size 2^( 7) =       0.000473201234

      target function =                  N/A
              le_mean =     -16.905941301953
             les_mean =     286.145950748684
             stat err =       0.000462544587
             autocorr =       1.276918790731
              std dev =       0.578877889680
             le_variance =       0.335099611161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594130195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941301953       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905947906278       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905951726146       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905953159375       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905957076709       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905955578951       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905954421975       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905954099103       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905956131137       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905956586648       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905957284666       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905957352712       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905957567366       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905957512059       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.552028e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941301953       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905945157530       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946749542       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905949224360       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905948516922       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905948310337       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905947840420       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905947678857       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905948049163       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905948053079       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.131124e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941301953       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942748797       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943143667       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943674662       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943913633       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943525470       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943584447       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943511205       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905943540790       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.168867e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6819e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.085046e-01 1 1  ON 0
 uu_1                 1.420456e-01 1 1  ON 1
 uu_2                 4.119619e-02 1 1  ON 2
 uu_3                -2.051573e-02 1 1  ON 3
 uu_4                -6.450484e-02 1 1  ON 4
 uu_5                -9.779220e-02 1 1  ON 5
 uu_6                -1.233370e-01 1 1  ON 6
 uu_7                -1.356793e-01 1 1  ON 7
 uu_8                -1.274828e-01 1 1  ON 8
 uu_9                -9.715537e-02 1 1  ON 9
 ud_0                 4.434798e-01 1 1  ON 10
 ud_1                 1.786758e-01 1 1  ON 11
 ud_2                 5.931140e-02 1 1  ON 12
 ud_3                -1.033513e-02 1 1  ON 13
 ud_4                -6.615202e-02 1 1  ON 14
 ud_5                -1.061879e-01 1 1  ON 15
 ud_6                -1.324508e-01 1 1  ON 16
 ud_7                -1.484616e-01 1 1  ON 17
 ud_8                -1.497734e-01 1 1  ON 18
 ud_9                -1.394341e-01 1 1  ON 19
 eO_0                -7.514507e-01 1 1  ON 20
 eO_1                -4.323050e-01 1 1  ON 21
 eO_2                -1.716025e-02 1 1  ON 22
 eO_3                 2.969428e-01 1 1  ON 23
 eO_4                 5.155527e-01 1 1  ON 24
 eO_5                 4.722015e-01 1 1  ON 25
 eO_6                 2.427658e-01 1 1  ON 26
 eO_7                -5.303566e-02 1 1  ON 27
 eO_8                -2.080562e-01 1 1  ON 28
 eO_9                -6.705403e-02 1 1  ON 29
eH1_0                -2.352767e-01 1 1  ON 30
eH1_1                -1.355610e-01 1 1  ON 31
eH1_2                -8.933218e-02 1 1  ON 32
eH1_3                -3.634232e-02 1 1  ON 33
eH1_4                 1.145541e-02 1 1  ON 34
eH1_5                 4.408371e-02 1 1  ON 35
eH1_6                 9.902501e-02 1 1  ON 36
eH1_7                 1.449912e-01 1 1  ON 37
eH1_8                 1.576023e-01 1 1  ON 38
eH1_9                 4.369776e-02 1 1  ON 39
eH2_0                -2.328637e-01 1 1  ON 40
eH2_1                -1.332667e-01 1 1  ON 41
eH2_2                -8.703020e-02 1 1  ON 42
eH2_3                -3.374326e-02 1 1  ON 43
eH2_4                 1.376824e-02 1 1  ON 44
eH2_5                 4.773717e-02 1 1  ON 45
eH2_6                 1.026553e-01 1 1  ON 46
eH2_7                 1.506487e-01 1 1  ON 47
eH2_8                 1.636057e-01 1 1  ON 48
eH2_9                 2.645078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8904
    reference variance = 0.273292
====================================================
  Execution time = 2.0487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4401e-01
  Total weights = 2.0000e+06
  Execution time = 1.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343572763773
                                         uncertainty =       0.007693743588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343572763773
                                         uncertainty =       0.007693743588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414438416
  error estimate for blocks of size 2^( 2) =       0.000426895221
  error estimate for blocks of size 2^( 3) =       0.000439777524
  error estimate for blocks of size 2^( 4) =       0.000451087963
  error estimate for blocks of size 2^( 5) =       0.000461924293
  error estimate for blocks of size 2^( 6) =       0.000468031528
  error estimate for blocks of size 2^( 7) =       0.000470585727

      target function =                  N/A
              le_mean =     -16.906202371576
             les_mean =     286.163196858911
             stat err =       0.000462907378
             autocorr =       1.247579396430
              std dev =       0.586104429251
             le_variance =       0.343518401988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344635947362
                                         uncertainty =       0.007721528446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344635947362
                                         uncertainty =       0.007721528446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415078984
  error estimate for blocks of size 2^( 2) =       0.000427498218
  error estimate for blocks of size 2^( 3) =       0.000440336276
  error estimate for blocks of size 2^( 4) =       0.000451600217
  error estimate for blocks of size 2^( 5) =       0.000462408278
  error estimate for blocks of size 2^( 6) =       0.000468485916
  error estimate for blocks of size 2^( 7) =       0.000471046320

      target function =                  N/A
              le_mean =     -16.906205613985
             les_mean =     286.164369216214
             stat err =       0.000463385183
             autocorr =       1.246300573577
              std dev =       0.587010328854
             le_variance =       0.344581126182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344571479520
                                         uncertainty =       0.007729748383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344571479520
                                         uncertainty =       0.007729748383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415040213
  error estimate for blocks of size 2^( 2) =       0.000427456795
  error estimate for blocks of size 2^( 3) =       0.000440295479
  error estimate for blocks of size 2^( 4) =       0.000451564560
  error estimate for blocks of size 2^( 5) =       0.000462381381
  error estimate for blocks of size 2^( 6) =       0.000468463575
  error estimate for blocks of size 2^( 7) =       0.000471039390

      target function =                  N/A
              le_mean =     -16.906208843158
             les_mean =     286.164414032375
             stat err =       0.000463362227
             autocorr =       1.246409930052
              std dev =       0.586955497585
             le_variance =       0.344516756146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343741575892
                                         uncertainty =       0.007701080317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343741575892
                                         uncertainty =       0.007701080317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414540200
  error estimate for blocks of size 2^( 2) =       0.000426988905
  error estimate for blocks of size 2^( 3) =       0.000439862662
  error estimate for blocks of size 2^( 4) =       0.000451165677
  error estimate for blocks of size 2^( 5) =       0.000461999175
  error estimate for blocks of size 2^( 6) =       0.000468101868
  error estimate for blocks of size 2^( 7) =       0.000470661797

      target function =                  N/A
              le_mean =     -16.906202895983
             les_mean =     286.163383342749
             stat err =       0.000462982129
             autocorr =       1.247369586588
              std dev =       0.586248372648
             le_variance =       0.343687154432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906202371576        initial
     6.2500e-02     6.2500e-01             3.5520e-03       -16.906205613985
     2.5000e-01     2.5000e+00             1.1311e-03       -16.906208843158  <--
     1.0000e+00     1.0000e+01             3.1689e-04       -16.906202895983

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9972e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.085046e-01 1 1  ON 0
 uu_1                 1.420456e-01 1 1  ON 1
 uu_2                 4.119619e-02 1 1  ON 2
 uu_3                -2.051573e-02 1 1  ON 3
 uu_4                -6.450484e-02 1 1  ON 4
 uu_5                -9.779220e-02 1 1  ON 5
 uu_6                -1.233370e-01 1 1  ON 6
 uu_7                -1.356793e-01 1 1  ON 7
 uu_8                -1.274828e-01 1 1  ON 8
 uu_9                -9.715537e-02 1 1  ON 9
 ud_0                 4.434798e-01 1 1  ON 10
 ud_1                 1.786758e-01 1 1  ON 11
 ud_2                 5.931140e-02 1 1  ON 12
 ud_3                -1.033513e-02 1 1  ON 13
 ud_4                -6.615202e-02 1 1  ON 14
 ud_5                -1.061879e-01 1 1  ON 15
 ud_6                -1.324508e-01 1 1  ON 16
 ud_7                -1.484616e-01 1 1  ON 17
 ud_8                -1.497734e-01 1 1  ON 18
 ud_9                -1.394341e-01 1 1  ON 19
 eO_0                -7.514507e-01 1 1  ON 20
 eO_1                -4.323050e-01 1 1  ON 21
 eO_2                -1.716025e-02 1 1  ON 22
 eO_3                 2.969428e-01 1 1  ON 23
 eO_4                 5.155527e-01 1 1  ON 24
 eO_5                 4.722015e-01 1 1  ON 25
 eO_6                 2.427658e-01 1 1  ON 26
 eO_7                -5.303566e-02 1 1  ON 27
 eO_8                -2.080562e-01 1 1  ON 28
 eO_9                -6.705403e-02 1 1  ON 29
eH1_0                -2.352767e-01 1 1  ON 30
eH1_1                -1.355610e-01 1 1  ON 31
eH1_2                -8.933218e-02 1 1  ON 32
eH1_3                -3.634232e-02 1 1  ON 33
eH1_4                 1.145541e-02 1 1  ON 34
eH1_5                 4.408371e-02 1 1  ON 35
eH1_6                 9.902501e-02 1 1  ON 36
eH1_7                 1.449912e-01 1 1  ON 37
eH1_8                 1.576023e-01 1 1  ON 38
eH1_9                 4.369776e-02 1 1  ON 39
eH2_0                -2.328637e-01 1 1  ON 40
eH2_1                -1.332667e-01 1 1  ON 41
eH2_2                -8.703020e-02 1 1  ON 42
eH2_3                -3.374326e-02 1 1  ON 43
eH2_4                 1.376824e-02 1 1  ON 44
eH2_5                 4.773717e-02 1 1  ON 45
eH2_6                 1.026553e-01 1 1  ON 46
eH2_7                 1.506487e-01 1 1  ON 47
eH2_8                 1.636057e-01 1 1  ON 48
eH2_9                 2.645078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.247107
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342816081552
                                         uncertainty =       0.004891623779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342816081552
                                         uncertainty =       0.004891623779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413956348
  error estimate for blocks of size 2^( 2) =       0.000427404919
  error estimate for blocks of size 2^( 3) =       0.000440955826
  error estimate for blocks of size 2^( 4) =       0.000454576839
  error estimate for blocks of size 2^( 5) =       0.000467094160
  error estimate for blocks of size 2^( 6) =       0.000476384712
  error estimate for blocks of size 2^( 7) =       0.000482951001

      target function =                  N/A
              le_mean =     -16.905596237159
             les_mean =     286.141903679280
             stat err =       0.000470251678
             autocorr =       1.290480994434
              std dev =       0.585422682181
             le_variance =       0.342719716812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559623716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596237159       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599251360       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905603535808       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608452356       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608868287       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905609517404       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905614473938       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905613937804       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905617675100       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905618661686       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905618466976       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905617600957       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905617858016       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.479336e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596237159       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905597965715       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600107981       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602752985       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603085346       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905602647123       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905604249644       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905604440846       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905604697343       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905604599846       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905604732766       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.128479e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905596237159       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596875918       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905597604153       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905598125065       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598531495       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598454244       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598823880       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598848768       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598867761       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.181522e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.085300e-01 1 1  ON 0
 uu_1                 1.421049e-01 1 1  ON 1
 uu_2                 4.114373e-02 1 1  ON 2
 uu_3                -2.042761e-02 1 1  ON 3
 uu_4                -6.463893e-02 1 1  ON 4
 uu_5                -9.817158e-02 1 1  ON 5
 uu_6                -1.239079e-01 1 1  ON 6
 uu_7                -1.357658e-01 1 1  ON 7
 uu_8                -1.275720e-01 1 1  ON 8
 uu_9                -9.719390e-02 1 1  ON 9
 ud_0                 4.439679e-01 1 1  ON 10
 ud_1                 1.788250e-01 1 1  ON 11
 ud_2                 5.925242e-02 1 1  ON 12
 ud_3                -1.083715e-02 1 1  ON 13
 ud_4                -6.658506e-02 1 1  ON 14
 ud_5                -1.065290e-01 1 1  ON 15
 ud_6                -1.327541e-01 1 1  ON 16
 ud_7                -1.483422e-01 1 1  ON 17
 ud_8                -1.490069e-01 1 1  ON 18
 ud_9                -1.389933e-01 1 1  ON 19
 eO_0                -7.524618e-01 1 1  ON 20
 eO_1                -4.328126e-01 1 1  ON 21
 eO_2                -1.729301e-02 1 1  ON 22
 eO_3                 2.973050e-01 1 1  ON 23
 eO_4                 5.162507e-01 1 1  ON 24
 eO_5                 4.727823e-01 1 1  ON 25
 eO_6                 2.430631e-01 1 1  ON 26
 eO_7                -5.253380e-02 1 1  ON 27
 eO_8                -2.083372e-01 1 1  ON 28
 eO_9                -6.748765e-02 1 1  ON 29
eH1_0                -2.363893e-01 1 1  ON 30
eH1_1                -1.359560e-01 1 1  ON 31
eH1_2                -8.954840e-02 1 1  ON 32
eH1_3                -3.638582e-02 1 1  ON 33
eH1_4                 1.115910e-02 1 1  ON 34
eH1_5                 4.401295e-02 1 1  ON 35
eH1_6                 9.922661e-02 1 1  ON 36
eH1_7                 1.455496e-01 1 1  ON 37
eH1_8                 1.583105e-01 1 1  ON 38
eH1_9                 4.439544e-02 1 1  ON 39
eH2_0                -2.339237e-01 1 1  ON 40
eH2_1                -1.339017e-01 1 1  ON 41
eH2_2                -8.734477e-02 1 1  ON 42
eH2_3                -3.399541e-02 1 1  ON 43
eH2_4                 1.334843e-02 1 1  ON 44
eH2_5                 4.768838e-02 1 1  ON 45
eH2_6                 1.027437e-01 1 1  ON 46
eH2_7                 1.509580e-01 1 1  ON 47
eH2_8                 1.646076e-01 1 1  ON 48
eH2_9                 2.757926e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.920762
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6452e-01
  Total weights = 2.0000e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364174715021
                                         uncertainty =       0.028603835668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364174715021
                                         uncertainty =       0.028603835668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426679814
  error estimate for blocks of size 2^( 2) =       0.000438499542
  error estimate for blocks of size 2^( 3) =       0.000450596775
  error estimate for blocks of size 2^( 4) =       0.000461610641
  error estimate for blocks of size 2^( 5) =       0.000472201557
  error estimate for blocks of size 2^( 6) =       0.000481867618
  error estimate for blocks of size 2^( 7) =       0.000488682307

      target function =                  N/A
              le_mean =     -16.906011692655
             les_mean =     286.177342497645
             stat err =       0.000476090531
             autocorr =       1.245015886204
              std dev =       0.603416379872
             le_variance =       0.364111327498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365108732549
                                         uncertainty =       0.028569518244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365108732549
                                         uncertainty =       0.028569518244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427227195
  error estimate for blocks of size 2^( 2) =       0.000439035642
  error estimate for blocks of size 2^( 3) =       0.000451110088
  error estimate for blocks of size 2^( 4) =       0.000462111179
  error estimate for blocks of size 2^( 5) =       0.000472664774
  error estimate for blocks of size 2^( 6) =       0.000482293306
  error estimate for blocks of size 2^( 7) =       0.000489087212

      target function =                  N/A
              le_mean =     -16.906017936822
             les_mean =     286.178488449702
             stat err =       0.000476539118
             autocorr =       1.244168878057
              std dev =       0.604190493191
             le_variance =       0.365046152063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365003323932
                                         uncertainty =       0.028547900841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365003323932
                                         uncertainty =       0.028547900841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427165503
  error estimate for blocks of size 2^( 2) =       0.000438971164
  error estimate for blocks of size 2^( 3) =       0.000451046118
  error estimate for blocks of size 2^( 4) =       0.000462052632
  error estimate for blocks of size 2^( 5) =       0.000472611594
  error estimate for blocks of size 2^( 6) =       0.000482245101
  error estimate for blocks of size 2^( 7) =       0.000489036152

      target function =                  N/A
              le_mean =     -16.906016126195
             les_mean =     286.178321810033
             stat err =       0.000476486370
             autocorr =       1.244252777300
              std dev =       0.604103247263
             le_variance =       0.364940733353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364312480457
                                         uncertainty =       0.028591386901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364312480457
                                         uncertainty =       0.028591386901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426760609
  error estimate for blocks of size 2^( 2) =       0.000438577300
  error estimate for blocks of size 2^( 3) =       0.000450670114
  error estimate for blocks of size 2^( 4) =       0.000461682792
  error estimate for blocks of size 2^( 5) =       0.000472268125
  error estimate for blocks of size 2^( 6) =       0.000481928641
  error estimate for blocks of size 2^( 7) =       0.000488738818

      target function =                  N/A
              le_mean =     -16.906011780655
             les_mean =     286.177483380147
             stat err =       0.000476154594
             autocorr =       1.244879471182
              std dev =       0.603530640988
             le_variance =       0.364249234611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906011692655        initial
     6.2500e-02     6.2500e-01             4.4793e-03       -16.906017936822  <--
     2.5000e-01     2.5000e+00             1.1285e-03       -16.906016126195
     1.0000e+00     1.0000e+01             3.1815e-04       -16.906011780655

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9818e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.087885e-01 1 1  ON 0
 uu_1                 1.422896e-01 1 1  ON 1
 uu_2                 4.118461e-02 1 1  ON 2
 uu_3                -2.049793e-02 1 1  ON 3
 uu_4                -6.500361e-02 1 1  ON 4
 uu_5                -9.892888e-02 1 1  ON 5
 uu_6                -1.249511e-01 1 1  ON 6
 uu_7                -1.365414e-01 1 1  ON 7
 uu_8                -1.283457e-01 1 1  ON 8
 uu_9                -9.742794e-02 1 1  ON 9
 ud_0                 4.444895e-01 1 1  ON 10
 ud_1                 1.791146e-01 1 1  ON 11
 ud_2                 5.925769e-02 1 1  ON 12
 ud_3                -1.124289e-02 1 1  ON 13
 ud_4                -6.722855e-02 1 1  ON 14
 ud_5                -1.071801e-01 1 1  ON 15
 ud_6                -1.333076e-01 1 1  ON 16
 ud_7                -1.483385e-01 1 1  ON 17
 ud_8                -1.479131e-01 1 1  ON 18
 ud_9                -1.377858e-01 1 1  ON 19
 eO_0                -7.544009e-01 1 1  ON 20
 eO_1                -4.341683e-01 1 1  ON 21
 eO_2                -1.777051e-02 1 1  ON 22
 eO_3                 2.976790e-01 1 1  ON 23
 eO_4                 5.177527e-01 1 1  ON 24
 eO_5                 4.745979e-01 1 1  ON 25
 eO_6                 2.442499e-01 1 1  ON 26
 eO_7                -5.125187e-02 1 1  ON 27
 eO_8                -2.092347e-01 1 1  ON 28
 eO_9                -6.876175e-02 1 1  ON 29
eH1_0                -2.383912e-01 1 1  ON 30
eH1_1                -1.371029e-01 1 1  ON 31
eH1_2                -9.051003e-02 1 1  ON 32
eH1_3                -3.712746e-02 1 1  ON 33
eH1_4                 1.037443e-02 1 1  ON 34
eH1_5                 4.360329e-02 1 1  ON 35
eH1_6                 9.958631e-02 1 1  ON 36
eH1_7                 1.471520e-01 1 1  ON 37
eH1_8                 1.603887e-01 1 1  ON 38
eH1_9                 4.648083e-02 1 1  ON 39
eH2_0                -2.361618e-01 1 1  ON 40
eH2_1                -1.355031e-01 1 1  ON 41
eH2_2                -8.863112e-02 1 1  ON 42
eH2_3                -3.515035e-02 1 1  ON 43
eH2_4                 1.220096e-02 1 1  ON 44
eH2_5                 4.711047e-02 1 1  ON 45
eH2_6                 1.028668e-01 1 1  ON 46
eH2_7                 1.519447e-01 1 1  ON 47
eH2_8                 1.675293e-01 1 1  ON 48
eH2_9                 3.093012e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8309
    reference variance = 0.206821
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336431660714
                                         uncertainty =       0.003293537008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336431660714
                                         uncertainty =       0.003293537008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410176835
  error estimate for blocks of size 2^( 2) =       0.000423368728
  error estimate for blocks of size 2^( 3) =       0.000436964316
  error estimate for blocks of size 2^( 4) =       0.000448997507
  error estimate for blocks of size 2^( 5) =       0.000460346376
  error estimate for blocks of size 2^( 6) =       0.000467988355
  error estimate for blocks of size 2^( 7) =       0.000474683804

      target function =                  N/A
              le_mean =     -16.905403058473
             les_mean =     286.129142473706
             stat err =       0.000463004011
             autocorr =       1.274169619466
              std dev =       0.580077643542
             le_variance =       0.336490072538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540305847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403058473       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405245450       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406739800       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905407306684       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406848283       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905407375779       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905410025899       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905414992264       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905416786305       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905416613986       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905422996021       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905423363330       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905423522286       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905423610034       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905424610630       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905424156170       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905424424593       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905424936344       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905424838758       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.406991e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403058473       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404891621       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406168286       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406511484       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406477737       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406404081       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905407285868       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905408890157       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905409033002       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905409013006       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905409956322       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905410193274       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905409972421       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.454577e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403058473       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404171390       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905404996715       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405106070       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405210092       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404993058       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405192432       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405446319       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905405457700       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905405508461       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.733362e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6215e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.089706e-01 1 1  ON 0
 uu_1                 1.424609e-01 1 1  ON 1
 uu_2                 4.119411e-02 1 1  ON 2
 uu_3                -2.065654e-02 1 1  ON 3
 uu_4                -6.541147e-02 1 1  ON 4
 uu_5                -9.873501e-02 1 1  ON 5
 uu_6                -1.252482e-01 1 1  ON 6
 uu_7                -1.370943e-01 1 1  ON 7
 uu_8                -1.294765e-01 1 1  ON 8
 uu_9                -9.882047e-02 1 1  ON 9
 ud_0                 4.454199e-01 1 1  ON 10
 ud_1                 1.798791e-01 1 1  ON 11
 ud_2                 6.003461e-02 1 1  ON 12
 ud_3                -1.060447e-02 1 1  ON 13
 ud_4                -6.715712e-02 1 1  ON 14
 ud_5                -1.078168e-01 1 1  ON 15
 ud_6                -1.339602e-01 1 1  ON 16
 ud_7                -1.493320e-01 1 1  ON 17
 ud_8                -1.485156e-01 1 1  ON 18
 ud_9                -1.375017e-01 1 1  ON 19
 eO_0                -7.556252e-01 1 1  ON 20
 eO_1                -4.353687e-01 1 1  ON 21
 eO_2                -1.827762e-02 1 1  ON 22
 eO_3                 2.977426e-01 1 1  ON 23
 eO_4                 5.192319e-01 1 1  ON 24
 eO_5                 4.765705e-01 1 1  ON 25
 eO_6                 2.457910e-01 1 1  ON 26
 eO_7                -4.934095e-02 1 1  ON 27
 eO_8                -2.106149e-01 1 1  ON 28
 eO_9                -7.098465e-02 1 1  ON 29
eH1_0                -2.399691e-01 1 1  ON 30
eH1_1                -1.388237e-01 1 1  ON 31
eH1_2                -9.214662e-02 1 1  ON 32
eH1_3                -3.859929e-02 1 1  ON 33
eH1_4                 8.994747e-03 1 1  ON 34
eH1_5                 4.296286e-02 1 1  ON 35
eH1_6                 9.990311e-02 1 1  ON 36
eH1_7                 1.491914e-01 1 1  ON 37
eH1_8                 1.633564e-01 1 1  ON 38
eH1_9                 4.945781e-02 1 1  ON 39
eH2_0                -2.387127e-01 1 1  ON 40
eH2_1                -1.372124e-01 1 1  ON 41
eH2_2                -9.045984e-02 1 1  ON 42
eH2_3                -3.660347e-02 1 1  ON 43
eH2_4                 1.166255e-02 1 1  ON 44
eH2_5                 4.723109e-02 1 1  ON 45
eH2_6                 1.035710e-01 1 1  ON 46
eH2_7                 1.529814e-01 1 1  ON 47
eH2_8                 1.700793e-01 1 1  ON 48
eH2_9                 3.438469e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8023
    reference variance = 0.224461
====================================================
  Execution time = 2.0409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4471e-01
  Total weights = 2.0000e+06
  Execution time = 1.9005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344429504331
                                         uncertainty =       0.006094478957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344429504331
                                         uncertainty =       0.006094478957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414953778
  error estimate for blocks of size 2^( 2) =       0.000427265506
  error estimate for blocks of size 2^( 3) =       0.000439761942
  error estimate for blocks of size 2^( 4) =       0.000450841507
  error estimate for blocks of size 2^( 5) =       0.000461572957
  error estimate for blocks of size 2^( 6) =       0.000467058338
  error estimate for blocks of size 2^( 7) =       0.000468270053

      target function =                  N/A
              le_mean =     -16.907517721594
             les_mean =     286.208528609625
             stat err =       0.000461935714
             autocorr =       1.239263431324
              std dev =       0.586833260639
             le_variance =       0.344373275792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345167259571
                                         uncertainty =       0.006097280714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345167259571
                                         uncertainty =       0.006097280714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415397988
  error estimate for blocks of size 2^( 2) =       0.000427705978
  error estimate for blocks of size 2^( 3) =       0.000440175192
  error estimate for blocks of size 2^( 4) =       0.000451205863
  error estimate for blocks of size 2^( 5) =       0.000461886789
  error estimate for blocks of size 2^( 6) =       0.000467324369
  error estimate for blocks of size 2^( 7) =       0.000468511160

      target function =                  N/A
              le_mean =     -16.907518281446
             les_mean =     286.209285242121
             stat err =       0.000462232045
             autocorr =       1.238201493415
              std dev =       0.587461468745
             le_variance =       0.345110977260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345116305551
                                         uncertainty =       0.006099623397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345116305551
                                         uncertainty =       0.006099623397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415367387
  error estimate for blocks of size 2^( 2) =       0.000427677175
  error estimate for blocks of size 2^( 3) =       0.000440154002
  error estimate for blocks of size 2^( 4) =       0.000451197127
  error estimate for blocks of size 2^( 5) =       0.000461894797
  error estimate for blocks of size 2^( 6) =       0.000467345763
  error estimate for blocks of size 2^( 7) =       0.000468554114

      target function =                  N/A
              le_mean =     -16.907519359455
             les_mean =     286.209270850989
             stat err =       0.000462247950
             autocorr =       1.238469166206
              std dev =       0.587418192745
             le_variance =       0.345060133168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515255029
                                         uncertainty =       0.006094877123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515255029
                                         uncertainty =       0.006094877123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415005458
  error estimate for blocks of size 2^( 2) =       0.000427317509
  error estimate for blocks of size 2^( 3) =       0.000439811805
  error estimate for blocks of size 2^( 4) =       0.000450886192
  error estimate for blocks of size 2^( 5) =       0.000461613114
  error estimate for blocks of size 2^( 6) =       0.000467093295
  error estimate for blocks of size 2^( 7) =       0.000468307961

      target function =                  N/A
              le_mean =     -16.907517776123
             les_mean =     286.208616237714
             stat err =       0.000461975140
             autocorr =       1.239166305086
              std dev =       0.586906346907
             le_variance =       0.344459060040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907517721594        initial
     1.5625e-02     1.5625e-01             1.4070e-02       -16.907518281446
     6.2500e-02     6.2500e-01             3.4546e-03       -16.907519359455  <--
     2.5000e-01     2.5000e+00             8.7334e-04       -16.907517776123

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0003e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.089706e-01 1 1  ON 0
 uu_1                 1.424609e-01 1 1  ON 1
 uu_2                 4.119411e-02 1 1  ON 2
 uu_3                -2.065654e-02 1 1  ON 3
 uu_4                -6.541147e-02 1 1  ON 4
 uu_5                -9.873501e-02 1 1  ON 5
 uu_6                -1.252482e-01 1 1  ON 6
 uu_7                -1.370943e-01 1 1  ON 7
 uu_8                -1.294765e-01 1 1  ON 8
 uu_9                -9.882047e-02 1 1  ON 9
 ud_0                 4.454199e-01 1 1  ON 10
 ud_1                 1.798791e-01 1 1  ON 11
 ud_2                 6.003461e-02 1 1  ON 12
 ud_3                -1.060447e-02 1 1  ON 13
 ud_4                -6.715712e-02 1 1  ON 14
 ud_5                -1.078168e-01 1 1  ON 15
 ud_6                -1.339602e-01 1 1  ON 16
 ud_7                -1.493320e-01 1 1  ON 17
 ud_8                -1.485156e-01 1 1  ON 18
 ud_9                -1.375017e-01 1 1  ON 19
 eO_0                -7.556252e-01 1 1  ON 20
 eO_1                -4.353687e-01 1 1  ON 21
 eO_2                -1.827762e-02 1 1  ON 22
 eO_3                 2.977426e-01 1 1  ON 23
 eO_4                 5.192319e-01 1 1  ON 24
 eO_5                 4.765705e-01 1 1  ON 25
 eO_6                 2.457910e-01 1 1  ON 26
 eO_7                -4.934095e-02 1 1  ON 27
 eO_8                -2.106149e-01 1 1  ON 28
 eO_9                -7.098465e-02 1 1  ON 29
eH1_0                -2.399691e-01 1 1  ON 30
eH1_1                -1.388237e-01 1 1  ON 31
eH1_2                -9.214662e-02 1 1  ON 32
eH1_3                -3.859929e-02 1 1  ON 33
eH1_4                 8.994747e-03 1 1  ON 34
eH1_5                 4.296286e-02 1 1  ON 35
eH1_6                 9.990311e-02 1 1  ON 36
eH1_7                 1.491914e-01 1 1  ON 37
eH1_8                 1.633564e-01 1 1  ON 38
eH1_9                 4.945781e-02 1 1  ON 39
eH2_0                -2.387127e-01 1 1  ON 40
eH2_1                -1.372124e-01 1 1  ON 41
eH2_2                -9.045984e-02 1 1  ON 42
eH2_3                -3.660347e-02 1 1  ON 43
eH2_4                 1.166255e-02 1 1  ON 44
eH2_5                 4.723109e-02 1 1  ON 45
eH2_6                 1.035710e-01 1 1  ON 46
eH2_7                 1.529814e-01 1 1  ON 47
eH2_8                 1.700793e-01 1 1  ON 48
eH2_9                 3.438469e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.373981
====================================================
  Execution time = 2.1103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349358013493
                                         uncertainty =       0.006412047798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349358013493
                                         uncertainty =       0.006412047798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417946110
  error estimate for blocks of size 2^( 2) =       0.000430509126
  error estimate for blocks of size 2^( 3) =       0.000443379270
  error estimate for blocks of size 2^( 4) =       0.000456351330
  error estimate for blocks of size 2^( 5) =       0.000466479594
  error estimate for blocks of size 2^( 6) =       0.000475033340
  error estimate for blocks of size 2^( 7) =       0.000477904973

      target function =                  N/A
              le_mean =     -16.906485990051
             les_mean =     286.178626258344
             stat err =       0.000468942309
             autocorr =       1.258920370956
              std dev =       0.591065056684
             le_variance =       0.349357901232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648599005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906485990051       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906489192015       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488553259       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906488053933       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906490545236       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906495030978       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906492686466       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498066679       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906499615825       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906502847236       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906507504902       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906508629435       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906508770938       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906510111304       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906512861087       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906512402766       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906511964557       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906511985547       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906511236709       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.517435e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906485990051       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488451362       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906487874081       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906487694912       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906489117707       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906492698843       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906491005140       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906493188049       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906493003068       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906493377501       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906494136269       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906494243134       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906494171616       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.657587e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906485990051       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906487268488       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486932261       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906487075854       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906487854469       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488767106       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488323850       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488745590       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906488693391       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906488821288       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.480279e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6668e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.094815e-01 1 1  ON 0
 uu_1                 1.425672e-01 1 1  ON 1
 uu_2                 4.121032e-02 1 1  ON 2
 uu_3                -2.087233e-02 1 1  ON 3
 uu_4                -6.558040e-02 1 1  ON 4
 uu_5                -9.950127e-02 1 1  ON 5
 uu_6                -1.259963e-01 1 1  ON 6
 uu_7                -1.379403e-01 1 1  ON 7
 uu_8                -1.302132e-01 1 1  ON 8
 uu_9                -9.957715e-02 1 1  ON 9
 ud_0                 4.464081e-01 1 1  ON 10
 ud_1                 1.805064e-01 1 1  ON 11
 ud_2                 6.058951e-02 1 1  ON 12
 ud_3                -1.017834e-02 1 1  ON 13
 ud_4                -6.707119e-02 1 1  ON 14
 ud_5                -1.082301e-01 1 1  ON 15
 ud_6                -1.344798e-01 1 1  ON 16
 ud_7                -1.498453e-01 1 1  ON 17
 ud_8                -1.494119e-01 1 1  ON 18
 ud_9                -1.378902e-01 1 1  ON 19
 eO_0                -7.569886e-01 1 1  ON 20
 eO_1                -4.360445e-01 1 1  ON 21
 eO_2                -1.879390e-02 1 1  ON 22
 eO_3                 2.988755e-01 1 1  ON 23
 eO_4                 5.205226e-01 1 1  ON 24
 eO_5                 4.788303e-01 1 1  ON 25
 eO_6                 2.477067e-01 1 1  ON 26
 eO_7                -4.909823e-02 1 1  ON 27
 eO_8                -2.126674e-01 1 1  ON 28
 eO_9                -7.296317e-02 1 1  ON 29
eH1_0                -2.416952e-01 1 1  ON 30
eH1_1                -1.404348e-01 1 1  ON 31
eH1_2                -9.348074e-02 1 1  ON 32
eH1_3                -3.917581e-02 1 1  ON 33
eH1_4                 8.634257e-03 1 1  ON 34
eH1_5                 4.195434e-02 1 1  ON 35
eH1_6                 9.809632e-02 1 1  ON 36
eH1_7                 1.501420e-01 1 1  ON 37
eH1_8                 1.670140e-01 1 1  ON 38
eH1_9                 5.280121e-02 1 1  ON 39
eH2_0                -2.404342e-01 1 1  ON 40
eH2_1                -1.386408e-01 1 1  ON 41
eH2_2                -9.162570e-02 1 1  ON 42
eH2_3                -3.756565e-02 1 1  ON 43
eH2_4                 1.067211e-02 1 1  ON 44
eH2_5                 4.562886e-02 1 1  ON 45
eH2_6                 1.032977e-01 1 1  ON 46
eH2_7                 1.542650e-01 1 1  ON 47
eH2_8                 1.725349e-01 1 1  ON 48
eH2_9                 3.802565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.227571
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3931e-01
  Total weights = 2.0000e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338660105860
                                         uncertainty =       0.003478718052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338660105860
                                         uncertainty =       0.003478718052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411548207
  error estimate for blocks of size 2^( 2) =       0.000424578769
  error estimate for blocks of size 2^( 3) =       0.000438082097
  error estimate for blocks of size 2^( 4) =       0.000449345789
  error estimate for blocks of size 2^( 5) =       0.000459005043
  error estimate for blocks of size 2^( 6) =       0.000468343791
  error estimate for blocks of size 2^( 7) =       0.000475731090

      target function =                  N/A
              le_mean =     -16.905667601344
             les_mean =     286.140340730478
             stat err =       0.000463106428
             autocorr =       1.266252138265
              std dev =       0.582017055336
             le_variance =       0.338743852702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704529559
                                         uncertainty =       0.003485837930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704529559
                                         uncertainty =       0.003485837930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412182787
  error estimate for blocks of size 2^( 2) =       0.000425194940
  error estimate for blocks of size 2^( 3) =       0.000438659221
  error estimate for blocks of size 2^( 4) =       0.000449866766
  error estimate for blocks of size 2^( 5) =       0.000459465986
  error estimate for blocks of size 2^( 6) =       0.000468776324
  error estimate for blocks of size 2^( 7) =       0.000476137155

      target function =                  N/A
              le_mean =     -16.905664859504
             les_mean =     286.141293471485
             stat err =       0.000463561558
             autocorr =       1.264838642687
              std dev =       0.582914487314
             le_variance =       0.339789299521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339809942332
                                         uncertainty =       0.003487228249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339809942332
                                         uncertainty =       0.003487228249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412246867
  error estimate for blocks of size 2^( 2) =       0.000425254925
  error estimate for blocks of size 2^( 3) =       0.000438722620
  error estimate for blocks of size 2^( 4) =       0.000449937664
  error estimate for blocks of size 2^( 5) =       0.000459546917
  error estimate for blocks of size 2^( 6) =       0.000468859452
  error estimate for blocks of size 2^( 7) =       0.000476228894

      target function =                  N/A
              le_mean =     -16.905663354470
             les_mean =     286.141348243491
             stat err =       0.000463643232
             autocorr =       1.264891054701
              std dev =       0.583005110411
             le_variance =       0.339894958765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338964427630
                                         uncertainty =       0.003481342279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338964427630
                                         uncertainty =       0.003481342279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411733254
  error estimate for blocks of size 2^( 2) =       0.000424755867
  error estimate for blocks of size 2^( 3) =       0.000438250243
  error estimate for blocks of size 2^( 4) =       0.000449503518
  error estimate for blocks of size 2^( 5) =       0.000459152164
  error estimate for blocks of size 2^( 6) =       0.000468483588
  error estimate for blocks of size 2^( 7) =       0.000475867199

      target function =                  N/A
              le_mean =     -16.905664987902
             les_mean =     286.140557058464
             stat err =       0.000463251617
             autocorr =       1.265907575480
              std dev =       0.582278751800
             le_variance =       0.339048544798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905667601344        initial  <--
     1.5625e-02     1.5625e-01             1.5174e-02       -16.905664859504
     6.2500e-02     6.2500e-01             3.6576e-03       -16.905663354470
     2.5000e-01     2.5000e+00             9.4803e-04       -16.905664987902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.7694
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.089706e-01 1 1  ON 0
 uu_1                 1.424609e-01 1 1  ON 1
 uu_2                 4.119411e-02 1 1  ON 2
 uu_3                -2.065654e-02 1 1  ON 3
 uu_4                -6.541147e-02 1 1  ON 4
 uu_5                -9.873501e-02 1 1  ON 5
 uu_6                -1.252482e-01 1 1  ON 6
 uu_7                -1.370943e-01 1 1  ON 7
 uu_8                -1.294765e-01 1 1  ON 8
 uu_9                -9.882047e-02 1 1  ON 9
 ud_0                 4.454199e-01 1 1  ON 10
 ud_1                 1.798791e-01 1 1  ON 11
 ud_2                 6.003461e-02 1 1  ON 12
 ud_3                -1.060447e-02 1 1  ON 13
 ud_4                -6.715712e-02 1 1  ON 14
 ud_5                -1.078168e-01 1 1  ON 15
 ud_6                -1.339602e-01 1 1  ON 16
 ud_7                -1.493320e-01 1 1  ON 17
 ud_8                -1.485156e-01 1 1  ON 18
 ud_9                -1.375017e-01 1 1  ON 19
 eO_0                -7.556252e-01 1 1  ON 20
 eO_1                -4.353687e-01 1 1  ON 21
 eO_2                -1.827762e-02 1 1  ON 22
 eO_3                 2.977426e-01 1 1  ON 23
 eO_4                 5.192319e-01 1 1  ON 24
 eO_5                 4.765705e-01 1 1  ON 25
 eO_6                 2.457910e-01 1 1  ON 26
 eO_7                -4.934095e-02 1 1  ON 27
 eO_8                -2.106149e-01 1 1  ON 28
 eO_9                -7.098465e-02 1 1  ON 29
eH1_0                -2.399691e-01 1 1  ON 30
eH1_1                -1.388237e-01 1 1  ON 31
eH1_2                -9.214662e-02 1 1  ON 32
eH1_3                -3.859929e-02 1 1  ON 33
eH1_4                 8.994747e-03 1 1  ON 34
eH1_5                 4.296286e-02 1 1  ON 35
eH1_6                 9.990311e-02 1 1  ON 36
eH1_7                 1.491914e-01 1 1  ON 37
eH1_8                 1.633564e-01 1 1  ON 38
eH1_9                 4.945781e-02 1 1  ON 39
eH2_0                -2.387127e-01 1 1  ON 40
eH2_1                -1.372124e-01 1 1  ON 41
eH2_2                -9.045984e-02 1 1  ON 42
eH2_3                -3.660347e-02 1 1  ON 43
eH2_4                 1.166255e-02 1 1  ON 44
eH2_5                 4.723109e-02 1 1  ON 45
eH2_6                 1.035710e-01 1 1  ON 46
eH2_7                 1.529814e-01 1 1  ON 47
eH2_8                 1.700793e-01 1 1  ON 48
eH2_9                 3.438469e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0548e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.345335
====================================================
  Execution time = 2.0518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4745e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347538634951
                                         uncertainty =       0.006941320358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347538634951
                                         uncertainty =       0.006941320358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416805278
  error estimate for blocks of size 2^( 2) =       0.000429732146
  error estimate for blocks of size 2^( 3) =       0.000443111767
  error estimate for blocks of size 2^( 4) =       0.000456464586
  error estimate for blocks of size 2^( 5) =       0.000467708958
  error estimate for blocks of size 2^( 6) =       0.000477092328
  error estimate for blocks of size 2^( 7) =       0.000482870614

      target function =                  N/A
              le_mean =     -16.905253073467
             les_mean =     286.135034584498
             stat err =       0.000471034121
             autocorr =       1.277139438469
              std dev =       0.589451677621
             le_variance =       0.347453280250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525307347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253073467       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253292975       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905254290592       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253858312       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905256783032       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905257329123       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905257361741       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905257390518       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905257066149       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905257274586       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905257311996       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.457779e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253073467       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253159395       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905253764047       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253674961       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905254359765       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905254487625       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905254394266       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905254385652       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.627651e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253073467       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253098489       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905253312781       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253297668       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905253343096       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905253470483       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905253433802       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905253436675       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.052546e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6084e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.089329e-01 1 1  ON 0
 uu_1                 1.424338e-01 1 1  ON 1
 uu_2                 4.118355e-02 1 1  ON 2
 uu_3                -2.070663e-02 1 1  ON 3
 uu_4                -6.533971e-02 1 1  ON 4
 uu_5                -9.886584e-02 1 1  ON 5
 uu_6                -1.251643e-01 1 1  ON 6
 uu_7                -1.372465e-01 1 1  ON 7
 uu_8                -1.294813e-01 1 1  ON 8
 uu_9                -9.884070e-02 1 1  ON 9
 ud_0                 4.455830e-01 1 1  ON 10
 ud_1                 1.799190e-01 1 1  ON 11
 ud_2                 6.007909e-02 1 1  ON 12
 ud_3                -1.063376e-02 1 1  ON 13
 ud_4                -6.711714e-02 1 1  ON 14
 ud_5                -1.078198e-01 1 1  ON 15
 ud_6                -1.341888e-01 1 1  ON 16
 ud_7                -1.493627e-01 1 1  ON 17
 ud_8                -1.485088e-01 1 1  ON 18
 ud_9                -1.374642e-01 1 1  ON 19
 eO_0                -7.557641e-01 1 1  ON 20
 eO_1                -4.354819e-01 1 1  ON 21
 eO_2                -1.836090e-02 1 1  ON 22
 eO_3                 2.976836e-01 1 1  ON 23
 eO_4                 5.193514e-01 1 1  ON 24
 eO_5                 4.768622e-01 1 1  ON 25
 eO_6                 2.460142e-01 1 1  ON 26
 eO_7                -4.924642e-02 1 1  ON 27
 eO_8                -2.107323e-01 1 1  ON 28
 eO_9                -7.116639e-02 1 1  ON 29
eH1_0                -2.402595e-01 1 1  ON 30
eH1_1                -1.390111e-01 1 1  ON 31
eH1_2                -9.223828e-02 1 1  ON 32
eH1_3                -3.864781e-02 1 1  ON 33
eH1_4                 8.896392e-03 1 1  ON 34
eH1_5                 4.284059e-02 1 1  ON 35
eH1_6                 9.989331e-02 1 1  ON 36
eH1_7                 1.494499e-01 1 1  ON 37
eH1_8                 1.637095e-01 1 1  ON 38
eH1_9                 4.971395e-02 1 1  ON 39
eH2_0                -2.388736e-01 1 1  ON 40
eH2_1                -1.373624e-01 1 1  ON 41
eH2_2                -9.064594e-02 1 1  ON 42
eH2_3                -3.676142e-02 1 1  ON 43
eH2_4                 1.178302e-02 1 1  ON 44
eH2_5                 4.709536e-02 1 1  ON 45
eH2_6                 1.034948e-01 1 1  ON 46
eH2_7                 1.531016e-01 1 1  ON 47
eH2_8                 1.702998e-01 1 1  ON 48
eH2_9                 3.474746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.271511
====================================================
  Execution time = 2.0054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5553e-01
  Total weights = 2.0000e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355504622439
                                         uncertainty =       0.011021673591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355504622439
                                         uncertainty =       0.011021673591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421562884
  error estimate for blocks of size 2^( 2) =       0.000434256250
  error estimate for blocks of size 2^( 3) =       0.000447221168
  error estimate for blocks of size 2^( 4) =       0.000458167542
  error estimate for blocks of size 2^( 5) =       0.000469080301
  error estimate for blocks of size 2^( 6) =       0.000477025614
  error estimate for blocks of size 2^( 7) =       0.000479085238

      target function =                  N/A
              le_mean =     -16.906018609914
             les_mean =     286.168895592199
             stat err =       0.000470839674
             autocorr =       1.247444881563
              std dev =       0.596179948632
             le_variance =       0.355430531151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355722691618
                                         uncertainty =       0.011024694718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355722691618
                                         uncertainty =       0.011024694718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421692075
  error estimate for blocks of size 2^( 2) =       0.000434382679
  error estimate for blocks of size 2^( 3) =       0.000447342096
  error estimate for blocks of size 2^( 4) =       0.000458280040
  error estimate for blocks of size 2^( 5) =       0.000469183714
  error estimate for blocks of size 2^( 6) =       0.000477113681
  error estimate for blocks of size 2^( 7) =       0.000479165633

      target function =                  N/A
              le_mean =     -16.906023322162
             les_mean =     286.169272803769
             stat err =       0.000470935767
             autocorr =       1.247189580116
              std dev =       0.596362651517
             le_variance =       0.355648412124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355697998291
                                         uncertainty =       0.011022733516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355697998291
                                         uncertainty =       0.011022733516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421677463
  error estimate for blocks of size 2^( 2) =       0.000434366978
  error estimate for blocks of size 2^( 3) =       0.000447326885
  error estimate for blocks of size 2^( 4) =       0.000458267046
  error estimate for blocks of size 2^( 5) =       0.000469173066
  error estimate for blocks of size 2^( 6) =       0.000477107981
  error estimate for blocks of size 2^( 7) =       0.000479162155

      target function =                  N/A
              le_mean =     -16.906022669662
             les_mean =     286.169226094292
             stat err =       0.000470927562
             autocorr =       1.247232556398
              std dev =       0.596341986610
             le_variance =       0.355623764994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355539328094
                                         uncertainty =       0.011022002296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355539328094
                                         uncertainty =       0.011022002296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421583451
  error estimate for blocks of size 2^( 2) =       0.000434276015
  error estimate for blocks of size 2^( 3) =       0.000447239967
  error estimate for blocks of size 2^( 4) =       0.000458185309
  error estimate for blocks of size 2^( 5) =       0.000469097018
  error estimate for blocks of size 2^( 6) =       0.000477040560
  error estimate for blocks of size 2^( 7) =       0.000479099556

      target function =                  N/A
              le_mean =     -16.906019250432
             les_mean =     286.168951930433
             stat err =       0.000470855611
             autocorr =       1.247407614580
              std dev =       0.596209033966
             le_variance =       0.355465212183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906018609914        initial
     1.5625e-01     1.5625e+00             1.4578e-03       -16.906023322162  <--
     6.2500e-01     6.2500e+00             3.6277e-04       -16.906022669662
     2.5000e+00     2.5000e+01             9.0525e-05       -16.906019250432

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9647e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.088771e-01 1 1  ON 0
 uu_1                 1.424108e-01 1 1  ON 1
 uu_2                 4.116562e-02 1 1  ON 2
 uu_3                -2.077357e-02 1 1  ON 3
 uu_4                -6.531421e-02 1 1  ON 4
 uu_5                -9.908735e-02 1 1  ON 5
 uu_6                -1.252013e-01 1 1  ON 6
 uu_7                -1.375786e-01 1 1  ON 7
 uu_8                -1.295146e-01 1 1  ON 8
 uu_9                -9.891966e-02 1 1  ON 9
 ud_0                 4.458543e-01 1 1  ON 10
 ud_1                 1.800638e-01 1 1  ON 11
 ud_2                 6.021748e-02 1 1  ON 12
 ud_3                -1.059398e-02 1 1  ON 13
 ud_4                -6.706640e-02 1 1  ON 14
 ud_5                -1.078828e-01 1 1  ON 15
 ud_6                -1.345217e-01 1 1  ON 16
 ud_7                -1.495408e-01 1 1  ON 17
 ud_8                -1.485603e-01 1 1  ON 18
 ud_9                -1.373628e-01 1 1  ON 19
 eO_0                -7.561514e-01 1 1  ON 20
 eO_1                -4.358440e-01 1 1  ON 21
 eO_2                -1.864795e-02 1 1  ON 22
 eO_3                 2.975507e-01 1 1  ON 23
 eO_4                 5.197532e-01 1 1  ON 24
 eO_5                 4.776877e-01 1 1  ON 25
 eO_6                 2.466834e-01 1 1  ON 26
 eO_7                -4.895551e-02 1 1  ON 27
 eO_8                -2.110920e-01 1 1  ON 28
 eO_9                -7.171749e-02 1 1  ON 29
eH1_0                -2.409680e-01 1 1  ON 30
eH1_1                -1.394803e-01 1 1  ON 31
eH1_2                -9.261508e-02 1 1  ON 32
eH1_3                -3.892955e-02 1 1  ON 33
eH1_4                 8.594129e-03 1 1  ON 34
eH1_5                 4.250353e-02 1 1  ON 35
eH1_6                 9.983328e-02 1 1  ON 36
eH1_7                 1.501935e-01 1 1  ON 37
eH1_8                 1.647794e-01 1 1  ON 38
eH1_9                 5.049377e-02 1 1  ON 39
eH2_0                -2.393464e-01 1 1  ON 40
eH2_1                -1.378285e-01 1 1  ON 41
eH2_2                -9.110876e-02 1 1  ON 42
eH2_3                -3.712322e-02 1 1  ON 43
eH2_4                 1.180182e-02 1 1  ON 44
eH2_5                 4.682070e-02 1 1  ON 45
eH2_6                 1.032887e-01 1 1  ON 46
eH2_7                 1.534410e-01 1 1  ON 47
eH2_8                 1.709609e-01 1 1  ON 48
eH2_9                 3.584247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5845e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.332866
====================================================
  Execution time = 2.1506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339430996443
                                         uncertainty =       0.003494963062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339430996443
                                         uncertainty =       0.003494963062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411923939
  error estimate for blocks of size 2^( 2) =       0.000424756340
  error estimate for blocks of size 2^( 3) =       0.000437797520
  error estimate for blocks of size 2^( 4) =       0.000449643546
  error estimate for blocks of size 2^( 5) =       0.000459722379
  error estimate for blocks of size 2^( 6) =       0.000466371742
  error estimate for blocks of size 2^( 7) =       0.000471778227

      target function =                  N/A
              le_mean =     -16.905020710798
             les_mean =     286.119087726411
             stat err =       0.000461878974
             autocorr =       1.257251956012
              std dev =       0.582548421674
             le_variance =       0.339362663595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690502071080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905020710798       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905024607718       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905026832588       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905026153674       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905026473880       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905029075419       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905024151219       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905027854050       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905031698313       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905031783333       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905032379284       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905033125404       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905033301606       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905033717941       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905033565759       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.322860e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905020710798       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905023185009       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905024761272       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905024304393       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905024488278       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905025520177       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905023982644       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905024445717       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905025364820       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905025495266       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905025343040       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.813078e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905020710798       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905021716434       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905022491667       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905022315603       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905022357743       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905022208606       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905022346549       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905022164378       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905022381303       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.497153e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7043e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093708e-01 1 1  ON 0
 uu_1                 1.423143e-01 1 1  ON 1
 uu_2                 4.091835e-02 1 1  ON 2
 uu_3                -2.100579e-02 1 1  ON 3
 uu_4                -6.565139e-02 1 1  ON 4
 uu_5                -9.919047e-02 1 1  ON 5
 uu_6                -1.255529e-01 1 1  ON 6
 uu_7                -1.377263e-01 1 1  ON 7
 uu_8                -1.291507e-01 1 1  ON 8
 uu_9                -9.897308e-02 1 1  ON 9
 ud_0                 4.462420e-01 1 1  ON 10
 ud_1                 1.805803e-01 1 1  ON 11
 ud_2                 6.045076e-02 1 1  ON 12
 ud_3                -1.027518e-02 1 1  ON 13
 ud_4                -6.720838e-02 1 1  ON 14
 ud_5                -1.081388e-01 1 1  ON 15
 ud_6                -1.339747e-01 1 1  ON 16
 ud_7                -1.497200e-01 1 1  ON 17
 ud_8                -1.494920e-01 1 1  ON 18
 ud_9                -1.379633e-01 1 1  ON 19
 eO_0                -7.566933e-01 1 1  ON 20
 eO_1                -4.361381e-01 1 1  ON 21
 eO_2                -1.861965e-02 1 1  ON 22
 eO_3                 2.979646e-01 1 1  ON 23
 eO_4                 5.198242e-01 1 1  ON 24
 eO_5                 4.781238e-01 1 1  ON 25
 eO_6                 2.476695e-01 1 1  ON 26
 eO_7                -4.832475e-02 1 1  ON 27
 eO_8                -2.118320e-01 1 1  ON 28
 eO_9                -7.257332e-02 1 1  ON 29
eH1_0                -2.414257e-01 1 1  ON 30
eH1_1                -1.400423e-01 1 1  ON 31
eH1_2                -9.316166e-02 1 1  ON 32
eH1_3                -3.922232e-02 1 1  ON 33
eH1_4                 8.587835e-03 1 1  ON 34
eH1_5                 4.249024e-02 1 1  ON 35
eH1_6                 9.984323e-02 1 1  ON 36
eH1_7                 1.507729e-01 1 1  ON 37
eH1_8                 1.654593e-01 1 1  ON 38
eH1_9                 5.136609e-02 1 1  ON 39
eH2_0                -2.395166e-01 1 1  ON 40
eH2_1                -1.384794e-01 1 1  ON 41
eH2_2                -9.143061e-02 1 1  ON 42
eH2_3                -3.753392e-02 1 1  ON 43
eH2_4                 1.091657e-02 1 1  ON 44
eH2_5                 4.600062e-02 1 1  ON 45
eH2_6                 1.030598e-01 1 1  ON 46
eH2_7                 1.536987e-01 1 1  ON 47
eH2_8                 1.720756e-01 1 1  ON 48
eH2_9                 3.765555e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.87
    reference variance = 0.256145
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3270e-01
  Total weights = 2.0000e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332500182582
                                         uncertainty =       0.002991661822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332500182582
                                         uncertainty =       0.002991661822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407677058
  error estimate for blocks of size 2^( 2) =       0.000420254087
  error estimate for blocks of size 2^( 3) =       0.000432944608
  error estimate for blocks of size 2^( 4) =       0.000444675674
  error estimate for blocks of size 2^( 5) =       0.000454399879
  error estimate for blocks of size 2^( 6) =       0.000461795794
  error estimate for blocks of size 2^( 7) =       0.000468954373

      target function =                  N/A
              le_mean =     -16.905318284709
             les_mean =     286.122187308579
             stat err =       0.000457456430
             autocorr =       1.259119435947
              std dev =       0.576542424682
             le_variance =       0.332401167458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333084566728
                                         uncertainty =       0.002995821053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333084566728
                                         uncertainty =       0.002995821053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035061
  error estimate for blocks of size 2^( 2) =       0.000420594995
  error estimate for blocks of size 2^( 3) =       0.000433262063
  error estimate for blocks of size 2^( 4) =       0.000444965093
  error estimate for blocks of size 2^( 5) =       0.000454671707
  error estimate for blocks of size 2^( 6) =       0.000462055513
  error estimate for blocks of size 2^( 7) =       0.000469195454

      target function =                  N/A
              le_mean =     -16.905311373401
             les_mean =     286.122537686726
             stat err =       0.000457721942
             autocorr =       1.258370416764
              std dev =       0.577048716827
             le_variance =       0.332985221591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333109560342
                                         uncertainty =       0.002995791761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333109560342
                                         uncertainty =       0.002995791761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408050426
  error estimate for blocks of size 2^( 2) =       0.000420608619
  error estimate for blocks of size 2^( 3) =       0.000433277573
  error estimate for blocks of size 2^( 4) =       0.000444985524
  error estimate for blocks of size 2^( 5) =       0.000454696428
  error estimate for blocks of size 2^( 6) =       0.000462089550
  error estimate for blocks of size 2^( 7) =       0.000469234290

      target function =                  N/A
              le_mean =     -16.905310935320
             les_mean =     286.122547954167
             stat err =       0.000457751448
             autocorr =       1.258437877316
              std dev =       0.577070447025
             le_variance =       0.333010300830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332623899117
                                         uncertainty =       0.002992467732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332623899117
                                         uncertainty =       0.002992467732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407752895
  error estimate for blocks of size 2^( 2) =       0.000420325371
  error estimate for blocks of size 2^( 3) =       0.000433011233
  error estimate for blocks of size 2^( 4) =       0.000444737453
  error estimate for blocks of size 2^( 5) =       0.000454458708
  error estimate for blocks of size 2^( 6) =       0.000461854928
  error estimate for blocks of size 2^( 7) =       0.000469011144

      target function =                  N/A
              le_mean =     -16.905315167961
             les_mean =     286.122205607888
             stat err =       0.000457515558
             autocorr =       1.258976515823
              std dev =       0.576649673601
             le_variance =       0.332524846064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905318284709        initial  <--
     3.9062e-02     3.9062e-01             7.3229e-03       -16.905311373401
     1.5625e-01     1.5625e+00             1.8131e-03       -16.905310935320
     6.2500e-01     6.2500e+00             4.4972e-04       -16.905315167961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9445
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088771e-01 1 1  ON 0
 uu_1                 1.424108e-01 1 1  ON 1
 uu_2                 4.116562e-02 1 1  ON 2
 uu_3                -2.077357e-02 1 1  ON 3
 uu_4                -6.531421e-02 1 1  ON 4
 uu_5                -9.908735e-02 1 1  ON 5
 uu_6                -1.252013e-01 1 1  ON 6
 uu_7                -1.375786e-01 1 1  ON 7
 uu_8                -1.295146e-01 1 1  ON 8
 uu_9                -9.891966e-02 1 1  ON 9
 ud_0                 4.458543e-01 1 1  ON 10
 ud_1                 1.800638e-01 1 1  ON 11
 ud_2                 6.021748e-02 1 1  ON 12
 ud_3                -1.059398e-02 1 1  ON 13
 ud_4                -6.706640e-02 1 1  ON 14
 ud_5                -1.078828e-01 1 1  ON 15
 ud_6                -1.345217e-01 1 1  ON 16
 ud_7                -1.495408e-01 1 1  ON 17
 ud_8                -1.485603e-01 1 1  ON 18
 ud_9                -1.373628e-01 1 1  ON 19
 eO_0                -7.561514e-01 1 1  ON 20
 eO_1                -4.358440e-01 1 1  ON 21
 eO_2                -1.864795e-02 1 1  ON 22
 eO_3                 2.975507e-01 1 1  ON 23
 eO_4                 5.197532e-01 1 1  ON 24
 eO_5                 4.776877e-01 1 1  ON 25
 eO_6                 2.466834e-01 1 1  ON 26
 eO_7                -4.895551e-02 1 1  ON 27
 eO_8                -2.110920e-01 1 1  ON 28
 eO_9                -7.171749e-02 1 1  ON 29
eH1_0                -2.409680e-01 1 1  ON 30
eH1_1                -1.394803e-01 1 1  ON 31
eH1_2                -9.261508e-02 1 1  ON 32
eH1_3                -3.892955e-02 1 1  ON 33
eH1_4                 8.594129e-03 1 1  ON 34
eH1_5                 4.250353e-02 1 1  ON 35
eH1_6                 9.983328e-02 1 1  ON 36
eH1_7                 1.501935e-01 1 1  ON 37
eH1_8                 1.647794e-01 1 1  ON 38
eH1_9                 5.049377e-02 1 1  ON 39
eH2_0                -2.393464e-01 1 1  ON 40
eH2_1                -1.378285e-01 1 1  ON 41
eH2_2                -9.110876e-02 1 1  ON 42
eH2_3                -3.712322e-02 1 1  ON 43
eH2_4                 1.180182e-02 1 1  ON 44
eH2_5                 4.682070e-02 1 1  ON 45
eH2_6                 1.032887e-01 1 1  ON 46
eH2_7                 1.534410e-01 1 1  ON 47
eH2_8                 1.709609e-01 1 1  ON 48
eH2_9                 3.584247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8552
    reference variance = 0.195945
====================================================
  Execution time = 2.1542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339376857581
                                         uncertainty =       0.004075143232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339376857581
                                         uncertainty =       0.004075143232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411915366
  error estimate for blocks of size 2^( 2) =       0.000424322717
  error estimate for blocks of size 2^( 3) =       0.000437657909
  error estimate for blocks of size 2^( 4) =       0.000450146680
  error estimate for blocks of size 2^( 5) =       0.000460688986
  error estimate for blocks of size 2^( 6) =       0.000467847153
  error estimate for blocks of size 2^( 7) =       0.000471252328

      target function =                  N/A
              le_mean =     -16.905607834420
             les_mean =     286.138924618305
             stat err =       0.000462483787
             autocorr =       1.260599236533
              std dev =       0.582536296542
             le_variance =       0.339348536789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560783442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905607834420       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608443776       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905609015216       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905609741072       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905610351211       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611145647       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905610803346       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905610728493       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905610614318       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.101426e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905607834420       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608041271       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905608229782       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608472751       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608773044       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608818936       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608778571       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608726161       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.267545e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905607834420       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905607891213       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905607943611       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608011220       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608065802       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608102683       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608097754       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608081634       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.177260e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7132e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.089423e-01 1 1  ON 0
 uu_1                 1.424631e-01 1 1  ON 1
 uu_2                 4.109857e-02 1 1  ON 2
 uu_3                -2.079124e-02 1 1  ON 3
 uu_4                -6.532645e-02 1 1  ON 4
 uu_5                -9.914391e-02 1 1  ON 5
 uu_6                -1.252412e-01 1 1  ON 6
 uu_7                -1.376218e-01 1 1  ON 7
 uu_8                -1.295772e-01 1 1  ON 8
 uu_9                -9.891320e-02 1 1  ON 9
 ud_0                 4.459076e-01 1 1  ON 10
 ud_1                 1.800887e-01 1 1  ON 11
 ud_2                 6.021177e-02 1 1  ON 12
 ud_3                -1.054815e-02 1 1  ON 13
 ud_4                -6.707485e-02 1 1  ON 14
 ud_5                -1.078888e-01 1 1  ON 15
 ud_6                -1.345541e-01 1 1  ON 16
 ud_7                -1.495469e-01 1 1  ON 17
 ud_8                -1.486268e-01 1 1  ON 18
 ud_9                -1.373612e-01 1 1  ON 19
 eO_0                -7.562452e-01 1 1  ON 20
 eO_1                -4.358259e-01 1 1  ON 21
 eO_2                -1.865189e-02 1 1  ON 22
 eO_3                 2.975287e-01 1 1  ON 23
 eO_4                 5.198407e-01 1 1  ON 24
 eO_5                 4.777708e-01 1 1  ON 25
 eO_6                 2.467685e-01 1 1  ON 26
 eO_7                -4.895918e-02 1 1  ON 27
 eO_8                -2.111731e-01 1 1  ON 28
 eO_9                -7.177776e-02 1 1  ON 29
eH1_0                -2.410223e-01 1 1  ON 30
eH1_1                -1.395510e-01 1 1  ON 31
eH1_2                -9.268549e-02 1 1  ON 32
eH1_3                -3.895431e-02 1 1  ON 33
eH1_4                 8.575520e-03 1 1  ON 34
eH1_5                 4.242428e-02 1 1  ON 35
eH1_6                 9.984991e-02 1 1  ON 36
eH1_7                 1.502327e-01 1 1  ON 37
eH1_8                 1.648952e-01 1 1  ON 38
eH1_9                 5.062052e-02 1 1  ON 39
eH2_0                -2.394548e-01 1 1  ON 40
eH2_1                -1.378426e-01 1 1  ON 41
eH2_2                -9.106117e-02 1 1  ON 42
eH2_3                -3.711127e-02 1 1  ON 43
eH2_4                 1.175120e-02 1 1  ON 44
eH2_5                 4.679009e-02 1 1  ON 45
eH2_6                 1.032208e-01 1 1  ON 46
eH2_7                 1.534446e-01 1 1  ON 47
eH2_8                 1.710456e-01 1 1  ON 48
eH2_9                 3.596468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0187
    reference variance = 0.409926
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3354e-01
  Total weights = 2.0000e+06
  Execution time = 1.8896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333479365718
                                         uncertainty =       0.002905357451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333479365718
                                         uncertainty =       0.002905357451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408316542
  error estimate for blocks of size 2^( 2) =       0.000421195851
  error estimate for blocks of size 2^( 3) =       0.000435026877
  error estimate for blocks of size 2^( 4) =       0.000448009976
  error estimate for blocks of size 2^( 5) =       0.000460175497
  error estimate for blocks of size 2^( 6) =       0.000470032698
  error estimate for blocks of size 2^( 7) =       0.000474519293

      target function =                  N/A
              le_mean =     -16.906127962535
             les_mean =     286.150607316236
             stat err =       0.000463184366
             autocorr =       1.286808242650
              std dev =       0.577446791778
             le_variance =       0.333444797335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333721783334
                                         uncertainty =       0.002908533587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333721783334
                                         uncertainty =       0.002908533587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408464953
  error estimate for blocks of size 2^( 2) =       0.000421336073
  error estimate for blocks of size 2^( 3) =       0.000435159786
  error estimate for blocks of size 2^( 4) =       0.000448136461
  error estimate for blocks of size 2^( 5) =       0.000460297503
  error estimate for blocks of size 2^( 6) =       0.000470153860
  error estimate for blocks of size 2^( 7) =       0.000474643311

      target function =                  N/A
              le_mean =     -16.906126915571
             les_mean =     286.150814353917
             stat err =       0.000463307784
             autocorr =       1.286558667736
              std dev =       0.577656676025
             le_variance =       0.333687235356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666255346
                                         uncertainty =       0.002907798633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666255346
                                         uncertainty =       0.002907798633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408430969
  error estimate for blocks of size 2^( 2) =       0.000421303721
  error estimate for blocks of size 2^( 3) =       0.000435129208
  error estimate for blocks of size 2^( 4) =       0.000448107822
  error estimate for blocks of size 2^( 5) =       0.000460270183
  error estimate for blocks of size 2^( 6) =       0.000470125936
  error estimate for blocks of size 2^( 7) =       0.000474614990

      target function =                  N/A
              le_mean =     -16.906127191281
             les_mean =     286.150768153812
             stat err =       0.000463279732
             autocorr =       1.286616962797
              std dev =       0.577608615636
             le_variance =       0.333631712857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506672136
                                         uncertainty =       0.002905713649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506672136
                                         uncertainty =       0.002905713649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408333264
  error estimate for blocks of size 2^( 2) =       0.000421211583
  error estimate for blocks of size 2^( 3) =       0.000435041789
  error estimate for blocks of size 2^( 4) =       0.000448024238
  error estimate for blocks of size 2^( 5) =       0.000460189321
  error estimate for blocks of size 2^( 6) =       0.000470046264
  error estimate for blocks of size 2^( 7) =       0.000474533227

      target function =                  N/A
              le_mean =     -16.906127833645
             les_mean =     286.150630269062
             stat err =       0.000463198262
             autocorr =       1.286780063235
              std dev =       0.577470439282
             le_variance =       0.333472108245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906127962535        initial  <--
     3.9062e-01     3.9062e+00             5.1014e-04       -16.906126915571
     1.5625e+00     1.5625e+01             1.2675e-04       -16.906127191281
     6.2500e+00     6.2500e+01             3.1773e-05       -16.906127833645

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1715
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088771e-01 1 1  ON 0
 uu_1                 1.424108e-01 1 1  ON 1
 uu_2                 4.116562e-02 1 1  ON 2
 uu_3                -2.077357e-02 1 1  ON 3
 uu_4                -6.531421e-02 1 1  ON 4
 uu_5                -9.908735e-02 1 1  ON 5
 uu_6                -1.252013e-01 1 1  ON 6
 uu_7                -1.375786e-01 1 1  ON 7
 uu_8                -1.295146e-01 1 1  ON 8
 uu_9                -9.891966e-02 1 1  ON 9
 ud_0                 4.458543e-01 1 1  ON 10
 ud_1                 1.800638e-01 1 1  ON 11
 ud_2                 6.021748e-02 1 1  ON 12
 ud_3                -1.059398e-02 1 1  ON 13
 ud_4                -6.706640e-02 1 1  ON 14
 ud_5                -1.078828e-01 1 1  ON 15
 ud_6                -1.345217e-01 1 1  ON 16
 ud_7                -1.495408e-01 1 1  ON 17
 ud_8                -1.485603e-01 1 1  ON 18
 ud_9                -1.373628e-01 1 1  ON 19
 eO_0                -7.561514e-01 1 1  ON 20
 eO_1                -4.358440e-01 1 1  ON 21
 eO_2                -1.864795e-02 1 1  ON 22
 eO_3                 2.975507e-01 1 1  ON 23
 eO_4                 5.197532e-01 1 1  ON 24
 eO_5                 4.776877e-01 1 1  ON 25
 eO_6                 2.466834e-01 1 1  ON 26
 eO_7                -4.895551e-02 1 1  ON 27
 eO_8                -2.110920e-01 1 1  ON 28
 eO_9                -7.171749e-02 1 1  ON 29
eH1_0                -2.409680e-01 1 1  ON 30
eH1_1                -1.394803e-01 1 1  ON 31
eH1_2                -9.261508e-02 1 1  ON 32
eH1_3                -3.892955e-02 1 1  ON 33
eH1_4                 8.594129e-03 1 1  ON 34
eH1_5                 4.250353e-02 1 1  ON 35
eH1_6                 9.983328e-02 1 1  ON 36
eH1_7                 1.501935e-01 1 1  ON 37
eH1_8                 1.647794e-01 1 1  ON 38
eH1_9                 5.049377e-02 1 1  ON 39
eH2_0                -2.393464e-01 1 1  ON 40
eH2_1                -1.378285e-01 1 1  ON 41
eH2_2                -9.110876e-02 1 1  ON 42
eH2_3                -3.712322e-02 1 1  ON 43
eH2_4                 1.180182e-02 1 1  ON 44
eH2_5                 4.682070e-02 1 1  ON 45
eH2_6                 1.032887e-01 1 1  ON 46
eH2_7                 1.534410e-01 1 1  ON 47
eH2_8                 1.709609e-01 1 1  ON 48
eH2_9                 3.584247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.304108
====================================================
  Execution time = 2.0938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344297228673
                                         uncertainty =       0.005480933394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344297228673
                                         uncertainty =       0.005480933394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414910989
  error estimate for blocks of size 2^( 2) =       0.000427136645
  error estimate for blocks of size 2^( 3) =       0.000439770239
  error estimate for blocks of size 2^( 4) =       0.000451560523
  error estimate for blocks of size 2^( 5) =       0.000462771649
  error estimate for blocks of size 2^( 6) =       0.000471503916
  error estimate for blocks of size 2^( 7) =       0.000477903681

      target function =                  N/A
              le_mean =     -16.906141016988
             les_mean =     286.161906171094
             stat err =       0.000465934942
             autocorr =       1.261074337189
              std dev =       0.586772747299
             le_variance =       0.344302256973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614101699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141016988       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141329072       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141361820       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141552342       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141539925       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141723301       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141693419       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141686795       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141704736       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.362591e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141016988       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141097369       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141106902       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141155614       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141153088       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141201764       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141195848       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141193930       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.888701e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141016988       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141037236       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141039714       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141051962       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141051371       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141063734       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141062379       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141061890       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.730412e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6612e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088850e-01 1 1  ON 0
 uu_1                 1.424163e-01 1 1  ON 1
 uu_2                 4.117259e-02 1 1  ON 2
 uu_3                -2.077243e-02 1 1  ON 3
 uu_4                -6.531338e-02 1 1  ON 4
 uu_5                -9.909449e-02 1 1  ON 5
 uu_6                -1.252049e-01 1 1  ON 6
 uu_7                -1.375843e-01 1 1  ON 7
 uu_8                -1.295253e-01 1 1  ON 8
 uu_9                -9.892994e-02 1 1  ON 9
 ud_0                 4.458501e-01 1 1  ON 10
 ud_1                 1.800760e-01 1 1  ON 11
 ud_2                 6.022047e-02 1 1  ON 12
 ud_3                -1.058470e-02 1 1  ON 13
 ud_4                -6.706557e-02 1 1  ON 14
 ud_5                -1.078750e-01 1 1  ON 15
 ud_6                -1.345122e-01 1 1  ON 16
 ud_7                -1.495441e-01 1 1  ON 17
 ud_8                -1.485792e-01 1 1  ON 18
 ud_9                -1.373746e-01 1 1  ON 19
 eO_0                -7.561500e-01 1 1  ON 20
 eO_1                -4.358440e-01 1 1  ON 21
 eO_2                -1.865298e-02 1 1  ON 22
 eO_3                 2.975508e-01 1 1  ON 23
 eO_4                 5.197568e-01 1 1  ON 24
 eO_5                 4.776932e-01 1 1  ON 25
 eO_6                 2.466968e-01 1 1  ON 26
 eO_7                -4.895171e-02 1 1  ON 27
 eO_8                -2.111049e-01 1 1  ON 28
 eO_9                -7.172604e-02 1 1  ON 29
eH1_0                -2.409772e-01 1 1  ON 30
eH1_1                -1.394855e-01 1 1  ON 31
eH1_2                -9.262241e-02 1 1  ON 32
eH1_3                -3.892704e-02 1 1  ON 33
eH1_4                 8.596178e-03 1 1  ON 34
eH1_5                 4.250279e-02 1 1  ON 35
eH1_6                 9.983061e-02 1 1  ON 36
eH1_7                 1.501983e-01 1 1  ON 37
eH1_8                 1.647883e-01 1 1  ON 38
eH1_9                 5.050213e-02 1 1  ON 39
eH2_0                -2.393601e-01 1 1  ON 40
eH2_1                -1.378307e-01 1 1  ON 41
eH2_2                -9.110870e-02 1 1  ON 42
eH2_3                -3.712530e-02 1 1  ON 43
eH2_4                 1.179498e-02 1 1  ON 44
eH2_5                 4.682115e-02 1 1  ON 45
eH2_6                 1.032843e-01 1 1  ON 46
eH2_7                 1.534405e-01 1 1  ON 47
eH2_8                 1.709724e-01 1 1  ON 48
eH2_9                 3.585813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0029
    reference variance = 0.546278
====================================================
  Execution time = 2.1480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3573e-01
  Total weights = 2.0000e+06
  Execution time = 1.9088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335774073946
                                         uncertainty =       0.003494279394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335774073946
                                         uncertainty =       0.003494279394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409720327
  error estimate for blocks of size 2^( 2) =       0.000422420356
  error estimate for blocks of size 2^( 3) =       0.000435389074
  error estimate for blocks of size 2^( 4) =       0.000447773157
  error estimate for blocks of size 2^( 5) =       0.000457915850
  error estimate for blocks of size 2^( 6) =       0.000465511848
  error estimate for blocks of size 2^( 7) =       0.000470036715

      target function =                  N/A
              le_mean =     -16.905697219153
             les_mean =     286.138339790579
             stat err =       0.000460309392
             autocorr =       1.262189758128
              std dev =       0.579432043267
             le_variance =       0.335741492765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335746082621
                                         uncertainty =       0.003493860087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335746082621
                                         uncertainty =       0.003493860087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409703246
  error estimate for blocks of size 2^( 2) =       0.000422403161
  error estimate for blocks of size 2^( 3) =       0.000435371638
  error estimate for blocks of size 2^( 4) =       0.000447755628
  error estimate for blocks of size 2^( 5) =       0.000457899403
  error estimate for blocks of size 2^( 6) =       0.000465496331
  error estimate for blocks of size 2^( 7) =       0.000470020845

      target function =                  N/A
              le_mean =     -16.905697493914
             les_mean =     286.138321087033
             stat err =       0.000460293052
             autocorr =       1.262205386812
              std dev =       0.579407886705
             le_variance =       0.335713499176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335756893935
                                         uncertainty =       0.003494025248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335756893935
                                         uncertainty =       0.003494025248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409709843
  error estimate for blocks of size 2^( 2) =       0.000422409877
  error estimate for blocks of size 2^( 3) =       0.000435378519
  error estimate for blocks of size 2^( 4) =       0.000447762591
  error estimate for blocks of size 2^( 5) =       0.000457905902
  error estimate for blocks of size 2^( 6) =       0.000465502415
  error estimate for blocks of size 2^( 7) =       0.000470027062

      target function =                  N/A
              le_mean =     -16.905697353409
             les_mean =     286.138327147908
             stat err =       0.000460299492
             autocorr =       1.262200060504
              std dev =       0.579417216442
             le_variance =       0.335724310710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771869736
                                         uncertainty =       0.003494246651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771869736
                                         uncertainty =       0.003494246651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718982
  error estimate for blocks of size 2^( 2) =       0.000422419012
  error estimate for blocks of size 2^( 3) =       0.000435387721
  error estimate for blocks of size 2^( 4) =       0.000447771803
  error estimate for blocks of size 2^( 5) =       0.000457914574
  error estimate for blocks of size 2^( 6) =       0.000465510636
  error estimate for blocks of size 2^( 7) =       0.000470035476

      target function =                  N/A
              le_mean =     -16.905697235810
             les_mean =     286.138338149299
             stat err =       0.000460308122
             autocorr =       1.262191080372
              std dev =       0.579430140991
             le_variance =       0.335739288289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905697219153        initial
     3.9062e+00     3.9062e+01             7.3626e-05       -16.905697493914  <--
     1.5625e+01     1.5625e+02             1.8887e-05       -16.905697353409
     6.2500e+01     6.2500e+02             4.7304e-06       -16.905697235810

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.1106e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.089088e-01 1 1  ON 0
 uu_1                 1.424316e-01 1 1  ON 1
 uu_2                 4.119168e-02 1 1  ON 2
 uu_3                -2.076671e-02 1 1  ON 3
 uu_4                -6.531220e-02 1 1  ON 4
 uu_5                -9.911399e-02 1 1  ON 5
 uu_6                -1.252170e-01 1 1  ON 6
 uu_7                -1.376020e-01 1 1  ON 7
 uu_8                -1.295569e-01 1 1  ON 8
 uu_9                -9.896090e-02 1 1  ON 9
 ud_0                 4.458439e-01 1 1  ON 10
 ud_1                 1.801098e-01 1 1  ON 11
 ud_2                 6.022951e-02 1 1  ON 12
 ud_3                -1.055908e-02 1 1  ON 13
 ud_4                -6.706349e-02 1 1  ON 14
 ud_5                -1.078523e-01 1 1  ON 15
 ud_6                -1.344871e-01 1 1  ON 16
 ud_7                -1.495536e-01 1 1  ON 17
 ud_8                -1.486339e-01 1 1  ON 18
 ud_9                -1.374098e-01 1 1  ON 19
 eO_0                -7.561461e-01 1 1  ON 20
 eO_1                -4.358450e-01 1 1  ON 21
 eO_2                -1.866662e-02 1 1  ON 22
 eO_3                 2.975498e-01 1 1  ON 23
 eO_4                 5.197674e-01 1 1  ON 24
 eO_5                 4.777107e-01 1 1  ON 25
 eO_6                 2.467373e-01 1 1  ON 26
 eO_7                -4.893921e-02 1 1  ON 27
 eO_8                -2.111440e-01 1 1  ON 28
 eO_9                -7.175250e-02 1 1  ON 29
eH1_0                -2.410049e-01 1 1  ON 30
eH1_1                -1.395012e-01 1 1  ON 31
eH1_2                -9.264455e-02 1 1  ON 32
eH1_3                -3.892102e-02 1 1  ON 33
eH1_4                 8.601607e-03 1 1  ON 34
eH1_5                 4.250052e-02 1 1  ON 35
eH1_6                 9.982258e-02 1 1  ON 36
eH1_7                 1.502129e-01 1 1  ON 37
eH1_8                 1.648160e-01 1 1  ON 38
eH1_9                 5.052852e-02 1 1  ON 39
eH2_0                -2.394016e-01 1 1  ON 40
eH2_1                -1.378381e-01 1 1  ON 41
eH2_2                -9.110909e-02 1 1  ON 42
eH2_3                -3.713074e-02 1 1  ON 43
eH2_4                 1.177304e-02 1 1  ON 44
eH2_5                 4.682082e-02 1 1  ON 45
eH2_6                 1.032712e-01 1 1  ON 46
eH2_7                 1.534391e-01 1 1  ON 47
eH2_8                 1.710084e-01 1 1  ON 48
eH2_9                 3.590710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.209266
====================================================
  Execution time = 2.1348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352533130321
                                         uncertainty =       0.010309430524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352533130321
                                         uncertainty =       0.010309430524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419806441
  error estimate for blocks of size 2^( 2) =       0.000432380141
  error estimate for blocks of size 2^( 3) =       0.000444714719
  error estimate for blocks of size 2^( 4) =       0.000456760309
  error estimate for blocks of size 2^( 5) =       0.000467896334
  error estimate for blocks of size 2^( 6) =       0.000475445811
  error estimate for blocks of size 2^( 7) =       0.000480512996

      target function =                  N/A
              le_mean =     -16.906064414865
             les_mean =     286.167488719740
             stat err =       0.000470153862
             autocorr =       1.254243388628
              std dev =       0.593695962945
             le_variance =       0.352474896417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606441486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906064414865       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906065376475       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906065434289       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066175963       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906065498399       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906065287350       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906065845444       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906065759629       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906065798452       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.048994e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906064414865       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906064689905       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906064700919       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906064946642       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906064829276       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906064709679       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906064827248       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906064801282       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.357956e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906064414865       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906064486194       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906064488743       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906064554988       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906064530080       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906064496129       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906064523017       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906064516223       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.349073e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6893e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.089044e-01 1 1  ON 0
 uu_1                 1.424468e-01 1 1  ON 1
 uu_2                 4.120386e-02 1 1  ON 2
 uu_3                -2.076530e-02 1 1  ON 3
 uu_4                -6.531377e-02 1 1  ON 4
 uu_5                -9.909546e-02 1 1  ON 5
 uu_6                -1.252393e-01 1 1  ON 6
 uu_7                -1.376119e-01 1 1  ON 7
 uu_8                -1.295847e-01 1 1  ON 8
 uu_9                -9.899260e-02 1 1  ON 9
 ud_0                 4.458614e-01 1 1  ON 10
 ud_1                 1.801235e-01 1 1  ON 11
 ud_2                 6.023015e-02 1 1  ON 12
 ud_3                -1.053231e-02 1 1  ON 13
 ud_4                -6.706169e-02 1 1  ON 14
 ud_5                -1.078426e-01 1 1  ON 15
 ud_6                -1.344568e-01 1 1  ON 16
 ud_7                -1.495762e-01 1 1  ON 17
 ud_8                -1.486875e-01 1 1  ON 18
 ud_9                -1.374311e-01 1 1  ON 19
 eO_0                -7.561735e-01 1 1  ON 20
 eO_1                -4.358243e-01 1 1  ON 21
 eO_2                -1.867286e-02 1 1  ON 22
 eO_3                 2.975586e-01 1 1  ON 23
 eO_4                 5.197798e-01 1 1  ON 24
 eO_5                 4.777387e-01 1 1  ON 25
 eO_6                 2.467740e-01 1 1  ON 26
 eO_7                -4.893559e-02 1 1  ON 27
 eO_8                -2.111820e-01 1 1  ON 28
 eO_9                -7.178501e-02 1 1  ON 29
eH1_0                -2.410436e-01 1 1  ON 30
eH1_1                -1.395316e-01 1 1  ON 31
eH1_2                -9.266785e-02 1 1  ON 32
eH1_3                -3.892994e-02 1 1  ON 33
eH1_4                 8.592351e-03 1 1  ON 34
eH1_5                 4.252495e-02 1 1  ON 35
eH1_6                 9.981719e-02 1 1  ON 36
eH1_7                 1.502218e-01 1 1  ON 37
eH1_8                 1.648486e-01 1 1  ON 38
eH1_9                 5.057540e-02 1 1  ON 39
eH2_0                -2.394231e-01 1 1  ON 40
eH2_1                -1.378612e-01 1 1  ON 41
eH2_2                -9.108655e-02 1 1  ON 42
eH2_3                -3.713725e-02 1 1  ON 43
eH2_4                 1.175539e-02 1 1  ON 44
eH2_5                 4.679761e-02 1 1  ON 45
eH2_6                 1.032575e-01 1 1  ON 46
eH2_7                 1.534562e-01 1 1  ON 47
eH2_8                 1.710377e-01 1 1  ON 48
eH2_9                 3.594499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9391
    reference variance = 0.234013
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.0000e+06
  Execution time = 1.8956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342784767763
                                         uncertainty =       0.004229465446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342784767763
                                         uncertainty =       0.004229465446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413959574
  error estimate for blocks of size 2^( 2) =       0.000426760450
  error estimate for blocks of size 2^( 3) =       0.000439206119
  error estimate for blocks of size 2^( 4) =       0.000451354580
  error estimate for blocks of size 2^( 5) =       0.000463720078
  error estimate for blocks of size 2^( 6) =       0.000472787267
  error estimate for blocks of size 2^( 7) =       0.000479527829

      target function =                  N/A
              le_mean =     -16.906012257157
             les_mean =     286.155975326329
             stat err =       0.000466847439
             autocorr =       1.271844736316
              std dev =       0.585427244447
             le_variance =       0.342725058541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342806422954
                                         uncertainty =       0.004229615260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342806422954
                                         uncertainty =       0.004229615260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413972634
  error estimate for blocks of size 2^( 2) =       0.000426771131
  error estimate for blocks of size 2^( 3) =       0.000439214479
  error estimate for blocks of size 2^( 4) =       0.000451361671
  error estimate for blocks of size 2^( 5) =       0.000463727299
  error estimate for blocks of size 2^( 6) =       0.000472792118
  error estimate for blocks of size 2^( 7) =       0.000479531885

      target function =                  N/A
              le_mean =     -16.906012111102
             les_mean =     286.155992012763
             stat err =       0.000466853243
             autocorr =       1.271796118624
              std dev =       0.585445713465
             le_variance =       0.342746683414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342794990436
                                         uncertainty =       0.004229493484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342794990436
                                         uncertainty =       0.004229493484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413965739
  error estimate for blocks of size 2^( 2) =       0.000426765241
  error estimate for blocks of size 2^( 3) =       0.000439209647
  error estimate for blocks of size 2^( 4) =       0.000451357460
  error estimate for blocks of size 2^( 5) =       0.000463723088
  error estimate for blocks of size 2^( 6) =       0.000472788947
  error estimate for blocks of size 2^( 7) =       0.000479528869

      target function =                  N/A
              le_mean =     -16.906012167643
             les_mean =     286.155982507309
             stat err =       0.000466849591
             autocorr =       1.271818584897
              std dev =       0.585435962494
             le_variance =       0.342735266181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342786162788
                                         uncertainty =       0.004229464988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342786162788
                                         uncertainty =       0.004229464988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413960416
  error estimate for blocks of size 2^( 2) =       0.000426761104
  error estimate for blocks of size 2^( 3) =       0.000439206603
  error estimate for blocks of size 2^( 4) =       0.000451354982
  error estimate for blocks of size 2^( 5) =       0.000463720501
  error estimate for blocks of size 2^( 6) =       0.000472787521
  error estimate for blocks of size 2^( 7) =       0.000479527972

      target function =                  N/A
              le_mean =     -16.906012242758
             les_mean =     286.155976232464
             stat err =       0.000466847744
             autocorr =       1.271841231989
              std dev =       0.585428434173
             le_variance =       0.342726451539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906012257157        initial  <--
     9.7656e-01     9.7656e+00             2.0490e-04       -16.906012111102
     3.9062e+00     3.9062e+01             5.3580e-05       -16.906012167643
     1.5625e+01     1.5625e+02             1.3491e-05       -16.906012242758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1387
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.089088e-01 1 1  ON 0
 uu_1                 1.424316e-01 1 1  ON 1
 uu_2                 4.119168e-02 1 1  ON 2
 uu_3                -2.076671e-02 1 1  ON 3
 uu_4                -6.531220e-02 1 1  ON 4
 uu_5                -9.911399e-02 1 1  ON 5
 uu_6                -1.252170e-01 1 1  ON 6
 uu_7                -1.376020e-01 1 1  ON 7
 uu_8                -1.295569e-01 1 1  ON 8
 uu_9                -9.896090e-02 1 1  ON 9
 ud_0                 4.458439e-01 1 1  ON 10
 ud_1                 1.801098e-01 1 1  ON 11
 ud_2                 6.022951e-02 1 1  ON 12
 ud_3                -1.055908e-02 1 1  ON 13
 ud_4                -6.706349e-02 1 1  ON 14
 ud_5                -1.078523e-01 1 1  ON 15
 ud_6                -1.344871e-01 1 1  ON 16
 ud_7                -1.495536e-01 1 1  ON 17
 ud_8                -1.486339e-01 1 1  ON 18
 ud_9                -1.374098e-01 1 1  ON 19
 eO_0                -7.561461e-01 1 1  ON 20
 eO_1                -4.358450e-01 1 1  ON 21
 eO_2                -1.866662e-02 1 1  ON 22
 eO_3                 2.975498e-01 1 1  ON 23
 eO_4                 5.197674e-01 1 1  ON 24
 eO_5                 4.777107e-01 1 1  ON 25
 eO_6                 2.467373e-01 1 1  ON 26
 eO_7                -4.893921e-02 1 1  ON 27
 eO_8                -2.111440e-01 1 1  ON 28
 eO_9                -7.175250e-02 1 1  ON 29
eH1_0                -2.410049e-01 1 1  ON 30
eH1_1                -1.395012e-01 1 1  ON 31
eH1_2                -9.264455e-02 1 1  ON 32
eH1_3                -3.892102e-02 1 1  ON 33
eH1_4                 8.601607e-03 1 1  ON 34
eH1_5                 4.250052e-02 1 1  ON 35
eH1_6                 9.982258e-02 1 1  ON 36
eH1_7                 1.502129e-01 1 1  ON 37
eH1_8                 1.648160e-01 1 1  ON 38
eH1_9                 5.052852e-02 1 1  ON 39
eH2_0                -2.394016e-01 1 1  ON 40
eH2_1                -1.378381e-01 1 1  ON 41
eH2_2                -9.110909e-02 1 1  ON 42
eH2_3                -3.713074e-02 1 1  ON 43
eH2_4                 1.177304e-02 1 1  ON 44
eH2_5                 4.682082e-02 1 1  ON 45
eH2_6                 1.032712e-01 1 1  ON 46
eH2_7                 1.534391e-01 1 1  ON 47
eH2_8                 1.710084e-01 1 1  ON 48
eH2_9                 3.590710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9306
    reference variance = 0.343572
====================================================
  Execution time = 6.7122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348078464033
                                         uncertainty =       0.007876697717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348078464033
                                         uncertainty =       0.007876697717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417584861
  error estimate for blocks of size 2^( 2) =       0.000430212534
  error estimate for blocks of size 2^( 3) =       0.000443256856
  error estimate for blocks of size 2^( 4) =       0.000454912318
  error estimate for blocks of size 2^( 5) =       0.000465615688
  error estimate for blocks of size 2^( 6) =       0.000474074930
  error estimate for blocks of size 2^( 7) =       0.000477513913

      target function =                  N/A
              le_mean =     -16.906194185190
             les_mean =     286.168155885964
             stat err =       0.000468029212
             autocorr =       1.256193174276
              std dev =       0.590554174487
             le_variance =       0.348754233005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619418519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194185190       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194285010       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194331226       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194358355       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194423116       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194426162       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194417984       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194403479       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.616011e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194185190       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194210394       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194222120       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194229164       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194245684       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194246456       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194244323       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194240669       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.565051e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194185190       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194191506       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194194449       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194196227       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194200378       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194200573       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194200035       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194199119       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.642822e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 7.2756e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.089102e-01 1 1  ON 0
 uu_1                 1.424364e-01 1 1  ON 1
 uu_2                 4.119649e-02 1 1  ON 2
 uu_3                -2.076437e-02 1 1  ON 3
 uu_4                -6.531178e-02 1 1  ON 4
 uu_5                -9.911218e-02 1 1  ON 5
 uu_6                -1.252224e-01 1 1  ON 6
 uu_7                -1.376086e-01 1 1  ON 7
 uu_8                -1.295609e-01 1 1  ON 8
 uu_9                -9.896372e-02 1 1  ON 9
 ud_0                 4.458435e-01 1 1  ON 10
 ud_1                 1.801139e-01 1 1  ON 11
 ud_2                 6.023072e-02 1 1  ON 12
 ud_3                -1.055839e-02 1 1  ON 13
 ud_4                -6.706315e-02 1 1  ON 14
 ud_5                -1.078506e-01 1 1  ON 15
 ud_6                -1.344831e-01 1 1  ON 16
 ud_7                -1.495527e-01 1 1  ON 17
 ud_8                -1.486389e-01 1 1  ON 18
 ud_9                -1.374140e-01 1 1  ON 19
 eO_0                -7.561473e-01 1 1  ON 20
 eO_1                -4.358469e-01 1 1  ON 21
 eO_2                -1.866493e-02 1 1  ON 22
 eO_3                 2.975512e-01 1 1  ON 23
 eO_4                 5.197696e-01 1 1  ON 24
 eO_5                 4.777136e-01 1 1  ON 25
 eO_6                 2.467410e-01 1 1  ON 26
 eO_7                -4.893945e-02 1 1  ON 27
 eO_8                -2.111486e-01 1 1  ON 28
 eO_9                -7.175593e-02 1 1  ON 29
eH1_0                -2.410081e-01 1 1  ON 30
eH1_1                -1.395023e-01 1 1  ON 31
eH1_2                -9.264729e-02 1 1  ON 32
eH1_3                -3.892372e-02 1 1  ON 33
eH1_4                 8.604848e-03 1 1  ON 34
eH1_5                 4.250193e-02 1 1  ON 35
eH1_6                 9.982264e-02 1 1  ON 36
eH1_7                 1.502120e-01 1 1  ON 37
eH1_8                 1.648175e-01 1 1  ON 38
eH1_9                 5.053237e-02 1 1  ON 39
eH2_0                -2.394028e-01 1 1  ON 40
eH2_1                -1.378433e-01 1 1  ON 41
eH2_2                -9.110821e-02 1 1  ON 42
eH2_3                -3.712981e-02 1 1  ON 43
eH2_4                 1.177282e-02 1 1  ON 44
eH2_5                 4.682144e-02 1 1  ON 45
eH2_6                 1.032694e-01 1 1  ON 46
eH2_7                 1.534398e-01 1 1  ON 47
eH2_8                 1.710113e-01 1 1  ON 48
eH2_9                 3.591032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.7746
    reference variance = 0.452051
====================================================
  Execution time = 1.9943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4264e-01
  Total weights = 2.0000e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342601368513
                                         uncertainty =       0.004886748839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342601368513
                                         uncertainty =       0.004886748839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413907207
  error estimate for blocks of size 2^( 2) =       0.000426299370
  error estimate for blocks of size 2^( 3) =       0.000439576117
  error estimate for blocks of size 2^( 4) =       0.000451275216
  error estimate for blocks of size 2^( 5) =       0.000461590966
  error estimate for blocks of size 2^( 6) =       0.000467527996
  error estimate for blocks of size 2^( 7) =       0.000471601785

      target function =                  N/A
              le_mean =     -16.905691637769
             les_mean =     286.145047931643
             stat err =       0.000462998991
             autocorr =       1.251278874805
              std dev =       0.585353185363
             le_variance =       0.342638351615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342591017112
                                         uncertainty =       0.004886574802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342591017112
                                         uncertainty =       0.004886574802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413900957
  error estimate for blocks of size 2^( 2) =       0.000426293088
  error estimate for blocks of size 2^( 3) =       0.000439569744
  error estimate for blocks of size 2^( 4) =       0.000451268914
  error estimate for blocks of size 2^( 5) =       0.000461584770
  error estimate for blocks of size 2^( 6) =       0.000467522152
  error estimate for blocks of size 2^( 7) =       0.000471596505

      target function =                  N/A
              le_mean =     -16.905691604410
             les_mean =     286.145036455842
             stat err =       0.000462993085
             autocorr =       1.251284743679
              std dev =       0.585344346291
             le_variance =       0.342628003734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342595918814
                                         uncertainty =       0.004886655258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342595918814
                                         uncertainty =       0.004886655258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413903916
  error estimate for blocks of size 2^( 2) =       0.000426296068
  error estimate for blocks of size 2^( 3) =       0.000439572773
  error estimate for blocks of size 2^( 4) =       0.000451271911
  error estimate for blocks of size 2^( 5) =       0.000461587716
  error estimate for blocks of size 2^( 6) =       0.000467524927
  error estimate for blocks of size 2^( 7) =       0.000471599003

      target function =                  N/A
              le_mean =     -16.905691620171
             les_mean =     286.145041888695
             stat err =       0.000462995889
             autocorr =       1.251282006904
              std dev =       0.585348531812
             le_variance =       0.342632903695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342600678107
                                         uncertainty =       0.004886736925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342600678107
                                         uncertainty =       0.004886736925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413906790
  error estimate for blocks of size 2^( 2) =       0.000426298952
  error estimate for blocks of size 2^( 3) =       0.000439575694
  error estimate for blocks of size 2^( 4) =       0.000451274798
  error estimate for blocks of size 2^( 5) =       0.000461590554
  error estimate for blocks of size 2^( 6) =       0.000467527608
  error estimate for blocks of size 2^( 7) =       0.000471601432

      target function =                  N/A
              le_mean =     -16.905691635501
             les_mean =     286.145047164746
             stat err =       0.000462998598
             autocorr =       1.251279272668
              std dev =       0.585352595819
             le_variance =       0.342637661432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905691637769        initial  <--
     9.7656e+00     9.7656e+01             2.6160e-05       -16.905691604410
     3.9062e+01     3.9062e+02             6.5651e-06       -16.905691620171
     1.5625e+02     1.5625e+03             1.6428e-06       -16.905691635501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3869
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.089088e-01 1 1  ON 0
 uu_1                 1.424316e-01 1 1  ON 1
 uu_2                 4.119168e-02 1 1  ON 2
 uu_3                -2.076671e-02 1 1  ON 3
 uu_4                -6.531220e-02 1 1  ON 4
 uu_5                -9.911399e-02 1 1  ON 5
 uu_6                -1.252170e-01 1 1  ON 6
 uu_7                -1.376020e-01 1 1  ON 7
 uu_8                -1.295569e-01 1 1  ON 8
 uu_9                -9.896090e-02 1 1  ON 9
 ud_0                 4.458439e-01 1 1  ON 10
 ud_1                 1.801098e-01 1 1  ON 11
 ud_2                 6.022951e-02 1 1  ON 12
 ud_3                -1.055908e-02 1 1  ON 13
 ud_4                -6.706349e-02 1 1  ON 14
 ud_5                -1.078523e-01 1 1  ON 15
 ud_6                -1.344871e-01 1 1  ON 16
 ud_7                -1.495536e-01 1 1  ON 17
 ud_8                -1.486339e-01 1 1  ON 18
 ud_9                -1.374098e-01 1 1  ON 19
 eO_0                -7.561461e-01 1 1  ON 20
 eO_1                -4.358450e-01 1 1  ON 21
 eO_2                -1.866662e-02 1 1  ON 22
 eO_3                 2.975498e-01 1 1  ON 23
 eO_4                 5.197674e-01 1 1  ON 24
 eO_5                 4.777107e-01 1 1  ON 25
 eO_6                 2.467373e-01 1 1  ON 26
 eO_7                -4.893921e-02 1 1  ON 27
 eO_8                -2.111440e-01 1 1  ON 28
 eO_9                -7.175250e-02 1 1  ON 29
eH1_0                -2.410049e-01 1 1  ON 30
eH1_1                -1.395012e-01 1 1  ON 31
eH1_2                -9.264455e-02 1 1  ON 32
eH1_3                -3.892102e-02 1 1  ON 33
eH1_4                 8.601607e-03 1 1  ON 34
eH1_5                 4.250052e-02 1 1  ON 35
eH1_6                 9.982258e-02 1 1  ON 36
eH1_7                 1.502129e-01 1 1  ON 37
eH1_8                 1.648160e-01 1 1  ON 38
eH1_9                 5.052852e-02 1 1  ON 39
eH2_0                -2.394016e-01 1 1  ON 40
eH2_1                -1.378381e-01 1 1  ON 41
eH2_2                -9.110909e-02 1 1  ON 42
eH2_3                -3.713074e-02 1 1  ON 43
eH2_4                 1.177304e-02 1 1  ON 44
eH2_5                 4.682082e-02 1 1  ON 45
eH2_6                 1.032712e-01 1 1  ON 46
eH2_7                 1.534391e-01 1 1  ON 47
eH2_8                 1.710084e-01 1 1  ON 48
eH2_9                 3.590710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0218e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8384
    reference variance = 0.300062
====================================================
  Execution time = 2.1457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344619510052
                                         uncertainty =       0.009139668743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344619510052
                                         uncertainty =       0.009139668743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415054444
  error estimate for blocks of size 2^( 2) =       0.000427771807
  error estimate for blocks of size 2^( 3) =       0.000441051444
  error estimate for blocks of size 2^( 4) =       0.000453059527
  error estimate for blocks of size 2^( 5) =       0.000464190493
  error estimate for blocks of size 2^( 6) =       0.000471879444
  error estimate for blocks of size 2^( 7) =       0.000479962242

      target function =                  N/A
              le_mean =     -16.905572515448
             les_mean =     286.142922285924
             stat err =       0.000467272926
             autocorr =       1.267450774030
              std dev =       0.586975623961
             le_variance =       0.344540383125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557251545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905572515448       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905572518151       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905572519370       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905572526501       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905572529865       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905572530558       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905572528821       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905572528624       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.324173e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905572515448       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905572516124       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905572516427       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905572518209       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905572519058       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905572519223       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905572518791       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905572518742       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.810824e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905572515448       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905572515617       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905572515693       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905572516138       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905572516351       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905572516391       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905572516284       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905572516273       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.452730e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7016e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.089090e-01 1 1  ON 0
 uu_1                 1.424318e-01 1 1  ON 1
 uu_2                 4.119175e-02 1 1  ON 2
 uu_3                -2.076646e-02 1 1  ON 3
 uu_4                -6.531220e-02 1 1  ON 4
 uu_5                -9.911404e-02 1 1  ON 5
 uu_6                -1.252171e-01 1 1  ON 6
 uu_7                -1.376022e-01 1 1  ON 7
 uu_8                -1.295574e-01 1 1  ON 8
 uu_9                -9.896125e-02 1 1  ON 9
 ud_0                 4.458440e-01 1 1  ON 10
 ud_1                 1.801099e-01 1 1  ON 11
 ud_2                 6.022986e-02 1 1  ON 12
 ud_3                -1.055899e-02 1 1  ON 13
 ud_4                -6.706355e-02 1 1  ON 14
 ud_5                -1.078523e-01 1 1  ON 15
 ud_6                -1.344870e-01 1 1  ON 16
 ud_7                -1.495536e-01 1 1  ON 17
 ud_8                -1.486342e-01 1 1  ON 18
 ud_9                -1.374100e-01 1 1  ON 19
 eO_0                -7.561460e-01 1 1  ON 20
 eO_1                -4.358452e-01 1 1  ON 21
 eO_2                -1.866673e-02 1 1  ON 22
 eO_3                 2.975499e-01 1 1  ON 23
 eO_4                 5.197677e-01 1 1  ON 24
 eO_5                 4.777107e-01 1 1  ON 25
 eO_6                 2.467377e-01 1 1  ON 26
 eO_7                -4.893895e-02 1 1  ON 27
 eO_8                -2.111445e-01 1 1  ON 28
 eO_9                -7.175289e-02 1 1  ON 29
eH1_0                -2.410052e-01 1 1  ON 30
eH1_1                -1.395015e-01 1 1  ON 31
eH1_2                -9.264492e-02 1 1  ON 32
eH1_3                -3.892123e-02 1 1  ON 33
eH1_4                 8.601785e-03 1 1  ON 34
eH1_5                 4.250055e-02 1 1  ON 35
eH1_6                 9.982222e-02 1 1  ON 36
eH1_7                 1.502129e-01 1 1  ON 37
eH1_8                 1.648166e-01 1 1  ON 38
eH1_9                 5.052904e-02 1 1  ON 39
eH2_0                -2.394018e-01 1 1  ON 40
eH2_1                -1.378383e-01 1 1  ON 41
eH2_2                -9.110921e-02 1 1  ON 42
eH2_3                -3.713071e-02 1 1  ON 43
eH2_4                 1.177251e-02 1 1  ON 44
eH2_5                 4.682089e-02 1 1  ON 45
eH2_6                 1.032713e-01 1 1  ON 46
eH2_7                 1.534391e-01 1 1  ON 47
eH2_8                 1.710089e-01 1 1  ON 48
eH2_9                 3.590753e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.347378
====================================================
  Execution time = 2.0856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3602e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981310051
                                         uncertainty =       0.003956030736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981310051
                                         uncertainty =       0.003956030736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409892278
  error estimate for blocks of size 2^( 2) =       0.000422548700
  error estimate for blocks of size 2^( 3) =       0.000435312700
  error estimate for blocks of size 2^( 4) =       0.000447975482
  error estimate for blocks of size 2^( 5) =       0.000458434685
  error estimate for blocks of size 2^( 6) =       0.000466076650
  error estimate for blocks of size 2^( 7) =       0.000470417646

      target function =                  N/A
              le_mean =     -16.906033237502
             les_mean =     286.149983019312
             stat err =       0.000460726116
             autocorr =       1.263415459153
              std dev =       0.579675219238
             le_variance =       0.336023359799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335980811438
                                         uncertainty =       0.003956029135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335980811438
                                         uncertainty =       0.003956029135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409891974
  error estimate for blocks of size 2^( 2) =       0.000422548404
  error estimate for blocks of size 2^( 3) =       0.000435312409
  error estimate for blocks of size 2^( 4) =       0.000447975193
  error estimate for blocks of size 2^( 5) =       0.000458434412
  error estimate for blocks of size 2^( 6) =       0.000466076382
  error estimate for blocks of size 2^( 7) =       0.000470417396

      target function =                  N/A
              le_mean =     -16.906033240319
             les_mean =     286.149982615682
             stat err =       0.000460725846
             autocorr =       1.263415853605
              std dev =       0.579674788917
             le_variance =       0.336022860905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981060181
                                         uncertainty =       0.003956029931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981060181
                                         uncertainty =       0.003956029931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409892126
  error estimate for blocks of size 2^( 2) =       0.000422548552
  error estimate for blocks of size 2^( 3) =       0.000435312555
  error estimate for blocks of size 2^( 4) =       0.000447975337
  error estimate for blocks of size 2^( 5) =       0.000458434548
  error estimate for blocks of size 2^( 6) =       0.000466076516
  error estimate for blocks of size 2^( 7) =       0.000470417521

      target function =                  N/A
              le_mean =     -16.906033238928
             les_mean =     286.149982817517
             stat err =       0.000460725980
             autocorr =       1.263415657300
              std dev =       0.579675003592
             le_variance =       0.336023109790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981278798
                                         uncertainty =       0.003956030635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335981278798
                                         uncertainty =       0.003956030635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409892259
  error estimate for blocks of size 2^( 2) =       0.000422548682
  error estimate for blocks of size 2^( 3) =       0.000435312682
  error estimate for blocks of size 2^( 4) =       0.000447975464
  error estimate for blocks of size 2^( 5) =       0.000458434668
  error estimate for blocks of size 2^( 6) =       0.000466076633
  error estimate for blocks of size 2^( 7) =       0.000470417630

      target function =                  N/A
              le_mean =     -16.906033237681
             les_mean =     286.149982994079
             stat err =       0.000460726099
             autocorr =       1.263415483944
              std dev =       0.579675192266
             le_variance =       0.336023328529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906033237502        initial
     9.7656e+01     9.7656e+02             2.3242e-06       -16.906033240319  <--
     3.9062e+02     3.9062e+03             5.8108e-07       -16.906033238928
     1.5625e+03     1.5625e+04             1.4527e-07       -16.906033237681

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 3.0301e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.089094e-01 1 1  ON 0
 uu_1                 1.424323e-01 1 1  ON 1
 uu_2                 4.119196e-02 1 1  ON 2
 uu_3                -2.076569e-02 1 1  ON 3
 uu_4                -6.531219e-02 1 1  ON 4
 uu_5                -9.911421e-02 1 1  ON 5
 uu_6                -1.252171e-01 1 1  ON 6
 uu_7                -1.376029e-01 1 1  ON 7
 uu_8                -1.295588e-01 1 1  ON 8
 uu_9                -9.896231e-02 1 1  ON 9
 ud_0                 4.458443e-01 1 1  ON 10
 ud_1                 1.801102e-01 1 1  ON 11
 ud_2                 6.023090e-02 1 1  ON 12
 ud_3                -1.055874e-02 1 1  ON 13
 ud_4                -6.706375e-02 1 1  ON 14
 ud_5                -1.078525e-01 1 1  ON 15
 ud_6                -1.344865e-01 1 1  ON 16
 ud_7                -1.495537e-01 1 1  ON 17
 ud_8                -1.486350e-01 1 1  ON 18
 ud_9                -1.374106e-01 1 1  ON 19
 eO_0                -7.561455e-01 1 1  ON 20
 eO_1                -4.358458e-01 1 1  ON 21
 eO_2                -1.866709e-02 1 1  ON 22
 eO_3                 2.975500e-01 1 1  ON 23
 eO_4                 5.197688e-01 1 1  ON 24
 eO_5                 4.777110e-01 1 1  ON 25
 eO_6                 2.467387e-01 1 1  ON 26
 eO_7                -4.893816e-02 1 1  ON 27
 eO_8                -2.111459e-01 1 1  ON 28
 eO_9                -7.175406e-02 1 1  ON 29
eH1_0                -2.410058e-01 1 1  ON 30
eH1_1                -1.395023e-01 1 1  ON 31
eH1_2                -9.264605e-02 1 1  ON 32
eH1_3                -3.892185e-02 1 1  ON 33
eH1_4                 8.602319e-03 1 1  ON 34
eH1_5                 4.250062e-02 1 1  ON 35
eH1_6                 9.982113e-02 1 1  ON 36
eH1_7                 1.502131e-01 1 1  ON 37
eH1_8                 1.648183e-01 1 1  ON 38
eH1_9                 5.053059e-02 1 1  ON 39
eH2_0                -2.394022e-01 1 1  ON 40
eH2_1                -1.378390e-01 1 1  ON 41
eH2_2                -9.110957e-02 1 1  ON 42
eH2_3                -3.713062e-02 1 1  ON 43
eH2_4                 1.177093e-02 1 1  ON 44
eH2_5                 4.682109e-02 1 1  ON 45
eH2_6                 1.032716e-01 1 1  ON 46
eH2_7                 1.534390e-01 1 1  ON 47
eH2_8                 1.710102e-01 1 1  ON 48
eH2_9                 3.590881e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8434
    reference variance = 0.328449
====================================================
  Execution time = 2.0735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348722091049
                                         uncertainty =       0.009169033305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348722091049
                                         uncertainty =       0.009169033305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417531582
  error estimate for blocks of size 2^( 2) =       0.000430574897
  error estimate for blocks of size 2^( 3) =       0.000443481438
  error estimate for blocks of size 2^( 4) =       0.000456263644
  error estimate for blocks of size 2^( 5) =       0.000467629597
  error estimate for blocks of size 2^( 6) =       0.000475283371
  error estimate for blocks of size 2^( 7) =       0.000479458191

      target function =                  N/A
              le_mean =     -16.905790864416
             les_mean =     286.154429820346
             stat err =       0.000469658701
             autocorr =       1.265278368536
              std dev =       0.590478825454
             le_variance =       0.348665243310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579086442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790864416       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905790878693       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905790855506       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790862934       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790905460       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905790916441       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905790912674       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905790911404       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.420361e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790864416       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905790868011       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905790862149       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790863986       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790874644       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905790877449       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905790876579       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905790876242       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.355104e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790864416       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905790865316       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905790863847       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790864305       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790866971       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905790867676       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905790867462       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905790867376       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.887774e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6260e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.089096e-01 1 1  ON 0
 uu_1                 1.424326e-01 1 1  ON 1
 uu_2                 4.119305e-02 1 1  ON 2
 uu_3                -2.076590e-02 1 1  ON 3
 uu_4                -6.531232e-02 1 1  ON 4
 uu_5                -9.911451e-02 1 1  ON 5
 uu_6                -1.252174e-01 1 1  ON 6
 uu_7                -1.376044e-01 1 1  ON 7
 uu_8                -1.295595e-01 1 1  ON 8
 uu_9                -9.896252e-02 1 1  ON 9
 ud_0                 4.458431e-01 1 1  ON 10
 ud_1                 1.801107e-01 1 1  ON 11
 ud_2                 6.023177e-02 1 1  ON 12
 ud_3                -1.055863e-02 1 1  ON 13
 ud_4                -6.706370e-02 1 1  ON 14
 ud_5                -1.078515e-01 1 1  ON 15
 ud_6                -1.344857e-01 1 1  ON 16
 ud_7                -1.495546e-01 1 1  ON 17
 ud_8                -1.486371e-01 1 1  ON 18
 ud_9                -1.374104e-01 1 1  ON 19
 eO_0                -7.561458e-01 1 1  ON 20
 eO_1                -4.358476e-01 1 1  ON 21
 eO_2                -1.866690e-02 1 1  ON 22
 eO_3                 2.975507e-01 1 1  ON 23
 eO_4                 5.197691e-01 1 1  ON 24
 eO_5                 4.777123e-01 1 1  ON 25
 eO_6                 2.467402e-01 1 1  ON 26
 eO_7                -4.893760e-02 1 1  ON 27
 eO_8                -2.111472e-01 1 1  ON 28
 eO_9                -7.175512e-02 1 1  ON 29
eH1_0                -2.410072e-01 1 1  ON 30
eH1_1                -1.395033e-01 1 1  ON 31
eH1_2                -9.264753e-02 1 1  ON 32
eH1_3                -3.892273e-02 1 1  ON 33
eH1_4                 8.601850e-03 1 1  ON 34
eH1_5                 4.250042e-02 1 1  ON 35
eH1_6                 9.982135e-02 1 1  ON 36
eH1_7                 1.502141e-01 1 1  ON 37
eH1_8                 1.648201e-01 1 1  ON 38
eH1_9                 5.053261e-02 1 1  ON 39
eH2_0                -2.394039e-01 1 1  ON 40
eH2_1                -1.378406e-01 1 1  ON 41
eH2_2                -9.110838e-02 1 1  ON 42
eH2_3                -3.713167e-02 1 1  ON 43
eH2_4                 1.177058e-02 1 1  ON 44
eH2_5                 4.681983e-02 1 1  ON 45
eH2_6                 1.032710e-01 1 1  ON 46
eH2_7                 1.534400e-01 1 1  ON 47
eH2_8                 1.710121e-01 1 1  ON 48
eH2_9                 3.591116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.268533
====================================================
  Execution time = 2.0555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.0000e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335323087919
                                         uncertainty =       0.003079631598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335323087919
                                         uncertainty =       0.003079631598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409418235
  error estimate for blocks of size 2^( 2) =       0.000422294328
  error estimate for blocks of size 2^( 3) =       0.000435562146
  error estimate for blocks of size 2^( 4) =       0.000448107257
  error estimate for blocks of size 2^( 5) =       0.000460026754
  error estimate for blocks of size 2^( 6) =       0.000467730065
  error estimate for blocks of size 2^( 7) =       0.000472938163

      target function =                  N/A
              le_mean =     -16.905545286339
             les_mean =     286.132707842623
             stat err =       0.000462200560
             autocorr =       1.274461062339
              std dev =       0.579004820168
             le_variance =       0.335246581778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335314355297
                                         uncertainty =       0.003079572987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335314355297
                                         uncertainty =       0.003079572987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409412904
  error estimate for blocks of size 2^( 2) =       0.000422289255
  error estimate for blocks of size 2^( 3) =       0.000435557354
  error estimate for blocks of size 2^( 4) =       0.000448102647
  error estimate for blocks of size 2^( 5) =       0.000460022323
  error estimate for blocks of size 2^( 6) =       0.000467725769
  error estimate for blocks of size 2^( 7) =       0.000472933899

      target function =                  N/A
              le_mean =     -16.905545327597
             les_mean =     286.132700508344
             stat err =       0.000462196160
             autocorr =       1.274469981746
              std dev =       0.578997281962
             le_variance =       0.335237852519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335318659070
                                         uncertainty =       0.003079601840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335318659070
                                         uncertainty =       0.003079601840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409415531
  error estimate for blocks of size 2^( 2) =       0.000422291756
  error estimate for blocks of size 2^( 3) =       0.000435559716
  error estimate for blocks of size 2^( 4) =       0.000448104919
  error estimate for blocks of size 2^( 5) =       0.000460024508
  error estimate for blocks of size 2^( 6) =       0.000467727886
  error estimate for blocks of size 2^( 7) =       0.000472936002

      target function =                  N/A
              le_mean =     -16.905545307190
             les_mean =     286.132704120474
             stat err =       0.000462198329
             autocorr =       1.274465589758
              std dev =       0.579000997100
             le_variance =       0.335242154643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335322532293
                                         uncertainty =       0.003079627864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335322532293
                                         uncertainty =       0.003079627864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409417896
  error estimate for blocks of size 2^( 2) =       0.000422294006
  error estimate for blocks of size 2^( 3) =       0.000435561841
  error estimate for blocks of size 2^( 4) =       0.000448106964
  error estimate for blocks of size 2^( 5) =       0.000460026472
  error estimate for blocks of size 2^( 6) =       0.000467729791
  error estimate for blocks of size 2^( 7) =       0.000472937892

      target function =                  N/A
              le_mean =     -16.905545288948
             les_mean =     286.132707375408
             stat err =       0.000462200280
             autocorr =       1.274461630421
              std dev =       0.579004340543
             le_variance =       0.335246026368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905545286339        initial
     2.4414e+01     2.4414e+02             9.4204e-06       -16.905545327597  <--
     9.7656e+01     9.7656e+02             2.3551e-06       -16.905545307190
     3.9062e+02     3.9062e+03             5.8878e-07       -16.905545288948

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.0004e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.089101e-01 1 1  ON 0
 uu_1                 1.424337e-01 1 1  ON 1
 uu_2                 4.119629e-02 1 1  ON 2
 uu_3                -2.076648e-02 1 1  ON 3
 uu_4                -6.531269e-02 1 1  ON 4
 uu_5                -9.911541e-02 1 1  ON 5
 uu_6                -1.252182e-01 1 1  ON 6
 uu_7                -1.376088e-01 1 1  ON 7
 uu_8                -1.295618e-01 1 1  ON 8
 uu_9                -9.896318e-02 1 1  ON 9
 ud_0                 4.458395e-01 1 1  ON 10
 ud_1                 1.801125e-01 1 1  ON 11
 ud_2                 6.023434e-02 1 1  ON 12
 ud_3                -1.055827e-02 1 1  ON 13
 ud_4                -6.706354e-02 1 1  ON 14
 ud_5                -1.078487e-01 1 1  ON 15
 ud_6                -1.344833e-01 1 1  ON 16
 ud_7                -1.495570e-01 1 1  ON 17
 ud_8                -1.486434e-01 1 1  ON 18
 ud_9                -1.374096e-01 1 1  ON 19
 eO_0                -7.561466e-01 1 1  ON 20
 eO_1                -4.358528e-01 1 1  ON 21
 eO_2                -1.866635e-02 1 1  ON 22
 eO_3                 2.975527e-01 1 1  ON 23
 eO_4                 5.197700e-01 1 1  ON 24
 eO_5                 4.777163e-01 1 1  ON 25
 eO_6                 2.467445e-01 1 1  ON 26
 eO_7                -4.893589e-02 1 1  ON 27
 eO_8                -2.111510e-01 1 1  ON 28
 eO_9                -7.175829e-02 1 1  ON 29
eH1_0                -2.410114e-01 1 1  ON 30
eH1_1                -1.395064e-01 1 1  ON 31
eH1_2                -9.265194e-02 1 1  ON 32
eH1_3                -3.892537e-02 1 1  ON 33
eH1_4                 8.600431e-03 1 1  ON 34
eH1_5                 4.249982e-02 1 1  ON 35
eH1_6                 9.982198e-02 1 1  ON 36
eH1_7                 1.502173e-01 1 1  ON 37
eH1_8                 1.648254e-01 1 1  ON 38
eH1_9                 5.053866e-02 1 1  ON 39
eH2_0                -2.394088e-01 1 1  ON 40
eH2_1                -1.378453e-01 1 1  ON 41
eH2_2                -9.110485e-02 1 1  ON 42
eH2_3                -3.713481e-02 1 1  ON 43
eH2_4                 1.176951e-02 1 1  ON 44
eH2_5                 4.681607e-02 1 1  ON 45
eH2_6                 1.032691e-01 1 1  ON 46
eH2_7                 1.534429e-01 1 1  ON 47
eH2_8                 1.710181e-01 1 1  ON 48
eH2_9                 3.591823e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8714
    reference variance = 0.356419
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988933484
                                         uncertainty =       0.002827265539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988933484
                                         uncertainty =       0.002827265539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408621543
  error estimate for blocks of size 2^( 2) =       0.000421464373
  error estimate for blocks of size 2^( 3) =       0.000434793974
  error estimate for blocks of size 2^( 4) =       0.000447199223
  error estimate for blocks of size 2^( 5) =       0.000457625306
  error estimate for blocks of size 2^( 6) =       0.000466977181
  error estimate for blocks of size 2^( 7) =       0.000473776897

      target function =                  N/A
              le_mean =     -16.906239681622
             les_mean =     286.154883136183
             stat err =       0.000461394652
             autocorr =       1.274977713821
              std dev =       0.577878127885
             le_variance =       0.333943130688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623968162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239681622       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239825811       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239882391       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239951073       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906239967180       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240023704       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240022609       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240000667       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.118699e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239681622       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239718334       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239733022       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239750957       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906239755147       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906239769440       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906239769014       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.756411e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239681622       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239690843       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239694551       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239699087       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906239700145       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906239703731       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906239703614       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.940353e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5958e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.089141e-01 1 1  ON 0
 uu_1                 1.424314e-01 1 1  ON 1
 uu_2                 4.119824e-02 1 1  ON 2
 uu_3                -2.076559e-02 1 1  ON 3
 uu_4                -6.531196e-02 1 1  ON 4
 uu_5                -9.911402e-02 1 1  ON 5
 uu_6                -1.252206e-01 1 1  ON 6
 uu_7                -1.376112e-01 1 1  ON 7
 uu_8                -1.295695e-01 1 1  ON 8
 uu_9                -9.896693e-02 1 1  ON 9
 ud_0                 4.458418e-01 1 1  ON 10
 ud_1                 1.801145e-01 1 1  ON 11
 ud_2                 6.023399e-02 1 1  ON 12
 ud_3                -1.055475e-02 1 1  ON 13
 ud_4                -6.706449e-02 1 1  ON 14
 ud_5                -1.078499e-01 1 1  ON 15
 ud_6                -1.344852e-01 1 1  ON 16
 ud_7                -1.495574e-01 1 1  ON 17
 ud_8                -1.486454e-01 1 1  ON 18
 ud_9                -1.374114e-01 1 1  ON 19
 eO_0                -7.561477e-01 1 1  ON 20
 eO_1                -4.358538e-01 1 1  ON 21
 eO_2                -1.867252e-02 1 1  ON 22
 eO_3                 2.975547e-01 1 1  ON 23
 eO_4                 5.197726e-01 1 1  ON 24
 eO_5                 4.777231e-01 1 1  ON 25
 eO_6                 2.467519e-01 1 1  ON 26
 eO_7                -4.893525e-02 1 1  ON 27
 eO_8                -2.111572e-01 1 1  ON 28
 eO_9                -7.176307e-02 1 1  ON 29
eH1_0                -2.410171e-01 1 1  ON 30
eH1_1                -1.395115e-01 1 1  ON 31
eH1_2                -9.265624e-02 1 1  ON 32
eH1_3                -3.892759e-02 1 1  ON 33
eH1_4                 8.599319e-03 1 1  ON 34
eH1_5                 4.249948e-02 1 1  ON 35
eH1_6                 9.981997e-02 1 1  ON 36
eH1_7                 1.502216e-01 1 1  ON 37
eH1_8                 1.648330e-01 1 1  ON 38
eH1_9                 5.054626e-02 1 1  ON 39
eH2_0                -2.394126e-01 1 1  ON 40
eH2_1                -1.378464e-01 1 1  ON 41
eH2_2                -9.110493e-02 1 1  ON 42
eH2_3                -3.713614e-02 1 1  ON 43
eH2_4                 1.176335e-02 1 1  ON 44
eH2_5                 4.680996e-02 1 1  ON 45
eH2_6                 1.032699e-01 1 1  ON 46
eH2_7                 1.534486e-01 1 1  ON 47
eH2_8                 1.710230e-01 1 1  ON 48
eH2_9                 3.592525e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.863
    reference variance = 0.278093
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3924e-01
  Total weights = 2.0000e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339289895147
                                         uncertainty =       0.003982826534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339289895147
                                         uncertainty =       0.003982826534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411846237
  error estimate for blocks of size 2^( 2) =       0.000424329815
  error estimate for blocks of size 2^( 3) =       0.000437502165
  error estimate for blocks of size 2^( 4) =       0.000450409593
  error estimate for blocks of size 2^( 5) =       0.000461633219
  error estimate for blocks of size 2^( 6) =       0.000468839183
  error estimate for blocks of size 2^( 7) =       0.000473376938

      target function =                  N/A
              le_mean =     -16.905597882783
             les_mean =     286.138474250531
             stat err =       0.000463564733
             autocorr =       1.266924028403
              std dev =       0.582438533903
             le_variance =       0.339234645775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339295051922
                                         uncertainty =       0.003982920695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339295051922
                                         uncertainty =       0.003982920695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411849369
  error estimate for blocks of size 2^( 2) =       0.000424332865
  error estimate for blocks of size 2^( 3) =       0.000437505106
  error estimate for blocks of size 2^( 4) =       0.000450412188
  error estimate for blocks of size 2^( 5) =       0.000461635618
  error estimate for blocks of size 2^( 6) =       0.000468841618
  error estimate for blocks of size 2^( 7) =       0.000473378943

      target function =                  N/A
              le_mean =     -16.905597904856
             les_mean =     286.138480156348
             stat err =       0.000463567092
             autocorr =       1.266917651126
              std dev =       0.582442963125
             le_variance =       0.339239805294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292520915
                                         uncertainty =       0.003982880807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292520915
                                         uncertainty =       0.003982880807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411847832
  error estimate for blocks of size 2^( 2) =       0.000424331365
  error estimate for blocks of size 2^( 3) =       0.000437503661
  error estimate for blocks of size 2^( 4) =       0.000450410925
  error estimate for blocks of size 2^( 5) =       0.000461634463
  error estimate for blocks of size 2^( 6) =       0.000468840467
  error estimate for blocks of size 2^( 7) =       0.000473377993

      target function =                  N/A
              le_mean =     -16.905597897811
             les_mean =     286.138477385712
             stat err =       0.000463565962
             autocorr =       1.266920934170
              std dev =       0.582440789153
             le_variance =       0.339237272869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339290227485
                                         uncertainty =       0.003982833398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339290227485
                                         uncertainty =       0.003982833398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411846439
  error estimate for blocks of size 2^( 2) =       0.000424330011
  error estimate for blocks of size 2^( 3) =       0.000437502354
  error estimate for blocks of size 2^( 4) =       0.000450409762
  error estimate for blocks of size 2^( 5) =       0.000461633376
  error estimate for blocks of size 2^( 6) =       0.000468839345
  error estimate for blocks of size 2^( 7) =       0.000473377072

      target function =                  N/A
              le_mean =     -16.905597884575
             les_mean =     286.138474643602
             stat err =       0.000463564889
             autocorr =       1.266923635856
              std dev =       0.582438819345
             le_variance =       0.339234978280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905597882783        initial
     6.1035e+00     6.1035e+01             3.1187e-05       -16.905597904856  <--
     2.4414e+01     2.4414e+02             7.7564e-06       -16.905597897811
     9.7656e+01     9.7656e+02             1.9404e-06       -16.905597884575

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9500e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.089260e-01 1 1  ON 0
 uu_1                 1.424268e-01 1 1  ON 1
 uu_2                 4.120304e-02 1 1  ON 2
 uu_3                -2.076366e-02 1 1  ON 3
 uu_4                -6.530944e-02 1 1  ON 4
 uu_5                -9.911073e-02 1 1  ON 5
 uu_6                -1.252284e-01 1 1  ON 6
 uu_7                -1.376181e-01 1 1  ON 7
 uu_8                -1.295927e-01 1 1  ON 8
 uu_9                -9.897822e-02 1 1  ON 9
 ud_0                 4.458483e-01 1 1  ON 10
 ud_1                 1.801198e-01 1 1  ON 11
 ud_2                 6.023419e-02 1 1  ON 12
 ud_3                -1.054497e-02 1 1  ON 13
 ud_4                -6.706674e-02 1 1  ON 14
 ud_5                -1.078533e-01 1 1  ON 15
 ud_6                -1.344913e-01 1 1  ON 16
 ud_7                -1.495586e-01 1 1  ON 17
 ud_8                -1.486512e-01 1 1  ON 18
 ud_9                -1.374166e-01 1 1  ON 19
 eO_0                -7.561517e-01 1 1  ON 20
 eO_1                -4.358575e-01 1 1  ON 21
 eO_2                -1.868937e-02 1 1  ON 22
 eO_3                 2.975604e-01 1 1  ON 23
 eO_4                 5.197807e-01 1 1  ON 24
 eO_5                 4.777437e-01 1 1  ON 25
 eO_6                 2.467746e-01 1 1  ON 26
 eO_7                -4.893298e-02 1 1  ON 27
 eO_8                -2.111758e-01 1 1  ON 28
 eO_9                -7.177778e-02 1 1  ON 29
eH1_0                -2.410341e-01 1 1  ON 30
eH1_1                -1.395265e-01 1 1  ON 31
eH1_2                -9.267067e-02 1 1  ON 32
eH1_3                -3.893491e-02 1 1  ON 33
eH1_4                 8.596225e-03 1 1  ON 34
eH1_5                 4.249833e-02 1 1  ON 35
eH1_6                 9.981376e-02 1 1  ON 36
eH1_7                 1.502348e-01 1 1  ON 37
eH1_8                 1.648566e-01 1 1  ON 38
eH1_9                 5.056977e-02 1 1  ON 39
eH2_0                -2.394245e-01 1 1  ON 40
eH2_1                -1.378509e-01 1 1  ON 41
eH2_2                -9.110460e-02 1 1  ON 42
eH2_3                -3.714039e-02 1 1  ON 43
eH2_4                 1.174495e-02 1 1  ON 44
eH2_5                 4.679194e-02 1 1  ON 45
eH2_6                 1.032720e-01 1 1  ON 46
eH2_7                 1.534656e-01 1 1  ON 47
eH2_8                 1.710384e-01 1 1  ON 48
eH2_9                 3.594700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.170952
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333046171734
                                         uncertainty =       0.002790079065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333046171734
                                         uncertainty =       0.002790079065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408104267
  error estimate for blocks of size 2^( 2) =       0.000420734042
  error estimate for blocks of size 2^( 3) =       0.000433904417
  error estimate for blocks of size 2^( 4) =       0.000445596672
  error estimate for blocks of size 2^( 5) =       0.000455648510
  error estimate for blocks of size 2^( 6) =       0.000461645711
  error estimate for blocks of size 2^( 7) =       0.000465803520

      target function =                  N/A
              le_mean =     -16.905634037869
             les_mean =     286.133560241224
             stat err =       0.000457173603
             autocorr =       1.254931503096
              std dev =       0.577146589201
             le_variance =       0.333098185426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563403787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634037869       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634405057       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634638325       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634623390       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905634773762       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905634903959       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905634851426       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905634788436       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.272376e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634037869       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634136795       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634196910       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634199260       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905634251190       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905634281111       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905634256607       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905634246576       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.227121e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634037869       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634063090       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634078245       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634079317       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905634093425       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905634100904       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905634093783       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905634091882       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.093985e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6359e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.089427e-01 1 1  ON 0
 uu_1                 1.424458e-01 1 1  ON 1
 uu_2                 4.119584e-02 1 1  ON 2
 uu_3                -2.075416e-02 1 1  ON 3
 uu_4                -6.530771e-02 1 1  ON 4
 uu_5                -9.910450e-02 1 1  ON 5
 uu_6                -1.252390e-01 1 1  ON 6
 uu_7                -1.376308e-01 1 1  ON 7
 uu_8                -1.296174e-01 1 1  ON 8
 uu_9                -9.900819e-02 1 1  ON 9
 ud_0                 4.458569e-01 1 1  ON 10
 ud_1                 1.801370e-01 1 1  ON 11
 ud_2                 6.024410e-02 1 1  ON 12
 ud_3                -1.053477e-02 1 1  ON 13
 ud_4                -6.706153e-02 1 1  ON 14
 ud_5                -1.078517e-01 1 1  ON 15
 ud_6                -1.344819e-01 1 1  ON 16
 ud_7                -1.495554e-01 1 1  ON 17
 ud_8                -1.486835e-01 1 1  ON 18
 ud_9                -1.374344e-01 1 1  ON 19
 eO_0                -7.561634e-01 1 1  ON 20
 eO_1                -4.358547e-01 1 1  ON 21
 eO_2                -1.868252e-02 1 1  ON 22
 eO_3                 2.975618e-01 1 1  ON 23
 eO_4                 5.197893e-01 1 1  ON 24
 eO_5                 4.777629e-01 1 1  ON 25
 eO_6                 2.467925e-01 1 1  ON 26
 eO_7                -4.892111e-02 1 1  ON 27
 eO_8                -2.112035e-01 1 1  ON 28
 eO_9                -7.180393e-02 1 1  ON 29
eH1_0                -2.410383e-01 1 1  ON 30
eH1_1                -1.395323e-01 1 1  ON 31
eH1_2                -9.267174e-02 1 1  ON 32
eH1_3                -3.894666e-02 1 1  ON 33
eH1_4                 8.589083e-03 1 1  ON 34
eH1_5                 4.248081e-02 1 1  ON 35
eH1_6                 9.980789e-02 1 1  ON 36
eH1_7                 1.502484e-01 1 1  ON 37
eH1_8                 1.648813e-01 1 1  ON 38
eH1_9                 5.058760e-02 1 1  ON 39
eH2_0                -2.394416e-01 1 1  ON 40
eH2_1                -1.378765e-01 1 1  ON 41
eH2_2                -9.111321e-02 1 1  ON 42
eH2_3                -3.713605e-02 1 1  ON 43
eH2_4                 1.172276e-02 1 1  ON 44
eH2_5                 4.678521e-02 1 1  ON 45
eH2_6                 1.032743e-01 1 1  ON 46
eH2_7                 1.534769e-01 1 1  ON 47
eH2_8                 1.710670e-01 1 1  ON 48
eH2_9                 3.597901e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 0.379796
====================================================
  Execution time = 2.2865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.0000e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339337438790
                                         uncertainty =       0.004119117285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339337438790
                                         uncertainty =       0.004119117285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411859653
  error estimate for blocks of size 2^( 2) =       0.000424334475
  error estimate for blocks of size 2^( 3) =       0.000437587705
  error estimate for blocks of size 2^( 4) =       0.000449950295
  error estimate for blocks of size 2^( 5) =       0.000460827862
  error estimate for blocks of size 2^( 6) =       0.000470759109
  error estimate for blocks of size 2^( 7) =       0.000477458135

      target function =                  N/A
              le_mean =     -16.906260873571
             les_mean =     286.160913302958
             stat err =       0.000464748850
             autocorr =       1.273321727499
              std dev =       0.582457506918
             le_variance =       0.339256747365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356032248
                                         uncertainty =       0.004119149466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356032248
                                         uncertainty =       0.004119149466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411870958
  error estimate for blocks of size 2^( 2) =       0.000424344012
  error estimate for blocks of size 2^( 3) =       0.000437595247
  error estimate for blocks of size 2^( 4) =       0.000449956565
  error estimate for blocks of size 2^( 5) =       0.000460833350
  error estimate for blocks of size 2^( 6) =       0.000470764371
  error estimate for blocks of size 2^( 7) =       0.000477464468

      target function =                  N/A
              le_mean =     -16.906260359407
             les_mean =     286.160914542413
             stat err =       0.000464754688
             autocorr =       1.273283817867
              std dev =       0.582473494671
             le_variance =       0.339275371994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339347108003
                                         uncertainty =       0.004119116208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339347108003
                                         uncertainty =       0.004119116208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411865534
  error estimate for blocks of size 2^( 2) =       0.000424339390
  error estimate for blocks of size 2^( 3) =       0.000437591529
  error estimate for blocks of size 2^( 4) =       0.000449953469
  error estimate for blocks of size 2^( 5) =       0.000460830647
  error estimate for blocks of size 2^( 6) =       0.000470761734
  error estimate for blocks of size 2^( 7) =       0.000477461439

      target function =                  N/A
              le_mean =     -16.906260567983
             les_mean =     286.160912659039
             stat err =       0.000464751822
             autocorr =       1.273301648511
              std dev =       0.582465823996
             le_variance =       0.339266436124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338663552
                                         uncertainty =       0.004119116524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338663552
                                         uncertainty =       0.004119116524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411860398
  error estimate for blocks of size 2^( 2) =       0.000424335096
  error estimate for blocks of size 2^( 3) =       0.000437588185
  error estimate for blocks of size 2^( 4) =       0.000449950693
  error estimate for blocks of size 2^( 5) =       0.000460828212
  error estimate for blocks of size 2^( 6) =       0.000470759437
  error estimate for blocks of size 2^( 7) =       0.000477458553

      target function =                  N/A
              le_mean =     -16.906260832549
             les_mean =     286.160913143282
             stat err =       0.000464749224
             autocorr =       1.273319167722
              std dev =       0.582458560532
             le_variance =       0.339257974737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906260873571        initial  <--
     1.5259e+00     1.5259e+01             1.2724e-04       -16.906260359407
     6.1035e+00     6.1035e+01             3.2271e-05       -16.906260567983
     2.4414e+01     2.4414e+02             8.0940e-06       -16.906260832549

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3289
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.089260e-01 1 1  ON 0
 uu_1                 1.424268e-01 1 1  ON 1
 uu_2                 4.120304e-02 1 1  ON 2
 uu_3                -2.076366e-02 1 1  ON 3
 uu_4                -6.530944e-02 1 1  ON 4
 uu_5                -9.911073e-02 1 1  ON 5
 uu_6                -1.252284e-01 1 1  ON 6
 uu_7                -1.376181e-01 1 1  ON 7
 uu_8                -1.295927e-01 1 1  ON 8
 uu_9                -9.897822e-02 1 1  ON 9
 ud_0                 4.458483e-01 1 1  ON 10
 ud_1                 1.801198e-01 1 1  ON 11
 ud_2                 6.023419e-02 1 1  ON 12
 ud_3                -1.054497e-02 1 1  ON 13
 ud_4                -6.706674e-02 1 1  ON 14
 ud_5                -1.078533e-01 1 1  ON 15
 ud_6                -1.344913e-01 1 1  ON 16
 ud_7                -1.495586e-01 1 1  ON 17
 ud_8                -1.486512e-01 1 1  ON 18
 ud_9                -1.374166e-01 1 1  ON 19
 eO_0                -7.561517e-01 1 1  ON 20
 eO_1                -4.358575e-01 1 1  ON 21
 eO_2                -1.868937e-02 1 1  ON 22
 eO_3                 2.975604e-01 1 1  ON 23
 eO_4                 5.197807e-01 1 1  ON 24
 eO_5                 4.777437e-01 1 1  ON 25
 eO_6                 2.467746e-01 1 1  ON 26
 eO_7                -4.893298e-02 1 1  ON 27
 eO_8                -2.111758e-01 1 1  ON 28
 eO_9                -7.177778e-02 1 1  ON 29
eH1_0                -2.410341e-01 1 1  ON 30
eH1_1                -1.395265e-01 1 1  ON 31
eH1_2                -9.267067e-02 1 1  ON 32
eH1_3                -3.893491e-02 1 1  ON 33
eH1_4                 8.596225e-03 1 1  ON 34
eH1_5                 4.249833e-02 1 1  ON 35
eH1_6                 9.981376e-02 1 1  ON 36
eH1_7                 1.502348e-01 1 1  ON 37
eH1_8                 1.648566e-01 1 1  ON 38
eH1_9                 5.056977e-02 1 1  ON 39
eH2_0                -2.394245e-01 1 1  ON 40
eH2_1                -1.378509e-01 1 1  ON 41
eH2_2                -9.110460e-02 1 1  ON 42
eH2_3                -3.714039e-02 1 1  ON 43
eH2_4                 1.174495e-02 1 1  ON 44
eH2_5                 4.679194e-02 1 1  ON 45
eH2_6                 1.032720e-01 1 1  ON 46
eH2_7                 1.534656e-01 1 1  ON 47
eH2_8                 1.710384e-01 1 1  ON 48
eH2_9                 3.594700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.239305
====================================================
  Execution time = 2.0374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632072195
                                         uncertainty =       0.003317722549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632072195
                                         uncertainty =       0.003317722549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411505505
  error estimate for blocks of size 2^( 2) =       0.000424141340
  error estimate for blocks of size 2^( 3) =       0.000437484762
  error estimate for blocks of size 2^( 4) =       0.000450251181
  error estimate for blocks of size 2^( 5) =       0.000461423316
  error estimate for blocks of size 2^( 6) =       0.000468241578
  error estimate for blocks of size 2^( 7) =       0.000475267573

      target function =                  N/A
              le_mean =     -16.905649420156
             les_mean =     286.139655708434
             stat err =       0.000463795912
             autocorr =       1.270288992076
              std dev =       0.581956665519
             le_variance =       0.338673560542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564942016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649420156       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649465974       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649490688       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649533880       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649531663       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649535592       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649528734       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649525041       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.542430e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649420156       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649431674       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649437956       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649448966       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649448640       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649449667       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649447755       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649446811       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.858216e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649420156       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649423040       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649424617       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649427383       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649427316       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649427576       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649427086       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649426848       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.646880e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5931e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.089274e-01 1 1  ON 0
 uu_1                 1.424283e-01 1 1  ON 1
 uu_2                 4.120277e-02 1 1  ON 2
 uu_3                -2.076287e-02 1 1  ON 3
 uu_4                -6.531102e-02 1 1  ON 4
 uu_5                -9.911286e-02 1 1  ON 5
 uu_6                -1.252308e-01 1 1  ON 6
 uu_7                -1.376196e-01 1 1  ON 7
 uu_8                -1.295928e-01 1 1  ON 8
 uu_9                -9.897817e-02 1 1  ON 9
 ud_0                 4.458492e-01 1 1  ON 10
 ud_1                 1.801201e-01 1 1  ON 11
 ud_2                 6.023386e-02 1 1  ON 12
 ud_3                -1.054406e-02 1 1  ON 13
 ud_4                -6.706685e-02 1 1  ON 14
 ud_5                -1.078547e-01 1 1  ON 15
 ud_6                -1.344903e-01 1 1  ON 16
 ud_7                -1.495598e-01 1 1  ON 17
 ud_8                -1.486525e-01 1 1  ON 18
 ud_9                -1.374159e-01 1 1  ON 19
 eO_0                -7.561532e-01 1 1  ON 20
 eO_1                -4.358576e-01 1 1  ON 21
 eO_2                -1.869002e-02 1 1  ON 22
 eO_3                 2.975606e-01 1 1  ON 23
 eO_4                 5.197821e-01 1 1  ON 24
 eO_5                 4.777454e-01 1 1  ON 25
 eO_6                 2.467771e-01 1 1  ON 26
 eO_7                -4.893280e-02 1 1  ON 27
 eO_8                -2.111777e-01 1 1  ON 28
 eO_9                -7.177953e-02 1 1  ON 29
eH1_0                -2.410368e-01 1 1  ON 30
eH1_1                -1.395256e-01 1 1  ON 31
eH1_2                -9.267237e-02 1 1  ON 32
eH1_3                -3.893700e-02 1 1  ON 33
eH1_4                 8.595653e-03 1 1  ON 34
eH1_5                 4.249870e-02 1 1  ON 35
eH1_6                 9.981418e-02 1 1  ON 36
eH1_7                 1.502346e-01 1 1  ON 37
eH1_8                 1.648589e-01 1 1  ON 38
eH1_9                 5.057272e-02 1 1  ON 39
eH2_0                -2.394249e-01 1 1  ON 40
eH2_1                -1.378519e-01 1 1  ON 41
eH2_2                -9.110725e-02 1 1  ON 42
eH2_3                -3.714103e-02 1 1  ON 43
eH2_4                 1.174371e-02 1 1  ON 44
eH2_5                 4.678969e-02 1 1  ON 45
eH2_6                 1.032722e-01 1 1  ON 46
eH2_7                 1.534661e-01 1 1  ON 47
eH2_8                 1.710417e-01 1 1  ON 48
eH2_9                 3.595086e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.166238
====================================================
  Execution time = 2.1543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3656e-01
  Total weights = 2.0000e+06
  Execution time = 1.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336640374189
                                         uncertainty =       0.002804071997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336640374189
                                         uncertainty =       0.002804071997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410219623
  error estimate for blocks of size 2^( 2) =       0.000423256344
  error estimate for blocks of size 2^( 3) =       0.000436722116
  error estimate for blocks of size 2^( 4) =       0.000448829428
  error estimate for blocks of size 2^( 5) =       0.000458187235
  error estimate for blocks of size 2^( 6) =       0.000465991350
  error estimate for blocks of size 2^( 7) =       0.000472747360

      target function =                  N/A
              le_mean =     -16.905706687370
             les_mean =     286.139478709594
             stat err =       0.000461438843
             autocorr =       1.265305621373
              std dev =       0.580138154662
             le_variance =       0.336560278495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336647914550
                                         uncertainty =       0.002804142488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336647914550
                                         uncertainty =       0.002804142488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410224216
  error estimate for blocks of size 2^( 2) =       0.000423260675
  error estimate for blocks of size 2^( 3) =       0.000436726230
  error estimate for blocks of size 2^( 4) =       0.000448833309
  error estimate for blocks of size 2^( 5) =       0.000458191088
  error estimate for blocks of size 2^( 6) =       0.000465995118
  error estimate for blocks of size 2^( 7) =       0.000472751418

      target function =                  N/A
              le_mean =     -16.905706712357
             les_mean =     286.139487090787
             stat err =       0.000461442733
             autocorr =       1.265298622342
              std dev =       0.580144649941
             le_variance =       0.336567814855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336644212028
                                         uncertainty =       0.002804107965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336644212028
                                         uncertainty =       0.002804107965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221961
  error estimate for blocks of size 2^( 2) =       0.000423258548
  error estimate for blocks of size 2^( 3) =       0.000436724210
  error estimate for blocks of size 2^( 4) =       0.000448831404
  error estimate for blocks of size 2^( 5) =       0.000458189197
  error estimate for blocks of size 2^( 6) =       0.000465993268
  error estimate for blocks of size 2^( 7) =       0.000472749427

      target function =                  N/A
              le_mean =     -16.905706699483
             les_mean =     286.139482954973
             stat err =       0.000461440824
             autocorr =       1.265302063338
              std dev =       0.580141460601
             le_variance =       0.336564114308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336640856034
                                         uncertainty =       0.002804076516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336640856034
                                         uncertainty =       0.002804076516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410219917
  error estimate for blocks of size 2^( 2) =       0.000423256621
  error estimate for blocks of size 2^( 3) =       0.000436722379
  error estimate for blocks of size 2^( 4) =       0.000448829676
  error estimate for blocks of size 2^( 5) =       0.000458187482
  error estimate for blocks of size 2^( 6) =       0.000465991591
  error estimate for blocks of size 2^( 7) =       0.000472747620

      target function =                  N/A
              le_mean =     -16.905706688862
             les_mean =     286.139479241647
             stat err =       0.000461439092
             autocorr =       1.265305174726
              std dev =       0.580138569727
             le_variance =       0.336560760085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905706687370        initial
     1.5259e+01     1.5259e+02             1.5424e-05       -16.905706712357  <--
     6.1035e+01     6.1035e+02             3.8582e-06       -16.905706699483
     2.4414e+02     2.4414e+03             9.6469e-07       -16.905706688862

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.1021e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.089313e-01 1 1  ON 0
 uu_1                 1.424329e-01 1 1  ON 1
 uu_2                 4.120206e-02 1 1  ON 2
 uu_3                -2.076059e-02 1 1  ON 3
 uu_4                -6.531566e-02 1 1  ON 4
 uu_5                -9.911922e-02 1 1  ON 5
 uu_6                -1.252381e-01 1 1  ON 6
 uu_7                -1.376238e-01 1 1  ON 7
 uu_8                -1.295933e-01 1 1  ON 8
 uu_9                -9.897800e-02 1 1  ON 9
 ud_0                 4.458518e-01 1 1  ON 10
 ud_1                 1.801210e-01 1 1  ON 11
 ud_2                 6.023294e-02 1 1  ON 12
 ud_3                -1.054140e-02 1 1  ON 13
 ud_4                -6.706717e-02 1 1  ON 14
 ud_5                -1.078589e-01 1 1  ON 15
 ud_6                -1.344873e-01 1 1  ON 16
 ud_7                -1.495635e-01 1 1  ON 17
 ud_8                -1.486561e-01 1 1  ON 18
 ud_9                -1.374138e-01 1 1  ON 19
 eO_0                -7.561576e-01 1 1  ON 20
 eO_1                -4.358578e-01 1 1  ON 21
 eO_2                -1.869195e-02 1 1  ON 22
 eO_3                 2.975613e-01 1 1  ON 23
 eO_4                 5.197864e-01 1 1  ON 24
 eO_5                 4.777505e-01 1 1  ON 25
 eO_6                 2.467845e-01 1 1  ON 26
 eO_7                -4.893226e-02 1 1  ON 27
 eO_8                -2.111833e-01 1 1  ON 28
 eO_9                -7.178478e-02 1 1  ON 29
eH1_0                -2.410450e-01 1 1  ON 30
eH1_1                -1.395230e-01 1 1  ON 31
eH1_2                -9.267743e-02 1 1  ON 32
eH1_3                -3.894321e-02 1 1  ON 33
eH1_4                 8.593925e-03 1 1  ON 34
eH1_5                 4.249982e-02 1 1  ON 35
eH1_6                 9.981545e-02 1 1  ON 36
eH1_7                 1.502340e-01 1 1  ON 37
eH1_8                 1.648657e-01 1 1  ON 38
eH1_9                 5.058155e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378549e-01 1 1  ON 41
eH2_2                -9.111513e-02 1 1  ON 42
eH2_3                -3.714300e-02 1 1  ON 43
eH2_4                 1.174003e-02 1 1  ON 44
eH2_5                 4.678293e-02 1 1  ON 45
eH2_6                 1.032729e-01 1 1  ON 46
eH2_7                 1.534675e-01 1 1  ON 47
eH2_8                 1.710515e-01 1 1  ON 48
eH2_9                 3.596243e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9332
    reference variance = 0.189399
====================================================
  Execution time = 2.0853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3508e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059058458
                                         uncertainty =       0.003230792072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059058458
                                         uncertainty =       0.003230792072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409315647
  error estimate for blocks of size 2^( 2) =       0.000422299977
  error estimate for blocks of size 2^( 3) =       0.000435668467
  error estimate for blocks of size 2^( 4) =       0.000448145907
  error estimate for blocks of size 2^( 5) =       0.000457951310
  error estimate for blocks of size 2^( 6) =       0.000464787244
  error estimate for blocks of size 2^( 7) =       0.000467884498

      target function =                  N/A
              le_mean =     -16.905664499452
             les_mean =     286.136570598983
             stat err =       0.000459692239
             autocorr =       1.261297832347
              std dev =       0.578859739899
             le_variance =       0.335078598476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566449945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664499452       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905664416427       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905664523054       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905664477655       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905664514847       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905664539314       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664581302       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905664578608       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.511242e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664499452       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905664478131       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905664505279       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905664492832       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905664501768       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905664506350       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664516774       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905664516466       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.385035e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664499452       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905664494086       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905664500903       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905664497719       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905664499926       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905664500967       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664503565       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905664503511       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.467042e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6397e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.089406e-01 1 1  ON 0
 uu_1                 1.424351e-01 1 1  ON 1
 uu_2                 4.120430e-02 1 1  ON 2
 uu_3                -2.075869e-02 1 1  ON 3
 uu_4                -6.532182e-02 1 1  ON 4
 uu_5                -9.911645e-02 1 1  ON 5
 uu_6                -1.252502e-01 1 1  ON 6
 uu_7                -1.376376e-01 1 1  ON 7
 uu_8                -1.295969e-01 1 1  ON 8
 uu_9                -9.897784e-02 1 1  ON 9
 ud_0                 4.458524e-01 1 1  ON 10
 ud_1                 1.801264e-01 1 1  ON 11
 ud_2                 6.023412e-02 1 1  ON 12
 ud_3                -1.054397e-02 1 1  ON 13
 ud_4                -6.706565e-02 1 1  ON 14
 ud_5                -1.078586e-01 1 1  ON 15
 ud_6                -1.344857e-01 1 1  ON 16
 ud_7                -1.495761e-01 1 1  ON 17
 ud_8                -1.486603e-01 1 1  ON 18
 ud_9                -1.374098e-01 1 1  ON 19
 eO_0                -7.561677e-01 1 1  ON 20
 eO_1                -4.358532e-01 1 1  ON 21
 eO_2                -1.869455e-02 1 1  ON 22
 eO_3                 2.975673e-01 1 1  ON 23
 eO_4                 5.197866e-01 1 1  ON 24
 eO_5                 4.777587e-01 1 1  ON 25
 eO_6                 2.467938e-01 1 1  ON 26
 eO_7                -4.893593e-02 1 1  ON 27
 eO_8                -2.111881e-01 1 1  ON 28
 eO_9                -7.179105e-02 1 1  ON 29
eH1_0                -2.410568e-01 1 1  ON 30
eH1_1                -1.395225e-01 1 1  ON 31
eH1_2                -9.268747e-02 1 1  ON 32
eH1_3                -3.894423e-02 1 1  ON 33
eH1_4                 8.594363e-03 1 1  ON 34
eH1_5                 4.250017e-02 1 1  ON 35
eH1_6                 9.980884e-02 1 1  ON 36
eH1_7                 1.502380e-01 1 1  ON 37
eH1_8                 1.648766e-01 1 1  ON 38
eH1_9                 5.059431e-02 1 1  ON 39
eH2_0                -2.394260e-01 1 1  ON 40
eH2_1                -1.378603e-01 1 1  ON 41
eH2_2                -9.112063e-02 1 1  ON 42
eH2_3                -3.714629e-02 1 1  ON 43
eH2_4                 1.173853e-02 1 1  ON 44
eH2_5                 4.677583e-02 1 1  ON 45
eH2_6                 1.032702e-01 1 1  ON 46
eH2_7                 1.534681e-01 1 1  ON 47
eH2_8                 1.710616e-01 1 1  ON 48
eH2_9                 3.597628e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.330228
====================================================
  Execution time = 2.0824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338664632764
                                         uncertainty =       0.003822222160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338664632764
                                         uncertainty =       0.003822222160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411502621
  error estimate for blocks of size 2^( 2) =       0.000424126521
  error estimate for blocks of size 2^( 3) =       0.000437200547
  error estimate for blocks of size 2^( 4) =       0.000449810296
  error estimate for blocks of size 2^( 5) =       0.000460831709
  error estimate for blocks of size 2^( 6) =       0.000465515569
  error estimate for blocks of size 2^( 7) =       0.000469328422

      target function =                  N/A
              le_mean =     -16.906191719443
             les_mean =     286.157987099357
             stat err =       0.000461371499
             autocorr =       1.257060886700
              std dev =       0.581952587529
             le_variance =       0.338668814131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338675148079
                                         uncertainty =       0.003822206257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338675148079
                                         uncertainty =       0.003822206257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411509008
  error estimate for blocks of size 2^( 2) =       0.000424132385
  error estimate for blocks of size 2^( 3) =       0.000437205305
  error estimate for blocks of size 2^( 4) =       0.000449814231
  error estimate for blocks of size 2^( 5) =       0.000460835213
  error estimate for blocks of size 2^( 6) =       0.000465519680
  error estimate for blocks of size 2^( 7) =       0.000469332004

      target function =                  N/A
              le_mean =     -16.906191860768
             les_mean =     286.158002390485
             stat err =       0.000461375282
             autocorr =       1.257042482343
              std dev =       0.581961619631
             le_variance =       0.338679326724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338669375431
                                         uncertainty =       0.003822202207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338669375431
                                         uncertainty =       0.003822202207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411505501
  error estimate for blocks of size 2^( 2) =       0.000424129143
  error estimate for blocks of size 2^( 3) =       0.000437202609
  error estimate for blocks of size 2^( 4) =       0.000449811944
  error estimate for blocks of size 2^( 5) =       0.000460833145
  error estimate for blocks of size 2^( 6) =       0.000465517340
  error estimate for blocks of size 2^( 7) =       0.000469329924

      target function =                  N/A
              le_mean =     -16.906191790175
             les_mean =     286.157994231997
             stat err =       0.000461373088
             autocorr =       1.257051950130
              std dev =       0.581956660898
             le_variance =       0.338673555163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338665205291
                                         uncertainty =       0.003822219231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338665205291
                                         uncertainty =       0.003822219231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411502969
  error estimate for blocks of size 2^( 2) =       0.000424126836
  error estimate for blocks of size 2^( 3) =       0.000437200792
  error estimate for blocks of size 2^( 4) =       0.000449810489
  error estimate for blocks of size 2^( 5) =       0.000460831876
  error estimate for blocks of size 2^( 6) =       0.000465515779
  error estimate for blocks of size 2^( 7) =       0.000469328598

      target function =                  N/A
              le_mean =     -16.906191728127
             les_mean =     286.157987965289
             stat err =       0.000461371686
             autocorr =       1.257059780204
              std dev =       0.581953079246
             le_variance =       0.338669386443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906191719443        initial
     3.8147e+00     3.8147e+01             5.5112e-05       -16.906191860768  <--
     1.5259e+01     1.5259e+02             1.3850e-05       -16.906191790175
     6.1035e+01     6.1035e+02             3.4670e-06       -16.906191728127

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 3.0237e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.089678e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121116e-02 1 1  ON 2
 uu_3                -2.075379e-02 1 1  ON 3
 uu_4                -6.533856e-02 1 1  ON 4
 uu_5                -9.910973e-02 1 1  ON 5
 uu_6                -1.252853e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296082e-01 1 1  ON 8
 uu_9                -9.897749e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023781e-02 1 1  ON 12
 ud_3                -1.055116e-02 1 1  ON 13
 ud_4                -6.706163e-02 1 1  ON 14
 ud_5                -1.078579e-01 1 1  ON 15
 ud_6                -1.344811e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486731e-01 1 1  ON 18
 ud_9                -1.373981e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870175e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197874e-01 1 1  ON 24
 eO_5                 4.777832e-01 1 1  ON 25
 eO_6                 2.468218e-01 1 1  ON 26
 eO_7                -4.894690e-02 1 1  ON 27
 eO_8                -2.112023e-01 1 1  ON 28
 eO_9                -7.180976e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271599e-02 1 1  ON 32
eH1_3                -3.894787e-02 1 1  ON 33
eH1_4                 8.595749e-03 1 1  ON 34
eH1_5                 4.250132e-02 1 1  ON 35
eH1_6                 9.978920e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649091e-01 1 1  ON 38
eH1_9                 5.063230e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113669e-02 1 1  ON 42
eH2_3                -3.715627e-02 1 1  ON 43
eH2_4                 1.173422e-02 1 1  ON 44
eH2_5                 4.675468e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534698e-01 1 1  ON 47
eH2_8                 1.710919e-01 1 1  ON 48
eH2_9                 3.601754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.24319
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334040560915
                                         uncertainty =       0.002933649462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334040560915
                                         uncertainty =       0.002933649462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408678185
  error estimate for blocks of size 2^( 2) =       0.000421185538
  error estimate for blocks of size 2^( 3) =       0.000433791182
  error estimate for blocks of size 2^( 4) =       0.000445185611
  error estimate for blocks of size 2^( 5) =       0.000454202676
  error estimate for blocks of size 2^( 6) =       0.000460351277
  error estimate for blocks of size 2^( 7) =       0.000462572619

      target function =                  N/A
              le_mean =     -16.906223350564
             les_mean =     286.154423530344
             stat err =       0.000455578046
             autocorr =       1.242689595484
              std dev =       0.577958232223
             le_variance =       0.334035718194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622335056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223350564       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223677969       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224143595       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224310045       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224219925       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224653123       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224067397       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223973310       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906224163415       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.430880e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223350564       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223439815       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223557692       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223575934       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223543007       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223661750       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223544225       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223502267       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906223544095       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.875708e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223350564       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223373393       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223402882       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223405498       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223396019       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223426144       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223400190       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223388592       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.257779e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6152e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.089870e-01 1 1  ON 0
 uu_1                 1.424498e-01 1 1  ON 1
 uu_2                 4.122260e-02 1 1  ON 2
 uu_3                -2.074966e-02 1 1  ON 3
 uu_4                -6.533775e-02 1 1  ON 4
 uu_5                -9.909520e-02 1 1  ON 5
 uu_6                -1.252686e-01 1 1  ON 6
 uu_7                -1.377194e-01 1 1  ON 7
 uu_8                -1.296459e-01 1 1  ON 8
 uu_9                -9.901683e-02 1 1  ON 9
 ud_0                 4.458700e-01 1 1  ON 10
 ud_1                 1.801981e-01 1 1  ON 11
 ud_2                 6.027638e-02 1 1  ON 12
 ud_3                -1.053765e-02 1 1  ON 13
 ud_4                -6.704346e-02 1 1  ON 14
 ud_5                -1.078501e-01 1 1  ON 15
 ud_6                -1.344569e-01 1 1  ON 16
 ud_7                -1.496305e-01 1 1  ON 17
 ud_8                -1.487618e-01 1 1  ON 18
 ud_9                -1.374460e-01 1 1  ON 19
 eO_0                -7.562052e-01 1 1  ON 20
 eO_1                -4.358856e-01 1 1  ON 21
 eO_2                -1.868931e-02 1 1  ON 22
 eO_3                 2.976222e-01 1 1  ON 23
 eO_4                 5.198014e-01 1 1  ON 24
 eO_5                 4.778307e-01 1 1  ON 25
 eO_6                 2.468655e-01 1 1  ON 26
 eO_7                -4.895751e-02 1 1  ON 27
 eO_8                -2.112519e-01 1 1  ON 28
 eO_9                -7.184677e-02 1 1  ON 29
eH1_0                -2.411220e-01 1 1  ON 30
eH1_1                -1.394969e-01 1 1  ON 31
eH1_2                -9.272090e-02 1 1  ON 32
eH1_3                -3.896144e-02 1 1  ON 33
eH1_4                 8.588412e-03 1 1  ON 34
eH1_5                 4.247582e-02 1 1  ON 35
eH1_6                 9.975773e-02 1 1  ON 36
eH1_7                 1.502479e-01 1 1  ON 37
eH1_8                 1.649459e-01 1 1  ON 38
eH1_9                 5.067893e-02 1 1  ON 39
eH2_0                -2.394668e-01 1 1  ON 40
eH2_1                -1.378805e-01 1 1  ON 41
eH2_2                -9.112292e-02 1 1  ON 42
eH2_3                -3.714722e-02 1 1  ON 43
eH2_4                 1.172818e-02 1 1  ON 44
eH2_5                 4.673742e-02 1 1  ON 45
eH2_6                 1.032486e-01 1 1  ON 46
eH2_7                 1.534697e-01 1 1  ON 47
eH2_8                 1.711206e-01 1 1  ON 48
eH2_9                 3.605413e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9072
    reference variance = 0.40002
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3446e-01
  Total weights = 2.0000e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334297848167
                                         uncertainty =       0.003000863225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334297848167
                                         uncertainty =       0.003000863225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408955104
  error estimate for blocks of size 2^( 2) =       0.000422109206
  error estimate for blocks of size 2^( 3) =       0.000435305829
  error estimate for blocks of size 2^( 4) =       0.000447462528
  error estimate for blocks of size 2^( 5) =       0.000457600657
  error estimate for blocks of size 2^( 6) =       0.000466006012
  error estimate for blocks of size 2^( 7) =       0.000472814164

      target function =                  N/A
              le_mean =     -16.906524998584
             les_mean =     286.165075914274
             stat err =       0.000460970840
             autocorr =       1.270561357465
              std dev =       0.578349854122
             le_variance =       0.334488553763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334226507561
                                         uncertainty =       0.003000214564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334226507561
                                         uncertainty =       0.003000214564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408911458
  error estimate for blocks of size 2^( 2) =       0.000422066091
  error estimate for blocks of size 2^( 3) =       0.000435262691
  error estimate for blocks of size 2^( 4) =       0.000447418318
  error estimate for blocks of size 2^( 5) =       0.000457559217
  error estimate for blocks of size 2^( 6) =       0.000465971144
  error estimate for blocks of size 2^( 7) =       0.000472788620

      target function =                  N/A
              le_mean =     -16.906524524395
             les_mean =     286.164988488084
             stat err =       0.000460934325
             autocorr =       1.270631272567
              std dev =       0.578288130016
             le_variance =       0.334417161318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334241157878
                                         uncertainty =       0.003000358824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334241157878
                                         uncertainty =       0.003000358824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408920426
  error estimate for blocks of size 2^( 2) =       0.000422075356
  error estimate for blocks of size 2^( 3) =       0.000435272475
  error estimate for blocks of size 2^( 4) =       0.000447429049
  error estimate for blocks of size 2^( 5) =       0.000457569067
  error estimate for blocks of size 2^( 6) =       0.000465978629
  error estimate for blocks of size 2^( 7) =       0.000472792425

      target function =                  N/A
              le_mean =     -16.906524649658
             les_mean =     286.165007391058
             stat err =       0.000460942293
             autocorr =       1.270619473996
              std dev =       0.578300811680
             le_variance =       0.334431828789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334289154819
                                         uncertainty =       0.003000788155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334289154819
                                         uncertainty =       0.003000788155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408949787
  error estimate for blocks of size 2^( 2) =       0.000422104038
  error estimate for blocks of size 2^( 3) =       0.000435300764
  error estimate for blocks of size 2^( 4) =       0.000447457495
  error estimate for blocks of size 2^( 5) =       0.000457595913
  error estimate for blocks of size 2^( 6) =       0.000466001837
  error estimate for blocks of size 2^( 7) =       0.000472810720

      target function =                  N/A
              le_mean =     -16.906524940374
             les_mean =     286.165065248259
             stat err =       0.000460966491
             autocorr =       1.270570422718
              std dev =       0.578342334606
             le_variance =       0.334479855998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906524998584        initial  <--
     9.5367e-01     9.5367e+00             3.4309e-04       -16.906524524395
     3.8147e+00     3.8147e+01             8.8757e-05       -16.906524649658
     1.5259e+01     1.5259e+02             2.2578e-05       -16.906524940374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1190
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.089678e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121116e-02 1 1  ON 2
 uu_3                -2.075379e-02 1 1  ON 3
 uu_4                -6.533856e-02 1 1  ON 4
 uu_5                -9.910973e-02 1 1  ON 5
 uu_6                -1.252853e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296082e-01 1 1  ON 8
 uu_9                -9.897749e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023781e-02 1 1  ON 12
 ud_3                -1.055116e-02 1 1  ON 13
 ud_4                -6.706163e-02 1 1  ON 14
 ud_5                -1.078579e-01 1 1  ON 15
 ud_6                -1.344811e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486731e-01 1 1  ON 18
 ud_9                -1.373981e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870175e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197874e-01 1 1  ON 24
 eO_5                 4.777832e-01 1 1  ON 25
 eO_6                 2.468218e-01 1 1  ON 26
 eO_7                -4.894690e-02 1 1  ON 27
 eO_8                -2.112023e-01 1 1  ON 28
 eO_9                -7.180976e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271599e-02 1 1  ON 32
eH1_3                -3.894787e-02 1 1  ON 33
eH1_4                 8.595749e-03 1 1  ON 34
eH1_5                 4.250132e-02 1 1  ON 35
eH1_6                 9.978920e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649091e-01 1 1  ON 38
eH1_9                 5.063230e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113669e-02 1 1  ON 42
eH2_3                -3.715627e-02 1 1  ON 43
eH2_4                 1.173422e-02 1 1  ON 44
eH2_5                 4.675468e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534698e-01 1 1  ON 47
eH2_8                 1.710919e-01 1 1  ON 48
eH2_9                 3.601754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8652
    reference variance = 0.198392
====================================================
  Execution time = 2.2647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3803e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338107663668
                                         uncertainty =       0.004766631253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338107663668
                                         uncertainty =       0.004766631253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411112082
  error estimate for blocks of size 2^( 2) =       0.000423789586
  error estimate for blocks of size 2^( 3) =       0.000436307575
  error estimate for blocks of size 2^( 4) =       0.000448056062
  error estimate for blocks of size 2^( 5) =       0.000457680371
  error estimate for blocks of size 2^( 6) =       0.000463951338
  error estimate for blocks of size 2^( 7) =       0.000467428064

      target function =                  N/A
              le_mean =     -16.905406363061
             les_mean =     286.130790418997
             stat err =       0.000459278959
             autocorr =       1.248051819679
              std dev =       0.581400281891
             le_variance =       0.338026287783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540636306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406363061       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406387023       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406506700       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406515576       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406489556       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406501203       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905406500303       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905406509053       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.141492e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406363061       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406369100       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406399609       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406401576       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406394933       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406398022       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905406397997       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905406400050       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.362452e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406363061       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406364574       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406372239       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406372714       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406371045       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406371828       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905406371836       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905406372340       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.341122e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8186e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.089690e-01 1 1  ON 0
 uu_1                 1.424428e-01 1 1  ON 1
 uu_2                 4.121230e-02 1 1  ON 2
 uu_3                -2.075316e-02 1 1  ON 3
 uu_4                -6.533626e-02 1 1  ON 4
 uu_5                -9.910913e-02 1 1  ON 5
 uu_6                -1.252898e-01 1 1  ON 6
 uu_7                -1.376788e-01 1 1  ON 7
 uu_8                -1.296113e-01 1 1  ON 8
 uu_9                -9.898063e-02 1 1  ON 9
 ud_0                 4.458542e-01 1 1  ON 10
 ud_1                 1.801430e-01 1 1  ON 11
 ud_2                 6.023934e-02 1 1  ON 12
 ud_3                -1.054824e-02 1 1  ON 13
 ud_4                -6.706153e-02 1 1  ON 14
 ud_5                -1.078585e-01 1 1  ON 15
 ud_6                -1.344784e-01 1 1  ON 16
 ud_7                -1.496161e-01 1 1  ON 17
 ud_8                -1.486769e-01 1 1  ON 18
 ud_9                -1.373991e-01 1 1  ON 19
 eO_0                -7.561977e-01 1 1  ON 20
 eO_1                -4.358415e-01 1 1  ON 21
 eO_2                -1.870303e-02 1 1  ON 22
 eO_3                 2.975829e-01 1 1  ON 23
 eO_4                 5.197920e-01 1 1  ON 24
 eO_5                 4.777878e-01 1 1  ON 25
 eO_6                 2.468255e-01 1 1  ON 26
 eO_7                -4.894663e-02 1 1  ON 27
 eO_8                -2.112066e-01 1 1  ON 28
 eO_9                -7.181337e-02 1 1  ON 29
eH1_0                -2.410931e-01 1 1  ON 30
eH1_1                -1.395221e-01 1 1  ON 31
eH1_2                -9.272051e-02 1 1  ON 32
eH1_3                -3.895258e-02 1 1  ON 33
eH1_4                 8.595952e-03 1 1  ON 34
eH1_5                 4.249800e-02 1 1  ON 35
eH1_6                 9.978886e-02 1 1  ON 36
eH1_7                 1.502532e-01 1 1  ON 37
eH1_8                 1.649144e-01 1 1  ON 38
eH1_9                 5.063718e-02 1 1  ON 39
eH2_0                -2.394294e-01 1 1  ON 40
eH2_1                -1.378765e-01 1 1  ON 41
eH2_2                -9.113554e-02 1 1  ON 42
eH2_3                -3.715558e-02 1 1  ON 43
eH2_4                 1.173342e-02 1 1  ON 44
eH2_5                 4.675172e-02 1 1  ON 45
eH2_6                 1.032596e-01 1 1  ON 46
eH2_7                 1.534690e-01 1 1  ON 47
eH2_8                 1.710953e-01 1 1  ON 48
eH2_9                 3.602267e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.255314
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4155e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341603676541
                                         uncertainty =       0.003826042082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341603676541
                                         uncertainty =       0.003826042082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413248788
  error estimate for blocks of size 2^( 2) =       0.000426280304
  error estimate for blocks of size 2^( 3) =       0.000439076573
  error estimate for blocks of size 2^( 4) =       0.000451993951
  error estimate for blocks of size 2^( 5) =       0.000463136944
  error estimate for blocks of size 2^( 6) =       0.000472504720
  error estimate for blocks of size 2^( 7) =       0.000475357864

      target function =                  N/A
              le_mean =     -16.905486615031
             les_mean =     286.137026641694
             stat err =       0.000465748370
             autocorr =       1.270221647645
              std dev =       0.584422040542
             le_variance =       0.341549121471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341594444567
                                         uncertainty =       0.003826010445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341594444567
                                         uncertainty =       0.003826010445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413243202
  error estimate for blocks of size 2^( 2) =       0.000426274909
  error estimate for blocks of size 2^( 3) =       0.000439071347
  error estimate for blocks of size 2^( 4) =       0.000451988791
  error estimate for blocks of size 2^( 5) =       0.000463132014
  error estimate for blocks of size 2^( 6) =       0.000472500120
  error estimate for blocks of size 2^( 7) =       0.000475353622

      target function =                  N/A
              le_mean =     -16.905486582075
             les_mean =     286.137016293933
             stat err =       0.000465743637
             autocorr =       1.270230171521
              std dev =       0.584414140804
             le_variance =       0.341539887972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341598885409
                                         uncertainty =       0.003826025441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341598885409
                                         uncertainty =       0.003826025441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413245889
  error estimate for blocks of size 2^( 2) =       0.000426277504
  error estimate for blocks of size 2^( 3) =       0.000439073861
  error estimate for blocks of size 2^( 4) =       0.000451991276
  error estimate for blocks of size 2^( 5) =       0.000463134389
  error estimate for blocks of size 2^( 6) =       0.000472502335
  error estimate for blocks of size 2^( 7) =       0.000475355665

      target function =                  N/A
              le_mean =     -16.905486597851
             les_mean =     286.137021268887
             stat err =       0.000465745916
             autocorr =       1.270226086535
              std dev =       0.584417940821
             le_variance =       0.341544329553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341603071754
                                         uncertainty =       0.003826039974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341603071754
                                         uncertainty =       0.003826039974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413248422
  error estimate for blocks of size 2^( 2) =       0.000426279951
  error estimate for blocks of size 2^( 3) =       0.000439076231
  error estimate for blocks of size 2^( 4) =       0.000451993613
  error estimate for blocks of size 2^( 5) =       0.000463136622
  error estimate for blocks of size 2^( 6) =       0.000472504419
  error estimate for blocks of size 2^( 7) =       0.000475357587

      target function =                  N/A
              le_mean =     -16.905486612835
             les_mean =     286.137025962565
             stat err =       0.000465748060
             autocorr =       1.270222208251
              std dev =       0.584421523033
             le_variance =       0.341548516585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905486615031        initial  <--
     9.5367e+00     9.5367e+01             2.1415e-05       -16.905486582075
     3.8147e+01     3.8147e+02             5.3625e-06       -16.905486597851
     1.5259e+02     1.5259e+03             1.3411e-06       -16.905486612835

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9108
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.089678e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121116e-02 1 1  ON 2
 uu_3                -2.075379e-02 1 1  ON 3
 uu_4                -6.533856e-02 1 1  ON 4
 uu_5                -9.910973e-02 1 1  ON 5
 uu_6                -1.252853e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296082e-01 1 1  ON 8
 uu_9                -9.897749e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023781e-02 1 1  ON 12
 ud_3                -1.055116e-02 1 1  ON 13
 ud_4                -6.706163e-02 1 1  ON 14
 ud_5                -1.078579e-01 1 1  ON 15
 ud_6                -1.344811e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486731e-01 1 1  ON 18
 ud_9                -1.373981e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870175e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197874e-01 1 1  ON 24
 eO_5                 4.777832e-01 1 1  ON 25
 eO_6                 2.468218e-01 1 1  ON 26
 eO_7                -4.894690e-02 1 1  ON 27
 eO_8                -2.112023e-01 1 1  ON 28
 eO_9                -7.180976e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271599e-02 1 1  ON 32
eH1_3                -3.894787e-02 1 1  ON 33
eH1_4                 8.595749e-03 1 1  ON 34
eH1_5                 4.250132e-02 1 1  ON 35
eH1_6                 9.978920e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649091e-01 1 1  ON 38
eH1_9                 5.063230e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113669e-02 1 1  ON 42
eH2_3                -3.715627e-02 1 1  ON 43
eH2_4                 1.173422e-02 1 1  ON 44
eH2_5                 4.675468e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534698e-01 1 1  ON 47
eH2_8                 1.710919e-01 1 1  ON 48
eH2_9                 3.601754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8207e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8618
    reference variance = 0.159963
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339084758894
                                         uncertainty =       0.004211910560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339084758894
                                         uncertainty =       0.004211910560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411746004
  error estimate for blocks of size 2^( 2) =       0.000423821225
  error estimate for blocks of size 2^( 3) =       0.000436647110
  error estimate for blocks of size 2^( 4) =       0.000447210137
  error estimate for blocks of size 2^( 5) =       0.000457392376
  error estimate for blocks of size 2^( 6) =       0.000463437925
  error estimate for blocks of size 2^( 7) =       0.000465272842

      target function =                  N/A
              le_mean =     -16.906349105353
             les_mean =     286.163709445849
             stat err =       0.000458328320
             autocorr =       1.239066456700
              std dev =       0.582296782858
             le_variance =       0.339069543327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634910535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349105353       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349107392       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349114171       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349112123       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349108272       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349111850       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349114269       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349114216       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.976065e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349105353       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349105863       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349107560       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349107049       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349106085       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349106980       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349107583       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349107571       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 7.442282e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349105353       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349105480       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349105905       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349105777       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349105535       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349105760       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349105911       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349105909       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.860703e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5876e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.089681e-01 1 1  ON 0
 uu_1                 1.424421e-01 1 1  ON 1
 uu_2                 4.121144e-02 1 1  ON 2
 uu_3                -2.075361e-02 1 1  ON 3
 uu_4                -6.533853e-02 1 1  ON 4
 uu_5                -9.910958e-02 1 1  ON 5
 uu_6                -1.252854e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296089e-01 1 1  ON 8
 uu_9                -9.897809e-02 1 1  ON 9
 ud_0                 4.458558e-01 1 1  ON 10
 ud_1                 1.801413e-01 1 1  ON 11
 ud_2                 6.023790e-02 1 1  ON 12
 ud_3                -1.055083e-02 1 1  ON 13
 ud_4                -6.706154e-02 1 1  ON 14
 ud_5                -1.078580e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496131e-01 1 1  ON 17
 ud_8                -1.486738e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561963e-01 1 1  ON 20
 eO_1                -4.358412e-01 1 1  ON 21
 eO_2                -1.870166e-02 1 1  ON 22
 eO_3                 2.975848e-01 1 1  ON 23
 eO_4                 5.197878e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468222e-01 1 1  ON 26
 eO_7                -4.894688e-02 1 1  ON 27
 eO_8                -2.112028e-01 1 1  ON 28
 eO_9                -7.181015e-02 1 1  ON 29
eH1_0                -2.410920e-01 1 1  ON 30
eH1_1                -1.395227e-01 1 1  ON 31
eH1_2                -9.271620e-02 1 1  ON 32
eH1_3                -3.894811e-02 1 1  ON 33
eH1_4                 8.595724e-03 1 1  ON 34
eH1_5                 4.250143e-02 1 1  ON 35
eH1_6                 9.978914e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649095e-01 1 1  ON 38
eH1_9                 5.063272e-02 1 1  ON 39
eH2_0                -2.394265e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113671e-02 1 1  ON 42
eH2_3                -3.715638e-02 1 1  ON 43
eH2_4                 1.173406e-02 1 1  ON 44
eH2_5                 4.675477e-02 1 1  ON 45
eH2_6                 1.032622e-01 1 1  ON 46
eH2_7                 1.534698e-01 1 1  ON 47
eH2_8                 1.710923e-01 1 1  ON 48
eH2_9                 3.601803e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.250531
====================================================
  Execution time = 2.2501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4435e-01
  Total weights = 2.0000e+06
  Execution time = 2.0692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399565025
                                         uncertainty =       0.005960671332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399565025
                                         uncertainty =       0.005960671332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414940041
  error estimate for blocks of size 2^( 2) =       0.000427377964
  error estimate for blocks of size 2^( 3) =       0.000440396911
  error estimate for blocks of size 2^( 4) =       0.000452204945
  error estimate for blocks of size 2^( 5) =       0.000461645211
  error estimate for blocks of size 2^( 6) =       0.000468756401
  error estimate for blocks of size 2^( 7) =       0.000472551484

      target function =                  N/A
              le_mean =     -16.906277984394
             les_mean =     286.166585588722
             stat err =       0.000463789510
             autocorr =       1.249312693182
              std dev =       0.586813833596
             le_variance =       0.344350475300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399223431
                                         uncertainty =       0.005960627133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399223431
                                         uncertainty =       0.005960627133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414939836
  error estimate for blocks of size 2^( 2) =       0.000427377749
  error estimate for blocks of size 2^( 3) =       0.000440396676
  error estimate for blocks of size 2^( 4) =       0.000452204709
  error estimate for blocks of size 2^( 5) =       0.000461644976
  error estimate for blocks of size 2^( 6) =       0.000468756166
  error estimate for blocks of size 2^( 7) =       0.000472551274

      target function =                  N/A
              le_mean =     -16.906277979500
             les_mean =     286.166585082713
             stat err =       0.000463789281
             autocorr =       1.249312693932
              std dev =       0.586813543432
             le_variance =       0.344350134755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399393334
                                         uncertainty =       0.005960649149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399393334
                                         uncertainty =       0.005960649149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414939938
  error estimate for blocks of size 2^( 2) =       0.000427377856
  error estimate for blocks of size 2^( 3) =       0.000440396793
  error estimate for blocks of size 2^( 4) =       0.000452204826
  error estimate for blocks of size 2^( 5) =       0.000461645093
  error estimate for blocks of size 2^( 6) =       0.000468756283
  error estimate for blocks of size 2^( 7) =       0.000472551379

      target function =                  N/A
              le_mean =     -16.906277981933
             les_mean =     286.166585334346
             stat err =       0.000463789395
             autocorr =       1.249312694256
              std dev =       0.586813687755
             le_variance =       0.344350304136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399543534
                                         uncertainty =       0.005960668557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399543534
                                         uncertainty =       0.005960668557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414940028
  error estimate for blocks of size 2^( 2) =       0.000427377951
  error estimate for blocks of size 2^( 3) =       0.000440396896
  error estimate for blocks of size 2^( 4) =       0.000452204930
  error estimate for blocks of size 2^( 5) =       0.000461645197
  error estimate for blocks of size 2^( 6) =       0.000468756386
  error estimate for blocks of size 2^( 7) =       0.000472551471

      target function =                  N/A
              le_mean =     -16.906277984085
             les_mean =     286.166585556872
             stat err =       0.000463789496
             autocorr =       1.249312693337
              std dev =       0.586813815341
             le_variance =       0.344350453875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906277984394        initial  <--
     9.5367e+01     9.5367e+02             2.9761e-06       -16.906277979500
     3.8147e+02     3.8147e+03             7.4423e-07       -16.906277981933
     1.5259e+03     1.5259e+04             1.8607e-07       -16.906277984085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1339
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.089678e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121116e-02 1 1  ON 2
 uu_3                -2.075379e-02 1 1  ON 3
 uu_4                -6.533856e-02 1 1  ON 4
 uu_5                -9.910973e-02 1 1  ON 5
 uu_6                -1.252853e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296082e-01 1 1  ON 8
 uu_9                -9.897749e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023781e-02 1 1  ON 12
 ud_3                -1.055116e-02 1 1  ON 13
 ud_4                -6.706163e-02 1 1  ON 14
 ud_5                -1.078579e-01 1 1  ON 15
 ud_6                -1.344811e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486731e-01 1 1  ON 18
 ud_9                -1.373981e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870175e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197874e-01 1 1  ON 24
 eO_5                 4.777832e-01 1 1  ON 25
 eO_6                 2.468218e-01 1 1  ON 26
 eO_7                -4.894690e-02 1 1  ON 27
 eO_8                -2.112023e-01 1 1  ON 28
 eO_9                -7.180976e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271599e-02 1 1  ON 32
eH1_3                -3.894787e-02 1 1  ON 33
eH1_4                 8.595749e-03 1 1  ON 34
eH1_5                 4.250132e-02 1 1  ON 35
eH1_6                 9.978920e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649091e-01 1 1  ON 38
eH1_9                 5.063230e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113669e-02 1 1  ON 42
eH2_3                -3.715627e-02 1 1  ON 43
eH2_4                 1.173422e-02 1 1  ON 44
eH2_5                 4.675468e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534698e-01 1 1  ON 47
eH2_8                 1.710919e-01 1 1  ON 48
eH2_9                 3.601754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.247938
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344493700747
                                         uncertainty =       0.006670342228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344493700747
                                         uncertainty =       0.006670342228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415057973
  error estimate for blocks of size 2^( 2) =       0.000427253019
  error estimate for blocks of size 2^( 3) =       0.000440034964
  error estimate for blocks of size 2^( 4) =       0.000452855394
  error estimate for blocks of size 2^( 5) =       0.000462875624
  error estimate for blocks of size 2^( 6) =       0.000470800457
  error estimate for blocks of size 2^( 7) =       0.000472247551

      target function =                  N/A
              le_mean =     -16.906588054936
             les_mean =     286.177265728908
             stat err =       0.000464694757
             autocorr =       1.253481771836
              std dev =       0.586980614563
             le_variance =       0.344546241873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658805494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588054936       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588055021       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588055547       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588055381       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588055541       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588055856       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588055921       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588055874       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.101220e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588054936       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588054957       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588055089       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588055046       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588055087       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588055168       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588055181       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588055170       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.253164e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588054936       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588054941       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588054974       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588054973       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588054984       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588055010       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588054988       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588055008       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.313298e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5943e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121118e-02 1 1  ON 2
 uu_3                -2.075378e-02 1 1  ON 3
 uu_4                -6.533854e-02 1 1  ON 4
 uu_5                -9.910975e-02 1 1  ON 5
 uu_6                -1.252854e-01 1 1  ON 6
 uu_7                -1.376784e-01 1 1  ON 7
 uu_8                -1.296082e-01 1 1  ON 8
 uu_9                -9.897751e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023783e-02 1 1  ON 12
 ud_3                -1.055112e-02 1 1  ON 13
 ud_4                -6.706162e-02 1 1  ON 14
 ud_5                -1.078579e-01 1 1  ON 15
 ud_6                -1.344811e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486731e-01 1 1  ON 18
 ud_9                -1.373981e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870180e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197875e-01 1 1  ON 24
 eO_5                 4.777833e-01 1 1  ON 25
 eO_6                 2.468218e-01 1 1  ON 26
 eO_7                -4.894689e-02 1 1  ON 27
 eO_8                -2.112023e-01 1 1  ON 28
 eO_9                -7.180979e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271602e-02 1 1  ON 32
eH1_3                -3.894790e-02 1 1  ON 33
eH1_4                 8.595738e-03 1 1  ON 34
eH1_5                 4.250133e-02 1 1  ON 35
eH1_6                 9.978918e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649091e-01 1 1  ON 38
eH1_9                 5.063235e-02 1 1  ON 39
eH2_0                -2.394261e-01 1 1  ON 40
eH2_1                -1.378766e-01 1 1  ON 41
eH2_2                -9.113669e-02 1 1  ON 42
eH2_3                -3.715626e-02 1 1  ON 43
eH2_4                 1.173419e-02 1 1  ON 44
eH2_5                 4.675468e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710919e-01 1 1  ON 48
eH2_9                 3.601759e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9151
    reference variance = 0.344318
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336327035716
                                         uncertainty =       0.002883315313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336327035716
                                         uncertainty =       0.002883315313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006338
  error estimate for blocks of size 2^( 2) =       0.000422510088
  error estimate for blocks of size 2^( 3) =       0.000435530839
  error estimate for blocks of size 2^( 4) =       0.000447058424
  error estimate for blocks of size 2^( 5) =       0.000457601135
  error estimate for blocks of size 2^( 6) =       0.000464320171
  error estimate for blocks of size 2^( 7) =       0.000469112754

      target function =                  N/A
              le_mean =     -16.906534551452
             les_mean =     286.167120765379
             stat err =       0.000459523121
             autocorr =       1.256127129698
              std dev =       0.579836523553
             le_variance =       0.336210394046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326925746
                                         uncertainty =       0.002883314033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326925746
                                         uncertainty =       0.002883314033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006271
  error estimate for blocks of size 2^( 2) =       0.000422510024
  error estimate for blocks of size 2^( 3) =       0.000435530778
  error estimate for blocks of size 2^( 4) =       0.000447058362
  error estimate for blocks of size 2^( 5) =       0.000457601076
  error estimate for blocks of size 2^( 6) =       0.000464320113
  error estimate for blocks of size 2^( 7) =       0.000469112694

      target function =                  N/A
              le_mean =     -16.906534551983
             les_mean =     286.167120673359
             stat err =       0.000459523061
             autocorr =       1.256127214586
              std dev =       0.579836428715
             le_variance =       0.336210284065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326980715
                                         uncertainty =       0.002883314673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326980715
                                         uncertainty =       0.002883314673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006304
  error estimate for blocks of size 2^( 2) =       0.000422510056
  error estimate for blocks of size 2^( 3) =       0.000435530808
  error estimate for blocks of size 2^( 4) =       0.000447058393
  error estimate for blocks of size 2^( 5) =       0.000457601106
  error estimate for blocks of size 2^( 6) =       0.000464320142
  error estimate for blocks of size 2^( 7) =       0.000469112724

      target function =                  N/A
              le_mean =     -16.906534551718
             les_mean =     286.167120719356
             stat err =       0.000459523091
             autocorr =       1.256127172168
              std dev =       0.579836476120
             le_variance =       0.336210339039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336327028840
                                         uncertainty =       0.002883315233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336327028840
                                         uncertainty =       0.002883315233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006334
  error estimate for blocks of size 2^( 2) =       0.000422510084
  error estimate for blocks of size 2^( 3) =       0.000435530835
  error estimate for blocks of size 2^( 4) =       0.000447058420
  error estimate for blocks of size 2^( 5) =       0.000457601131
  error estimate for blocks of size 2^( 6) =       0.000464320168
  error estimate for blocks of size 2^( 7) =       0.000469112750

      target function =                  N/A
              le_mean =     -16.906534551485
             les_mean =     286.167120759625
             stat err =       0.000459523117
             autocorr =       1.256127135010
              std dev =       0.579836517623
             le_variance =       0.336210387169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906534551452        initial
     9.5367e+02     9.5367e+03             2.1012e-07       -16.906534551983  <--
     3.8147e+03     3.8147e+04             5.2532e-08       -16.906534551718
     1.5259e+04     1.5259e+05             1.3133e-08       -16.906534551485

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.9662e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8856
    reference variance = 0.279647
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341548103744
                                         uncertainty =       0.006385983959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341548103744
                                         uncertainty =       0.006385983959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413195225
  error estimate for blocks of size 2^( 2) =       0.000425899228
  error estimate for blocks of size 2^( 3) =       0.000438555738
  error estimate for blocks of size 2^( 4) =       0.000450059568
  error estimate for blocks of size 2^( 5) =       0.000460251263
  error estimate for blocks of size 2^( 6) =       0.000466298784
  error estimate for blocks of size 2^( 7) =       0.000472483718

      target function =                  N/A
              le_mean =     -16.905794605794
             les_mean =     286.147351669654
             stat err =       0.000462273333
             autocorr =       1.251662081933
              std dev =       0.584346290403
             le_variance =       0.341460587108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579460579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905794605794       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905794605267       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905794604258       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905794603211       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905794604001       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905794605191       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905794605954       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905794605993       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.130960e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905794605794       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905794605662       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905794605409       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905794605147       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905794605344       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905794605642       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905794605832       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905794605842       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.282830e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905794605794       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905794605761       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905794605697       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905794605635       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905794605681       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905794605755       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905794605804       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905794605806       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.707131e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6056e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.089680e-01 1 1  ON 0
 uu_1                 1.424421e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075381e-02 1 1  ON 3
 uu_4                -6.533849e-02 1 1  ON 4
 uu_5                -9.910998e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296084e-01 1 1  ON 8
 uu_9                -9.897772e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801411e-01 1 1  ON 11
 ud_2                 6.023782e-02 1 1  ON 12
 ud_3                -1.055089e-02 1 1  ON 13
 ud_4                -6.706158e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496130e-01 1 1  ON 17
 ud_8                -1.486734e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358409e-01 1 1  ON 21
 eO_2                -1.870188e-02 1 1  ON 22
 eO_3                 2.975848e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777835e-01 1 1  ON 25
 eO_6                 2.468221e-01 1 1  ON 26
 eO_7                -4.894681e-02 1 1  ON 27
 eO_8                -2.112026e-01 1 1  ON 28
 eO_9                -7.181004e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271621e-02 1 1  ON 32
eH1_3                -3.894811e-02 1 1  ON 33
eH1_4                 8.595720e-03 1 1  ON 34
eH1_5                 4.250132e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649094e-01 1 1  ON 38
eH1_9                 5.063273e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378770e-01 1 1  ON 41
eH2_2                -9.113662e-02 1 1  ON 42
eH2_3                -3.715620e-02 1 1  ON 43
eH2_4                 1.173392e-02 1 1  ON 44
eH2_5                 4.675459e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534700e-01 1 1  ON 47
eH2_8                 1.710922e-01 1 1  ON 48
eH2_9                 3.601794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.279099
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3979e-01
  Total weights = 2.0000e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803611615
                                         uncertainty =       0.003670316052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803611615
                                         uncertainty =       0.003670316052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180550
  error estimate for blocks of size 2^( 2) =       0.000424891031
  error estimate for blocks of size 2^( 3) =       0.000437563518
  error estimate for blocks of size 2^( 4) =       0.000448306670
  error estimate for blocks of size 2^( 5) =       0.000457399371
  error estimate for blocks of size 2^( 6) =       0.000462888322
  error estimate for blocks of size 2^( 7) =       0.000465052826

      target function =                  N/A
              le_mean =     -16.905858213643
             les_mean =     286.147827381657
             stat err =       0.000458411797
             autocorr =       1.236905675589
              std dev =       0.582911324095
             le_variance =       0.339785611758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803925467
                                         uncertainty =       0.003670316930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803925467
                                         uncertainty =       0.003670316930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180740
  error estimate for blocks of size 2^( 2) =       0.000424891207
  error estimate for blocks of size 2^( 3) =       0.000437563672
  error estimate for blocks of size 2^( 4) =       0.000448306810
  error estimate for blocks of size 2^( 5) =       0.000457399496
  error estimate for blocks of size 2^( 6) =       0.000462888461
  error estimate for blocks of size 2^( 7) =       0.000465052973

      target function =                  N/A
              le_mean =     -16.905858209951
             les_mean =     286.147827570450
             stat err =       0.000458411935
             autocorr =       1.236905276801
              std dev =       0.582911593106
             le_variance =       0.339785925377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803768663
                                         uncertainty =       0.003670316490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803768663
                                         uncertainty =       0.003670316490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180645
  error estimate for blocks of size 2^( 2) =       0.000424891119
  error estimate for blocks of size 2^( 3) =       0.000437563595
  error estimate for blocks of size 2^( 4) =       0.000448306740
  error estimate for blocks of size 2^( 5) =       0.000457399434
  error estimate for blocks of size 2^( 6) =       0.000462888392
  error estimate for blocks of size 2^( 7) =       0.000465052899

      target function =                  N/A
              le_mean =     -16.905858211794
             les_mean =     286.147827476085
             stat err =       0.000458411866
             autocorr =       1.236905475989
              std dev =       0.582911458705
             le_variance =       0.339785768690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803631249
                                         uncertainty =       0.003670316107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339803631249
                                         uncertainty =       0.003670316107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180562
  error estimate for blocks of size 2^( 2) =       0.000424891042
  error estimate for blocks of size 2^( 3) =       0.000437563528
  error estimate for blocks of size 2^( 4) =       0.000448306679
  error estimate for blocks of size 2^( 5) =       0.000457399379
  error estimate for blocks of size 2^( 6) =       0.000462888331
  error estimate for blocks of size 2^( 7) =       0.000465052835

      target function =                  N/A
              le_mean =     -16.905858213412
             les_mean =     286.147827393458
             stat err =       0.000458411806
             autocorr =       1.236905650642
              std dev =       0.582911340924
             le_variance =       0.339785631378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905858213643        initial  <--
     2.3842e+02     2.3842e+03             9.1310e-07       -16.905858209951
     9.5367e+02     9.5367e+03             2.2828e-07       -16.905858211794
     3.8147e+03     3.8147e+04             5.7071e-08       -16.905858213412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5667
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8711
    reference variance = 0.314102
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344725609510
                                         uncertainty =       0.006811821121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344725609510
                                         uncertainty =       0.006811821121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415160193
  error estimate for blocks of size 2^( 2) =       0.000427558761
  error estimate for blocks of size 2^( 3) =       0.000441034546
  error estimate for blocks of size 2^( 4) =       0.000453872682
  error estimate for blocks of size 2^( 5) =       0.000464821703
  error estimate for blocks of size 2^( 6) =       0.000471761558
  error estimate for blocks of size 2^( 7) =       0.000473944716

      target function =                  N/A
              le_mean =     -16.905691836954
             les_mean =     286.147132285723
             stat err =       0.000466100165
             autocorr =       1.260454294511
              std dev =       0.587125175769
             le_variance =       0.344715972022


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569183695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905691836954       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905691837195       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905691837247       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905691837613       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905691837664       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905691837629       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905691837645       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 9.145683e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905691836954       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905691837014       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905691837027       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905691837119       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905691837131       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905691837122       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905691837122       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.286437e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905691836954       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905691836969       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905691836972       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905691836995       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905691836983       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905691837002       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905691837000       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.716102e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6570e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910984e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180991e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250138e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063251e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8312
    reference variance = 0.195673
====================================================
  Execution time = 2.0298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4860e-01
  Total weights = 2.0000e+06
  Execution time = 1.8646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680437960
                                         uncertainty =       0.006155254889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680437960
                                         uncertainty =       0.006155254889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417495391
  error estimate for blocks of size 2^( 2) =       0.000429758678
  error estimate for blocks of size 2^( 3) =       0.000442541732
  error estimate for blocks of size 2^( 4) =       0.000454393396
  error estimate for blocks of size 2^( 5) =       0.000465231103
  error estimate for blocks of size 2^( 6) =       0.000473183471
  error estimate for blocks of size 2^( 7) =       0.000476154905

      target function =                  N/A
              le_mean =     -16.905929735028
             les_mean =     286.159064834067
             stat err =       0.000467240719
             autocorr =       1.252500753701
              std dev =       0.590427643875
             le_variance =       0.348604802652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680413994
                                         uncertainty =       0.006155254637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680413994
                                         uncertainty =       0.006155254637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417495376
  error estimate for blocks of size 2^( 2) =       0.000429758664
  error estimate for blocks of size 2^( 3) =       0.000442541718
  error estimate for blocks of size 2^( 4) =       0.000454393381
  error estimate for blocks of size 2^( 5) =       0.000465231087
  error estimate for blocks of size 2^( 6) =       0.000473183457
  error estimate for blocks of size 2^( 7) =       0.000476154892

      target function =                  N/A
              le_mean =     -16.905929735016
             les_mean =     286.159064809707
             stat err =       0.000467240704
             autocorr =       1.252500764552
              std dev =       0.590427623592
             le_variance =       0.348604778701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680425976
                                         uncertainty =       0.006155254763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680425976
                                         uncertainty =       0.006155254763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417495384
  error estimate for blocks of size 2^( 2) =       0.000429758671
  error estimate for blocks of size 2^( 3) =       0.000442541725
  error estimate for blocks of size 2^( 4) =       0.000454393388
  error estimate for blocks of size 2^( 5) =       0.000465231095
  error estimate for blocks of size 2^( 6) =       0.000473183464
  error estimate for blocks of size 2^( 7) =       0.000476154899

      target function =                  N/A
              le_mean =     -16.905929735022
             les_mean =     286.159064821887
             stat err =       0.000467240711
             autocorr =       1.252500759120
              std dev =       0.590427633733
             le_variance =       0.348604790676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680436462
                                         uncertainty =       0.006155254873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348680436462
                                         uncertainty =       0.006155254873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417495390
  error estimate for blocks of size 2^( 2) =       0.000429758677
  error estimate for blocks of size 2^( 3) =       0.000442541731
  error estimate for blocks of size 2^( 4) =       0.000454393395
  error estimate for blocks of size 2^( 5) =       0.000465231102
  error estimate for blocks of size 2^( 6) =       0.000473183470
  error estimate for blocks of size 2^( 7) =       0.000476154905

      target function =                  N/A
              le_mean =     -16.905929735028
             les_mean =     286.159064832544
             stat err =       0.000467240718
             autocorr =       1.252500754370
              std dev =       0.590427642608
             le_variance =       0.348604801155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905929735028        initial  <--
     2.3842e+03     2.3842e+04             9.1457e-08       -16.905929735016
     9.5367e+03     9.5367e+04             2.2864e-08       -16.905929735022
     3.8147e+04     3.8147e+05             5.7161e-09       -16.905929735028

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7140
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8239
    reference variance = 0.231375
====================================================
  Execution time = 2.0892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5085e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350905508533
                                         uncertainty =       0.015722137579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350905508533
                                         uncertainty =       0.015722137579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418839426
  error estimate for blocks of size 2^( 2) =       0.000431702301
  error estimate for blocks of size 2^( 3) =       0.000444919094
  error estimate for blocks of size 2^( 4) =       0.000457503539
  error estimate for blocks of size 2^( 5) =       0.000467940648
  error estimate for blocks of size 2^( 6) =       0.000476740245
  error estimate for blocks of size 2^( 7) =       0.000482709449

      target function =                  N/A
              le_mean =     -16.906717925870
             les_mean =     286.187963779311
             stat err =       0.000471223470
             autocorr =       1.265781413553
              std dev =       0.592328396915
             le_variance =       0.350852929791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671792587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717925870       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717925869       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717925869       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717925869       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717925860       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717925861       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717925850       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906717925861       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.097360e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717925870       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717925870       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717925870       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717925872       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717925820       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717925895       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717925839       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906717925871       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.743402e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717925870       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717925870       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717925870       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717925870       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717925933       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717926040       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717925855       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906717925478       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.858510e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6428e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.353196
====================================================
  Execution time = 1.9802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3449e-01
  Total weights = 2.0000e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390695040
                                         uncertainty =       0.003684561524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390695040
                                         uncertainty =       0.003684561524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408957707
  error estimate for blocks of size 2^( 2) =       0.000421858136
  error estimate for blocks of size 2^( 3) =       0.000434126309
  error estimate for blocks of size 2^( 4) =       0.000446608906
  error estimate for blocks of size 2^( 5) =       0.000456121185
  error estimate for blocks of size 2^( 6) =       0.000463682888
  error estimate for blocks of size 2^( 7) =       0.000468219846

      target function =                  N/A
              le_mean =     -16.906358754494
             les_mean =     286.159458980983
             stat err =       0.000458658206
             autocorr =       1.257828821208
              std dev =       0.578353535972
             le_variance =       0.334492812571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390691901
                                         uncertainty =       0.003684561454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390691901
                                         uncertainty =       0.003684561454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408957705
  error estimate for blocks of size 2^( 2) =       0.000421858134
  error estimate for blocks of size 2^( 3) =       0.000434126307
  error estimate for blocks of size 2^( 4) =       0.000446608905
  error estimate for blocks of size 2^( 5) =       0.000456121183
  error estimate for blocks of size 2^( 6) =       0.000463682886
  error estimate for blocks of size 2^( 7) =       0.000468219844

      target function =                  N/A
              le_mean =     -16.906358754487
             les_mean =     286.159458977609
             stat err =       0.000458658204
             autocorr =       1.257828823442
              std dev =       0.578353533262
             le_variance =       0.334492809436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390693470
                                         uncertainty =       0.003684561489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390693470
                                         uncertainty =       0.003684561489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408957706
  error estimate for blocks of size 2^( 2) =       0.000421858135
  error estimate for blocks of size 2^( 3) =       0.000434126308
  error estimate for blocks of size 2^( 4) =       0.000446608905
  error estimate for blocks of size 2^( 5) =       0.000456121184
  error estimate for blocks of size 2^( 6) =       0.000463682887
  error estimate for blocks of size 2^( 7) =       0.000468219845

      target function =                  N/A
              le_mean =     -16.906358754491
             les_mean =     286.159458979296
             stat err =       0.000458658205
             autocorr =       1.257828822332
              std dev =       0.578353534617
             le_variance =       0.334492811003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390694843
                                         uncertainty =       0.003684561520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334390694843
                                         uncertainty =       0.003684561520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408957707
  error estimate for blocks of size 2^( 2) =       0.000421858136
  error estimate for blocks of size 2^( 3) =       0.000434126309
  error estimate for blocks of size 2^( 4) =       0.000446608906
  error estimate for blocks of size 2^( 5) =       0.000456121185
  error estimate for blocks of size 2^( 6) =       0.000463682887
  error estimate for blocks of size 2^( 7) =       0.000468219846

      target function =                  N/A
              le_mean =     -16.906358754494
             les_mean =     286.159458980772
             stat err =       0.000458658206
             autocorr =       1.257828821349
              std dev =       0.578353535802
             le_variance =       0.334492812375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906358754494        initial  <--
     2.3842e+04     2.3842e+05             1.0974e-08       -16.906358754487
     9.5367e+04     9.5367e+05             2.7434e-09       -16.906358754491
     3.8147e+05     3.8147e+06             6.8585e-10       -16.906358754494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2889
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8604
    reference variance = 0.219615
====================================================
  Execution time = 2.0155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347969580667
                                         uncertainty =       0.011100855460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347969580667
                                         uncertainty =       0.011100855460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417070244
  error estimate for blocks of size 2^( 2) =       0.000429131576
  error estimate for blocks of size 2^( 3) =       0.000442716196
  error estimate for blocks of size 2^( 4) =       0.000455340827
  error estimate for blocks of size 2^( 5) =       0.000467167886
  error estimate for blocks of size 2^( 6) =       0.000475305046
  error estimate for blocks of size 2^( 7) =       0.000481061709

      target function =                  N/A
              le_mean =     -16.906040681203
             les_mean =     286.162106518204
             stat err =       0.000469718867
             autocorr =       1.268403980624
              std dev =       0.589826396212
             le_variance =       0.347895177668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604068120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040681203       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040681203       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040681205       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040681368       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040681085       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040681396       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040681138       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040681209       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.731671e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040681203       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040681203       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040681203       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040681204       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040680954       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040681519       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040681186       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040681211       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.432918e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040681203       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040681203       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040681203       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040680868       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040681682       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040678763       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040681084       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040682321       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.082290e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5670e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9118
    reference variance = 0.233235
====================================================
  Execution time = 1.9868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.0000e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396422
                                         uncertainty =       0.003286483716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396422
                                         uncertainty =       0.003286483716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110055
  error estimate for blocks of size 2^( 2) =       0.000424768655
  error estimate for blocks of size 2^( 3) =       0.000437513916
  error estimate for blocks of size 2^( 4) =       0.000449758487
  error estimate for blocks of size 2^( 5) =       0.000459866750
  error estimate for blocks of size 2^( 6) =       0.000466719450
  error estimate for blocks of size 2^( 7) =       0.000473450979

      target function =                  N/A
              le_mean =     -16.906643638659
             les_mean =     286.174268348948
             stat err =       0.000462448917
             autocorr =       1.259218548005
              std dev =       0.582811628393
             le_variance =       0.339669394190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396081
                                         uncertainty =       0.003286483710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396081
                                         uncertainty =       0.003286483710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110054
  error estimate for blocks of size 2^( 2) =       0.000424768654
  error estimate for blocks of size 2^( 3) =       0.000437513915
  error estimate for blocks of size 2^( 4) =       0.000449758487
  error estimate for blocks of size 2^( 5) =       0.000459866750
  error estimate for blocks of size 2^( 6) =       0.000466719450
  error estimate for blocks of size 2^( 7) =       0.000473450979

      target function =                  N/A
              le_mean =     -16.906643638656
             les_mean =     286.174268348536
             stat err =       0.000462448917
             autocorr =       1.259218548187
              std dev =       0.582811628101
             le_variance =       0.339669393850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396251
                                         uncertainty =       0.003286483713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396251
                                         uncertainty =       0.003286483713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110054
  error estimate for blocks of size 2^( 2) =       0.000424768654
  error estimate for blocks of size 2^( 3) =       0.000437513915
  error estimate for blocks of size 2^( 4) =       0.000449758487
  error estimate for blocks of size 2^( 5) =       0.000459866750
  error estimate for blocks of size 2^( 6) =       0.000466719450
  error estimate for blocks of size 2^( 7) =       0.000473450979

      target function =                  N/A
              le_mean =     -16.906643638657
             les_mean =     286.174268348742
             stat err =       0.000462448917
             autocorr =       1.259218548100
              std dev =       0.582811628247
             le_variance =       0.339669394020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396400
                                         uncertainty =       0.003286483716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339704396400
                                         uncertainty =       0.003286483716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110055
  error estimate for blocks of size 2^( 2) =       0.000424768654
  error estimate for blocks of size 2^( 3) =       0.000437513916
  error estimate for blocks of size 2^( 4) =       0.000449758487
  error estimate for blocks of size 2^( 5) =       0.000459866750
  error estimate for blocks of size 2^( 6) =       0.000466719450
  error estimate for blocks of size 2^( 7) =       0.000473450979

      target function =                  N/A
              le_mean =     -16.906643638658
             les_mean =     286.174268348922
             stat err =       0.000462448917
             autocorr =       1.259218548015
              std dev =       0.582811628375
             le_variance =       0.339669394169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906643638659        initial  <--
     2.3842e+05     2.3842e+06             9.7317e-10       -16.906643638656
     9.5367e+05     9.5367e+06             2.4329e-10       -16.906643638657
     3.8147e+06     3.8147e+07             6.0823e-11       -16.906643638658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3006
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5005e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9921
    reference variance = 0.310835
====================================================
  Execution time = 2.2931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3298e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333084221067
                                         uncertainty =       0.003340067960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333084221067
                                         uncertainty =       0.003340067960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408029740
  error estimate for blocks of size 2^( 2) =       0.000421085181
  error estimate for blocks of size 2^( 3) =       0.000434917429
  error estimate for blocks of size 2^( 4) =       0.000447849625
  error estimate for blocks of size 2^( 5) =       0.000460199072
  error estimate for blocks of size 2^( 6) =       0.000470398323
  error estimate for blocks of size 2^( 7) =       0.000477332009

      target function =                  N/A
              le_mean =     -16.905690400477
             les_mean =     286.135344287110
             stat err =       0.000463944757
             autocorr =       1.292852282064
              std dev =       0.577041191619
             le_variance =       0.332976536825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569040048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690400477       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690400477       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690400477       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690400512       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690400446       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690400351       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690399993       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690399271       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.076645e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690400477       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690400477       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690400477       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690405538       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690396587       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690402249       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690400899       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690394292       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.691613e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690400477       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690400477       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690400477       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690404393       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690415714       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690392016       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690396326       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690391311       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 6.729066e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8469e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.433582
====================================================
  Execution time = 2.1076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.0000e+06
  Execution time = 1.8688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851424
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851424
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410230776
  error estimate for blocks of size 2^( 2) =       0.000422752201
  error estimate for blocks of size 2^( 3) =       0.000435463025
  error estimate for blocks of size 2^( 4) =       0.000447677788
  error estimate for blocks of size 2^( 5) =       0.000457847993
  error estimate for blocks of size 2^( 6) =       0.000465390799
  error estimate for blocks of size 2^( 7) =       0.000468977052

      target function =                  N/A
              le_mean =     -16.905129145633
             les_mean =     286.119969841358
             stat err =       0.000459973408
             autocorr =       1.257213317147
              std dev =       0.580153927092
             le_variance =       0.336578579121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851440
                                         uncertainty =       0.002998067358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851440
                                         uncertainty =       0.002998067358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410230776
  error estimate for blocks of size 2^( 2) =       0.000422752201
  error estimate for blocks of size 2^( 3) =       0.000435463025
  error estimate for blocks of size 2^( 4) =       0.000447677788
  error estimate for blocks of size 2^( 5) =       0.000457847993
  error estimate for blocks of size 2^( 6) =       0.000465390799
  error estimate for blocks of size 2^( 7) =       0.000468977052

      target function =                  N/A
              le_mean =     -16.905129145633
             les_mean =     286.119969841378
             stat err =       0.000459973408
             autocorr =       1.257213317123
              std dev =       0.580153927107
             le_variance =       0.336578579137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851432
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851432
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410230776
  error estimate for blocks of size 2^( 2) =       0.000422752201
  error estimate for blocks of size 2^( 3) =       0.000435463025
  error estimate for blocks of size 2^( 4) =       0.000447677788
  error estimate for blocks of size 2^( 5) =       0.000457847993
  error estimate for blocks of size 2^( 6) =       0.000465390799
  error estimate for blocks of size 2^( 7) =       0.000468977052

      target function =                  N/A
              le_mean =     -16.905129145633
             les_mean =     286.119969841368
             stat err =       0.000459973408
             autocorr =       1.257213317136
              std dev =       0.580153927099
             le_variance =       0.336578579129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851425
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336553851425
                                         uncertainty =       0.002998067357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410230776
  error estimate for blocks of size 2^( 2) =       0.000422752201
  error estimate for blocks of size 2^( 3) =       0.000435463025
  error estimate for blocks of size 2^( 4) =       0.000447677788
  error estimate for blocks of size 2^( 5) =       0.000457847993
  error estimate for blocks of size 2^( 6) =       0.000465390799
  error estimate for blocks of size 2^( 7) =       0.000468977051

      target function =                  N/A
              le_mean =     -16.905129145633
             les_mean =     286.119969841360
             stat err =       0.000459973408
             autocorr =       1.257213317141
              std dev =       0.580153927093
             le_variance =       0.336578579122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905129145633        initial
     2.3842e+06     2.3842e+07             1.0766e-10       -16.905129145633  <--
     9.5367e+06     9.5367e+07             2.6916e-11       -16.905129145633
     3.8147e+07     3.8147e+08             6.7291e-12       -16.905129145633

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 3.0489e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.230167
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3834e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338355159666
                                         uncertainty =       0.005335893869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338355159666
                                         uncertainty =       0.005335893869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411304815
  error estimate for blocks of size 2^( 2) =       0.000424013765
  error estimate for blocks of size 2^( 3) =       0.000437070410
  error estimate for blocks of size 2^( 4) =       0.000448603760
  error estimate for blocks of size 2^( 5) =       0.000458978335
  error estimate for blocks of size 2^( 6) =       0.000466410241
  error estimate for blocks of size 2^( 7) =       0.000473548218

      target function =                  N/A
              le_mean =     -16.905612393351
             les_mean =     286.138073527451
             stat err =       0.000461885138
             autocorr =       1.261073469588
              std dev =       0.581672848255
             le_variance =       0.338343302397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561239335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905612393351       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905612393351       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612393350       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905612393349       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905612393094       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612393358       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612393840       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612394058       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 3.976808e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905612393351       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905612393351       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612393351       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905612393350       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905612393008       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612391186       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612394923       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612393753       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 9.942063e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905612393351       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905612393351       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612393351       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905612393351       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905612393610       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612385772       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612389687       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612386948       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.485557e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6325e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9318
    reference variance = 0.277041
====================================================
  Execution time = 1.9808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.0000e+06
  Execution time = 1.8621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464642
                                         uncertainty =       0.003515281807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464642
                                         uncertainty =       0.003515281807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411000209
  error estimate for blocks of size 2^( 2) =       0.000424081091
  error estimate for blocks of size 2^( 3) =       0.000437774021
  error estimate for blocks of size 2^( 4) =       0.000450388826
  error estimate for blocks of size 2^( 5) =       0.000461899995
  error estimate for blocks of size 2^( 6) =       0.000471531180
  error estimate for blocks of size 2^( 7) =       0.000477267128

      target function =                  N/A
              le_mean =     -16.906258416985
             les_mean =     286.159415837341
             stat err =       0.000465271782
             autocorr =       1.281531665963
              std dev =       0.581242070375
             le_variance =       0.337842344374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464668
                                         uncertainty =       0.003515281808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464668
                                         uncertainty =       0.003515281808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411000209
  error estimate for blocks of size 2^( 2) =       0.000424081091
  error estimate for blocks of size 2^( 3) =       0.000437774021
  error estimate for blocks of size 2^( 4) =       0.000450388826
  error estimate for blocks of size 2^( 5) =       0.000461899995
  error estimate for blocks of size 2^( 6) =       0.000471531180
  error estimate for blocks of size 2^( 7) =       0.000477267128

      target function =                  N/A
              le_mean =     -16.906258416984
             les_mean =     286.159415837325
             stat err =       0.000465271782
             autocorr =       1.281531665880
              std dev =       0.581242070398
             le_variance =       0.337842344400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464655
                                         uncertainty =       0.003515281808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464655
                                         uncertainty =       0.003515281808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411000209
  error estimate for blocks of size 2^( 2) =       0.000424081091
  error estimate for blocks of size 2^( 3) =       0.000437774021
  error estimate for blocks of size 2^( 4) =       0.000450388826
  error estimate for blocks of size 2^( 5) =       0.000461899995
  error estimate for blocks of size 2^( 6) =       0.000471531180
  error estimate for blocks of size 2^( 7) =       0.000477267128

      target function =                  N/A
              le_mean =     -16.906258416985
             les_mean =     286.159415837333
             stat err =       0.000465271782
             autocorr =       1.281531665923
              std dev =       0.581242070387
             le_variance =       0.337842344387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464643
                                         uncertainty =       0.003515281807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337802464643
                                         uncertainty =       0.003515281807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411000209
  error estimate for blocks of size 2^( 2) =       0.000424081091
  error estimate for blocks of size 2^( 3) =       0.000437774021
  error estimate for blocks of size 2^( 4) =       0.000450388826
  error estimate for blocks of size 2^( 5) =       0.000461899995
  error estimate for blocks of size 2^( 6) =       0.000471531180
  error estimate for blocks of size 2^( 7) =       0.000477267128

      target function =                  N/A
              le_mean =     -16.906258416985
             les_mean =     286.159415837340
             stat err =       0.000465271782
             autocorr =       1.281531665952
              std dev =       0.581242070377
             le_variance =       0.337842344376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906258416985        initial  <--
     5.9605e+05     5.9605e+06             3.9768e-10       -16.906258416984
     2.3842e+06     2.3842e+07             9.9421e-11       -16.906258416985
     9.5367e+06     9.5367e+07             2.4856e-11       -16.906258416985

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2154
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9009
    reference variance = 0.22756
====================================================
  Execution time = 2.0284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338579226079
                                         uncertainty =       0.003319149491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338579226079
                                         uncertainty =       0.003319149491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411408041
  error estimate for blocks of size 2^( 2) =       0.000423942647
  error estimate for blocks of size 2^( 3) =       0.000436727696
  error estimate for blocks of size 2^( 4) =       0.000449273467
  error estimate for blocks of size 2^( 5) =       0.000459726628
  error estimate for blocks of size 2^( 6) =       0.000468770120
  error estimate for blocks of size 2^( 7) =       0.000474882826

      target function =                  N/A
              le_mean =     -16.905373431765
             les_mean =     286.130163850496
             stat err =       0.000463163260
             autocorr =       1.267426120812
              std dev =       0.581818831182
             le_variance =       0.338513152318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537343177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905373431765       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905373431765       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905373431765       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905373426812       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905373435031       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905373426935       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905373438619       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905373434733       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.922826e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905373431765       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905373431765       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905373431765       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905373431765       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905373428774       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905373422566       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905373431150       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905373431338       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.806966e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905373431765       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905373431765       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905373431765       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905373431765       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905373470805       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905373461872       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905373470435       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905373288268       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.452088e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5935e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.183831
====================================================
  Execution time = 1.9895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3913e-01
  Total weights = 2.0000e+06
  Execution time = 1.8475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156921
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156921
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411783454
  error estimate for blocks of size 2^( 2) =       0.000424325132
  error estimate for blocks of size 2^( 3) =       0.000437396794
  error estimate for blocks of size 2^( 4) =       0.000448926562
  error estimate for blocks of size 2^( 5) =       0.000459673314
  error estimate for blocks of size 2^( 6) =       0.000465501643
  error estimate for blocks of size 2^( 7) =       0.000471282513

      target function =                  N/A
              le_mean =     -16.906128361573
             les_mean =     286.156307235171
             stat err =       0.000461346008
             autocorr =       1.255208144440
              std dev =       0.582349746083
             le_variance =       0.339131226762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156944
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156944
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411783454
  error estimate for blocks of size 2^( 2) =       0.000424325132
  error estimate for blocks of size 2^( 3) =       0.000437396794
  error estimate for blocks of size 2^( 4) =       0.000448926562
  error estimate for blocks of size 2^( 5) =       0.000459673314
  error estimate for blocks of size 2^( 6) =       0.000465501643
  error estimate for blocks of size 2^( 7) =       0.000471282513

      target function =                  N/A
              le_mean =     -16.906128361573
             les_mean =     286.156307235196
             stat err =       0.000461346008
             autocorr =       1.255208144409
              std dev =       0.582349746102
             le_variance =       0.339131226786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156933
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156933
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411783454
  error estimate for blocks of size 2^( 2) =       0.000424325132
  error estimate for blocks of size 2^( 3) =       0.000437396794
  error estimate for blocks of size 2^( 4) =       0.000448926562
  error estimate for blocks of size 2^( 5) =       0.000459673314
  error estimate for blocks of size 2^( 6) =       0.000465501643
  error estimate for blocks of size 2^( 7) =       0.000471282513

      target function =                  N/A
              le_mean =     -16.906128361573
             les_mean =     286.156307235183
             stat err =       0.000461346008
             autocorr =       1.255208144429
              std dev =       0.582349746092
             le_variance =       0.339131226774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156923
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338976156923
                                         uncertainty =       0.003124620824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411783454
  error estimate for blocks of size 2^( 2) =       0.000424325132
  error estimate for blocks of size 2^( 3) =       0.000437396794
  error estimate for blocks of size 2^( 4) =       0.000448926562
  error estimate for blocks of size 2^( 5) =       0.000459673314
  error estimate for blocks of size 2^( 6) =       0.000465501643
  error estimate for blocks of size 2^( 7) =       0.000471282513

      target function =                  N/A
              le_mean =     -16.906128361573
             les_mean =     286.156307235173
             stat err =       0.000461346008
             autocorr =       1.255208144442
              std dev =       0.582349746084
             le_variance =       0.339131226764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906128361573        initial
     5.9605e+06     5.9605e+07             3.9228e-11       -16.906128361573  <--
     2.3842e+07     2.3842e+08             9.8070e-12       -16.906128361573
     9.5367e+07     9.5367e+08             2.4521e-12       -16.906128361573

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.9251e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.216737
====================================================
  Execution time = 2.0805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336125306255
                                         uncertainty =       0.003604360625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336125306255
                                         uncertainty =       0.003604360625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409884507
  error estimate for blocks of size 2^( 2) =       0.000422246339
  error estimate for blocks of size 2^( 3) =       0.000434903777
  error estimate for blocks of size 2^( 4) =       0.000447018606
  error estimate for blocks of size 2^( 5) =       0.000458013404
  error estimate for blocks of size 2^( 6) =       0.000465164859
  error estimate for blocks of size 2^( 7) =       0.000466155270

      target function =                  N/A
              le_mean =     -16.906723430777
             les_mean =     286.173307614457
             stat err =       0.000459088035
             autocorr =       1.254495022596
              std dev =       0.579664228400
             le_variance =       0.336010617686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690672343078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906723430777       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906723430777       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906723430777       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906723430778       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906723430778       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906723430778       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906723430907       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906723430748       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.529682e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906723430777       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906723430777       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906723430777       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906723432166       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906723431066       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906723430777       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906723430843       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906723426210       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.824163e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906723430777       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906723430777       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906723430777       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906723430777       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906723430777       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906723435915       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906723445628       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906723408492       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.560574e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6366e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8318
    reference variance = 0.192599
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4149e-01
  Total weights = 2.0000e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902040
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902040
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413210515
  error estimate for blocks of size 2^( 2) =       0.000426145461
  error estimate for blocks of size 2^( 3) =       0.000439227164
  error estimate for blocks of size 2^( 4) =       0.000451857915
  error estimate for blocks of size 2^( 5) =       0.000462863142
  error estimate for blocks of size 2^( 6) =       0.000471422100
  error estimate for blocks of size 2^( 7) =       0.000478159762

      target function =                  N/A
              le_mean =     -16.905991039933
             les_mean =     286.154018730985
             stat err =       0.000466075730
             autocorr =       1.272243519159
              std dev =       0.584367914455
             le_variance =       0.341485859444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902078
                                         uncertainty =       0.004514339448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902078
                                         uncertainty =       0.004514339448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413210515
  error estimate for blocks of size 2^( 2) =       0.000426145461
  error estimate for blocks of size 2^( 3) =       0.000439227164
  error estimate for blocks of size 2^( 4) =       0.000451857915
  error estimate for blocks of size 2^( 5) =       0.000462863142
  error estimate for blocks of size 2^( 6) =       0.000471422100
  error estimate for blocks of size 2^( 7) =       0.000478159762

      target function =                  N/A
              le_mean =     -16.905991039933
             les_mean =     286.154018731037
             stat err =       0.000466075730
             autocorr =       1.272243519084
              std dev =       0.584367914487
             le_variance =       0.341485859482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902059
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902059
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413210515
  error estimate for blocks of size 2^( 2) =       0.000426145461
  error estimate for blocks of size 2^( 3) =       0.000439227164
  error estimate for blocks of size 2^( 4) =       0.000451857915
  error estimate for blocks of size 2^( 5) =       0.000462863142
  error estimate for blocks of size 2^( 6) =       0.000471422100
  error estimate for blocks of size 2^( 7) =       0.000478159762

      target function =                  N/A
              le_mean =     -16.905991039933
             les_mean =     286.154018731011
             stat err =       0.000466075730
             autocorr =       1.272243519118
              std dev =       0.584367914471
             le_variance =       0.341485859463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902042
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568902042
                                         uncertainty =       0.004514339447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413210515
  error estimate for blocks of size 2^( 2) =       0.000426145461
  error estimate for blocks of size 2^( 3) =       0.000439227164
  error estimate for blocks of size 2^( 4) =       0.000451857915
  error estimate for blocks of size 2^( 5) =       0.000462863142
  error estimate for blocks of size 2^( 6) =       0.000471422100
  error estimate for blocks of size 2^( 7) =       0.000478159762

      target function =                  N/A
              le_mean =     -16.905991039933
             les_mean =     286.154018730988
             stat err =       0.000466075730
             autocorr =       1.272243519147
              std dev =       0.584367914457
             le_variance =       0.341485859446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905991039933        initial
     1.4901e+06     1.4901e+07             1.5297e-10       -16.905991039933  <--
     5.9605e+06     5.9605e+07             3.8242e-11       -16.905991039933
     2.3842e+07     2.3842e+08             9.5606e-12       -16.905991039933

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 2.9551e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.756222
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336313837268
                                         uncertainty =       0.002775587313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336313837268
                                         uncertainty =       0.002775587313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410073306
  error estimate for blocks of size 2^( 2) =       0.000422764299
  error estimate for blocks of size 2^( 3) =       0.000435869662
  error estimate for blocks of size 2^( 4) =       0.000448036762
  error estimate for blocks of size 2^( 5) =       0.000458249288
  error estimate for blocks of size 2^( 6) =       0.000465032810
  error estimate for blocks of size 2^( 7) =       0.000472264081

      target function =                  N/A
              le_mean =     -16.906026942456
             les_mean =     286.150067043140
             stat err =       0.000460895735
             autocorr =       1.263229853241
              std dev =       0.579931230632
             le_variance =       0.336320232263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602694246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026942456       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906026942456       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026942455       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906026942458       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026942478       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906026942585       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906026942476       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906026942458       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.266747e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026942456       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906026942456       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026942456       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906026941328       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026942456       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906026942608       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906026942650       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906026943236       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.566681e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026942456       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906026942456       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026942456       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906026940098       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026944281       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906026942482       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906026941199       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906026939185       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.916707e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6031e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9372
    reference variance = 0.258943
====================================================
  Execution time = 2.0670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4038e-01
  Total weights = 2.0000e+06
  Execution time = 1.8613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731486
                                         uncertainty =       0.005735153234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731486
                                         uncertainty =       0.005735153234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412541682
  error estimate for blocks of size 2^( 2) =       0.000425213363
  error estimate for blocks of size 2^( 3) =       0.000437730876
  error estimate for blocks of size 2^( 4) =       0.000449462470
  error estimate for blocks of size 2^( 5) =       0.000459864864
  error estimate for blocks of size 2^( 6) =       0.000467861437
  error estimate for blocks of size 2^( 7) =       0.000473067559

      target function =                  N/A
              le_mean =     -16.905969500399
             les_mean =     286.152185857677
             stat err =       0.000462564083
             autocorr =       1.257210918174
              std dev =       0.583422042304
             le_variance =       0.340381279446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731199
                                         uncertainty =       0.005735153224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731199
                                         uncertainty =       0.005735153224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412541682
  error estimate for blocks of size 2^( 2) =       0.000425213363
  error estimate for blocks of size 2^( 3) =       0.000437730875
  error estimate for blocks of size 2^( 4) =       0.000449462470
  error estimate for blocks of size 2^( 5) =       0.000459864864
  error estimate for blocks of size 2^( 6) =       0.000467861436
  error estimate for blocks of size 2^( 7) =       0.000473067559

      target function =                  N/A
              le_mean =     -16.905969500402
             les_mean =     286.152185857482
             stat err =       0.000462564082
             autocorr =       1.257210918423
              std dev =       0.583422042057
             le_variance =       0.340381279158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731343
                                         uncertainty =       0.005735153229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731343
                                         uncertainty =       0.005735153229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412541682
  error estimate for blocks of size 2^( 2) =       0.000425213363
  error estimate for blocks of size 2^( 3) =       0.000437730876
  error estimate for blocks of size 2^( 4) =       0.000449462470
  error estimate for blocks of size 2^( 5) =       0.000459864864
  error estimate for blocks of size 2^( 6) =       0.000467861436
  error estimate for blocks of size 2^( 7) =       0.000473067559

      target function =                  N/A
              le_mean =     -16.905969500400
             les_mean =     286.152185857580
             stat err =       0.000462564082
             autocorr =       1.257210918300
              std dev =       0.583422042180
             le_variance =       0.340381279302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731468
                                         uncertainty =       0.005735153234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336731468
                                         uncertainty =       0.005735153234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412541682
  error estimate for blocks of size 2^( 2) =       0.000425213363
  error estimate for blocks of size 2^( 3) =       0.000437730876
  error estimate for blocks of size 2^( 4) =       0.000449462470
  error estimate for blocks of size 2^( 5) =       0.000459864864
  error estimate for blocks of size 2^( 6) =       0.000467861436
  error estimate for blocks of size 2^( 7) =       0.000473067559

      target function =                  N/A
              le_mean =     -16.905969500399
             les_mean =     286.152185857665
             stat err =       0.000462564083
             autocorr =       1.257210918186
              std dev =       0.583422042288
             le_variance =       0.340381279428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905969500399        initial
     3.7253e+05     3.7253e+06             6.2667e-10       -16.905969500402  <--
     1.4901e+06     1.4901e+07             1.5667e-10       -16.905969500400
     5.9605e+06     5.9605e+07             3.9167e-11       -16.905969500399

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 3.0066e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.223236
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335227990348
                                         uncertainty =       0.003922185440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335227990348
                                         uncertainty =       0.003922185440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409376861
  error estimate for blocks of size 2^( 2) =       0.000422101680
  error estimate for blocks of size 2^( 3) =       0.000435485068
  error estimate for blocks of size 2^( 4) =       0.000447515658
  error estimate for blocks of size 2^( 5) =       0.000458166363
  error estimate for blocks of size 2^( 6) =       0.000465948564
  error estimate for blocks of size 2^( 7) =       0.000471020894

      target function =                  N/A
              le_mean =     -16.905191090924
             les_mean =     286.120664481850
             stat err =       0.000460662870
             autocorr =       1.266251094460
              std dev =       0.578946309053
             le_variance =       0.335178828766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519109092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191090924       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191090930       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191090944       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191090950       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191090932       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191090947       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191091002       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191090981       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.356676e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191090924       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191090926       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191090929       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191091005       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191091135       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191090920       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191090988       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191090746       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 5.891693e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191090924       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191090925       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191090926       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191090926       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191090926       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191090253       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191091668       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191091152       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.472924e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8582e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.844
    reference variance = 0.228011
====================================================
  Execution time = 1.9994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3717e-01
  Total weights = 2.0000e+06
  Execution time = 1.8509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157098
                                         uncertainty =       0.003531170753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157098
                                         uncertainty =       0.003531170753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410588765
  error estimate for blocks of size 2^( 2) =       0.000423306520
  error estimate for blocks of size 2^( 3) =       0.000436474236
  error estimate for blocks of size 2^( 4) =       0.000448892235
  error estimate for blocks of size 2^( 5) =       0.000458837262
  error estimate for blocks of size 2^( 6) =       0.000466757868
  error estimate for blocks of size 2^( 7) =       0.000471348317

      target function =                  N/A
              le_mean =     -16.906581075725
             les_mean =     286.169649769153
             stat err =       0.000461458921
             autocorr =       1.263141398606
              std dev =       0.580660199845
             le_variance =       0.337166267684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112158453
                                         uncertainty =       0.003531170765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112158453
                                         uncertainty =       0.003531170765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410588766
  error estimate for blocks of size 2^( 2) =       0.000423306520
  error estimate for blocks of size 2^( 3) =       0.000436474237
  error estimate for blocks of size 2^( 4) =       0.000448892236
  error estimate for blocks of size 2^( 5) =       0.000458837262
  error estimate for blocks of size 2^( 6) =       0.000466757869
  error estimate for blocks of size 2^( 7) =       0.000471348318

      target function =                  N/A
              le_mean =     -16.906581075726
             les_mean =     286.169649770543
             stat err =       0.000461458921
             autocorr =       1.263141397279
              std dev =       0.580660201011
             le_variance =       0.337166269038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157776
                                         uncertainty =       0.003531170759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157776
                                         uncertainty =       0.003531170759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410588765
  error estimate for blocks of size 2^( 2) =       0.000423306520
  error estimate for blocks of size 2^( 3) =       0.000436474237
  error estimate for blocks of size 2^( 4) =       0.000448892236
  error estimate for blocks of size 2^( 5) =       0.000458837262
  error estimate for blocks of size 2^( 6) =       0.000466757869
  error estimate for blocks of size 2^( 7) =       0.000471348318

      target function =                  N/A
              le_mean =     -16.906581075725
             les_mean =     286.169649769848
             stat err =       0.000461458921
             autocorr =       1.263141397951
              std dev =       0.580660200428
             le_variance =       0.337166268361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157182
                                         uncertainty =       0.003531170753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337112157182
                                         uncertainty =       0.003531170753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410588765
  error estimate for blocks of size 2^( 2) =       0.000423306520
  error estimate for blocks of size 2^( 3) =       0.000436474237
  error estimate for blocks of size 2^( 4) =       0.000448892235
  error estimate for blocks of size 2^( 5) =       0.000458837262
  error estimate for blocks of size 2^( 6) =       0.000466757868
  error estimate for blocks of size 2^( 7) =       0.000471348317

      target function =                  N/A
              le_mean =     -16.906581075725
             les_mean =     286.169649769240
             stat err =       0.000461458921
             autocorr =       1.263141398526
              std dev =       0.580660199918
             le_variance =       0.337166267769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906581075725        initial
     9.3132e+04     9.3132e+05             2.3567e-09       -16.906581075726  <--
     3.7253e+05     3.7253e+06             5.8917e-10       -16.906581075725
     1.4901e+06     1.4901e+07             1.4729e-10       -16.906581075725

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9333e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395223e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675467e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9277
    reference variance = 0.242111
====================================================
  Execution time = 2.0947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3371e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333814715666
                                         uncertainty =       0.002575425313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333814715666
                                         uncertainty =       0.002575425313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408480529
  error estimate for blocks of size 2^( 2) =       0.000421379213
  error estimate for blocks of size 2^( 3) =       0.000434678642
  error estimate for blocks of size 2^( 4) =       0.000447801436
  error estimate for blocks of size 2^( 5) =       0.000459271390
  error estimate for blocks of size 2^( 6) =       0.000468457234
  error estimate for blocks of size 2^( 7) =       0.000473793095

      target function =                  N/A
              le_mean =     -16.905117597247
             les_mean =     286.116713495857
             stat err =       0.000462330789
             autocorr =       1.281040651284
              std dev =       0.577678704776
             le_variance =       0.333712685952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690511759725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905117597247       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905117597269       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905117597282       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905117597263       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905117597272       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905117597274       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905117597284       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905117597290       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.085818e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905117597247       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905117597253       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905117597256       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905117597251       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905117597249       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905117597320       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905117597231       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905117597623       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.714554e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905117597247       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905117597249       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905117597249       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905117597056       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905117597238       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905117597213       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905117597077       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905117596753       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.786393e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6477e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533851e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468219e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271611e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063250e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378767e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173409e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9049
    reference variance = 0.366468
====================================================
  Execution time = 2.0988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4551e-01
  Total weights = 2.0000e+06
  Execution time = 1.8524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594737698
                                         uncertainty =       0.004038955352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594737698
                                         uncertainty =       0.004038955352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415636349
  error estimate for blocks of size 2^( 2) =       0.000428055050
  error estimate for blocks of size 2^( 3) =       0.000441121316
  error estimate for blocks of size 2^( 4) =       0.000453562749
  error estimate for blocks of size 2^( 5) =       0.000464754928
  error estimate for blocks of size 2^( 6) =       0.000470635648
  error estimate for blocks of size 2^( 7) =       0.000474548779

      target function =                  N/A
              le_mean =     -16.905590804209
             les_mean =     286.144507416172
             stat err =       0.000465875526
             autocorr =       1.256356089541
              std dev =       0.587798562071
             le_variance =       0.345507149573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594740858
                                         uncertainty =       0.004038955375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594740858
                                         uncertainty =       0.004038955375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415636351
  error estimate for blocks of size 2^( 2) =       0.000428055052
  error estimate for blocks of size 2^( 3) =       0.000441121317
  error estimate for blocks of size 2^( 4) =       0.000453562750
  error estimate for blocks of size 2^( 5) =       0.000464754930
  error estimate for blocks of size 2^( 6) =       0.000470635649
  error estimate for blocks of size 2^( 7) =       0.000474548780

      target function =                  N/A
              le_mean =     -16.905590804242
             les_mean =     286.144507420436
             stat err =       0.000465875527
             autocorr =       1.256356084743
              std dev =       0.587798564760
             le_variance =       0.345507152734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594739278
                                         uncertainty =       0.004038955364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594739278
                                         uncertainty =       0.004038955364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415636350
  error estimate for blocks of size 2^( 2) =       0.000428055051
  error estimate for blocks of size 2^( 3) =       0.000441121316
  error estimate for blocks of size 2^( 4) =       0.000453562749
  error estimate for blocks of size 2^( 5) =       0.000464754929
  error estimate for blocks of size 2^( 6) =       0.000470635648
  error estimate for blocks of size 2^( 7) =       0.000474548780

      target function =                  N/A
              le_mean =     -16.905590804225
             les_mean =     286.144507418304
             stat err =       0.000465875527
             autocorr =       1.256356087142
              std dev =       0.587798563416
             le_variance =       0.345507151153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594737896
                                         uncertainty =       0.004038955354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345594737896
                                         uncertainty =       0.004038955354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415636349
  error estimate for blocks of size 2^( 2) =       0.000428055050
  error estimate for blocks of size 2^( 3) =       0.000441121316
  error estimate for blocks of size 2^( 4) =       0.000453562749
  error estimate for blocks of size 2^( 5) =       0.000464754928
  error estimate for blocks of size 2^( 6) =       0.000470635648
  error estimate for blocks of size 2^( 7) =       0.000474548779

      target function =                  N/A
              le_mean =     -16.905590804211
             les_mean =     286.144507416439
             stat err =       0.000465875526
             autocorr =       1.256356089252
              std dev =       0.587798562239
             le_variance =       0.345507149771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905590804209        initial
     2.3283e+04     2.3283e+05             1.0858e-08       -16.905590804242  <--
     9.3132e+04     9.3132e+05             2.7146e-09       -16.905590804225
     3.7253e+05     3.7253e+06             6.7864e-10       -16.905590804211

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 3.0353e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373982e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595705e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063251e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.269272
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3505e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335070071262
                                         uncertainty =       0.002957776119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335070071262
                                         uncertainty =       0.002957776119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409296225
  error estimate for blocks of size 2^( 2) =       0.000421690437
  error estimate for blocks of size 2^( 3) =       0.000435035707
  error estimate for blocks of size 2^( 4) =       0.000447142582
  error estimate for blocks of size 2^( 5) =       0.000458459300
  error estimate for blocks of size 2^( 6) =       0.000465898545
  error estimate for blocks of size 2^( 7) =       0.000472198463

      target function =                  N/A
              le_mean =     -16.905287539583
             les_mean =     286.123793427461
             stat err =       0.000460924723
             autocorr =       1.268190595962
              std dev =       0.578832271914
             le_variance =       0.335046799009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528753958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287539583       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905287539681       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905287539743       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905287539780       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905287539755       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905287539779       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905287539801       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905287539813       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.061830e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287539583       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905287539607       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905287539623       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905287539633       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905287539626       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905287539620       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905287539639       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905287539642       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.015460e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287539583       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905287539589       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905287539593       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905287539591       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905287539594       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905287539551       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905287539622       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905287539545       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.538652e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706162e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373982e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180991e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894798e-02 1 1  ON 33
eH1_4                 8.595703e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601777e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.7835
    reference variance = 0.374503
====================================================
  Execution time = 2.0053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3299e-01
  Total weights = 2.0000e+06
  Execution time = 1.8582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023923132
                                         uncertainty =       0.003928100057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023923132
                                         uncertainty =       0.003928100057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035642
  error estimate for blocks of size 2^( 2) =       0.000421003773
  error estimate for blocks of size 2^( 3) =       0.000434545481
  error estimate for blocks of size 2^( 4) =       0.000446948296
  error estimate for blocks of size 2^( 5) =       0.000456375034
  error estimate for blocks of size 2^( 6) =       0.000463504733
  error estimate for blocks of size 2^( 7) =       0.000469860634

      target function =                  N/A
              le_mean =     -16.905444177320
             les_mean =     286.127028835876
             stat err =       0.000459172174
             autocorr =       1.266353407899
              std dev =       0.577049538517
             le_variance =       0.332986169903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023936377
                                         uncertainty =       0.003928100307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023936377
                                         uncertainty =       0.003928100307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035650
  error estimate for blocks of size 2^( 2) =       0.000421003781
  error estimate for blocks of size 2^( 3) =       0.000434545488
  error estimate for blocks of size 2^( 4) =       0.000446948303
  error estimate for blocks of size 2^( 5) =       0.000456375040
  error estimate for blocks of size 2^( 6) =       0.000463504740
  error estimate for blocks of size 2^( 7) =       0.000469860642

      target function =                  N/A
              le_mean =     -16.905444177195
             les_mean =     286.127028844883
             stat err =       0.000459172181
             autocorr =       1.266353396285
              std dev =       0.577049549979
             le_variance =       0.332986183130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023929755
                                         uncertainty =       0.003928100182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023929755
                                         uncertainty =       0.003928100182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035646
  error estimate for blocks of size 2^( 2) =       0.000421003777
  error estimate for blocks of size 2^( 3) =       0.000434545484
  error estimate for blocks of size 2^( 4) =       0.000446948300
  error estimate for blocks of size 2^( 5) =       0.000456375037
  error estimate for blocks of size 2^( 6) =       0.000463504736
  error estimate for blocks of size 2^( 7) =       0.000469860638

      target function =                  N/A
              le_mean =     -16.905444177257
             les_mean =     286.127028840380
             stat err =       0.000459172178
             autocorr =       1.266353402094
              std dev =       0.577049544248
             le_variance =       0.332986176517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023923960
                                         uncertainty =       0.003928100073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333023923960
                                         uncertainty =       0.003928100073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035642
  error estimate for blocks of size 2^( 2) =       0.000421003774
  error estimate for blocks of size 2^( 3) =       0.000434545481
  error estimate for blocks of size 2^( 4) =       0.000446948297
  error estimate for blocks of size 2^( 5) =       0.000456375034
  error estimate for blocks of size 2^( 6) =       0.000463504733
  error estimate for blocks of size 2^( 7) =       0.000469860635

      target function =                  N/A
              le_mean =     -16.905444177312
             les_mean =     286.127028836439
             stat err =       0.000459172175
             autocorr =       1.266353407169
              std dev =       0.577049539233
             le_variance =       0.332986170730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905444177320        initial  <--
     5.8208e+03     5.8208e+04             4.0618e-08       -16.905444177195
     2.3283e+04     2.3283e+05             1.0155e-08       -16.905444177257
     9.3132e+04     9.3132e+05             2.5387e-09       -16.905444177312

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4079
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373982e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180990e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595705e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063251e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.43004
====================================================
  Execution time = 2.0331e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4035e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340439205311
                                         uncertainty =       0.004018027830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340439205311
                                         uncertainty =       0.004018027830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525704
  error estimate for blocks of size 2^( 2) =       0.000425055286
  error estimate for blocks of size 2^( 3) =       0.000437793849
  error estimate for blocks of size 2^( 4) =       0.000449777588
  error estimate for blocks of size 2^( 5) =       0.000460895958
  error estimate for blocks of size 2^( 6) =       0.000468185903
  error estimate for blocks of size 2^( 7) =       0.000473288082

      target function =                  N/A
              le_mean =     -16.906652073238
             les_mean =     286.175239067586
             stat err =       0.000463036883
             autocorr =       1.259879890758
              std dev =       0.583399444837
             le_variance =       0.340354912236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665207324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652073238       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652073248       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652073264       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652073284       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652073267       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652073241       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652073211       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652073302       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.308526e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652073238       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652073241       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652073245       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652073220       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652073208       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652073087       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652073315       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652073292       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.077132e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652073238       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652073239       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652073240       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652073058       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652073419       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652072841       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652073031       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652073618       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.692828e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5864e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373982e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180991e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595705e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063251e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.33778
====================================================
  Execution time = 2.0641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4085e-01
  Total weights = 2.0000e+06
  Execution time = 1.8524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913042172
                                         uncertainty =       0.006019450071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913042172
                                         uncertainty =       0.006019450071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412826217
  error estimate for blocks of size 2^( 2) =       0.000425590586
  error estimate for blocks of size 2^( 3) =       0.000438667726
  error estimate for blocks of size 2^( 4) =       0.000450943047
  error estimate for blocks of size 2^( 5) =       0.000461564852
  error estimate for blocks of size 2^( 6) =       0.000469349804
  error estimate for blocks of size 2^( 7) =       0.000474144281

      target function =                  N/A
              le_mean =     -16.905950656103
             les_mean =     286.152018387409
             stat err =       0.000464000496
             autocorr =       1.263287937190
              std dev =       0.583824435279
             le_variance =       0.340850971229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913040771
                                         uncertainty =       0.006019449992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913040771
                                         uncertainty =       0.006019449992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412826216
  error estimate for blocks of size 2^( 2) =       0.000425590585
  error estimate for blocks of size 2^( 3) =       0.000438667725
  error estimate for blocks of size 2^( 4) =       0.000450943046
  error estimate for blocks of size 2^( 5) =       0.000461564852
  error estimate for blocks of size 2^( 6) =       0.000469349803
  error estimate for blocks of size 2^( 7) =       0.000474144280

      target function =                  N/A
              le_mean =     -16.905950656113
             les_mean =     286.152018386328
             stat err =       0.000464000495
             autocorr =       1.263287938619
              std dev =       0.583824434079
             le_variance =       0.340850969828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913041472
                                         uncertainty =       0.006019450032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913041472
                                         uncertainty =       0.006019450032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412826217
  error estimate for blocks of size 2^( 2) =       0.000425590586
  error estimate for blocks of size 2^( 3) =       0.000438667725
  error estimate for blocks of size 2^( 4) =       0.000450943046
  error estimate for blocks of size 2^( 5) =       0.000461564852
  error estimate for blocks of size 2^( 6) =       0.000469349804
  error estimate for blocks of size 2^( 7) =       0.000474144280

      target function =                  N/A
              le_mean =     -16.905950656108
             les_mean =     286.152018386869
             stat err =       0.000464000496
             autocorr =       1.263287937902
              std dev =       0.583824434679
             le_variance =       0.340850970528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913042085
                                         uncertainty =       0.006019450066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913042085
                                         uncertainty =       0.006019450066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412826217
  error estimate for blocks of size 2^( 2) =       0.000425590586
  error estimate for blocks of size 2^( 3) =       0.000438667725
  error estimate for blocks of size 2^( 4) =       0.000450943047
  error estimate for blocks of size 2^( 5) =       0.000461564852
  error estimate for blocks of size 2^( 6) =       0.000469349804
  error estimate for blocks of size 2^( 7) =       0.000474144281

      target function =                  N/A
              le_mean =     -16.905950656104
             les_mean =     286.152018387342
             stat err =       0.000464000496
             autocorr =       1.263287937274
              std dev =       0.583824435204
             le_variance =       0.340850971142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905950656103        initial
     5.8208e+04     5.8208e+05             4.3085e-09       -16.905950656113  <--
     2.3283e+05     2.3283e+06             1.0771e-09       -16.905950656108
     9.3132e+05     9.3132e+06             2.6928e-10       -16.905950656104

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.9985e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055100e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180991e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595705e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063251e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715622e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.230245
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3446e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334522300720
                                         uncertainty =       0.003247979236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334522300720
                                         uncertainty =       0.003247979236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408939272
  error estimate for blocks of size 2^( 2) =       0.000422174819
  error estimate for blocks of size 2^( 3) =       0.000435167148
  error estimate for blocks of size 2^( 4) =       0.000447611831
  error estimate for blocks of size 2^( 5) =       0.000458835819
  error estimate for blocks of size 2^( 6) =       0.000466761954
  error estimate for blocks of size 2^( 7) =       0.000471332840

      target function =                  N/A
              le_mean =     -16.906305205804
             les_mean =     286.157618200565
             stat err =       0.000461135611
             autocorr =       1.271568276598
              std dev =       0.578327464324
             le_variance =       0.334462655992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630520580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305205804       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305205842       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305205865       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305205897       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305205888       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305205873       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305205871       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305205882       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.426888e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305205804       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305205814       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305205819       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305205827       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305205820       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305205798       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305205821       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305205821       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.567224e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305205804       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305205807       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305205808       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305205812       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305205809       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305205777       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305205855       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305205769       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 8.918061e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6178e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075373e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897759e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801409e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870195e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180991e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595705e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978910e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675466e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601777e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.209709
====================================================
  Execution time = 2.0226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5015e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225109596
                                         uncertainty =       0.007041335783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225109596
                                         uncertainty =       0.007041335783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418422350
  error estimate for blocks of size 2^( 2) =       0.000430881370
  error estimate for blocks of size 2^( 3) =       0.000443840230
  error estimate for blocks of size 2^( 4) =       0.000456553313
  error estimate for blocks of size 2^( 5) =       0.000467112378
  error estimate for blocks of size 2^( 6) =       0.000476137391
  error estimate for blocks of size 2^( 7) =       0.000483211928

      target function =                  N/A
              le_mean =     -16.906669313342
             les_mean =     286.185621621016
             stat err =       0.000470753753
             autocorr =       1.265778845788
              std dev =       0.591738561700
             le_variance =       0.350154525402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225098983
                                         uncertainty =       0.007041335490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225098983
                                         uncertainty =       0.007041335490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418422343
  error estimate for blocks of size 2^( 2) =       0.000430881364
  error estimate for blocks of size 2^( 3) =       0.000443840224
  error estimate for blocks of size 2^( 4) =       0.000456553307
  error estimate for blocks of size 2^( 5) =       0.000467112372
  error estimate for blocks of size 2^( 6) =       0.000476137385
  error estimate for blocks of size 2^( 7) =       0.000483211922

      target function =                  N/A
              le_mean =     -16.906669313361
             les_mean =     286.185621611069
             stat err =       0.000470753747
             autocorr =       1.265778853329
              std dev =       0.591738552736
             le_variance =       0.350154514794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225104290
                                         uncertainty =       0.007041335636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225104290
                                         uncertainty =       0.007041335636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418422346
  error estimate for blocks of size 2^( 2) =       0.000430881367
  error estimate for blocks of size 2^( 3) =       0.000443840227
  error estimate for blocks of size 2^( 4) =       0.000456553310
  error estimate for blocks of size 2^( 5) =       0.000467112375
  error estimate for blocks of size 2^( 6) =       0.000476137388
  error estimate for blocks of size 2^( 7) =       0.000483211925

      target function =                  N/A
              le_mean =     -16.906669313352
             les_mean =     286.185621616042
             stat err =       0.000470753750
             autocorr =       1.265778849556
              std dev =       0.591738557218
             le_variance =       0.350154520098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225108933
                                         uncertainty =       0.007041335764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350225108933
                                         uncertainty =       0.007041335764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418422349
  error estimate for blocks of size 2^( 2) =       0.000430881369
  error estimate for blocks of size 2^( 3) =       0.000443840229
  error estimate for blocks of size 2^( 4) =       0.000456553313
  error estimate for blocks of size 2^( 5) =       0.000467112378
  error estimate for blocks of size 2^( 6) =       0.000476137390
  error estimate for blocks of size 2^( 7) =       0.000483211928

      target function =                  N/A
              le_mean =     -16.906669313343
             les_mean =     286.185621620394
             stat err =       0.000470753752
             autocorr =       1.265778846253
              std dev =       0.591738561139
             le_variance =       0.350154524739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906669313342        initial
     1.4552e+04     1.4552e+05             1.4269e-08       -16.906669313361  <--
     5.8208e+04     5.8208e+05             3.5672e-09       -16.906669313352
     2.3283e+05     2.3283e+06             8.9181e-10       -16.906669313343

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.9650e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9812
    reference variance = 0.356508
====================================================
  Execution time = 2.0233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528490226
                                         uncertainty =       0.004511118915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528490226
                                         uncertainty =       0.004511118915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411998637
  error estimate for blocks of size 2^( 2) =       0.000424788373
  error estimate for blocks of size 2^( 3) =       0.000438137040
  error estimate for blocks of size 2^( 4) =       0.000450062088
  error estimate for blocks of size 2^( 5) =       0.000461658165
  error estimate for blocks of size 2^( 6) =       0.000468403530
  error estimate for blocks of size 2^( 7) =       0.000474579508

      target function =                  N/A
              le_mean =     -16.905707652524
             les_mean =     286.142436816490
             stat err =       0.000463675823
             autocorr =       1.266593760997
              std dev =       0.582654059987
             le_variance =       0.339485753619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570765252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707652524       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905707652476       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905707652358       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905707652127       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905707652371       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905707652332       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905707652338       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905707652370       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.342049e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707652524       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905707652512       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905707652483       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905707652425       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905707652488       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905707652482       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905707652486       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905707652474       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.585520e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707652524       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905707652521       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905707652514       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905707652499       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905707652463       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905707652491       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905707652463       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905707652518       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.963804e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5829e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975848e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271613e-02 1 1  ON 32
eH1_3                -3.894798e-02 1 1  ON 33
eH1_4                 8.595706e-03 1 1  ON 34
eH1_5                 4.250138e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063254e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113667e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173407e-02 1 1  ON 44
eH2_5                 4.675464e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710921e-01 1 1  ON 48
eH2_9                 3.601779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9636
    reference variance = 0.19022
====================================================
  Execution time = 2.2100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3466e-01
  Total weights = 2.0000e+06
  Execution time = 1.8785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599113596
                                         uncertainty =       0.003376515588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599113596
                                         uncertainty =       0.003376515588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409062334
  error estimate for blocks of size 2^( 2) =       0.000422049133
  error estimate for blocks of size 2^( 3) =       0.000434884815
  error estimate for blocks of size 2^( 4) =       0.000447702905
  error estimate for blocks of size 2^( 5) =       0.000458434165
  error estimate for blocks of size 2^( 6) =       0.000467760848
  error estimate for blocks of size 2^( 7) =       0.000472170445

      target function =                  N/A
              le_mean =     -16.906524238267
             les_mean =     286.165225638170
             stat err =       0.000461517091
             autocorr =       1.272906759023
              std dev =       0.578501500775
             le_variance =       0.334663986399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599139718
                                         uncertainty =       0.003376515973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599139718
                                         uncertainty =       0.003376515973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409062350
  error estimate for blocks of size 2^( 2) =       0.000422049148
  error estimate for blocks of size 2^( 3) =       0.000434884829
  error estimate for blocks of size 2^( 4) =       0.000447702920
  error estimate for blocks of size 2^( 5) =       0.000458434178
  error estimate for blocks of size 2^( 6) =       0.000467760861
  error estimate for blocks of size 2^( 7) =       0.000472170459

      target function =                  N/A
              le_mean =     -16.906524238172
             les_mean =     286.165225661102
             stat err =       0.000461517105
             autocorr =       1.272906735003
              std dev =       0.578501523360
             le_variance =       0.334664012530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599126658
                                         uncertainty =       0.003376515781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599126658
                                         uncertainty =       0.003376515781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409062342
  error estimate for blocks of size 2^( 2) =       0.000422049141
  error estimate for blocks of size 2^( 3) =       0.000434884822
  error estimate for blocks of size 2^( 4) =       0.000447702912
  error estimate for blocks of size 2^( 5) =       0.000458434172
  error estimate for blocks of size 2^( 6) =       0.000467760854
  error estimate for blocks of size 2^( 7) =       0.000472170452

      target function =                  N/A
              le_mean =     -16.906524238219
             les_mean =     286.165225649637
             stat err =       0.000461517098
             autocorr =       1.272906747005
              std dev =       0.578501512068
             le_variance =       0.334663999465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599115229
                                         uncertainty =       0.003376515612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334599115229
                                         uncertainty =       0.003376515612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409062335
  error estimate for blocks of size 2^( 2) =       0.000422049134
  error estimate for blocks of size 2^( 3) =       0.000434884816
  error estimate for blocks of size 2^( 4) =       0.000447702906
  error estimate for blocks of size 2^( 5) =       0.000458434166
  error estimate for blocks of size 2^( 6) =       0.000467760849
  error estimate for blocks of size 2^( 7) =       0.000472170446

      target function =                  N/A
              le_mean =     -16.906524238261
             les_mean =     286.165225639603
             stat err =       0.000461517092
             autocorr =       1.272906757522
              std dev =       0.578501502187
             le_variance =       0.334663988032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906524238267        initial  <--
     3.6380e+03     3.6380e+04             6.3420e-08       -16.906524238172
     1.4552e+04     1.4552e+05             1.5855e-08       -16.906524238219
     5.8208e+04     5.8208e+05             3.9638e-09       -16.906524238261

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5793
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.263284
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5450e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354580266840
                                         uncertainty =       0.014112530898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354580266840
                                         uncertainty =       0.014112530898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421011437
  error estimate for blocks of size 2^( 2) =       0.000433369754
  error estimate for blocks of size 2^( 3) =       0.000446727471
  error estimate for blocks of size 2^( 4) =       0.000459150123
  error estimate for blocks of size 2^( 5) =       0.000469515561
  error estimate for blocks of size 2^( 6) =       0.000477663096
  error estimate for blocks of size 2^( 7) =       0.000480456788

      target function =                  N/A
              le_mean =     -16.905482291997
             les_mean =     286.149832608068
             stat err =       0.000471696392
             autocorr =       1.255270495433
              std dev =       0.595400084229
             le_variance =       0.354501260300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548229200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905482291997       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905482291992       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905482291990       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905482292005       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905482292024       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905482292010       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905482292033       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 7.282222e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905482291997       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905482291996       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905482291995       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905482292047       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905482292029       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905482292017       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905482291940       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.820557e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905482291997       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905482291997       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905482291996       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905482292067       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905482292096       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905482291727       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905482291950       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.551391e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5988e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9733
    reference variance = 0.211367
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3640e-01
  Total weights = 2.0000e+06
  Execution time = 1.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444239464
                                         uncertainty =       0.003261329951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444239464
                                         uncertainty =       0.003261329951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410121902
  error estimate for blocks of size 2^( 2) =       0.000423526285
  error estimate for blocks of size 2^( 3) =       0.000436906294
  error estimate for blocks of size 2^( 4) =       0.000449843312
  error estimate for blocks of size 2^( 5) =       0.000461305543
  error estimate for blocks of size 2^( 6) =       0.000469311717
  error estimate for blocks of size 2^( 7) =       0.000473511765

      target function =                  N/A
              le_mean =     -16.906239978215
             les_mean =     286.157349982433
             stat err =       0.000463493084
             autocorr =       1.277204942227
              std dev =       0.579999956579
             le_variance =       0.336399949632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444245327
                                         uncertainty =       0.003261330016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444245327
                                         uncertainty =       0.003261330016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410121906
  error estimate for blocks of size 2^( 2) =       0.000423526288
  error estimate for blocks of size 2^( 3) =       0.000436906297
  error estimate for blocks of size 2^( 4) =       0.000449843315
  error estimate for blocks of size 2^( 5) =       0.000461305546
  error estimate for blocks of size 2^( 6) =       0.000469311720
  error estimate for blocks of size 2^( 7) =       0.000473511768

      target function =                  N/A
              le_mean =     -16.906239978215
             les_mean =     286.157349988281
             stat err =       0.000463493087
             autocorr =       1.277204936501
              std dev =       0.579999961635
             le_variance =       0.336399955496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444242396
                                         uncertainty =       0.003261329983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444242396
                                         uncertainty =       0.003261329983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410121904
  error estimate for blocks of size 2^( 2) =       0.000423526286
  error estimate for blocks of size 2^( 3) =       0.000436906295
  error estimate for blocks of size 2^( 4) =       0.000449843313
  error estimate for blocks of size 2^( 5) =       0.000461305544
  error estimate for blocks of size 2^( 6) =       0.000469311719
  error estimate for blocks of size 2^( 7) =       0.000473511766

      target function =                  N/A
              le_mean =     -16.906239978215
             les_mean =     286.157349985357
             stat err =       0.000463493086
             autocorr =       1.277204939366
              std dev =       0.579999959107
             le_variance =       0.336399952564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444239831
                                         uncertainty =       0.003261329955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444239831
                                         uncertainty =       0.003261329955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410121903
  error estimate for blocks of size 2^( 2) =       0.000423526285
  error estimate for blocks of size 2^( 3) =       0.000436906294
  error estimate for blocks of size 2^( 4) =       0.000449843312
  error estimate for blocks of size 2^( 5) =       0.000461305543
  error estimate for blocks of size 2^( 6) =       0.000469311718
  error estimate for blocks of size 2^( 7) =       0.000473511765

      target function =                  N/A
              le_mean =     -16.906239978215
             les_mean =     286.157349982798
             stat err =       0.000463493084
             autocorr =       1.277204941874
              std dev =       0.579999956895
             le_variance =       0.336399949998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906239978215        initial  <--
     3.6380e+04     3.6380e+05             7.2822e-09       -16.906239978215
     1.4552e+05     1.4552e+06             1.8206e-09       -16.906239978215
     5.8208e+05     5.8208e+06             4.5514e-10       -16.906239978215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5242
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.209228
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4336e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363365167
                                         uncertainty =       0.004140706690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363365167
                                         uncertainty =       0.004140706690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414340211
  error estimate for blocks of size 2^( 2) =       0.000426426830
  error estimate for blocks of size 2^( 3) =       0.000439526839
  error estimate for blocks of size 2^( 4) =       0.000451075775
  error estimate for blocks of size 2^( 5) =       0.000460921266
  error estimate for blocks of size 2^( 6) =       0.000468652756
  error estimate for blocks of size 2^( 7) =       0.000472007315

      target function =                  N/A
              le_mean =     -16.906751601574
             les_mean =     286.181605166411
             stat err =       0.000463164278
             autocorr =       1.249556643036
              std dev =       0.585965545703
             le_variance =       0.343355620751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675160157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906751601574       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906751601577       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906751601579       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906751601580       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906751601580       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906751601957       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906751601715       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906751601691       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.198333e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906751601574       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906751601575       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906751601576       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906751601595       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906751601588       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906751600815       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906751603111       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906751601711       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.799583e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906751601574       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906751601575       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906751601575       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906751601394       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906751605543       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906751603590       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906751599754       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906751604843       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.498976e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894685e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.188256
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358341
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358341
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066934
  error estimate for blocks of size 2^( 2) =       0.000421421574
  error estimate for blocks of size 2^( 3) =       0.000434182043
  error estimate for blocks of size 2^( 4) =       0.000446203059
  error estimate for blocks of size 2^( 5) =       0.000455392340
  error estimate for blocks of size 2^( 6) =       0.000461636160
  error estimate for blocks of size 2^( 7) =       0.000464324927

      target function =                  N/A
              le_mean =     -16.907188689996
             les_mean =     286.187700745483
             stat err =       0.000456889121
             autocorr =       1.247477962987
              std dev =       0.578508006602
             le_variance =       0.334671513703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358335
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358335
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066934
  error estimate for blocks of size 2^( 2) =       0.000421421574
  error estimate for blocks of size 2^( 3) =       0.000434182043
  error estimate for blocks of size 2^( 4) =       0.000446203059
  error estimate for blocks of size 2^( 5) =       0.000455392339
  error estimate for blocks of size 2^( 6) =       0.000461636160
  error estimate for blocks of size 2^( 7) =       0.000464324927

      target function =                  N/A
              le_mean =     -16.907188689997
             les_mean =     286.187700745508
             stat err =       0.000456889121
             autocorr =       1.247477962821
              std dev =       0.578508006597
             le_variance =       0.334671513696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358338
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358338
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066934
  error estimate for blocks of size 2^( 2) =       0.000421421574
  error estimate for blocks of size 2^( 3) =       0.000434182043
  error estimate for blocks of size 2^( 4) =       0.000446203059
  error estimate for blocks of size 2^( 5) =       0.000455392340
  error estimate for blocks of size 2^( 6) =       0.000461636160
  error estimate for blocks of size 2^( 7) =       0.000464324927

      target function =                  N/A
              le_mean =     -16.907188689996
             les_mean =     286.187700745495
             stat err =       0.000456889121
             autocorr =       1.247477962902
              std dev =       0.578508006599
             le_variance =       0.334671513700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358341
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334659358341
                                         uncertainty =       0.003500031346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066934
  error estimate for blocks of size 2^( 2) =       0.000421421574
  error estimate for blocks of size 2^( 3) =       0.000434182043
  error estimate for blocks of size 2^( 4) =       0.000446203059
  error estimate for blocks of size 2^( 5) =       0.000455392340
  error estimate for blocks of size 2^( 6) =       0.000461636160
  error estimate for blocks of size 2^( 7) =       0.000464324927

      target function =                  N/A
              le_mean =     -16.907188689996
             les_mean =     286.187700745484
             stat err =       0.000456889121
             autocorr =       1.247477962984
              std dev =       0.578508006602
             le_variance =       0.334671513703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907188689996        initial
     3.6380e+05     3.6380e+06             7.1983e-10       -16.907188689997  <--
     1.4552e+06     1.4552e+07             1.7996e-10       -16.907188689996
     5.8208e+06     5.8208e+07             4.4990e-11       -16.907188689996

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 2.9553e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063252e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9711
    reference variance = 0.665328
====================================================
  Execution time = 2.0748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340234927171
                                         uncertainty =       0.004145171495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340234927171
                                         uncertainty =       0.004145171495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412441683
  error estimate for blocks of size 2^( 2) =       0.000425272362
  error estimate for blocks of size 2^( 3) =       0.000438173280
  error estimate for blocks of size 2^( 4) =       0.000450992393
  error estimate for blocks of size 2^( 5) =       0.000462239083
  error estimate for blocks of size 2^( 6) =       0.000468398554
  error estimate for blocks of size 2^( 7) =       0.000472512379

      target function =                  N/A
              le_mean =     -16.904744705505
             les_mean =     286.110609672080
             stat err =       0.000463535602
             autocorr =       1.263109761336
              std dev =       0.583280621896
             le_variance =       0.340216283880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690474470551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744705505       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904744705494       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904744705495       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904744705495       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904744705505       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904744705574       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904744705504       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904744705571       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.122188e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744705505       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904744705503       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904744705503       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904744705503       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904744705454       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904744705268       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904744705289       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904744705746       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.805500e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744705505       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904744705505       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904744705505       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904744705505       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904744705627       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904744706647       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904744705107       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904744706618       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.951371e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6255e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.23736
====================================================
  Execution time = 2.0819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3878e-01
  Total weights = 2.0000e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864232906
                                         uncertainty =       0.005544339551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864232906
                                         uncertainty =       0.005544339551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411572116
  error estimate for blocks of size 2^( 2) =       0.000424351615
  error estimate for blocks of size 2^( 3) =       0.000437482510
  error estimate for blocks of size 2^( 4) =       0.000449516216
  error estimate for blocks of size 2^( 5) =       0.000459301157
  error estimate for blocks of size 2^( 6) =       0.000464835899
  error estimate for blocks of size 2^( 7) =       0.000469599960

      target function =                  N/A
              le_mean =     -16.905087333688
             les_mean =     286.120760803037
             stat err =       0.000460813308
             autocorr =       1.253597562118
              std dev =       0.582050867903
             le_variance =       0.338783212826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864234287
                                         uncertainty =       0.005544339572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864234287
                                         uncertainty =       0.005544339572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411572117
  error estimate for blocks of size 2^( 2) =       0.000424351616
  error estimate for blocks of size 2^( 3) =       0.000437482511
  error estimate for blocks of size 2^( 4) =       0.000449516217
  error estimate for blocks of size 2^( 5) =       0.000459301157
  error estimate for blocks of size 2^( 6) =       0.000464835900
  error estimate for blocks of size 2^( 7) =       0.000469599961

      target function =                  N/A
              le_mean =     -16.905087333695
             les_mean =     286.120760804659
             stat err =       0.000460813309
             autocorr =       1.253597559905
              std dev =       0.582050869088
             le_variance =       0.338783214206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864233597
                                         uncertainty =       0.005544339561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864233597
                                         uncertainty =       0.005544339561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411572116
  error estimate for blocks of size 2^( 2) =       0.000424351615
  error estimate for blocks of size 2^( 3) =       0.000437482511
  error estimate for blocks of size 2^( 4) =       0.000449516216
  error estimate for blocks of size 2^( 5) =       0.000459301157
  error estimate for blocks of size 2^( 6) =       0.000464835900
  error estimate for blocks of size 2^( 7) =       0.000469599960

      target function =                  N/A
              le_mean =     -16.905087333691
             les_mean =     286.120760803848
             stat err =       0.000460813308
             autocorr =       1.253597561011
              std dev =       0.582050868495
             le_variance =       0.338783213516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864232992
                                         uncertainty =       0.005544339552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864232992
                                         uncertainty =       0.005544339552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411572116
  error estimate for blocks of size 2^( 2) =       0.000424351615
  error estimate for blocks of size 2^( 3) =       0.000437482510
  error estimate for blocks of size 2^( 4) =       0.000449516216
  error estimate for blocks of size 2^( 5) =       0.000459301157
  error estimate for blocks of size 2^( 6) =       0.000464835899
  error estimate for blocks of size 2^( 7) =       0.000469599960

      target function =                  N/A
              le_mean =     -16.905087333688
             les_mean =     286.120760803138
             stat err =       0.000460813308
             autocorr =       1.253597561979
              std dev =       0.582050867977
             le_variance =       0.338783212913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905087333688        initial
     9.0949e+04     9.0949e+05             3.1222e-09       -16.905087333695  <--
     3.6380e+05     3.6380e+06             7.8055e-10       -16.905087333691
     1.4552e+06     1.4552e+07             1.9514e-10       -16.905087333688

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 3.0290e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.411631
====================================================
  Execution time = 2.1512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337668532512
                                         uncertainty =       0.004184950096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337668532512
                                         uncertainty =       0.004184950096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886477
  error estimate for blocks of size 2^( 2) =       0.000423716680
  error estimate for blocks of size 2^( 3) =       0.000437380697
  error estimate for blocks of size 2^( 4) =       0.000449609923
  error estimate for blocks of size 2^( 5) =       0.000460901658
  error estimate for blocks of size 2^( 6) =       0.000470569233
  error estimate for blocks of size 2^( 7) =       0.000477499080

      target function =                  N/A
              le_mean =     -16.905918321768
             les_mean =     286.147729527547
             stat err =       0.000464644974
             autocorr =       1.278788701531
              std dev =       0.581081228478
             le_variance =       0.337655394089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591832177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918321768       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918321769       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918321762       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918321743       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918321764       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918321794       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918321789       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918321782       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 8.875159e-09

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918321768       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918321768       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918321766       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918321774       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918321707       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918321770       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918321796       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918321734       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.218791e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918321768       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918321768       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918321768       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918321766       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918321797       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918321618       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918321508       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918321385       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.546975e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7032e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121124e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897761e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055098e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9808
    reference variance = 0.372996
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2922e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275057240
                                         uncertainty =       0.002542561035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275057240
                                         uncertainty =       0.002542561035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405724375
  error estimate for blocks of size 2^( 2) =       0.000418389271
  error estimate for blocks of size 2^( 3) =       0.000431237756
  error estimate for blocks of size 2^( 4) =       0.000444188282
  error estimate for blocks of size 2^( 5) =       0.000454804770
  error estimate for blocks of size 2^( 6) =       0.000460956347
  error estimate for blocks of size 2^( 7) =       0.000466775065

      target function =                  N/A
              le_mean =     -16.905922821190
             les_mean =     286.139450808616
             stat err =       0.000456681116
             autocorr =       1.266962928150
              std dev =       0.573780913925
             le_variance =       0.329224537185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275063044
                                         uncertainty =       0.002542561077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275063044
                                         uncertainty =       0.002542561077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405724379
  error estimate for blocks of size 2^( 2) =       0.000418389274
  error estimate for blocks of size 2^( 3) =       0.000431237759
  error estimate for blocks of size 2^( 4) =       0.000444188285
  error estimate for blocks of size 2^( 5) =       0.000454804773
  error estimate for blocks of size 2^( 6) =       0.000460956350
  error estimate for blocks of size 2^( 7) =       0.000466775068

      target function =                  N/A
              le_mean =     -16.905922821157
             les_mean =     286.139450813280
             stat err =       0.000456681119
             autocorr =       1.266962921513
              std dev =       0.573780918982
             le_variance =       0.329224542988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275060142
                                         uncertainty =       0.002542561056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275060142
                                         uncertainty =       0.002542561056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405724377
  error estimate for blocks of size 2^( 2) =       0.000418389273
  error estimate for blocks of size 2^( 3) =       0.000431237758
  error estimate for blocks of size 2^( 4) =       0.000444188284
  error estimate for blocks of size 2^( 5) =       0.000454804771
  error estimate for blocks of size 2^( 6) =       0.000460956349
  error estimate for blocks of size 2^( 7) =       0.000466775066

      target function =                  N/A
              le_mean =     -16.905922821173
             les_mean =     286.139450810948
             stat err =       0.000456681118
             autocorr =       1.266962924838
              std dev =       0.573780916454
             le_variance =       0.329224540087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275057603
                                         uncertainty =       0.002542561037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329275057603
                                         uncertainty =       0.002542561037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405724375
  error estimate for blocks of size 2^( 2) =       0.000418389271
  error estimate for blocks of size 2^( 3) =       0.000431237756
  error estimate for blocks of size 2^( 4) =       0.000444188283
  error estimate for blocks of size 2^( 5) =       0.000454804770
  error estimate for blocks of size 2^( 6) =       0.000460956348
  error estimate for blocks of size 2^( 7) =       0.000466775065

      target function =                  N/A
              le_mean =     -16.905922821188
             les_mean =     286.139450808908
             stat err =       0.000456681116
             autocorr =       1.266962927744
              std dev =       0.573780914242
             le_variance =       0.329224537548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905922821190        initial  <--
     2.2737e+04     2.2737e+05             8.8752e-09       -16.905922821157
     9.0949e+04     9.0949e+05             2.2188e-09       -16.905922821173
     3.6380e+05     3.6380e+06             5.5470e-10       -16.905922821188

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0563
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7376e+01 secs
  Total Execution time = 2.3245e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
