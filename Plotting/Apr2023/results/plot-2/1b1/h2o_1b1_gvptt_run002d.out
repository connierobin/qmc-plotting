--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0257.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 90732 MB
Rank =    1  Free Memory = 90729 MB
Rank =    2  Free Memory = 90729 MB
Rank =    3  Free Memory = 90729 MB
Rank =    4  Free Memory = 90728 MB
Rank =    5  Free Memory = 90728 MB
Rank =    6  Free Memory = 90728 MB
Rank =    7  Free Memory = 90728 MB
Rank =    8  Free Memory = 90728 MB
Rank =    9  Free Memory = 90728 MB
Rank =   10  Free Memory = 90728 MB
Rank =   11  Free Memory = 90728 MB
Rank =   12  Free Memory = 90728 MB
Rank =   13  Free Memory = 90728 MB
Rank =   14  Free Memory = 90726 MB
Rank =   15  Free Memory = 90725 MB
Rank =   16  Free Memory = 90725 MB
Rank =   17  Free Memory = 90725 MB
Rank =   18  Free Memory = 90725 MB
Rank =   19  Free Memory = 90725 MB
Rank =   20  Free Memory = 90725 MB
Rank =   21  Free Memory = 90724 MB
Rank =   22  Free Memory = 90724 MB
Rank =   23  Free Memory = 90724 MB
Rank =   24  Free Memory = 90723 MB
Rank =   25  Free Memory = 90715 MB
Rank =   26  Free Memory = 90715 MB
Rank =   27  Free Memory = 90715 MB
Rank =   28  Free Memory = 90715 MB
Rank =   29  Free Memory = 90715 MB
Rank =   30  Free Memory = 90715 MB
Rank =   31  Free Memory = 90715 MB
Rank =   32  Free Memory = 90715 MB
Rank =   33  Free Memory = 90715 MB
Rank =   34  Free Memory = 90715 MB
Rank =   35  Free Memory = 90715 MB
Rank =   36  Free Memory = 90715 MB
Rank =   37  Free Memory = 90715 MB
Rank =   38  Free Memory = 90715 MB
Rank =   39  Free Memory = 90715 MB
Rank =   40  Free Memory = 90670 MB
Rank =   41  Free Memory = 90670 MB
Rank =   42  Free Memory = 90670 MB
Rank =   43  Free Memory = 90670 MB
Rank =   44  Free Memory = 90670 MB
Rank =   45  Free Memory = 90670 MB
Rank =   46  Free Memory = 90670 MB
Rank =   47  Free Memory = 90670 MB
Rank =   48  Free Memory = 90670 MB
Rank =   49  Free Memory = 90670 MB
Rank =   50  Free Memory = 90670 MB
Rank =   51  Free Memory = 90670 MB
Rank =   52  Free Memory = 90670 MB
Rank =   53  Free Memory = 90670 MB
Rank =   54  Free Memory = 90670 MB
Rank =   55  Free Memory = 90670 MB
Rank =   56  Free Memory = 90670 MB
Rank =   57  Free Memory = 90670 MB
Rank =   58  Free Memory = 90670 MB
Rank =   59  Free Memory = 90670 MB
Rank =   60  Free Memory = 90670 MB
Rank =   61  Free Memory = 90670 MB
Rank =   62  Free Memory = 90670 MB
Rank =   63  Free Memory = 90670 MB
Rank =   64  Free Memory = 90670 MB
Rank =   65  Free Memory = 90670 MB
Rank =   66  Free Memory = 90670 MB
Rank =   67  Free Memory = 90670 MB
Rank =   68  Free Memory = 90670 MB
Rank =   69  Free Memory = 90670 MB
Rank =   70  Free Memory = 90670 MB
Rank =   71  Free Memory = 90670 MB
Rank =   72  Free Memory = 90670 MB
Rank =   73  Free Memory = 90670 MB
Rank =   74  Free Memory = 90670 MB
Rank =   75  Free Memory = 90670 MB
Rank =   76  Free Memory = 90670 MB
Rank =   77  Free Memory = 90670 MB
Rank =   78  Free Memory = 90669 MB
Rank =   79  Free Memory = 90669 MB
Rank =   80  Free Memory = 90902 MB
Rank =   81  Free Memory = 90902 MB
Rank =   82  Free Memory = 90902 MB
Rank =   83  Free Memory = 90902 MB
Rank =   84  Free Memory = 90902 MB
Rank =   85  Free Memory = 90902 MB
Rank =   86  Free Memory = 90902 MB
Rank =   87  Free Memory = 90902 MB
Rank =   88  Free Memory = 90902 MB
Rank =   89  Free Memory = 90902 MB
Rank =   90  Free Memory = 90902 MB
Rank =   91  Free Memory = 90902 MB
Rank =   92  Free Memory = 90902 MB
Rank =   93  Free Memory = 90902 MB
Rank =   94  Free Memory = 90902 MB
Rank =   95  Free Memory = 90902 MB
Rank =   96  Free Memory = 90902 MB
Rank =   97  Free Memory = 90902 MB
Rank =   98  Free Memory = 90902 MB
Rank =   99  Free Memory = 90901 MB
Rank =  100  Free Memory = 90901 MB
Rank =  101  Free Memory = 90901 MB
Rank =  102  Free Memory = 90901 MB
Rank =  103  Free Memory = 90901 MB
Rank =  104  Free Memory = 90901 MB
Rank =  105  Free Memory = 90901 MB
Rank =  106  Free Memory = 90901 MB
Rank =  107  Free Memory = 90901 MB
Rank =  108  Free Memory = 90901 MB
Rank =  109  Free Memory = 90900 MB
Rank =  110  Free Memory = 90900 MB
Rank =  111  Free Memory = 90900 MB
Rank =  112  Free Memory = 90900 MB
Rank =  113  Free Memory = 90900 MB
Rank =  114  Free Memory = 90899 MB
Rank =  115  Free Memory = 90899 MB
Rank =  116  Free Memory = 90899 MB
Rank =  117  Free Memory = 90899 MB
Rank =  118  Free Memory = 90899 MB
Rank =  119  Free Memory = 90899 MB
Rank =  120  Free Memory = 85904 MB
Rank =  121  Free Memory = 85904 MB
Rank =  122  Free Memory = 85904 MB
Rank =  123  Free Memory = 85904 MB
Rank =  124  Free Memory = 85904 MB
Rank =  125  Free Memory = 85904 MB
Rank =  126  Free Memory = 85904 MB
Rank =  127  Free Memory = 85904 MB
  Input file(s): opt_h2o_1b1_gvptt_run002d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002d.xml

  Project = H2O
  date    = 2023-03-13 14:07:09 PDT
  host    = n0253.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 125

  Range of prime numbers to use as seeds over processors and threads = 709-1613


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.062627e-01    1         1  ON     0
     uu_1                 1.405132e-01    1         1  ON     1
     uu_2                 3.991511e-02    1         1  ON     2
     uu_3                -2.084707e-02    1         1  ON     3
     uu_4                -6.391752e-02    1         1  ON     4
     uu_5                -9.627630e-02    1         1  ON     5
     uu_6                -1.215851e-01    1         1  ON     6
     uu_7                -1.326938e-01    1         1  ON     7
     uu_8                -1.246534e-01    1         1  ON     8
     uu_9                -9.532831e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.379685e-01    1         1  ON     0
     ud_1                 1.743686e-01    1         1  ON     1
     ud_2                 5.854069e-02    1         1  ON     2
     ud_3                -9.296908e-03    1         1  ON     3
     ud_4                -6.529973e-02    1         1  ON     4
     ud_5                -1.054789e-01    1         1  ON     5
     ud_6                -1.315624e-01    1         1  ON     6
     ud_7                -1.469618e-01    1         1  ON     7
     ud_8                -1.479724e-01    1         1  ON     8
     ud_9                -1.380541e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.452780e-01    1         1  ON     0
     eO_1                -4.298249e-01    1         1  ON     1
     eO_2                -1.650634e-02    1         1  ON     2
     eO_3                 2.951529e-01    1         1  ON     3
     eO_4                 5.104734e-01    1         1  ON     4
     eO_5                 4.658844e-01    1         1  ON     5
     eO_6                 2.375932e-01    1         1  ON     6
     eO_7                -5.432288e-02    1         1  ON     7
     eO_8                -2.026970e-01    1         1  ON     8
     eO_9                -6.272824e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.276264e-01    1         1  ON     0
     eH1_1                -1.319963e-01    1         1  ON     1
     eH1_2                -8.791265e-02    1         1  ON     2
     eH1_3                -3.555523e-02    1         1  ON     3
     eH1_4                 1.145340e-02    1         1  ON     4
     eH1_5                 4.535961e-02    1         1  ON     5
     eH1_6                 9.883257e-02    1         1  ON     6
     eH1_7                 1.425730e-01    1         1  ON     7
     eH1_8                 1.514952e-01    1         1  ON     8
     eH1_9                 3.825677e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.254839e-01    1         1  ON     0
     eH2_1                -1.299196e-01    1         1  ON     1
     eH2_2                -8.562770e-02    1         1  ON     2
     eH2_3                -3.313741e-02    1         1  ON     3
     eH2_4                 1.395716e-02    1         1  ON     4
     eH2_5                 4.869255e-02    1         1  ON     5
     eH2_6                 1.013858e-01    1         1  ON     6
     eH2_7                 1.481299e-01    1         1  ON     7
     eH2_8                 1.594861e-01    1         1  ON     8
     eH2_9                 2.090526e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.229486e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.3648e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0253.savio3:127752] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0253.savio3:127752] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.200217
====================================================
  Execution time = 2.0680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335713423524
                                         uncertainty =       0.004382801298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335713423524
                                         uncertainty =       0.004382801298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409720661
  error estimate for blocks of size 2^( 2) =       0.000422798273
  error estimate for blocks of size 2^( 3) =       0.000436101629
  error estimate for blocks of size 2^( 4) =       0.000448517181
  error estimate for blocks of size 2^( 5) =       0.000458887802
  error estimate for blocks of size 2^( 6) =       0.000466764969
  error estimate for blocks of size 2^( 7) =       0.000471392176

      target function =                  N/A
              le_mean =     -16.905506616327
             les_mean =     286.131895827072
             stat err =       0.000461390532
             autocorr =       1.268123723697
              std dev =       0.579432515718
             le_variance =       0.335742040271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690550661633e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506616327       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905514204120       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905514193878       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905517019663       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905523161509       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905527474423       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905527131720       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905527837240       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905527896659       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905527998604       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905527814584       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905527975105       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.900268e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506616327       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905509683004       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905509797034       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905510371691       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905513196264       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905513857698       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905513980290       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905513769852       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905513961510       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905513942973       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 9.174445e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506616327       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905507522726       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905507583459       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905507714995       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905508495288       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905508640419       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905508696698       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905508656918       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905508681684       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.491804e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6324e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.061246e-01                 1 1 ON  0
uu_1  1.404543e-01                 1 1 ON  1
uu_2  4.000320e-02                 1 1 ON  2
uu_3  -2.081890e-02                1 1 ON  3
uu_4  -6.383150e-02                1 1 ON  4
uu_5  -9.625035e-02                1 1 ON  5
uu_6  -1.215631e-01                1 1 ON  6
uu_7  -1.329232e-01                1 1 ON  7
uu_8  -1.247391e-01                1 1 ON  8
uu_9  -9.533154e-02                1 1 ON  9
ud_0  4.386601e-01                 1 1 ON  10
ud_1  1.749015e-01                 1 1 ON  11
ud_2  5.824018e-02                 1 1 ON  12
ud_3  -9.820907e-03                1 1 ON  13
ud_4  -6.542546e-02                1 1 ON  14
ud_5  -1.057051e-01                1 1 ON  15
ud_6  -1.316814e-01                1 1 ON  16
ud_7  -1.470573e-01                1 1 ON  17
ud_8  -1.479543e-01                1 1 ON  18
ud_9  -1.379373e-01                1 1 ON  19
eO_0  -7.461955e-01                1 1 ON  20
eO_1  -4.301979e-01                1 1 ON  21
eO_2  -1.614787e-02                1 1 ON  22
eO_3  2.957573e-01                 1 1 ON  23
eO_4  5.108029e-01                 1 1 ON  24
eO_5  4.659869e-01                 1 1 ON  25
eO_6  2.377510e-01                 1 1 ON  26
eO_7  -5.431532e-02                1 1 ON  27
eO_8  -2.028223e-01                1 1 ON  28
eO_9  -6.284933e-02                1 1 ON  29
eH1_0 -2.280148e-01                1 1 ON  30
eH1_1 -1.320356e-01                1 1 ON  31
eH1_2 -8.804936e-02                1 1 ON  32
eH1_3 -3.556033e-02                1 1 ON  33
eH1_4 1.144261e-02                 1 1 ON  34
eH1_5 4.531591e-02                 1 1 ON  35
eH1_6 9.882568e-02                 1 1 ON  36
eH1_7 1.427107e-01                 1 1 ON  37
eH1_8 1.517716e-01                 1 1 ON  38
eH1_9 3.846061e-02                 1 1 ON  39
eH2_0 -2.259245e-01                1 1 ON  40
eH2_1 -1.299798e-01                1 1 ON  41
eH2_2 -8.569378e-02                1 1 ON  42
eH2_3 -3.306051e-02                1 1 ON  43
eH2_4 1.398206e-02                 1 1 ON  44
eH2_5 4.868717e-02                 1 1 ON  45
eH2_6 1.014476e-01                 1 1 ON  46
eH2_7 1.481864e-01                 1 1 ON  47
eH2_8 1.596638e-01                 1 1 ON  48
eH2_9 2.110540e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.287677
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.0000e+06
  Execution time = 2.2574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965018572
                                         uncertainty =       0.004210581246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965018572
                                         uncertainty =       0.004210581246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411666867
  error estimate for blocks of size 2^( 2) =       0.000424739121
  error estimate for blocks of size 2^( 3) =       0.000438791957
  error estimate for blocks of size 2^( 4) =       0.000452225085
  error estimate for blocks of size 2^( 5) =       0.000464691433
  error estimate for blocks of size 2^( 6) =       0.000473400714
  error estimate for blocks of size 2^( 7) =       0.000482943303

      target function =                  N/A
              le_mean =     -16.904640483707
             les_mean =     286.105808933320
             stat err =       0.000468315134
             autocorr =       1.294149818196
              std dev =       0.582184867041
             le_variance =       0.338939219411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340498571557
                                         uncertainty =       0.004232013484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340498571557
                                         uncertainty =       0.004232013484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412597138
  error estimate for blocks of size 2^( 2) =       0.000425600542
  error estimate for blocks of size 2^( 3) =       0.000439572184
  error estimate for blocks of size 2^( 4) =       0.000452934142
  error estimate for blocks of size 2^( 5) =       0.000465354255
  error estimate for blocks of size 2^( 6) =       0.000474065747
  error estimate for blocks of size 2^( 7) =       0.000483613883

      target function =                  N/A
              le_mean =     -16.904650776777
             les_mean =     286.107690510961
             stat err =       0.000468992007
             autocorr =       1.292047438718
              std dev =       0.583500468230
             le_variance =       0.340472796425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340011029473
                                         uncertainty =       0.004225023994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340011029473
                                         uncertainty =       0.004225023994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412301617
  error estimate for blocks of size 2^( 2) =       0.000425320842
  error estimate for blocks of size 2^( 3) =       0.000439311235
  error estimate for blocks of size 2^( 4) =       0.000452692354
  error estimate for blocks of size 2^( 5) =       0.000465122970
  error estimate for blocks of size 2^( 6) =       0.000473840348
  error estimate for blocks of size 2^( 7) =       0.000483390216

      target function =                  N/A
              le_mean =     -16.904646855022
             les_mean =     286.107070369299
             stat err =       0.000468761472
             autocorr =       1.292628546648
              std dev =       0.583082538151
             le_variance =       0.339985246297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339105796032
                                         uncertainty =       0.004212566993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339105796032
                                         uncertainty =       0.004212566993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752353
  error estimate for blocks of size 2^( 2) =       0.000424816309
  error estimate for blocks of size 2^( 3) =       0.000438859573
  error estimate for blocks of size 2^( 4) =       0.000452284997
  error estimate for blocks of size 2^( 5) =       0.000464745910
  error estimate for blocks of size 2^( 6) =       0.000473456845
  error estimate for blocks of size 2^( 7) =       0.000483000743

      target function =                  N/A
              le_mean =     -16.904640353310
             les_mean =     286.105945306271
             stat err =       0.000468372124
             autocorr =       1.293927366067
              std dev =       0.582305762498
             le_variance =       0.339080001038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904640483707        initial
     2.5000e-01     2.5000e+00             2.9003e-03       -16.904650776777  <--
     1.0000e+00     1.0000e+01             9.1744e-04       -16.904646855022
     4.0000e+00     4.0000e+01             2.4918e-04       -16.904640353310

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.1872e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.060552e-01 1 1  ON 0
 uu_1                 1.404754e-01 1 1  ON 1
 uu_2                 4.009839e-02 1 1  ON 2
 uu_3                -2.079163e-02 1 1  ON 3
 uu_4                -6.378819e-02 1 1  ON 4
 uu_5                -9.623532e-02 1 1  ON 5
 uu_6                -1.216033e-01 1 1  ON 6
 uu_7                -1.334733e-01 1 1  ON 7
 uu_8                -1.250269e-01 1 1  ON 8
 uu_9                -9.537692e-02 1 1  ON 9
 ud_0                 4.399998e-01 1 1  ON 10
 ud_1                 1.756888e-01 1 1  ON 11
 ud_2                 5.798452e-02 1 1  ON 12
 ud_3                -1.069173e-02 1 1  ON 13
 ud_4                -6.593436e-02 1 1  ON 14
 ud_5                -1.061831e-01 1 1  ON 15
 ud_6                -1.319652e-01 1 1  ON 16
 ud_7                -1.472744e-01 1 1  ON 17
 ud_8                -1.479076e-01 1 1  ON 18
 ud_9                -1.375975e-01 1 1  ON 19
 eO_0                -7.481783e-01 1 1  ON 20
 eO_1                -4.311997e-01 1 1  ON 21
 eO_2                -1.568130e-02 1 1  ON 22
 eO_3                 2.970023e-01 1 1  ON 23
 eO_4                 5.118805e-01 1 1  ON 24
 eO_5                 4.664684e-01 1 1  ON 25
 eO_6                 2.382452e-01 1 1  ON 26
 eO_7                -5.428370e-02 1 1  ON 27
 eO_8                -2.031992e-01 1 1  ON 28
 eO_9                -6.321356e-02 1 1  ON 29
eH1_0                -2.289841e-01 1 1  ON 30
eH1_1                -1.322992e-01 1 1  ON 31
eH1_2                -8.836251e-02 1 1  ON 32
eH1_3                -3.566342e-02 1 1  ON 33
eH1_4                 1.130479e-02 1 1  ON 34
eH1_5                 4.518640e-02 1 1  ON 35
eH1_6                 9.884328e-02 1 1  ON 36
eH1_7                 1.431293e-01 1 1  ON 37
eH1_8                 1.525991e-01 1 1  ON 38
eH1_9                 3.907419e-02 1 1  ON 39
eH2_0                -2.269957e-01 1 1  ON 40
eH2_1                -1.302341e-01 1 1  ON 41
eH2_2                -8.585309e-02 1 1  ON 42
eH2_3                -3.296019e-02 1 1  ON 43
eH2_4                 1.397515e-02 1 1  ON 44
eH2_5                 4.864632e-02 1 1  ON 45
eH2_6                 1.016400e-01 1 1  ON 46
eH2_7                 1.483712e-01 1 1  ON 47
eH2_8                 1.601964e-01 1 1  ON 48
eH2_9                 2.170495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8836
    reference variance = 0.38202
====================================================
  Execution time = 2.0754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847695394
                                         uncertainty =       0.004695971706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847695394
                                         uncertainty =       0.004695971706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989725
  error estimate for blocks of size 2^( 2) =       0.000423147431
  error estimate for blocks of size 2^( 3) =       0.000435383321
  error estimate for blocks of size 2^( 4) =       0.000446569828
  error estimate for blocks of size 2^( 5) =       0.000455460567
  error estimate for blocks of size 2^( 6) =       0.000462011977
  error estimate for blocks of size 2^( 7) =       0.000467615632

      target function =                  N/A
              le_mean =     -16.905226026368
             les_mean =     286.124491942572
             stat err =       0.000457914501
             autocorr =       1.241386058463
              std dev =       0.581227243769
             le_variance =       0.337825108900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690522602637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905226026368       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905225134727       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905237111272       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905240252586       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905240503253       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241128746       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905247896261       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905250162343       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905249747457       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905249591366       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905251288105       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905251478749       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905252531481       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905252574554       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905252465605       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 5.111628e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905226026368       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905225484619       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905232123131       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905232652922       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905232092826       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905232859503       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905234172137       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905235109554       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905234532200       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905234580085       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905234586417       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905234780475       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.830650e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905226026368       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905225815542       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905228279564       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905228267336       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905227862971       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905228112307       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905228274753       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905228499937       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905228390115       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.457351e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6414e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.065864e-01 1 1  ON 0
 uu_1                 1.405156e-01 1 1  ON 1
 uu_2                 4.015164e-02 1 1  ON 2
 uu_3                -2.072641e-02 1 1  ON 3
 uu_4                -6.377937e-02 1 1  ON 4
 uu_5                -9.636629e-02 1 1  ON 5
 uu_6                -1.219542e-01 1 1  ON 6
 uu_7                -1.336587e-01 1 1  ON 7
 uu_8                -1.255297e-01 1 1  ON 8
 uu_9                -9.569122e-02 1 1  ON 9
 ud_0                 4.417743e-01 1 1  ON 10
 ud_1                 1.765674e-01 1 1  ON 11
 ud_2                 5.800942e-02 1 1  ON 12
 ud_3                -1.109829e-02 1 1  ON 13
 ud_4                -6.640714e-02 1 1  ON 14
 ud_5                -1.061437e-01 1 1  ON 15
 ud_6                -1.320730e-01 1 1  ON 16
 ud_7                -1.476182e-01 1 1  ON 17
 ud_8                -1.485050e-01 1 1  ON 18
 ud_9                -1.382513e-01 1 1  ON 19
 eO_0                -7.500090e-01 1 1  ON 20
 eO_1                -4.323441e-01 1 1  ON 21
 eO_2                -1.521741e-02 1 1  ON 22
 eO_3                 2.982862e-01 1 1  ON 23
 eO_4                 5.130988e-01 1 1  ON 24
 eO_5                 4.672101e-01 1 1  ON 25
 eO_6                 2.386839e-01 1 1  ON 26
 eO_7                -5.399945e-02 1 1  ON 27
 eO_8                -2.039459e-01 1 1  ON 28
 eO_9                -6.383840e-02 1 1  ON 29
eH1_0                -2.300185e-01 1 1  ON 30
eH1_1                -1.326538e-01 1 1  ON 31
eH1_2                -8.838425e-02 1 1  ON 32
eH1_3                -3.559225e-02 1 1  ON 33
eH1_4                 1.121741e-02 1 1  ON 34
eH1_5                 4.510124e-02 1 1  ON 35
eH1_6                 9.904919e-02 1 1  ON 36
eH1_7                 1.432683e-01 1 1  ON 37
eH1_8                 1.531156e-01 1 1  ON 38
eH1_9                 3.971499e-02 1 1  ON 39
eH2_0                -2.275153e-01 1 1  ON 40
eH2_1                -1.305687e-01 1 1  ON 41
eH2_2                -8.582944e-02 1 1  ON 42
eH2_3                -3.280078e-02 1 1  ON 43
eH2_4                 1.390831e-02 1 1  ON 44
eH2_5                 4.831461e-02 1 1  ON 45
eH2_6                 1.014126e-01 1 1  ON 46
eH2_7                 1.482140e-01 1 1  ON 47
eH2_8                 1.608861e-01 1 1  ON 48
eH2_9                 2.252668e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9288
    reference variance = 0.250962
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3660e-01
  Total weights = 2.0000e+06
  Execution time = 1.9083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335255164234
                                         uncertainty =       0.003683919480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335255164234
                                         uncertainty =       0.003683919480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409446613
  error estimate for blocks of size 2^( 2) =       0.000421686259
  error estimate for blocks of size 2^( 3) =       0.000435003191
  error estimate for blocks of size 2^( 4) =       0.000446910051
  error estimate for blocks of size 2^( 5) =       0.000457850484
  error estimate for blocks of size 2^( 6) =       0.000465066327
  error estimate for blocks of size 2^( 7) =       0.000471839346

      target function =                  N/A
              le_mean =     -16.905338211786
             les_mean =     286.125752945469
             stat err =       0.000460416552
             autocorr =       1.264466390033
              std dev =       0.579044953569
             le_variance =       0.335293058254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667226628
                                         uncertainty =       0.003698396067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667226628
                                         uncertainty =       0.003698396067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410916960
  error estimate for blocks of size 2^( 2) =       0.000423067531
  error estimate for blocks of size 2^( 3) =       0.000436281013
  error estimate for blocks of size 2^( 4) =       0.000448099569
  error estimate for blocks of size 2^( 5) =       0.000458991473
  error estimate for blocks of size 2^( 6) =       0.000466164179
  error estimate for blocks of size 2^( 7) =       0.000472930445

      target function =                  N/A
              le_mean =     -16.905332421934
             les_mean =     286.127969622604
             stat err =       0.000461546417
             autocorr =       1.261602772573
              std dev =       0.581124337272
             le_variance =       0.337705495370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337903297848
                                         uncertainty =       0.003697609647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337903297848
                                         uncertainty =       0.003697609647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411060643
  error estimate for blocks of size 2^( 2) =       0.000423204715
  error estimate for blocks of size 2^( 3) =       0.000436417306
  error estimate for blocks of size 2^( 4) =       0.000448241323
  error estimate for blocks of size 2^( 5) =       0.000459144737
  error estimate for blocks of size 2^( 6) =       0.000466314829
  error estimate for blocks of size 2^( 7) =       0.000473090693

      target function =                  N/A
              le_mean =     -16.905333948699
             les_mean =     286.128257452180
             stat err =       0.000461697895
             autocorr =       1.261548627991
              std dev =       0.581327536009
             le_variance =       0.337941704123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771797047
                                         uncertainty =       0.003686428031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771797047
                                         uncertainty =       0.003686428031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409762012
  error estimate for blocks of size 2^( 2) =       0.000421981708
  error estimate for blocks of size 2^( 3) =       0.000435277877
  error estimate for blocks of size 2^( 4) =       0.000447169142
  error estimate for blocks of size 2^( 5) =       0.000458103347
  error estimate for blocks of size 2^( 6) =       0.000465310384
  error estimate for blocks of size 2^( 7) =       0.000472085303

      target function =                  N/A
              le_mean =     -16.905335229025
             les_mean =     286.126168850086
             stat err =       0.000460667044
             autocorr =       1.263894726087
              std dev =       0.579490994133
             le_variance =       0.335809812281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905338211786        initial  <--
     6.2500e-02     6.2500e-01             5.1116e-03       -16.905332421934
     2.5000e-01     2.5000e+00             1.8307e-03       -16.905333948699
     1.0000e+00     1.0000e+01             6.4574e-04       -16.905335229025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2160
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.060552e-01 1 1  ON 0
 uu_1                 1.404754e-01 1 1  ON 1
 uu_2                 4.009839e-02 1 1  ON 2
 uu_3                -2.079163e-02 1 1  ON 3
 uu_4                -6.378819e-02 1 1  ON 4
 uu_5                -9.623532e-02 1 1  ON 5
 uu_6                -1.216033e-01 1 1  ON 6
 uu_7                -1.334733e-01 1 1  ON 7
 uu_8                -1.250269e-01 1 1  ON 8
 uu_9                -9.537692e-02 1 1  ON 9
 ud_0                 4.399998e-01 1 1  ON 10
 ud_1                 1.756888e-01 1 1  ON 11
 ud_2                 5.798452e-02 1 1  ON 12
 ud_3                -1.069173e-02 1 1  ON 13
 ud_4                -6.593436e-02 1 1  ON 14
 ud_5                -1.061831e-01 1 1  ON 15
 ud_6                -1.319652e-01 1 1  ON 16
 ud_7                -1.472744e-01 1 1  ON 17
 ud_8                -1.479076e-01 1 1  ON 18
 ud_9                -1.375975e-01 1 1  ON 19
 eO_0                -7.481783e-01 1 1  ON 20
 eO_1                -4.311997e-01 1 1  ON 21
 eO_2                -1.568130e-02 1 1  ON 22
 eO_3                 2.970023e-01 1 1  ON 23
 eO_4                 5.118805e-01 1 1  ON 24
 eO_5                 4.664684e-01 1 1  ON 25
 eO_6                 2.382452e-01 1 1  ON 26
 eO_7                -5.428370e-02 1 1  ON 27
 eO_8                -2.031992e-01 1 1  ON 28
 eO_9                -6.321356e-02 1 1  ON 29
eH1_0                -2.289841e-01 1 1  ON 30
eH1_1                -1.322992e-01 1 1  ON 31
eH1_2                -8.836251e-02 1 1  ON 32
eH1_3                -3.566342e-02 1 1  ON 33
eH1_4                 1.130479e-02 1 1  ON 34
eH1_5                 4.518640e-02 1 1  ON 35
eH1_6                 9.884328e-02 1 1  ON 36
eH1_7                 1.431293e-01 1 1  ON 37
eH1_8                 1.525991e-01 1 1  ON 38
eH1_9                 3.907419e-02 1 1  ON 39
eH2_0                -2.269957e-01 1 1  ON 40
eH2_1                -1.302341e-01 1 1  ON 41
eH2_2                -8.585309e-02 1 1  ON 42
eH2_3                -3.296019e-02 1 1  ON 43
eH2_4                 1.397515e-02 1 1  ON 44
eH2_5                 4.864632e-02 1 1  ON 45
eH2_6                 1.016400e-01 1 1  ON 46
eH2_7                 1.483712e-01 1 1  ON 47
eH2_8                 1.601964e-01 1 1  ON 48
eH2_9                 2.170495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.309191
====================================================
  Execution time = 2.0782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346110271819
                                         uncertainty =       0.008764242957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346110271819
                                         uncertainty =       0.008764242957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415979326
  error estimate for blocks of size 2^( 2) =       0.000428243880
  error estimate for blocks of size 2^( 3) =       0.000441381295
  error estimate for blocks of size 2^( 4) =       0.000453303030
  error estimate for blocks of size 2^( 5) =       0.000464221100
  error estimate for blocks of size 2^( 6) =       0.000472801463
  error estimate for blocks of size 2^( 7) =       0.000479832520

      target function =                  N/A
              le_mean =     -16.905796033029
             les_mean =     286.152016936367
             stat err =       0.000467539528
             autocorr =       1.263261250923
              std dev =       0.588283604243
             le_variance =       0.346077599021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579603303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905796033029       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905795802882       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797930250       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798223705       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799271548       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799846388       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799457079       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799411033       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905799613047       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905799649070       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 9.313594e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905796033029       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905795958320       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905796646629       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905796776979       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797162699       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797301311       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797203665       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905797158934       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905797172456       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.508232e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905796033029       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905796012846       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905796198958       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905796236945       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905796348386       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905796384817       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905796358282       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905796345801       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905796345947       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 6.386632e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6423e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.060777e-01 1 1  ON 0
 uu_1                 1.404575e-01 1 1  ON 1
 uu_2                 4.006833e-02 1 1  ON 2
 uu_3                -2.079851e-02 1 1  ON 3
 uu_4                -6.376149e-02 1 1  ON 4
 uu_5                -9.623334e-02 1 1  ON 5
 uu_6                -1.216561e-01 1 1  ON 6
 uu_7                -1.334572e-01 1 1  ON 7
 uu_8                -1.250760e-01 1 1  ON 8
 uu_9                -9.538923e-02 1 1  ON 9
 ud_0                 4.402006e-01 1 1  ON 10
 ud_1                 1.758322e-01 1 1  ON 11
 ud_2                 5.794548e-02 1 1  ON 12
 ud_3                -1.077590e-02 1 1  ON 13
 ud_4                -6.600893e-02 1 1  ON 14
 ud_5                -1.061878e-01 1 1  ON 15
 ud_6                -1.319943e-01 1 1  ON 16
 ud_7                -1.473290e-01 1 1  ON 17
 ud_8                -1.479316e-01 1 1  ON 18
 ud_9                -1.375996e-01 1 1  ON 19
 eO_0                -7.484291e-01 1 1  ON 20
 eO_1                -4.313411e-01 1 1  ON 21
 eO_2                -1.558470e-02 1 1  ON 22
 eO_3                 2.971692e-01 1 1  ON 23
 eO_4                 5.119888e-01 1 1  ON 24
 eO_5                 4.665339e-01 1 1  ON 25
 eO_6                 2.382981e-01 1 1  ON 26
 eO_7                -5.426415e-02 1 1  ON 27
 eO_8                -2.032583e-01 1 1  ON 28
 eO_9                -6.326434e-02 1 1  ON 29
eH1_0                -2.290949e-01 1 1  ON 30
eH1_1                -1.323685e-01 1 1  ON 31
eH1_2                -8.836361e-02 1 1  ON 32
eH1_3                -3.565111e-02 1 1  ON 33
eH1_4                 1.133258e-02 1 1  ON 34
eH1_5                 4.517025e-02 1 1  ON 35
eH1_6                 9.884176e-02 1 1  ON 36
eH1_7                 1.431672e-01 1 1  ON 37
eH1_8                 1.526681e-01 1 1  ON 38
eH1_9                 3.913103e-02 1 1  ON 39
eH2_0                -2.270916e-01 1 1  ON 40
eH2_1                -1.302326e-01 1 1  ON 41
eH2_2                -8.585753e-02 1 1  ON 42
eH2_3                -3.298279e-02 1 1  ON 43
eH2_4                 1.394919e-02 1 1  ON 44
eH2_5                 4.861450e-02 1 1  ON 45
eH2_6                 1.016415e-01 1 1  ON 46
eH2_7                 1.483876e-01 1 1  ON 47
eH2_8                 1.602630e-01 1 1  ON 48
eH2_9                 2.178511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9547
    reference variance = 0.242631
====================================================
  Execution time = 2.0399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3068e-01
  Total weights = 2.0000e+06
  Execution time = 1.9019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330491243237
                                         uncertainty =       0.003423461735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330491243237
                                         uncertainty =       0.003423461735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406520453
  error estimate for blocks of size 2^( 2) =       0.000419030933
  error estimate for blocks of size 2^( 3) =       0.000432708948
  error estimate for blocks of size 2^( 4) =       0.000444629029
  error estimate for blocks of size 2^( 5) =       0.000454729610
  error estimate for blocks of size 2^( 6) =       0.000462709957
  error estimate for blocks of size 2^( 7) =       0.000468725692

      target function =                  N/A
              le_mean =     -16.905086863990
             les_mean =     286.112479471646
             stat err =       0.000457698572
             autocorr =       1.267635265151
              std dev =       0.574906738410
             le_variance =       0.330517757870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331009013729
                                         uncertainty =       0.003428716171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331009013729
                                         uncertainty =       0.003428716171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406838773
  error estimate for blocks of size 2^( 2) =       0.000419328164
  error estimate for blocks of size 2^( 3) =       0.000432980603
  error estimate for blocks of size 2^( 4) =       0.000444876165
  error estimate for blocks of size 2^( 5) =       0.000454966902
  error estimate for blocks of size 2^( 6) =       0.000462936833
  error estimate for blocks of size 2^( 7) =       0.000468952762

      target function =                  N/A
              le_mean =     -16.905090319002
             les_mean =     286.113114103206
             stat err =       0.000457933166
             autocorr =       1.266950140772
              std dev =       0.575356911076
             le_variance =       0.331035575123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330815265958
                                         uncertainty =       0.003426760804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330815265958
                                         uncertainty =       0.003426760804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406719693
  error estimate for blocks of size 2^( 2) =       0.000419216498
  error estimate for blocks of size 2^( 3) =       0.000432878155
  error estimate for blocks of size 2^( 4) =       0.000444782788
  error estimate for blocks of size 2^( 5) =       0.000454876998
  error estimate for blocks of size 2^( 6) =       0.000462851269
  error estimate for blocks of size 2^( 7) =       0.000468867749

      target function =                  N/A
              le_mean =     -16.905088951566
             les_mean =     286.112874111788
             stat err =       0.000457844701
             autocorr =       1.267202388594
              std dev =       0.575188505506
             le_variance =       0.330841816867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330533856061
                                         uncertainty =       0.003423899025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330533856061
                                         uncertainty =       0.003423899025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406546661
  error estimate for blocks of size 2^( 2) =       0.000419055292
  error estimate for blocks of size 2^( 3) =       0.000432731100
  error estimate for blocks of size 2^( 4) =       0.000444649108
  error estimate for blocks of size 2^( 5) =       0.000454748832
  error estimate for blocks of size 2^( 6) =       0.000462728406
  error estimate for blocks of size 2^( 7) =       0.000468744274

      target function =                  N/A
              le_mean =     -16.905087102077
             les_mean =     286.112530139022
             stat err =       0.000457717655
             autocorr =       1.267577526078
              std dev =       0.574943802043
             le_variance =       0.330560375508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905086863990        initial
     6.2500e-01     6.2500e+00             9.3136e-04       -16.905090319002  <--
     2.5000e+00     2.5000e+01             2.5082e-04       -16.905088951566
     1.0000e+01     1.0000e+02             6.3866e-05       -16.905087102077

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0019e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.061316e-01 1 1  ON 0
 uu_1                 1.404203e-01 1 1  ON 1
 uu_2                 4.000472e-02 1 1  ON 2
 uu_3                -2.082999e-02 1 1  ON 3
 uu_4                -6.371412e-02 1 1  ON 4
 uu_5                -9.622762e-02 1 1  ON 5
 uu_6                -1.217842e-01 1 1  ON 6
 uu_7                -1.334261e-01 1 1  ON 7
 uu_8                -1.252195e-01 1 1  ON 8
 uu_9                -9.542581e-02 1 1  ON 9
 ud_0                 4.406824e-01 1 1  ON 10
 ud_1                 1.761588e-01 1 1  ON 11
 ud_2                 5.792485e-02 1 1  ON 12
 ud_3                -1.096946e-02 1 1  ON 13
 ud_4                -6.619919e-02 1 1  ON 14
 ud_5                -1.062199e-01 1 1  ON 15
 ud_6                -1.320587e-01 1 1  ON 16
 ud_7                -1.474687e-01 1 1  ON 17
 ud_8                -1.479998e-01 1 1  ON 18
 ud_9                -1.376049e-01 1 1  ON 19
 eO_0                -7.491097e-01 1 1  ON 20
 eO_1                -4.317142e-01 1 1  ON 21
 eO_2                -1.540909e-02 1 1  ON 22
 eO_3                 2.976176e-01 1 1  ON 23
 eO_4                 5.123317e-01 1 1  ON 24
 eO_5                 4.667500e-01 1 1  ON 25
 eO_6                 2.384587e-01 1 1  ON 26
 eO_7                -5.420599e-02 1 1  ON 27
 eO_8                -2.034334e-01 1 1  ON 28
 eO_9                -6.341535e-02 1 1  ON 29
eH1_0                -2.294087e-01 1 1  ON 30
eH1_1                -1.325405e-01 1 1  ON 31
eH1_2                -8.838057e-02 1 1  ON 32
eH1_3                -3.563567e-02 1 1  ON 33
eH1_4                 1.138657e-02 1 1  ON 34
eH1_5                 4.513165e-02 1 1  ON 35
eH1_6                 9.884197e-02 1 1  ON 36
eH1_7                 1.432795e-01 1 1  ON 37
eH1_8                 1.528731e-01 1 1  ON 38
eH1_9                 3.930051e-02 1 1  ON 39
eH2_0                -2.273537e-01 1 1  ON 40
eH2_1                -1.302626e-01 1 1  ON 41
eH2_2                -8.588033e-02 1 1  ON 42
eH2_3                -3.303781e-02 1 1  ON 43
eH2_4                 1.386515e-02 1 1  ON 44
eH2_5                 4.852649e-02 1 1  ON 45
eH2_6                 1.016502e-01 1 1  ON 46
eH2_7                 1.484390e-01 1 1  ON 47
eH2_8                 1.604622e-01 1 1  ON 48
eH2_9                 2.202421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.96
    reference variance = 0.19567
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7828e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378370409538
                                         uncertainty =       0.036032295195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378370409538
                                         uncertainty =       0.036032295195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434901592
  error estimate for blocks of size 2^( 2) =       0.000447854463
  error estimate for blocks of size 2^( 3) =       0.000461043993
  error estimate for blocks of size 2^( 4) =       0.000472577435
  error estimate for blocks of size 2^( 5) =       0.000483635557
  error estimate for blocks of size 2^( 6) =       0.000492274796
  error estimate for blocks of size 2^( 7) =       0.000499361640

      target function =                  N/A
              le_mean =     -16.905808938266
             les_mean =     286.184654458238
             stat err =       0.000486962357
             autocorr =       1.253743763101
              std dev =       0.615043730344
             le_variance =       0.378278790236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580893827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905808938266       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812273327       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905814088177       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905814692091       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816016314       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905817183882       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905819333380       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905820021315       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905819804386       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905820026255       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905820018022       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905820180759       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.636060e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905808938266       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810375030       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811210406       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811321642       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905811929752       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812122370       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812272106       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812460365       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812506816       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905812523738       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.419263e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905808938266       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809376735       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809657330       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809705597       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809890683       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809912690       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809912929       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809932911       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905809953528       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.319436e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6278e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.061436e-01 1 1  ON 0
 uu_1                 1.404643e-01 1 1  ON 1
 uu_2                 4.004275e-02 1 1  ON 2
 uu_3                -2.073902e-02 1 1  ON 3
 uu_4                -6.376883e-02 1 1  ON 4
 uu_5                -9.642316e-02 1 1  ON 5
 uu_6                -1.218435e-01 1 1  ON 6
 uu_7                -1.335013e-01 1 1  ON 7
 uu_8                -1.252590e-01 1 1  ON 8
 uu_9                -9.549016e-02 1 1  ON 9
 ud_0                 4.411505e-01 1 1  ON 10
 ud_1                 1.764796e-01 1 1  ON 11
 ud_2                 5.786782e-02 1 1  ON 12
 ud_3                -1.118518e-02 1 1  ON 13
 ud_4                -6.634168e-02 1 1  ON 14
 ud_5                -1.064025e-01 1 1  ON 15
 ud_6                -1.321642e-01 1 1  ON 16
 ud_7                -1.474480e-01 1 1  ON 17
 ud_8                -1.479837e-01 1 1  ON 18
 ud_9                -1.376855e-01 1 1  ON 19
 eO_0                -7.499516e-01 1 1  ON 20
 eO_1                -4.320376e-01 1 1  ON 21
 eO_2                -1.541546e-02 1 1  ON 22
 eO_3                 2.980398e-01 1 1  ON 23
 eO_4                 5.129049e-01 1 1  ON 24
 eO_5                 4.670549e-01 1 1  ON 25
 eO_6                 2.386906e-01 1 1  ON 26
 eO_7                -5.406708e-02 1 1  ON 27
 eO_8                -2.036266e-01 1 1  ON 28
 eO_9                -6.367245e-02 1 1  ON 29
eH1_0                -2.298533e-01 1 1  ON 30
eH1_1                -1.328479e-01 1 1  ON 31
eH1_2                -8.842085e-02 1 1  ON 32
eH1_3                -3.566006e-02 1 1  ON 33
eH1_4                 1.139483e-02 1 1  ON 34
eH1_5                 4.498026e-02 1 1  ON 35
eH1_6                 9.896294e-02 1 1  ON 36
eH1_7                 1.436034e-01 1 1  ON 37
eH1_8                 1.532342e-01 1 1  ON 38
eH1_9                 3.953164e-02 1 1  ON 39
eH2_0                -2.277056e-01 1 1  ON 40
eH2_1                -1.304906e-01 1 1  ON 41
eH2_2                -8.587830e-02 1 1  ON 42
eH2_3                -3.300100e-02 1 1  ON 43
eH2_4                 1.391182e-02 1 1  ON 44
eH2_5                 4.827395e-02 1 1  ON 45
eH2_6                 1.015952e-01 1 1  ON 46
eH2_7                 1.484844e-01 1 1  ON 47
eH2_8                 1.607860e-01 1 1  ON 48
eH2_9                 2.244370e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.250691
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3813e-01
  Total weights = 2.0000e+06
  Execution time = 1.9111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770519556
                                         uncertainty =       0.004665377881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337770519556
                                         uncertainty =       0.004665377881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410983681
  error estimate for blocks of size 2^( 2) =       0.000423894244
  error estimate for blocks of size 2^( 3) =       0.000436986233
  error estimate for blocks of size 2^( 4) =       0.000449076006
  error estimate for blocks of size 2^( 5) =       0.000458208571
  error estimate for blocks of size 2^( 6) =       0.000463986436
  error estimate for blocks of size 2^( 7) =       0.000465964250

      target function =                  N/A
              le_mean =     -16.906581905953
             les_mean =     286.170326745718
             stat err =       0.000459308816
             autocorr =       1.248994159523
              std dev =       0.581218695434
             le_variance =       0.337815171922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338642720120
                                         uncertainty =       0.004661143041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338642720120
                                         uncertainty =       0.004661143041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514107
  error estimate for blocks of size 2^( 2) =       0.000424395350
  error estimate for blocks of size 2^( 3) =       0.000437448941
  error estimate for blocks of size 2^( 4) =       0.000449499884
  error estimate for blocks of size 2^( 5) =       0.000458617932
  error estimate for blocks of size 2^( 6) =       0.000464369768
  error estimate for blocks of size 2^( 7) =       0.000466333424

      target function =                  N/A
              le_mean =     -16.906586286495
             les_mean =     286.171347413289
             stat err =       0.000459705252
             autocorr =       1.247927848321
              std dev =       0.581968830724
             le_variance =       0.338687719934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405501325
                                         uncertainty =       0.004660499762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338405501325
                                         uncertainty =       0.004660499762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411369927
  error estimate for blocks of size 2^( 2) =       0.000424257349
  error estimate for blocks of size 2^( 3) =       0.000437320652
  error estimate for blocks of size 2^( 4) =       0.000449383386
  error estimate for blocks of size 2^( 5) =       0.000458507666
  error estimate for blocks of size 2^( 6) =       0.000464263527
  error estimate for blocks of size 2^( 7) =       0.000466234036

      target function =                  N/A
              le_mean =     -16.906585231282
             les_mean =     286.171074447597
             stat err =       0.000459597154
             autocorr =       1.248215529471
              std dev =       0.581764930393
             le_variance =       0.338450434236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337865782379
                                         uncertainty =       0.004664591300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337865782379
                                         uncertainty =       0.004664591300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411041651
  error estimate for blocks of size 2^( 2) =       0.000423948443
  error estimate for blocks of size 2^( 3) =       0.000437035918
  error estimate for blocks of size 2^( 4) =       0.000449121619
  error estimate for blocks of size 2^( 5) =       0.000458252951
  error estimate for blocks of size 2^( 6) =       0.000464027211
  error estimate for blocks of size 2^( 7) =       0.000466004417

      target function =                  N/A
              le_mean =     -16.906582100598
             les_mean =     286.170428632398
             stat err =       0.000459351549
             autocorr =       1.248874244619
              std dev =       0.581300677020
             le_variance =       0.337910477104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906581905953        initial
     1.5625e-01     1.5625e+00             2.6361e-03       -16.906586286495  <--
     6.2500e-01     6.2500e+00             8.4193e-04       -16.906585231282
     2.5000e+00     2.5000e+01             2.3194e-04       -16.906582100598

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0042e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.063491e-01 1 1  ON 0
 uu_1                 1.406680e-01 1 1  ON 1
 uu_2                 4.015843e-02 1 1  ON 2
 uu_3                -2.067974e-02 1 1  ON 3
 uu_4                -6.395777e-02 1 1  ON 4
 uu_5                -9.681085e-02 1 1  ON 5
 uu_6                -1.221339e-01 1 1  ON 6
 uu_7                -1.337780e-01 1 1  ON 7
 uu_8                -1.254167e-01 1 1  ON 8
 uu_9                -9.568763e-02 1 1  ON 9
 ud_0                 4.420131e-01 1 1  ON 10
 ud_1                 1.770321e-01 1 1  ON 11
 ud_2                 5.798870e-02 1 1  ON 12
 ud_3                -1.142921e-02 1 1  ON 13
 ud_4                -6.667639e-02 1 1  ON 14
 ud_5                -1.067788e-01 1 1  ON 15
 ud_6                -1.324121e-01 1 1  ON 16
 ud_7                -1.474818e-01 1 1  ON 17
 ud_8                -1.479541e-01 1 1  ON 18
 ud_9                -1.378943e-01 1 1  ON 19
 eO_0                -7.517457e-01 1 1  ON 20
 eO_1                -4.330693e-01 1 1  ON 21
 eO_2                -1.561833e-02 1 1  ON 22
 eO_3                 2.988421e-01 1 1  ON 23
 eO_4                 5.144181e-01 1 1  ON 24
 eO_5                 4.680984e-01 1 1  ON 25
 eO_6                 2.394354e-01 1 1  ON 26
 eO_7                -5.365075e-02 1 1  ON 27
 eO_8                -2.041992e-01 1 1  ON 28
 eO_9                -6.444350e-02 1 1  ON 29
eH1_0                -2.309076e-01 1 1  ON 30
eH1_1                -1.335662e-01 1 1  ON 31
eH1_2                -8.870977e-02 1 1  ON 32
eH1_3                -3.588481e-02 1 1  ON 33
eH1_4                 1.128082e-02 1 1  ON 34
eH1_5                 4.457471e-02 1 1  ON 35
eH1_6                 9.925286e-02 1 1  ON 36
eH1_7                 1.445417e-01 1 1  ON 37
eH1_8                 1.543340e-01 1 1  ON 38
eH1_9                 4.023943e-02 1 1  ON 39
eH2_0                -2.285219e-01 1 1  ON 40
eH2_1                -1.310222e-01 1 1  ON 41
eH2_2                -8.602610e-02 1 1  ON 42
eH2_3                -3.306068e-02 1 1  ON 43
eH2_4                 1.387129e-02 1 1  ON 44
eH2_5                 4.763527e-02 1 1  ON 45
eH2_6                 1.014249e-01 1 1  ON 46
eH2_7                 1.486198e-01 1 1  ON 47
eH2_8                 1.617503e-01 1 1  ON 48
eH2_9                 2.370532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9144
    reference variance = 0.221442
====================================================
  Execution time = 2.0853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338846634091
                                         uncertainty =       0.003757225780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338846634091
                                         uncertainty =       0.003757225780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587874
  error estimate for blocks of size 2^( 2) =       0.000423701157
  error estimate for blocks of size 2^( 3) =       0.000436411087
  error estimate for blocks of size 2^( 4) =       0.000447939158
  error estimate for blocks of size 2^( 5) =       0.000458640162
  error estimate for blocks of size 2^( 6) =       0.000464889507
  error estimate for blocks of size 2^( 7) =       0.000467170737

      target function =                  N/A
              le_mean =     -16.905109521824
             les_mean =     286.121536931003
             stat err =       0.000459659891
             autocorr =       1.247234390786
              std dev =       0.582073153091
             le_variance =       0.338809155549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510952182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905109521824       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905112217351       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905119151369       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905123492199       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905126950572       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905126843505       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905132479165       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905132255949       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905134637629       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905133044471       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905135842702       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905136192228       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905135965555       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905136321786       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905136389868       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905136367515       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.215267e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905109521824       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905111379978       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905115589321       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905118390820       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905117833046       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905117889971       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905120220707       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905119878631       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905119222331       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905119639327       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905119662767       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905119818725       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.303286e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905109521824       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905110350391       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905111969484       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905112974531       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905113023544       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905112617032       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905112913019       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905113156374       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905113057018       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.845726e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6593e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.069976e-01 1 1  ON 0
 uu_1                 1.409227e-01 1 1  ON 1
 uu_2                 4.014441e-02 1 1  ON 2
 uu_3                -2.100138e-02 1 1  ON 3
 uu_4                -6.431173e-02 1 1  ON 4
 uu_5                -9.679591e-02 1 1  ON 5
 uu_6                -1.224531e-01 1 1  ON 6
 uu_7                -1.344130e-01 1 1  ON 7
 uu_8                -1.259483e-01 1 1  ON 8
 uu_9                -9.609037e-02 1 1  ON 9
 ud_0                 4.429164e-01 1 1  ON 10
 ud_1                 1.776038e-01 1 1  ON 11
 ud_2                 5.826460e-02 1 1  ON 12
 ud_3                -1.159312e-02 1 1  ON 13
 ud_4                -6.727829e-02 1 1  ON 14
 ud_5                -1.069986e-01 1 1  ON 15
 ud_6                -1.329905e-01 1 1  ON 16
 ud_7                -1.480702e-01 1 1  ON 17
 ud_8                -1.480381e-01 1 1  ON 18
 ud_9                -1.374037e-01 1 1  ON 19
 eO_0                -7.540490e-01 1 1  ON 20
 eO_1                -4.346385e-01 1 1  ON 21
 eO_2                -1.570061e-02 1 1  ON 22
 eO_3                 3.001978e-01 1 1  ON 23
 eO_4                 5.160846e-01 1 1  ON 24
 eO_5                 4.697556e-01 1 1  ON 25
 eO_6                 2.402442e-01 1 1  ON 26
 eO_7                -5.341354e-02 1 1  ON 27
 eO_8                -2.052136e-01 1 1  ON 28
 eO_9                -6.511500e-02 1 1  ON 29
eH1_0                -2.321558e-01 1 1  ON 30
eH1_1                -1.341733e-01 1 1  ON 31
eH1_2                -8.906535e-02 1 1  ON 32
eH1_3                -3.646306e-02 1 1  ON 33
eH1_4                 1.071384e-02 1 1  ON 34
eH1_5                 4.425443e-02 1 1  ON 35
eH1_6                 9.918548e-02 1 1  ON 36
eH1_7                 1.452596e-01 1 1  ON 37
eH1_8                 1.558734e-01 1 1  ON 38
eH1_9                 4.153517e-02 1 1  ON 39
eH2_0                -2.296170e-01 1 1  ON 40
eH2_1                -1.314456e-01 1 1  ON 41
eH2_2                -8.632785e-02 1 1  ON 42
eH2_3                -3.348966e-02 1 1  ON 43
eH2_4                 1.336954e-02 1 1  ON 44
eH2_5                 4.724908e-02 1 1  ON 45
eH2_6                 1.018030e-01 1 1  ON 46
eH2_7                 1.487107e-01 1 1  ON 47
eH2_8                 1.628075e-01 1 1  ON 48
eH2_9                 2.514749e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9369
    reference variance = 0.382538
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3797e-01
  Total weights = 2.0000e+06
  Execution time = 1.9123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337337897506
                                         uncertainty =       0.003229745004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337337897506
                                         uncertainty =       0.003229745004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410638633
  error estimate for blocks of size 2^( 2) =       0.000423597902
  error estimate for blocks of size 2^( 3) =       0.000436945867
  error estimate for blocks of size 2^( 4) =       0.000449233473
  error estimate for blocks of size 2^( 5) =       0.000458393881
  error estimate for blocks of size 2^( 6) =       0.000465861033
  error estimate for blocks of size 2^( 7) =       0.000472668933

      target function =                  N/A
              le_mean =     -16.905715318206
             les_mean =     286.140458425500
             stat err =       0.000461539330
             autocorr =       1.263274760272
              std dev =       0.580730724098
             le_variance =       0.337248173911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338938697700
                                         uncertainty =       0.003244226298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338938697700
                                         uncertainty =       0.003244226298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411611898
  error estimate for blocks of size 2^( 2) =       0.000424546823
  error estimate for blocks of size 2^( 3) =       0.000437839580
  error estimate for blocks of size 2^( 4) =       0.000450067753
  error estimate for blocks of size 2^( 5) =       0.000459156267
  error estimate for blocks of size 2^( 6) =       0.000466586970
  error estimate for blocks of size 2^( 7) =       0.000473369113

      target function =                  N/A
              le_mean =     -16.905722053039
             les_mean =     286.142286674871
             stat err =       0.000462295026
             autocorr =       1.261428388262
              std dev =       0.582107129049
             le_variance =       0.338848709690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338808959213
                                         uncertainty =       0.003240907710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338808959213
                                         uncertainty =       0.003240907710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411533056
  error estimate for blocks of size 2^( 2) =       0.000424468080
  error estimate for blocks of size 2^( 3) =       0.000437767253
  error estimate for blocks of size 2^( 4) =       0.000450013224
  error estimate for blocks of size 2^( 5) =       0.000459123971
  error estimate for blocks of size 2^( 6) =       0.000466574303
  error estimate for blocks of size 2^( 7) =       0.000473371052

      target function =                  N/A
              le_mean =     -16.905721648028
             les_mean =     286.142143183626
             stat err =       0.000462270638
             autocorr =       1.261778628720
              std dev =       0.581995629170
             le_variance =       0.338718912373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337594049881
                                         uncertainty =       0.003231330660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337594049881
                                         uncertainty =       0.003231330660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410794505
  error estimate for blocks of size 2^( 2) =       0.000423748776
  error estimate for blocks of size 2^( 3) =       0.000437088062
  error estimate for blocks of size 2^( 4) =       0.000449369387
  error estimate for blocks of size 2^( 5) =       0.000458522549
  error estimate for blocks of size 2^( 6) =       0.000465988016
  error estimate for blocks of size 2^( 7) =       0.000472796983

      target function =                  N/A
              le_mean =     -16.905715567984
             les_mean =     286.140722947245
             stat err =       0.000461669234
             autocorr =       1.263026945702
              std dev =       0.580951160095
             le_variance =       0.337504250416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905715318206        initial
     3.9062e-02     3.9062e-01             6.2153e-03       -16.905722053039  <--
     1.5625e-01     1.5625e+00             2.3033e-03       -16.905721648028
     6.2500e-01     6.2500e+00             6.8457e-04       -16.905715567984

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.0105e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414880e-01 1 1  ON 1
 uu_2                 4.040635e-02 1 1  ON 2
 uu_3                -2.117537e-02 1 1  ON 3
 uu_4                -6.482458e-02 1 1  ON 4
 uu_5                -9.747404e-02 1 1  ON 5
 uu_6                -1.234248e-01 1 1  ON 6
 uu_7                -1.357622e-01 1 1  ON 7
 uu_8                -1.274485e-01 1 1  ON 8
 uu_9                -9.751845e-02 1 1  ON 9
 ud_0                 4.441886e-01 1 1  ON 10
 ud_1                 1.786025e-01 1 1  ON 11
 ud_2                 5.889887e-02 1 1  ON 12
 ud_3                -1.150240e-02 1 1  ON 13
 ud_4                -6.774011e-02 1 1  ON 14
 ud_5                -1.076667e-01 1 1  ON 15
 ud_6                -1.339897e-01 1 1  ON 16
 ud_7                -1.490528e-01 1 1  ON 17
 ud_8                -1.486567e-01 1 1  ON 18
 ud_9                -1.365675e-01 1 1  ON 19
 eO_0                -7.579610e-01 1 1  ON 20
 eO_1                -4.374963e-01 1 1  ON 21
 eO_2                -1.674161e-02 1 1  ON 22
 eO_3                 3.017884e-01 1 1  ON 23
 eO_4                 5.193328e-01 1 1  ON 24
 eO_5                 4.742296e-01 1 1  ON 25
 eO_6                 2.434498e-01 1 1  ON 26
 eO_7                -5.259450e-02 1 1  ON 27
 eO_8                -2.083682e-01 1 1  ON 28
 eO_9                -6.721678e-02 1 1  ON 29
eH1_0                -2.347011e-01 1 1  ON 30
eH1_1                -1.361531e-01 1 1  ON 31
eH1_2                -9.077639e-02 1 1  ON 32
eH1_3                -3.803799e-02 1 1  ON 33
eH1_4                 9.031517e-03 1 1  ON 34
eH1_5                 4.302994e-02 1 1  ON 35
eH1_6                 9.881600e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604188e-01 1 1  ON 38
eH1_9                 4.549592e-02 1 1  ON 39
eH2_0                -2.317571e-01 1 1  ON 40
eH2_1                -1.330640e-01 1 1  ON 41
eH2_2                -8.771866e-02 1 1  ON 42
eH2_3                -3.473601e-02 1 1  ON 43
eH2_4                 1.199927e-02 1 1  ON 44
eH2_5                 4.603963e-02 1 1  ON 45
eH2_6                 1.020783e-01 1 1  ON 46
eH2_7                 1.493226e-01 1 1  ON 47
eH2_8                 1.660357e-01 1 1  ON 48
eH2_9                 2.949596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.345378
====================================================
  Execution time = 2.3138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334136513464
                                         uncertainty =       0.002964430004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334136513464
                                         uncertainty =       0.002964430004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408791613
  error estimate for blocks of size 2^( 2) =       0.000421790001
  error estimate for blocks of size 2^( 3) =       0.000434700642
  error estimate for blocks of size 2^( 4) =       0.000447259892
  error estimate for blocks of size 2^( 5) =       0.000457733944
  error estimate for blocks of size 2^( 6) =       0.000465542234
  error estimate for blocks of size 2^( 7) =       0.000470385411

      target function =                  N/A
              le_mean =     -16.905074738393
             les_mean =     286.115772908843
             stat err =       0.000460230370
             autocorr =       1.267495992249
              std dev =       0.578118642925
             le_variance =       0.334221165297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690507473839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905074738393       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905079131032       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905083936703       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905086467337       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905091035716       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905097408481       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108844300       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905104663835       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905107606737       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905111197050       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905110919766       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905111098826       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905110593960       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905114674676       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905115469095       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905117624290       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905115055336       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905116051630       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905116724055       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905116490465       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905117376133       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905118775612       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.486824e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905074738393       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905078339254       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905082607578       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905084993993       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905089308901       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905093858669       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905097311712       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905092875650       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905093446337       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905093259357       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905092233251       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905092353087       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905092467174       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905093290738       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.847430e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905074738393       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905076830695       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905080467865       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905083689454       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905084469683       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905084708334       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905083537264       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905083004072       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905083321167       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905082978534       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.432813e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8770e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.084351e-01 1 1  ON 0
 uu_1                 1.418473e-01 1 1  ON 1
 uu_2                 4.051162e-02 1 1  ON 2
 uu_3                -2.146835e-02 1 1  ON 3
 uu_4                -6.521655e-02 1 1  ON 4
 uu_5                -9.882850e-02 1 1  ON 5
 uu_6                -1.246744e-01 1 1  ON 6
 uu_7                -1.366176e-01 1 1  ON 7
 uu_8                -1.281836e-01 1 1  ON 8
 uu_9                -9.897280e-02 1 1  ON 9
 ud_0                 4.450778e-01 1 1  ON 10
 ud_1                 1.792931e-01 1 1  ON 11
 ud_2                 5.937945e-02 1 1  ON 12
 ud_3                -1.140484e-02 1 1  ON 13
 ud_4                -6.784044e-02 1 1  ON 14
 ud_5                -1.079393e-01 1 1  ON 15
 ud_6                -1.339885e-01 1 1  ON 16
 ud_7                -1.491723e-01 1 1  ON 17
 ud_8                -1.498056e-01 1 1  ON 18
 ud_9                -1.370651e-01 1 1  ON 19
 eO_0                -7.614417e-01 1 1  ON 20
 eO_1                -4.403816e-01 1 1  ON 21
 eO_2                -1.845969e-02 1 1  ON 22
 eO_3                 3.023169e-01 1 1  ON 23
 eO_4                 5.227506e-01 1 1  ON 24
 eO_5                 4.790987e-01 1 1  ON 25
 eO_6                 2.480142e-01 1 1  ON 26
 eO_7                -5.117128e-02 1 1  ON 27
 eO_8                -2.118812e-01 1 1  ON 28
 eO_9                -6.998800e-02 1 1  ON 29
eH1_0                -2.368838e-01 1 1  ON 30
eH1_1                -1.381294e-01 1 1  ON 31
eH1_2                -9.225453e-02 1 1  ON 32
eH1_3                -3.894221e-02 1 1  ON 33
eH1_4                 7.547269e-03 1 1  ON 34
eH1_5                 4.131656e-02 1 1  ON 35
eH1_6                 9.808866e-02 1 1  ON 36
eH1_7                 1.478213e-01 1 1  ON 37
eH1_8                 1.647417e-01 1 1  ON 38
eH1_9                 5.071549e-02 1 1  ON 39
eH2_0                -2.338994e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -8.939606e-02 1 1  ON 42
eH2_3                -3.620387e-02 1 1  ON 43
eH2_4                 1.042826e-02 1 1  ON 44
eH2_5                 4.430687e-02 1 1  ON 45
eH2_6                 1.004842e-01 1 1  ON 46
eH2_7                 1.515751e-01 1 1  ON 47
eH2_8                 1.703017e-01 1 1  ON 48
eH2_9                 3.534339e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8396
    reference variance = 0.30151
====================================================
  Execution time = 2.0198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.0000e+06
  Execution time = 1.9058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337970468116
                                         uncertainty =       0.003369262605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337970468116
                                         uncertainty =       0.003369262605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411049624
  error estimate for blocks of size 2^( 2) =       0.000423659641
  error estimate for blocks of size 2^( 3) =       0.000436955407
  error estimate for blocks of size 2^( 4) =       0.000449057960
  error estimate for blocks of size 2^( 5) =       0.000458434799
  error estimate for blocks of size 2^( 6) =       0.000467083240
  error estimate for blocks of size 2^( 7) =       0.000467894092

      target function =                  N/A
              le_mean =     -16.905831166319
             les_mean =     286.145050841509
             stat err =       0.000460617523
             autocorr =       1.255718812701
              std dev =       0.581311952717
             le_variance =       0.337923586372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235744148
                                         uncertainty =       0.003377683984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235744148
                                         uncertainty =       0.003377683984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411818623
  error estimate for blocks of size 2^( 2) =       0.000424411514
  error estimate for blocks of size 2^( 3) =       0.000437663045
  error estimate for blocks of size 2^( 4) =       0.000449677794
  error estimate for blocks of size 2^( 5) =       0.000458959782
  error estimate for blocks of size 2^( 6) =       0.000467528447
  error estimate for blocks of size 2^( 7) =       0.000468317763

      target function =                  N/A
              le_mean =     -16.905823776563
             les_mean =     286.146066550670
             stat err =       0.000461120946
             autocorr =       1.253769605977
              std dev =       0.582399481495
             le_variance =       0.339189156046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339164684456
                                         uncertainty =       0.003374657516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339164684456
                                         uncertainty =       0.003374657516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411775562
  error estimate for blocks of size 2^( 2) =       0.000424369980
  error estimate for blocks of size 2^( 3) =       0.000437629460
  error estimate for blocks of size 2^( 4) =       0.000449670683
  error estimate for blocks of size 2^( 5) =       0.000458979803
  error estimate for blocks of size 2^( 6) =       0.000467564403
  error estimate for blocks of size 2^( 7) =       0.000468337732

      target function =                  N/A
              le_mean =     -16.905822968186
             les_mean =     286.145968289472
             stat err =       0.000461138155
             autocorr =       1.254125442023
              std dev =       0.582338584834
             le_variance =       0.339118227387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207692800
                                         uncertainty =       0.003369103948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207692800
                                         uncertainty =       0.003369103948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411193945
  error estimate for blocks of size 2^( 2) =       0.000423799306
  error estimate for blocks of size 2^( 3) =       0.000437087036
  error estimate for blocks of size 2^( 4) =       0.000449180223
  error estimate for blocks of size 2^( 5) =       0.000458545264
  error estimate for blocks of size 2^( 6) =       0.000467181398
  error estimate for blocks of size 2^( 7) =       0.000467982653

      target function =                  N/A
              le_mean =     -16.905827623869
             les_mean =     286.145168399744
             stat err =       0.000460722384
             autocorr =       1.255408904228
              std dev =       0.581516053824
             le_variance =       0.338160920855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905831166319        initial  <--
     9.7656e-03     9.7656e-02             2.4868e-02       -16.905823776563
     3.9062e-02     3.9062e-01             5.8474e-03       -16.905822968186
     1.5625e-01     1.5625e+00             1.4328e-03       -16.905827623869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7992
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414880e-01 1 1  ON 1
 uu_2                 4.040635e-02 1 1  ON 2
 uu_3                -2.117537e-02 1 1  ON 3
 uu_4                -6.482458e-02 1 1  ON 4
 uu_5                -9.747404e-02 1 1  ON 5
 uu_6                -1.234248e-01 1 1  ON 6
 uu_7                -1.357622e-01 1 1  ON 7
 uu_8                -1.274485e-01 1 1  ON 8
 uu_9                -9.751845e-02 1 1  ON 9
 ud_0                 4.441886e-01 1 1  ON 10
 ud_1                 1.786025e-01 1 1  ON 11
 ud_2                 5.889887e-02 1 1  ON 12
 ud_3                -1.150240e-02 1 1  ON 13
 ud_4                -6.774011e-02 1 1  ON 14
 ud_5                -1.076667e-01 1 1  ON 15
 ud_6                -1.339897e-01 1 1  ON 16
 ud_7                -1.490528e-01 1 1  ON 17
 ud_8                -1.486567e-01 1 1  ON 18
 ud_9                -1.365675e-01 1 1  ON 19
 eO_0                -7.579610e-01 1 1  ON 20
 eO_1                -4.374963e-01 1 1  ON 21
 eO_2                -1.674161e-02 1 1  ON 22
 eO_3                 3.017884e-01 1 1  ON 23
 eO_4                 5.193328e-01 1 1  ON 24
 eO_5                 4.742296e-01 1 1  ON 25
 eO_6                 2.434498e-01 1 1  ON 26
 eO_7                -5.259450e-02 1 1  ON 27
 eO_8                -2.083682e-01 1 1  ON 28
 eO_9                -6.721678e-02 1 1  ON 29
eH1_0                -2.347011e-01 1 1  ON 30
eH1_1                -1.361531e-01 1 1  ON 31
eH1_2                -9.077639e-02 1 1  ON 32
eH1_3                -3.803799e-02 1 1  ON 33
eH1_4                 9.031517e-03 1 1  ON 34
eH1_5                 4.302994e-02 1 1  ON 35
eH1_6                 9.881600e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604188e-01 1 1  ON 38
eH1_9                 4.549592e-02 1 1  ON 39
eH2_0                -2.317571e-01 1 1  ON 40
eH2_1                -1.330640e-01 1 1  ON 41
eH2_2                -8.771866e-02 1 1  ON 42
eH2_3                -3.473601e-02 1 1  ON 43
eH2_4                 1.199927e-02 1 1  ON 44
eH2_5                 4.603963e-02 1 1  ON 45
eH2_6                 1.020783e-01 1 1  ON 46
eH2_7                 1.493226e-01 1 1  ON 47
eH2_8                 1.660357e-01 1 1  ON 48
eH2_9                 2.949596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.7936
    reference variance = 0.761168
====================================================
  Execution time = 2.2784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3564e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335611756371
                                         uncertainty =       0.003120732575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335611756371
                                         uncertainty =       0.003120732575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409656861
  error estimate for blocks of size 2^( 2) =       0.000422411650
  error estimate for blocks of size 2^( 3) =       0.000435805377
  error estimate for blocks of size 2^( 4) =       0.000447694651
  error estimate for blocks of size 2^( 5) =       0.000458515683
  error estimate for blocks of size 2^( 6) =       0.000466599021
  error estimate for blocks of size 2^( 7) =       0.000472444714

      target function =                  N/A
              le_mean =     -16.905051024193
             les_mean =     286.116387450927
             stat err =       0.000461313517
             autocorr =       1.268095303695
              std dev =       0.579342289304
             le_variance =       0.335637488176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505102419e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905051024193       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905051067988       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905052118921       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905052402313       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905054830772       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905055475951       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905056998836       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905058582850       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905057670604       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905057695287       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905057577565       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.151847e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905051024193       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905051048971       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905051659573       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905051919366       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905052798830       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905052845592       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905053257745       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905053259290       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905053185738       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.451312e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905051024193       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905051033247       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905051262909       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905051366943       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905051596172       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905051683701       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905051706966       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905051697589       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.363896e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8348e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.079121e-01 1 1  ON 0
 uu_1                 1.415195e-01 1 1  ON 1
 uu_2                 4.031983e-02 1 1  ON 2
 uu_3                -2.112560e-02 1 1  ON 3
 uu_4                -6.502560e-02 1 1  ON 4
 uu_5                -9.755299e-02 1 1  ON 5
 uu_6                -1.236115e-01 1 1  ON 6
 uu_7                -1.358511e-01 1 1  ON 7
 uu_8                -1.274081e-01 1 1  ON 8
 uu_9                -9.758104e-02 1 1  ON 9
 ud_0                 4.443325e-01 1 1  ON 10
 ud_1                 1.786921e-01 1 1  ON 11
 ud_2                 5.906597e-02 1 1  ON 12
 ud_3                -1.154649e-02 1 1  ON 13
 ud_4                -6.779442e-02 1 1  ON 14
 ud_5                -1.077402e-01 1 1  ON 15
 ud_6                -1.339824e-01 1 1  ON 16
 ud_7                -1.490781e-01 1 1  ON 17
 ud_8                -1.489318e-01 1 1  ON 18
 ud_9                -1.366730e-01 1 1  ON 19
 eO_0                -7.583688e-01 1 1  ON 20
 eO_1                -4.378849e-01 1 1  ON 21
 eO_2                -1.687869e-02 1 1  ON 22
 eO_3                 3.018948e-01 1 1  ON 23
 eO_4                 5.197646e-01 1 1  ON 24
 eO_5                 4.747747e-01 1 1  ON 25
 eO_6                 2.438851e-01 1 1  ON 26
 eO_7                -5.251755e-02 1 1  ON 27
 eO_8                -2.087037e-01 1 1  ON 28
 eO_9                -6.750606e-02 1 1  ON 29
eH1_0                -2.347667e-01 1 1  ON 30
eH1_1                -1.363318e-01 1 1  ON 31
eH1_2                -9.118441e-02 1 1  ON 32
eH1_3                -3.806292e-02 1 1  ON 33
eH1_4                 8.891024e-03 1 1  ON 34
eH1_5                 4.279763e-02 1 1  ON 35
eH1_6                 9.869784e-02 1 1  ON 36
eH1_7                 1.474251e-01 1 1  ON 37
eH1_8                 1.609305e-01 1 1  ON 38
eH1_9                 4.594652e-02 1 1  ON 39
eH2_0                -2.318647e-01 1 1  ON 40
eH2_1                -1.332316e-01 1 1  ON 41
eH2_2                -8.786908e-02 1 1  ON 42
eH2_3                -3.501804e-02 1 1  ON 43
eH2_4                 1.175100e-02 1 1  ON 44
eH2_5                 4.604893e-02 1 1  ON 45
eH2_6                 1.019242e-01 1 1  ON 46
eH2_7                 1.494783e-01 1 1  ON 47
eH2_8                 1.663611e-01 1 1  ON 48
eH2_9                 3.004069e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.341064
====================================================
  Execution time = 2.0363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.0000e+06
  Execution time = 1.9086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343351158458
                                         uncertainty =       0.009010216222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343351158458
                                         uncertainty =       0.009010216222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414332565
  error estimate for blocks of size 2^( 2) =       0.000427514578
  error estimate for blocks of size 2^( 3) =       0.000440260974
  error estimate for blocks of size 2^( 4) =       0.000451599269
  error estimate for blocks of size 2^( 5) =       0.000461657769
  error estimate for blocks of size 2^( 6) =       0.000470042322
  error estimate for blocks of size 2^( 7) =       0.000473600998

      target function =                  N/A
              le_mean =     -16.905427966604
             les_mean =     286.136837510478
             stat err =       0.000464225089
             autocorr =       1.255333390979
              std dev =       0.585954732129
             le_variance =       0.343342948104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343706319222
                                         uncertainty =       0.009048857417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343706319222
                                         uncertainty =       0.009048857417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414546676
  error estimate for blocks of size 2^( 2) =       0.000427725028
  error estimate for blocks of size 2^( 3) =       0.000440455219
  error estimate for blocks of size 2^( 4) =       0.000451772566
  error estimate for blocks of size 2^( 5) =       0.000461819825
  error estimate for blocks of size 2^( 6) =       0.000470199102
  error estimate for blocks of size 2^( 7) =       0.000473745125

      target function =                  N/A
              le_mean =     -16.905427401144
             les_mean =     286.137173336486
             stat err =       0.000464384155
             autocorr =       1.254896508933
              std dev =       0.586257531292
             le_variance =       0.343697892997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343566520213
                                         uncertainty =       0.009040957439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343566520213
                                         uncertainty =       0.009040957439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414462289
  error estimate for blocks of size 2^( 2) =       0.000427643399
  error estimate for blocks of size 2^( 3) =       0.000440378464
  error estimate for blocks of size 2^( 4) =       0.000451703670
  error estimate for blocks of size 2^( 5) =       0.000461759079
  error estimate for blocks of size 2^( 6) =       0.000470146509
  error estimate for blocks of size 2^( 7) =       0.000473697751

      target function =                  N/A
              le_mean =     -16.905427152929
             les_mean =     286.137025028872
             stat err =       0.000464326752
             autocorr =       1.255097229133
              std dev =       0.586138189897
             le_variance =       0.343557977656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343384381936
                                         uncertainty =       0.009015590738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343384381936
                                         uncertainty =       0.009015590738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414352569
  error estimate for blocks of size 2^( 2) =       0.000427534520
  error estimate for blocks of size 2^( 3) =       0.000440279108
  error estimate for blocks of size 2^( 4) =       0.000451615481
  error estimate for blocks of size 2^( 5) =       0.000461673960
  error estimate for blocks of size 2^( 6) =       0.000470059826
  error estimate for blocks of size 2^( 7) =       0.000473617412

      target function =                  N/A
              le_mean =     -16.905427597666
             les_mean =     286.136858190537
             stat err =       0.000464241670
             autocorr =       1.255301847259
              std dev =       0.585983022190
             le_variance =       0.343376102295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905427966604        initial  <--
     9.7656e-02     9.7656e-01             2.1518e-03       -16.905427401144
     3.9062e-01     3.9062e+00             5.4513e-04       -16.905427152929
     1.5625e+00     1.5625e+01             1.3639e-04       -16.905427597666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9778
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414880e-01 1 1  ON 1
 uu_2                 4.040635e-02 1 1  ON 2
 uu_3                -2.117537e-02 1 1  ON 3
 uu_4                -6.482458e-02 1 1  ON 4
 uu_5                -9.747404e-02 1 1  ON 5
 uu_6                -1.234248e-01 1 1  ON 6
 uu_7                -1.357622e-01 1 1  ON 7
 uu_8                -1.274485e-01 1 1  ON 8
 uu_9                -9.751845e-02 1 1  ON 9
 ud_0                 4.441886e-01 1 1  ON 10
 ud_1                 1.786025e-01 1 1  ON 11
 ud_2                 5.889887e-02 1 1  ON 12
 ud_3                -1.150240e-02 1 1  ON 13
 ud_4                -6.774011e-02 1 1  ON 14
 ud_5                -1.076667e-01 1 1  ON 15
 ud_6                -1.339897e-01 1 1  ON 16
 ud_7                -1.490528e-01 1 1  ON 17
 ud_8                -1.486567e-01 1 1  ON 18
 ud_9                -1.365675e-01 1 1  ON 19
 eO_0                -7.579610e-01 1 1  ON 20
 eO_1                -4.374963e-01 1 1  ON 21
 eO_2                -1.674161e-02 1 1  ON 22
 eO_3                 3.017884e-01 1 1  ON 23
 eO_4                 5.193328e-01 1 1  ON 24
 eO_5                 4.742296e-01 1 1  ON 25
 eO_6                 2.434498e-01 1 1  ON 26
 eO_7                -5.259450e-02 1 1  ON 27
 eO_8                -2.083682e-01 1 1  ON 28
 eO_9                -6.721678e-02 1 1  ON 29
eH1_0                -2.347011e-01 1 1  ON 30
eH1_1                -1.361531e-01 1 1  ON 31
eH1_2                -9.077639e-02 1 1  ON 32
eH1_3                -3.803799e-02 1 1  ON 33
eH1_4                 9.031517e-03 1 1  ON 34
eH1_5                 4.302994e-02 1 1  ON 35
eH1_6                 9.881600e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604188e-01 1 1  ON 38
eH1_9                 4.549592e-02 1 1  ON 39
eH2_0                -2.317571e-01 1 1  ON 40
eH2_1                -1.330640e-01 1 1  ON 41
eH2_2                -8.771866e-02 1 1  ON 42
eH2_3                -3.473601e-02 1 1  ON 43
eH2_4                 1.199927e-02 1 1  ON 44
eH2_5                 4.603963e-02 1 1  ON 45
eH2_6                 1.020783e-01 1 1  ON 46
eH2_7                 1.493226e-01 1 1  ON 47
eH2_8                 1.660357e-01 1 1  ON 48
eH2_9                 2.949596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.203518
====================================================
  Execution time = 2.0829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5710e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357122772145
                                         uncertainty =       0.012486785417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357122772145
                                         uncertainty =       0.012486785417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422549697
  error estimate for blocks of size 2^( 2) =       0.000434731689
  error estimate for blocks of size 2^( 3) =       0.000447541326
  error estimate for blocks of size 2^( 4) =       0.000460103314
  error estimate for blocks of size 2^( 5) =       0.000469334960
  error estimate for blocks of size 2^( 6) =       0.000477724614
  error estimate for blocks of size 2^( 7) =       0.000484953321

      target function =                  N/A
              le_mean =     -16.906114405990
             les_mean =     286.173800621916
             stat err =       0.000473029052
             autocorr =       1.253199004017
              std dev =       0.597575511581
             le_variance =       0.357096492042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611440599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114405990       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114684486       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114346222       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114374792       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114773390       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906115195312       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906115399065       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906115410727       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906115378109       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.570015e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114405990       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114488950       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114390543       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114397495       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114465564       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114568478       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114609295       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114620111       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.719901e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114405990       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114427773       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114402188       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114403958       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114418328       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114443794       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114452772       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114455691       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.695345e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6436e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.078919e-01 1 1  ON 0
 uu_1                 1.414903e-01 1 1  ON 1
 uu_2                 4.042569e-02 1 1  ON 2
 uu_3                -2.116641e-02 1 1  ON 3
 uu_4                -6.481199e-02 1 1  ON 4
 uu_5                -9.749187e-02 1 1  ON 5
 uu_6                -1.234242e-01 1 1  ON 6
 uu_7                -1.357807e-01 1 1  ON 7
 uu_8                -1.274585e-01 1 1  ON 8
 uu_9                -9.754568e-02 1 1  ON 9
 ud_0                 4.441966e-01 1 1  ON 10
 ud_1                 1.786491e-01 1 1  ON 11
 ud_2                 5.891589e-02 1 1  ON 12
 ud_3                -1.150909e-02 1 1  ON 13
 ud_4                -6.775303e-02 1 1  ON 14
 ud_5                -1.076723e-01 1 1  ON 15
 ud_6                -1.339893e-01 1 1  ON 16
 ud_7                -1.490632e-01 1 1  ON 17
 ud_8                -1.486850e-01 1 1  ON 18
 ud_9                -1.365773e-01 1 1  ON 19
 eO_0                -7.580119e-01 1 1  ON 20
 eO_1                -4.375472e-01 1 1  ON 21
 eO_2                -1.672709e-02 1 1  ON 22
 eO_3                 3.018002e-01 1 1  ON 23
 eO_4                 5.194000e-01 1 1  ON 24
 eO_5                 4.742730e-01 1 1  ON 25
 eO_6                 2.434760e-01 1 1  ON 26
 eO_7                -5.258200e-02 1 1  ON 27
 eO_8                -2.084046e-01 1 1  ON 28
 eO_9                -6.725013e-02 1 1  ON 29
eH1_0                -2.347307e-01 1 1  ON 30
eH1_1                -1.361968e-01 1 1  ON 31
eH1_2                -9.080595e-02 1 1  ON 32
eH1_3                -3.805341e-02 1 1  ON 33
eH1_4                 9.006103e-03 1 1  ON 34
eH1_5                 4.301700e-02 1 1  ON 35
eH1_6                 9.881340e-02 1 1  ON 36
eH1_7                 1.472818e-01 1 1  ON 37
eH1_8                 1.604766e-01 1 1  ON 38
eH1_9                 4.555361e-02 1 1  ON 39
eH2_0                -2.317461e-01 1 1  ON 40
eH2_1                -1.331050e-01 1 1  ON 41
eH2_2                -8.776056e-02 1 1  ON 42
eH2_3                -3.474503e-02 1 1  ON 43
eH2_4                 1.198973e-02 1 1  ON 44
eH2_5                 4.605220e-02 1 1  ON 45
eH2_6                 1.020843e-01 1 1  ON 46
eH2_7                 1.493154e-01 1 1  ON 47
eH2_8                 1.660668e-01 1 1  ON 48
eH2_9                 2.954457e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.420289
====================================================
  Execution time = 2.0497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4617e-01
  Total weights = 2.0000e+06
  Execution time = 1.9436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346227143440
                                         uncertainty =       0.008496570069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346227143440
                                         uncertainty =       0.008496570069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416045842
  error estimate for blocks of size 2^( 2) =       0.000428692502
  error estimate for blocks of size 2^( 3) =       0.000441738263
  error estimate for blocks of size 2^( 4) =       0.000453462184
  error estimate for blocks of size 2^( 5) =       0.000462930765
  error estimate for blocks of size 2^( 6) =       0.000471982176
  error estimate for blocks of size 2^( 7) =       0.000478914594

      target function =                  N/A
              le_mean =     -16.905685927915
             les_mean =     286.148404805378
             stat err =       0.000466822430
             autocorr =       1.258986455700
              std dev =       0.588377672208
             le_variance =       0.346188285153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346197332817
                                         uncertainty =       0.008496099537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346197332817
                                         uncertainty =       0.008496099537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416027970
  error estimate for blocks of size 2^( 2) =       0.000428674725
  error estimate for blocks of size 2^( 3) =       0.000441718586
  error estimate for blocks of size 2^( 4) =       0.000453439892
  error estimate for blocks of size 2^( 5) =       0.000462908339
  error estimate for blocks of size 2^( 6) =       0.000471962235
  error estimate for blocks of size 2^( 7) =       0.000478890653

      target function =                  N/A
              le_mean =     -16.905685631460
             les_mean =     286.148365040210
             stat err =       0.000466800280
             autocorr =       1.258975144980
              std dev =       0.588352397394
             le_variance =       0.346158543519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346187964036
                                         uncertainty =       0.008495665382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346187964036
                                         uncertainty =       0.008495665382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416022326
  error estimate for blocks of size 2^( 2) =       0.000428669595
  error estimate for blocks of size 2^( 3) =       0.000441714858
  error estimate for blocks of size 2^( 4) =       0.000453437696
  error estimate for blocks of size 2^( 5) =       0.000462906750
  error estimate for blocks of size 2^( 6) =       0.000471959709
  error estimate for blocks of size 2^( 7) =       0.000478890184

      target function =                  N/A
              le_mean =     -16.905685735722
             les_mean =     286.148359174133
             stat err =       0.000466798585
             autocorr =       1.259000158302
              std dev =       0.588344416315
             le_variance =       0.346149152209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346221334407
                                         uncertainty =       0.008496440193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346221334407
                                         uncertainty =       0.008496440193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416042355
  error estimate for blocks of size 2^( 2) =       0.000428689110
  error estimate for blocks of size 2^( 3) =       0.000441734821
  error estimate for blocks of size 2^( 4) =       0.000453458614
  error estimate for blocks of size 2^( 5) =       0.000462927272
  error estimate for blocks of size 2^( 6) =       0.000471978884
  error estimate for blocks of size 2^( 7) =       0.000478911048

      target function =                  N/A
              le_mean =     -16.905685900718
             les_mean =     286.148398083022
             stat err =       0.000466818954
             autocorr =       1.258988811967
              std dev =       0.588372741015
             le_variance =       0.346182482370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905685927915        initial  <--
     9.7656e-01     9.7656e+00             2.5700e-04       -16.905685631460
     3.9062e+00     3.9062e+01             6.7199e-05       -16.905685735722
     1.5625e+01     1.5625e+02             1.6953e-05       -16.905685900718

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1073
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414880e-01 1 1  ON 1
 uu_2                 4.040635e-02 1 1  ON 2
 uu_3                -2.117537e-02 1 1  ON 3
 uu_4                -6.482458e-02 1 1  ON 4
 uu_5                -9.747404e-02 1 1  ON 5
 uu_6                -1.234248e-01 1 1  ON 6
 uu_7                -1.357622e-01 1 1  ON 7
 uu_8                -1.274485e-01 1 1  ON 8
 uu_9                -9.751845e-02 1 1  ON 9
 ud_0                 4.441886e-01 1 1  ON 10
 ud_1                 1.786025e-01 1 1  ON 11
 ud_2                 5.889887e-02 1 1  ON 12
 ud_3                -1.150240e-02 1 1  ON 13
 ud_4                -6.774011e-02 1 1  ON 14
 ud_5                -1.076667e-01 1 1  ON 15
 ud_6                -1.339897e-01 1 1  ON 16
 ud_7                -1.490528e-01 1 1  ON 17
 ud_8                -1.486567e-01 1 1  ON 18
 ud_9                -1.365675e-01 1 1  ON 19
 eO_0                -7.579610e-01 1 1  ON 20
 eO_1                -4.374963e-01 1 1  ON 21
 eO_2                -1.674161e-02 1 1  ON 22
 eO_3                 3.017884e-01 1 1  ON 23
 eO_4                 5.193328e-01 1 1  ON 24
 eO_5                 4.742296e-01 1 1  ON 25
 eO_6                 2.434498e-01 1 1  ON 26
 eO_7                -5.259450e-02 1 1  ON 27
 eO_8                -2.083682e-01 1 1  ON 28
 eO_9                -6.721678e-02 1 1  ON 29
eH1_0                -2.347011e-01 1 1  ON 30
eH1_1                -1.361531e-01 1 1  ON 31
eH1_2                -9.077639e-02 1 1  ON 32
eH1_3                -3.803799e-02 1 1  ON 33
eH1_4                 9.031517e-03 1 1  ON 34
eH1_5                 4.302994e-02 1 1  ON 35
eH1_6                 9.881600e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604188e-01 1 1  ON 38
eH1_9                 4.549592e-02 1 1  ON 39
eH2_0                -2.317571e-01 1 1  ON 40
eH2_1                -1.330640e-01 1 1  ON 41
eH2_2                -8.771866e-02 1 1  ON 42
eH2_3                -3.473601e-02 1 1  ON 43
eH2_4                 1.199927e-02 1 1  ON 44
eH2_5                 4.603963e-02 1 1  ON 45
eH2_6                 1.020783e-01 1 1  ON 46
eH2_7                 1.493226e-01 1 1  ON 47
eH2_8                 1.660357e-01 1 1  ON 48
eH2_9                 2.949596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7628
    reference variance = 1.61042
====================================================
  Execution time = 2.1076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333342502643
                                         uncertainty =       0.002389876157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333342502643
                                         uncertainty =       0.002389876157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408256031
  error estimate for blocks of size 2^( 2) =       0.000420757451
  error estimate for blocks of size 2^( 3) =       0.000433925993
  error estimate for blocks of size 2^( 4) =       0.000446907582
  error estimate for blocks of size 2^( 5) =       0.000457501846
  error estimate for blocks of size 2^( 6) =       0.000465551519
  error estimate for blocks of size 2^( 7) =       0.000470599130

      target function =                  N/A
              le_mean =     -16.904558863773
             les_mean =     286.097456185721
             stat err =       0.000460140019
             autocorr =       1.270324852344
              std dev =       0.577361215892
             le_variance =       0.333345973616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690455886377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904558863773       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904558836306       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904558820879       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904558846005       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904558866510       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904558875372       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904558909414       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904558900725       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.926878e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904558863773       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904558856708       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904558852695       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904558858684       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904558863894       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904558866094       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904558874823       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904558872603       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.318472e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904558863773       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904558861994       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904558860981       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904558862458       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904558863766       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904558864315       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904558866511       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904558865955       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.829654e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6617e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.079101e-01 1 1  ON 0
 uu_1                 1.414871e-01 1 1  ON 1
 uu_2                 4.041089e-02 1 1  ON 2
 uu_3                -2.117532e-02 1 1  ON 3
 uu_4                -6.482306e-02 1 1  ON 4
 uu_5                -9.747783e-02 1 1  ON 5
 uu_6                -1.234264e-01 1 1  ON 6
 uu_7                -1.357629e-01 1 1  ON 7
 uu_8                -1.274512e-01 1 1  ON 8
 uu_9                -9.752002e-02 1 1  ON 9
 ud_0                 4.441926e-01 1 1  ON 10
 ud_1                 1.786058e-01 1 1  ON 11
 ud_2                 5.889697e-02 1 1  ON 12
 ud_3                -1.150505e-02 1 1  ON 13
 ud_4                -6.773867e-02 1 1  ON 14
 ud_5                -1.076720e-01 1 1  ON 15
 ud_6                -1.339901e-01 1 1  ON 16
 ud_7                -1.490511e-01 1 1  ON 17
 ud_8                -1.486597e-01 1 1  ON 18
 ud_9                -1.365684e-01 1 1  ON 19
 eO_0                -7.579652e-01 1 1  ON 20
 eO_1                -4.375009e-01 1 1  ON 21
 eO_2                -1.674316e-02 1 1  ON 22
 eO_3                 3.017897e-01 1 1  ON 23
 eO_4                 5.193401e-01 1 1  ON 24
 eO_5                 4.742339e-01 1 1  ON 25
 eO_6                 2.434533e-01 1 1  ON 26
 eO_7                -5.259330e-02 1 1  ON 27
 eO_8                -2.083724e-01 1 1  ON 28
 eO_9                -6.721988e-02 1 1  ON 29
eH1_0                -2.347030e-01 1 1  ON 30
eH1_1                -1.361599e-01 1 1  ON 31
eH1_2                -9.077934e-02 1 1  ON 32
eH1_3                -3.803731e-02 1 1  ON 33
eH1_4                 9.030355e-03 1 1  ON 34
eH1_5                 4.303318e-02 1 1  ON 35
eH1_6                 9.881584e-02 1 1  ON 36
eH1_7                 1.472448e-01 1 1  ON 37
eH1_8                 1.604233e-01 1 1  ON 38
eH1_9                 4.549996e-02 1 1  ON 39
eH2_0                -2.317596e-01 1 1  ON 40
eH2_1                -1.330684e-01 1 1  ON 41
eH2_2                -8.772143e-02 1 1  ON 42
eH2_3                -3.473876e-02 1 1  ON 43
eH2_4                 1.199969e-02 1 1  ON 44
eH2_5                 4.603954e-02 1 1  ON 45
eH2_6                 1.020785e-01 1 1  ON 46
eH2_7                 1.493254e-01 1 1  ON 47
eH2_8                 1.660392e-01 1 1  ON 48
eH2_9                 2.950123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9302
    reference variance = 0.229226
====================================================
  Execution time = 2.0595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3544e-01
  Total weights = 2.0000e+06
  Execution time = 1.9098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335391575138
                                         uncertainty =       0.003492252832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335391575138
                                         uncertainty =       0.003492252832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536023
  error estimate for blocks of size 2^( 2) =       0.000422028141
  error estimate for blocks of size 2^( 3) =       0.000435472674
  error estimate for blocks of size 2^( 4) =       0.000447355092
  error estimate for blocks of size 2^( 5) =       0.000456996889
  error estimate for blocks of size 2^( 6) =       0.000465084242
  error estimate for blocks of size 2^( 7) =       0.000468910438

      target function =                  N/A
              le_mean =     -16.905364606341
             les_mean =     286.126791813281
             stat err =       0.000459586665
             autocorr =       1.259362109420
              std dev =       0.579171397505
             le_variance =       0.335439507688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335399679754
                                         uncertainty =       0.003492290670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335399679754
                                         uncertainty =       0.003492290670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409540966
  error estimate for blocks of size 2^( 2) =       0.000422032585
  error estimate for blocks of size 2^( 3) =       0.000435476477
  error estimate for blocks of size 2^( 4) =       0.000447358388
  error estimate for blocks of size 2^( 5) =       0.000456999381
  error estimate for blocks of size 2^( 6) =       0.000465086104
  error estimate for blocks of size 2^( 7) =       0.000468911419

      target function =                  N/A
              le_mean =     -16.905364535222
             les_mean =     286.126797506354
             stat err =       0.000459588823
             autocorr =       1.259343533183
              std dev =       0.579178388195
             le_variance =       0.335447605352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335395546381
                                         uncertainty =       0.003492270172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335395546381
                                         uncertainty =       0.003492270172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409538445
  error estimate for blocks of size 2^( 2) =       0.000422030311
  error estimate for blocks of size 2^( 3) =       0.000435474521
  error estimate for blocks of size 2^( 4) =       0.000447356686
  error estimate for blocks of size 2^( 5) =       0.000456998070
  error estimate for blocks of size 2^( 6) =       0.000465085097
  error estimate for blocks of size 2^( 7) =       0.000468910838

      target function =                  N/A
              le_mean =     -16.905364568363
             les_mean =     286.126794496871
             stat err =       0.000459587673
             autocorr =       1.259352734105
              std dev =       0.579174822765
             le_variance =       0.335443475325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392068196
                                         uncertainty =       0.003492254943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335392068196
                                         uncertainty =       0.003492254943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536323
  error estimate for blocks of size 2^( 2) =       0.000422028410
  error estimate for blocks of size 2^( 3) =       0.000435472903
  error estimate for blocks of size 2^( 4) =       0.000447355289
  error estimate for blocks of size 2^( 5) =       0.000456997034
  error estimate for blocks of size 2^( 6) =       0.000465084346
  error estimate for blocks of size 2^( 7) =       0.000468910485

      target function =                  N/A
              le_mean =     -16.905364601449
             les_mean =     286.126792140487
             stat err =       0.000459586789
             autocorr =       1.259360934832
              std dev =       0.579171822771
             le_variance =       0.335440000292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905364606341        initial  <--
     9.7656e+00     9.7656e+01             2.9269e-05       -16.905364535222
     3.9062e+01     3.9062e+02             7.3185e-06       -16.905364568363
     1.5625e+02     1.5625e+03             1.8297e-06       -16.905364601449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2074
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414880e-01 1 1  ON 1
 uu_2                 4.040635e-02 1 1  ON 2
 uu_3                -2.117537e-02 1 1  ON 3
 uu_4                -6.482458e-02 1 1  ON 4
 uu_5                -9.747404e-02 1 1  ON 5
 uu_6                -1.234248e-01 1 1  ON 6
 uu_7                -1.357622e-01 1 1  ON 7
 uu_8                -1.274485e-01 1 1  ON 8
 uu_9                -9.751845e-02 1 1  ON 9
 ud_0                 4.441886e-01 1 1  ON 10
 ud_1                 1.786025e-01 1 1  ON 11
 ud_2                 5.889887e-02 1 1  ON 12
 ud_3                -1.150240e-02 1 1  ON 13
 ud_4                -6.774011e-02 1 1  ON 14
 ud_5                -1.076667e-01 1 1  ON 15
 ud_6                -1.339897e-01 1 1  ON 16
 ud_7                -1.490528e-01 1 1  ON 17
 ud_8                -1.486567e-01 1 1  ON 18
 ud_9                -1.365675e-01 1 1  ON 19
 eO_0                -7.579610e-01 1 1  ON 20
 eO_1                -4.374963e-01 1 1  ON 21
 eO_2                -1.674161e-02 1 1  ON 22
 eO_3                 3.017884e-01 1 1  ON 23
 eO_4                 5.193328e-01 1 1  ON 24
 eO_5                 4.742296e-01 1 1  ON 25
 eO_6                 2.434498e-01 1 1  ON 26
 eO_7                -5.259450e-02 1 1  ON 27
 eO_8                -2.083682e-01 1 1  ON 28
 eO_9                -6.721678e-02 1 1  ON 29
eH1_0                -2.347011e-01 1 1  ON 30
eH1_1                -1.361531e-01 1 1  ON 31
eH1_2                -9.077639e-02 1 1  ON 32
eH1_3                -3.803799e-02 1 1  ON 33
eH1_4                 9.031517e-03 1 1  ON 34
eH1_5                 4.302994e-02 1 1  ON 35
eH1_6                 9.881600e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604188e-01 1 1  ON 38
eH1_9                 4.549592e-02 1 1  ON 39
eH2_0                -2.317571e-01 1 1  ON 40
eH2_1                -1.330640e-01 1 1  ON 41
eH2_2                -8.771866e-02 1 1  ON 42
eH2_3                -3.473601e-02 1 1  ON 43
eH2_4                 1.199927e-02 1 1  ON 44
eH2_5                 4.603963e-02 1 1  ON 45
eH2_6                 1.020783e-01 1 1  ON 46
eH2_7                 1.493226e-01 1 1  ON 47
eH2_8                 1.660357e-01 1 1  ON 48
eH2_9                 2.949596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9644
    reference variance = 0.532098
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3597e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335959815099
                                         uncertainty =       0.002962175822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335959815099
                                         uncertainty =       0.002962175822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409862400
  error estimate for blocks of size 2^( 2) =       0.000422638617
  error estimate for blocks of size 2^( 3) =       0.000436160283
  error estimate for blocks of size 2^( 4) =       0.000447896326
  error estimate for blocks of size 2^( 5) =       0.000458428853
  error estimate for blocks of size 2^( 6) =       0.000465691897
  error estimate for blocks of size 2^( 7) =       0.000468313767

      target function =                  N/A
              le_mean =     -16.905164299363
             les_mean =     286.120554194255
             stat err =       0.000460082711
             autocorr =       1.260072894691
              std dev =       0.579632964709
             le_variance =       0.335974373777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690516429936e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905164299363       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905164295637       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905164291968       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905164295408       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905164302953       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905164306554       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905164306470       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905164306529       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.340558e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905164299363       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905164298430       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905164297511       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905164298371       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905164300261       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905164301160       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905164301138       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905164301153       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.861134e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905164299363       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905164299130       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905164298900       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905164299115       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905164299589       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905164299811       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905164299809       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905164299808       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.465896e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6511e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.079118e-01 1 1  ON 0
 uu_1                 1.414882e-01 1 1  ON 1
 uu_2                 4.040638e-02 1 1  ON 2
 uu_3                -2.117525e-02 1 1  ON 3
 uu_4                -6.482449e-02 1 1  ON 4
 uu_5                -9.747384e-02 1 1  ON 5
 uu_6                -1.234250e-01 1 1  ON 6
 uu_7                -1.357623e-01 1 1  ON 7
 uu_8                -1.274489e-01 1 1  ON 8
 uu_9                -9.751884e-02 1 1  ON 9
 ud_0                 4.441890e-01 1 1  ON 10
 ud_1                 1.786030e-01 1 1  ON 11
 ud_2                 5.889915e-02 1 1  ON 12
 ud_3                -1.150253e-02 1 1  ON 13
 ud_4                -6.774009e-02 1 1  ON 14
 ud_5                -1.076668e-01 1 1  ON 15
 ud_6                -1.339894e-01 1 1  ON 16
 ud_7                -1.490529e-01 1 1  ON 17
 ud_8                -1.486570e-01 1 1  ON 18
 ud_9                -1.365679e-01 1 1  ON 19
 eO_0                -7.579614e-01 1 1  ON 20
 eO_1                -4.374967e-01 1 1  ON 21
 eO_2                -1.674162e-02 1 1  ON 22
 eO_3                 3.017885e-01 1 1  ON 23
 eO_4                 5.193333e-01 1 1  ON 24
 eO_5                 4.742301e-01 1 1  ON 25
 eO_6                 2.434502e-01 1 1  ON 26
 eO_7                -5.259435e-02 1 1  ON 27
 eO_8                -2.083686e-01 1 1  ON 28
 eO_9                -6.721718e-02 1 1  ON 29
eH1_0                -2.347012e-01 1 1  ON 30
eH1_1                -1.361533e-01 1 1  ON 31
eH1_2                -9.077697e-02 1 1  ON 32
eH1_3                -3.803791e-02 1 1  ON 33
eH1_4                 9.031550e-03 1 1  ON 34
eH1_5                 4.302995e-02 1 1  ON 35
eH1_6                 9.881595e-02 1 1  ON 36
eH1_7                 1.472447e-01 1 1  ON 37
eH1_8                 1.604192e-01 1 1  ON 38
eH1_9                 4.549629e-02 1 1  ON 39
eH2_0                -2.317575e-01 1 1  ON 40
eH2_1                -1.330643e-01 1 1  ON 41
eH2_2                -8.771895e-02 1 1  ON 42
eH2_3                -3.473592e-02 1 1  ON 43
eH2_4                 1.199942e-02 1 1  ON 44
eH2_5                 4.603996e-02 1 1  ON 45
eH2_6                 1.020782e-01 1 1  ON 46
eH2_7                 1.493224e-01 1 1  ON 47
eH2_8                 1.660359e-01 1 1  ON 48
eH2_9                 2.949642e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.257308
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3925e-01
  Total weights = 2.0000e+06
  Execution time = 1.9122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254344648
                                         uncertainty =       0.009415917445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254344648
                                         uncertainty =       0.009415917445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411856874
  error estimate for blocks of size 2^( 2) =       0.000424869395
  error estimate for blocks of size 2^( 3) =       0.000437922461
  error estimate for blocks of size 2^( 4) =       0.000450525188
  error estimate for blocks of size 2^( 5) =       0.000460864425
  error estimate for blocks of size 2^( 6) =       0.000467726999
  error estimate for blocks of size 2^( 7) =       0.000472696863

      target function =                  N/A
              le_mean =     -16.905292123231
             les_mean =     286.128153771327
             stat err =       0.000462953369
             autocorr =       1.263519240268
              std dev =       0.582453576840
             le_variance =       0.339252169173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339255092568
                                         uncertainty =       0.009415956225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339255092568
                                         uncertainty =       0.009415956225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411857327
  error estimate for blocks of size 2^( 2) =       0.000424869805
  error estimate for blocks of size 2^( 3) =       0.000437922802
  error estimate for blocks of size 2^( 4) =       0.000450525485
  error estimate for blocks of size 2^( 5) =       0.000460864692
  error estimate for blocks of size 2^( 6) =       0.000467727262
  error estimate for blocks of size 2^( 7) =       0.000472697089

      target function =                  N/A
              le_mean =     -16.905292139618
             les_mean =     286.128155072224
             stat err =       0.000462953632
             autocorr =       1.263517897646
              std dev =       0.582454217950
             le_variance =       0.339252916008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254718214
                                         uncertainty =       0.009415936867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254718214
                                         uncertainty =       0.009415936867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411857100
  error estimate for blocks of size 2^( 2) =       0.000424869600
  error estimate for blocks of size 2^( 3) =       0.000437922631
  error estimate for blocks of size 2^( 4) =       0.000450525337
  error estimate for blocks of size 2^( 5) =       0.000460864558
  error estimate for blocks of size 2^( 6) =       0.000467727130
  error estimate for blocks of size 2^( 7) =       0.000472696975

      target function =                  N/A
              le_mean =     -16.905292131437
             les_mean =     286.128154421784
             stat err =       0.000462953500
             autocorr =       1.263518568701
              std dev =       0.582453897056
             le_variance =       0.339252542196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254391330
                                         uncertainty =       0.009415919874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254391330
                                         uncertainty =       0.009415919874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411856902
  error estimate for blocks of size 2^( 2) =       0.000424869421
  error estimate for blocks of size 2^( 3) =       0.000437922482
  error estimate for blocks of size 2^( 4) =       0.000450525207
  error estimate for blocks of size 2^( 5) =       0.000460864441
  error estimate for blocks of size 2^( 6) =       0.000467727015
  error estimate for blocks of size 2^( 7) =       0.000472696877

      target function =                  N/A
              le_mean =     -16.905292124257
             les_mean =     286.128153852624
             stat err =       0.000462953385
             autocorr =       1.263519156314
              std dev =       0.582453616854
             le_variance =       0.339252215787


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905292123231        initial
     9.7656e+01     9.7656e+02             2.3406e-06       -16.905292139618  <--
     3.9062e+02     3.9062e+03             5.8611e-07       -16.905292131437
     1.5625e+03     1.5625e+04             1.4659e-07       -16.905292124257

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9957e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.079117e-01 1 1  ON 0
 uu_1                 1.414889e-01 1 1  ON 1
 uu_2                 4.040645e-02 1 1  ON 2
 uu_3                -2.117488e-02 1 1  ON 3
 uu_4                -6.482425e-02 1 1  ON 4
 uu_5                -9.747326e-02 1 1  ON 5
 uu_6                -1.234259e-01 1 1  ON 6
 uu_7                -1.357627e-01 1 1  ON 7
 uu_8                -1.274500e-01 1 1  ON 8
 uu_9                -9.752002e-02 1 1  ON 9
 ud_0                 4.441903e-01 1 1  ON 10
 ud_1                 1.786043e-01 1 1  ON 11
 ud_2                 5.889998e-02 1 1  ON 12
 ud_3                -1.150293e-02 1 1  ON 13
 ud_4                -6.774005e-02 1 1  ON 14
 ud_5                -1.076669e-01 1 1  ON 15
 ud_6                -1.339887e-01 1 1  ON 16
 ud_7                -1.490532e-01 1 1  ON 17
 ud_8                -1.486582e-01 1 1  ON 18
 ud_9                -1.365691e-01 1 1  ON 19
 eO_0                -7.579626e-01 1 1  ON 20
 eO_1                -4.374978e-01 1 1  ON 21
 eO_2                -1.674167e-02 1 1  ON 22
 eO_3                 3.017888e-01 1 1  ON 23
 eO_4                 5.193350e-01 1 1  ON 24
 eO_5                 4.742317e-01 1 1  ON 25
 eO_6                 2.434514e-01 1 1  ON 26
 eO_7                -5.259392e-02 1 1  ON 27
 eO_8                -2.083700e-01 1 1  ON 28
 eO_9                -6.721839e-02 1 1  ON 29
eH1_0                -2.347016e-01 1 1  ON 30
eH1_1                -1.361540e-01 1 1  ON 31
eH1_2                -9.077873e-02 1 1  ON 32
eH1_3                -3.803769e-02 1 1  ON 33
eH1_4                 9.031650e-03 1 1  ON 34
eH1_5                 4.302997e-02 1 1  ON 35
eH1_6                 9.881582e-02 1 1  ON 36
eH1_7                 1.472451e-01 1 1  ON 37
eH1_8                 1.604204e-01 1 1  ON 38
eH1_9                 4.549742e-02 1 1  ON 39
eH2_0                -2.317586e-01 1 1  ON 40
eH2_1                -1.330651e-01 1 1  ON 41
eH2_2                -8.771981e-02 1 1  ON 42
eH2_3                -3.473564e-02 1 1  ON 43
eH2_4                 1.199987e-02 1 1  ON 44
eH2_5                 4.604094e-02 1 1  ON 45
eH2_6                 1.020777e-01 1 1  ON 46
eH2_7                 1.493219e-01 1 1  ON 47
eH2_8                 1.660366e-01 1 1  ON 48
eH2_9                 2.949783e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9993
    reference variance = 0.275526
====================================================
  Execution time = 2.1424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336455232293
                                         uncertainty =       0.003391958916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336455232293
                                         uncertainty =       0.003391958916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410159453
  error estimate for blocks of size 2^( 2) =       0.000422710149
  error estimate for blocks of size 2^( 3) =       0.000435887270
  error estimate for blocks of size 2^( 4) =       0.000447970791
  error estimate for blocks of size 2^( 5) =       0.000458235691
  error estimate for blocks of size 2^( 6) =       0.000466406585
  error estimate for blocks of size 2^( 7) =       0.000471352481

      target function =                  N/A
              le_mean =     -16.905355935860
             les_mean =     286.127520704433
             stat err =       0.000460991387
             autocorr =       1.263223427429
              std dev =       0.580053061837
             le_variance =       0.336461554547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690535593586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905355935860       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905355934916       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905355931809       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905355927433       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905355935610       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905355939457       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905355939145       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905355938559       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.141255e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905355935860       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905355935622       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905355934840       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905355933718       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905355935772       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905355936737       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905355936648       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905355936509       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.855169e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905355935860       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905355935800       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905355935604       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905355935322       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905355935836       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905355936078       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905355936055       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905355936019       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 7.139206e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8842e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.079114e-01 1 1  ON 0
 uu_1                 1.414885e-01 1 1  ON 1
 uu_2                 4.040705e-02 1 1  ON 2
 uu_3                -2.117461e-02 1 1  ON 3
 uu_4                -6.482479e-02 1 1  ON 4
 uu_5                -9.747394e-02 1 1  ON 5
 uu_6                -1.234260e-01 1 1  ON 6
 uu_7                -1.357632e-01 1 1  ON 7
 uu_8                -1.274511e-01 1 1  ON 8
 uu_9                -9.752051e-02 1 1  ON 9
 ud_0                 4.441923e-01 1 1  ON 10
 ud_1                 1.786049e-01 1 1  ON 11
 ud_2                 5.890057e-02 1 1  ON 12
 ud_3                -1.150377e-02 1 1  ON 13
 ud_4                -6.773982e-02 1 1  ON 14
 ud_5                -1.076677e-01 1 1  ON 15
 ud_6                -1.339884e-01 1 1  ON 16
 ud_7                -1.490539e-01 1 1  ON 17
 ud_8                -1.486596e-01 1 1  ON 18
 ud_9                -1.365703e-01 1 1  ON 19
 eO_0                -7.579647e-01 1 1  ON 20
 eO_1                -4.374991e-01 1 1  ON 21
 eO_2                -1.674246e-02 1 1  ON 22
 eO_3                 3.017894e-01 1 1  ON 23
 eO_4                 5.193378e-01 1 1  ON 24
 eO_5                 4.742329e-01 1 1  ON 25
 eO_6                 2.434534e-01 1 1  ON 26
 eO_7                -5.259332e-02 1 1  ON 27
 eO_8                -2.083717e-01 1 1  ON 28
 eO_9                -6.721965e-02 1 1  ON 29
eH1_0                -2.347024e-01 1 1  ON 30
eH1_1                -1.361546e-01 1 1  ON 31
eH1_2                -9.077995e-02 1 1  ON 32
eH1_3                -3.803744e-02 1 1  ON 33
eH1_4                 9.031193e-03 1 1  ON 34
eH1_5                 4.302993e-02 1 1  ON 35
eH1_6                 9.881547e-02 1 1  ON 36
eH1_7                 1.472445e-01 1 1  ON 37
eH1_8                 1.604217e-01 1 1  ON 38
eH1_9                 4.549944e-02 1 1  ON 39
eH2_0                -2.317600e-01 1 1  ON 40
eH2_1                -1.330671e-01 1 1  ON 41
eH2_2                -8.772072e-02 1 1  ON 42
eH2_3                -3.473653e-02 1 1  ON 43
eH2_4                 1.200078e-02 1 1  ON 44
eH2_5                 4.604104e-02 1 1  ON 45
eH2_6                 1.020774e-01 1 1  ON 46
eH2_7                 1.493228e-01 1 1  ON 47
eH2_8                 1.660385e-01 1 1  ON 48
eH2_9                 2.949964e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.241186
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4613e-01
  Total weights = 2.0000e+06
  Execution time = 1.9099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346087483613
                                         uncertainty =       0.005626451034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346087483613
                                         uncertainty =       0.005626451034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416007556
  error estimate for blocks of size 2^( 2) =       0.000428202477
  error estimate for blocks of size 2^( 3) =       0.000440946938
  error estimate for blocks of size 2^( 4) =       0.000452790349
  error estimate for blocks of size 2^( 5) =       0.000461759834
  error estimate for blocks of size 2^( 6) =       0.000469310445
  error estimate for blocks of size 2^( 7) =       0.000474741475

      target function =                  N/A
              le_mean =     -16.905961943582
             les_mean =     286.157673638655
             stat err =       0.000464650526
             autocorr =       1.247528360297
              std dev =       0.588323528241
             le_variance =       0.346124573882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346091612723
                                         uncertainty =       0.005626463867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346091612723
                                         uncertainty =       0.005626463867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416010036
  error estimate for blocks of size 2^( 2) =       0.000428204846
  error estimate for blocks of size 2^( 3) =       0.000440949148
  error estimate for blocks of size 2^( 4) =       0.000452792419
  error estimate for blocks of size 2^( 5) =       0.000461761805
  error estimate for blocks of size 2^( 6) =       0.000469312305
  error estimate for blocks of size 2^( 7) =       0.000474743396

      target function =                  N/A
              le_mean =     -16.905961946009
             les_mean =     286.157677847094
             stat err =       0.000464652482
             autocorr =       1.247523989929
              std dev =       0.588327035124
             le_variance =       0.346128700258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346089559371
                                         uncertainty =       0.005626457420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346089559371
                                         uncertainty =       0.005626457420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416008803
  error estimate for blocks of size 2^( 2) =       0.000428203668
  error estimate for blocks of size 2^( 3) =       0.000440948049
  error estimate for blocks of size 2^( 4) =       0.000452791391
  error estimate for blocks of size 2^( 5) =       0.000461760826
  error estimate for blocks of size 2^( 6) =       0.000469311381
  error estimate for blocks of size 2^( 7) =       0.000474742442

      target function =                  N/A
              le_mean =     -16.905961944832
             les_mean =     286.157675755308
             stat err =       0.000464651510
             autocorr =       1.247526167942
              std dev =       0.588325291186
             le_variance =       0.346126648249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346087743399
                                         uncertainty =       0.005626451831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346087743399
                                         uncertainty =       0.005626451831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416007712
  error estimate for blocks of size 2^( 2) =       0.000428202626
  error estimate for blocks of size 2^( 3) =       0.000440947077
  error estimate for blocks of size 2^( 4) =       0.000452790479
  error estimate for blocks of size 2^( 5) =       0.000461759958
  error estimate for blocks of size 2^( 6) =       0.000469310562
  error estimate for blocks of size 2^( 7) =       0.000474741596

      target function =                  N/A
              le_mean =     -16.905961943736
             les_mean =     286.157673903478
             stat err =       0.000464650649
             autocorr =       1.247528086036
              std dev =       0.588323748878
             le_variance =       0.346124833493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905961943582        initial
     2.4414e+01     2.4414e+02             1.1413e-05       -16.905961946009  <--
     9.7656e+01     9.7656e+02             2.8552e-06       -16.905961944832
     3.9062e+02     3.9062e+03             7.1392e-07       -16.905961943736

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.0438e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040883e-02 1 1  ON 2
 uu_3                -2.117379e-02 1 1  ON 3
 uu_4                -6.482640e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752198e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434595e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083769e-01 1 1  ON 28
 eO_9                -6.722344e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078361e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029833e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604256e-01 1 1  ON 38
eH1_9                 4.550550e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950509e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.178289
====================================================
  Execution time = 2.3302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337356350930
                                         uncertainty =       0.003292634393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337356350930
                                         uncertainty =       0.003292634393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410740346
  error estimate for blocks of size 2^( 2) =       0.000423416038
  error estimate for blocks of size 2^( 3) =       0.000436406404
  error estimate for blocks of size 2^( 4) =       0.000448653838
  error estimate for blocks of size 2^( 5) =       0.000458678747
  error estimate for blocks of size 2^( 6) =       0.000465619564
  error estimate for blocks of size 2^( 7) =       0.000468396417

      target function =                  N/A
              le_mean =     -16.906882355914
             les_mean =     286.180086091352
             stat err =       0.000460337142
             autocorr =       1.256080011028
              std dev =       0.580874567660
             le_variance =       0.337415263354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688235591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882355914       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906882632640       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906882794572       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906882828113       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906882792269       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906882786161       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906882796583       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906882828764       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906882821894       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.372099e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882355914       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906882427153       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906882469838       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906882477638       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906882467828       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906882466058       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906882469359       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906882477214       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.130643e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882355914       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906882373857       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906882384675       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906882386585       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906882384079       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906882383618       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906882384489       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906882386442       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.851046e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8876e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.079047e-01 1 1  ON 0
 uu_1                 1.414865e-01 1 1  ON 1
 uu_2                 4.041222e-02 1 1  ON 2
 uu_3                -2.117164e-02 1 1  ON 3
 uu_4                -6.482567e-02 1 1  ON 4
 uu_5                -9.747407e-02 1 1  ON 5
 uu_6                -1.234224e-01 1 1  ON 6
 uu_7                -1.357605e-01 1 1  ON 7
 uu_8                -1.274630e-01 1 1  ON 8
 uu_9                -9.752829e-02 1 1  ON 9
 ud_0                 4.441992e-01 1 1  ON 10
 ud_1                 1.786159e-01 1 1  ON 11
 ud_2                 5.890928e-02 1 1  ON 12
 ud_3                -1.150474e-02 1 1  ON 13
 ud_4                -6.773461e-02 1 1  ON 14
 ud_5                -1.076750e-01 1 1  ON 15
 ud_6                -1.339803e-01 1 1  ON 16
 ud_7                -1.490598e-01 1 1  ON 17
 ud_8                -1.486737e-01 1 1  ON 18
 ud_9                -1.365803e-01 1 1  ON 19
 eO_0                -7.579824e-01 1 1  ON 20
 eO_1                -4.374999e-01 1 1  ON 21
 eO_2                -1.674518e-02 1 1  ON 22
 eO_3                 3.017941e-01 1 1  ON 23
 eO_4                 5.193537e-01 1 1  ON 24
 eO_5                 4.742410e-01 1 1  ON 25
 eO_6                 2.434680e-01 1 1  ON 26
 eO_7                -5.259010e-02 1 1  ON 27
 eO_8                -2.083852e-01 1 1  ON 28
 eO_9                -6.722979e-02 1 1  ON 29
eH1_0                -2.347092e-01 1 1  ON 30
eH1_1                -1.361663e-01 1 1  ON 31
eH1_2                -9.078661e-02 1 1  ON 32
eH1_3                -3.803438e-02 1 1  ON 33
eH1_4                 9.030736e-03 1 1  ON 34
eH1_5                 4.303209e-02 1 1  ON 35
eH1_6                 9.881455e-02 1 1  ON 36
eH1_7                 1.472446e-01 1 1  ON 37
eH1_8                 1.604312e-01 1 1  ON 38
eH1_9                 4.551015e-02 1 1  ON 39
eH2_0                -2.317688e-01 1 1  ON 40
eH2_1                -1.330776e-01 1 1  ON 41
eH2_2                -8.772738e-02 1 1  ON 42
eH2_3                -3.474251e-02 1 1  ON 43
eH2_4                 1.200650e-02 1 1  ON 44
eH2_5                 4.603939e-02 1 1  ON 45
eH2_6                 1.020773e-01 1 1  ON 46
eH2_7                 1.493269e-01 1 1  ON 47
eH2_8                 1.660489e-01 1 1  ON 48
eH2_9                 2.951371e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.191628
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 5.0831e-01
  Total weights = 2.0000e+06
  Execution time = 1.9006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508601096371
                                         uncertainty =       0.165433505727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508601096371
                                         uncertainty =       0.165433505727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504141726
  error estimate for blocks of size 2^( 2) =       0.000514753544
  error estimate for blocks of size 2^( 3) =       0.000525749204
  error estimate for blocks of size 2^( 4) =       0.000536477126
  error estimate for blocks of size 2^( 5) =       0.000545093208
  error estimate for blocks of size 2^( 6) =       0.000551815628
  error estimate for blocks of size 2^( 7) =       0.000558460312

      target function =                  N/A
              le_mean =     -16.905686670723
             les_mean =     286.310559313523
             stat err =       0.000547961569
             autocorr =       1.181394414444
              std dev =       0.712964065719
             le_variance =       0.508317759007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508564658250
                                         uncertainty =       0.165425416460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508564658250
                                         uncertainty =       0.165425416460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504123664
  error estimate for blocks of size 2^( 2) =       0.000514735619
  error estimate for blocks of size 2^( 3) =       0.000525731305
  error estimate for blocks of size 2^( 4) =       0.000536459293
  error estimate for blocks of size 2^( 5) =       0.000545075415
  error estimate for blocks of size 2^( 6) =       0.000551798634
  error estimate for blocks of size 2^( 7) =       0.000558441929

      target function =                  N/A
              le_mean =     -16.905686665799
             les_mean =     286.310522725347
             stat err =       0.000547943818
             autocorr =       1.181402523685
              std dev =       0.712938522815
             le_variance =       0.508281337314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508579868168
                                         uncertainty =       0.165428708199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508579868168
                                         uncertainty =       0.165428708199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504131204
  error estimate for blocks of size 2^( 2) =       0.000514743134
  error estimate for blocks of size 2^( 3) =       0.000525738850
  error estimate for blocks of size 2^( 4) =       0.000536466851
  error estimate for blocks of size 2^( 5) =       0.000545082984
  error estimate for blocks of size 2^( 6) =       0.000551805835
  error estimate for blocks of size 2^( 7) =       0.000558449831

      target function =                  N/A
              le_mean =     -16.905686665326
             les_mean =     286.310537912803
             stat err =       0.000547951375
             autocorr =       1.181399775311
              std dev =       0.712949185263
             le_variance =       0.508296540767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508598383219
                                         uncertainty =       0.165432888716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508598383219
                                         uncertainty =       0.165432888716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504140381
  error estimate for blocks of size 2^( 2) =       0.000514752214
  error estimate for blocks of size 2^( 3) =       0.000525747881
  error estimate for blocks of size 2^( 4) =       0.000536475814
  error estimate for blocks of size 2^( 5) =       0.000545091903
  error estimate for blocks of size 2^( 6) =       0.000551814377
  error estimate for blocks of size 2^( 7) =       0.000558458975

      target function =                  N/A
              le_mean =     -16.905686669789
             les_mean =     286.310556570058
             stat err =       0.000547960267
             autocorr =       1.181395105643
              std dev =       0.712962163883
             le_variance =       0.508315047128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905686670723        initial  <--
     6.1035e+00     6.1035e+01             4.3721e-05       -16.905686665799
     2.4414e+01     2.4414e+02             1.1306e-05       -16.905686665326
     9.7656e+01     9.7656e+02             2.8510e-06       -16.905686669789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8664
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040883e-02 1 1  ON 2
 uu_3                -2.117379e-02 1 1  ON 3
 uu_4                -6.482640e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752198e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434595e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083769e-01 1 1  ON 28
 eO_9                -6.722344e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078361e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029833e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604256e-01 1 1  ON 38
eH1_9                 4.550550e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950509e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.407786
====================================================
  Execution time = 2.1037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342541631102
                                         uncertainty =       0.004213412755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342541631102
                                         uncertainty =       0.004213412755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413793381
  error estimate for blocks of size 2^( 2) =       0.000426204656
  error estimate for blocks of size 2^( 3) =       0.000439351259
  error estimate for blocks of size 2^( 4) =       0.000451421899
  error estimate for blocks of size 2^( 5) =       0.000462405857
  error estimate for blocks of size 2^( 6) =       0.000472695338
  error estimate for blocks of size 2^( 7) =       0.000479649463

      target function =                  N/A
              le_mean =     -16.905914486912
             les_mean =     286.152394392574
             stat err =       0.000466543140
             autocorr =       1.271207759791
              std dev =       0.585192212035
             le_variance =       0.342449925026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591448691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914486912       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914486506       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914484576       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914479450       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905914486061       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905914492502       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905914496918       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905914494849       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.319888e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914486912       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914486810       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914486329       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914485043       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905914486689       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905914488298       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905914489401       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905914488888       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.080249e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914486912       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914486886       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914486766       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914486444       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905914486855       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905914487258       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905914487534       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905914487405       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.700794e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6591e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.079104e-01 1 1  ON 0
 uu_1                 1.414876e-01 1 1  ON 1
 uu_2                 4.040944e-02 1 1  ON 2
 uu_3                -2.117359e-02 1 1  ON 3
 uu_4                -6.482585e-02 1 1  ON 4
 uu_5                -9.747634e-02 1 1  ON 5
 uu_6                -1.234264e-01 1 1  ON 6
 uu_7                -1.357651e-01 1 1  ON 7
 uu_8                -1.274555e-01 1 1  ON 8
 uu_9                -9.752260e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786070e-01 1 1  ON 11
 ud_2                 5.890252e-02 1 1  ON 12
 ud_3                -1.150634e-02 1 1  ON 13
 ud_4                -6.773918e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490554e-01 1 1  ON 17
 ud_8                -1.486640e-01 1 1  ON 18
 ud_9                -1.365742e-01 1 1  ON 19
 eO_0                -7.579721e-01 1 1  ON 20
 eO_1                -4.375036e-01 1 1  ON 21
 eO_2                -1.674489e-02 1 1  ON 22
 eO_3                 3.017914e-01 1 1  ON 23
 eO_4                 5.193475e-01 1 1  ON 24
 eO_5                 4.742373e-01 1 1  ON 25
 eO_6                 2.434603e-01 1 1  ON 26
 eO_7                -5.259134e-02 1 1  ON 27
 eO_8                -2.083777e-01 1 1  ON 28
 eO_9                -6.722406e-02 1 1  ON 29
eH1_0                -2.347051e-01 1 1  ON 30
eH1_1                -1.361572e-01 1 1  ON 31
eH1_2                -9.078446e-02 1 1  ON 32
eH1_3                -3.803647e-02 1 1  ON 33
eH1_4                 9.029795e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881415e-02 1 1  ON 36
eH1_7                 1.472433e-01 1 1  ON 37
eH1_8                 1.604264e-01 1 1  ON 38
eH1_9                 4.550604e-02 1 1  ON 39
eH2_0                -2.317646e-01 1 1  ON 40
eH2_1                -1.330738e-01 1 1  ON 41
eH2_2                -8.772409e-02 1 1  ON 42
eH2_3                -3.473928e-02 1 1  ON 43
eH2_4                 1.200330e-02 1 1  ON 44
eH2_5                 4.604163e-02 1 1  ON 45
eH2_6                 1.020759e-01 1 1  ON 46
eH2_7                 1.493257e-01 1 1  ON 47
eH2_8                 1.660451e-01 1 1  ON 48
eH2_9                 2.950606e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.212677
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3486e-01
  Total weights = 2.0000e+06
  Execution time = 1.9576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566832393
                                         uncertainty =       0.003435305235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566832393
                                         uncertainty =       0.003435305235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409180152
  error estimate for blocks of size 2^( 2) =       0.000422381432
  error estimate for blocks of size 2^( 3) =       0.000435529763
  error estimate for blocks of size 2^( 4) =       0.000448246596
  error estimate for blocks of size 2^( 5) =       0.000458974494
  error estimate for blocks of size 2^( 6) =       0.000468130013
  error estimate for blocks of size 2^( 7) =       0.000472891667

      target function =                  N/A
              le_mean =     -16.905521661146
             les_mean =     286.131519261892
             stat err =       0.000462060692
             autocorr =       1.275172476237
              std dev =       0.578668120649
             le_variance =       0.334856793855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566201972
                                         uncertainty =       0.003435294678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566201972
                                         uncertainty =       0.003435294678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409179766
  error estimate for blocks of size 2^( 2) =       0.000422381038
  error estimate for blocks of size 2^( 3) =       0.000435529323
  error estimate for blocks of size 2^( 4) =       0.000448246117
  error estimate for blocks of size 2^( 5) =       0.000458974015
  error estimate for blocks of size 2^( 6) =       0.000468129547
  error estimate for blocks of size 2^( 7) =       0.000472891146

      target function =                  N/A
              le_mean =     -16.905521647189
             les_mean =     286.131518157264
             stat err =       0.000462060206
             autocorr =       1.275172201407
              std dev =       0.578667573934
             le_variance =       0.334856161123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566512756
                                         uncertainty =       0.003435299894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566512756
                                         uncertainty =       0.003435299894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409179956
  error estimate for blocks of size 2^( 2) =       0.000422381232
  error estimate for blocks of size 2^( 3) =       0.000435529540
  error estimate for blocks of size 2^( 4) =       0.000448246354
  error estimate for blocks of size 2^( 5) =       0.000458974252
  error estimate for blocks of size 2^( 6) =       0.000468129778
  error estimate for blocks of size 2^( 7) =       0.000472891404

      target function =                  N/A
              le_mean =     -16.905521654119
             les_mean =     286.131518703518
             stat err =       0.000462060447
             autocorr =       1.275172342267
              std dev =       0.578667843454
             le_variance =       0.334856473048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566792292
                                         uncertainty =       0.003435304566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333566792292
                                         uncertainty =       0.003435304566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409180128
  error estimate for blocks of size 2^( 2) =       0.000422381407
  error estimate for blocks of size 2^( 3) =       0.000435529735
  error estimate for blocks of size 2^( 4) =       0.000448246566
  error estimate for blocks of size 2^( 5) =       0.000458974464
  error estimate for blocks of size 2^( 6) =       0.000468129983
  error estimate for blocks of size 2^( 7) =       0.000472891634

      target function =                  N/A
              le_mean =     -16.905521660265
             les_mean =     286.131519191864
             stat err =       0.000462060662
             autocorr =       1.275172459595
              std dev =       0.578668085872
             le_variance =       0.334856753607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905521661146        initial  <--
     6.1035e+01     6.1035e+02             4.3199e-06       -16.905521647189
     2.4414e+02     2.4414e+03             1.0802e-06       -16.905521654119
     9.7656e+02     9.7656e+03             2.7008e-07       -16.905521660265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8627
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040883e-02 1 1  ON 2
 uu_3                -2.117379e-02 1 1  ON 3
 uu_4                -6.482640e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752198e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434595e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083769e-01 1 1  ON 28
 eO_9                -6.722344e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078361e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029833e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604256e-01 1 1  ON 38
eH1_9                 4.550550e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950509e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0008
    reference variance = 0.294971
====================================================
  Execution time = 2.0715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.3825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438441260191
                                         uncertainty =       0.095337263657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438441260191
                                         uncertainty =       0.095337263657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468106124
  error estimate for blocks of size 2^( 2) =       0.000479579693
  error estimate for blocks of size 2^( 3) =       0.000491572173
  error estimate for blocks of size 2^( 4) =       0.000502704973
  error estimate for blocks of size 2^( 5) =       0.000512572251
  error estimate for blocks of size 2^( 6) =       0.000519671819
  error estimate for blocks of size 2^( 7) =       0.000525216632

      target function =                  N/A
              le_mean =     -16.905898242970
             les_mean =     286.247641870107
             stat err =       0.000515041419
             autocorr =       1.210586049656
              std dev =       0.662002029877
             le_variance =       0.438246687562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589824297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898242970       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898244084       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898243668       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898243156       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898242173       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898242183       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898242803       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898242995       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.674310e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898242970       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898243249       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898243145       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898243017       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898242771       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898242772       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898242927       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898242978       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.168704e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898242970       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898243040       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898243014       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898242980       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898242940       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898242921       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898242961       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898242985       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.921839e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6308e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040886e-02 1 1  ON 2
 uu_3                -2.117381e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752198e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890237e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773917e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490559e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674487e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722348e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078362e-02 1 1  ON 32
eH1_3                -3.803677e-02 1 1  ON 33
eH1_4                 9.029868e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550557e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772359e-02 1 1  ON 42
eH2_3                -3.473923e-02 1 1  ON 43
eH2_4                 1.200349e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.249813
====================================================
  Execution time = 2.0238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4611e-01
  Total weights = 2.0000e+06
  Execution time = 1.9001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142585554
                                         uncertainty =       0.005274099821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142585554
                                         uncertainty =       0.005274099821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415996553
  error estimate for blocks of size 2^( 2) =       0.000428664639
  error estimate for blocks of size 2^( 3) =       0.000441499367
  error estimate for blocks of size 2^( 4) =       0.000454057135
  error estimate for blocks of size 2^( 5) =       0.000463037722
  error estimate for blocks of size 2^( 6) =       0.000471019554
  error estimate for blocks of size 2^( 7) =       0.000473442392

      target function =                  N/A
              le_mean =     -16.905399212928
             les_mean =     286.138628638903
             stat err =       0.000465389200
             autocorr =       1.251564220361
              std dev =       0.588307966527
             le_variance =       0.346106263480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142706576
                                         uncertainty =       0.005274102227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142706576
                                         uncertainty =       0.005274102227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415996625
  error estimate for blocks of size 2^( 2) =       0.000428664712
  error estimate for blocks of size 2^( 3) =       0.000441499437
  error estimate for blocks of size 2^( 4) =       0.000454057197
  error estimate for blocks of size 2^( 5) =       0.000463037781
  error estimate for blocks of size 2^( 6) =       0.000471019611
  error estimate for blocks of size 2^( 7) =       0.000473442449

      target function =                  N/A
              le_mean =     -16.905399210993
             les_mean =     286.138628694346
             stat err =       0.000465389259
             autocorr =       1.251564100327
              std dev =       0.588308069273
             le_variance =       0.346106384372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142646085
                                         uncertainty =       0.005274101025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142646085
                                         uncertainty =       0.005274101025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415996589
  error estimate for blocks of size 2^( 2) =       0.000428664676
  error estimate for blocks of size 2^( 3) =       0.000441499402
  error estimate for blocks of size 2^( 4) =       0.000454057166
  error estimate for blocks of size 2^( 5) =       0.000463037751
  error estimate for blocks of size 2^( 6) =       0.000471019582
  error estimate for blocks of size 2^( 7) =       0.000473442420

      target function =                  N/A
              le_mean =     -16.905399211960
             les_mean =     286.138628666625
             stat err =       0.000465389230
             autocorr =       1.251564160326
              std dev =       0.588308017917
             le_variance =       0.346106323945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142593121
                                         uncertainty =       0.005274099972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346142593121
                                         uncertainty =       0.005274099972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415996557
  error estimate for blocks of size 2^( 2) =       0.000428664644
  error estimate for blocks of size 2^( 3) =       0.000441499371
  error estimate for blocks of size 2^( 4) =       0.000454057139
  error estimate for blocks of size 2^( 5) =       0.000463037726
  error estimate for blocks of size 2^( 6) =       0.000471019557
  error estimate for blocks of size 2^( 7) =       0.000473442395

      target function =                  N/A
              le_mean =     -16.905399212807
             les_mean =     286.138628642368
             stat err =       0.000465389204
             autocorr =       1.251564212853
              std dev =       0.588307972951
             le_variance =       0.346106271038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905399212928        initial  <--
     6.1035e+02     6.1035e+03             4.6743e-07       -16.905399210993
     2.4414e+03     2.4414e+04             1.1687e-07       -16.905399211960
     9.7656e+03     9.7656e+04             2.9218e-08       -16.905399212807

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9465
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040883e-02 1 1  ON 2
 uu_3                -2.117379e-02 1 1  ON 3
 uu_4                -6.482640e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752198e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434595e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083769e-01 1 1  ON 28
 eO_9                -6.722344e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078361e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029833e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604256e-01 1 1  ON 38
eH1_9                 4.550550e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950509e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.882
    reference variance = 0.197912
====================================================
  Execution time = 2.0973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4423e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344302432377
                                         uncertainty =       0.009147236683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344302432377
                                         uncertainty =       0.009147236683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414864775
  error estimate for blocks of size 2^( 2) =       0.000427376040
  error estimate for blocks of size 2^( 3) =       0.000440028967
  error estimate for blocks of size 2^( 4) =       0.000452105526
  error estimate for blocks of size 2^( 5) =       0.000461452240
  error estimate for blocks of size 2^( 6) =       0.000468386544
  error estimate for blocks of size 2^( 7) =       0.000472248965

      target function =                  N/A
              le_mean =     -16.905069281188
             les_mean =     286.125592792650
             stat err =       0.000463548319
             autocorr =       1.248466511662
              std dev =       0.586707391279
             le_variance =       0.344225562981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690506928119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905069281188       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905069281160       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905069281394       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905069281442       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905069281547       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905069281579       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905069281573       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905069281554       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.349065e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905069281188       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905069281181       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905069281240       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905069281252       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905069281328       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905069281327       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905069281300       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905069281261       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.087269e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905069281188       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905069281187       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905069281201       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905069281231       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905069281226       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905069281215       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905069281166       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905069281284       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.718175e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6531e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040883e-02 1 1  ON 2
 uu_3                -2.117379e-02 1 1  ON 3
 uu_4                -6.482640e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274544e-01 1 1  ON 8
 uu_9                -9.752199e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076698e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434595e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722345e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078361e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029830e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604256e-01 1 1  ON 38
eH1_9                 4.550551e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020764e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950509e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9879
    reference variance = 0.443647
====================================================
  Execution time = 2.0263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.0000e+06
  Execution time = 1.9154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402550719
                                         uncertainty =       0.003579590783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402550719
                                         uncertainty =       0.003579590783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410086026
  error estimate for blocks of size 2^( 2) =       0.000422721870
  error estimate for blocks of size 2^( 3) =       0.000436001429
  error estimate for blocks of size 2^( 4) =       0.000448641730
  error estimate for blocks of size 2^( 5) =       0.000458888938
  error estimate for blocks of size 2^( 6) =       0.000469428903
  error estimate for blocks of size 2^( 7) =       0.000471100165

      target function =                  N/A
              le_mean =     -16.905400234808
             les_mean =     286.128898028384
             stat err =       0.000462014934
             autocorr =       1.269293588122
              std dev =       0.579949219767
             le_variance =       0.336341097508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402545248
                                         uncertainty =       0.003579590674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402545248
                                         uncertainty =       0.003579590674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410086023
  error estimate for blocks of size 2^( 2) =       0.000422721866
  error estimate for blocks of size 2^( 3) =       0.000436001425
  error estimate for blocks of size 2^( 4) =       0.000448641726
  error estimate for blocks of size 2^( 5) =       0.000458888934
  error estimate for blocks of size 2^( 6) =       0.000469428900
  error estimate for blocks of size 2^( 7) =       0.000471100161

      target function =                  N/A
              le_mean =     -16.905400234824
             les_mean =     286.128898023449
             stat err =       0.000462014930
             autocorr =       1.269293587087
              std dev =       0.579949215049
             le_variance =       0.336341092036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402547983
                                         uncertainty =       0.003579590728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402547983
                                         uncertainty =       0.003579590728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410086024
  error estimate for blocks of size 2^( 2) =       0.000422721868
  error estimate for blocks of size 2^( 3) =       0.000436001427
  error estimate for blocks of size 2^( 4) =       0.000448641728
  error estimate for blocks of size 2^( 5) =       0.000458888936
  error estimate for blocks of size 2^( 6) =       0.000469428901
  error estimate for blocks of size 2^( 7) =       0.000471100163

      target function =                  N/A
              le_mean =     -16.905400234816
             les_mean =     286.128898025916
             stat err =       0.000462014932
             autocorr =       1.269293587602
              std dev =       0.579949217408
             le_variance =       0.336341094772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402550377
                                         uncertainty =       0.003579590776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336402550377
                                         uncertainty =       0.003579590776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410086026
  error estimate for blocks of size 2^( 2) =       0.000422721870
  error estimate for blocks of size 2^( 3) =       0.000436001429
  error estimate for blocks of size 2^( 4) =       0.000448641730
  error estimate for blocks of size 2^( 5) =       0.000458888938
  error estimate for blocks of size 2^( 6) =       0.000469428903
  error estimate for blocks of size 2^( 7) =       0.000471100165

      target function =                  N/A
              le_mean =     -16.905400234809
             les_mean =     286.128898028075
             stat err =       0.000462014934
             autocorr =       1.269293588061
              std dev =       0.579949219472
             le_variance =       0.336341097166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905400234808        initial
     6.1035e+03     6.1035e+04             4.3491e-08       -16.905400234824  <--
     2.4414e+04     2.4414e+05             1.0873e-08       -16.905400234816
     9.7656e+04     9.7656e+05             2.7182e-09       -16.905400234809

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 2.9932e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040885e-02 1 1  ON 2
 uu_3                -2.117378e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752201e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773915e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674481e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722346e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078362e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029818e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550552e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772347e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604132e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.894
    reference variance = 0.244168
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335030773911
                                         uncertainty =       0.003480404097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335030773911
                                         uncertainty =       0.003480404097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409332198
  error estimate for blocks of size 2^( 2) =       0.000422461521
  error estimate for blocks of size 2^( 3) =       0.000434995283
  error estimate for blocks of size 2^( 4) =       0.000447617084
  error estimate for blocks of size 2^( 5) =       0.000458292407
  error estimate for blocks of size 2^( 6) =       0.000464692464
  error estimate for blocks of size 2^( 7) =       0.000468938179

      target function =                  N/A
              le_mean =     -16.906279781551
             les_mean =     286.157401581495
             stat err =       0.000459885034
             autocorr =       1.262253945657
              std dev =       0.578883146218
             le_variance =       0.335105696976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627978155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279781551       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279781770       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279781681       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279781653       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279781894       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279781671       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279781966       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279782092       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279781991       residual = 7.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.895387e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279781551       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279781606       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279781583       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279781576       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279781637       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279781581       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279781657       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279781684       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279781648       residual = 7.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.738842e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279781551       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279781564       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279781559       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279781557       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279781572       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279781559       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279781587       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279781601       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279781577       residual = 7.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.184734e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6471e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040886e-02 1 1  ON 2
 uu_3                -2.117378e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747598e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752204e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890236e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773914e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674483e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722349e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078364e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029818e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881438e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550555e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772349e-02 1 1  ON 42
eH2_3                -3.473917e-02 1 1  ON 43
eH2_4                 1.200349e-02 1 1  ON 44
eH2_5                 4.604132e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950515e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9329
    reference variance = 0.580792
====================================================
  Execution time = 2.2320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.0000e+06
  Execution time = 1.9036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265626911
                                         uncertainty =       0.003501720198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265626911
                                         uncertainty =       0.003501720198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410017264
  error estimate for blocks of size 2^( 2) =       0.000422936849
  error estimate for blocks of size 2^( 3) =       0.000435796696
  error estimate for blocks of size 2^( 4) =       0.000448655772
  error estimate for blocks of size 2^( 5) =       0.000460531728
  error estimate for blocks of size 2^( 6) =       0.000470819384
  error estimate for blocks of size 2^( 7) =       0.000477922371

      target function =                  N/A
              le_mean =     -16.904990553348
             les_mean =     286.114933753964
             stat err =       0.000464482313
             autocorr =       1.283317382958
              std dev =       0.579851975327
             le_variance =       0.336228313291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265641670
                                         uncertainty =       0.003501720876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265641670
                                         uncertainty =       0.003501720876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410017273
  error estimate for blocks of size 2^( 2) =       0.000422936856
  error estimate for blocks of size 2^( 3) =       0.000435796700
  error estimate for blocks of size 2^( 4) =       0.000448655775
  error estimate for blocks of size 2^( 5) =       0.000460531730
  error estimate for blocks of size 2^( 6) =       0.000470819386
  error estimate for blocks of size 2^( 7) =       0.000477922373

      target function =                  N/A
              le_mean =     -16.904990553303
             les_mean =     286.114933767218
             stat err =       0.000464482316
             autocorr =       1.283317339613
              std dev =       0.579851988057
             le_variance =       0.336228328053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265634290
                                         uncertainty =       0.003501720537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265634290
                                         uncertainty =       0.003501720537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410017268
  error estimate for blocks of size 2^( 2) =       0.000422936852
  error estimate for blocks of size 2^( 3) =       0.000435796698
  error estimate for blocks of size 2^( 4) =       0.000448655773
  error estimate for blocks of size 2^( 5) =       0.000460531729
  error estimate for blocks of size 2^( 6) =       0.000470819385
  error estimate for blocks of size 2^( 7) =       0.000477922372

      target function =                  N/A
              le_mean =     -16.904990553326
             les_mean =     286.114933760590
             stat err =       0.000464482315
             autocorr =       1.283317361275
              std dev =       0.579851981692
             le_variance =       0.336228320672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265627833
                                         uncertainty =       0.003501720241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265627833
                                         uncertainty =       0.003501720241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410017264
  error estimate for blocks of size 2^( 2) =       0.000422936849
  error estimate for blocks of size 2^( 3) =       0.000435796696
  error estimate for blocks of size 2^( 4) =       0.000448655772
  error estimate for blocks of size 2^( 5) =       0.000460531728
  error estimate for blocks of size 2^( 6) =       0.000470819384
  error estimate for blocks of size 2^( 7) =       0.000477922371

      target function =                  N/A
              le_mean =     -16.904990553345
             les_mean =     286.114933754792
             stat err =       0.000464482314
             autocorr =       1.283317380247
              std dev =       0.579851976123
             le_variance =       0.336228314213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904990553348        initial  <--
     1.5259e+03     1.5259e+04             1.8954e-07       -16.904990553303
     6.1035e+03     6.1035e+04             4.7388e-08       -16.904990553326
     2.4414e+04     2.4414e+05             1.1847e-08       -16.904990553345

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9358
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040885e-02 1 1  ON 2
 uu_3                -2.117378e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752201e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773915e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674481e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722346e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078362e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029818e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550552e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772347e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604132e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.396888
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338853237947
                                         uncertainty =       0.003722545725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338853237947
                                         uncertainty =       0.003722545725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411566604
  error estimate for blocks of size 2^( 2) =       0.000424308017
  error estimate for blocks of size 2^( 3) =       0.000437392676
  error estimate for blocks of size 2^( 4) =       0.000449795902
  error estimate for blocks of size 2^( 5) =       0.000459833153
  error estimate for blocks of size 2^( 6) =       0.000470070524
  error estimate for blocks of size 2^( 7) =       0.000477319400

      target function =                  N/A
              le_mean =     -16.906032881845
             les_mean =     286.152721771483
             stat err =       0.000464254745
             autocorr =       1.272425744371
              std dev =       0.582043073009
             le_variance =       0.338774138838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603288185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032881845       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032881887       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032881810       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032881815       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032881852       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032881874       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906032881874       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.527743e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032881845       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032881856       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032881836       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032881840       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032881862       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032881853       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906032881892       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.819364e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032881845       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032881848       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032881843       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032881553       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032881847       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906032881546       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906032881755       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.548409e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6326e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040885e-02 1 1  ON 2
 uu_3                -2.117378e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752201e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890235e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365739e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -1.674481e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193464e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259150e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722347e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078362e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029817e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881439e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550553e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772347e-02 1 1  ON 42
eH2_3                -3.473918e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604132e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950512e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8271
    reference variance = 0.232032
====================================================
  Execution time = 2.2244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3396e-01
  Total weights = 2.0000e+06
  Execution time = 1.9139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140780
                                         uncertainty =       0.003207671730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140780
                                         uncertainty =       0.003207671730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408634666
  error estimate for blocks of size 2^( 2) =       0.000421734688
  error estimate for blocks of size 2^( 3) =       0.000435105361
  error estimate for blocks of size 2^( 4) =       0.000447791592
  error estimate for blocks of size 2^( 5) =       0.000457957224
  error estimate for blocks of size 2^( 6) =       0.000466175854
  error estimate for blocks of size 2^( 7) =       0.000471767961

      target function =                  N/A
              le_mean =     -16.904878244919
             les_mean =     286.108872889733
             stat err =       0.000460923158
             autocorr =       1.272291550029
              std dev =       0.577896687297
             le_variance =       0.333964581189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056139950
                                         uncertainty =       0.003207671689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056139950
                                         uncertainty =       0.003207671689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408634666
  error estimate for blocks of size 2^( 2) =       0.000421734688
  error estimate for blocks of size 2^( 3) =       0.000435105361
  error estimate for blocks of size 2^( 4) =       0.000447791591
  error estimate for blocks of size 2^( 5) =       0.000457957224
  error estimate for blocks of size 2^( 6) =       0.000466175854
  error estimate for blocks of size 2^( 7) =       0.000471767960

      target function =                  N/A
              le_mean =     -16.904878244985
             les_mean =     286.108872891152
             stat err =       0.000460923157
             autocorr =       1.272291550581
              std dev =       0.577896686580
             le_variance =       0.333964580360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140365
                                         uncertainty =       0.003207671709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140365
                                         uncertainty =       0.003207671709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408634666
  error estimate for blocks of size 2^( 2) =       0.000421734688
  error estimate for blocks of size 2^( 3) =       0.000435105361
  error estimate for blocks of size 2^( 4) =       0.000447791592
  error estimate for blocks of size 2^( 5) =       0.000457957224
  error estimate for blocks of size 2^( 6) =       0.000466175854
  error estimate for blocks of size 2^( 7) =       0.000471767960

      target function =                  N/A
              le_mean =     -16.904878244952
             les_mean =     286.108872890442
             stat err =       0.000460923157
             autocorr =       1.272291550301
              std dev =       0.577896686939
             le_variance =       0.333964580775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140728
                                         uncertainty =       0.003207671727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334056140728
                                         uncertainty =       0.003207671727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408634666
  error estimate for blocks of size 2^( 2) =       0.000421734688
  error estimate for blocks of size 2^( 3) =       0.000435105361
  error estimate for blocks of size 2^( 4) =       0.000447791592
  error estimate for blocks of size 2^( 5) =       0.000457957224
  error estimate for blocks of size 2^( 6) =       0.000466175854
  error estimate for blocks of size 2^( 7) =       0.000471767961

      target function =                  N/A
              le_mean =     -16.904878244923
             les_mean =     286.108872889822
             stat err =       0.000460923158
             autocorr =       1.272291550063
              std dev =       0.577896687252
             le_variance =       0.333964581137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904878244919        initial
     1.5259e+04     1.5259e+05             1.5277e-08       -16.904878244985  <--
     6.1035e+04     6.1035e+05             3.8194e-09       -16.904878244952
     2.4414e+05     2.4414e+06             9.5484e-10       -16.904878244923

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 3.1941e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040885e-02 1 1  ON 2
 uu_3                -2.117377e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747597e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752202e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890236e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773916e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674481e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722347e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078363e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029814e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881438e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550554e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330731e-01 1 1  ON 41
eH2_2                -8.772348e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200347e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950513e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.189481
====================================================
  Execution time = 2.0921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5098e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351087896897
                                         uncertainty =       0.012692716874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351087896897
                                         uncertainty =       0.012692716874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418912736
  error estimate for blocks of size 2^( 2) =       0.000431104507
  error estimate for blocks of size 2^( 3) =       0.000443492495
  error estimate for blocks of size 2^( 4) =       0.000454928767
  error estimate for blocks of size 2^( 5) =       0.000465173444
  error estimate for blocks of size 2^( 6) =       0.000472893706
  error estimate for blocks of size 2^( 7) =       0.000475264178

      target function =                  N/A
              le_mean =     -16.906221680488
             les_mean =     286.171307095604
             stat err =       0.000467065024
             autocorr =       1.243104285083
              std dev =       0.592432073141
             le_variance =       0.350975761286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622168049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221680488       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221680527       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221680449       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221680530       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221680644       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221680639       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221680699       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221680686       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.211399e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221680488       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221680498       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221680478       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221680495       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221680523       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221680523       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221680538       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221680543       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.802867e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221680488       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221680491       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221680486       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221680505       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221680447       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221680529       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221680484       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221680536       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.507179e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163155 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6461e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040886e-02 1 1  ON 2
 uu_3                -2.117377e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747598e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357649e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752202e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786066e-01 1 1  ON 11
 ud_2                 5.890236e-02 1 1  ON 12
 ud_3                -1.150624e-02 1 1  ON 13
 ud_4                -6.773915e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579711e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742365e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722348e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078364e-02 1 1  ON 32
eH1_3                -3.803673e-02 1 1  ON 33
eH1_4                 9.029815e-03 1 1  ON 34
eH1_5                 4.302981e-02 1 1  ON 35
eH1_6                 9.881438e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550555e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772349e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604131e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950514e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.441474
====================================================
  Execution time = 2.0238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3297e-01
  Total weights = 2.0000e+06
  Execution time = 1.9025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897633941
                                         uncertainty =       0.003457827519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897633941
                                         uncertainty =       0.003457827519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408026966
  error estimate for blocks of size 2^( 2) =       0.000421247896
  error estimate for blocks of size 2^( 3) =       0.000434593871
  error estimate for blocks of size 2^( 4) =       0.000447459287
  error estimate for blocks of size 2^( 5) =       0.000458385304
  error estimate for blocks of size 2^( 6) =       0.000466752208
  error estimate for blocks of size 2^( 7) =       0.000473795639

      target function =                  N/A
              le_mean =     -16.905164779943
             les_mean =     286.117568080029
             stat err =       0.000461598110
             autocorr =       1.279824181810
              std dev =       0.577037268725
             le_variance =       0.332972009498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897618755
                                         uncertainty =       0.003457827537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897618755
                                         uncertainty =       0.003457827537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408026956
  error estimate for blocks of size 2^( 2) =       0.000421247887
  error estimate for blocks of size 2^( 3) =       0.000434593862
  error estimate for blocks of size 2^( 4) =       0.000447459278
  error estimate for blocks of size 2^( 5) =       0.000458385295
  error estimate for blocks of size 2^( 6) =       0.000466752200
  error estimate for blocks of size 2^( 7) =       0.000473795631

      target function =                  N/A
              le_mean =     -16.905164780288
             les_mean =     286.117568076519
             stat err =       0.000461598101
             autocorr =       1.279824191495
              std dev =       0.577037255568
             le_variance =       0.332971994314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897626346
                                         uncertainty =       0.003457827528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897626346
                                         uncertainty =       0.003457827528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408026961
  error estimate for blocks of size 2^( 2) =       0.000421247891
  error estimate for blocks of size 2^( 3) =       0.000434593867
  error estimate for blocks of size 2^( 4) =       0.000447459283
  error estimate for blocks of size 2^( 5) =       0.000458385300
  error estimate for blocks of size 2^( 6) =       0.000466752204
  error estimate for blocks of size 2^( 7) =       0.000473795635

      target function =                  N/A
              le_mean =     -16.905164780115
             les_mean =     286.117568078273
             stat err =       0.000461598105
             autocorr =       1.279824186646
              std dev =       0.577037262145
             le_variance =       0.332972001904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897632991
                                         uncertainty =       0.003457827520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332897632991
                                         uncertainty =       0.003457827520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408026965
  error estimate for blocks of size 2^( 2) =       0.000421247895
  error estimate for blocks of size 2^( 3) =       0.000434593871
  error estimate for blocks of size 2^( 4) =       0.000447459287
  error estimate for blocks of size 2^( 5) =       0.000458385304
  error estimate for blocks of size 2^( 6) =       0.000466752208
  error estimate for blocks of size 2^( 7) =       0.000473795638

      target function =                  N/A
              le_mean =     -16.905164779964
             les_mean =     286.117568079809
             stat err =       0.000461598109
             autocorr =       1.279824182421
              std dev =       0.577037267903
             le_variance =       0.332972008548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905164779943        initial
     3.8147e+03     3.8147e+04             7.2114e-08       -16.905164780288  <--
     1.5259e+04     1.5259e+05             1.8029e-08       -16.905164780115
     6.1035e+04     6.1035e+05             4.5072e-09       -16.905164779964

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 2.9869e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040887e-02 1 1  ON 2
 uu_3                -2.117375e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752203e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890238e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773914e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722351e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078366e-02 1 1  ON 32
eH1_3                -3.803674e-02 1 1  ON 33
eH1_4                 9.029821e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881437e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550558e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772351e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604130e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.32119
====================================================
  Execution time = 2.0963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336074092996
                                         uncertainty =       0.005272970099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336074092996
                                         uncertainty =       0.005272970099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410126089
  error estimate for blocks of size 2^( 2) =       0.000423130052
  error estimate for blocks of size 2^( 3) =       0.000436280371
  error estimate for blocks of size 2^( 4) =       0.000448621782
  error estimate for blocks of size 2^( 5) =       0.000458666976
  error estimate for blocks of size 2^( 6) =       0.000467254139
  error estimate for blocks of size 2^( 7) =       0.000471775680

      target function =                  N/A
              le_mean =     -16.905817253302
             les_mean =     286.143063652023
             stat err =       0.000461579644
             autocorr =       1.266655469790
              std dev =       0.580005877723
             le_variance =       0.336406818193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581725330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817253302       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817253438       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817253395       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905817254344       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905817254896       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905817255325       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905817255236       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.875391e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817253302       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817253336       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817253325       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905817253562       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905817253700       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905817253804       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905817253787       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.188788e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817253302       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817253310       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817253308       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905817253369       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905817253398       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905817253421       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905817253424       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.797216e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6572e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040888e-02 1 1  ON 2
 uu_3                -2.117375e-02 1 1  ON 3
 uu_4                -6.482639e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752204e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890239e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773914e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674483e-02 1 1  ON 22
 eO_3                 3.017911e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722354e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078369e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029817e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881435e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550563e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200349e-02 1 1  ON 44
eH2_5                 4.604129e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950524e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8819
    reference variance = 0.23095
====================================================
  Execution time = 2.0495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.0000e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255747691
                                         uncertainty =       0.006452015449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255747691
                                         uncertainty =       0.006452015449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411374152
  error estimate for blocks of size 2^( 2) =       0.000423997136
  error estimate for blocks of size 2^( 3) =       0.000436853028
  error estimate for blocks of size 2^( 4) =       0.000447954585
  error estimate for blocks of size 2^( 5) =       0.000458733139
  error estimate for blocks of size 2^( 6) =       0.000464063951
  error estimate for blocks of size 2^( 7) =       0.000467164262

      target function =                  N/A
              le_mean =     -16.905672458552
             les_mean =     286.140218492857
             stat err =       0.000459478984
             autocorr =       1.247548114840
              std dev =       0.581770905301
             le_variance =       0.338457386255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255692154
                                         uncertainty =       0.006452016063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255692154
                                         uncertainty =       0.006452016063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411374118
  error estimate for blocks of size 2^( 2) =       0.000423997103
  error estimate for blocks of size 2^( 3) =       0.000436852997
  error estimate for blocks of size 2^( 4) =       0.000447954553
  error estimate for blocks of size 2^( 5) =       0.000458733110
  error estimate for blocks of size 2^( 6) =       0.000464063924
  error estimate for blocks of size 2^( 7) =       0.000467164237

      target function =                  N/A
              le_mean =     -16.905672456767
             les_mean =     286.140218376839
             stat err =       0.000459478956
             autocorr =       1.247548165866
              std dev =       0.581770857451
             le_variance =       0.338457330579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255719912
                                         uncertainty =       0.006452015756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255719912
                                         uncertainty =       0.006452015756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411374135
  error estimate for blocks of size 2^( 2) =       0.000423997119
  error estimate for blocks of size 2^( 3) =       0.000436853012
  error estimate for blocks of size 2^( 4) =       0.000447954569
  error estimate for blocks of size 2^( 5) =       0.000458733125
  error estimate for blocks of size 2^( 6) =       0.000464063938
  error estimate for blocks of size 2^( 7) =       0.000467164249

      target function =                  N/A
              le_mean =     -16.905672457659
             les_mean =     286.140218434830
             stat err =       0.000459478970
             autocorr =       1.247548140357
              std dev =       0.581770881367
             le_variance =       0.338457358406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255744218
                                         uncertainty =       0.006452015487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255744218
                                         uncertainty =       0.006452015487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411374150
  error estimate for blocks of size 2^( 2) =       0.000423997134
  error estimate for blocks of size 2^( 3) =       0.000436853026
  error estimate for blocks of size 2^( 4) =       0.000447954583
  error estimate for blocks of size 2^( 5) =       0.000458733138
  error estimate for blocks of size 2^( 6) =       0.000464063950
  error estimate for blocks of size 2^( 7) =       0.000467164260

      target function =                  N/A
              le_mean =     -16.905672458440
             les_mean =     286.140218485603
             stat err =       0.000459478983
             autocorr =       1.247548118030
              std dev =       0.581770902309
             le_variance =       0.338457382774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905672458552        initial  <--
     9.5367e+02     9.5367e+03             2.8754e-07       -16.905672456767
     3.8147e+03     3.8147e+04             7.1888e-08       -16.905672457659
     1.5259e+04     1.5259e+05             1.7972e-08       -16.905672458440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0713
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040887e-02 1 1  ON 2
 uu_3                -2.117375e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752203e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890238e-02 1 1  ON 12
 ud_3                -1.150623e-02 1 1  ON 13
 ud_4                -6.773914e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486636e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722351e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078366e-02 1 1  ON 32
eH1_3                -3.803674e-02 1 1  ON 33
eH1_4                 9.029821e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881437e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550558e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772351e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604130e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.245396
====================================================
  Execution time = 2.0585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328610343005
                                         uncertainty =       0.002261394118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328610343005
                                         uncertainty =       0.002261394118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405356523
  error estimate for blocks of size 2^( 2) =       0.000418269028
  error estimate for blocks of size 2^( 3) =       0.000431242526
  error estimate for blocks of size 2^( 4) =       0.000442816261
  error estimate for blocks of size 2^( 5) =       0.000453479031
  error estimate for blocks of size 2^( 6) =       0.000460552036
  error estimate for blocks of size 2^( 7) =       0.000464553651

      target function =                  N/A
              le_mean =     -16.905780620599
             les_mean =     286.134046049275
             stat err =       0.000455350245
             autocorr =       1.261876394067
              std dev =       0.573260692679
             le_variance =       0.328627821771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578062060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780620599       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780620648       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780620715       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780620711       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780620703       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780620700       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780620699       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780620695       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.467439e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780620599       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780620611       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780620628       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780620626       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780620618       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780620592       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780620619       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780620623       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.168625e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780620599       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780620602       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780620606       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780620496       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780620605       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780620591       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780620616       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780620576       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.542158e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6223e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040888e-02 1 1  ON 2
 uu_3                -2.117375e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752203e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890238e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773914e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674482e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193465e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083770e-01 1 1  ON 28
 eO_9                -6.722352e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078367e-02 1 1  ON 32
eH1_3                -3.803674e-02 1 1  ON 33
eH1_4                 9.029821e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881437e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550558e-02 1 1  ON 39
eH2_0                -2.317641e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772351e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604130e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950519e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.0293
    reference variance = 1.34777
====================================================
  Execution time = 2.0265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.0000e+06
  Execution time = 1.9559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127254609
                                         uncertainty =       0.003677743764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127254609
                                         uncertainty =       0.003677743764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667799
  error estimate for blocks of size 2^( 2) =       0.000423516740
  error estimate for blocks of size 2^( 3) =       0.000437052112
  error estimate for blocks of size 2^( 4) =       0.000448829009
  error estimate for blocks of size 2^( 5) =       0.000458990047
  error estimate for blocks of size 2^( 6) =       0.000466698758
  error estimate for blocks of size 2^( 7) =       0.000472662480

      target function =                  N/A
              le_mean =     -16.905035559499
             les_mean =     286.117523181733
             stat err =       0.000461795074
             autocorr =       1.264495504168
              std dev =       0.580771971149
             le_variance =       0.337296082472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127257725
                                         uncertainty =       0.003677743797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127257725
                                         uncertainty =       0.003677743797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667801
  error estimate for blocks of size 2^( 2) =       0.000423516742
  error estimate for blocks of size 2^( 3) =       0.000437052113
  error estimate for blocks of size 2^( 4) =       0.000448829011
  error estimate for blocks of size 2^( 5) =       0.000458990048
  error estimate for blocks of size 2^( 6) =       0.000466698759
  error estimate for blocks of size 2^( 7) =       0.000472662481

      target function =                  N/A
              le_mean =     -16.905035559501
             les_mean =     286.117523184940
             stat err =       0.000461795074
             autocorr =       1.264495497229
              std dev =       0.580771973824
             le_variance =       0.337296085579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127256167
                                         uncertainty =       0.003677743781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127256167
                                         uncertainty =       0.003677743781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667800
  error estimate for blocks of size 2^( 2) =       0.000423516741
  error estimate for blocks of size 2^( 3) =       0.000437052113
  error estimate for blocks of size 2^( 4) =       0.000448829010
  error estimate for blocks of size 2^( 5) =       0.000458990047
  error estimate for blocks of size 2^( 6) =       0.000466698758
  error estimate for blocks of size 2^( 7) =       0.000472662480

      target function =                  N/A
              le_mean =     -16.905035559500
             les_mean =     286.117523183337
             stat err =       0.000461795074
             autocorr =       1.264495500698
              std dev =       0.580771972486
             le_variance =       0.337296084026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127254804
                                         uncertainty =       0.003677743766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337127254804
                                         uncertainty =       0.003677743766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667799
  error estimate for blocks of size 2^( 2) =       0.000423516740
  error estimate for blocks of size 2^( 3) =       0.000437052112
  error estimate for blocks of size 2^( 4) =       0.000448829010
  error estimate for blocks of size 2^( 5) =       0.000458990047
  error estimate for blocks of size 2^( 6) =       0.000466698758
  error estimate for blocks of size 2^( 7) =       0.000472662480

      target function =                  N/A
              le_mean =     -16.905035559499
             les_mean =     286.117523181934
             stat err =       0.000461795074
             autocorr =       1.264495503737
              std dev =       0.580771971316
             le_variance =       0.337296082667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905035559499        initial
     9.5367e+03     9.5367e+04             2.4674e-08       -16.905035559501  <--
     3.8147e+04     3.8147e+05             6.1686e-09       -16.905035559500
     1.5259e+05     1.5259e+06             1.5422e-09       -16.905035559499

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9954e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040888e-02 1 1  ON 2
 uu_3                -2.117375e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747602e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752204e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890239e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773915e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339875e-01 1 1  ON 16
 ud_7                -1.490557e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674483e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722353e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361566e-01 1 1  ON 31
eH1_2                -9.078368e-02 1 1  ON 32
eH1_3                -3.803673e-02 1 1  ON 33
eH1_4                 9.029823e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881437e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550560e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772351e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200348e-02 1 1  ON 44
eH2_5                 4.604129e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.271456
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224303522
                                         uncertainty =       0.004257140165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224303522
                                         uncertainty =       0.004257140165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413627026
  error estimate for blocks of size 2^( 2) =       0.000426448624
  error estimate for blocks of size 2^( 3) =       0.000439691340
  error estimate for blocks of size 2^( 4) =       0.000452172076
  error estimate for blocks of size 2^( 5) =       0.000462485978
  error estimate for blocks of size 2^( 6) =       0.000468310093
  error estimate for blocks of size 2^( 7) =       0.000474442019

      target function =                  N/A
              le_mean =     -16.905785897250
             les_mean =     286.147771265090
             stat err =       0.000464352541
             autocorr =       1.260311327779
              std dev =       0.584956949285
             le_variance =       0.342174632517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578589725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905785897250       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905785897426       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905785897362       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905785897461       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905785897462       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905785897951       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905785897958       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905785897895       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.157521e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905785897250       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905785897294       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905785897278       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905785897303       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905785897311       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905785897422       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905785897446       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905785897388       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.893833e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905785897250       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905785897261       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905785897257       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905785897263       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905785897258       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905785897292       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905785897321       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905785897367       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.234601e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6154e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040889e-02 1 1  ON 2
 uu_3                -2.117374e-02 1 1  ON 3
 uu_4                -6.482638e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752205e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890240e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773913e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365740e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674484e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742366e-01 1 1  ON 25
 eO_6                 2.434596e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722354e-02 1 1  ON 29
eH1_0                -2.347048e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078369e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029821e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881436e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604257e-01 1 1  ON 38
eH1_9                 4.550561e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772352e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200349e-02 1 1  ON 44
eH2_5                 4.604129e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660443e-01 1 1  ON 48
eH2_9                 2.950522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.7853
    reference variance = 0.24689
====================================================
  Execution time = 2.1561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3660e-01
  Total weights = 2.0000e+06
  Execution time = 1.8973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251559
                                         uncertainty =       0.003100410555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251559
                                         uncertainty =       0.003100410555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410244788
  error estimate for blocks of size 2^( 2) =       0.000423069498
  error estimate for blocks of size 2^( 3) =       0.000435728840
  error estimate for blocks of size 2^( 4) =       0.000447371772
  error estimate for blocks of size 2^( 5) =       0.000457620350
  error estimate for blocks of size 2^( 6) =       0.000463638094
  error estimate for blocks of size 2^( 7) =       0.000467217419

      target function =                  N/A
              le_mean =     -16.906233871164
             les_mean =     286.157345110391
             stat err =       0.000458961909
             autocorr =       1.251604574125
              std dev =       0.580173743100
             le_variance =       0.336601572183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624250796
                                         uncertainty =       0.003100410763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624250796
                                         uncertainty =       0.003100410763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410244788
  error estimate for blocks of size 2^( 2) =       0.000423069497
  error estimate for blocks of size 2^( 3) =       0.000435728838
  error estimate for blocks of size 2^( 4) =       0.000447371769
  error estimate for blocks of size 2^( 5) =       0.000457620346
  error estimate for blocks of size 2^( 6) =       0.000463638090
  error estimate for blocks of size 2^( 7) =       0.000467217415

      target function =                  N/A
              le_mean =     -16.906233871252
             les_mean =     286.157345112573
             stat err =       0.000458961905
             autocorr =       1.251604555454
              std dev =       0.580173742443
             le_variance =       0.336601571420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251177
                                         uncertainty =       0.003100410659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251177
                                         uncertainty =       0.003100410659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410244788
  error estimate for blocks of size 2^( 2) =       0.000423069497
  error estimate for blocks of size 2^( 3) =       0.000435728839
  error estimate for blocks of size 2^( 4) =       0.000447371771
  error estimate for blocks of size 2^( 5) =       0.000457620348
  error estimate for blocks of size 2^( 6) =       0.000463638092
  error estimate for blocks of size 2^( 7) =       0.000467217417

      target function =                  N/A
              le_mean =     -16.906233871208
             les_mean =     286.157345111482
             stat err =       0.000458961907
             autocorr =       1.251604564790
              std dev =       0.580173742771
             le_variance =       0.336601571801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251511
                                         uncertainty =       0.003100410568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624251511
                                         uncertainty =       0.003100410568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410244788
  error estimate for blocks of size 2^( 2) =       0.000423069498
  error estimate for blocks of size 2^( 3) =       0.000435728840
  error estimate for blocks of size 2^( 4) =       0.000447371772
  error estimate for blocks of size 2^( 5) =       0.000457620350
  error estimate for blocks of size 2^( 6) =       0.000463638094
  error estimate for blocks of size 2^( 7) =       0.000467217419

      target function =                  N/A
              le_mean =     -16.906233871170
             les_mean =     286.157345110528
             stat err =       0.000458961909
             autocorr =       1.251604572962
              std dev =       0.580173743059
             le_variance =       0.336601572135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906233871164        initial
     2.3842e+03     2.3842e+04             1.1575e-07       -16.906233871252  <--
     9.5367e+03     9.5367e+04             2.8938e-08       -16.906233871208
     3.8147e+04     3.8147e+05             7.2346e-09       -16.906233871170

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 3.4695e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040890e-02 1 1  ON 2
 uu_3                -2.117371e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752207e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890242e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773910e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674487e-02 1 1  ON 22
 eO_3                 3.017911e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742367e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722358e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078370e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029816e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881433e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550567e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950529e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.317854
====================================================
  Execution time = 2.0572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344130875888
                                         uncertainty =       0.003734237363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344130875888
                                         uncertainty =       0.003734237363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414771124
  error estimate for blocks of size 2^( 2) =       0.000427344796
  error estimate for blocks of size 2^( 3) =       0.000439609495
  error estimate for blocks of size 2^( 4) =       0.000451356761
  error estimate for blocks of size 2^( 5) =       0.000461787114
  error estimate for blocks of size 2^( 6) =       0.000468478897
  error estimate for blocks of size 2^( 7) =       0.000470671579

      target function =                  N/A
              le_mean =     -16.906014729328
             les_mean =     286.157404026419
             stat err =       0.000463073588
             autocorr =       1.246473345079
              std dev =       0.586574948497
             le_variance =       0.344070170204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601472933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906014729328       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906014729122       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906014728324       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906014728369       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906014727862       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906014728033       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906014727691       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906014727786       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.637009e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906014729328       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906014729276       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906014729077       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906014729088       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906014728959       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906014729004       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906014728918       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906014728943       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.159491e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906014729328       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906014729315       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906014729265       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906014729269       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906014729237       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906014729244       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906014729222       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906014729236       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.898876e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6087e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.079105e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117372e-02 1 1  ON 3
 uu_4                -6.482633e-02 1 1  ON 4
 uu_5                -9.747605e-02 1 1  ON 5
 uu_6                -1.234262e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752212e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890245e-02 1 1  ON 12
 ud_3                -1.150616e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017911e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078373e-02 1 1  ON 32
eH1_3                -3.803672e-02 1 1  ON 33
eH1_4                 9.029821e-03 1 1  ON 34
eH1_5                 4.302984e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550572e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772353e-02 1 1  ON 42
eH2_3                -3.473925e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604130e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9688
    reference variance = 0.585567
====================================================
  Execution time = 2.2750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4149e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306924952
                                         uncertainty =       0.004613339285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306924952
                                         uncertainty =       0.004613339285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413215231
  error estimate for blocks of size 2^( 2) =       0.000425982441
  error estimate for blocks of size 2^( 3) =       0.000439592473
  error estimate for blocks of size 2^( 4) =       0.000452179870
  error estimate for blocks of size 2^( 5) =       0.000464105521
  error estimate for blocks of size 2^( 6) =       0.000473020391
  error estimate for blocks of size 2^( 7) =       0.000480677340

      target function =                  N/A
              le_mean =     -16.905680710128
             les_mean =     286.143533756167
             stat err =       0.000467495781
             autocorr =       1.279978718657
              std dev =       0.584374583744
             le_variance =       0.341493654126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306815758
                                         uncertainty =       0.004613338389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306815758
                                         uncertainty =       0.004613338389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413215165
  error estimate for blocks of size 2^( 2) =       0.000425982376
  error estimate for blocks of size 2^( 3) =       0.000439592407
  error estimate for blocks of size 2^( 4) =       0.000452179802
  error estimate for blocks of size 2^( 5) =       0.000464105450
  error estimate for blocks of size 2^( 6) =       0.000473020326
  error estimate for blocks of size 2^( 7) =       0.000480677278

      target function =                  N/A
              le_mean =     -16.905680709021
             les_mean =     286.143533609445
             stat err =       0.000467495714
             autocorr =       1.279978764179
              std dev =       0.584374490221
             le_variance =       0.341493544820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306870304
                                         uncertainty =       0.004613338836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306870304
                                         uncertainty =       0.004613338836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413215198
  error estimate for blocks of size 2^( 2) =       0.000425982409
  error estimate for blocks of size 2^( 3) =       0.000439592440
  error estimate for blocks of size 2^( 4) =       0.000452179836
  error estimate for blocks of size 2^( 5) =       0.000464105486
  error estimate for blocks of size 2^( 6) =       0.000473020359
  error estimate for blocks of size 2^( 7) =       0.000480677309

      target function =                  N/A
              le_mean =     -16.905680709574
             les_mean =     286.143533682734
             stat err =       0.000467495747
             autocorr =       1.279978741462
              std dev =       0.584374536939
             le_variance =       0.341493599422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306918119
                                         uncertainty =       0.004613339229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306918119
                                         uncertainty =       0.004613339229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413215227
  error estimate for blocks of size 2^( 2) =       0.000425982437
  error estimate for blocks of size 2^( 3) =       0.000439592469
  error estimate for blocks of size 2^( 4) =       0.000452179866
  error estimate for blocks of size 2^( 5) =       0.000464105517
  error estimate for blocks of size 2^( 6) =       0.000473020387
  error estimate for blocks of size 2^( 7) =       0.000480677336

      target function =                  N/A
              le_mean =     -16.905680710059
             les_mean =     286.143533746985
             stat err =       0.000467495776
             autocorr =       1.279978721513
              std dev =       0.584374577892
             le_variance =       0.341493647287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905680710128        initial  <--
     5.9605e+02     5.9605e+03             4.6370e-07       -16.905680709021
     2.3842e+03     2.3842e+04             1.1595e-07       -16.905680709574
     9.5367e+03     9.5367e+04             2.8989e-08       -16.905680710059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2988
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040890e-02 1 1  ON 2
 uu_3                -2.117371e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274545e-01 1 1  ON 8
 uu_9                -9.752207e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890242e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773910e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674487e-02 1 1  ON 22
 eO_3                 3.017911e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742367e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722358e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078370e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029816e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881433e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550567e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330732e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950529e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.303769
====================================================
  Execution time = 2.0938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339520585491
                                         uncertainty =       0.004411383333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339520585491
                                         uncertainty =       0.004411383333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412113246
  error estimate for blocks of size 2^( 2) =       0.000424586522
  error estimate for blocks of size 2^( 3) =       0.000437277768
  error estimate for blocks of size 2^( 4) =       0.000448835229
  error estimate for blocks of size 2^( 5) =       0.000458352515
  error estimate for blocks of size 2^( 6) =       0.000465810804
  error estimate for blocks of size 2^( 7) =       0.000471595589

      target function =                  N/A
              le_mean =     -16.905799497984
             les_mean =     286.145731151752
             stat err =       0.000461148534
             autocorr =       1.252127393431
              std dev =       0.582816142152
             le_variance =       0.339674655553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579949798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799497984       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799497982       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799498114       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799498147       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799498098       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799498107       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799498164       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799498152       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.916556e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799497984       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799497984       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799498017       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799498024       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799498005       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799498021       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799498037       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799498023       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.791415e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905799497984       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799497984       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799497992       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799497988       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799498008       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799498088       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799498007       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799498007       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.447856e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6558e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040891e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752208e-02 1 1  ON 9
 ud_0                 4.441985e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890242e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773909e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579712e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674487e-02 1 1  ON 22
 eO_3                 3.017911e-01 1 1  ON 23
 eO_4                 5.193466e-01 1 1  ON 24
 eO_5                 4.742367e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259149e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722359e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078371e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029812e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550567e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950529e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8352
    reference variance = 0.236836
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4680e-01
  Total weights = 2.0000e+06
  Execution time = 1.9042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783208410
                                         uncertainty =       0.008101436385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783208410
                                         uncertainty =       0.008101436385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416413446
  error estimate for blocks of size 2^( 2) =       0.000429357858
  error estimate for blocks of size 2^( 3) =       0.000442214102
  error estimate for blocks of size 2^( 4) =       0.000453902260
  error estimate for blocks of size 2^( 5) =       0.000463415653
  error estimate for blocks of size 2^( 6) =       0.000472067990
  error estimate for blocks of size 2^( 7) =       0.000477309425

      target function =                  N/A
              le_mean =     -16.906237308873
             les_mean =     286.167660085886
             stat err =       0.000466673832
             autocorr =       1.255964632172
              std dev =       0.588897542316
             le_variance =       0.346800315346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783195849
                                         uncertainty =       0.008101435942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783195849
                                         uncertainty =       0.008101435942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416413438
  error estimate for blocks of size 2^( 2) =       0.000429357851
  error estimate for blocks of size 2^( 3) =       0.000442214095
  error estimate for blocks of size 2^( 4) =       0.000453902252
  error estimate for blocks of size 2^( 5) =       0.000463415646
  error estimate for blocks of size 2^( 6) =       0.000472067983
  error estimate for blocks of size 2^( 7) =       0.000477309417

      target function =                  N/A
              le_mean =     -16.906237308890
             les_mean =     286.167660073896
             stat err =       0.000466673824
             autocorr =       1.255964638228
              std dev =       0.588897531649
             le_variance =       0.346800302782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783202129
                                         uncertainty =       0.008101436164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783202129
                                         uncertainty =       0.008101436164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416413442
  error estimate for blocks of size 2^( 2) =       0.000429357855
  error estimate for blocks of size 2^( 3) =       0.000442214099
  error estimate for blocks of size 2^( 4) =       0.000453902256
  error estimate for blocks of size 2^( 5) =       0.000463415649
  error estimate for blocks of size 2^( 6) =       0.000472067986
  error estimate for blocks of size 2^( 7) =       0.000477309421

      target function =                  N/A
              le_mean =     -16.906237308882
             les_mean =     286.167660079890
             stat err =       0.000466673828
             autocorr =       1.255964635198
              std dev =       0.588897536982
             le_variance =       0.346800309064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783207625
                                         uncertainty =       0.008101436358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346783207625
                                         uncertainty =       0.008101436358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416413445
  error estimate for blocks of size 2^( 2) =       0.000429357858
  error estimate for blocks of size 2^( 3) =       0.000442214102
  error estimate for blocks of size 2^( 4) =       0.000453902259
  error estimate for blocks of size 2^( 5) =       0.000463415653
  error estimate for blocks of size 2^( 6) =       0.000472067989
  error estimate for blocks of size 2^( 7) =       0.000477309424

      target function =                  N/A
              le_mean =     -16.906237308874
             les_mean =     286.167660085137
             stat err =       0.000466673831
             autocorr =       1.255964632551
              std dev =       0.588897541650
             le_variance =       0.346800314561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906237308873        initial
     5.9605e+03     5.9605e+04             3.9166e-08       -16.906237308890  <--
     2.3842e+04     2.3842e+05             9.7914e-09       -16.906237308882
     9.5367e+04     9.5367e+05             2.4479e-09       -16.906237308874

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.9741e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040891e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747600e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773909e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722361e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078371e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029800e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550570e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9163
    reference variance = 0.286119
====================================================
  Execution time = 2.0910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6698e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366982597685
                                         uncertainty =       0.024835534067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366982597685
                                         uncertainty =       0.024835534067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428359700
  error estimate for blocks of size 2^( 2) =       0.000440206264
  error estimate for blocks of size 2^( 3) =       0.000452550642
  error estimate for blocks of size 2^( 4) =       0.000464601625
  error estimate for blocks of size 2^( 5) =       0.000474963740
  error estimate for blocks of size 2^( 6) =       0.000481583363
  error estimate for blocks of size 2^( 7) =       0.000483214011

      target function =                  N/A
              le_mean =     -16.905871391607
             les_mean =     286.175471391701
             stat err =       0.000476090685
             autocorr =       1.235270745498
              std dev =       0.605792097714
             le_variance =       0.366984065653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587139161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871391607       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871390949       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905871390286       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905871390275       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905871390329       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905871390450       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905871390426       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905871390510       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.554937e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871391607       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871391442       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905871391276       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905871391274       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905871391287       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905871391318       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905871391313       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905871391336       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.887409e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871391607       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871391565       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905871391524       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905871391523       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905871391527       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905871391534       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905871391510       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905871391537       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.718563e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6425e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482635e-02 1 1  ON 4
 uu_5                -9.747602e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752210e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890246e-02 1 1  ON 12
 ud_3                -1.150620e-02 1 1  ON 13
 ud_4                -6.773909e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722363e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078373e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029825e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472427e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550572e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772356e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200351e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950535e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.248427
====================================================
  Execution time = 2.0564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3875e-01
  Total weights = 2.0000e+06
  Execution time = 1.9042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838058534
                                         uncertainty =       0.003066229552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838058534
                                         uncertainty =       0.003066229552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411551210
  error estimate for blocks of size 2^( 2) =       0.000424667364
  error estimate for blocks of size 2^( 3) =       0.000437771998
  error estimate for blocks of size 2^( 4) =       0.000448831129
  error estimate for blocks of size 2^( 5) =       0.000458364890
  error estimate for blocks of size 2^( 6) =       0.000466336487
  error estimate for blocks of size 2^( 7) =       0.000468557074

      target function =                  N/A
              le_mean =     -16.905302267391
             les_mean =     286.127993379819
             stat err =       0.000460522395
             autocorr =       1.252142460255
              std dev =       0.582021303171
             le_variance =       0.338748797345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838029291
                                         uncertainty =       0.003066228834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838029291
                                         uncertainty =       0.003066228834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411551192
  error estimate for blocks of size 2^( 2) =       0.000424667347
  error estimate for blocks of size 2^( 3) =       0.000437771981
  error estimate for blocks of size 2^( 4) =       0.000448831111
  error estimate for blocks of size 2^( 5) =       0.000458364873
  error estimate for blocks of size 2^( 6) =       0.000466336468
  error estimate for blocks of size 2^( 7) =       0.000468557051

      target function =                  N/A
              le_mean =     -16.905302267366
             les_mean =     286.127993349700
             stat err =       0.000460522376
             autocorr =       1.252142463220
              std dev =       0.582021278028
             le_variance =       0.338748768078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838043910
                                         uncertainty =       0.003066229193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838043910
                                         uncertainty =       0.003066229193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411551201
  error estimate for blocks of size 2^( 2) =       0.000424667356
  error estimate for blocks of size 2^( 3) =       0.000437771989
  error estimate for blocks of size 2^( 4) =       0.000448831120
  error estimate for blocks of size 2^( 5) =       0.000458364882
  error estimate for blocks of size 2^( 6) =       0.000466336477
  error estimate for blocks of size 2^( 7) =       0.000468557062

      target function =                  N/A
              le_mean =     -16.905302267378
             les_mean =     286.127993364758
             stat err =       0.000460522385
             autocorr =       1.252142461745
              std dev =       0.582021290598
             le_variance =       0.338748782709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838056706
                                         uncertainty =       0.003066229507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838056706
                                         uncertainty =       0.003066229507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411551209
  error estimate for blocks of size 2^( 2) =       0.000424667363
  error estimate for blocks of size 2^( 3) =       0.000437771997
  error estimate for blocks of size 2^( 4) =       0.000448831128
  error estimate for blocks of size 2^( 5) =       0.000458364889
  error estimate for blocks of size 2^( 6) =       0.000466336486
  error estimate for blocks of size 2^( 7) =       0.000468557072

      target function =                  N/A
              le_mean =     -16.905302267389
             les_mean =     286.127993377937
             stat err =       0.000460522394
             autocorr =       1.252142460438
              std dev =       0.582021301600
             le_variance =       0.338748795516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905302267391        initial  <--
     1.4901e+03     1.4901e+04             1.5549e-07       -16.905302267366
     5.9605e+03     5.9605e+04             3.8874e-08       -16.905302267378
     2.3842e+04     2.3842e+05             9.7186e-09       -16.905302267389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1600
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040891e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747600e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773909e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722361e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078371e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029800e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550570e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.2116
====================================================
  Execution time = 2.0640e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338071174280
                                         uncertainty =       0.004184789326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338071174280
                                         uncertainty =       0.004184789326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411093931
  error estimate for blocks of size 2^( 2) =       0.000424121315
  error estimate for blocks of size 2^( 3) =       0.000438228011
  error estimate for blocks of size 2^( 4) =       0.000451544189
  error estimate for blocks of size 2^( 5) =       0.000462007321
  error estimate for blocks of size 2^( 6) =       0.000471590752
  error estimate for blocks of size 2^( 7) =       0.000475460177

      target function =                  N/A
              le_mean =     -16.905606253081
             les_mean =     286.137519055987
             stat err =       0.000465150610
             autocorr =       1.280280283713
              std dev =       0.581374613112
             le_variance =       0.337996440771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560625308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905606253081       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606253095       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905606253108       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905606253128       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905606253159       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905606253168       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905606253173       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905606253160       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.768108e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905606253081       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606253085       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905606253088       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905606253093       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905606253062       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905606253115       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905606253066       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905606253099       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.420298e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905606253081       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606253082       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905606253083       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905606253084       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905606253240       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905606253056       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905606252958       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905606253231       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.105076e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6198e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040891e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083771e-01 1 1  ON 28
 eO_9                -6.722361e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078371e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029800e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550570e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.185356
====================================================
  Execution time = 2.0291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3367e-01
  Total weights = 2.0000e+06
  Execution time = 1.9031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722912958
                                         uncertainty =       0.003034420865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722912958
                                         uncertainty =       0.003034420865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408456803
  error estimate for blocks of size 2^( 2) =       0.000421548919
  error estimate for blocks of size 2^( 3) =       0.000434677741
  error estimate for blocks of size 2^( 4) =       0.000447463671
  error estimate for blocks of size 2^( 5) =       0.000457976120
  error estimate for blocks of size 2^( 6) =       0.000465905558
  error estimate for blocks of size 2^( 7) =       0.000471647819

      target function =                  N/A
              le_mean =     -16.905374563882
             les_mean =     286.125362897521
             stat err =       0.000460748292
             autocorr =       1.272433813053
              std dev =       0.577645149894
             le_variance =       0.333673919196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722918770
                                         uncertainty =       0.003034420932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722918770
                                         uncertainty =       0.003034420932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408456806
  error estimate for blocks of size 2^( 2) =       0.000421548922
  error estimate for blocks of size 2^( 3) =       0.000434677744
  error estimate for blocks of size 2^( 4) =       0.000447463674
  error estimate for blocks of size 2^( 5) =       0.000457976123
  error estimate for blocks of size 2^( 6) =       0.000465905561
  error estimate for blocks of size 2^( 7) =       0.000471647821

      target function =                  N/A
              le_mean =     -16.905374563944
             les_mean =     286.125362905414
             stat err =       0.000460748295
             autocorr =       1.272433805221
              std dev =       0.577645154924
             le_variance =       0.333673925007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722915864
                                         uncertainty =       0.003034420898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722915864
                                         uncertainty =       0.003034420898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408456804
  error estimate for blocks of size 2^( 2) =       0.000421548920
  error estimate for blocks of size 2^( 3) =       0.000434677742
  error estimate for blocks of size 2^( 4) =       0.000447463673
  error estimate for blocks of size 2^( 5) =       0.000457976121
  error estimate for blocks of size 2^( 6) =       0.000465905560
  error estimate for blocks of size 2^( 7) =       0.000471647820

      target function =                  N/A
              le_mean =     -16.905374563913
             les_mean =     286.125362901468
             stat err =       0.000460748293
             autocorr =       1.272433809140
              std dev =       0.577645152409
             le_variance =       0.333673922102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722913321
                                         uncertainty =       0.003034420869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722913321
                                         uncertainty =       0.003034420869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408456803
  error estimate for blocks of size 2^( 2) =       0.000421548919
  error estimate for blocks of size 2^( 3) =       0.000434677741
  error estimate for blocks of size 2^( 4) =       0.000447463671
  error estimate for blocks of size 2^( 5) =       0.000457976120
  error estimate for blocks of size 2^( 6) =       0.000465905559
  error estimate for blocks of size 2^( 7) =       0.000471647819

      target function =                  N/A
              le_mean =     -16.905374563886
             les_mean =     286.125362898014
             stat err =       0.000460748292
             autocorr =       1.272433812563
              std dev =       0.577645150208
             le_variance =       0.333673919559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905374563882        initial
     1.4901e+04     1.4901e+05             1.7681e-08       -16.905374563944  <--
     5.9605e+04     5.9605e+05             4.4203e-09       -16.905374563913
     2.3842e+05     2.3842e+06             1.1051e-09       -16.905374563886

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.9887e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722361e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078372e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550571e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950533e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8807
    reference variance = 0.292728
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339697592316
                                         uncertainty =       0.004082579718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339697592316
                                         uncertainty =       0.004082579718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412101999
  error estimate for blocks of size 2^( 2) =       0.000424803939
  error estimate for blocks of size 2^( 3) =       0.000437810885
  error estimate for blocks of size 2^( 4) =       0.000450552270
  error estimate for blocks of size 2^( 5) =       0.000461628591
  error estimate for blocks of size 2^( 6) =       0.000470299320
  error estimate for blocks of size 2^( 7) =       0.000475305838

      target function =                  N/A
              le_mean =     -16.905718755367
             les_mean =     286.142982581552
             stat err =       0.000464446505
             autocorr =       1.270170302733
              std dev =       0.582800236631
             le_variance =       0.339656115817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571875537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718755367       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905718755425       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905718755275       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905718755389       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905718755242       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905718755548       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905718755577       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905718755615       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 7.025062e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718755367       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905718755382       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905718755344       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905718755373       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905718755334       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905718755405       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905718755418       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905718755423       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.756323e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905718755367       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905718755371       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905718755361       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905718755391       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905718755354       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905718755396       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905718755408       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905718755323       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.390842e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6244e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482636e-02 1 1  ON 4
 uu_5                -9.747602e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357651e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752210e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722362e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078373e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029804e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550572e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772355e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950535e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8613
    reference variance = 0.49269
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.0000e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884404073
                                         uncertainty =       0.003490799983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884404073
                                         uncertainty =       0.003490799983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989956
  error estimate for blocks of size 2^( 2) =       0.000423736248
  error estimate for blocks of size 2^( 3) =       0.000436360614
  error estimate for blocks of size 2^( 4) =       0.000448180531
  error estimate for blocks of size 2^( 5) =       0.000459163095
  error estimate for blocks of size 2^( 6) =       0.000468898379
  error estimate for blocks of size 2^( 7) =       0.000475399950

      target function =                  N/A
              le_mean =     -16.905552314372
             les_mean =     286.135524373276
             stat err =       0.000462910489
             autocorr =       1.268620208510
              std dev =       0.581227570082
             le_variance =       0.337825488223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884441323
                                         uncertainty =       0.003490800156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884441323
                                         uncertainty =       0.003490800156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989979
  error estimate for blocks of size 2^( 2) =       0.000423736269
  error estimate for blocks of size 2^( 3) =       0.000436360633
  error estimate for blocks of size 2^( 4) =       0.000448180550
  error estimate for blocks of size 2^( 5) =       0.000459163111
  error estimate for blocks of size 2^( 6) =       0.000468898394
  error estimate for blocks of size 2^( 7) =       0.000475399966

      target function =                  N/A
              le_mean =     -16.905552314041
             les_mean =     286.135524399338
             stat err =       0.000462910505
             autocorr =       1.268620157393
              std dev =       0.581227602122
             le_variance =       0.337825525468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884422699
                                         uncertainty =       0.003490800069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884422699
                                         uncertainty =       0.003490800069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989968
  error estimate for blocks of size 2^( 2) =       0.000423736258
  error estimate for blocks of size 2^( 3) =       0.000436360624
  error estimate for blocks of size 2^( 4) =       0.000448180540
  error estimate for blocks of size 2^( 5) =       0.000459163103
  error estimate for blocks of size 2^( 6) =       0.000468898386
  error estimate for blocks of size 2^( 7) =       0.000475399958

      target function =                  N/A
              le_mean =     -16.905552314207
             les_mean =     286.135524386307
             stat err =       0.000462910497
             autocorr =       1.268620182945
              std dev =       0.581227586102
             le_variance =       0.337825506846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884406401
                                         uncertainty =       0.003490799993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337884406401
                                         uncertainty =       0.003490799993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410989958
  error estimate for blocks of size 2^( 2) =       0.000423736249
  error estimate for blocks of size 2^( 3) =       0.000436360615
  error estimate for blocks of size 2^( 4) =       0.000448180533
  error estimate for blocks of size 2^( 5) =       0.000459163096
  error estimate for blocks of size 2^( 6) =       0.000468898379
  error estimate for blocks of size 2^( 7) =       0.000475399951

      target function =                  N/A
              le_mean =     -16.905552314351
             les_mean =     286.135524374905
             stat err =       0.000462910490
             autocorr =       1.268620205304
              std dev =       0.581227572085
             le_variance =       0.337825490551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905552314372        initial  <--
     3.7253e+03     3.7253e+04             7.0251e-08       -16.905552314041
     1.4901e+04     1.4901e+05             1.7563e-08       -16.905552314207
     5.9605e+04     5.9605e+05             4.3908e-09       -16.905552314351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7414
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722361e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078372e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550571e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950533e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.252809
====================================================
  Execution time = 2.2986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337909648545
                                         uncertainty =       0.004875251137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337909648545
                                         uncertainty =       0.004875251137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411072847
  error estimate for blocks of size 2^( 2) =       0.000424206487
  error estimate for blocks of size 2^( 3) =       0.000437582617
  error estimate for blocks of size 2^( 4) =       0.000450249099
  error estimate for blocks of size 2^( 5) =       0.000461322318
  error estimate for blocks of size 2^( 6) =       0.000468576316
  error estimate for blocks of size 2^( 7) =       0.000474559256

      target function =                  N/A
              le_mean =     -16.905472723663
             les_mean =     286.132969612001
             stat err =       0.000463676747
             autocorr =       1.272310331272
              std dev =       0.581344794811
             le_variance =       0.337961770454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547272366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472723663       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472723686       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472723710       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472723711       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472723697       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472723695       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472723695       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472723687       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 7.619018e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472723663       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472723669       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472723675       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472723675       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472723651       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472723807       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472723719       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472723808       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.904764e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472723663       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472723665       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472723666       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472723686       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472723468       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472723661       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472723883       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472723961       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.761916e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8604e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722362e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078372e-02 1 1  ON 32
eH1_3                -3.803670e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550571e-02 1 1  ON 39
eH2_0                -2.317642e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772354e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950533e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9549
    reference variance = 0.364835
====================================================
  Execution time = 2.0409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.0000e+06
  Execution time = 1.9021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312643439
                                         uncertainty =       0.003255190422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312643439
                                         uncertainty =       0.003255190422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410004499
  error estimate for blocks of size 2^( 2) =       0.000423142760
  error estimate for blocks of size 2^( 3) =       0.000436560477
  error estimate for blocks of size 2^( 4) =       0.000450368671
  error estimate for blocks of size 2^( 5) =       0.000461544074
  error estimate for blocks of size 2^( 6) =       0.000467081517
  error estimate for blocks of size 2^( 7) =       0.000472034606

      target function =                  N/A
              le_mean =     -16.906171026824
             les_mean =     286.154825998464
             stat err =       0.000462757217
             autocorr =       1.273881870430
              std dev =       0.579833923083
             le_variance =       0.336207378358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312650992
                                         uncertainty =       0.003255190506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312650992
                                         uncertainty =       0.003255190506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410004504
  error estimate for blocks of size 2^( 2) =       0.000423142764
  error estimate for blocks of size 2^( 3) =       0.000436560482
  error estimate for blocks of size 2^( 4) =       0.000450368675
  error estimate for blocks of size 2^( 5) =       0.000461544077
  error estimate for blocks of size 2^( 6) =       0.000467081521
  error estimate for blocks of size 2^( 7) =       0.000472034609

      target function =                  N/A
              le_mean =     -16.906171026825
             les_mean =     286.154826006071
             stat err =       0.000462757221
             autocorr =       1.273881861136
              std dev =       0.579833929592
             le_variance =       0.336207385906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312647215
                                         uncertainty =       0.003255190464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312647215
                                         uncertainty =       0.003255190464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410004501
  error estimate for blocks of size 2^( 2) =       0.000423142762
  error estimate for blocks of size 2^( 3) =       0.000436560480
  error estimate for blocks of size 2^( 4) =       0.000450368673
  error estimate for blocks of size 2^( 5) =       0.000461544075
  error estimate for blocks of size 2^( 6) =       0.000467081519
  error estimate for blocks of size 2^( 7) =       0.000472034608

      target function =                  N/A
              le_mean =     -16.906171026824
             les_mean =     286.154826002267
             stat err =       0.000462757219
             autocorr =       1.273881865780
              std dev =       0.579833926338
             le_variance =       0.336207382132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312643911
                                         uncertainty =       0.003255190427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312643911
                                         uncertainty =       0.003255190427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410004499
  error estimate for blocks of size 2^( 2) =       0.000423142760
  error estimate for blocks of size 2^( 3) =       0.000436560478
  error estimate for blocks of size 2^( 4) =       0.000450368672
  error estimate for blocks of size 2^( 5) =       0.000461544074
  error estimate for blocks of size 2^( 6) =       0.000467081518
  error estimate for blocks of size 2^( 7) =       0.000472034606

      target function =                  N/A
              le_mean =     -16.906171026824
             les_mean =     286.154825998939
             stat err =       0.000462757217
             autocorr =       1.273881869842
              std dev =       0.579833923490
             le_variance =       0.336207378830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906171026824        initial
     3.7253e+04     3.7253e+05             7.6190e-09       -16.906171026825  <--
     1.4901e+05     1.4901e+06             1.9048e-09       -16.906171026824
     5.9605e+05     5.9605e+06             4.7619e-10       -16.906171026824

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9996e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747601e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786067e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722362e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078372e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550571e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772355e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950534e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8056
    reference variance = 0.344718
====================================================
  Execution time = 2.3049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3618e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336226374164
                                         uncertainty =       0.003531635112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336226374164
                                         uncertainty =       0.003531635112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409987199
  error estimate for blocks of size 2^( 2) =       0.000422996581
  error estimate for blocks of size 2^( 3) =       0.000436793798
  error estimate for blocks of size 2^( 4) =       0.000449932031
  error estimate for blocks of size 2^( 5) =       0.000460058095
  error estimate for blocks of size 2^( 6) =       0.000469436405
  error estimate for blocks of size 2^( 7) =       0.000474985249

      target function =                  N/A
              le_mean =     -16.906364152206
             les_mean =     286.161327686175
             stat err =       0.000463602945
             autocorr =       1.278650278042
              std dev =       0.579809457713
             le_variance =       0.336179007254


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636415221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906364152206       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906364152145       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906364152130       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906364152137       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906364152182       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906364152229       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906364152242       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906364152237       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.236256e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906364152206       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906364152191       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906364152187       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906364152189       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906364152205       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906364152207       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906364152217       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906364152204       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 8.090667e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906364152206       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906364152203       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906364152202       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906364152212       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906364152205       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906364152181       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906364152126       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906364152168       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.022668e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8553e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747602e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890243e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674488e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722362e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361567e-01 1 1  ON 31
eH1_2                -9.078373e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302986e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604258e-01 1 1  ON 38
eH1_9                 4.550572e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772355e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950535e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.203107
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4108e-01
  Total weights = 2.0000e+06
  Execution time = 1.9115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169556559
                                         uncertainty =       0.003628508115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169556559
                                         uncertainty =       0.003628508115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966952
  error estimate for blocks of size 2^( 2) =       0.000425601787
  error estimate for blocks of size 2^( 3) =       0.000439033718
  error estimate for blocks of size 2^( 4) =       0.000450413814
  error estimate for blocks of size 2^( 5) =       0.000459299939
  error estimate for blocks of size 2^( 6) =       0.000466823054
  error estimate for blocks of size 2^( 7) =       0.000473066912

      target function =                  N/A
              le_mean =     -16.905585713848
             les_mean =     286.139911563811
             stat err =       0.000462400930
             autocorr =       1.253738035015
              std dev =       0.584023463659
             le_variance =       0.341083406104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169546267
                                         uncertainty =       0.003628507755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169546267
                                         uncertainty =       0.003628507755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966945
  error estimate for blocks of size 2^( 2) =       0.000425601782
  error estimate for blocks of size 2^( 3) =       0.000439033712
  error estimate for blocks of size 2^( 4) =       0.000450413808
  error estimate for blocks of size 2^( 5) =       0.000459299934
  error estimate for blocks of size 2^( 6) =       0.000466823048
  error estimate for blocks of size 2^( 7) =       0.000473066907

      target function =                  N/A
              le_mean =     -16.905585713888
             les_mean =     286.139911554897
             stat err =       0.000462400924
             autocorr =       1.253738044117
              std dev =       0.584023454848
             le_variance =       0.341083395813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169551413
                                         uncertainty =       0.003628507935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169551413
                                         uncertainty =       0.003628507935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966948
  error estimate for blocks of size 2^( 2) =       0.000425601784
  error estimate for blocks of size 2^( 3) =       0.000439033715
  error estimate for blocks of size 2^( 4) =       0.000450413811
  error estimate for blocks of size 2^( 5) =       0.000459299937
  error estimate for blocks of size 2^( 6) =       0.000466823051
  error estimate for blocks of size 2^( 7) =       0.000473066909

      target function =                  N/A
              le_mean =     -16.905585713868
             les_mean =     286.139911559354
             stat err =       0.000462400927
             autocorr =       1.253738039564
              std dev =       0.584023459253
             le_variance =       0.341083400958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169555915
                                         uncertainty =       0.003628508093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341169555915
                                         uncertainty =       0.003628508093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966951
  error estimate for blocks of size 2^( 2) =       0.000425601787
  error estimate for blocks of size 2^( 3) =       0.000439033717
  error estimate for blocks of size 2^( 4) =       0.000450413813
  error estimate for blocks of size 2^( 5) =       0.000459299939
  error estimate for blocks of size 2^( 6) =       0.000466823053
  error estimate for blocks of size 2^( 7) =       0.000473066911

      target function =                  N/A
              le_mean =     -16.905585713850
             les_mean =     286.139911563254
             stat err =       0.000462400929
             autocorr =       1.253738035580
              std dev =       0.584023463108
             le_variance =       0.341083405461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905585713848        initial
     9.3132e+03     9.3132e+04             3.2363e-08       -16.905585713888  <--
     3.7253e+04     3.7253e+05             8.0907e-09       -16.905585713868
     1.4901e+05     1.4901e+06             2.0227e-09       -16.905585713850

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.9806e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747603e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722363e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550573e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950536e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.208938
====================================================
  Execution time = 2.0704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339122123151
                                         uncertainty =       0.004965290269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339122123151
                                         uncertainty =       0.004965290269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411773677
  error estimate for blocks of size 2^( 2) =       0.000424406905
  error estimate for blocks of size 2^( 3) =       0.000436976192
  error estimate for blocks of size 2^( 4) =       0.000448578167
  error estimate for blocks of size 2^( 5) =       0.000459220929
  error estimate for blocks of size 2^( 6) =       0.000465591167
  error estimate for blocks of size 2^( 7) =       0.000468177809

      target function =                  N/A
              le_mean =     -16.905648501683
             les_mean =     286.140066214853
             stat err =       0.000460392018
             autocorr =       1.250081735064
              std dev =       0.582335918491
             le_variance =       0.339115121965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564850168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905648501683       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905648502073       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905648502382       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905648502607       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905648502863       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905648502774       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905648502761       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905648502762       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.109885e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905648501683       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905648501780       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905648501858       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905648501912       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905648501979       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905648501952       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905648501952       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905648501950       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.774725e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905648501683       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905648501707       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905648501726       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905648501733       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905648501727       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905648501753       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905648501746       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905648501746       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.936820e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6231e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357651e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752211e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890245e-02 1 1  ON 12
 ud_3                -1.150620e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722365e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078375e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029817e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550574e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772358e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8876
    reference variance = 0.144565
====================================================
  Execution time = 2.0104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4009e-01
  Total weights = 2.0000e+06
  Execution time = 1.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141840067
                                         uncertainty =       0.003565301833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141840067
                                         uncertainty =       0.003565301833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412363481
  error estimate for blocks of size 2^( 2) =       0.000425411771
  error estimate for blocks of size 2^( 3) =       0.000438602616
  error estimate for blocks of size 2^( 4) =       0.000450571782
  error estimate for blocks of size 2^( 5) =       0.000462005664
  error estimate for blocks of size 2^( 6) =       0.000470540545
  error estimate for blocks of size 2^( 7) =       0.000476393040

      target function =                  N/A
              le_mean =     -16.904659037449
             les_mean =     286.107584283362
             stat err =       0.000464877758
             autocorr =       1.270916860105
              std dev =       0.583170027513
             le_variance =       0.340087280990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141816597
                                         uncertainty =       0.003565302307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141816597
                                         uncertainty =       0.003565302307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412363467
  error estimate for blocks of size 2^( 2) =       0.000425411757
  error estimate for blocks of size 2^( 3) =       0.000438602601
  error estimate for blocks of size 2^( 4) =       0.000450571767
  error estimate for blocks of size 2^( 5) =       0.000462005648
  error estimate for blocks of size 2^( 6) =       0.000470540529
  error estimate for blocks of size 2^( 7) =       0.000476393026

      target function =                  N/A
              le_mean =     -16.904659037445
             les_mean =     286.107584259772
             stat err =       0.000464877742
             autocorr =       1.270916863416
              std dev =       0.583170007399
             le_variance =       0.340087257530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141828328
                                         uncertainty =       0.003565302070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141828328
                                         uncertainty =       0.003565302070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412363474
  error estimate for blocks of size 2^( 2) =       0.000425411764
  error estimate for blocks of size 2^( 3) =       0.000438602608
  error estimate for blocks of size 2^( 4) =       0.000450571774
  error estimate for blocks of size 2^( 5) =       0.000462005656
  error estimate for blocks of size 2^( 6) =       0.000470540537
  error estimate for blocks of size 2^( 7) =       0.000476393033

      target function =                  N/A
              le_mean =     -16.904659037447
             les_mean =     286.107584271563
             stat err =       0.000464877750
             autocorr =       1.270916861761
              std dev =       0.583170017453
             le_variance =       0.340087269256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141838599
                                         uncertainty =       0.003565301862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141838599
                                         uncertainty =       0.003565301862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412363480
  error estimate for blocks of size 2^( 2) =       0.000425411770
  error estimate for blocks of size 2^( 3) =       0.000438602615
  error estimate for blocks of size 2^( 4) =       0.000450571781
  error estimate for blocks of size 2^( 5) =       0.000462005663
  error estimate for blocks of size 2^( 6) =       0.000470540544
  error estimate for blocks of size 2^( 7) =       0.000476393039

      target function =                  N/A
              le_mean =     -16.904659037449
             les_mean =     286.107584281886
             stat err =       0.000464877757
             autocorr =       1.270916860315
              std dev =       0.583170026256
             le_variance =       0.340087279523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904659037449        initial  <--
     2.3283e+03     2.3283e+04             1.1099e-07       -16.904659037445
     9.3132e+03     9.3132e+04             2.7747e-08       -16.904659037447
     3.7253e+04     3.7253e+05             6.9368e-09       -16.904659037449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6627
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040892e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747603e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722363e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550573e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950536e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8643
    reference variance = 0.26016
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338299733097
                                         uncertainty =       0.004124461688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338299733097
                                         uncertainty =       0.004124461688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272592
  error estimate for blocks of size 2^( 2) =       0.000423858605
  error estimate for blocks of size 2^( 3) =       0.000436574442
  error estimate for blocks of size 2^( 4) =       0.000449754139
  error estimate for blocks of size 2^( 5) =       0.000461254791
  error estimate for blocks of size 2^( 6) =       0.000472325002
  error estimate for blocks of size 2^( 7) =       0.000478920998

      target function =                  N/A
              le_mean =     -16.905857894413
             les_mean =     286.146321266933
             stat err =       0.000465563733
             autocorr =       1.281441386139
              std dev =       0.581627277546
             le_variance =       0.338290289985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585789441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857894413       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905857894433       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905857894469       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905857894471       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905857894478       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905857894463       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905857894481       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905857894486       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.045641e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857894413       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905857894418       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905857894427       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905857894401       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905857894436       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905857894407       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905857894384       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905857894428       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.614103e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905857894413       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905857894414       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905857894417       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905857894417       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905857894436       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905857893812       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905857894827       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905857894656       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.535260e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747603e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259148e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722363e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029801e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550573e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.282531
====================================================
  Execution time = 2.0139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3232e-01
  Total weights = 2.0000e+06
  Execution time = 1.9054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329090974
                                         uncertainty =       0.002750257488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329090974
                                         uncertainty =       0.002750257488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407625697
  error estimate for blocks of size 2^( 2) =       0.000420264583
  error estimate for blocks of size 2^( 3) =       0.000433430732
  error estimate for blocks of size 2^( 4) =       0.000445070376
  error estimate for blocks of size 2^( 5) =       0.000455432525
  error estimate for blocks of size 2^( 6) =       0.000464202111
  error estimate for blocks of size 2^( 7) =       0.000468319804

      target function =                  N/A
              le_mean =     -16.905383757643
             les_mean =     286.124317244713
             stat err =       0.000458256204
             autocorr =       1.263844369464
              std dev =       0.576469789041
             le_variance =       0.332317417677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329088686
                                         uncertainty =       0.002750257473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329088686
                                         uncertainty =       0.002750257473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407625696
  error estimate for blocks of size 2^( 2) =       0.000420264582
  error estimate for blocks of size 2^( 3) =       0.000433430730
  error estimate for blocks of size 2^( 4) =       0.000445070374
  error estimate for blocks of size 2^( 5) =       0.000455432524
  error estimate for blocks of size 2^( 6) =       0.000464202110
  error estimate for blocks of size 2^( 7) =       0.000468319803

      target function =                  N/A
              le_mean =     -16.905383757655
             les_mean =     286.124317242808
             stat err =       0.000458256203
             autocorr =       1.263844371034
              std dev =       0.576469787054
             le_variance =       0.332317415386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329089830
                                         uncertainty =       0.002750257480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329089830
                                         uncertainty =       0.002750257480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407625696
  error estimate for blocks of size 2^( 2) =       0.000420264582
  error estimate for blocks of size 2^( 3) =       0.000433430731
  error estimate for blocks of size 2^( 4) =       0.000445070375
  error estimate for blocks of size 2^( 5) =       0.000455432525
  error estimate for blocks of size 2^( 6) =       0.000464202111
  error estimate for blocks of size 2^( 7) =       0.000468319804

      target function =                  N/A
              le_mean =     -16.905383757649
             les_mean =     286.124317243761
             stat err =       0.000458256203
             autocorr =       1.263844370251
              std dev =       0.576469788047
             le_variance =       0.332317416531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329090831
                                         uncertainty =       0.002750257487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332329090831
                                         uncertainty =       0.002750257487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407625697
  error estimate for blocks of size 2^( 2) =       0.000420264583
  error estimate for blocks of size 2^( 3) =       0.000433430732
  error estimate for blocks of size 2^( 4) =       0.000445070376
  error estimate for blocks of size 2^( 5) =       0.000455432525
  error estimate for blocks of size 2^( 6) =       0.000464202111
  error estimate for blocks of size 2^( 7) =       0.000468319804

      target function =                  N/A
              le_mean =     -16.905383757644
             les_mean =     286.124317244594
             stat err =       0.000458256204
             autocorr =       1.263844369557
              std dev =       0.576469788917
             le_variance =       0.332317417534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905383757643        initial
     2.3283e+04     2.3283e+05             1.0456e-08       -16.905383757655  <--
     9.3132e+04     9.3132e+05             2.6141e-09       -16.905383757649
     3.7253e+05     3.7253e+06             6.5353e-10       -16.905383757644

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9811e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747603e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029798e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550574e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.273969
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340860040140
                                         uncertainty =       0.006774704828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340860040140
                                         uncertainty =       0.006774704828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412786816
  error estimate for blocks of size 2^( 2) =       0.000425643856
  error estimate for blocks of size 2^( 3) =       0.000438267579
  error estimate for blocks of size 2^( 4) =       0.000450195234
  error estimate for blocks of size 2^( 5) =       0.000461106340
  error estimate for blocks of size 2^( 6) =       0.000467701362
  error estimate for blocks of size 2^( 7) =       0.000470900143

      target function =                  N/A
              le_mean =     -16.906021991004
             les_mean =     286.154365300677
             stat err =       0.000462475770
             autocorr =       1.255238733489
              std dev =       0.583768713403
             le_variance =       0.340785910748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602199100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021991004       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021991023       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021991082       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021991014       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021990993       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021990947       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021990970       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021990981       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.782111e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021991004       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021991009       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021991024       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021990995       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021990999       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021990983       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021990991       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021990904       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.455301e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906021991004       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021991005       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021991009       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021991005       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021990908       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021990953       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021990946       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021990981       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.363826e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6439e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752210e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890245e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674491e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078375e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029791e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550575e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772358e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8361
    reference variance = 0.246592
====================================================
  Execution time = 2.0390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4685e-01
  Total weights = 2.0000e+06
  Execution time = 1.9005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723021844
                                         uncertainty =       0.006642620841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723021844
                                         uncertainty =       0.006642620841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416442843
  error estimate for blocks of size 2^( 2) =       0.000428960194
  error estimate for blocks of size 2^( 3) =       0.000441572637
  error estimate for blocks of size 2^( 4) =       0.000453654152
  error estimate for blocks of size 2^( 5) =       0.000463963547
  error estimate for blocks of size 2^( 6) =       0.000472432017
  error estimate for blocks of size 2^( 7) =       0.000477266215

      target function =                  N/A
              le_mean =     -16.905680871156
             les_mean =     286.148894827234
             stat err =       0.000466828983
             autocorr =       1.256622456207
              std dev =       0.588939116787
             le_variance =       0.346849283282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723029565
                                         uncertainty =       0.006642620585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723029565
                                         uncertainty =       0.006642620585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416442848
  error estimate for blocks of size 2^( 2) =       0.000428960198
  error estimate for blocks of size 2^( 3) =       0.000441572640
  error estimate for blocks of size 2^( 4) =       0.000453654155
  error estimate for blocks of size 2^( 5) =       0.000463963550
  error estimate for blocks of size 2^( 6) =       0.000472432020
  error estimate for blocks of size 2^( 7) =       0.000477266218

      target function =                  N/A
              le_mean =     -16.905680871081
             les_mean =     286.148894832414
             stat err =       0.000466828986
             autocorr =       1.256622444365
              std dev =       0.588939123345
             le_variance =       0.346849291007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723025704
                                         uncertainty =       0.006642620713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723025704
                                         uncertainty =       0.006642620713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416442846
  error estimate for blocks of size 2^( 2) =       0.000428960196
  error estimate for blocks of size 2^( 3) =       0.000441572639
  error estimate for blocks of size 2^( 4) =       0.000453654153
  error estimate for blocks of size 2^( 5) =       0.000463963549
  error estimate for blocks of size 2^( 6) =       0.000472432019
  error estimate for blocks of size 2^( 7) =       0.000477266216

      target function =                  N/A
              le_mean =     -16.905680871119
             les_mean =     286.148894829824
             stat err =       0.000466828984
             autocorr =       1.256622450288
              std dev =       0.588939120066
             le_variance =       0.346849287144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723022326
                                         uncertainty =       0.006642620825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346723022326
                                         uncertainty =       0.006642620825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416442843
  error estimate for blocks of size 2^( 2) =       0.000428960194
  error estimate for blocks of size 2^( 3) =       0.000441572637
  error estimate for blocks of size 2^( 4) =       0.000453654152
  error estimate for blocks of size 2^( 5) =       0.000463963548
  error estimate for blocks of size 2^( 6) =       0.000472432017
  error estimate for blocks of size 2^( 7) =       0.000477266215

      target function =                  N/A
              le_mean =     -16.905680871151
             les_mean =     286.148894827557
             stat err =       0.000466828983
             autocorr =       1.256622455469
              std dev =       0.588939117196
             le_variance =       0.346849283764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905680871156        initial  <--
     5.8208e+03     5.8208e+04             3.7821e-08       -16.905680871081
     2.3283e+04     2.3283e+05             9.4553e-09       -16.905680871119
     9.3132e+04     9.3132e+05             2.3638e-09       -16.905680871151

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9586
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747603e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029798e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550574e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8454
    reference variance = 0.257079
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339826157390
                                         uncertainty =       0.005081820772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339826157390
                                         uncertainty =       0.005081820772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211186
  error estimate for blocks of size 2^( 2) =       0.000425056237
  error estimate for blocks of size 2^( 3) =       0.000438034903
  error estimate for blocks of size 2^( 4) =       0.000450075559
  error estimate for blocks of size 2^( 5) =       0.000461957992
  error estimate for blocks of size 2^( 6) =       0.000469773025
  error estimate for blocks of size 2^( 7) =       0.000474453050

      target function =                  N/A
              le_mean =     -16.905148342972
             les_mean =     286.123876451621
             stat err =       0.000464064907
             autocorr =       1.267412276043
              std dev =       0.582954649751
             le_variance =       0.339836123667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690514834297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148342971       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148342997       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148342999       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148342998       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148343033       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148342982       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148342968       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148343008       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.802178e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148342971       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148342978       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148342978       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148343226       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148342864       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148342997       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148342880       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148342973       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.200546e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148342971       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148342973       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148342973       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148343296       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148343020       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148343007       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148344307       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148341889       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.001366e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6569e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076699e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078374e-02 1 1  ON 32
eH1_3                -3.803669e-02 1 1  ON 33
eH1_4                 9.029798e-03 1 1  ON 34
eH1_5                 4.302985e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550574e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772357e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.207328
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4952e-01
  Total weights = 2.0000e+06
  Execution time = 1.9667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609622201
                                         uncertainty =       0.017053689340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609622201
                                         uncertainty =       0.017053689340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418045545
  error estimate for blocks of size 2^( 2) =       0.000430240282
  error estimate for blocks of size 2^( 3) =       0.000443240754
  error estimate for blocks of size 2^( 4) =       0.000455335412
  error estimate for blocks of size 2^( 5) =       0.000465538429
  error estimate for blocks of size 2^( 6) =       0.000471452778
  error estimate for blocks of size 2^( 7) =       0.000474499372

      target function =                  N/A
              le_mean =     -16.905595508800
             les_mean =     286.148683488252
             stat err =       0.000466706498
             autocorr =       1.246351368215
              std dev =       0.591205679835
             le_variance =       0.349524155869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609621313
                                         uncertainty =       0.017053689171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609621313
                                         uncertainty =       0.017053689171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418045545
  error estimate for blocks of size 2^( 2) =       0.000430240281
  error estimate for blocks of size 2^( 3) =       0.000443240754
  error estimate for blocks of size 2^( 4) =       0.000455335411
  error estimate for blocks of size 2^( 5) =       0.000465538429
  error estimate for blocks of size 2^( 6) =       0.000471452777
  error estimate for blocks of size 2^( 7) =       0.000474499371

      target function =                  N/A
              le_mean =     -16.905595508807
             les_mean =     286.148683487616
             stat err =       0.000466706497
             autocorr =       1.246351368250
              std dev =       0.591205679085
             le_variance =       0.349524154983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609621757
                                         uncertainty =       0.017053689256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609621757
                                         uncertainty =       0.017053689256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418045545
  error estimate for blocks of size 2^( 2) =       0.000430240281
  error estimate for blocks of size 2^( 3) =       0.000443240754
  error estimate for blocks of size 2^( 4) =       0.000455335412
  error estimate for blocks of size 2^( 5) =       0.000465538429
  error estimate for blocks of size 2^( 6) =       0.000471452778
  error estimate for blocks of size 2^( 7) =       0.000474499371

      target function =                  N/A
              le_mean =     -16.905595508803
             les_mean =     286.148683487934
             stat err =       0.000466706497
             autocorr =       1.246351368226
              std dev =       0.591205679460
             le_variance =       0.349524155426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609622146
                                         uncertainty =       0.017053689329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349609622146
                                         uncertainty =       0.017053689329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418045545
  error estimate for blocks of size 2^( 2) =       0.000430240282
  error estimate for blocks of size 2^( 3) =       0.000443240754
  error estimate for blocks of size 2^( 4) =       0.000455335412
  error estimate for blocks of size 2^( 5) =       0.000465538429
  error estimate for blocks of size 2^( 6) =       0.000471452778
  error estimate for blocks of size 2^( 7) =       0.000474499371

      target function =                  N/A
              le_mean =     -16.905595508800
             les_mean =     286.148683488212
             stat err =       0.000466706498
             autocorr =       1.246351368222
              std dev =       0.591205679788
             le_variance =       0.349524155814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905595508800        initial
     5.8208e+04     5.8208e+05             4.8022e-09       -16.905595508807  <--
     2.3283e+05     2.3283e+06             1.2005e-09       -16.905595508803
     9.3132e+05     9.3132e+06             3.0014e-10       -16.905595508800

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.9901e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117370e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752209e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890244e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674490e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078375e-02 1 1  ON 32
eH1_3                -3.803668e-02 1 1  ON 33
eH1_4                 9.029796e-03 1 1  ON 34
eH1_5                 4.302984e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550574e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772358e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200353e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660444e-01 1 1  ON 48
eH2_9                 2.950538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.273021
====================================================
  Execution time = 2.3025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336622175160
                                         uncertainty =       0.002873759833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336622175160
                                         uncertainty =       0.002873759833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410234671
  error estimate for blocks of size 2^( 2) =       0.000423105832
  error estimate for blocks of size 2^( 3) =       0.000436492230
  error estimate for blocks of size 2^( 4) =       0.000448870668
  error estimate for blocks of size 2^( 5) =       0.000460322831
  error estimate for blocks of size 2^( 6) =       0.000469303284
  error estimate for blocks of size 2^( 7) =       0.000475220666

      target function =                  N/A
              le_mean =     -16.905452056695
             les_mean =     286.130894043438
             stat err =       0.000463429362
             autocorr =       1.276151892468
              std dev =       0.580159435443
             le_variance =       0.336584970533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545205669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452056695       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452056680       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905452056735       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452056790       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905452056818       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905452056797       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905452056812       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905452056797       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.947477e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452056695       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452056691       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905452056705       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452056731       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905452056753       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905452056715       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905452056758       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905452056720       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.868707e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452056695       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452056694       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905452056697       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452056700       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905452056702       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905452056634       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905452056677       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905452056833       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.217178e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8505e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040893e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752210e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890245e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674491e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722364e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078375e-02 1 1  ON 32
eH1_3                -3.803668e-02 1 1  ON 33
eH1_4                 9.029796e-03 1 1  ON 34
eH1_5                 4.302984e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550575e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772358e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9263
    reference variance = 0.411929
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4402e-01
  Total weights = 2.0000e+06
  Execution time = 1.8998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985617614
                                         uncertainty =       0.009460688000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985617614
                                         uncertainty =       0.009460688000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739738
  error estimate for blocks of size 2^( 2) =       0.000427673027
  error estimate for blocks of size 2^( 3) =       0.000441091997
  error estimate for blocks of size 2^( 4) =       0.000453588486
  error estimate for blocks of size 2^( 5) =       0.000464207199
  error estimate for blocks of size 2^( 6) =       0.000472349158
  error estimate for blocks of size 2^( 7) =       0.000477056475

      target function =                  N/A
              le_mean =     -16.906045918549
             les_mean =     286.158406528175
             stat err =       0.000466800329
             autocorr =       1.266808620475
              std dev =       0.586530561959
             le_variance =       0.344018100112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985613981
                                         uncertainty =       0.009460687584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985613981
                                         uncertainty =       0.009460687584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739736
  error estimate for blocks of size 2^( 2) =       0.000427673025
  error estimate for blocks of size 2^( 3) =       0.000441091995
  error estimate for blocks of size 2^( 4) =       0.000453588483
  error estimate for blocks of size 2^( 5) =       0.000464207196
  error estimate for blocks of size 2^( 6) =       0.000472349155
  error estimate for blocks of size 2^( 7) =       0.000477056473

      target function =                  N/A
              le_mean =     -16.906045918594
             les_mean =     286.158406526079
             stat err =       0.000466800327
             autocorr =       1.266808620659
              std dev =       0.586530558860
             le_variance =       0.344018096476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985615798
                                         uncertainty =       0.009460687792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985615798
                                         uncertainty =       0.009460687792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739737
  error estimate for blocks of size 2^( 2) =       0.000427673026
  error estimate for blocks of size 2^( 3) =       0.000441091996
  error estimate for blocks of size 2^( 4) =       0.000453588484
  error estimate for blocks of size 2^( 5) =       0.000464207198
  error estimate for blocks of size 2^( 6) =       0.000472349156
  error estimate for blocks of size 2^( 7) =       0.000477056474

      target function =                  N/A
              le_mean =     -16.906045918571
             les_mean =     286.158406527127
             stat err =       0.000466800328
             autocorr =       1.266808620564
              std dev =       0.586530560410
             le_variance =       0.344018098294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985617387
                                         uncertainty =       0.009460687974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343985617387
                                         uncertainty =       0.009460687974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739738
  error estimate for blocks of size 2^( 2) =       0.000427673027
  error estimate for blocks of size 2^( 3) =       0.000441091997
  error estimate for blocks of size 2^( 4) =       0.000453588485
  error estimate for blocks of size 2^( 5) =       0.000464207199
  error estimate for blocks of size 2^( 6) =       0.000472349157
  error estimate for blocks of size 2^( 7) =       0.000477056475

      target function =                  N/A
              le_mean =     -16.906045918551
             les_mean =     286.158406528044
             stat err =       0.000466800329
             autocorr =       1.266808620483
              std dev =       0.586530561765
             le_variance =       0.344018099885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906045918549        initial
     1.4552e+04     1.4552e+05             1.9475e-08       -16.906045918594  <--
     5.8208e+04     5.8208e+05             4.8687e-09       -16.906045918571
     2.3283e+05     2.3283e+06             1.2172e-09       -16.906045918551

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 3.0072e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040894e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357651e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752211e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890245e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773909e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486637e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674492e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193467e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722365e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078376e-02 1 1  ON 32
eH1_3                -3.803668e-02 1 1  ON 33
eH1_4                 9.029796e-03 1 1  ON 34
eH1_5                 4.302984e-02 1 1  ON 35
eH1_6                 9.881432e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550576e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772359e-02 1 1  ON 42
eH2_3                -3.473921e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604126e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.340807
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339357949013
                                         uncertainty =       0.004741004775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339357949013
                                         uncertainty =       0.004741004775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411878286
  error estimate for blocks of size 2^( 2) =       0.000424506342
  error estimate for blocks of size 2^( 3) =       0.000437791638
  error estimate for blocks of size 2^( 4) =       0.000450502359
  error estimate for blocks of size 2^( 5) =       0.000461085895
  error estimate for blocks of size 2^( 6) =       0.000470198477
  error estimate for blocks of size 2^( 7) =       0.000475312308

      target function =                  N/A
              le_mean =     -16.905241161626
             les_mean =     286.126466008767
             stat err =       0.000464274760
             autocorr =       1.270610246329
              std dev =       0.582483858735
             le_variance =       0.339287445687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690524116163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241161626       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241161792       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241161935       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241161942       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241161944       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241161953       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241161933       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241161959       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.662521e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241161626       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241161667       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241161703       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241161700       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241161707       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241161712       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241161703       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241161700       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.415636e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241161626       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241161636       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241161645       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241161646       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241161644       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241161638       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241161650       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241161721       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.539094e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040894e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274546e-01 1 1  ON 8
 uu_9                -9.752212e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890246e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773908e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579713e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674492e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742368e-01 1 1  ON 25
 eO_6                 2.434597e-01 1 1  ON 26
 eO_7                -5.259147e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722366e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078377e-02 1 1  ON 32
eH1_3                -3.803668e-02 1 1  ON 33
eH1_4                 9.029789e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881431e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550577e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772360e-02 1 1  ON 42
eH2_3                -3.473920e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604127e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8959
    reference variance = 0.462243
====================================================
  Execution time = 2.0640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.0000e+06
  Execution time = 1.9054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746158858
                                         uncertainty =       0.003384624178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746158858
                                         uncertainty =       0.003384624178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401156
  error estimate for blocks of size 2^( 2) =       0.000423051175
  error estimate for blocks of size 2^( 3) =       0.000435984658
  error estimate for blocks of size 2^( 4) =       0.000448322622
  error estimate for blocks of size 2^( 5) =       0.000459329595
  error estimate for blocks of size 2^( 6) =       0.000465819039
  error estimate for blocks of size 2^( 7) =       0.000472354304

      target function =                  N/A
              le_mean =     -16.905547662277
             les_mean =     286.134399810720
             stat err =       0.000461456390
             autocorr =       1.264282648562
              std dev =       0.580394880785
             le_variance =       0.336858217642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746154574
                                         uncertainty =       0.003384624116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746154574
                                         uncertainty =       0.003384624116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401153
  error estimate for blocks of size 2^( 2) =       0.000423051172
  error estimate for blocks of size 2^( 3) =       0.000435984655
  error estimate for blocks of size 2^( 4) =       0.000448322619
  error estimate for blocks of size 2^( 5) =       0.000459329591
  error estimate for blocks of size 2^( 6) =       0.000465819036
  error estimate for blocks of size 2^( 7) =       0.000472354299

      target function =                  N/A
              le_mean =     -16.905547662718
             les_mean =     286.134399821370
             stat err =       0.000461456386
             autocorr =       1.264282643162
              std dev =       0.580394877115
             le_variance =       0.336858213381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746156715
                                         uncertainty =       0.003384624147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746156715
                                         uncertainty =       0.003384624147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401155
  error estimate for blocks of size 2^( 2) =       0.000423051174
  error estimate for blocks of size 2^( 3) =       0.000435984657
  error estimate for blocks of size 2^( 4) =       0.000448322620
  error estimate for blocks of size 2^( 5) =       0.000459329593
  error estimate for blocks of size 2^( 6) =       0.000465819037
  error estimate for blocks of size 2^( 7) =       0.000472354302

      target function =                  N/A
              le_mean =     -16.905547662497
             les_mean =     286.134399816044
             stat err =       0.000461456388
             autocorr =       1.264282645868
              std dev =       0.580394878949
             le_variance =       0.336858215510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746158590
                                         uncertainty =       0.003384624174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336746158590
                                         uncertainty =       0.003384624174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401156
  error estimate for blocks of size 2^( 2) =       0.000423051175
  error estimate for blocks of size 2^( 3) =       0.000435984658
  error estimate for blocks of size 2^( 4) =       0.000448322622
  error estimate for blocks of size 2^( 5) =       0.000459329594
  error estimate for blocks of size 2^( 6) =       0.000465819039
  error estimate for blocks of size 2^( 7) =       0.000472354304

      target function =                  N/A
              le_mean =     -16.905547662304
             les_mean =     286.134399811385
             stat err =       0.000461456390
             autocorr =       1.264282648228
              std dev =       0.580394880556
             le_variance =       0.336858217375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905547662277        initial
     3.6380e+03     3.6380e+04             5.6625e-08       -16.905547662718  <--
     1.4552e+04     1.4552e+05             1.4156e-08       -16.905547662497
     5.8208e+04     5.8208e+05             3.5391e-09       -16.905547662304

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 3.0236e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8893
    reference variance = 0.295722
====================================================
  Execution time = 2.0401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337216540969
                                         uncertainty =       0.003481808444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337216540969
                                         uncertainty =       0.003481808444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410558553
  error estimate for blocks of size 2^( 2) =       0.000423638600
  error estimate for blocks of size 2^( 3) =       0.000437071297
  error estimate for blocks of size 2^( 4) =       0.000450244836
  error estimate for blocks of size 2^( 5) =       0.000460665598
  error estimate for blocks of size 2^( 6) =       0.000468721436
  error estimate for blocks of size 2^( 7) =       0.000473308028

      target function =                  N/A
              le_mean =     -16.905460113585
             les_mean =     286.131698134359
             stat err =       0.000463234974
             autocorr =       1.273070558435
              std dev =       0.580617473805
             le_variance =       0.337116650887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546011359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460113585       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460113620       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905460114363       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905460114545       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905460115224       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905460114842       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905460114902       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905460114888       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.857268e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460113585       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460113594       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905460113780       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905460113825       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905460113995       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905460113899       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905460113914       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905460113911       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 7.143216e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460113585       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460113588       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905460113634       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905460113645       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905460113688       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905460113664       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905460113672       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905460113662       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.785807e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6061e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040894e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482635e-02 1 1  ON 4
 uu_5                -9.747606e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752218e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150621e-02 1 1  ON 13
 ud_4                -6.773905e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365742e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193469e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259144e-02 1 1  ON 27
 eO_8                -2.083773e-01 1 1  ON 28
 eO_9                -6.722373e-02 1 1  ON 29
eH1_0                -2.347050e-01 1 1  ON 30
eH1_1                -1.361569e-01 1 1  ON 31
eH1_2                -9.078382e-02 1 1  ON 32
eH1_3                -3.803665e-02 1 1  ON 33
eH1_4                 9.029745e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881428e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604260e-01 1 1  ON 38
eH1_9                 4.550586e-02 1 1  ON 39
eH2_0                -2.317644e-01 1 1  ON 40
eH2_1                -1.330734e-01 1 1  ON 41
eH2_2                -8.772364e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200352e-02 1 1  ON 44
eH2_5                 4.604125e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950548e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.221846
====================================================
  Execution time = 2.0083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3581e-01
  Total weights = 2.0000e+06
  Execution time = 1.9011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770279623
                                         uncertainty =       0.002899564422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770279623
                                         uncertainty =       0.002899564422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409760241
  error estimate for blocks of size 2^( 2) =       0.000422948152
  error estimate for blocks of size 2^( 3) =       0.000436397762
  error estimate for blocks of size 2^( 4) =       0.000448960809
  error estimate for blocks of size 2^( 5) =       0.000459742705
  error estimate for blocks of size 2^( 6) =       0.000468720598
  error estimate for blocks of size 2^( 7) =       0.000470807678

      target function =                  N/A
              le_mean =     -16.905300335285
             les_mean =     286.124986167738
             stat err =       0.000462057947
             autocorr =       1.271549456588
              std dev =       0.579488489496
             le_variance =       0.335806909458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770348526
                                         uncertainty =       0.002899564571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770348526
                                         uncertainty =       0.002899564571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409760283
  error estimate for blocks of size 2^( 2) =       0.000422948191
  error estimate for blocks of size 2^( 3) =       0.000436397797
  error estimate for blocks of size 2^( 4) =       0.000448960840
  error estimate for blocks of size 2^( 5) =       0.000459742733
  error estimate for blocks of size 2^( 6) =       0.000468720623
  error estimate for blocks of size 2^( 7) =       0.000470807706

      target function =                  N/A
              le_mean =     -16.905300333358
             les_mean =     286.124986171515
             stat err =       0.000462057976
             autocorr =       1.271549351865
              std dev =       0.579488548982
             le_variance =       0.335806978401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770314073
                                         uncertainty =       0.002899564496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770314073
                                         uncertainty =       0.002899564496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409760262
  error estimate for blocks of size 2^( 2) =       0.000422948172
  error estimate for blocks of size 2^( 3) =       0.000436397780
  error estimate for blocks of size 2^( 4) =       0.000448960825
  error estimate for blocks of size 2^( 5) =       0.000459742719
  error estimate for blocks of size 2^( 6) =       0.000468720610
  error estimate for blocks of size 2^( 7) =       0.000470807692

      target function =                  N/A
              le_mean =     -16.905300334321
             les_mean =     286.124986169614
             stat err =       0.000462057961
             autocorr =       1.271549404214
              std dev =       0.579488519238
             le_variance =       0.335806943928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770283929
                                         uncertainty =       0.002899564431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335770283929
                                         uncertainty =       0.002899564431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409760243
  error estimate for blocks of size 2^( 2) =       0.000422948154
  error estimate for blocks of size 2^( 3) =       0.000436397764
  error estimate for blocks of size 2^( 4) =       0.000448960811
  error estimate for blocks of size 2^( 5) =       0.000459742706
  error estimate for blocks of size 2^( 6) =       0.000468720599
  error estimate for blocks of size 2^( 7) =       0.000470807680

      target function =                  N/A
              le_mean =     -16.905300335164
             les_mean =     286.124986167972
             stat err =       0.000462057949
             autocorr =       1.271549450030
              std dev =       0.579488493214
             le_variance =       0.335806913767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905300335285        initial  <--
     9.0949e+02     9.0949e+03             2.8573e-07       -16.905300333358
     3.6380e+03     3.6380e+04             7.1432e-08       -16.905300334321
     1.4552e+04     1.4552e+05             1.7858e-08       -16.905300335164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6640
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.245893
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341060905306
                                         uncertainty =       0.004338168880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341060905306
                                         uncertainty =       0.004338168880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413018737
  error estimate for blocks of size 2^( 2) =       0.000425712620
  error estimate for blocks of size 2^( 3) =       0.000439221022
  error estimate for blocks of size 2^( 4) =       0.000451016652
  error estimate for blocks of size 2^( 5) =       0.000461101332
  error estimate for blocks of size 2^( 6) =       0.000469880629
  error estimate for blocks of size 2^( 7) =       0.000474079823

      target function =                  N/A
              le_mean =     -16.905299516383
             les_mean =     286.130320522983
             stat err =       0.000464019609
             autocorr =       1.262214479444
              std dev =       0.584096700005
             le_variance =       0.341168954957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529951638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299516383       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299516452       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299516472       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299516443       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299516459       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299516474       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299516478       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299516483       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.564345e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299516383       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299516400       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299516405       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299516398       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299516395       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299516410       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299516415       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299516415       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 8.910873e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299516383       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299516387       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299516388       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299516386       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299516378       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299516381       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299516351       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299516599       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.227719e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6347e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259145e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029768e-03 1 1  ON 34
eH1_5                 4.302982e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550581e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330734e-01 1 1  ON 41
eH2_2                -8.772363e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8208
    reference variance = 0.232252
====================================================
  Execution time = 2.0773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3411e-01
  Total weights = 2.0000e+06
  Execution time = 1.9015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157873544
                                         uncertainty =       0.002562590733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157873544
                                         uncertainty =       0.002562590733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408726750
  error estimate for blocks of size 2^( 2) =       0.000421441921
  error estimate for blocks of size 2^( 3) =       0.000434942015
  error estimate for blocks of size 2^( 4) =       0.000447328295
  error estimate for blocks of size 2^( 5) =       0.000458362525
  error estimate for blocks of size 2^( 6) =       0.000467740761
  error estimate for blocks of size 2^( 7) =       0.000472251774

      target function =                  N/A
              le_mean =     -16.905470381805
             les_mean =     286.129043775130
             stat err =       0.000461420839
             autocorr =       1.274466090913
              std dev =       0.578026912943
             le_variance =       0.334115112087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157877779
                                         uncertainty =       0.002562590737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157877779
                                         uncertainty =       0.002562590737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408726752
  error estimate for blocks of size 2^( 2) =       0.000421441924
  error estimate for blocks of size 2^( 3) =       0.000434942017
  error estimate for blocks of size 2^( 4) =       0.000447328298
  error estimate for blocks of size 2^( 5) =       0.000458362527
  error estimate for blocks of size 2^( 6) =       0.000467740763
  error estimate for blocks of size 2^( 7) =       0.000472251775

      target function =                  N/A
              le_mean =     -16.905470381668
             les_mean =     286.129043774718
             stat err =       0.000461420840
             autocorr =       1.274466084477
              std dev =       0.578026916611
             le_variance =       0.334115116326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157875662
                                         uncertainty =       0.002562590735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157875662
                                         uncertainty =       0.002562590735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408726751
  error estimate for blocks of size 2^( 2) =       0.000421441923
  error estimate for blocks of size 2^( 3) =       0.000434942016
  error estimate for blocks of size 2^( 4) =       0.000447328296
  error estimate for blocks of size 2^( 5) =       0.000458362526
  error estimate for blocks of size 2^( 6) =       0.000467740762
  error estimate for blocks of size 2^( 7) =       0.000472251774

      target function =                  N/A
              le_mean =     -16.905470381737
             les_mean =     286.129043774923
             stat err =       0.000461420840
             autocorr =       1.274466087690
              std dev =       0.578026914777
             le_variance =       0.334115114206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157873809
                                         uncertainty =       0.002562590733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334157873809
                                         uncertainty =       0.002562590733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408726750
  error estimate for blocks of size 2^( 2) =       0.000421441921
  error estimate for blocks of size 2^( 3) =       0.000434942015
  error estimate for blocks of size 2^( 4) =       0.000447328296
  error estimate for blocks of size 2^( 5) =       0.000458362525
  error estimate for blocks of size 2^( 6) =       0.000467740761
  error estimate for blocks of size 2^( 7) =       0.000472251774

      target function =                  N/A
              le_mean =     -16.905470381797
             les_mean =     286.129043775104
             stat err =       0.000461420839
             autocorr =       1.274466090510
              std dev =       0.578026913173
             le_variance =       0.334115112352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905470381805        initial  <--
     9.0949e+03     9.0949e+04             3.5643e-08       -16.905470381668
     3.6380e+04     3.6380e+05             8.9109e-09       -16.905470381737
     1.4552e+05     1.4552e+06             2.2277e-09       -16.905470381797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3467
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.517548
====================================================
  Execution time = 2.0633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3924e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068058985
                                         uncertainty =       0.003130587202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068058985
                                         uncertainty =       0.003130587202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411847521
  error estimate for blocks of size 2^( 2) =       0.000424741681
  error estimate for blocks of size 2^( 3) =       0.000437917451
  error estimate for blocks of size 2^( 4) =       0.000449784896
  error estimate for blocks of size 2^( 5) =       0.000460832532
  error estimate for blocks of size 2^( 6) =       0.000467050828
  error estimate for blocks of size 2^( 7) =       0.000469353016

      target function =                  N/A
              le_mean =     -16.905633398044
             les_mean =     286.139677180213
             stat err =       0.000461755318
             autocorr =       1.257045216362
              std dev =       0.582440349538
             le_variance =       0.339236760769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563339804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905633398044       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905633398042       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905633398047       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905633398047       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905633398046       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905633398051       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905633398069       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905633397905       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.291983e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905633398044       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905633398043       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905633398045       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905633398046       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905633398061       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905633398134       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905633398184       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905633398227       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.729959e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905633398044       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905633398044       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905633398044       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905633398230       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905633398042       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905633397678       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905633397740       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905633397488       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.432489e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6249e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029769e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.215472
====================================================
  Execution time = 2.2280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3259e-01
  Total weights = 2.0000e+06
  Execution time = 1.8983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645555
                                         uncertainty =       0.002236351549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645555
                                         uncertainty =       0.002236351549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407792567
  error estimate for blocks of size 2^( 2) =       0.000420877435
  error estimate for blocks of size 2^( 3) =       0.000434660609
  error estimate for blocks of size 2^( 4) =       0.000447658139
  error estimate for blocks of size 2^( 5) =       0.000458324375
  error estimate for blocks of size 2^( 6) =       0.000467324690
  error estimate for blocks of size 2^( 7) =       0.000470690450

      target function =                  N/A
              le_mean =     -16.905418842349
             les_mean =     286.125775624288
             stat err =       0.000460999414
             autocorr =       1.277974343710
              std dev =       0.576705778836
             le_variance =       0.332589555343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645991
                                         uncertainty =       0.002236351551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645991
                                         uncertainty =       0.002236351551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407792567
  error estimate for blocks of size 2^( 2) =       0.000420877435
  error estimate for blocks of size 2^( 3) =       0.000434660609
  error estimate for blocks of size 2^( 4) =       0.000447658140
  error estimate for blocks of size 2^( 5) =       0.000458324376
  error estimate for blocks of size 2^( 6) =       0.000467324690
  error estimate for blocks of size 2^( 7) =       0.000470690450

      target function =                  N/A
              le_mean =     -16.905418842336
             les_mean =     286.125775624281
             stat err =       0.000460999414
             autocorr =       1.277974343243
              std dev =       0.576705779214
             le_variance =       0.332589555779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645773
                                         uncertainty =       0.002236351550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645773
                                         uncertainty =       0.002236351550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407792567
  error estimate for blocks of size 2^( 2) =       0.000420877435
  error estimate for blocks of size 2^( 3) =       0.000434660609
  error estimate for blocks of size 2^( 4) =       0.000447658140
  error estimate for blocks of size 2^( 5) =       0.000458324376
  error estimate for blocks of size 2^( 6) =       0.000467324690
  error estimate for blocks of size 2^( 7) =       0.000470690450

      target function =                  N/A
              le_mean =     -16.905418842342
             les_mean =     286.125775624285
             stat err =       0.000460999414
             autocorr =       1.277974343472
              std dev =       0.576705779025
             le_variance =       0.332589555561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645582
                                         uncertainty =       0.002236351549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720645582
                                         uncertainty =       0.002236351549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407792567
  error estimate for blocks of size 2^( 2) =       0.000420877435
  error estimate for blocks of size 2^( 3) =       0.000434660609
  error estimate for blocks of size 2^( 4) =       0.000447658139
  error estimate for blocks of size 2^( 5) =       0.000458324375
  error estimate for blocks of size 2^( 6) =       0.000467324690
  error estimate for blocks of size 2^( 7) =       0.000470690450

      target function =                  N/A
              le_mean =     -16.905418842348
             les_mean =     286.125775624288
             stat err =       0.000460999414
             autocorr =       1.277974343671
              std dev =       0.576705778860
             le_variance =       0.332589555370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905418842349        initial  <--
     9.0949e+04     9.0949e+05             2.2920e-09       -16.905418842336
     3.6380e+05     3.6380e+06             5.7300e-10       -16.905418842342
     1.4552e+06     1.4552e+07             1.4325e-10       -16.905418842348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8479
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.251815
====================================================
  Execution time = 2.0598e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341132049428
                                         uncertainty =       0.006573961541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341132049428
                                         uncertainty =       0.006573961541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412944836
  error estimate for blocks of size 2^( 2) =       0.000425789683
  error estimate for blocks of size 2^( 3) =       0.000438560555
  error estimate for blocks of size 2^( 4) =       0.000450862829
  error estimate for blocks of size 2^( 5) =       0.000461878526
  error estimate for blocks of size 2^( 6) =       0.000470141645
  error estimate for blocks of size 2^( 7) =       0.000472588157

      target function =                  N/A
              le_mean =     -16.904704011120
             les_mean =     286.110064408357
             stat err =       0.000463867789
             autocorr =       1.261840183387
              std dev =       0.583992187711
             le_variance =       0.341046875307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690470401112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904704011120       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904704011121       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904704011121       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904704011140       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904704011220       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904704010703       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904704010756       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 2.663509e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904704011120       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904704011120       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904704011120       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904704013832       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904704011120       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904704011120       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904704011349       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.658780e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904704011120       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904704011120       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904704011120       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904704011120       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904704014839       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904704007131       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904704009113       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.664690e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6336e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8899
    reference variance = 0.213952
====================================================
  Execution time = 2.2602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4328e-01
  Total weights = 2.0000e+06
  Execution time = 1.8973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502493
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502493
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414296905
  error estimate for blocks of size 2^( 2) =       0.000427285846
  error estimate for blocks of size 2^( 3) =       0.000440611930
  error estimate for blocks of size 2^( 4) =       0.000453116170
  error estimate for blocks of size 2^( 5) =       0.000464625711
  error estimate for blocks of size 2^( 6) =       0.000473406523
  error estimate for blocks of size 2^( 7) =       0.000481356141

      target function =                  N/A
              le_mean =     -16.905481226418
             les_mean =     286.138579176284
             stat err =       0.000468126136
             autocorr =       1.276739810570
              std dev =       0.585904302043
             le_variance =       0.343283851152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502546
                                         uncertainty =       0.004799682280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502546
                                         uncertainty =       0.004799682280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414296905
  error estimate for blocks of size 2^( 2) =       0.000427285846
  error estimate for blocks of size 2^( 3) =       0.000440611930
  error estimate for blocks of size 2^( 4) =       0.000453116170
  error estimate for blocks of size 2^( 5) =       0.000464625711
  error estimate for blocks of size 2^( 6) =       0.000473406523
  error estimate for blocks of size 2^( 7) =       0.000481356141

      target function =                  N/A
              le_mean =     -16.905481226417
             les_mean =     286.138579176312
             stat err =       0.000468126136
             autocorr =       1.276739810482
              std dev =       0.585904302088
             le_variance =       0.343283851205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502519
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502519
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414296905
  error estimate for blocks of size 2^( 2) =       0.000427285846
  error estimate for blocks of size 2^( 3) =       0.000440611930
  error estimate for blocks of size 2^( 4) =       0.000453116170
  error estimate for blocks of size 2^( 5) =       0.000464625711
  error estimate for blocks of size 2^( 6) =       0.000473406523
  error estimate for blocks of size 2^( 7) =       0.000481356141

      target function =                  N/A
              le_mean =     -16.905481226418
             les_mean =     286.138579176298
             stat err =       0.000468126136
             autocorr =       1.276739810520
              std dev =       0.585904302065
             le_variance =       0.343283851179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502496
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397502496
                                         uncertainty =       0.004799682279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414296905
  error estimate for blocks of size 2^( 2) =       0.000427285846
  error estimate for blocks of size 2^( 3) =       0.000440611930
  error estimate for blocks of size 2^( 4) =       0.000453116170
  error estimate for blocks of size 2^( 5) =       0.000464625711
  error estimate for blocks of size 2^( 6) =       0.000473406523
  error estimate for blocks of size 2^( 7) =       0.000481356141

      target function =                  N/A
              le_mean =     -16.905481226418
             les_mean =     286.138579176286
             stat err =       0.000468126136
             autocorr =       1.276739810557
              std dev =       0.585904302046
             le_variance =       0.343283851156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905481226418        initial  <--
     9.0949e+05     9.0949e+06             2.6635e-10       -16.905481226417
     3.6380e+06     3.6380e+07             6.6588e-11       -16.905481226418
     1.4552e+07     1.4552e+08             1.6647e-11       -16.905481226418

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2229
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9585
    reference variance = 0.273539
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4769e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347657928719
                                         uncertainty =       0.005012118875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347657928719
                                         uncertainty =       0.005012118875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416948477
  error estimate for blocks of size 2^( 2) =       0.000429451892
  error estimate for blocks of size 2^( 3) =       0.000442037760
  error estimate for blocks of size 2^( 4) =       0.000454904538
  error estimate for blocks of size 2^( 5) =       0.000465438683
  error estimate for blocks of size 2^( 6) =       0.000472739213
  error estimate for blocks of size 2^( 7) =       0.000478044719

      target function =                  N/A
              le_mean =     -16.905933165345
             les_mean =     286.158268083000
             stat err =       0.000467781788
             autocorr =       1.258698848489
              std dev =       0.589654191644
             le_variance =       0.347692065723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593316535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933165345       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933165345       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933165345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933164836       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933167606       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933164931       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933165573       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933167367       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 2.734877e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933165345       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933165345       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933165345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933154156       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933168929       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933174917       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933172103       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933160552       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 6.837242e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933165345       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933165345       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933165345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933141370       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933147660       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933126082       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933281353       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933138392       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.709322e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.241849
====================================================
  Execution time = 2.0275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3420e-01
  Total weights = 2.0000e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238381
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238381
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408780630
  error estimate for blocks of size 2^( 2) =       0.000421377371
  error estimate for blocks of size 2^( 3) =       0.000433906154
  error estimate for blocks of size 2^( 4) =       0.000445868903
  error estimate for blocks of size 2^( 5) =       0.000457453709
  error estimate for blocks of size 2^( 6) =       0.000462534226
  error estimate for blocks of size 2^( 7) =       0.000465488757

      target function =                  N/A
              le_mean =     -16.905541579951
             les_mean =     286.131539150887
             stat err =       0.000457836399
             autocorr =       1.254411471540
              std dev =       0.578103110650
             le_variance =       0.334203206543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238379
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238379
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408780630
  error estimate for blocks of size 2^( 2) =       0.000421377371
  error estimate for blocks of size 2^( 3) =       0.000433906154
  error estimate for blocks of size 2^( 4) =       0.000445868903
  error estimate for blocks of size 2^( 5) =       0.000457453709
  error estimate for blocks of size 2^( 6) =       0.000462534226
  error estimate for blocks of size 2^( 7) =       0.000465488757

      target function =                  N/A
              le_mean =     -16.905541579951
             les_mean =     286.131539150882
             stat err =       0.000457836399
             autocorr =       1.254411471533
              std dev =       0.578103110648
             le_variance =       0.334203206541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238380
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238380
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408780630
  error estimate for blocks of size 2^( 2) =       0.000421377371
  error estimate for blocks of size 2^( 3) =       0.000433906154
  error estimate for blocks of size 2^( 4) =       0.000445868903
  error estimate for blocks of size 2^( 5) =       0.000457453709
  error estimate for blocks of size 2^( 6) =       0.000462534226
  error estimate for blocks of size 2^( 7) =       0.000465488757

      target function =                  N/A
              le_mean =     -16.905541579951
             les_mean =     286.131539150885
             stat err =       0.000457836399
             autocorr =       1.254411471530
              std dev =       0.578103110649
             le_variance =       0.334203206542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238381
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334142238381
                                         uncertainty =       0.003549682350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408780630
  error estimate for blocks of size 2^( 2) =       0.000421377371
  error estimate for blocks of size 2^( 3) =       0.000433906154
  error estimate for blocks of size 2^( 4) =       0.000445868903
  error estimate for blocks of size 2^( 5) =       0.000457453709
  error estimate for blocks of size 2^( 6) =       0.000462534226
  error estimate for blocks of size 2^( 7) =       0.000465488757

      target function =                  N/A
              le_mean =     -16.905541579951
             les_mean =     286.131539150887
             stat err =       0.000457836399
             autocorr =       1.254411471540
              std dev =       0.578103110650
             le_variance =       0.334203206543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905541579951        initial  <--
     9.0949e+06     9.0949e+07             2.7349e-11       -16.905541579951
     3.6380e+07     3.6380e+08             6.8372e-12       -16.905541579951
     1.4552e+08     1.4552e+09             1.7093e-12       -16.905541579951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8584
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.294983
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3625e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336352755875
                                         uncertainty =       0.003501007419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336352755875
                                         uncertainty =       0.003501007419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410032054
  error estimate for blocks of size 2^( 2) =       0.000423173401
  error estimate for blocks of size 2^( 3) =       0.000436514684
  error estimate for blocks of size 2^( 4) =       0.000449733595
  error estimate for blocks of size 2^( 5) =       0.000461611423
  error estimate for blocks of size 2^( 6) =       0.000472183447
  error estimate for blocks of size 2^( 7) =       0.000480390805

      target function =                  N/A
              le_mean =     -16.905383889828
             les_mean =     286.128256864552
             stat err =       0.000465979817
             autocorr =       1.291512449345
              std dev =       0.579872891443
             le_variance =       0.336252570230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538388983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905383889828       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905383889828       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905383889828       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905383889828       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905383889828       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905383954728       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905383934252       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905383912203       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+07 is 3.193537e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905383889828       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905383889828       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905383889828       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905383872225       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905383918976       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905383843256       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905383782656       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905383789305       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+08 is 7.982086e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905383889828       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905383889828       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905383889828       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905383889828       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905383591257       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905384485522       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905384297360       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905383090815       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.997228e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6290e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8699
    reference variance = 0.286997
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4110e-01
  Total weights = 2.0000e+06
  Execution time = 1.8998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412977419
  error estimate for blocks of size 2^( 2) =       0.000425748886
  error estimate for blocks of size 2^( 3) =       0.000438414520
  error estimate for blocks of size 2^( 4) =       0.000450284337
  error estimate for blocks of size 2^( 5) =       0.000460566720
  error estimate for blocks of size 2^( 6) =       0.000468070709
  error estimate for blocks of size 2^( 7) =       0.000475263399

      target function =                  N/A
              le_mean =     -16.905809976198
             les_mean =     286.147511478332
             stat err =       0.000463546291
             autocorr =       1.259892843798
              std dev =       0.584038267207
             le_variance =       0.341100697562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412977419
  error estimate for blocks of size 2^( 2) =       0.000425748886
  error estimate for blocks of size 2^( 3) =       0.000438414520
  error estimate for blocks of size 2^( 4) =       0.000450284337
  error estimate for blocks of size 2^( 5) =       0.000460566720
  error estimate for blocks of size 2^( 6) =       0.000468070709
  error estimate for blocks of size 2^( 7) =       0.000475263399

      target function =                  N/A
              le_mean =     -16.905809976198
             les_mean =     286.147511478332
             stat err =       0.000463546291
             autocorr =       1.259892843792
              std dev =       0.584038267208
             le_variance =       0.341100697563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412977419
  error estimate for blocks of size 2^( 2) =       0.000425748886
  error estimate for blocks of size 2^( 3) =       0.000438414520
  error estimate for blocks of size 2^( 4) =       0.000450284337
  error estimate for blocks of size 2^( 5) =       0.000460566720
  error estimate for blocks of size 2^( 6) =       0.000468070709
  error estimate for blocks of size 2^( 7) =       0.000475263399

      target function =                  N/A
              le_mean =     -16.905809976198
             les_mean =     286.147511478332
             stat err =       0.000463546291
             autocorr =       1.259892843791
              std dev =       0.584038267207
             le_variance =       0.341100697562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050754774
                                         uncertainty =       0.004298207848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412977419
  error estimate for blocks of size 2^( 2) =       0.000425748886
  error estimate for blocks of size 2^( 3) =       0.000438414520
  error estimate for blocks of size 2^( 4) =       0.000450284337
  error estimate for blocks of size 2^( 5) =       0.000460566720
  error estimate for blocks of size 2^( 6) =       0.000468070709
  error estimate for blocks of size 2^( 7) =       0.000475263399

      target function =                  N/A
              le_mean =     -16.905809976198
             les_mean =     286.147511478332
             stat err =       0.000463546291
             autocorr =       1.259892843794
              std dev =       0.584038267207
             le_variance =       0.341100697562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905809976198        initial
     9.0949e+07     9.0949e+08             3.1935e-12       -16.905809976198
     3.6380e+08     3.6380e+09             7.9821e-13       -16.905809976198  <--
     1.4552e+09     1.4552e+10             1.9972e-13       -16.905809976198

*****************************************************************************
Applying the update for shift_i =   3.6380e+08     and shift_s =   3.6380e+09
*****************************************************************************

  Execution time = 2.9891e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.079106e-01 1 1  ON 0
 uu_1                 1.414872e-01 1 1  ON 1
 uu_2                 4.040895e-02 1 1  ON 2
 uu_3                -2.117369e-02 1 1  ON 3
 uu_4                -6.482637e-02 1 1  ON 4
 uu_5                -9.747604e-02 1 1  ON 5
 uu_6                -1.234263e-01 1 1  ON 6
 uu_7                -1.357650e-01 1 1  ON 7
 uu_8                -1.274547e-01 1 1  ON 8
 uu_9                -9.752215e-02 1 1  ON 9
 ud_0                 4.441986e-01 1 1  ON 10
 ud_1                 1.786068e-01 1 1  ON 11
 ud_2                 5.890248e-02 1 1  ON 12
 ud_3                -1.150622e-02 1 1  ON 13
 ud_4                -6.773906e-02 1 1  ON 14
 ud_5                -1.076700e-01 1 1  ON 15
 ud_6                -1.339874e-01 1 1  ON 16
 ud_7                -1.490558e-01 1 1  ON 17
 ud_8                -1.486638e-01 1 1  ON 18
 ud_9                -1.365741e-01 1 1  ON 19
 eO_0                -7.579714e-01 1 1  ON 20
 eO_1                -4.375032e-01 1 1  ON 21
 eO_2                -1.674494e-02 1 1  ON 22
 eO_3                 3.017912e-01 1 1  ON 23
 eO_4                 5.193468e-01 1 1  ON 24
 eO_5                 4.742369e-01 1 1  ON 25
 eO_6                 2.434598e-01 1 1  ON 26
 eO_7                -5.259146e-02 1 1  ON 27
 eO_8                -2.083772e-01 1 1  ON 28
 eO_9                -6.722369e-02 1 1  ON 29
eH1_0                -2.347049e-01 1 1  ON 30
eH1_1                -1.361568e-01 1 1  ON 31
eH1_2                -9.078380e-02 1 1  ON 32
eH1_3                -3.803666e-02 1 1  ON 33
eH1_4                 9.029770e-03 1 1  ON 34
eH1_5                 4.302983e-02 1 1  ON 35
eH1_6                 9.881430e-02 1 1  ON 36
eH1_7                 1.472428e-01 1 1  ON 37
eH1_8                 1.604259e-01 1 1  ON 38
eH1_9                 4.550580e-02 1 1  ON 39
eH2_0                -2.317643e-01 1 1  ON 40
eH2_1                -1.330733e-01 1 1  ON 41
eH2_2                -8.772362e-02 1 1  ON 42
eH2_3                -3.473919e-02 1 1  ON 43
eH2_4                 1.200354e-02 1 1  ON 44
eH2_5                 4.604128e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.493255e-01 1 1  ON 47
eH2_8                 1.660445e-01 1 1  ON 48
eH2_9                 2.950543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6187e+01 secs
  Total Execution time = 2.2868e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
