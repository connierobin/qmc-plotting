Rank =    0  Free Memory = 89087 MB
Rank =    1  Free Memory = 89087 MB
Rank =    2  Free Memory = 89087 MB
Rank =    3  Free Memory = 89087 MB
Rank =    4  Free Memory = 89087 MB
Rank =    5  Free Memory = 89087 MB
Rank =    6  Free Memory = 89087 MB
Rank =    7  Free Memory = 89087 MB
Rank =    8  Free Memory = 89087 MB
Rank =    9  Free Memory = 89087 MB
Rank =   10  Free Memory = 89087 MB
Rank =   11  Free Memory = 89087 MB
Rank =   12  Free Memory = 89087 MB
Rank =   13  Free Memory = 89087 MB
Rank =   14  Free Memory = 89086 MB
Rank =   15  Free Memory = 89071 MB
Rank =   16  Free Memory = 89071 MB
Rank =   17  Free Memory = 89071 MB
Rank =   18  Free Memory = 89071 MB
Rank =   19  Free Memory = 89071 MB
Rank =   20  Free Memory = 89071 MB
Rank =   21  Free Memory = 89071 MB
Rank =   22  Free Memory = 89071 MB
Rank =   23  Free Memory = 89071 MB
Rank =   24  Free Memory = 89071 MB
Rank =   25  Free Memory = 89071 MB
Rank =   26  Free Memory = 89071 MB
Rank =   27  Free Memory = 89071 MB
Rank =   28  Free Memory = 89071 MB
Rank =   29  Free Memory = 89071 MB
Rank =   30  Free Memory = 89071 MB
Rank =   31  Free Memory = 89071 MB
Rank =   32  Free Memory = 86142 MB
Rank =   33  Free Memory = 86142 MB
Rank =   34  Free Memory = 86142 MB
Rank =   35  Free Memory = 86142 MB
Rank =   36  Free Memory = 86142 MB
Rank =   37  Free Memory = 86142 MB
Rank =   38  Free Memory = 86142 MB
Rank =   39  Free Memory = 86142 MB
Rank =   40  Free Memory = 86142 MB
Rank =   41  Free Memory = 86142 MB
Rank =   42  Free Memory = 86142 MB
Rank =   43  Free Memory = 86142 MB
Rank =   44  Free Memory = 86142 MB
Rank =   45  Free Memory = 86142 MB
Rank =   46  Free Memory = 86142 MB
Rank =   47  Free Memory = 86142 MB
Rank =   48  Free Memory = 86142 MB
Rank =   49  Free Memory = 86142 MB
Rank =   50  Free Memory = 86142 MB
Rank =   51  Free Memory = 86142 MB
Rank =   52  Free Memory = 86142 MB
Rank =   53  Free Memory = 86142 MB
Rank =   54  Free Memory = 86142 MB
Rank =   55  Free Memory = 86142 MB
Rank =   56  Free Memory = 86142 MB
Rank =   57  Free Memory = 86142 MB
Rank =   58  Free Memory = 86141 MB
Rank =   59  Free Memory = 86141 MB
Rank =   60  Free Memory = 86141 MB
Rank =   61  Free Memory = 86141 MB
Rank =   62  Free Memory = 86141 MB
Rank =   63  Free Memory = 86141 MB
Rank =   64  Free Memory = 89873 MB
Rank =   65  Free Memory = 89873 MB
Rank =   66  Free Memory = 89873 MB
Rank =   67  Free Memory = 89873 MB
Rank =   68  Free Memory = 89873 MB
Rank =   69  Free Memory = 89873 MB
Rank =   70  Free Memory = 89873 MB
Rank =   71  Free Memory = 89873 MB
Rank =   72  Free Memory = 89873 MB
Rank =   73  Free Memory = 89873 MB
Rank =   74  Free Memory = 89873 MB
Rank =   75  Free Memory = 89873 MB
Rank =   76  Free Memory = 89873 MB
Rank =   77  Free Memory = 89873 MB
Rank =   78  Free Memory = 89873 MB
Rank =   79  Free Memory = 89873 MB
Rank =   80  Free Memory = 89873 MB
Rank =   81  Free Memory = 89873 MB
Rank =   82  Free Memory = 89873 MB
Rank =   83  Free Memory = 89873 MB
Rank =   84  Free Memory = 89873 MB
Rank =   85  Free Memory = 89873 MB
Rank =   86  Free Memory = 89873 MB
Rank =   87  Free Memory = 89873 MB
Rank =   88  Free Memory = 89873 MB
Rank =   89  Free Memory = 89873 MB
Rank =   90  Free Memory = 89873 MB
Rank =   91  Free Memory = 89873 MB
Rank =   92  Free Memory = 89873 MB
Rank =   93  Free Memory = 89873 MB
Rank =   94  Free Memory = 89873 MB
Rank =   95  Free Memory = 89873 MB
Rank =   96  Free Memory = 90157 MB
Rank =   97  Free Memory = 90157 MB
Rank =   98  Free Memory = 90157 MB
Rank =   99  Free Memory = 90157 MB
Rank =  100  Free Memory = 90157 MB
Rank =  101  Free Memory = 90157 MB
Rank =  102  Free Memory = 90157 MB
Rank =  103  Free Memory = 90157 MB
Rank =  104  Free Memory = 90157 MB
Rank =  105  Free Memory = 90157 MB
Rank =  106  Free Memory = 90157 MB
Rank =  107  Free Memory = 90157 MB
Rank =  108  Free Memory = 90157 MB
Rank =  109  Free Memory = 90157 MB
Rank =  110  Free Memory = 90157 MB
Rank =  111  Free Memory = 90157 MB
Rank =  112  Free Memory = 90157 MB
Rank =  113  Free Memory = 90157 MB
Rank =  114  Free Memory = 90157 MB
Rank =  115  Free Memory = 90157 MB
Rank =  116  Free Memory = 90157 MB
Rank =  117  Free Memory = 90157 MB
Rank =  118  Free Memory = 90157 MB
Rank =  119  Free Memory = 90157 MB
Rank =  120  Free Memory = 90157 MB
Rank =  121  Free Memory = 90157 MB
Rank =  122  Free Memory = 90157 MB
Rank =  123  Free Memory = 90157 MB
Rank =  124  Free Memory = 90157 MB
Rank =  125  Free Memory = 90157 MB
Rank =  126  Free Memory = 90157 MB
Rank =  127  Free Memory = 90157 MB
  Input file(s): opt_h2o_1b1_gvptt_run002j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002j.xml

  Project = H2O
  date    = 2023-04-02 10:37:22 PDT
  host    = n0054.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 338

  Range of prime numbers to use as seeds over processors and threads = 2287-3323


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.088364e-01    1         1  ON     0
     uu_1                 1.420892e-01    1         1  ON     1
     uu_2                 4.083271e-02    1         1  ON     2
     uu_3                -2.129604e-02    1         1  ON     3
     uu_4                -6.580117e-02    1         1  ON     4
     uu_5                -9.964308e-02    1         1  ON     5
     uu_6                -1.260401e-01    1         1  ON     6
     uu_7                -1.389344e-01    1         1  ON     7
     uu_8                -1.311686e-01    1         1  ON     8
     uu_9                -1.014899e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.493187e-01    1         1  ON     0
     ud_1                 1.828244e-01    1         1  ON     1
     ud_2                 6.186965e-02    1         1  ON     2
     ud_3                -9.907872e-03    1         1  ON     3
     ud_4                -6.714290e-02    1         1  ON     4
     ud_5                -1.085363e-01    1         1  ON     5
     ud_6                -1.354156e-01    1         1  ON     6
     ud_7                -1.511958e-01    1         1  ON     7
     ud_8                -1.511657e-01    1         1  ON     8
     ud_9                -1.396837e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.653852e-01    1         1  ON     0
     eO_1                -4.431724e-01    1         1  ON     1
     eO_2                -1.998623e-02    1         1  ON     2
     eO_3                 3.023700e-01    1         1  ON     3
     eO_4                 5.267864e-01    1         1  ON     4
     eO_5                 4.857958e-01    1         1  ON     5
     eO_6                 2.551754e-01    1         1  ON     6
     eO_7                -4.706179e-02    1         1  ON     7
     eO_8                -2.179902e-01    1         1  ON     8
     eO_9                -7.680229e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.422767e-01    1         1  ON     0
     eH1_1                -1.422367e-01    1         1  ON     1
     eH1_2                -9.540408e-02    1         1  ON     2
     eH1_3                -4.176552e-02    1         1  ON     3
     eH1_4                 6.576405e-03    1         1  ON     4
     eH1_5                 4.071741e-02    1         1  ON     5
     eH1_6                 9.816338e-02    1         1  ON     6
     eH1_7                 1.506074e-01    1         1  ON     7
     eH1_8                 1.723549e-01    1         1  ON     8
     eH1_9                 5.736343e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.370699e-01    1         1  ON     0
     eH2_1                -1.377256e-01    1         1  ON     1
     eH2_2                -9.173521e-02    1         1  ON     2
     eH2_3                -3.775251e-02    1         1  ON     3
     eH2_4                 9.915103e-03    1         1  ON     4
     eH2_5                 4.334430e-02    1         1  ON     5
     eH2_6                 9.908431e-02    1         1  ON     6
     eH2_7                 1.497877e-01    1         1  ON     7
     eH2_8                 1.754636e-01    1         1  ON     8
     eH2_9                 4.425327e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.590760e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 8.1653e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9562
    reference variance = 0.238687
====================================================
  Execution time = 4.0500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3356e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0729e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333540538585
                                         uncertainty =       0.002606528482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333540538585
                                         uncertainty =       0.002606528482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384684
  error estimate for blocks of size 2^( 2) =       0.000421575026
  error estimate for blocks of size 2^( 3) =       0.000435264237
  error estimate for blocks of size 2^( 4) =       0.000447733040
  error estimate for blocks of size 2^( 5) =       0.000459291919
  error estimate for blocks of size 2^( 6) =       0.000467620746
  error estimate for blocks of size 2^( 7) =       0.000475425109

      target function =                  N/A
              le_mean =     -16.904553070042
             les_mean =     286.097470431927
             stat err =       0.000462517703
             autocorr =       1.282678538749
              std dev =       0.577543159285
             le_variance =       0.333556100837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690455307004e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904553070042       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904555204929       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904555236693       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904555949337       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904556089884       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904556641539       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904556896375       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904556972960       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904556996675       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904557006052       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.484303e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904553070042       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904553887129       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904553900683       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904554201308       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904554449221       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904554547998       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904554549927       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904554510425       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904554541586       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.561159e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904553070042       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904553305576       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904553312918       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904553405066       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904553484226       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904553531410       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904553515155       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904553504100       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.971240e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1366e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.089110e-01                 1 1 ON  0
uu_1  1.421305e-01                 1 1 ON  1
uu_2  4.080850e-02                 1 1 ON  2
uu_3  -2.124351e-02                1 1 ON  3
uu_4  -6.586208e-02                1 1 ON  4
uu_5  -9.970728e-02                1 1 ON  5
uu_6  -1.261127e-01                1 1 ON  6
uu_7  -1.389922e-01                1 1 ON  7
uu_8  -1.312277e-01                1 1 ON  8
uu_9  -1.015187e-01                1 1 ON  9
ud_0  4.492616e-01                 1 1 ON  10
ud_1  1.828112e-01                 1 1 ON  11
ud_2  6.187013e-02                 1 1 ON  12
ud_3  -9.903537e-03                1 1 ON  13
ud_4  -6.718000e-02                1 1 ON  14
ud_5  -1.084908e-01                1 1 ON  15
ud_6  -1.354287e-01                1 1 ON  16
ud_7  -1.511885e-01                1 1 ON  17
ud_8  -1.510751e-01                1 1 ON  18
ud_9  -1.396900e-01                1 1 ON  19
eO_0  -7.654259e-01                1 1 ON  20
eO_1  -4.431987e-01                1 1 ON  21
eO_2  -2.011017e-02                1 1 ON  22
eO_3  3.023567e-01                 1 1 ON  23
eO_4  5.269606e-01                 1 1 ON  24
eO_5  4.859204e-01                 1 1 ON  25
eO_6  2.552533e-01                 1 1 ON  26
eO_7  -4.700455e-02                1 1 ON  27
eO_8  -2.180811e-01                1 1 ON  28
eO_9  -7.692270e-02                1 1 ON  29
eH1_0 -2.424051e-01                1 1 ON  30
eH1_1 -1.423532e-01                1 1 ON  31
eH1_2 -9.550364e-02                1 1 ON  32
eH1_3 -4.184256e-02                1 1 ON  33
eH1_4 6.320289e-03                 1 1 ON  34
eH1_5 4.062841e-02                 1 1 ON  35
eH1_6 9.827020e-02                 1 1 ON  36
eH1_7 1.507668e-01                 1 1 ON  37
eH1_8 1.725790e-01                 1 1 ON  38
eH1_9 5.760295e-02                 1 1 ON  39
eH2_0 -2.372530e-01                1 1 ON  40
eH2_1 -1.378759e-01                1 1 ON  41
eH2_2 -9.166565e-02                1 1 ON  42
eH2_3 -3.780399e-02                1 1 ON  43
eH2_4 9.858217e-03                 1 1 ON  44
eH2_5 4.334631e-02                 1 1 ON  45
eH2_6 9.912327e-02                 1 1 ON  46
eH2_7 1.498681e-01                 1 1 ON  47
eH2_8 1.755544e-01                 1 1 ON  48
eH2_9 4.440766e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9089
    reference variance = 0.232931
====================================================
  Execution time = 3.9829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4028e-01
  Total weights = 2.0000e+06
  Execution time = 3.7113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340420313402
                                         uncertainty =       0.003607949655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340420313402
                                         uncertainty =       0.003607949655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412505135
  error estimate for blocks of size 2^( 2) =       0.000425018730
  error estimate for blocks of size 2^( 3) =       0.000437963050
  error estimate for blocks of size 2^( 4) =       0.000450202544
  error estimate for blocks of size 2^( 5) =       0.000460257407
  error estimate for blocks of size 2^( 6) =       0.000467263757
  error estimate for blocks of size 2^( 7) =       0.000468493386

      target function =                  N/A
              le_mean =     -16.906688225757
             les_mean =     286.176427565439
             stat err =       0.000461554274
             autocorr =       1.251949568950
              std dev =       0.583370356328
             le_variance =       0.340320972642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340360648358
                                         uncertainty =       0.003607257395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340360648358
                                         uncertainty =       0.003607257395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412468933
  error estimate for blocks of size 2^( 2) =       0.000424986810
  error estimate for blocks of size 2^( 3) =       0.000437937431
  error estimate for blocks of size 2^( 4) =       0.000450178786
  error estimate for blocks of size 2^( 5) =       0.000460233534
  error estimate for blocks of size 2^( 6) =       0.000467234541
  error estimate for blocks of size 2^( 7) =       0.000468448532

      target function =                  N/A
              le_mean =     -16.906684952219
             les_mean =     286.176257145033
             stat err =       0.000461523848
             autocorr =       1.252004263281
              std dev =       0.583319159274
             le_variance =       0.340261241576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340348815597
                                         uncertainty =       0.003607201411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340348815597
                                         uncertainty =       0.003607201411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412461767
  error estimate for blocks of size 2^( 2) =       0.000424978714
  error estimate for blocks of size 2^( 3) =       0.000437928570
  error estimate for blocks of size 2^( 4) =       0.000450170502
  error estimate for blocks of size 2^( 5) =       0.000460225939
  error estimate for blocks of size 2^( 6) =       0.000467228489
  error estimate for blocks of size 2^( 7) =       0.000468446490

      target function =                  N/A
              le_mean =     -16.906685048593
             les_mean =     286.176248580565
             stat err =       0.000461517855
             autocorr =       1.252015251655
              std dev =       0.583309024755
             le_variance =       0.340249418360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340409049493
                                         uncertainty =       0.003607834592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340409049493
                                         uncertainty =       0.003607834592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412498304
  error estimate for blocks of size 2^( 2) =       0.000425012370
  error estimate for blocks of size 2^( 3) =       0.000437957489
  error estimate for blocks of size 2^( 4) =       0.000450197335
  error estimate for blocks of size 2^( 5) =       0.000460252262
  error estimate for blocks of size 2^( 6) =       0.000467258031
  error estimate for blocks of size 2^( 7) =       0.000468485933

      target function =                  N/A
              le_mean =     -16.906687664925
             les_mean =     286.176397330629
             stat err =       0.000461548391
             autocorr =       1.251959118148
              std dev =       0.583360695859
             le_variance =       0.340309701473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906688225757        initial  <--
     2.5000e-01     2.5000e+00             9.4843e-04       -16.906684952219
     1.0000e+00     1.0000e+01             2.5612e-04       -16.906685048593
     4.0000e+00     4.0000e+01             6.9712e-05       -16.906687664925

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.5101
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.088364e-01 1 1  ON 0
 uu_1                 1.420892e-01 1 1  ON 1
 uu_2                 4.083271e-02 1 1  ON 2
 uu_3                -2.129604e-02 1 1  ON 3
 uu_4                -6.580117e-02 1 1  ON 4
 uu_5                -9.964308e-02 1 1  ON 5
 uu_6                -1.260401e-01 1 1  ON 6
 uu_7                -1.389344e-01 1 1  ON 7
 uu_8                -1.311686e-01 1 1  ON 8
 uu_9                -1.014899e-01 1 1  ON 9
 ud_0                 4.493187e-01 1 1  ON 10
 ud_1                 1.828244e-01 1 1  ON 11
 ud_2                 6.186965e-02 1 1  ON 12
 ud_3                -9.907872e-03 1 1  ON 13
 ud_4                -6.714290e-02 1 1  ON 14
 ud_5                -1.085363e-01 1 1  ON 15
 ud_6                -1.354156e-01 1 1  ON 16
 ud_7                -1.511958e-01 1 1  ON 17
 ud_8                -1.511657e-01 1 1  ON 18
 ud_9                -1.396837e-01 1 1  ON 19
 eO_0                -7.653852e-01 1 1  ON 20
 eO_1                -4.431724e-01 1 1  ON 21
 eO_2                -1.998623e-02 1 1  ON 22
 eO_3                 3.023700e-01 1 1  ON 23
 eO_4                 5.267864e-01 1 1  ON 24
 eO_5                 4.857958e-01 1 1  ON 25
 eO_6                 2.551754e-01 1 1  ON 26
 eO_7                -4.706179e-02 1 1  ON 27
 eO_8                -2.179902e-01 1 1  ON 28
 eO_9                -7.680229e-02 1 1  ON 29
eH1_0                -2.422767e-01 1 1  ON 30
eH1_1                -1.422367e-01 1 1  ON 31
eH1_2                -9.540408e-02 1 1  ON 32
eH1_3                -4.176552e-02 1 1  ON 33
eH1_4                 6.576405e-03 1 1  ON 34
eH1_5                 4.071741e-02 1 1  ON 35
eH1_6                 9.816338e-02 1 1  ON 36
eH1_7                 1.506074e-01 1 1  ON 37
eH1_8                 1.723549e-01 1 1  ON 38
eH1_9                 5.736343e-02 1 1  ON 39
eH2_0                -2.370699e-01 1 1  ON 40
eH2_1                -1.377256e-01 1 1  ON 41
eH2_2                -9.173521e-02 1 1  ON 42
eH2_3                -3.775251e-02 1 1  ON 43
eH2_4                 9.915103e-03 1 1  ON 44
eH2_5                 4.334430e-02 1 1  ON 45
eH2_6                 9.908431e-02 1 1  ON 46
eH2_7                 1.497877e-01 1 1  ON 47
eH2_8                 1.754636e-01 1 1  ON 48
eH2_9                 4.425327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.304996
====================================================
  Execution time = 4.0449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3852e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0550e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338576745781
                                         uncertainty =       0.003478314042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338576745781
                                         uncertainty =       0.003478314042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411409671
  error estimate for blocks of size 2^( 2) =       0.000424070457
  error estimate for blocks of size 2^( 3) =       0.000437376273
  error estimate for blocks of size 2^( 4) =       0.000449877468
  error estimate for blocks of size 2^( 5) =       0.000460244547
  error estimate for blocks of size 2^( 6) =       0.000465512595
  error estimate for blocks of size 2^( 7) =       0.000467704067

      target function =                  N/A
              le_mean =     -16.906947022264
             les_mean =     286.183373279176
             stat err =       0.000460834669
             autocorr =       1.254704037128
              std dev =       0.581821136434
             le_variance =       0.338515834801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690694702226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947022264       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906946906372       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906946762241       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906946713879       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906946811038       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906946846193       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906946819781       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906946839346       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.679248e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947022264       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906946991879       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906946950070       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906946936957       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906946963500       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906946972068       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906946966509       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906946970483       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.925711e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947022264       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906947014574       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906947003703       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906947000359       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906947007118       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906947009246       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906947007948       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906947008867       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 4.816423e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1008e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.088325e-01 1 1  ON 0
 uu_1                 1.420929e-01 1 1  ON 1
 uu_2                 4.084115e-02 1 1  ON 2
 uu_3                -2.129183e-02 1 1  ON 3
 uu_4                -6.580944e-02 1 1  ON 4
 uu_5                -9.964911e-02 1 1  ON 5
 uu_6                -1.260465e-01 1 1  ON 6
 uu_7                -1.389382e-01 1 1  ON 7
 uu_8                -1.311649e-01 1 1  ON 8
 uu_9                -1.014960e-01 1 1  ON 9
 ud_0                 4.493079e-01 1 1  ON 10
 ud_1                 1.828356e-01 1 1  ON 11
 ud_2                 6.187006e-02 1 1  ON 12
 ud_3                -9.895374e-03 1 1  ON 13
 ud_4                -6.714658e-02 1 1  ON 14
 ud_5                -1.085322e-01 1 1  ON 15
 ud_6                -1.354099e-01 1 1  ON 16
 ud_7                -1.511904e-01 1 1  ON 17
 ud_8                -1.511732e-01 1 1  ON 18
 ud_9                -1.396940e-01 1 1  ON 19
 eO_0                -7.653947e-01 1 1  ON 20
 eO_1                -4.431686e-01 1 1  ON 21
 eO_2                -2.000398e-02 1 1  ON 22
 eO_3                 3.023808e-01 1 1  ON 23
 eO_4                 5.267998e-01 1 1  ON 24
 eO_5                 4.858053e-01 1 1  ON 25
 eO_6                 2.551870e-01 1 1  ON 26
 eO_7                -4.705251e-02 1 1  ON 27
 eO_8                -2.180040e-01 1 1  ON 28
 eO_9                -7.681701e-02 1 1  ON 29
eH1_0                -2.422906e-01 1 1  ON 30
eH1_1                -1.422372e-01 1 1  ON 31
eH1_2                -9.541351e-02 1 1  ON 32
eH1_3                -4.177195e-02 1 1  ON 33
eH1_4                 6.566413e-03 1 1  ON 34
eH1_5                 4.071954e-02 1 1  ON 35
eH1_6                 9.817355e-02 1 1  ON 36
eH1_7                 1.506021e-01 1 1  ON 37
eH1_8                 1.723700e-01 1 1  ON 38
eH1_9                 5.738269e-02 1 1  ON 39
eH2_0                -2.370883e-01 1 1  ON 40
eH2_1                -1.377420e-01 1 1  ON 41
eH2_2                -9.173101e-02 1 1  ON 42
eH2_3                -3.775453e-02 1 1  ON 43
eH2_4                 9.910953e-03 1 1  ON 44
eH2_5                 4.334107e-02 1 1  ON 45
eH2_6                 9.907895e-02 1 1  ON 46
eH2_7                 1.498003e-01 1 1  ON 47
eH2_8                 1.754784e-01 1 1  ON 48
eH2_9                 4.427175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.190477
====================================================
  Execution time = 4.1459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4250e-01
  Total weights = 2.0000e+06
  Execution time = 3.7143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342604994421
                                         uncertainty =       0.004242293704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342604994421
                                         uncertainty =       0.004242293704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413831909
  error estimate for blocks of size 2^( 2) =       0.000426327647
  error estimate for blocks of size 2^( 3) =       0.000438957314
  error estimate for blocks of size 2^( 4) =       0.000452061496
  error estimate for blocks of size 2^( 5) =       0.000462766480
  error estimate for blocks of size 2^( 6) =       0.000469907977
  error estimate for blocks of size 2^( 7) =       0.000474252707

      target function =                  N/A
              le_mean =     -16.906036563714
             les_mean =     286.156585820428
             stat err =       0.000464747165
             autocorr =       1.261204610296
              std dev =       0.585246698439
             le_variance =       0.342513698034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342547594441
                                         uncertainty =       0.004241664895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342547594441
                                         uncertainty =       0.004241664895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797233
  error estimate for blocks of size 2^( 2) =       0.000426293885
  error estimate for blocks of size 2^( 3) =       0.000438924518
  error estimate for blocks of size 2^( 4) =       0.000452030103
  error estimate for blocks of size 2^( 5) =       0.000462735621
  error estimate for blocks of size 2^( 6) =       0.000469875027
  error estimate for blocks of size 2^( 7) =       0.000474220572

      target function =                  N/A
              le_mean =     -16.906036552927
             les_mean =     286.156528057956
             stat err =       0.000464715331
             autocorr =       1.261243193507
              std dev =       0.585197659147
             le_variance =       0.342456300271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342572679316
                                         uncertainty =       0.004241931725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342572679316
                                         uncertainty =       0.004241931725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413812387
  error estimate for blocks of size 2^( 2) =       0.000426308630
  error estimate for blocks of size 2^( 3) =       0.000438938830
  error estimate for blocks of size 2^( 4) =       0.000452043818
  error estimate for blocks of size 2^( 5) =       0.000462749119
  error estimate for blocks of size 2^( 6) =       0.000469889447
  error estimate for blocks of size 2^( 7) =       0.000474234609

      target function =                  N/A
              le_mean =     -16.906036581764
             les_mean =     286.156554116405
             stat err =       0.000464729248
             autocorr =       1.261226358066
              std dev =       0.585219090341
             le_variance =       0.342481383700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342600821764
                                         uncertainty =       0.004242246775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342600821764
                                         uncertainty =       0.004242246775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413829388
  error estimate for blocks of size 2^( 2) =       0.000426325191
  error estimate for blocks of size 2^( 3) =       0.000438954926
  error estimate for blocks of size 2^( 4) =       0.000452059212
  error estimate for blocks of size 2^( 5) =       0.000462764238
  error estimate for blocks of size 2^( 6) =       0.000469905585
  error estimate for blocks of size 2^( 7) =       0.000474250369

      target function =                  N/A
              le_mean =     -16.906036566386
             les_mean =     286.156581738203
             stat err =       0.000464744851
             autocorr =       1.261207415142
              std dev =       0.585243133630
             le_variance =       0.342509525461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906036563714        initial
     2.5000e+00     2.5000e+01             7.6792e-05       -16.906036552927
     1.0000e+01     1.0000e+02             1.9257e-05       -16.906036581764  <--
     4.0000e+01     4.0000e+02             4.8164e-06       -16.906036566386

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 6.3889e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.088325e-01 1 1  ON 0
 uu_1                 1.420929e-01 1 1  ON 1
 uu_2                 4.084115e-02 1 1  ON 2
 uu_3                -2.129183e-02 1 1  ON 3
 uu_4                -6.580944e-02 1 1  ON 4
 uu_5                -9.964911e-02 1 1  ON 5
 uu_6                -1.260465e-01 1 1  ON 6
 uu_7                -1.389382e-01 1 1  ON 7
 uu_8                -1.311649e-01 1 1  ON 8
 uu_9                -1.014960e-01 1 1  ON 9
 ud_0                 4.493079e-01 1 1  ON 10
 ud_1                 1.828356e-01 1 1  ON 11
 ud_2                 6.187006e-02 1 1  ON 12
 ud_3                -9.895374e-03 1 1  ON 13
 ud_4                -6.714658e-02 1 1  ON 14
 ud_5                -1.085322e-01 1 1  ON 15
 ud_6                -1.354099e-01 1 1  ON 16
 ud_7                -1.511904e-01 1 1  ON 17
 ud_8                -1.511732e-01 1 1  ON 18
 ud_9                -1.396940e-01 1 1  ON 19
 eO_0                -7.653947e-01 1 1  ON 20
 eO_1                -4.431686e-01 1 1  ON 21
 eO_2                -2.000398e-02 1 1  ON 22
 eO_3                 3.023808e-01 1 1  ON 23
 eO_4                 5.267998e-01 1 1  ON 24
 eO_5                 4.858053e-01 1 1  ON 25
 eO_6                 2.551870e-01 1 1  ON 26
 eO_7                -4.705251e-02 1 1  ON 27
 eO_8                -2.180040e-01 1 1  ON 28
 eO_9                -7.681701e-02 1 1  ON 29
eH1_0                -2.422906e-01 1 1  ON 30
eH1_1                -1.422372e-01 1 1  ON 31
eH1_2                -9.541351e-02 1 1  ON 32
eH1_3                -4.177195e-02 1 1  ON 33
eH1_4                 6.566413e-03 1 1  ON 34
eH1_5                 4.071954e-02 1 1  ON 35
eH1_6                 9.817355e-02 1 1  ON 36
eH1_7                 1.506021e-01 1 1  ON 37
eH1_8                 1.723700e-01 1 1  ON 38
eH1_9                 5.738269e-02 1 1  ON 39
eH2_0                -2.370883e-01 1 1  ON 40
eH2_1                -1.377420e-01 1 1  ON 41
eH2_2                -9.173101e-02 1 1  ON 42
eH2_3                -3.775453e-02 1 1  ON 43
eH2_4                 9.910953e-03 1 1  ON 44
eH2_5                 4.334107e-02 1 1  ON 45
eH2_6                 9.907895e-02 1 1  ON 46
eH2_7                 1.498003e-01 1 1  ON 47
eH2_8                 1.754784e-01 1 1  ON 48
eH2_9                 4.427175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1491e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.194236
====================================================
  Execution time = 4.0851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0578e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354886402851
                                         uncertainty =       0.013798024251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354886402851
                                         uncertainty =       0.013798024251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421194967
  error estimate for blocks of size 2^( 2) =       0.000433643934
  error estimate for blocks of size 2^( 3) =       0.000445845384
  error estimate for blocks of size 2^( 4) =       0.000457857374
  error estimate for blocks of size 2^( 5) =       0.000469419194
  error estimate for blocks of size 2^( 6) =       0.000478231974
  error estimate for blocks of size 2^( 7) =       0.000483406110

      target function =                  N/A
              le_mean =     -16.906243440849
             les_mean =     286.175877505061
             stat err =       0.000472228663
             autocorr =       1.257008867025
              std dev =       0.595659635367
             le_variance =       0.354810401206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624344085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243440849       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906243439316       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906243954411       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244406350       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244525640       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244533302       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244488570       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244390952       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906244420366       residual = 8.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.154234e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243440849       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906243440444       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906243578886       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906243673558       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906243729193       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906243733464       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906243718165       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906243697086       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.229561e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243440849       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906243440747       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906243476018       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906243498218       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906243514151       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906243515256       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906243511180       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906243506178       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 5.612371e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1439e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.088310e-01 1 1  ON 0
 uu_1                 1.421051e-01 1 1  ON 1
 uu_2                 4.084534e-02 1 1  ON 2
 uu_3                -2.128821e-02 1 1  ON 3
 uu_4                -6.581421e-02 1 1  ON 4
 uu_5                -9.965947e-02 1 1  ON 5
 uu_6                -1.260572e-01 1 1  ON 6
 uu_7                -1.389408e-01 1 1  ON 7
 uu_8                -1.311718e-01 1 1  ON 8
 uu_9                -1.014954e-01 1 1  ON 9
 ud_0                 4.492978e-01 1 1  ON 10
 ud_1                 1.828363e-01 1 1  ON 11
 ud_2                 6.188146e-02 1 1  ON 12
 ud_3                -9.893301e-03 1 1  ON 13
 ud_4                -6.715037e-02 1 1  ON 14
 ud_5                -1.085192e-01 1 1  ON 15
 ud_6                -1.353966e-01 1 1  ON 16
 ud_7                -1.511954e-01 1 1  ON 17
 ud_8                -1.511824e-01 1 1  ON 18
 ud_9                -1.397029e-01 1 1  ON 19
 eO_0                -7.653946e-01 1 1  ON 20
 eO_1                -4.431792e-01 1 1  ON 21
 eO_2                -2.001225e-02 1 1  ON 22
 eO_3                 3.023768e-01 1 1  ON 23
 eO_4                 5.268221e-01 1 1  ON 24
 eO_5                 4.858160e-01 1 1  ON 25
 eO_6                 2.552013e-01 1 1  ON 26
 eO_7                -4.704798e-02 1 1  ON 27
 eO_8                -2.180182e-01 1 1  ON 28
 eO_9                -7.682954e-02 1 1  ON 29
eH1_0                -2.423033e-01 1 1  ON 30
eH1_1                -1.422398e-01 1 1  ON 31
eH1_2                -9.542081e-02 1 1  ON 32
eH1_3                -4.176423e-02 1 1  ON 33
eH1_4                 6.551575e-03 1 1  ON 34
eH1_5                 4.071501e-02 1 1  ON 35
eH1_6                 9.818021e-02 1 1  ON 36
eH1_7                 1.506137e-01 1 1  ON 37
eH1_8                 1.723777e-01 1 1  ON 38
eH1_9                 5.739185e-02 1 1  ON 39
eH2_0                -2.371081e-01 1 1  ON 40
eH2_1                -1.377627e-01 1 1  ON 41
eH2_2                -9.172216e-02 1 1  ON 42
eH2_3                -3.776180e-02 1 1  ON 43
eH2_4                 9.912795e-03 1 1  ON 44
eH2_5                 4.333471e-02 1 1  ON 45
eH2_6                 9.907835e-02 1 1  ON 46
eH2_7                 1.498070e-01 1 1  ON 47
eH2_8                 1.754911e-01 1 1  ON 48
eH2_9                 4.429400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8683
    reference variance = 0.252398
====================================================
  Execution time = 3.9444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3757e-01
  Total weights = 2.0000e+06
  Execution time = 3.6491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337649697997
                                         uncertainty =       0.004572444280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337649697997
                                         uncertainty =       0.004572444280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410848016
  error estimate for blocks of size 2^( 2) =       0.000423562205
  error estimate for blocks of size 2^( 3) =       0.000436112540
  error estimate for blocks of size 2^( 4) =       0.000448282535
  error estimate for blocks of size 2^( 5) =       0.000458905653
  error estimate for blocks of size 2^( 6) =       0.000467769860
  error estimate for blocks of size 2^( 7) =       0.000472510016

      target function =                  N/A
              le_mean =     -16.905173089762
             les_mean =     286.122469211146
             stat err =       0.000461867016
             autocorr =       1.263780086385
              std dev =       0.581026836853
             le_variance =       0.337592185144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337587208720
                                         uncertainty =       0.004572088592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337587208720
                                         uncertainty =       0.004572088592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410810005
  error estimate for blocks of size 2^( 2) =       0.000423525818
  error estimate for blocks of size 2^( 3) =       0.000436077708
  error estimate for blocks of size 2^( 4) =       0.000448248870
  error estimate for blocks of size 2^( 5) =       0.000458873186
  error estimate for blocks of size 2^( 6) =       0.000467737467
  error estimate for blocks of size 2^( 7) =       0.000472477750

      target function =                  N/A
              le_mean =     -16.905173465628
             les_mean =     286.122419455328
             stat err =       0.000461834318
             autocorr =       1.263834997804
              std dev =       0.580973081245
             le_variance =       0.337529721131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613608751
                                         uncertainty =       0.004572239192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613608751
                                         uncertainty =       0.004572239192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410826064
  error estimate for blocks of size 2^( 2) =       0.000423541209
  error estimate for blocks of size 2^( 3) =       0.000436092442
  error estimate for blocks of size 2^( 4) =       0.000448263087
  error estimate for blocks of size 2^( 5) =       0.000458886881
  error estimate for blocks of size 2^( 6) =       0.000467751096
  error estimate for blocks of size 2^( 7) =       0.000472491311

      target function =                  N/A
              le_mean =     -16.905173318468
             les_mean =     286.122440869209
             stat err =       0.000461848094
             autocorr =       1.263811587274
              std dev =       0.580995792187
             le_variance =       0.337556110539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337645079939
                                         uncertainty =       0.004572418122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337645079939
                                         uncertainty =       0.004572418122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410845207
  error estimate for blocks of size 2^( 2) =       0.000423559519
  error estimate for blocks of size 2^( 3) =       0.000436109970
  error estimate for blocks of size 2^( 4) =       0.000448280048
  error estimate for blocks of size 2^( 5) =       0.000458903253
  error estimate for blocks of size 2^( 6) =       0.000467767460
  error estimate for blocks of size 2^( 7) =       0.000472507624

      target function =                  N/A
              le_mean =     -16.905173118082
             les_mean =     286.122465552458
             stat err =       0.000461864596
             autocorr =       1.263784124265
              std dev =       0.581022864392
             le_variance =       0.337587568946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905173089762        initial
     2.5000e+00     2.5000e+01             9.1542e-05       -16.905173465628  <--
     1.0000e+01     1.0000e+02             2.2296e-05       -16.905173318468
     4.0000e+01     4.0000e+02             5.6124e-06       -16.905173118082

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 5.7832e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.088293e-01 1 1  ON 0
 uu_1                 1.421388e-01 1 1  ON 1
 uu_2                 4.085662e-02 1 1  ON 2
 uu_3                -2.127844e-02 1 1  ON 3
 uu_4                -6.583094e-02 1 1  ON 4
 uu_5                -9.968862e-02 1 1  ON 5
 uu_6                -1.260873e-01 1 1  ON 6
 uu_7                -1.389492e-01 1 1  ON 7
 uu_8                -1.311929e-01 1 1  ON 8
 uu_9                -1.014937e-01 1 1  ON 9
 ud_0                 4.492743e-01 1 1  ON 10
 ud_1                 1.828379e-01 1 1  ON 11
 ud_2                 6.191082e-02 1 1  ON 12
 ud_3                -9.883961e-03 1 1  ON 13
 ud_4                -6.716028e-02 1 1  ON 14
 ud_5                -1.084848e-01 1 1  ON 15
 ud_6                -1.353602e-01 1 1  ON 16
 ud_7                -1.512088e-01 1 1  ON 17
 ud_8                -1.512086e-01 1 1  ON 18
 ud_9                -1.397299e-01 1 1  ON 19
 eO_0                -7.653969e-01 1 1  ON 20
 eO_1                -4.432096e-01 1 1  ON 21
 eO_2                -2.003537e-02 1 1  ON 22
 eO_3                 3.023648e-01 1 1  ON 23
 eO_4                 5.268870e-01 1 1  ON 24
 eO_5                 4.858498e-01 1 1  ON 25
 eO_6                 2.552460e-01 1 1  ON 26
 eO_7                -4.703342e-02 1 1  ON 27
 eO_8                -2.180620e-01 1 1  ON 28
 eO_9                -7.686852e-02 1 1  ON 29
eH1_0                -2.423427e-01 1 1  ON 30
eH1_1                -1.422500e-01 1 1  ON 31
eH1_2                -9.543878e-02 1 1  ON 32
eH1_3                -4.174619e-02 1 1  ON 33
eH1_4                 6.510358e-03 1 1  ON 34
eH1_5                 4.070100e-02 1 1  ON 35
eH1_6                 9.819922e-02 1 1  ON 36
eH1_7                 1.506490e-01 1 1  ON 37
eH1_8                 1.724020e-01 1 1  ON 38
eH1_9                 5.742059e-02 1 1  ON 39
eH2_0                -2.371678e-01 1 1  ON 40
eH2_1                -1.378197e-01 1 1  ON 41
eH2_2                -9.170116e-02 1 1  ON 42
eH2_3                -3.778132e-02 1 1  ON 43
eH2_4                 9.912796e-03 1 1  ON 44
eH2_5                 4.331444e-02 1 1  ON 45
eH2_6                 9.907700e-02 1 1  ON 46
eH2_7                 1.498277e-01 1 1  ON 47
eH2_8                 1.755305e-01 1 1  ON 48
eH2_9                 4.436329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0938e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9539
    reference variance = 0.321711
====================================================
  Execution time = 3.9695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0845e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344881661150
                                         uncertainty =       0.004909070679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344881661150
                                         uncertainty =       0.004909070679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415217876
  error estimate for blocks of size 2^( 2) =       0.000427429069
  error estimate for blocks of size 2^( 3) =       0.000440192702
  error estimate for blocks of size 2^( 4) =       0.000451810851
  error estimate for blocks of size 2^( 5) =       0.000461780553
  error estimate for blocks of size 2^( 6) =       0.000469425860
  error estimate for blocks of size 2^( 7) =       0.000475339729

      target function =                  N/A
              le_mean =     -16.907041105994
             les_mean =     286.192850556549
             stat err =       0.000464589248
             autocorr =       1.251947810223
              std dev =       0.587206751664
             le_variance =       0.344811769199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690704110599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907041105994       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907041773650       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907041965032       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907042086440       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907042108533       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907042136285       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907042376693       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907042251808       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907042219947       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.790813e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907041105994       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907041303170       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907041358763       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907041399866       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907041403542       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907041414315       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907041450712       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907041427458       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.431234e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907041105994       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907041157628       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907041172358       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907041183534       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907041184632       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907041189302       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907041195343       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907041190381       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.367453e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0549e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.088495e-01 1 1  ON 0
 uu_1                 1.421767e-01 1 1  ON 1
 uu_2                 4.085543e-02 1 1  ON 2
 uu_3                -2.126770e-02 1 1  ON 3
 uu_4                -6.583280e-02 1 1  ON 4
 uu_5                -9.969785e-02 1 1  ON 5
 uu_6                -1.260836e-01 1 1  ON 6
 uu_7                -1.390000e-01 1 1  ON 7
 uu_8                -1.312329e-01 1 1  ON 8
 uu_9                -1.015310e-01 1 1  ON 9
 ud_0                 4.492858e-01 1 1  ON 10
 ud_1                 1.828548e-01 1 1  ON 11
 ud_2                 6.192879e-02 1 1  ON 12
 ud_3                -9.875513e-03 1 1  ON 13
 ud_4                -6.714252e-02 1 1  ON 14
 ud_5                -1.084843e-01 1 1  ON 15
 ud_6                -1.353666e-01 1 1  ON 16
 ud_7                -1.511999e-01 1 1  ON 17
 ud_8                -1.512392e-01 1 1  ON 18
 ud_9                -1.397493e-01 1 1  ON 19
 eO_0                -7.653978e-01 1 1  ON 20
 eO_1                -4.431976e-01 1 1  ON 21
 eO_2                -2.003630e-02 1 1  ON 22
 eO_3                 3.023727e-01 1 1  ON 23
 eO_4                 5.268865e-01 1 1  ON 24
 eO_5                 4.858809e-01 1 1  ON 25
 eO_6                 2.552742e-01 1 1  ON 26
 eO_7                -4.699855e-02 1 1  ON 27
 eO_8                -2.181062e-01 1 1  ON 28
 eO_9                -7.692685e-02 1 1  ON 29
eH1_0                -2.423890e-01 1 1  ON 30
eH1_1                -1.422409e-01 1 1  ON 31
eH1_2                -9.550157e-02 1 1  ON 32
eH1_3                -4.175408e-02 1 1  ON 33
eH1_4                 6.485838e-03 1 1  ON 34
eH1_5                 4.069418e-02 1 1  ON 35
eH1_6                 9.822103e-02 1 1  ON 36
eH1_7                 1.506729e-01 1 1  ON 37
eH1_8                 1.724372e-01 1 1  ON 38
eH1_9                 5.748134e-02 1 1  ON 39
eH2_0                -2.372256e-01 1 1  ON 40
eH2_1                -1.378386e-01 1 1  ON 41
eH2_2                -9.168194e-02 1 1  ON 42
eH2_3                -3.780342e-02 1 1  ON 43
eH2_4                 9.912133e-03 1 1  ON 44
eH2_5                 4.326677e-02 1 1  ON 45
eH2_6                 9.905132e-02 1 1  ON 46
eH2_7                 1.498337e-01 1 1  ON 47
eH2_8                 1.755805e-01 1 1  ON 48
eH2_9                 4.445761e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8654
    reference variance = 0.314093
====================================================
  Execution time = 3.9245e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4536e-01
  Total weights = 2.0000e+06
  Execution time = 3.6465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345399075964
                                         uncertainty =       0.004200560322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345399075964
                                         uncertainty =       0.004200560322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415545678
  error estimate for blocks of size 2^( 2) =       0.000428507323
  error estimate for blocks of size 2^( 3) =       0.000442094937
  error estimate for blocks of size 2^( 4) =       0.000455813232
  error estimate for blocks of size 2^( 5) =       0.000466692726
  error estimate for blocks of size 2^( 6) =       0.000473659936
  error estimate for blocks of size 2^( 7) =       0.000477610290

      target function =                  N/A
              le_mean =     -16.906276188971
             les_mean =     286.167530825934
             stat err =       0.000468444046
             autocorr =       1.270802053192
              std dev =       0.587670333466
             le_variance =       0.345356420836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345419479120
                                         uncertainty =       0.004199831566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345419479120
                                         uncertainty =       0.004199831566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415557961
  error estimate for blocks of size 2^( 2) =       0.000428518502
  error estimate for blocks of size 2^( 3) =       0.000442103652
  error estimate for blocks of size 2^( 4) =       0.000455819842
  error estimate for blocks of size 2^( 5) =       0.000466700342
  error estimate for blocks of size 2^( 6) =       0.000473668571
  error estimate for blocks of size 2^( 7) =       0.000477619810

      target function =                  N/A
              le_mean =     -16.906275705280
             les_mean =     286.167534888561
             stat err =       0.000468452141
             autocorr =       1.270770845738
              std dev =       0.587687704757
             le_variance =       0.345376838323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345407787958
                                         uncertainty =       0.004199998496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345407787958
                                         uncertainty =       0.004199998496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415550924
  error estimate for blocks of size 2^( 2) =       0.000428512020
  error estimate for blocks of size 2^( 3) =       0.000442098223
  error estimate for blocks of size 2^( 4) =       0.000455815164
  error estimate for blocks of size 2^( 5) =       0.000466695293
  error estimate for blocks of size 2^( 6) =       0.000473663142
  error estimate for blocks of size 2^( 7) =       0.000477613927

      target function =                  N/A
              le_mean =     -16.906275773453
             les_mean =     286.167525496238
             stat err =       0.000468446882
             autocorr =       1.270785351415
              std dev =       0.587677752587
             le_variance =       0.345365140886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345400194668
                                         uncertainty =       0.004200483681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345400194668
                                         uncertainty =       0.004200483681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415546352
  error estimate for blocks of size 2^( 2) =       0.000428507923
  error estimate for blocks of size 2^( 3) =       0.000442095348
  error estimate for blocks of size 2^( 4) =       0.000455813461
  error estimate for blocks of size 2^( 5) =       0.000466693042
  error estimate for blocks of size 2^( 6) =       0.000473660340
  error estimate for blocks of size 2^( 7) =       0.000477610759

      target function =                  N/A
              le_mean =     -16.906276126296
             les_mean =     286.167529826490
             stat err =       0.000468444401
             autocorr =       1.270799855684
              std dev =       0.587671286190
             le_variance =       0.345357540612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906276188971        initial  <--
     6.2500e-01     6.2500e+00             3.7908e-04       -16.906275705280
     2.5000e+00     2.5000e+01             9.4312e-05       -16.906275773453
     1.0000e+01     1.0000e+02             2.3675e-05       -16.906276126296

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6478
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.088293e-01 1 1  ON 0
 uu_1                 1.421388e-01 1 1  ON 1
 uu_2                 4.085662e-02 1 1  ON 2
 uu_3                -2.127844e-02 1 1  ON 3
 uu_4                -6.583094e-02 1 1  ON 4
 uu_5                -9.968862e-02 1 1  ON 5
 uu_6                -1.260873e-01 1 1  ON 6
 uu_7                -1.389492e-01 1 1  ON 7
 uu_8                -1.311929e-01 1 1  ON 8
 uu_9                -1.014937e-01 1 1  ON 9
 ud_0                 4.492743e-01 1 1  ON 10
 ud_1                 1.828379e-01 1 1  ON 11
 ud_2                 6.191082e-02 1 1  ON 12
 ud_3                -9.883961e-03 1 1  ON 13
 ud_4                -6.716028e-02 1 1  ON 14
 ud_5                -1.084848e-01 1 1  ON 15
 ud_6                -1.353602e-01 1 1  ON 16
 ud_7                -1.512088e-01 1 1  ON 17
 ud_8                -1.512086e-01 1 1  ON 18
 ud_9                -1.397299e-01 1 1  ON 19
 eO_0                -7.653969e-01 1 1  ON 20
 eO_1                -4.432096e-01 1 1  ON 21
 eO_2                -2.003537e-02 1 1  ON 22
 eO_3                 3.023648e-01 1 1  ON 23
 eO_4                 5.268870e-01 1 1  ON 24
 eO_5                 4.858498e-01 1 1  ON 25
 eO_6                 2.552460e-01 1 1  ON 26
 eO_7                -4.703342e-02 1 1  ON 27
 eO_8                -2.180620e-01 1 1  ON 28
 eO_9                -7.686852e-02 1 1  ON 29
eH1_0                -2.423427e-01 1 1  ON 30
eH1_1                -1.422500e-01 1 1  ON 31
eH1_2                -9.543878e-02 1 1  ON 32
eH1_3                -4.174619e-02 1 1  ON 33
eH1_4                 6.510358e-03 1 1  ON 34
eH1_5                 4.070100e-02 1 1  ON 35
eH1_6                 9.819922e-02 1 1  ON 36
eH1_7                 1.506490e-01 1 1  ON 37
eH1_8                 1.724020e-01 1 1  ON 38
eH1_9                 5.742059e-02 1 1  ON 39
eH2_0                -2.371678e-01 1 1  ON 40
eH2_1                -1.378197e-01 1 1  ON 41
eH2_2                -9.170116e-02 1 1  ON 42
eH2_3                -3.778132e-02 1 1  ON 43
eH2_4                 9.912796e-03 1 1  ON 44
eH2_5                 4.331444e-02 1 1  ON 45
eH2_6                 9.907700e-02 1 1  ON 46
eH2_7                 1.498277e-01 1 1  ON 47
eH2_8                 1.755305e-01 1 1  ON 48
eH2_9                 4.436329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0820e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.240423
====================================================
  Execution time = 4.1952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0812e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339721400410
                                         uncertainty =       0.003712457972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339721400410
                                         uncertainty =       0.003712457972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110866
  error estimate for blocks of size 2^( 2) =       0.000425007600
  error estimate for blocks of size 2^( 3) =       0.000438337596
  error estimate for blocks of size 2^( 4) =       0.000450104099
  error estimate for blocks of size 2^( 5) =       0.000462219284
  error estimate for blocks of size 2^( 6) =       0.000469187117
  error estimate for blocks of size 2^( 7) =       0.000474130310

      target function =                  N/A
              le_mean =     -16.905556965857
             les_mean =     286.137526887622
             stat err =       0.000463910202
             autocorr =       1.267184104614
              std dev =       0.582812775780
             le_variance =       0.339670731612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555696586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905556965857       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905557168079       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905557082453       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905556892072       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905556942160       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905556979670       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905556997585       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.645720e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905556965857       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905557017626       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905556996432       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905556947698       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905556955081       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905556969849       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905556969346       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905556973288       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.243654e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905556965857       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905556978878       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905556973594       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905556961342       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905556962835       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905556966696       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905556966624       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905556967591       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.311607e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2772e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.088320e-01 1 1  ON 0
 uu_1                 1.421386e-01 1 1  ON 1
 uu_2                 4.085465e-02 1 1  ON 2
 uu_3                -2.127588e-02 1 1  ON 3
 uu_4                -6.583482e-02 1 1  ON 4
 uu_5                -9.968458e-02 1 1  ON 5
 uu_6                -1.260882e-01 1 1  ON 6
 uu_7                -1.389536e-01 1 1  ON 7
 uu_8                -1.311951e-01 1 1  ON 8
 uu_9                -1.014968e-01 1 1  ON 9
 ud_0                 4.492778e-01 1 1  ON 10
 ud_1                 1.828402e-01 1 1  ON 11
 ud_2                 6.191096e-02 1 1  ON 12
 ud_3                -9.882513e-03 1 1  ON 13
 ud_4                -6.716315e-02 1 1  ON 14
 ud_5                -1.084827e-01 1 1  ON 15
 ud_6                -1.353628e-01 1 1  ON 16
 ud_7                -1.512070e-01 1 1  ON 17
 ud_8                -1.512122e-01 1 1  ON 18
 ud_9                -1.397321e-01 1 1  ON 19
 eO_0                -7.653981e-01 1 1  ON 20
 eO_1                -4.432073e-01 1 1  ON 21
 eO_2                -2.003993e-02 1 1  ON 22
 eO_3                 3.023613e-01 1 1  ON 23
 eO_4                 5.268888e-01 1 1  ON 24
 eO_5                 4.858578e-01 1 1  ON 25
 eO_6                 2.552525e-01 1 1  ON 26
 eO_7                -4.703093e-02 1 1  ON 27
 eO_8                -2.180677e-01 1 1  ON 28
 eO_9                -7.687391e-02 1 1  ON 29
eH1_0                -2.423506e-01 1 1  ON 30
eH1_1                -1.422530e-01 1 1  ON 31
eH1_2                -9.543920e-02 1 1  ON 32
eH1_3                -4.174545e-02 1 1  ON 33
eH1_4                 6.508591e-03 1 1  ON 34
eH1_5                 4.069755e-02 1 1  ON 35
eH1_6                 9.819723e-02 1 1  ON 36
eH1_7                 1.506527e-01 1 1  ON 37
eH1_8                 1.724085e-01 1 1  ON 38
eH1_9                 5.742825e-02 1 1  ON 39
eH2_0                -2.371724e-01 1 1  ON 40
eH2_1                -1.378237e-01 1 1  ON 41
eH2_2                -9.170254e-02 1 1  ON 42
eH2_3                -3.778721e-02 1 1  ON 43
eH2_4                 9.913382e-03 1 1  ON 44
eH2_5                 4.331353e-02 1 1  ON 45
eH2_6                 9.907454e-02 1 1  ON 46
eH2_7                 1.498301e-01 1 1  ON 47
eH2_8                 1.755372e-01 1 1  ON 48
eH2_9                 4.437254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9843
    reference variance = 0.344063
====================================================
  Execution time = 4.1160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3289e-01
  Total weights = 2.0000e+06
  Execution time = 3.6349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332917909764
                                         uncertainty =       0.003987013928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332917909764
                                         uncertainty =       0.003987013928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407977652
  error estimate for blocks of size 2^( 2) =       0.000420647819
  error estimate for blocks of size 2^( 3) =       0.000433512064
  error estimate for blocks of size 2^( 4) =       0.000445555965
  error estimate for blocks of size 2^( 5) =       0.000456469039
  error estimate for blocks of size 2^( 6) =       0.000464713316
  error estimate for blocks of size 2^( 7) =       0.000469885263

      target function =                  N/A
              le_mean =     -16.905017138856
             les_mean =     286.112495827703
             stat err =       0.000459155895
             autocorr =       1.266623617043
              std dev =       0.576967528667
             le_variance =       0.332891529136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332928277469
                                         uncertainty =       0.003987147409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332928277469
                                         uncertainty =       0.003987147409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407983996
  error estimate for blocks of size 2^( 2) =       0.000420653635
  error estimate for blocks of size 2^( 3) =       0.000433517458
  error estimate for blocks of size 2^( 4) =       0.000445561089
  error estimate for blocks of size 2^( 5) =       0.000456474024
  error estimate for blocks of size 2^( 6) =       0.000464718389
  error estimate for blocks of size 2^( 7) =       0.000469890199

      target function =                  N/A
              le_mean =     -16.905017118415
             les_mean =     286.112505488955
             stat err =       0.000459160925
             autocorr =       1.266611978060
              std dev =       0.576976499942
             le_variance =       0.332901881486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332923407421
                                         uncertainty =       0.003987086857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332923407421
                                         uncertainty =       0.003987086857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407981016
  error estimate for blocks of size 2^( 2) =       0.000420650902
  error estimate for blocks of size 2^( 3) =       0.000433514924
  error estimate for blocks of size 2^( 4) =       0.000445558677
  error estimate for blocks of size 2^( 5) =       0.000456471673
  error estimate for blocks of size 2^( 6) =       0.000464715988
  error estimate for blocks of size 2^( 7) =       0.000469887882

      target function =                  N/A
              le_mean =     -16.905017126146
             les_mean =     286.112500887605
             stat err =       0.000459158555
             autocorr =       1.266617402403
              std dev =       0.576972285967
             le_variance =       0.332897018774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332918604356
                                         uncertainty =       0.003987023180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332918604356
                                         uncertainty =       0.003987023180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407978077
  error estimate for blocks of size 2^( 2) =       0.000420648208
  error estimate for blocks of size 2^( 3) =       0.000433512426
  error estimate for blocks of size 2^( 4) =       0.000445556308
  error estimate for blocks of size 2^( 5) =       0.000456469372
  error estimate for blocks of size 2^( 6) =       0.000464713653
  error estimate for blocks of size 2^( 7) =       0.000469885593

      target function =                  N/A
              le_mean =     -16.905017137172
             les_mean =     286.112496464332
             stat err =       0.000459156231
             autocorr =       1.266622831681
              std dev =       0.576968129719
             le_variance =       0.332892222712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905017138856        initial  <--
     6.2500e+00     6.2500e+01             3.6457e-05       -16.905017118415
     2.5000e+01     2.5000e+02             9.2437e-06       -16.905017126146
     1.0000e+02     1.0000e+03             2.3116e-06       -16.905017137172

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.5236
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.088293e-01 1 1  ON 0
 uu_1                 1.421388e-01 1 1  ON 1
 uu_2                 4.085662e-02 1 1  ON 2
 uu_3                -2.127844e-02 1 1  ON 3
 uu_4                -6.583094e-02 1 1  ON 4
 uu_5                -9.968862e-02 1 1  ON 5
 uu_6                -1.260873e-01 1 1  ON 6
 uu_7                -1.389492e-01 1 1  ON 7
 uu_8                -1.311929e-01 1 1  ON 8
 uu_9                -1.014937e-01 1 1  ON 9
 ud_0                 4.492743e-01 1 1  ON 10
 ud_1                 1.828379e-01 1 1  ON 11
 ud_2                 6.191082e-02 1 1  ON 12
 ud_3                -9.883961e-03 1 1  ON 13
 ud_4                -6.716028e-02 1 1  ON 14
 ud_5                -1.084848e-01 1 1  ON 15
 ud_6                -1.353602e-01 1 1  ON 16
 ud_7                -1.512088e-01 1 1  ON 17
 ud_8                -1.512086e-01 1 1  ON 18
 ud_9                -1.397299e-01 1 1  ON 19
 eO_0                -7.653969e-01 1 1  ON 20
 eO_1                -4.432096e-01 1 1  ON 21
 eO_2                -2.003537e-02 1 1  ON 22
 eO_3                 3.023648e-01 1 1  ON 23
 eO_4                 5.268870e-01 1 1  ON 24
 eO_5                 4.858498e-01 1 1  ON 25
 eO_6                 2.552460e-01 1 1  ON 26
 eO_7                -4.703342e-02 1 1  ON 27
 eO_8                -2.180620e-01 1 1  ON 28
 eO_9                -7.686852e-02 1 1  ON 29
eH1_0                -2.423427e-01 1 1  ON 30
eH1_1                -1.422500e-01 1 1  ON 31
eH1_2                -9.543878e-02 1 1  ON 32
eH1_3                -4.174619e-02 1 1  ON 33
eH1_4                 6.510358e-03 1 1  ON 34
eH1_5                 4.070100e-02 1 1  ON 35
eH1_6                 9.819922e-02 1 1  ON 36
eH1_7                 1.506490e-01 1 1  ON 37
eH1_8                 1.724020e-01 1 1  ON 38
eH1_9                 5.742059e-02 1 1  ON 39
eH2_0                -2.371678e-01 1 1  ON 40
eH2_1                -1.378197e-01 1 1  ON 41
eH2_2                -9.170116e-02 1 1  ON 42
eH2_3                -3.778132e-02 1 1  ON 43
eH2_4                 9.912796e-03 1 1  ON 44
eH2_5                 4.331444e-02 1 1  ON 45
eH2_6                 9.907700e-02 1 1  ON 46
eH2_7                 1.498277e-01 1 1  ON 47
eH2_8                 1.755305e-01 1 1  ON 48
eH2_9                 4.436329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1230e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.330574
====================================================
  Execution time = 3.9744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0931e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337560115065
                                         uncertainty =       0.003734245146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337560115065
                                         uncertainty =       0.003734245146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410816020
  error estimate for blocks of size 2^( 2) =       0.000423372136
  error estimate for blocks of size 2^( 3) =       0.000435939587
  error estimate for blocks of size 2^( 4) =       0.000448045921
  error estimate for blocks of size 2^( 5) =       0.000457970643
  error estimate for blocks of size 2^( 6) =       0.000464276876
  error estimate for blocks of size 2^( 7) =       0.000469468201

      target function =                  N/A
              le_mean =     -16.906411593817
             les_mean =     286.164292415532
             stat err =       0.000459940410
             autocorr =       1.253453982845
              std dev =       0.580981587283
             le_variance =       0.337539604761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641159382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411593817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411594465       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411586696       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411583885       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411586274       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411585357       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411589446       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411591926       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.572733e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411593817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411593979       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411592034       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411591329       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411591929       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411591692       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411592704       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411593327       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.934301e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411593817       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411593857       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411593371       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411593195       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411593344       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411593285       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411593538       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411593692       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.233729e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0684e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.088292e-01 1 1  ON 0
 uu_1                 1.421390e-01 1 1  ON 1
 uu_2                 4.085713e-02 1 1  ON 2
 uu_3                -2.127823e-02 1 1  ON 3
 uu_4                -6.583111e-02 1 1  ON 4
 uu_5                -9.968840e-02 1 1  ON 5
 uu_6                -1.260872e-01 1 1  ON 6
 uu_7                -1.389493e-01 1 1  ON 7
 uu_8                -1.311937e-01 1 1  ON 8
 uu_9                -1.014944e-01 1 1  ON 9
 ud_0                 4.492742e-01 1 1  ON 10
 ud_1                 1.828384e-01 1 1  ON 11
 ud_2                 6.191097e-02 1 1  ON 12
 ud_3                -9.883694e-03 1 1  ON 13
 ud_4                -6.716017e-02 1 1  ON 14
 ud_5                -1.084841e-01 1 1  ON 15
 ud_6                -1.353601e-01 1 1  ON 16
 ud_7                -1.512090e-01 1 1  ON 17
 ud_8                -1.512094e-01 1 1  ON 18
 ud_9                -1.397305e-01 1 1  ON 19
 eO_0                -7.653967e-01 1 1  ON 20
 eO_1                -4.432095e-01 1 1  ON 21
 eO_2                -2.003544e-02 1 1  ON 22
 eO_3                 3.023645e-01 1 1  ON 23
 eO_4                 5.268872e-01 1 1  ON 24
 eO_5                 4.858501e-01 1 1  ON 25
 eO_6                 2.552468e-01 1 1  ON 26
 eO_7                -4.703299e-02 1 1  ON 27
 eO_8                -2.180629e-01 1 1  ON 28
 eO_9                -7.686920e-02 1 1  ON 29
eH1_0                -2.423431e-01 1 1  ON 30
eH1_1                -1.422500e-01 1 1  ON 31
eH1_2                -9.543895e-02 1 1  ON 32
eH1_3                -4.174631e-02 1 1  ON 33
eH1_4                 6.510065e-03 1 1  ON 34
eH1_5                 4.070103e-02 1 1  ON 35
eH1_6                 9.819884e-02 1 1  ON 36
eH1_7                 1.506490e-01 1 1  ON 37
eH1_8                 1.724025e-01 1 1  ON 38
eH1_9                 5.742136e-02 1 1  ON 39
eH2_0                -2.371686e-01 1 1  ON 40
eH2_1                -1.378204e-01 1 1  ON 41
eH2_2                -9.170117e-02 1 1  ON 42
eH2_3                -3.778192e-02 1 1  ON 43
eH2_4                 9.912893e-03 1 1  ON 44
eH2_5                 4.331469e-02 1 1  ON 45
eH2_6                 9.907758e-02 1 1  ON 46
eH2_7                 1.498281e-01 1 1  ON 47
eH2_8                 1.755309e-01 1 1  ON 48
eH2_9                 4.436377e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8371
    reference variance = 0.714317
====================================================
  Execution time = 3.8992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4109e-01
  Total weights = 2.0000e+06
  Execution time = 3.6486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055711778
                                         uncertainty =       0.005205354747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055711778
                                         uncertainty =       0.005205354747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412973113
  error estimate for blocks of size 2^( 2) =       0.000425771425
  error estimate for blocks of size 2^( 3) =       0.000438503314
  error estimate for blocks of size 2^( 4) =       0.000449834278
  error estimate for blocks of size 2^( 5) =       0.000459667853
  error estimate for blocks of size 2^( 6) =       0.000466942659
  error estimate for blocks of size 2^( 7) =       0.000471373283

      target function =                  N/A
              le_mean =     -16.906052290382
             les_mean =     286.155697458963
             stat err =       0.000461954518
             autocorr =       1.251281095760
              std dev =       0.584032177510
             le_variance =       0.341093584367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053452385
                                         uncertainty =       0.005205315614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053452385
                                         uncertainty =       0.005205315614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412971745
  error estimate for blocks of size 2^( 2) =       0.000425770075
  error estimate for blocks of size 2^( 3) =       0.000438501968
  error estimate for blocks of size 2^( 4) =       0.000449832960
  error estimate for blocks of size 2^( 5) =       0.000459666591
  error estimate for blocks of size 2^( 6) =       0.000466941469
  error estimate for blocks of size 2^( 7) =       0.000471372097

      target function =                  N/A
              le_mean =     -16.906052313566
             les_mean =     286.155695982241
             stat err =       0.000461953280
             autocorr =       1.251282677703
              std dev =       0.584030242145
             le_variance =       0.341091323740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341054576468
                                         uncertainty =       0.005205335078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341054576468
                                         uncertainty =       0.005205335078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412972425
  error estimate for blocks of size 2^( 2) =       0.000425770747
  error estimate for blocks of size 2^( 3) =       0.000438502637
  error estimate for blocks of size 2^( 4) =       0.000449833616
  error estimate for blocks of size 2^( 5) =       0.000459667219
  error estimate for blocks of size 2^( 6) =       0.000466942061
  error estimate for blocks of size 2^( 7) =       0.000471372687

      target function =                  N/A
              le_mean =     -16.906052302013
             les_mean =     286.155696716293
             stat err =       0.000461953896
             autocorr =       1.251281891169
              std dev =       0.584031205019
             le_variance =       0.341092448436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055569684
                                         uncertainty =       0.005205352285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055569684
                                         uncertainty =       0.005205352285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412973027
  error estimate for blocks of size 2^( 2) =       0.000425771340
  error estimate for blocks of size 2^( 3) =       0.000438503229
  error estimate for blocks of size 2^( 4) =       0.000449834195
  error estimate for blocks of size 2^( 5) =       0.000459667774
  error estimate for blocks of size 2^( 6) =       0.000466942584
  error estimate for blocks of size 2^( 7) =       0.000471373209

      target function =                  N/A
              le_mean =     -16.906052291837
             les_mean =     286.155697365964
             stat err =       0.000461954440
             autocorr =       1.251281195318
              std dev =       0.584032055793
             le_variance =       0.341093442194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906052290382        initial
     6.2500e+01     6.2500e+02             3.5727e-06       -16.906052313566  <--
     2.5000e+02     2.5000e+03             8.9343e-07       -16.906052302013
     1.0000e+03     1.0000e+04             2.2337e-07       -16.906052291837

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 5.7393e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0809e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.268355
====================================================
  Execution time = 3.9874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4447e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0784e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344624660540
                                         uncertainty =       0.006472614663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344624660540
                                         uncertainty =       0.006472614663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415009237
  error estimate for blocks of size 2^( 2) =       0.000427816486
  error estimate for blocks of size 2^( 3) =       0.000441227572
  error estimate for blocks of size 2^( 4) =       0.000453834812
  error estimate for blocks of size 2^( 5) =       0.000464504899
  error estimate for blocks of size 2^( 6) =       0.000471821179
  error estimate for blocks of size 2^( 7) =       0.000479030302

      target function =                  N/A
              le_mean =     -16.905211888510
             les_mean =     286.130654156940
             stat err =       0.000467297798
             autocorr =       1.267861875773
              std dev =       0.586911691621
             le_variance =       0.344465333761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690521188851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905211888510       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905211905128       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905211947642       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905211961867       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905211942460       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905211959182       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905211966513       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905211964770       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.326442e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905211888510       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905211892701       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905211903383       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905211907075       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905211902092       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905211906176       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905211908089       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905211907622       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.318636e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905211888510       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905211889560       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905211892234       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905211893165       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905211891911       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905211892926       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905211893410       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905211893290       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.298165e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0668e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088291e-01 1 1  ON 0
 uu_1                 1.421409e-01 1 1  ON 1
 uu_2                 4.086040e-02 1 1  ON 2
 uu_3                -2.127696e-02 1 1  ON 3
 uu_4                -6.583267e-02 1 1  ON 4
 uu_5                -9.968831e-02 1 1  ON 5
 uu_6                -1.260879e-01 1 1  ON 6
 uu_7                -1.389514e-01 1 1  ON 7
 uu_8                -1.311968e-01 1 1  ON 8
 uu_9                -1.014978e-01 1 1  ON 9
 ud_0                 4.492735e-01 1 1  ON 10
 ud_1                 1.828401e-01 1 1  ON 11
 ud_2                 6.191108e-02 1 1  ON 12
 ud_3                -9.882676e-03 1 1  ON 13
 ud_4                -6.716128e-02 1 1  ON 14
 ud_5                -1.084810e-01 1 1  ON 15
 ud_6                -1.353595e-01 1 1  ON 16
 ud_7                -1.512086e-01 1 1  ON 17
 ud_8                -1.512120e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653958e-01 1 1  ON 20
 eO_1                -4.432103e-01 1 1  ON 21
 eO_2                -2.003708e-02 1 1  ON 22
 eO_3                 3.023643e-01 1 1  ON 23
 eO_4                 5.268900e-01 1 1  ON 24
 eO_5                 4.858532e-01 1 1  ON 25
 eO_6                 2.552492e-01 1 1  ON 26
 eO_7                -4.703046e-02 1 1  ON 27
 eO_8                -2.180671e-01 1 1  ON 28
 eO_9                -7.687356e-02 1 1  ON 29
eH1_0                -2.423454e-01 1 1  ON 30
eH1_1                -1.422511e-01 1 1  ON 31
eH1_2                -9.544267e-02 1 1  ON 32
eH1_3                -4.174678e-02 1 1  ON 33
eH1_4                 6.506572e-03 1 1  ON 34
eH1_5                 4.070124e-02 1 1  ON 35
eH1_6                 9.819676e-02 1 1  ON 36
eH1_7                 1.506510e-01 1 1  ON 37
eH1_8                 1.724075e-01 1 1  ON 38
eH1_9                 5.742675e-02 1 1  ON 39
eH2_0                -2.371741e-01 1 1  ON 40
eH2_1                -1.378243e-01 1 1  ON 41
eH2_2                -9.170044e-02 1 1  ON 42
eH2_3                -3.778271e-02 1 1  ON 43
eH2_4                 9.911935e-03 1 1  ON 44
eH2_5                 4.331678e-02 1 1  ON 45
eH2_6                 9.907929e-02 1 1  ON 46
eH2_7                 1.498281e-01 1 1  ON 47
eH2_8                 1.755330e-01 1 1  ON 48
eH2_9                 4.436817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.243032
====================================================
  Execution time = 3.9173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.0000e+06
  Execution time = 3.6504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336511764945
                                         uncertainty =       0.004043383400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336511764945
                                         uncertainty =       0.004043383400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410172554
  error estimate for blocks of size 2^( 2) =       0.000423040624
  error estimate for blocks of size 2^( 3) =       0.000436016114
  error estimate for blocks of size 2^( 4) =       0.000447561808
  error estimate for blocks of size 2^( 5) =       0.000457218688
  error estimate for blocks of size 2^( 6) =       0.000464790771
  error estimate for blocks of size 2^( 7) =       0.000469836198

      target function =                  N/A
              le_mean =     -16.906424177973
             les_mean =     286.163661365215
             stat err =       0.000459851867
             autocorr =       1.256905751888
              std dev =       0.580071588596
             le_variance =       0.336483047897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336509190088
                                         uncertainty =       0.004043332795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336509190088
                                         uncertainty =       0.004043332795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410170985
  error estimate for blocks of size 2^( 2) =       0.000423039001
  error estimate for blocks of size 2^( 3) =       0.000436014397
  error estimate for blocks of size 2^( 4) =       0.000447560041
  error estimate for blocks of size 2^( 5) =       0.000457216890
  error estimate for blocks of size 2^( 6) =       0.000464788843
  error estimate for blocks of size 2^( 7) =       0.000469834043

      target function =                  N/A
              le_mean =     -16.906424131097
             les_mean =     286.163657206388
             stat err =       0.000459849954
             autocorr =       1.256904911587
              std dev =       0.580069370072
             le_variance =       0.336480474095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336510456087
                                         uncertainty =       0.004043358242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336510456087
                                         uncertainty =       0.004043358242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410171756
  error estimate for blocks of size 2^( 2) =       0.000423039799
  error estimate for blocks of size 2^( 3) =       0.000436015242
  error estimate for blocks of size 2^( 4) =       0.000447560911
  error estimate for blocks of size 2^( 5) =       0.000457217775
  error estimate for blocks of size 2^( 6) =       0.000464789792
  error estimate for blocks of size 2^( 7) =       0.000469835105

      target function =                  N/A
              le_mean =     -16.906424154095
             les_mean =     286.163659249511
             stat err =       0.000459850896
             autocorr =       1.256905332461
              std dev =       0.580070460878
             le_variance =       0.336481739584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336511600602
                                         uncertainty =       0.004043380261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336511600602
                                         uncertainty =       0.004043380261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410172454
  error estimate for blocks of size 2^( 2) =       0.000423040521
  error estimate for blocks of size 2^( 3) =       0.000436016005
  error estimate for blocks of size 2^( 4) =       0.000447561696
  error estimate for blocks of size 2^( 5) =       0.000457218573
  error estimate for blocks of size 2^( 6) =       0.000464790648
  error estimate for blocks of size 2^( 7) =       0.000469836061

      target function =                  N/A
              le_mean =     -16.906424174965
             les_mean =     286.163661099220
             stat err =       0.000459851745
             autocorr =       1.256905699447
              std dev =       0.580071446998
             le_variance =       0.336482883622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906424177973        initial  <--
     1.5625e+01     1.5625e+02             1.3264e-05       -16.906424131097
     6.2500e+01     6.2500e+02             3.3186e-06       -16.906424154095
     2.5000e+02     2.5000e+03             8.2982e-07       -16.906424174965

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5637
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0826e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9642
    reference variance = 0.265603
====================================================
  Execution time = 4.1742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0781e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843858057
                                         uncertainty =       0.003015908829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843858057
                                         uncertainty =       0.003015908829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412195347
  error estimate for blocks of size 2^( 2) =       0.000425185861
  error estimate for blocks of size 2^( 3) =       0.000438416892
  error estimate for blocks of size 2^( 4) =       0.000451276522
  error estimate for blocks of size 2^( 5) =       0.000462976993
  error estimate for blocks of size 2^( 6) =       0.000472011377
  error estimate for blocks of size 2^( 7) =       0.000478719921

      target function =                  N/A
              le_mean =     -16.905959485043
             les_mean =     286.151275947872
             stat err =       0.000466246203
             autocorr =       1.279453323841
              std dev =       0.582932249816
             le_variance =       0.339810007876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595948504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959485043       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905959485904       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959485309       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905959487599       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905959490025       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905959490248       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959490367       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905959490608       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.628009e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959485043       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905959485258       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959485109       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905959485682       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905959486291       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905959486347       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959486376       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905959486437       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.070734e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959485043       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905959485097       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959485059       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905959485202       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905959485354       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905959485370       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959485376       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905959485389       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.017728e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2921e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088289e-01 1 1  ON 0
 uu_1                 1.421396e-01 1 1  ON 1
 uu_2                 4.085864e-02 1 1  ON 2
 uu_3                -2.127753e-02 1 1  ON 3
 uu_4                -6.583177e-02 1 1  ON 4
 uu_5                -9.968777e-02 1 1  ON 5
 uu_6                -1.260870e-01 1 1  ON 6
 uu_7                -1.389499e-01 1 1  ON 7
 uu_8                -1.311959e-01 1 1  ON 8
 uu_9                -1.014964e-01 1 1  ON 9
 ud_0                 4.492741e-01 1 1  ON 10
 ud_1                 1.828398e-01 1 1  ON 11
 ud_2                 6.191128e-02 1 1  ON 12
 ud_3                -9.882923e-03 1 1  ON 13
 ud_4                -6.715986e-02 1 1  ON 14
 ud_5                -1.084818e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512095e-01 1 1  ON 17
 ud_8                -1.512119e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653961e-01 1 1  ON 20
 eO_1                -4.432090e-01 1 1  ON 21
 eO_2                -2.003582e-02 1 1  ON 22
 eO_3                 3.023635e-01 1 1  ON 23
 eO_4                 5.268879e-01 1 1  ON 24
 eO_5                 4.858512e-01 1 1  ON 25
 eO_6                 2.552490e-01 1 1  ON 26
 eO_7                -4.703164e-02 1 1  ON 27
 eO_8                -2.180658e-01 1 1  ON 28
 eO_9                -7.687141e-02 1 1  ON 29
eH1_0                -2.423445e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543952e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509082e-03 1 1  ON 34
eH1_5                 4.070091e-02 1 1  ON 35
eH1_6                 9.819754e-02 1 1  ON 36
eH1_7                 1.506489e-01 1 1  ON 37
eH1_8                 1.724045e-01 1 1  ON 38
eH1_9                 5.742400e-02 1 1  ON 39
eH2_0                -2.371714e-01 1 1  ON 40
eH2_1                -1.378226e-01 1 1  ON 41
eH2_2                -9.170135e-02 1 1  ON 42
eH2_3                -3.778386e-02 1 1  ON 43
eH2_4                 9.913103e-03 1 1  ON 44
eH2_5                 4.331552e-02 1 1  ON 45
eH2_6                 9.907940e-02 1 1  ON 46
eH2_7                 1.498292e-01 1 1  ON 47
eH2_8                 1.755321e-01 1 1  ON 48
eH2_9                 4.436554e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8326
    reference variance = 0.261763
====================================================
  Execution time = 3.9573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.0000e+06
  Execution time = 3.6414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392069061
                                         uncertainty =       0.004263320544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392069061
                                         uncertainty =       0.004263320544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411873873
  error estimate for blocks of size 2^( 2) =       0.000424577732
  error estimate for blocks of size 2^( 3) =       0.000437753676
  error estimate for blocks of size 2^( 4) =       0.000451118736
  error estimate for blocks of size 2^( 5) =       0.000461021343
  error estimate for blocks of size 2^( 6) =       0.000470794204
  error estimate for blocks of size 2^( 7) =       0.000476742460

      target function =                  N/A
              le_mean =     -16.906082222395
             les_mean =     286.154896115684
             stat err =       0.000464919186
             autocorr =       1.274167283036
              std dev =       0.582477617551
             le_variance =       0.339280174948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392738717
                                         uncertainty =       0.004263328371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392738717
                                         uncertainty =       0.004263328371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411874280
  error estimate for blocks of size 2^( 2) =       0.000424578109
  error estimate for blocks of size 2^( 3) =       0.000437754023
  error estimate for blocks of size 2^( 4) =       0.000451119074
  error estimate for blocks of size 2^( 5) =       0.000461021666
  error estimate for blocks of size 2^( 6) =       0.000470794533
  error estimate for blocks of size 2^( 7) =       0.000476742810

      target function =                  N/A
              le_mean =     -16.906082219064
             les_mean =     286.154896672661
             stat err =       0.000464919521
             autocorr =       1.274166602860
              std dev =       0.582478192327
             le_variance =       0.339280844537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392404321
                                         uncertainty =       0.004263324460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392404321
                                         uncertainty =       0.004263324460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411874077
  error estimate for blocks of size 2^( 2) =       0.000424577921
  error estimate for blocks of size 2^( 3) =       0.000437753850
  error estimate for blocks of size 2^( 4) =       0.000451118905
  error estimate for blocks of size 2^( 5) =       0.000461021505
  error estimate for blocks of size 2^( 6) =       0.000470794369
  error estimate for blocks of size 2^( 7) =       0.000476742635

      target function =                  N/A
              le_mean =     -16.906082220722
             les_mean =     286.154896394334
             stat err =       0.000464919353
             autocorr =       1.274166942523
              std dev =       0.582477905310
             le_variance =       0.339280510174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392110982
                                         uncertainty =       0.004263321034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339392110982
                                         uncertainty =       0.004263321034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411873899
  error estimate for blocks of size 2^( 2) =       0.000424577756
  error estimate for blocks of size 2^( 3) =       0.000437753697
  error estimate for blocks of size 2^( 4) =       0.000451118757
  error estimate for blocks of size 2^( 5) =       0.000461021363
  error estimate for blocks of size 2^( 6) =       0.000470794225
  error estimate for blocks of size 2^( 7) =       0.000476742482

      target function =                  N/A
              le_mean =     -16.906082222185
             les_mean =     286.154896150516
             stat err =       0.000464919207
             autocorr =       1.274167240457
              std dev =       0.582477653532
             le_variance =       0.339280216864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906082222395        initial  <--
     1.5625e+02     1.5625e+03             1.6280e-06       -16.906082219064
     6.2500e+02     6.2500e+03             4.0707e-07       -16.906082220722
     2.5000e+03     2.5000e+04             1.0177e-07       -16.906082222185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.8929
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1082e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8704
    reference variance = 0.204058
====================================================
  Execution time = 4.0164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7873e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0808e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378815273816
                                         uncertainty =       0.040663854786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378815273816
                                         uncertainty =       0.040663854786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435160972
  error estimate for blocks of size 2^( 2) =       0.000447238059
  error estimate for blocks of size 2^( 3) =       0.000459685272
  error estimate for blocks of size 2^( 4) =       0.000471556867
  error estimate for blocks of size 2^( 5) =       0.000481278150
  error estimate for blocks of size 2^( 6) =       0.000487708213
  error estimate for blocks of size 2^( 7) =       0.000489730356

      target function =                  N/A
              le_mean =     -16.906993652701
             les_mean =     286.225164326508
             stat err =       0.000482568396
             autocorr =       1.229752957591
              std dev =       0.615410548662
             le_variance =       0.378730143405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690699365270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993652701       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993652835       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906993653117       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906993653118       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906993653086       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906993653130       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906993653085       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906993653071       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.494363e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993652701       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993652735       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906993652805       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906993652805       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906993652797       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906993652810       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906993652800       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906993652793       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.736463e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993652701       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993652709       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906993652727       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906993652729       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906993652717       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906993652726       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906993652724       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906993652711       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 9.341503e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0982e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085866e-02 1 1  ON 2
 uu_3                -2.127759e-02 1 1  ON 3
 uu_4                -6.583161e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882879e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003567e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552490e-01 1 1  ON 26
 eO_7                -4.703170e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687127e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543947e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509172e-03 1 1  ON 34
eH1_5                 4.070109e-02 1 1  ON 35
eH1_6                 9.819768e-02 1 1  ON 36
eH1_7                 1.506489e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742371e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170118e-02 1 1  ON 42
eH2_3                -3.778374e-02 1 1  ON 43
eH2_4                 9.913164e-03 1 1  ON 44
eH2_5                 4.331543e-02 1 1  ON 45
eH2_6                 9.907933e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9404
    reference variance = 0.229672
====================================================
  Execution time = 3.9157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3679e-01
  Total weights = 2.0000e+06
  Execution time = 3.6508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923102198
                                         uncertainty =       0.002660072995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923102198
                                         uncertainty =       0.002660072995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410359222
  error estimate for blocks of size 2^( 2) =       0.000423298078
  error estimate for blocks of size 2^( 3) =       0.000436898161
  error estimate for blocks of size 2^( 4) =       0.000449302720
  error estimate for blocks of size 2^( 5) =       0.000460569769
  error estimate for blocks of size 2^( 6) =       0.000467846497
  error estimate for blocks of size 2^( 7) =       0.000470947201

      target function =                  N/A
              le_mean =     -16.904887898171
             les_mean =     286.112024062723
             stat err =       0.000462166547
             autocorr =       1.268436173143
              std dev =       0.580335576545
             le_variance =       0.336789381404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923003147
                                         uncertainty =       0.002660072290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923003147
                                         uncertainty =       0.002660072290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410359161
  error estimate for blocks of size 2^( 2) =       0.000423298020
  error estimate for blocks of size 2^( 3) =       0.000436898106
  error estimate for blocks of size 2^( 4) =       0.000449302668
  error estimate for blocks of size 2^( 5) =       0.000460569721
  error estimate for blocks of size 2^( 6) =       0.000467846449
  error estimate for blocks of size 2^( 7) =       0.000470947154

      target function =                  N/A
              le_mean =     -16.904887897712
             les_mean =     286.112023948219
             stat err =       0.000462166498
             autocorr =       1.268436278396
              std dev =       0.580335491248
             le_variance =       0.336789282403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923052664
                                         uncertainty =       0.002660072642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923052664
                                         uncertainty =       0.002660072642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410359191
  error estimate for blocks of size 2^( 2) =       0.000423298049
  error estimate for blocks of size 2^( 3) =       0.000436898134
  error estimate for blocks of size 2^( 4) =       0.000449302694
  error estimate for blocks of size 2^( 5) =       0.000460569745
  error estimate for blocks of size 2^( 6) =       0.000467846473
  error estimate for blocks of size 2^( 7) =       0.000470947178

      target function =                  N/A
              le_mean =     -16.904887897941
             les_mean =     286.112024005460
             stat err =       0.000462166522
             autocorr =       1.268436225776
              std dev =       0.580335533889
             le_variance =       0.336789331894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923096006
                                         uncertainty =       0.002660072951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923096006
                                         uncertainty =       0.002660072951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410359218
  error estimate for blocks of size 2^( 2) =       0.000423298074
  error estimate for blocks of size 2^( 3) =       0.000436898157
  error estimate for blocks of size 2^( 4) =       0.000449302717
  error estimate for blocks of size 2^( 5) =       0.000460569766
  error estimate for blocks of size 2^( 6) =       0.000467846494
  error estimate for blocks of size 2^( 7) =       0.000470947198

      target function =                  N/A
              le_mean =     -16.904887898142
             les_mean =     286.112024055565
             stat err =       0.000462166544
             autocorr =       1.268436179725
              std dev =       0.580335571213
             le_variance =       0.336789375215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904887898171        initial  <--
     1.5625e+03     1.5625e+04             1.4944e-07       -16.904887897712
     6.2500e+03     6.2500e+04             3.7365e-08       -16.904887897941
     2.5000e+04     2.5000e+05             9.3415e-09       -16.904887898142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5447
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0853e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9383
    reference variance = 0.369225
====================================================
  Execution time = 4.0334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3905e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0846e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339098369170
                                         uncertainty =       0.006355837894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339098369170
                                         uncertainty =       0.006355837894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411731820
  error estimate for blocks of size 2^( 2) =       0.000423830214
  error estimate for blocks of size 2^( 3) =       0.000437046841
  error estimate for blocks of size 2^( 4) =       0.000449409903
  error estimate for blocks of size 2^( 5) =       0.000459744857
  error estimate for blocks of size 2^( 6) =       0.000467885674
  error estimate for blocks of size 2^( 7) =       0.000473030634

      target function =                  N/A
              le_mean =     -16.905816742354
             les_mean =     286.145685740093
             stat err =       0.000462517767
             autocorr =       1.261908820311
              std dev =       0.582276724203
             le_variance =       0.339046183548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581674235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905816742354       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905816742369       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905816742374       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905816742366       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816742386       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905816742364       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905816742383       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905816742392       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.459846e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905816742354       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905816742358       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905816742359       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905816742382       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816742372       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905816742377       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905816742686       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905816742369       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 3.649621e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905816742354       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905816742355       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905816742356       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905816742265       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816742356       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905816742356       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905816742279       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905816742430       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 9.124058e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162606 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1188e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882893e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703171e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687125e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509187e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742369e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778374e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.234923
====================================================
  Execution time = 4.0960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.0000e+06
  Execution time = 3.6397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341190514
                                         uncertainty =       0.003511085325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341190514
                                         uncertainty =       0.003511085325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410043294
  error estimate for blocks of size 2^( 2) =       0.000422919611
  error estimate for blocks of size 2^( 3) =       0.000436708112
  error estimate for blocks of size 2^( 4) =       0.000449086403
  error estimate for blocks of size 2^( 5) =       0.000459673964
  error estimate for blocks of size 2^( 6) =       0.000468705900
  error estimate for blocks of size 2^( 7) =       0.000475591857

      target function =                  N/A
              le_mean =     -16.905265571225
             les_mean =     286.124274871359
             stat err =       0.000463264531
             autocorr =       1.276434910595
              std dev =       0.579888787478
             le_variance =       0.336271005843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341187088
                                         uncertainty =       0.003511085319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341187088
                                         uncertainty =       0.003511085319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410043292
  error estimate for blocks of size 2^( 2) =       0.000422919609
  error estimate for blocks of size 2^( 3) =       0.000436708110
  error estimate for blocks of size 2^( 4) =       0.000449086401
  error estimate for blocks of size 2^( 5) =       0.000459673963
  error estimate for blocks of size 2^( 6) =       0.000468705899
  error estimate for blocks of size 2^( 7) =       0.000475591855

      target function =                  N/A
              le_mean =     -16.905265571119
             les_mean =     286.124274864361
             stat err =       0.000463264529
             autocorr =       1.276434914708
              std dev =       0.579888784530
             le_variance =       0.336271002424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341188801
                                         uncertainty =       0.003511085322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341188801
                                         uncertainty =       0.003511085322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410043293
  error estimate for blocks of size 2^( 2) =       0.000422919610
  error estimate for blocks of size 2^( 3) =       0.000436708111
  error estimate for blocks of size 2^( 4) =       0.000449086402
  error estimate for blocks of size 2^( 5) =       0.000459673963
  error estimate for blocks of size 2^( 6) =       0.000468705899
  error estimate for blocks of size 2^( 7) =       0.000475591856

      target function =                  N/A
              le_mean =     -16.905265571172
             les_mean =     286.124274867860
             stat err =       0.000463264530
             autocorr =       1.276434912644
              std dev =       0.579888786004
             le_variance =       0.336271004133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341190300
                                         uncertainty =       0.003511085324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336341190300
                                         uncertainty =       0.003511085324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410043294
  error estimate for blocks of size 2^( 2) =       0.000422919611
  error estimate for blocks of size 2^( 3) =       0.000436708112
  error estimate for blocks of size 2^( 4) =       0.000449086402
  error estimate for blocks of size 2^( 5) =       0.000459673964
  error estimate for blocks of size 2^( 6) =       0.000468705900
  error estimate for blocks of size 2^( 7) =       0.000475591857

      target function =                  N/A
              le_mean =     -16.905265571219
             les_mean =     286.124274870921
             stat err =       0.000463264531
             autocorr =       1.276434910848
              std dev =       0.579888787294
             le_variance =       0.336271005629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905265571225        initial  <--
     1.5625e+04     1.5625e+05             1.4598e-08       -16.905265571119
     6.2500e+04     6.2500e+05             3.6496e-09       -16.905265571172
     2.5000e+05     2.5000e+06             9.1241e-10       -16.905265571219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.2819
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1054e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8276
    reference variance = 0.223949
====================================================
  Execution time = 4.2101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3355e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0826e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333571599353
                                         uncertainty =       0.003684200834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333571599353
                                         uncertainty =       0.003684200834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408383576
  error estimate for blocks of size 2^( 2) =       0.000421440935
  error estimate for blocks of size 2^( 3) =       0.000434324201
  error estimate for blocks of size 2^( 4) =       0.000447222725
  error estimate for blocks of size 2^( 5) =       0.000457700302
  error estimate for blocks of size 2^( 6) =       0.000465842136
  error estimate for blocks of size 2^( 7) =       0.000470428035

      target function =                  N/A
              le_mean =     -16.906112434479
             les_mean =     286.150191769962
             stat err =       0.000460298300
             autocorr =       1.270405037190
              std dev =       0.577541591136
             le_variance =       0.333554289491


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611243448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112434479       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112434481       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112434475       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112434472       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112434548       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112434481       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112434387       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906112434428       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.363255e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112434479       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112434479       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112434478       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112434744       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112434546       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112434720       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112434014       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906112435807       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.408138e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112434479       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112434479       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112434479       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112434121       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112433915       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112438959       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112433908       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906112433902       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 8.520353e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2936e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8605
    reference variance = 0.226966
====================================================
  Execution time = 3.9382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3762e-01
  Total weights = 2.0000e+06
  Execution time = 3.6395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674631086
                                         uncertainty =       0.004076732699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674631086
                                         uncertainty =       0.004076732699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410863389
  error estimate for blocks of size 2^( 2) =       0.000423655753
  error estimate for blocks of size 2^( 3) =       0.000436932932
  error estimate for blocks of size 2^( 4) =       0.000449341919
  error estimate for blocks of size 2^( 5) =       0.000461619611
  error estimate for blocks of size 2^( 6) =       0.000469574236
  error estimate for blocks of size 2^( 7) =       0.000475535802

      target function =                  N/A
              le_mean =     -16.905922351390
             les_mean =     286.147827831029
             stat err =       0.000464017892
             autocorr =       1.275482679498
              std dev =       0.581048576807
             le_variance =       0.337617448609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674630279
                                         uncertainty =       0.004076732700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674630279
                                         uncertainty =       0.004076732700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410863388
  error estimate for blocks of size 2^( 2) =       0.000423655752
  error estimate for blocks of size 2^( 3) =       0.000436932931
  error estimate for blocks of size 2^( 4) =       0.000449341918
  error estimate for blocks of size 2^( 5) =       0.000461619610
  error estimate for blocks of size 2^( 6) =       0.000469574236
  error estimate for blocks of size 2^( 7) =       0.000475535802

      target function =                  N/A
              le_mean =     -16.905922351381
             les_mean =     286.147827829915
             stat err =       0.000464017891
             autocorr =       1.275482680160
              std dev =       0.581048576113
             le_variance =       0.337617447803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674630682
                                         uncertainty =       0.004076732700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674630682
                                         uncertainty =       0.004076732700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410863389
  error estimate for blocks of size 2^( 2) =       0.000423655753
  error estimate for blocks of size 2^( 3) =       0.000436932932
  error estimate for blocks of size 2^( 4) =       0.000449341918
  error estimate for blocks of size 2^( 5) =       0.000461619610
  error estimate for blocks of size 2^( 6) =       0.000469574236
  error estimate for blocks of size 2^( 7) =       0.000475535802

      target function =                  N/A
              le_mean =     -16.905922351385
             les_mean =     286.147827830472
             stat err =       0.000464017892
             autocorr =       1.275482679833
              std dev =       0.581048576460
             le_variance =       0.337617448206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674631035
                                         uncertainty =       0.004076732699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674631035
                                         uncertainty =       0.004076732699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410863389
  error estimate for blocks of size 2^( 2) =       0.000423655753
  error estimate for blocks of size 2^( 3) =       0.000436932932
  error estimate for blocks of size 2^( 4) =       0.000449341919
  error estimate for blocks of size 2^( 5) =       0.000461619611
  error estimate for blocks of size 2^( 6) =       0.000469574236
  error estimate for blocks of size 2^( 7) =       0.000475535802

      target function =                  N/A
              le_mean =     -16.905922351389
             les_mean =     286.147827830959
             stat err =       0.000464017892
             autocorr =       1.275482679537
              std dev =       0.581048576763
             le_variance =       0.337617448559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905922351390        initial  <--
     1.5625e+05     1.5625e+06             1.3633e-09       -16.905922351381
     6.2500e+05     6.2500e+06             3.4081e-10       -16.905922351385
     2.5000e+06     2.5000e+07             8.5204e-11       -16.905922351389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.7016
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1065e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8635
    reference variance = 0.441981
====================================================
  Execution time = 4.0830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3180e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0756e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331838053369
                                         uncertainty =       0.002477418874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331838053369
                                         uncertainty =       0.002477418874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407310966
  error estimate for blocks of size 2^( 2) =       0.000420328220
  error estimate for blocks of size 2^( 3) =       0.000434168940
  error estimate for blocks of size 2^( 4) =       0.000447290682
  error estimate for blocks of size 2^( 5) =       0.000459374320
  error estimate for blocks of size 2^( 6) =       0.000467886402
  error estimate for blocks of size 2^( 7) =       0.000475259717

      target function =                  N/A
              le_mean =     -16.905492087185
             les_mean =     286.127466990633
             stat err =       0.000462452780
             autocorr =       1.289088052988
              std dev =       0.576024692742
             le_variance =       0.331804446649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549208719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905492087185       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905492087185       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905492087186       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492087186       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492087135       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905492086871       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905492087081       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905492087200       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.305793e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905492087185       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905492087185       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905492087185       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492087646       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492084467       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905492089021       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905492084830       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905492088413       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 3.264480e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905492087185       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905492087185       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905492087185       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492089559       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492085968       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905492064424       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905492092646       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905492093965       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+07 is 8.160946e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1595e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.212604
====================================================
  Execution time = 3.9334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3371e-01
  Total weights = 2.0000e+06
  Execution time = 3.6318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107580
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107580
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408477265
  error estimate for blocks of size 2^( 2) =       0.000421364573
  error estimate for blocks of size 2^( 3) =       0.000434678273
  error estimate for blocks of size 2^( 4) =       0.000447697861
  error estimate for blocks of size 2^( 5) =       0.000458072702
  error estimate for blocks of size 2^( 6) =       0.000467493003
  error estimate for blocks of size 2^( 7) =       0.000472873732

      target function =                  N/A
              le_mean =     -16.904553865199
             les_mean =     286.097648566762
             stat err =       0.000461534325
             autocorr =       1.276651121872
              std dev =       0.577674088226
             le_variance =       0.333707352208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107619
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107619
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408477265
  error estimate for blocks of size 2^( 2) =       0.000421364573
  error estimate for blocks of size 2^( 3) =       0.000434678273
  error estimate for blocks of size 2^( 4) =       0.000447697861
  error estimate for blocks of size 2^( 5) =       0.000458072702
  error estimate for blocks of size 2^( 6) =       0.000467493003
  error estimate for blocks of size 2^( 7) =       0.000472873732

      target function =                  N/A
              le_mean =     -16.904553865199
             les_mean =     286.097648566797
             stat err =       0.000461534325
             autocorr =       1.276651121831
              std dev =       0.577674088260
             le_variance =       0.333707352247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107599
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107599
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408477265
  error estimate for blocks of size 2^( 2) =       0.000421364573
  error estimate for blocks of size 2^( 3) =       0.000434678273
  error estimate for blocks of size 2^( 4) =       0.000447697861
  error estimate for blocks of size 2^( 5) =       0.000458072702
  error estimate for blocks of size 2^( 6) =       0.000467493003
  error estimate for blocks of size 2^( 7) =       0.000472873732

      target function =                  N/A
              le_mean =     -16.904553865199
             les_mean =     286.097648566779
             stat err =       0.000461534325
             autocorr =       1.276651121838
              std dev =       0.577674088243
             le_variance =       0.333707352228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107582
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600107582
                                         uncertainty =       0.003916753042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408477265
  error estimate for blocks of size 2^( 2) =       0.000421364573
  error estimate for blocks of size 2^( 3) =       0.000434678273
  error estimate for blocks of size 2^( 4) =       0.000447697861
  error estimate for blocks of size 2^( 5) =       0.000458072702
  error estimate for blocks of size 2^( 6) =       0.000467493003
  error estimate for blocks of size 2^( 7) =       0.000472873732

      target function =                  N/A
              le_mean =     -16.904553865199
             les_mean =     286.097648566764
             stat err =       0.000461534325
             autocorr =       1.276651121865
              std dev =       0.577674088228
             le_variance =       0.333707352211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904553865199        initial  <--
     1.5625e+06     1.5625e+07             1.3058e-10       -16.904553865199
     6.2500e+06     6.2500e+07             3.2645e-11       -16.904553865199
     2.5000e+07     2.5000e+08             8.1609e-12       -16.904553865199

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5985
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0920e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.144214
====================================================
  Execution time = 4.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4276e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0711e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759156509
                                         uncertainty =       0.003860779040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342759156509
                                         uncertainty =       0.003860779040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413980680
  error estimate for blocks of size 2^( 2) =       0.000427103259
  error estimate for blocks of size 2^( 3) =       0.000440463633
  error estimate for blocks of size 2^( 4) =       0.000453417054
  error estimate for blocks of size 2^( 5) =       0.000465710632
  error estimate for blocks of size 2^( 6) =       0.000475938122
  error estimate for blocks of size 2^( 7) =       0.000479649550

      target function =                  N/A
              le_mean =     -16.905642054743
             les_mean =     286.143493119045
             stat err =       0.000468678839
             autocorr =       1.281712275568
              std dev =       0.585457092660
             le_variance =       0.342760007346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564205474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905642054742       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905642054743       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905642054743       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905642054743       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905642054743       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905642055012       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905642055425       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905642043391       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.972863e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905642054742       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905642054743       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905642054743       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905642054743       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905642054743       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905642067262       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905642000579       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905641886398       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.932054e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905642054742       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905642054743       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905642054743       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905641975743       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905642063247       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905642054743       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905642000303       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905642045823       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 1.233020e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1345e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8742
    reference variance = 0.207389
====================================================
  Execution time = 4.0694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5390e-01
  Total weights = 2.0000e+06
  Execution time = 3.6501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420651496
  error estimate for blocks of size 2^( 2) =       0.000433093880
  error estimate for blocks of size 2^( 3) =       0.000446692940
  error estimate for blocks of size 2^( 4) =       0.000459195401
  error estimate for blocks of size 2^( 5) =       0.000469792378
  error estimate for blocks of size 2^( 6) =       0.000475902306
  error estimate for blocks of size 2^( 7) =       0.000484193843

      target function =                  N/A
              le_mean =     -16.905495505090
             les_mean =     286.149673457614
             stat err =       0.000472270982
             autocorr =       1.260484904059
              std dev =       0.594891050485
             le_variance =       0.353895361947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010911
                                         uncertainty =       0.012062269458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010911
                                         uncertainty =       0.012062269458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420651496
  error estimate for blocks of size 2^( 2) =       0.000433093880
  error estimate for blocks of size 2^( 3) =       0.000446692940
  error estimate for blocks of size 2^( 4) =       0.000459195401
  error estimate for blocks of size 2^( 5) =       0.000469792378
  error estimate for blocks of size 2^( 6) =       0.000475902306
  error estimate for blocks of size 2^( 7) =       0.000484193843

      target function =                  N/A
              le_mean =     -16.905495505090
             les_mean =     286.149673457613
             stat err =       0.000472270982
             autocorr =       1.260484904053
              std dev =       0.594891050485
             le_variance =       0.353895361948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420651496
  error estimate for blocks of size 2^( 2) =       0.000433093880
  error estimate for blocks of size 2^( 3) =       0.000446692940
  error estimate for blocks of size 2^( 4) =       0.000459195401
  error estimate for blocks of size 2^( 5) =       0.000469792378
  error estimate for blocks of size 2^( 6) =       0.000475902306
  error estimate for blocks of size 2^( 7) =       0.000484193843

      target function =                  N/A
              le_mean =     -16.905495505090
             les_mean =     286.149673457614
             stat err =       0.000472270982
             autocorr =       1.260484904059
              std dev =       0.594891050485
             le_variance =       0.353895361948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353625010910
                                         uncertainty =       0.012062269457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420651496
  error estimate for blocks of size 2^( 2) =       0.000433093880
  error estimate for blocks of size 2^( 3) =       0.000446692940
  error estimate for blocks of size 2^( 4) =       0.000459195401
  error estimate for blocks of size 2^( 5) =       0.000469792378
  error estimate for blocks of size 2^( 6) =       0.000475902306
  error estimate for blocks of size 2^( 7) =       0.000484193843

      target function =                  N/A
              le_mean =     -16.905495505090
             les_mean =     286.149673457614
             stat err =       0.000472270982
             autocorr =       1.260484904058
              std dev =       0.594891050485
             le_variance =       0.353895361947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905495505090        initial
     1.5625e+07     1.5625e+08             1.9729e-11       -16.905495505090
     6.2500e+07     6.2500e+08             4.9321e-12       -16.905495505090
     2.5000e+08     2.5000e+09             1.2330e-12       -16.905495505090  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+08     and shift_s =   2.5000e+09
*****************************************************************************

  Execution time = 6.1818e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1317e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.237367
====================================================
  Execution time = 4.0961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1080e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340709016249
                                         uncertainty =       0.005406512533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340709016249
                                         uncertainty =       0.005406512533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412700197
  error estimate for blocks of size 2^( 2) =       0.000425235040
  error estimate for blocks of size 2^( 3) =       0.000438419782
  error estimate for blocks of size 2^( 4) =       0.000451691445
  error estimate for blocks of size 2^( 5) =       0.000462188347
  error estimate for blocks of size 2^( 6) =       0.000470864472
  error estimate for blocks of size 2^( 7) =       0.000476122367

      target function =                  N/A
              le_mean =     -16.905102248505
             les_mean =     286.123124766583
             stat err =       0.000465216658
             autocorr =       1.270694536310
              std dev =       0.583646215191
             le_variance =       0.340642904506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510224850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905102248505       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905102248505       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905102248505       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905102248505       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905102251430       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905102249133       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905102005760       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905102215224       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 3.392143e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905102248505       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905102248505       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905102248505       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905102248505       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905102254583       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905102183528       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905102257422       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905101900669       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 8.479453e-13

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905102248505       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905102248505       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905102248505       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905102182470       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905102194742       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905102021735       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905101810642       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905102057114       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+09 is 2.120664e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2050e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8336
    reference variance = 0.288395
====================================================
  Execution time = 3.9074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3992e-01
  Total weights = 2.0000e+06
  Execution time = 3.6427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412262466
  error estimate for blocks of size 2^( 2) =       0.000424510897
  error estimate for blocks of size 2^( 3) =       0.000437826734
  error estimate for blocks of size 2^( 4) =       0.000449805174
  error estimate for blocks of size 2^( 5) =       0.000459885514
  error estimate for blocks of size 2^( 6) =       0.000468609535
  error estimate for blocks of size 2^( 7) =       0.000470864630

      target function =                  N/A
              le_mean =     -16.906106400837
             les_mean =     286.156354147766
             stat err =       0.000462291213
             autocorr =       1.257429615868
              std dev =       0.583027170298
             le_variance =       0.339920681306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604749
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604749
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412262466
  error estimate for blocks of size 2^( 2) =       0.000424510897
  error estimate for blocks of size 2^( 3) =       0.000437826734
  error estimate for blocks of size 2^( 4) =       0.000449805174
  error estimate for blocks of size 2^( 5) =       0.000459885514
  error estimate for blocks of size 2^( 6) =       0.000468609535
  error estimate for blocks of size 2^( 7) =       0.000470864630

      target function =                  N/A
              le_mean =     -16.906106400837
             les_mean =     286.156354147765
             stat err =       0.000462291213
             autocorr =       1.257429615862
              std dev =       0.583027170297
             le_variance =       0.339920681304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412262466
  error estimate for blocks of size 2^( 2) =       0.000424510897
  error estimate for blocks of size 2^( 3) =       0.000437826734
  error estimate for blocks of size 2^( 4) =       0.000449805174
  error estimate for blocks of size 2^( 5) =       0.000459885514
  error estimate for blocks of size 2^( 6) =       0.000468609535
  error estimate for blocks of size 2^( 7) =       0.000470864630

      target function =                  N/A
              le_mean =     -16.906106400837
             les_mean =     286.156354147765
             stat err =       0.000462291213
             autocorr =       1.257429615859
              std dev =       0.583027170297
             le_variance =       0.339920681305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339973604750
                                         uncertainty =       0.004554714362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412262466
  error estimate for blocks of size 2^( 2) =       0.000424510897
  error estimate for blocks of size 2^( 3) =       0.000437826734
  error estimate for blocks of size 2^( 4) =       0.000449805174
  error estimate for blocks of size 2^( 5) =       0.000459885514
  error estimate for blocks of size 2^( 6) =       0.000468609535
  error estimate for blocks of size 2^( 7) =       0.000470864630

      target function =                  N/A
              le_mean =     -16.906106400837
             les_mean =     286.156354147766
             stat err =       0.000462291213
             autocorr =       1.257429615859
              std dev =       0.583027170298
             le_variance =       0.339920681306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906106400837        initial
     6.2500e+07     6.2500e+08             3.3921e-12       -16.906106400837  <--
     2.5000e+08     2.5000e+09             8.4795e-13       -16.906106400837
     1.0000e+09     1.0000e+10             2.1207e-13       -16.906106400837

*****************************************************************************
Applying the update for shift_i =   6.2500e+07     and shift_s =   6.2500e+08
*****************************************************************************

  Execution time = 5.7412e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0948e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.949
    reference variance = 0.337483
====================================================
  Execution time = 4.0016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4385e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0696e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960433508
                                         uncertainty =       0.006075190516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960433508
                                         uncertainty =       0.006075190516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414637299
  error estimate for blocks of size 2^( 2) =       0.000427342198
  error estimate for blocks of size 2^( 3) =       0.000440734996
  error estimate for blocks of size 2^( 4) =       0.000453421462
  error estimate for blocks of size 2^( 5) =       0.000464939568
  error estimate for blocks of size 2^( 6) =       0.000473142773
  error estimate for blocks of size 2^( 7) =       0.000480066536

      target function =                  N/A
              le_mean =     -16.904752730789
             les_mean =     286.114512896774
             stat err =       0.000467892585
             autocorr =       1.273372865728
              std dev =       0.586385691825
             le_variance =       0.343848179577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475273079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904752730789       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904752730789       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904752730789       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904752730789       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904752730789       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904752742742       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904752724254       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904752731661       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.621692e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904752730789       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904752730789       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904752730789       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904752780312       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904752734826       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904752732350       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904752752291       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904752702050       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.054453e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904752730789       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904752730789       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904752730789       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904752713374       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904752730976       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904752616584       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904752963471       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904752582136       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 1.013680e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0721e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.191291
====================================================
  Execution time = 3.9176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3858e-01
  Total weights = 2.0000e+06
  Execution time = 3.6307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740702
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740702
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411445775
  error estimate for blocks of size 2^( 2) =       0.000424172686
  error estimate for blocks of size 2^( 3) =       0.000437474246
  error estimate for blocks of size 2^( 4) =       0.000448991586
  error estimate for blocks of size 2^( 5) =       0.000460280929
  error estimate for blocks of size 2^( 6) =       0.000467940006
  error estimate for blocks of size 2^( 7) =       0.000472432499

      target function =                  N/A
              le_mean =     -16.905588823352
             les_mean =     286.137508546896
             stat err =       0.000462411255
             autocorr =       1.263082093380
              std dev =       0.581872195549
             le_variance =       0.338575251953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740695
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740695
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411445775
  error estimate for blocks of size 2^( 2) =       0.000424172686
  error estimate for blocks of size 2^( 3) =       0.000437474246
  error estimate for blocks of size 2^( 4) =       0.000448991586
  error estimate for blocks of size 2^( 5) =       0.000460280929
  error estimate for blocks of size 2^( 6) =       0.000467940006
  error estimate for blocks of size 2^( 7) =       0.000472432499

      target function =                  N/A
              le_mean =     -16.905588823352
             les_mean =     286.137508546887
             stat err =       0.000462411255
             autocorr =       1.263082093393
              std dev =       0.581872195543
             le_variance =       0.338575251946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740698
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740698
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411445775
  error estimate for blocks of size 2^( 2) =       0.000424172686
  error estimate for blocks of size 2^( 3) =       0.000437474246
  error estimate for blocks of size 2^( 4) =       0.000448991586
  error estimate for blocks of size 2^( 5) =       0.000460280929
  error estimate for blocks of size 2^( 6) =       0.000467940006
  error estimate for blocks of size 2^( 7) =       0.000472432499

      target function =                  N/A
              le_mean =     -16.905588823352
             les_mean =     286.137508546892
             stat err =       0.000462411255
             autocorr =       1.263082093388
              std dev =       0.581872195546
             le_variance =       0.338575251950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740701
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338551740701
                                         uncertainty =       0.004527882540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411445775
  error estimate for blocks of size 2^( 2) =       0.000424172686
  error estimate for blocks of size 2^( 3) =       0.000437474246
  error estimate for blocks of size 2^( 4) =       0.000448991586
  error estimate for blocks of size 2^( 5) =       0.000460280929
  error estimate for blocks of size 2^( 6) =       0.000467940006
  error estimate for blocks of size 2^( 7) =       0.000472432499

      target function =                  N/A
              le_mean =     -16.905588823352
             les_mean =     286.137508546896
             stat err =       0.000462411255
             autocorr =       1.263082093385
              std dev =       0.581872195549
             le_variance =       0.338575251953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905588823352        initial  <--
     1.5625e+07     1.5625e+08             1.6217e-11       -16.905588823352
     6.2500e+07     6.2500e+08             4.0545e-12       -16.905588823352
     2.5000e+08     2.5000e+09             1.0137e-12       -16.905588823352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4583
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0819e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.432977
====================================================
  Execution time = 4.1970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0751e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338097102116
                                         uncertainty =       0.004190919765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338097102116
                                         uncertainty =       0.004190919765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411097485
  error estimate for blocks of size 2^( 2) =       0.000424318802
  error estimate for blocks of size 2^( 3) =       0.000437181894
  error estimate for blocks of size 2^( 4) =       0.000450147397
  error estimate for blocks of size 2^( 5) =       0.000461482672
  error estimate for blocks of size 2^( 6) =       0.000468198997
  error estimate for blocks of size 2^( 7) =       0.000475009857

      target function =                  N/A
              le_mean =     -16.905080480315
             les_mean =     286.119748160902
             stat err =       0.000463709730
             autocorr =       1.272338823297
              std dev =       0.581379638439
             le_variance =       0.338002283991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690508048031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905080480315       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905080480315       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905080480315       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905080480315       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905080438720       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905080519737       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905080534284       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905080321408       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 1.226369e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905080480315       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905080480315       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905080480315       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905080480315       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905080449734       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905080403696       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905080234344       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905080479327       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 3.063949e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905080480315       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905080480315       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905080480315       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905080355132       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905080906406       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905082069824       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905080685701       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905081159855       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+09 is 7.693787e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2730e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8212
    reference variance = 0.280309
====================================================
  Execution time = 4.2326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4329e-01
  Total weights = 2.0000e+06
  Execution time = 3.6694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414298772
  error estimate for blocks of size 2^( 2) =       0.000427404151
  error estimate for blocks of size 2^( 3) =       0.000440925768
  error estimate for blocks of size 2^( 4) =       0.000453641531
  error estimate for blocks of size 2^( 5) =       0.000464539682
  error estimate for blocks of size 2^( 6) =       0.000471200333
  error estimate for blocks of size 2^( 7) =       0.000476978446

      target function =                  N/A
              le_mean =     -16.905314818598
             les_mean =     286.132955889649
             stat err =       0.000466589998
             autocorr =       1.268362979939
              std dev =       0.585906942601
             le_variance =       0.343286945388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414298772
  error estimate for blocks of size 2^( 2) =       0.000427404151
  error estimate for blocks of size 2^( 3) =       0.000440925768
  error estimate for blocks of size 2^( 4) =       0.000453641531
  error estimate for blocks of size 2^( 5) =       0.000464539682
  error estimate for blocks of size 2^( 6) =       0.000471200333
  error estimate for blocks of size 2^( 7) =       0.000476978446

      target function =                  N/A
              le_mean =     -16.905314818598
             les_mean =     286.132955889649
             stat err =       0.000466589998
             autocorr =       1.268362979935
              std dev =       0.585906942601
             le_variance =       0.343286945388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414298772
  error estimate for blocks of size 2^( 2) =       0.000427404151
  error estimate for blocks of size 2^( 3) =       0.000440925768
  error estimate for blocks of size 2^( 4) =       0.000453641531
  error estimate for blocks of size 2^( 5) =       0.000464539682
  error estimate for blocks of size 2^( 6) =       0.000471200333
  error estimate for blocks of size 2^( 7) =       0.000476978446

      target function =                  N/A
              le_mean =     -16.905314818598
             les_mean =     286.132955889649
             stat err =       0.000466589998
             autocorr =       1.268362979943
              std dev =       0.585906942601
             le_variance =       0.343286945388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343266737110
                                         uncertainty =       0.004263710338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414298772
  error estimate for blocks of size 2^( 2) =       0.000427404151
  error estimate for blocks of size 2^( 3) =       0.000440925768
  error estimate for blocks of size 2^( 4) =       0.000453641531
  error estimate for blocks of size 2^( 5) =       0.000464539682
  error estimate for blocks of size 2^( 6) =       0.000471200333
  error estimate for blocks of size 2^( 7) =       0.000476978446

      target function =                  N/A
              le_mean =     -16.905314818598
             les_mean =     286.132955889649
             stat err =       0.000466589998
             autocorr =       1.268362979947
              std dev =       0.585906942601
             le_variance =       0.343286945388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905314818598        initial  <--
     1.5625e+08     1.5625e+09             1.2264e-12       -16.905314818598
     6.2500e+08     6.2500e+09             3.0639e-13       -16.905314818598
     2.5000e+09     2.5000e+10             7.6938e-14       -16.905314818598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7587
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1352e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.0076
    reference variance = 0.305952
====================================================
  Execution time = 4.0041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5453e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0722e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354614525333
                                         uncertainty =       0.014924753407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354614525333
                                         uncertainty =       0.014924753407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421031456
  error estimate for blocks of size 2^( 2) =       0.000433827858
  error estimate for blocks of size 2^( 3) =       0.000447523253
  error estimate for blocks of size 2^( 4) =       0.000459862467
  error estimate for blocks of size 2^( 5) =       0.000471088502
  error estimate for blocks of size 2^( 6) =       0.000479985859
  error estimate for blocks of size 2^( 7) =       0.000481589237

      target function =                  N/A
              le_mean =     -16.906414196148
             les_mean =     286.181375767773
             stat err =       0.000473131516
             autocorr =       1.262800279245
              std dev =       0.595428394794
             le_variance =       0.354534973327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641419615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414196148       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414196148       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414196148       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414196148       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414638246       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413988557       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906415413299       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906413677065       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 1.674935e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414196148       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414196148       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414196148       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414196099       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414191529       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410989842       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413348670       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906415800750       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+09 is 4.172899e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414196148       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414196148       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414196148       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414048483       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906419615804       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906444448483       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427277851       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906398308674       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906417409060       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+10 is 1.065144e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0775e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.196556
====================================================
  Execution time = 3.8841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3035e-01
  Total weights = 2.0000e+06
  Execution time = 3.6687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406417546
  error estimate for blocks of size 2^( 2) =       0.000419821837
  error estimate for blocks of size 2^( 3) =       0.000433088168
  error estimate for blocks of size 2^( 4) =       0.000445989929
  error estimate for blocks of size 2^( 5) =       0.000456662165
  error estimate for blocks of size 2^( 6) =       0.000465994735
  error estimate for blocks of size 2^( 7) =       0.000467162787

      target function =                  N/A
              le_mean =     -16.905364944284
             les_mean =     286.121714177583
             stat err =       0.000458952404
             autocorr =       1.275235515821
              std dev =       0.574761205489
             le_variance =       0.330350443335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406417546
  error estimate for blocks of size 2^( 2) =       0.000419821837
  error estimate for blocks of size 2^( 3) =       0.000433088168
  error estimate for blocks of size 2^( 4) =       0.000445989929
  error estimate for blocks of size 2^( 5) =       0.000456662165
  error estimate for blocks of size 2^( 6) =       0.000465994735
  error estimate for blocks of size 2^( 7) =       0.000467162787

      target function =                  N/A
              le_mean =     -16.905364944284
             les_mean =     286.121714177583
             stat err =       0.000458952404
             autocorr =       1.275235515823
              std dev =       0.574761205489
             le_variance =       0.330350443335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406417546
  error estimate for blocks of size 2^( 2) =       0.000419821837
  error estimate for blocks of size 2^( 3) =       0.000433088168
  error estimate for blocks of size 2^( 4) =       0.000445989929
  error estimate for blocks of size 2^( 5) =       0.000456662165
  error estimate for blocks of size 2^( 6) =       0.000465994735
  error estimate for blocks of size 2^( 7) =       0.000467162787

      target function =                  N/A
              le_mean =     -16.905364944284
             les_mean =     286.121714177583
             stat err =       0.000458952404
             autocorr =       1.275235515822
              std dev =       0.574761205489
             le_variance =       0.330350443335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330450086712
                                         uncertainty =       0.003208639351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406417546
  error estimate for blocks of size 2^( 2) =       0.000419821837
  error estimate for blocks of size 2^( 3) =       0.000433088168
  error estimate for blocks of size 2^( 4) =       0.000445989929
  error estimate for blocks of size 2^( 5) =       0.000456662165
  error estimate for blocks of size 2^( 6) =       0.000465994735
  error estimate for blocks of size 2^( 7) =       0.000467162787

      target function =                  N/A
              le_mean =     -16.905364944284
             les_mean =     286.121714177583
             stat err =       0.000458952404
             autocorr =       1.275235515826
              std dev =       0.574761205489
             le_variance =       0.330350443335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905364944284        initial  <--
     1.5625e+09     1.5625e+10             1.6749e-13       -16.905364944284
     6.2500e+09     6.2500e+10             4.1729e-14       -16.905364944284
     2.5000e+10     2.5000e+11             1.0651e-14       -16.905364944284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.2379
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0802e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.272186
====================================================
  Execution time = 4.0525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5041e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0865e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350443735654
                                         uncertainty =       0.007360703816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350443735654
                                         uncertainty =       0.007360703816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418577683
  error estimate for blocks of size 2^( 2) =       0.000431223357
  error estimate for blocks of size 2^( 3) =       0.000443767554
  error estimate for blocks of size 2^( 4) =       0.000455967289
  error estimate for blocks of size 2^( 5) =       0.000466047257
  error estimate for blocks of size 2^( 6) =       0.000474220523
  error estimate for blocks of size 2^( 7) =       0.000481462225

      target function =                  N/A
              le_mean =     -16.906029242564
             les_mean =     286.164239129164
             stat err =       0.000469424324
             autocorr =       1.257705726876
              std dev =       0.591958236648
             le_variance =       0.350414553936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602924256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029242564       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029242564       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906029242564       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906024363896       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026997874       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906018839388       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033018396       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906031169455       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+10 is 1.379969e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029242564       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029242564       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906029242564       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906036696766       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906029518538       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906028419287       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905999125760       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010486460       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905966013988       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905899157383       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906767943262       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905996710944       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905256815980       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904449329151       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904859018118       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911971772400       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903603855954       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906501915398       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905947953608       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903572373431       residual = 7.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908072146083       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903357289283       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909645109575       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905597004245       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908337894834       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906498761557       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903029964026       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.899606497282       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908527652768       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903959765087       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906709634947       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.902342187659       residual = 2.07e-03           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.901034980775       residual = 3.52e-03           smallest_sin_value = 9.93e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.907423069572       residual = 2.43e-03           smallest_sin_value = 9.92e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.13e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+10 is 3.393818e-15

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029242564       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029242564       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906029242564       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067831332       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027401463       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222848929       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906071380206       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906927317153       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907209509556       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907541854594       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910066496940       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907045058294       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.899708580206       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913205315598       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.894232216188       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907669936953       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908957190224       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905869547488       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903807254055       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.898329730327       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.899973888447       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.898468184525       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.913693690002       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.885509030502       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.894216172009       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.873818956814       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.897604933397       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.886568902212       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.900931574628       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.917278539083       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908854027825       residual = 2.16e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.904772732242       residual = 1.58e-03           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.865058101512       residual = 2.25e-01           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+11 is 5.970269e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1522e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8237
    reference variance = 0.258734
====================================================
  Execution time = 3.8752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3725e-01
  Total weights = 2.0000e+06
  Execution time = 3.6604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410639889
  error estimate for blocks of size 2^( 2) =       0.000423520658
  error estimate for blocks of size 2^( 3) =       0.000437093110
  error estimate for blocks of size 2^( 4) =       0.000449281376
  error estimate for blocks of size 2^( 5) =       0.000460520060
  error estimate for blocks of size 2^( 6) =       0.000468765717
  error estimate for blocks of size 2^( 7) =       0.000472577701

      target function =                  N/A
              le_mean =     -16.904852140254
             les_mean =     286.111275952088
             stat err =       0.000462786213
             autocorr =       1.270101876332
              std dev =       0.580732500261
             le_variance =       0.337250236859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410639889
  error estimate for blocks of size 2^( 2) =       0.000423520658
  error estimate for blocks of size 2^( 3) =       0.000437093110
  error estimate for blocks of size 2^( 4) =       0.000449281376
  error estimate for blocks of size 2^( 5) =       0.000460520060
  error estimate for blocks of size 2^( 6) =       0.000468765717
  error estimate for blocks of size 2^( 7) =       0.000472577701

      target function =                  N/A
              le_mean =     -16.904852140254
             les_mean =     286.111275952088
             stat err =       0.000462786213
             autocorr =       1.270101876335
              std dev =       0.580732500261
             le_variance =       0.337250236859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410639889
  error estimate for blocks of size 2^( 2) =       0.000423520658
  error estimate for blocks of size 2^( 3) =       0.000437093110
  error estimate for blocks of size 2^( 4) =       0.000449281376
  error estimate for blocks of size 2^( 5) =       0.000460520060
  error estimate for blocks of size 2^( 6) =       0.000468765717
  error estimate for blocks of size 2^( 7) =       0.000472577701

      target function =                  N/A
              le_mean =     -16.904852140254
             les_mean =     286.111275952088
             stat err =       0.000462786213
             autocorr =       1.270101876336
              std dev =       0.580732500260
             le_variance =       0.337250236859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344834049
                                         uncertainty =       0.003208295836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410639889
  error estimate for blocks of size 2^( 2) =       0.000423520658
  error estimate for blocks of size 2^( 3) =       0.000437093110
  error estimate for blocks of size 2^( 4) =       0.000449281376
  error estimate for blocks of size 2^( 5) =       0.000460520060
  error estimate for blocks of size 2^( 6) =       0.000468765717
  error estimate for blocks of size 2^( 7) =       0.000472577701

      target function =                  N/A
              le_mean =     -16.904852140254
             les_mean =     286.111275952088
             stat err =       0.000462786213
             autocorr =       1.270101876333
              std dev =       0.580732500261
             le_variance =       0.337250236859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904852140254        initial  <--
     1.5625e+10     1.5625e+11             1.3800e-14       -16.904852140254
     6.2500e+10     6.2500e+11             3.3938e-15       -16.904852140254
     2.5000e+11     2.5000e+12             5.9703e-16       -16.904852140254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4608
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.153052
====================================================
  Execution time = 4.1582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4292e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0694e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342926357800
                                         uncertainty =       0.004294882985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342926357800
                                         uncertainty =       0.004294882985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414077792
  error estimate for blocks of size 2^( 2) =       0.000427062222
  error estimate for blocks of size 2^( 3) =       0.000440311515
  error estimate for blocks of size 2^( 4) =       0.000453686262
  error estimate for blocks of size 2^( 5) =       0.000465947059
  error estimate for blocks of size 2^( 6) =       0.000474644531
  error estimate for blocks of size 2^( 7) =       0.000478370884

      target function =                  N/A
              le_mean =     -16.904762796384
             les_mean =     286.113925866437
             stat err =       0.000468162184
             autocorr =       1.278288207730
              std dev =       0.585594429513
             le_variance =       0.342920835876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690476279638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762796384       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762796384       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904762796384       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904762796384       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904767519629       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904772183081       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904700823690       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904753768092       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904414597394       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904576807290       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905639449597       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904932057348       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905305148184       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903488772829       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905057789423       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.901916779568       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.895298371549       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.874875796453       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903531915944       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.901475099432       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914037186852       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903999457725       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.899705005929       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914361735770       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909812462133       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.895621804232       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.904928414313       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.899703710695       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.898962658857       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906464401222       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901053175736       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.903452971023       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.930394255131       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.908833412355       residual = 2.85e-03           smallest_sin_value = 9.95e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+11 is 1.558540e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762796384       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762796384       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904762796384       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904667648638       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904720589449       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904997913916       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.900425287477       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903442787517       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904887185022       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922997556375       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894935159768       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.917360086636       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909879980196       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913160671293       residual = 9.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.935429712833       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.916582252238       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.900143442417       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.891747202244       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.888563563848       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.914752278683       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908164172971       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.874462664316       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.952216363880       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.955658666198       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.886810359680       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.883437199565       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.970746145560       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.746481507909       residual = 3.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.951691349385       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.859215817838       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901029595408       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.905245724010       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.980056508488       residual = 7.52e-01           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.930488372237       residual = 8.38e-02           smallest_sin_value = 9.93e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.910003238298       residual = 2.33e-02           smallest_sin_value = 9.90e-01
davidson iteration   35 stopping due to small subspace S singular value of 8.70e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+11 is 8.058005e-17

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762796384       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762796384       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2329e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9254
    reference variance = 0.313143
====================================================
  Execution time = 3.9042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3857e-01
  Total weights = 2.0000e+06
  Execution time = 3.6338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441608
  error estimate for blocks of size 2^( 2) =       0.000424331968
  error estimate for blocks of size 2^( 3) =       0.000437339722
  error estimate for blocks of size 2^( 4) =       0.000449871235
  error estimate for blocks of size 2^( 5) =       0.000460473742
  error estimate for blocks of size 2^( 6) =       0.000468517450
  error estimate for blocks of size 2^( 7) =       0.000474785560

      target function =                  N/A
              le_mean =     -16.905714552062
             les_mean =     286.141752740550
             stat err =       0.000463411997
             autocorr =       1.268580780751
              std dev =       0.581866302554
             le_variance =       0.338568394048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441608
  error estimate for blocks of size 2^( 2) =       0.000424331968
  error estimate for blocks of size 2^( 3) =       0.000437339722
  error estimate for blocks of size 2^( 4) =       0.000449871235
  error estimate for blocks of size 2^( 5) =       0.000460473742
  error estimate for blocks of size 2^( 6) =       0.000468517450
  error estimate for blocks of size 2^( 7) =       0.000474785560

      target function =                  N/A
              le_mean =     -16.905714552062
             les_mean =     286.141752740550
             stat err =       0.000463411997
             autocorr =       1.268580780743
              std dev =       0.581866302554
             le_variance =       0.338568394048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441608
  error estimate for blocks of size 2^( 2) =       0.000424331968
  error estimate for blocks of size 2^( 3) =       0.000437339722
  error estimate for blocks of size 2^( 4) =       0.000449871235
  error estimate for blocks of size 2^( 5) =       0.000460473742
  error estimate for blocks of size 2^( 6) =       0.000468517450
  error estimate for blocks of size 2^( 7) =       0.000474785560

      target function =                  N/A
              le_mean =     -16.905714552062
             les_mean =     286.141752740550
             stat err =       0.000463411997
             autocorr =       1.268580780748
              std dev =       0.581866302554
             le_variance =       0.338568394048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177191812
                                         uncertainty =       0.004674328763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411441608
  error estimate for blocks of size 2^( 2) =       0.000424331968
  error estimate for blocks of size 2^( 3) =       0.000437339722
  error estimate for blocks of size 2^( 4) =       0.000449871235
  error estimate for blocks of size 2^( 5) =       0.000460473742
  error estimate for blocks of size 2^( 6) =       0.000468517450
  error estimate for blocks of size 2^( 7) =       0.000474785560

      target function =                  N/A
              le_mean =     -16.905714552062
             les_mean =     286.141752740550
             stat err =       0.000463411997
             autocorr =       1.268580780751
              std dev =       0.581866302554
             le_variance =       0.338568394048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905714552062        initial  <--
     1.5625e+11     1.5625e+12             1.5585e-15       -16.905714552062
     6.2500e+11     6.2500e+12             8.0580e-17       -16.905714552062
     2.5000e+12     2.5000e+13             0.0000e+00       -16.905714552062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.3492
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0969e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9263
    reference variance = 0.262041
====================================================
  Execution time = 4.0013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0664e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341552629306
                                         uncertainty =       0.004352985194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341552629306
                                         uncertainty =       0.004352985194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413231164
  error estimate for blocks of size 2^( 2) =       0.000426130925
  error estimate for blocks of size 2^( 3) =       0.000439302267
  error estimate for blocks of size 2^( 4) =       0.000451450097
  error estimate for blocks of size 2^( 5) =       0.000462541458
  error estimate for blocks of size 2^( 6) =       0.000470680000
  error estimate for blocks of size 2^( 7) =       0.000474218457

      target function =                  N/A
              le_mean =     -16.906115096490
             les_mean =     286.158247474727
             stat err =       0.000464722503
             autocorr =       1.264740051282
              std dev =       0.584397116444
             le_variance =       0.341519989708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611509649e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906115096490       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0683e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.509574
====================================================
  Execution time = 3.9434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.0000e+06
  Execution time = 3.6713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412399388
  error estimate for blocks of size 2^( 2) =       0.000425347804
  error estimate for blocks of size 2^( 3) =       0.000438294130
  error estimate for blocks of size 2^( 4) =       0.000450284852
  error estimate for blocks of size 2^( 5) =       0.000460892291
  error estimate for blocks of size 2^( 6) =       0.000468347496
  error estimate for blocks of size 2^( 7) =       0.000473944109

      target function =                  N/A
              le_mean =     -16.905447941687
             les_mean =     286.134316449364
             stat err =       0.000463367187
             autocorr =       1.262450994577
              std dev =       0.583220807550
             le_variance =       0.340146510359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412399388
  error estimate for blocks of size 2^( 2) =       0.000425347804
  error estimate for blocks of size 2^( 3) =       0.000438294130
  error estimate for blocks of size 2^( 4) =       0.000450284852
  error estimate for blocks of size 2^( 5) =       0.000460892291
  error estimate for blocks of size 2^( 6) =       0.000468347496
  error estimate for blocks of size 2^( 7) =       0.000473944109

      target function =                  N/A
              le_mean =     -16.905447941687
             les_mean =     286.134316449364
             stat err =       0.000463367187
             autocorr =       1.262450994577
              std dev =       0.583220807550
             le_variance =       0.340146510359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412399388
  error estimate for blocks of size 2^( 2) =       0.000425347804
  error estimate for blocks of size 2^( 3) =       0.000438294130
  error estimate for blocks of size 2^( 4) =       0.000450284852
  error estimate for blocks of size 2^( 5) =       0.000460892291
  error estimate for blocks of size 2^( 6) =       0.000468347496
  error estimate for blocks of size 2^( 7) =       0.000473944109

      target function =                  N/A
              le_mean =     -16.905447941687
             les_mean =     286.134316449364
             stat err =       0.000463367187
             autocorr =       1.262450994577
              std dev =       0.583220807550
             le_variance =       0.340146510359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340134961578
                                         uncertainty =       0.003666052353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412399388
  error estimate for blocks of size 2^( 2) =       0.000425347804
  error estimate for blocks of size 2^( 3) =       0.000438294130
  error estimate for blocks of size 2^( 4) =       0.000450284852
  error estimate for blocks of size 2^( 5) =       0.000460892291
  error estimate for blocks of size 2^( 6) =       0.000468347496
  error estimate for blocks of size 2^( 7) =       0.000473944109

      target function =                  N/A
              le_mean =     -16.905447941687
             les_mean =     286.134316449364
             stat err =       0.000463367187
             autocorr =       1.262450994577
              std dev =       0.583220807550
             le_variance =       0.340146510359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905447941687        initial  <--
     1.5625e+12     1.5625e+13             0.0000e+00       -16.905447941687
     6.2500e+12     6.2500e+13             0.0000e+00       -16.905447941687
     2.5000e+13     2.5000e+14             0.0000e+00       -16.905447941687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9155
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0861e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9409
    reference variance = 0.217727
====================================================
  Execution time = 4.0030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3228e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0893e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332285219081
                                         uncertainty =       0.002621895966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332285219081
                                         uncertainty =       0.002621895966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407605335
  error estimate for blocks of size 2^( 2) =       0.000420449343
  error estimate for blocks of size 2^( 3) =       0.000433625913
  error estimate for blocks of size 2^( 4) =       0.000446868697
  error estimate for blocks of size 2^( 5) =       0.000456687341
  error estimate for blocks of size 2^( 6) =       0.000466269562
  error estimate for blocks of size 2^( 7) =       0.000468973108

      target function =                  N/A
              le_mean =     -16.906225220390
             les_mean =     286.152735254540
             stat err =       0.000459699677
             autocorr =       1.271946012629
              std dev =       0.576440992755
             le_variance =       0.332284218129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622522039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225220390       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0930e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.329224
====================================================
  Execution time = 4.1239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4617e-01
  Total weights = 2.0000e+06
  Execution time = 3.6600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416037014
  error estimate for blocks of size 2^( 2) =       0.000428352250
  error estimate for blocks of size 2^( 3) =       0.000441493479
  error estimate for blocks of size 2^( 4) =       0.000453492412
  error estimate for blocks of size 2^( 5) =       0.000464910020
  error estimate for blocks of size 2^( 6) =       0.000471013042
  error estimate for blocks of size 2^( 7) =       0.000478603991

      target function =                  N/A
              le_mean =     -16.904952170665
             les_mean =     286.123581313115
             stat err =       0.000467004866
             autocorr =       1.260024157104
              std dev =       0.588365187376
             le_variance =       0.346173593716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416037014
  error estimate for blocks of size 2^( 2) =       0.000428352250
  error estimate for blocks of size 2^( 3) =       0.000441493479
  error estimate for blocks of size 2^( 4) =       0.000453492412
  error estimate for blocks of size 2^( 5) =       0.000464910020
  error estimate for blocks of size 2^( 6) =       0.000471013042
  error estimate for blocks of size 2^( 7) =       0.000478603991

      target function =                  N/A
              le_mean =     -16.904952170665
             les_mean =     286.123581313115
             stat err =       0.000467004866
             autocorr =       1.260024157104
              std dev =       0.588365187376
             le_variance =       0.346173593716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416037014
  error estimate for blocks of size 2^( 2) =       0.000428352250
  error estimate for blocks of size 2^( 3) =       0.000441493479
  error estimate for blocks of size 2^( 4) =       0.000453492412
  error estimate for blocks of size 2^( 5) =       0.000464910020
  error estimate for blocks of size 2^( 6) =       0.000471013042
  error estimate for blocks of size 2^( 7) =       0.000478603991

      target function =                  N/A
              le_mean =     -16.904952170665
             les_mean =     286.123581313115
             stat err =       0.000467004866
             autocorr =       1.260024157104
              std dev =       0.588365187376
             le_variance =       0.346173593716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346166823376
                                         uncertainty =       0.004891388457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416037014
  error estimate for blocks of size 2^( 2) =       0.000428352250
  error estimate for blocks of size 2^( 3) =       0.000441493479
  error estimate for blocks of size 2^( 4) =       0.000453492412
  error estimate for blocks of size 2^( 5) =       0.000464910020
  error estimate for blocks of size 2^( 6) =       0.000471013042
  error estimate for blocks of size 2^( 7) =       0.000478603991

      target function =                  N/A
              le_mean =     -16.904952170665
             les_mean =     286.123581313115
             stat err =       0.000467004866
             autocorr =       1.260024157104
              std dev =       0.588365187376
             le_variance =       0.346173593716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904952170665        initial  <--
     1.5625e+13     1.5625e+14             0.0000e+00       -16.904952170665
     6.2500e+13     6.2500e+14             0.0000e+00       -16.904952170665
     2.5000e+14     2.5000e+15             0.0000e+00       -16.904952170665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.6618
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1060e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9387
    reference variance = 0.273836
====================================================
  Execution time = 4.1779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3701e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0862e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337101722241
                                         uncertainty =       0.004368553038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337101722241
                                         uncertainty =       0.004368553038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410491956
  error estimate for blocks of size 2^( 2) =       0.000423214790
  error estimate for blocks of size 2^( 3) =       0.000436998502
  error estimate for blocks of size 2^( 4) =       0.000449604315
  error estimate for blocks of size 2^( 5) =       0.000460540568
  error estimate for blocks of size 2^( 6) =       0.000468084731
  error estimate for blocks of size 2^( 7) =       0.000473591093

      target function =                  N/A
              le_mean =     -16.906634604603
             les_mean =     286.171300777339
             stat err =       0.000462955177
             autocorr =       1.271945744542
              std dev =       0.580523291766
             le_variance =       0.337007292282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663460460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906634604603       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2648e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8376
    reference variance = 0.186712
====================================================
  Execution time = 3.9468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3536e-01
  Total weights = 2.0000e+06
  Execution time = 3.6845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409485102
  error estimate for blocks of size 2^( 2) =       0.000422314454
  error estimate for blocks of size 2^( 3) =       0.000435352344
  error estimate for blocks of size 2^( 4) =       0.000447912096
  error estimate for blocks of size 2^( 5) =       0.000457230253
  error estimate for blocks of size 2^( 6) =       0.000466119333
  error estimate for blocks of size 2^( 7) =       0.000471465560

      target function =                  N/A
              le_mean =     -16.905320666947
             les_mean =     286.125222781450
             stat err =       0.000460681810
             autocorr =       1.265685832998
              std dev =       0.579099384230
             le_variance =       0.335356096816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409485102
  error estimate for blocks of size 2^( 2) =       0.000422314454
  error estimate for blocks of size 2^( 3) =       0.000435352344
  error estimate for blocks of size 2^( 4) =       0.000447912096
  error estimate for blocks of size 2^( 5) =       0.000457230253
  error estimate for blocks of size 2^( 6) =       0.000466119333
  error estimate for blocks of size 2^( 7) =       0.000471465560

      target function =                  N/A
              le_mean =     -16.905320666947
             les_mean =     286.125222781450
             stat err =       0.000460681810
             autocorr =       1.265685832998
              std dev =       0.579099384230
             le_variance =       0.335356096816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409485102
  error estimate for blocks of size 2^( 2) =       0.000422314454
  error estimate for blocks of size 2^( 3) =       0.000435352344
  error estimate for blocks of size 2^( 4) =       0.000447912096
  error estimate for blocks of size 2^( 5) =       0.000457230253
  error estimate for blocks of size 2^( 6) =       0.000466119333
  error estimate for blocks of size 2^( 7) =       0.000471465560

      target function =                  N/A
              le_mean =     -16.905320666947
             les_mean =     286.125222781450
             stat err =       0.000460681810
             autocorr =       1.265685832998
              std dev =       0.579099384230
             le_variance =       0.335356096816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335273873852
                                         uncertainty =       0.003437086916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409485102
  error estimate for blocks of size 2^( 2) =       0.000422314454
  error estimate for blocks of size 2^( 3) =       0.000435352344
  error estimate for blocks of size 2^( 4) =       0.000447912096
  error estimate for blocks of size 2^( 5) =       0.000457230253
  error estimate for blocks of size 2^( 6) =       0.000466119333
  error estimate for blocks of size 2^( 7) =       0.000471465560

      target function =                  N/A
              le_mean =     -16.905320666947
             les_mean =     286.125222781450
             stat err =       0.000460681810
             autocorr =       1.265685832998
              std dev =       0.579099384230
             le_variance =       0.335356096816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905320666947        initial  <--
     1.5625e+14     1.5625e+15             0.0000e+00       -16.905320666947
     6.2500e+14     6.2500e+15             0.0000e+00       -16.905320666947
     2.5000e+15     2.5000e+16             0.0000e+00       -16.905320666947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9357
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1061e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8329
    reference variance = 0.178256
====================================================
  Execution time = 4.0205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4183e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0793e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341841486110
                                         uncertainty =       0.005977325776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341841486110
                                         uncertainty =       0.005977325776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413418151
  error estimate for blocks of size 2^( 2) =       0.000426241560
  error estimate for blocks of size 2^( 3) =       0.000439257499
  error estimate for blocks of size 2^( 4) =       0.000452387710
  error estimate for blocks of size 2^( 5) =       0.000462968245
  error estimate for blocks of size 2^( 6) =       0.000469259452
  error estimate for blocks of size 2^( 7) =       0.000472667182

      target function =                  N/A
              le_mean =     -16.906032031449
             les_mean =     286.155748013333
             stat err =       0.000464320647
             autocorr =       1.261411862887
              std dev =       0.584661556681
             le_variance =       0.341829135860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603203145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032031449       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032031449       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032031449       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032031449       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.831821183140       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.488923566719       residual = 4.41e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -15.875593685217       residual = 2.27e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.893508021094       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -24.506222232229       residual = 8.25e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -23.616363696426       residual = 5.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.110855160608       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =      -8.116733395779       residual = 1.13e+04           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+15 is 2.719049e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032031449       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032031449       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032031449       residual = 8.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032031449       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906032031449       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.796051690454       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+15 is 6.797621e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906032031449       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032031449       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032031449       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906032031449       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+16 is 1.699405e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1008e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 0.198083
====================================================
  Execution time = 3.9453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5812e-01
  Total weights = 2.0000e+06
  Execution time = 3.6616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423155537
  error estimate for blocks of size 2^( 2) =       0.000435701335
  error estimate for blocks of size 2^( 3) =       0.000448642289
  error estimate for blocks of size 2^( 4) =       0.000461479126
  error estimate for blocks of size 2^( 5) =       0.000471847905
  error estimate for blocks of size 2^( 6) =       0.000478301448
  error estimate for blocks of size 2^( 7) =       0.000484738656

      target function =                  N/A
              le_mean =     -16.905820300919
             les_mean =     286.164881084976
             stat err =       0.000474091784
             autocorr =       1.255234309670
              std dev =       0.598432299488
             le_variance =       0.358121217070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423155537
  error estimate for blocks of size 2^( 2) =       0.000435701335
  error estimate for blocks of size 2^( 3) =       0.000448642289
  error estimate for blocks of size 2^( 4) =       0.000461479126
  error estimate for blocks of size 2^( 5) =       0.000471847905
  error estimate for blocks of size 2^( 6) =       0.000478301448
  error estimate for blocks of size 2^( 7) =       0.000484738656

      target function =                  N/A
              le_mean =     -16.905820300919
             les_mean =     286.164881084976
             stat err =       0.000474091784
             autocorr =       1.255234309670
              std dev =       0.598432299488
             le_variance =       0.358121217070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423155537
  error estimate for blocks of size 2^( 2) =       0.000435701335
  error estimate for blocks of size 2^( 3) =       0.000448642289
  error estimate for blocks of size 2^( 4) =       0.000461479126
  error estimate for blocks of size 2^( 5) =       0.000471847905
  error estimate for blocks of size 2^( 6) =       0.000478301448
  error estimate for blocks of size 2^( 7) =       0.000484738656

      target function =                  N/A
              le_mean =     -16.905820300919
             les_mean =     286.164881084976
             stat err =       0.000474091784
             autocorr =       1.255234309670
              std dev =       0.598432299488
             le_variance =       0.358121217070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358236641474
                                         uncertainty =       0.023380546341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423155537
  error estimate for blocks of size 2^( 2) =       0.000435701335
  error estimate for blocks of size 2^( 3) =       0.000448642289
  error estimate for blocks of size 2^( 4) =       0.000461479126
  error estimate for blocks of size 2^( 5) =       0.000471847905
  error estimate for blocks of size 2^( 6) =       0.000478301448
  error estimate for blocks of size 2^( 7) =       0.000484738656

      target function =                  N/A
              le_mean =     -16.905820300919
             les_mean =     286.164881084976
             stat err =       0.000474091784
             autocorr =       1.255234309670
              std dev =       0.598432299488
             le_variance =       0.358121217070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905820300919        initial  <--
     1.5625e+15     1.5625e+16             2.7190e-20       -16.905820300919
     6.2500e+15     6.2500e+16             6.7976e-21       -16.905820300919
     2.5000e+16     2.5000e+17             1.6994e-21       -16.905820300919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.8706
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0889e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.304352
====================================================
  Execution time = 4.0631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4163e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0704e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341573417039
                                         uncertainty =       0.005191960521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341573417039
                                         uncertainty =       0.005191960521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413299983
  error estimate for blocks of size 2^( 2) =       0.000426065143
  error estimate for blocks of size 2^( 3) =       0.000439793334
  error estimate for blocks of size 2^( 4) =       0.000453289520
  error estimate for blocks of size 2^( 5) =       0.000466052542
  error estimate for blocks of size 2^( 6) =       0.000474009824
  error estimate for blocks of size 2^( 7) =       0.000480288709

      target function =                  N/A
              le_mean =     -16.906204451594
             les_mean =     286.161382539825
             stat err =       0.000468410149
             autocorr =       1.284463648045
              std dev =       0.584494440992
             le_variance =       0.341633751551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620445159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204451594       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1342e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8563
    reference variance = 0.288605
====================================================
  Execution time = 4.1028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4587e-01
  Total weights = 2.0000e+06
  Execution time = 3.6557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415854011
  error estimate for blocks of size 2^( 2) =       0.000428347004
  error estimate for blocks of size 2^( 3) =       0.000441468374
  error estimate for blocks of size 2^( 4) =       0.000453376803
  error estimate for blocks of size 2^( 5) =       0.000462991148
  error estimate for blocks of size 2^( 6) =       0.000469651330
  error estimate for blocks of size 2^( 7) =       0.000472261374

      target function =                  N/A
              le_mean =     -16.905567659111
             les_mean =     286.144086820196
             stat err =       0.000464570164
             autocorr =       1.248017974677
              std dev =       0.588106381821
             le_variance =       0.345869116339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415854011
  error estimate for blocks of size 2^( 2) =       0.000428347004
  error estimate for blocks of size 2^( 3) =       0.000441468374
  error estimate for blocks of size 2^( 4) =       0.000453376803
  error estimate for blocks of size 2^( 5) =       0.000462991148
  error estimate for blocks of size 2^( 6) =       0.000469651330
  error estimate for blocks of size 2^( 7) =       0.000472261374

      target function =                  N/A
              le_mean =     -16.905567659111
             les_mean =     286.144086820196
             stat err =       0.000464570164
             autocorr =       1.248017974677
              std dev =       0.588106381821
             le_variance =       0.345869116339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415854011
  error estimate for blocks of size 2^( 2) =       0.000428347004
  error estimate for blocks of size 2^( 3) =       0.000441468374
  error estimate for blocks of size 2^( 4) =       0.000453376803
  error estimate for blocks of size 2^( 5) =       0.000462991148
  error estimate for blocks of size 2^( 6) =       0.000469651330
  error estimate for blocks of size 2^( 7) =       0.000472261374

      target function =                  N/A
              le_mean =     -16.905567659111
             les_mean =     286.144086820196
             stat err =       0.000464570164
             autocorr =       1.248017974677
              std dev =       0.588106381821
             le_variance =       0.345869116339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345973838630
                                         uncertainty =       0.005557141045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415854011
  error estimate for blocks of size 2^( 2) =       0.000428347004
  error estimate for blocks of size 2^( 3) =       0.000441468374
  error estimate for blocks of size 2^( 4) =       0.000453376803
  error estimate for blocks of size 2^( 5) =       0.000462991148
  error estimate for blocks of size 2^( 6) =       0.000469651330
  error estimate for blocks of size 2^( 7) =       0.000472261374

      target function =                  N/A
              le_mean =     -16.905567659111
             les_mean =     286.144086820196
             stat err =       0.000464570164
             autocorr =       1.248017974677
              std dev =       0.588106381821
             le_variance =       0.345869116339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905567659111        initial  <--
     1.5625e+16     1.5625e+17             0.0000e+00       -16.905567659111
     6.2500e+16     6.2500e+17             0.0000e+00       -16.905567659111
     2.5000e+17     2.5000e+18             0.0000e+00       -16.905567659111

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.4165
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1077e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9179
    reference variance = 0.341837
====================================================
  Execution time = 4.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0636e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519962964
                                         uncertainty =       0.003376166935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519962964
                                         uncertainty =       0.003376166935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411394366
  error estimate for blocks of size 2^( 2) =       0.000424414094
  error estimate for blocks of size 2^( 3) =       0.000437419321
  error estimate for blocks of size 2^( 4) =       0.000449463710
  error estimate for blocks of size 2^( 5) =       0.000459707749
  error estimate for blocks of size 2^( 6) =       0.000466210856
  error estimate for blocks of size 2^( 7) =       0.000469815632

      target function =                  N/A
              le_mean =     -16.906172263521
             les_mean =     286.157151082789
             stat err =       0.000461299487
             autocorr =       1.257329959096
              std dev =       0.581799491400
             le_variance =       0.338490648193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617226352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172263521       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172263521       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172263521       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172263521       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172263521       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172263521       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906172263517       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+17 is 3.109775e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172263521       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172263521       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172263521       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172263521       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+18 is 7.774438e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1021e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.32076
====================================================
  Execution time = 3.8999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3065e-01
  Total weights = 2.0000e+06
  Execution time = 3.6669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406600087
  error estimate for blocks of size 2^( 2) =       0.000419325293
  error estimate for blocks of size 2^( 3) =       0.000432689275
  error estimate for blocks of size 2^( 4) =       0.000444849809
  error estimate for blocks of size 2^( 5) =       0.000455421949
  error estimate for blocks of size 2^( 6) =       0.000462432448
  error estimate for blocks of size 2^( 7) =       0.000467517709

      target function =                  N/A
              le_mean =     -16.905894008078
             les_mean =     286.139899308599
             stat err =       0.000457555479
             autocorr =       1.266346589394
              std dev =       0.575019357554
             le_variance =       0.330647261562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406600087
  error estimate for blocks of size 2^( 2) =       0.000419325293
  error estimate for blocks of size 2^( 3) =       0.000432689275
  error estimate for blocks of size 2^( 4) =       0.000444849809
  error estimate for blocks of size 2^( 5) =       0.000455421949
  error estimate for blocks of size 2^( 6) =       0.000462432448
  error estimate for blocks of size 2^( 7) =       0.000467517709

      target function =                  N/A
              le_mean =     -16.905894008078
             les_mean =     286.139899308599
             stat err =       0.000457555479
             autocorr =       1.266346589394
              std dev =       0.575019357554
             le_variance =       0.330647261562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406600087
  error estimate for blocks of size 2^( 2) =       0.000419325293
  error estimate for blocks of size 2^( 3) =       0.000432689275
  error estimate for blocks of size 2^( 4) =       0.000444849809
  error estimate for blocks of size 2^( 5) =       0.000455421949
  error estimate for blocks of size 2^( 6) =       0.000462432448
  error estimate for blocks of size 2^( 7) =       0.000467517709

      target function =                  N/A
              le_mean =     -16.905894008078
             les_mean =     286.139899308599
             stat err =       0.000457555479
             autocorr =       1.266346589394
              std dev =       0.575019357554
             le_variance =       0.330647261562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330683156348
                                         uncertainty =       0.003637256472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406600087
  error estimate for blocks of size 2^( 2) =       0.000419325293
  error estimate for blocks of size 2^( 3) =       0.000432689275
  error estimate for blocks of size 2^( 4) =       0.000444849809
  error estimate for blocks of size 2^( 5) =       0.000455421949
  error estimate for blocks of size 2^( 6) =       0.000462432448
  error estimate for blocks of size 2^( 7) =       0.000467517709

      target function =                  N/A
              le_mean =     -16.905894008078
             les_mean =     286.139899308599
             stat err =       0.000457555479
             autocorr =       1.266346589394
              std dev =       0.575019357554
             le_variance =       0.330647261562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905894008078        initial  <--
     1.5625e+17     1.5625e+18             0.0000e+00       -16.905894008078
     6.2500e+17     6.2500e+18             3.1098e-22       -16.905894008078
     2.5000e+18     2.5000e+19             7.7744e-23       -16.905894008078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.3871
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0856e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9651
    reference variance = 0.706886
====================================================
  Execution time = 4.0414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0740e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945178524
                                         uncertainty =       0.003800171791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945178524
                                         uncertainty =       0.003800171791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409222873
  error estimate for blocks of size 2^( 2) =       0.000422562401
  error estimate for blocks of size 2^( 3) =       0.000436271597
  error estimate for blocks of size 2^( 4) =       0.000449066108
  error estimate for blocks of size 2^( 5) =       0.000460004601
  error estimate for blocks of size 2^( 6) =       0.000468123713
  error estimate for blocks of size 2^( 7) =       0.000471083743

      target function =                  N/A
              le_mean =     -16.905332870841
             les_mean =     286.125206025675
             stat err =       0.000462069541
             autocorr =       1.274955079338
              std dev =       0.578728536718
             le_variance =       0.334926719212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533287084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905332870841       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905332870841       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905332870841       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+18 is 3.142063e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905332870841       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905332870841       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905332870841       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905332870841       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+18 is 2.044080e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905332870841       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905332870841       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905332870841       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905332870841       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+19 is 3.398931e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1162e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9249
    reference variance = 0.387841
====================================================
  Execution time = 3.9028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3618e-01
  Total weights = 2.0000e+06
  Execution time = 3.6729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989899
  error estimate for blocks of size 2^( 2) =       0.000423219583
  error estimate for blocks of size 2^( 3) =       0.000435833840
  error estimate for blocks of size 2^( 4) =       0.000446982603
  error estimate for blocks of size 2^( 5) =       0.000457975070
  error estimate for blocks of size 2^( 6) =       0.000466878179
  error estimate for blocks of size 2^( 7) =       0.000473532616

      target function =                  N/A
              le_mean =     -16.905910090137
             les_mean =     286.145979241567
             stat err =       0.000461342117
             autocorr =       1.266192960090
              std dev =       0.579813274995
             le_variance =       0.336183433860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989899
  error estimate for blocks of size 2^( 2) =       0.000423219583
  error estimate for blocks of size 2^( 3) =       0.000435833840
  error estimate for blocks of size 2^( 4) =       0.000446982603
  error estimate for blocks of size 2^( 5) =       0.000457975070
  error estimate for blocks of size 2^( 6) =       0.000466878179
  error estimate for blocks of size 2^( 7) =       0.000473532616

      target function =                  N/A
              le_mean =     -16.905910090137
             les_mean =     286.145979241567
             stat err =       0.000461342117
             autocorr =       1.266192960090
              std dev =       0.579813274995
             le_variance =       0.336183433860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989899
  error estimate for blocks of size 2^( 2) =       0.000423219583
  error estimate for blocks of size 2^( 3) =       0.000435833840
  error estimate for blocks of size 2^( 4) =       0.000446982603
  error estimate for blocks of size 2^( 5) =       0.000457975070
  error estimate for blocks of size 2^( 6) =       0.000466878179
  error estimate for blocks of size 2^( 7) =       0.000473532616

      target function =                  N/A
              le_mean =     -16.905910090137
             les_mean =     286.145979241567
             stat err =       0.000461342117
             autocorr =       1.266192960090
              std dev =       0.579813274995
             le_variance =       0.336183433860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336170701273
                                         uncertainty =       0.003266332811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409989899
  error estimate for blocks of size 2^( 2) =       0.000423219583
  error estimate for blocks of size 2^( 3) =       0.000435833840
  error estimate for blocks of size 2^( 4) =       0.000446982603
  error estimate for blocks of size 2^( 5) =       0.000457975070
  error estimate for blocks of size 2^( 6) =       0.000466878179
  error estimate for blocks of size 2^( 7) =       0.000473532616

      target function =                  N/A
              le_mean =     -16.905910090137
             les_mean =     286.145979241567
             stat err =       0.000461342117
             autocorr =       1.266192960090
              std dev =       0.579813274995
             le_variance =       0.336183433860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905910090137        initial  <--
     1.5625e+18     1.5625e+19             3.1421e-23       -16.905910090137
     6.2500e+18     6.2500e+19             2.0441e-23       -16.905910090137
     2.5000e+19     2.5000e+20             3.3989e-24       -16.905910090137

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4055
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0857e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9476
    reference variance = 0.224995
====================================================
  Execution time = 4.1563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4063e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0761e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340693217041
                                         uncertainty =       0.006737155086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340693217041
                                         uncertainty =       0.006737155086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691237
  error estimate for blocks of size 2^( 2) =       0.000425428539
  error estimate for blocks of size 2^( 3) =       0.000439058090
  error estimate for blocks of size 2^( 4) =       0.000451499496
  error estimate for blocks of size 2^( 5) =       0.000462374480
  error estimate for blocks of size 2^( 6) =       0.000471264362
  error estimate for blocks of size 2^( 7) =       0.000476835199

      target function =                  N/A
              le_mean =     -16.904804170291
             les_mean =     286.113031979604
             stat err =       0.000465493384
             autocorr =       1.272261928975
              std dev =       0.583633544307
             le_variance =       0.340628114040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690480417029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+19 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904804170291       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+20 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2331e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9453
    reference variance = 0.327711
====================================================
  Execution time = 4.1248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4978e-01
  Total weights = 2.0000e+06
  Execution time = 3.6706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418197218
  error estimate for blocks of size 2^( 2) =       0.000431062485
  error estimate for blocks of size 2^( 3) =       0.000443524096
  error estimate for blocks of size 2^( 4) =       0.000455816698
  error estimate for blocks of size 2^( 5) =       0.000466803460
  error estimate for blocks of size 2^( 6) =       0.000476342284
  error estimate for blocks of size 2^( 7) =       0.000481249145

      target function =                  N/A
              le_mean =     -16.906155678074
             les_mean =     286.167877463272
             stat err =       0.000470052897
             autocorr =       1.263371824876
              std dev =       0.591420177953
             le_variance =       0.349777826890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418197218
  error estimate for blocks of size 2^( 2) =       0.000431062485
  error estimate for blocks of size 2^( 3) =       0.000443524096
  error estimate for blocks of size 2^( 4) =       0.000455816698
  error estimate for blocks of size 2^( 5) =       0.000466803460
  error estimate for blocks of size 2^( 6) =       0.000476342284
  error estimate for blocks of size 2^( 7) =       0.000481249145

      target function =                  N/A
              le_mean =     -16.906155678074
             les_mean =     286.167877463272
             stat err =       0.000470052897
             autocorr =       1.263371824876
              std dev =       0.591420177953
             le_variance =       0.349777826890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418197218
  error estimate for blocks of size 2^( 2) =       0.000431062485
  error estimate for blocks of size 2^( 3) =       0.000443524096
  error estimate for blocks of size 2^( 4) =       0.000455816698
  error estimate for blocks of size 2^( 5) =       0.000466803460
  error estimate for blocks of size 2^( 6) =       0.000476342284
  error estimate for blocks of size 2^( 7) =       0.000481249145

      target function =                  N/A
              le_mean =     -16.906155678074
             les_mean =     286.167877463272
             stat err =       0.000470052897
             autocorr =       1.263371824876
              std dev =       0.591420177953
             le_variance =       0.349777826890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349809857299
                                         uncertainty =       0.010449069209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418197218
  error estimate for blocks of size 2^( 2) =       0.000431062485
  error estimate for blocks of size 2^( 3) =       0.000443524096
  error estimate for blocks of size 2^( 4) =       0.000455816698
  error estimate for blocks of size 2^( 5) =       0.000466803460
  error estimate for blocks of size 2^( 6) =       0.000476342284
  error estimate for blocks of size 2^( 7) =       0.000481249145

      target function =                  N/A
              le_mean =     -16.906155678074
             les_mean =     286.167877463272
             stat err =       0.000470052897
             autocorr =       1.263371824876
              std dev =       0.591420177953
             le_variance =       0.349777826890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906155678074        initial  <--
     1.5625e+19     1.5625e+20             0.0000e+00       -16.906155678074
     6.2500e+19     6.2500e+20             0.0000e+00       -16.906155678074
     2.5000e+20     2.5000e+21             0.0000e+00       -16.906155678074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.7546
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.73831
====================================================
  Execution time = 4.0708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4042e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0781e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340342715215
                                         uncertainty =       0.003898194360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340342715215
                                         uncertainty =       0.003898194360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412566487
  error estimate for blocks of size 2^( 2) =       0.000425305480
  error estimate for blocks of size 2^( 3) =       0.000438073024
  error estimate for blocks of size 2^( 4) =       0.000451090188
  error estimate for blocks of size 2^( 5) =       0.000462494661
  error estimate for blocks of size 2^( 6) =       0.000470908752
  error estimate for blocks of size 2^( 7) =       0.000478415735

      target function =                  N/A
              le_mean =     -16.905498836510
             les_mean =     286.136312954010
             stat err =       0.000465727334
             autocorr =       1.274311377806
              std dev =       0.583457121801
             le_variance =       0.340422212980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549883651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905498836510       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1496e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.36544
====================================================
  Execution time = 3.9169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4036e-01
  Total weights = 2.0000e+06
  Execution time = 3.6688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412529140
  error estimate for blocks of size 2^( 2) =       0.000425486503
  error estimate for blocks of size 2^( 3) =       0.000438488562
  error estimate for blocks of size 2^( 4) =       0.000450804061
  error estimate for blocks of size 2^( 5) =       0.000461521984
  error estimate for blocks of size 2^( 6) =       0.000468767250
  error estimate for blocks of size 2^( 7) =       0.000475629550

      target function =                  N/A
              le_mean =     -16.905902943763
             les_mean =     286.149914755806
             stat err =       0.000464180711
             autocorr =       1.266090987596
              std dev =       0.583404304106
             le_variance =       0.340360582050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412529140
  error estimate for blocks of size 2^( 2) =       0.000425486503
  error estimate for blocks of size 2^( 3) =       0.000438488562
  error estimate for blocks of size 2^( 4) =       0.000450804061
  error estimate for blocks of size 2^( 5) =       0.000461521984
  error estimate for blocks of size 2^( 6) =       0.000468767250
  error estimate for blocks of size 2^( 7) =       0.000475629550

      target function =                  N/A
              le_mean =     -16.905902943763
             les_mean =     286.149914755806
             stat err =       0.000464180711
             autocorr =       1.266090987596
              std dev =       0.583404304106
             le_variance =       0.340360582050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412529140
  error estimate for blocks of size 2^( 2) =       0.000425486503
  error estimate for blocks of size 2^( 3) =       0.000438488562
  error estimate for blocks of size 2^( 4) =       0.000450804061
  error estimate for blocks of size 2^( 5) =       0.000461521984
  error estimate for blocks of size 2^( 6) =       0.000468767250
  error estimate for blocks of size 2^( 7) =       0.000475629550

      target function =                  N/A
              le_mean =     -16.905902943763
             les_mean =     286.149914755806
             stat err =       0.000464180711
             autocorr =       1.266090987596
              std dev =       0.583404304106
             le_variance =       0.340360582050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340372765386
                                         uncertainty =       0.003586679802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412529140
  error estimate for blocks of size 2^( 2) =       0.000425486503
  error estimate for blocks of size 2^( 3) =       0.000438488562
  error estimate for blocks of size 2^( 4) =       0.000450804061
  error estimate for blocks of size 2^( 5) =       0.000461521984
  error estimate for blocks of size 2^( 6) =       0.000468767250
  error estimate for blocks of size 2^( 7) =       0.000475629550

      target function =                  N/A
              le_mean =     -16.905902943763
             les_mean =     286.149914755806
             stat err =       0.000464180711
             autocorr =       1.266090987596
              std dev =       0.583404304106
             le_variance =       0.340360582050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905902943763        initial  <--
     1.5625e+20     1.5625e+21             0.0000e+00       -16.905902943763
     6.2500e+20     6.2500e+21             0.0000e+00       -16.905902943763
     2.5000e+21     2.5000e+22             0.0000e+00       -16.905902943763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5691
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0915e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.390059
====================================================
  Execution time = 3.9908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0826e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339023605541
                                         uncertainty =       0.004098007826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339023605541
                                         uncertainty =       0.004098007826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411704924
  error estimate for blocks of size 2^( 2) =       0.000423681390
  error estimate for blocks of size 2^( 3) =       0.000436443866
  error estimate for blocks of size 2^( 4) =       0.000449745389
  error estimate for blocks of size 2^( 5) =       0.000459331015
  error estimate for blocks of size 2^( 6) =       0.000468113383
  error estimate for blocks of size 2^( 7) =       0.000472223187

      target function =                  N/A
              le_mean =     -16.905406899574
             les_mean =     286.131784159218
             stat err =       0.000462353244
             autocorr =       1.261175993449
              std dev =       0.582238686918
             le_variance =       0.339001888544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540689957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+21 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406899574       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+21 is 8.714080e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406899574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+22 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0742e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9785
    reference variance = 0.190982
====================================================
  Execution time = 3.9628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3163e-01
  Total weights = 2.0000e+06
  Execution time = 3.6630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407205268
  error estimate for blocks of size 2^( 2) =       0.000420555430
  error estimate for blocks of size 2^( 3) =       0.000433990498
  error estimate for blocks of size 2^( 4) =       0.000446893775
  error estimate for blocks of size 2^( 5) =       0.000457220140
  error estimate for blocks of size 2^( 6) =       0.000465675628
  error estimate for blocks of size 2^( 7) =       0.000470068826

      target function =                  N/A
              le_mean =     -16.905783682183
             les_mean =     286.137154003342
             stat err =       0.000459964592
             autocorr =       1.275915833702
              std dev =       0.575875212526
             le_variance =       0.331632260401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407205268
  error estimate for blocks of size 2^( 2) =       0.000420555430
  error estimate for blocks of size 2^( 3) =       0.000433990498
  error estimate for blocks of size 2^( 4) =       0.000446893775
  error estimate for blocks of size 2^( 5) =       0.000457220140
  error estimate for blocks of size 2^( 6) =       0.000465675628
  error estimate for blocks of size 2^( 7) =       0.000470068826

      target function =                  N/A
              le_mean =     -16.905783682183
             les_mean =     286.137154003342
             stat err =       0.000459964592
             autocorr =       1.275915833702
              std dev =       0.575875212526
             le_variance =       0.331632260401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407205268
  error estimate for blocks of size 2^( 2) =       0.000420555430
  error estimate for blocks of size 2^( 3) =       0.000433990498
  error estimate for blocks of size 2^( 4) =       0.000446893775
  error estimate for blocks of size 2^( 5) =       0.000457220140
  error estimate for blocks of size 2^( 6) =       0.000465675628
  error estimate for blocks of size 2^( 7) =       0.000470068826

      target function =                  N/A
              le_mean =     -16.905783682183
             les_mean =     286.137154003342
             stat err =       0.000459964592
             autocorr =       1.275915833702
              std dev =       0.575875212526
             le_variance =       0.331632260401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331611121133
                                         uncertainty =       0.003654265173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407205268
  error estimate for blocks of size 2^( 2) =       0.000420555430
  error estimate for blocks of size 2^( 3) =       0.000433990498
  error estimate for blocks of size 2^( 4) =       0.000446893775
  error estimate for blocks of size 2^( 5) =       0.000457220140
  error estimate for blocks of size 2^( 6) =       0.000465675628
  error estimate for blocks of size 2^( 7) =       0.000470068826

      target function =                  N/A
              le_mean =     -16.905783682183
             les_mean =     286.137154003342
             stat err =       0.000459964592
             autocorr =       1.275915833702
              std dev =       0.575875212526
             le_variance =       0.331632260401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905783682183        initial  <--
     1.5625e+21     1.5625e+22             0.0000e+00       -16.905783682183
     6.2500e+21     6.2500e+22             8.7141e-27       -16.905783682183
     2.5000e+22     2.5000e+23             0.0000e+00       -16.905783682183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.4651
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1022e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.235508
====================================================
  Execution time = 4.3464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0785e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353911266121
                                         uncertainty =       0.011923484303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353911266121
                                         uncertainty =       0.011923484303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420632877
  error estimate for blocks of size 2^( 2) =       0.000433373232
  error estimate for blocks of size 2^( 3) =       0.000445793399
  error estimate for blocks of size 2^( 4) =       0.000458262344
  error estimate for blocks of size 2^( 5) =       0.000468319444
  error estimate for blocks of size 2^( 6) =       0.000476446933
  error estimate for blocks of size 2^( 7) =       0.000482432955

      target function =                  N/A
              le_mean =     -16.905961783998
             les_mean =     286.165407699293
             stat err =       0.000471365419
             autocorr =       1.255766829866
              std dev =       0.594864719273
             le_variance =       0.353864034236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596178400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+22 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961783998       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297406 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4255e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.96
    reference variance = 0.279103
====================================================
  Execution time = 3.8837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.0000e+06
  Execution time = 3.6786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408618382
  error estimate for blocks of size 2^( 2) =       0.000422154454
  error estimate for blocks of size 2^( 3) =       0.000435143096
  error estimate for blocks of size 2^( 4) =       0.000448512137
  error estimate for blocks of size 2^( 5) =       0.000459185313
  error estimate for blocks of size 2^( 6) =       0.000466737870
  error estimate for blocks of size 2^( 7) =       0.000471425052

      target function =                  N/A
              le_mean =     -16.904876887956
             les_mean =     286.108800394883
             stat err =       0.000461465093
             autocorr =       1.275386774225
              std dev =       0.577873658247
             le_variance =       0.333937964896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408618382
  error estimate for blocks of size 2^( 2) =       0.000422154454
  error estimate for blocks of size 2^( 3) =       0.000435143096
  error estimate for blocks of size 2^( 4) =       0.000448512137
  error estimate for blocks of size 2^( 5) =       0.000459185313
  error estimate for blocks of size 2^( 6) =       0.000466737870
  error estimate for blocks of size 2^( 7) =       0.000471425052

      target function =                  N/A
              le_mean =     -16.904876887956
             les_mean =     286.108800394883
             stat err =       0.000461465093
             autocorr =       1.275386774225
              std dev =       0.577873658247
             le_variance =       0.333937964896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408618382
  error estimate for blocks of size 2^( 2) =       0.000422154454
  error estimate for blocks of size 2^( 3) =       0.000435143096
  error estimate for blocks of size 2^( 4) =       0.000448512137
  error estimate for blocks of size 2^( 5) =       0.000459185313
  error estimate for blocks of size 2^( 6) =       0.000466737870
  error estimate for blocks of size 2^( 7) =       0.000471425052

      target function =                  N/A
              le_mean =     -16.904876887956
             les_mean =     286.108800394883
             stat err =       0.000461465093
             autocorr =       1.275386774225
              std dev =       0.577873658247
             le_variance =       0.333937964896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333957694847
                                         uncertainty =       0.003243630962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408618382
  error estimate for blocks of size 2^( 2) =       0.000422154454
  error estimate for blocks of size 2^( 3) =       0.000435143096
  error estimate for blocks of size 2^( 4) =       0.000448512137
  error estimate for blocks of size 2^( 5) =       0.000459185313
  error estimate for blocks of size 2^( 6) =       0.000466737870
  error estimate for blocks of size 2^( 7) =       0.000471425052

      target function =                  N/A
              le_mean =     -16.904876887956
             les_mean =     286.108800394883
             stat err =       0.000461465093
             autocorr =       1.275386774225
              std dev =       0.577873658247
             le_variance =       0.333937964896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904876887956        initial  <--
     1.5625e+22     1.5625e+23             0.0000e+00       -16.904876887956
     6.2500e+22     6.2500e+23             0.0000e+00       -16.904876887956
     2.5000e+23     2.5000e+24             0.0000e+00       -16.904876887956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.3652
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1163e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.912
    reference variance = 0.198539
====================================================
  Execution time = 3.9889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0889e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337774824922
                                         uncertainty =       0.003987193838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337774824922
                                         uncertainty =       0.003987193838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982400
  error estimate for blocks of size 2^( 2) =       0.000424036234
  error estimate for blocks of size 2^( 3) =       0.000437674588
  error estimate for blocks of size 2^( 4) =       0.000450138145
  error estimate for blocks of size 2^( 5) =       0.000461501742
  error estimate for blocks of size 2^( 6) =       0.000469630650
  error estimate for blocks of size 2^( 7) =       0.000476406326

      target function =                  N/A
              le_mean =     -16.906024506268
             les_mean =     286.151477503899
             stat err =       0.000464419216
             autocorr =       1.276950061735
              std dev =       0.581216884011
             le_variance =       0.337813066259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602450627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024506268       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0786e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9033
    reference variance = 0.256953
====================================================
  Execution time = 3.8800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4699e-01
  Total weights = 2.0000e+06
  Execution time = 3.6922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527462
  error estimate for blocks of size 2^( 2) =       0.000428999100
  error estimate for blocks of size 2^( 3) =       0.000442231257
  error estimate for blocks of size 2^( 4) =       0.000454035432
  error estimate for blocks of size 2^( 5) =       0.000464868048
  error estimate for blocks of size 2^( 6) =       0.000473985438
  error estimate for blocks of size 2^( 7) =       0.000480183594

      target function =                  N/A
              le_mean =     -16.905359859452
             les_mean =     286.138182057742
             stat err =       0.000468268128
             autocorr =       1.263868580586
              std dev =       0.589058786259
             le_variance =       0.346990253669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527462
  error estimate for blocks of size 2^( 2) =       0.000428999100
  error estimate for blocks of size 2^( 3) =       0.000442231257
  error estimate for blocks of size 2^( 4) =       0.000454035432
  error estimate for blocks of size 2^( 5) =       0.000464868048
  error estimate for blocks of size 2^( 6) =       0.000473985438
  error estimate for blocks of size 2^( 7) =       0.000480183594

      target function =                  N/A
              le_mean =     -16.905359859452
             les_mean =     286.138182057742
             stat err =       0.000468268128
             autocorr =       1.263868580586
              std dev =       0.589058786259
             le_variance =       0.346990253669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527462
  error estimate for blocks of size 2^( 2) =       0.000428999100
  error estimate for blocks of size 2^( 3) =       0.000442231257
  error estimate for blocks of size 2^( 4) =       0.000454035432
  error estimate for blocks of size 2^( 5) =       0.000464868048
  error estimate for blocks of size 2^( 6) =       0.000473985438
  error estimate for blocks of size 2^( 7) =       0.000480183594

      target function =                  N/A
              le_mean =     -16.905359859452
             les_mean =     286.138182057742
             stat err =       0.000468268128
             autocorr =       1.263868580586
              std dev =       0.589058786259
             le_variance =       0.346990253669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347055563457
                                         uncertainty =       0.007662377180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527462
  error estimate for blocks of size 2^( 2) =       0.000428999100
  error estimate for blocks of size 2^( 3) =       0.000442231257
  error estimate for blocks of size 2^( 4) =       0.000454035432
  error estimate for blocks of size 2^( 5) =       0.000464868048
  error estimate for blocks of size 2^( 6) =       0.000473985438
  error estimate for blocks of size 2^( 7) =       0.000480183594

      target function =                  N/A
              le_mean =     -16.905359859452
             les_mean =     286.138182057742
             stat err =       0.000468268128
             autocorr =       1.263868580586
              std dev =       0.589058786259
             le_variance =       0.346990253669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905359859452        initial  <--
     1.5625e+23     1.5625e+24             0.0000e+00       -16.905359859452
     6.2500e+23     6.2500e+24             0.0000e+00       -16.905359859452
     2.5000e+24     2.5000e+25             0.0000e+00       -16.905359859452

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.3840
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0818e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.26011
====================================================
  Execution time = 3.9686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0591e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332894159228
                                         uncertainty =       0.002644588787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332894159228
                                         uncertainty =       0.002644588787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407948475
  error estimate for blocks of size 2^( 2) =       0.000420858213
  error estimate for blocks of size 2^( 3) =       0.000434506076
  error estimate for blocks of size 2^( 4) =       0.000447205294
  error estimate for blocks of size 2^( 5) =       0.000459005075
  error estimate for blocks of size 2^( 6) =       0.000468110145
  error estimate for blocks of size 2^( 7) =       0.000472816938

      target function =                  N/A
              le_mean =     -16.905746694485
             les_mean =     286.137115047808
             stat err =       0.000461784363
             autocorr =       1.281350132717
              std dev =       0.576926265783
             le_variance =       0.332843916151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574669448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746694485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746694485       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746694485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+24 is 3.402147e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746694485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746694485       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746562993       residual = 6.62e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905746609619       residual = 4.61e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+24 is 8.505369e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746694485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746694485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0284e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.164832
====================================================
  Execution time = 4.1409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3685e-01
  Total weights = 2.0000e+06
  Execution time = 3.6985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398773
  error estimate for blocks of size 2^( 2) =       0.000423429457
  error estimate for blocks of size 2^( 3) =       0.000436606145
  error estimate for blocks of size 2^( 4) =       0.000448927661
  error estimate for blocks of size 2^( 5) =       0.000461154714
  error estimate for blocks of size 2^( 6) =       0.000471019152
  error estimate for blocks of size 2^( 7) =       0.000478725299

      target function =                  N/A
              le_mean =     -16.905741288039
             les_mean =     286.140942635530
             stat err =       0.000464956707
             autocorr =       1.283550396838
              std dev =       0.580391510837
             le_variance =       0.336854305852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398773
  error estimate for blocks of size 2^( 2) =       0.000423429457
  error estimate for blocks of size 2^( 3) =       0.000436606145
  error estimate for blocks of size 2^( 4) =       0.000448927661
  error estimate for blocks of size 2^( 5) =       0.000461154714
  error estimate for blocks of size 2^( 6) =       0.000471019152
  error estimate for blocks of size 2^( 7) =       0.000478725299

      target function =                  N/A
              le_mean =     -16.905741288039
             les_mean =     286.140942635530
             stat err =       0.000464956707
             autocorr =       1.283550396838
              std dev =       0.580391510837
             le_variance =       0.336854305852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398773
  error estimate for blocks of size 2^( 2) =       0.000423429457
  error estimate for blocks of size 2^( 3) =       0.000436606145
  error estimate for blocks of size 2^( 4) =       0.000448927661
  error estimate for blocks of size 2^( 5) =       0.000461154714
  error estimate for blocks of size 2^( 6) =       0.000471019152
  error estimate for blocks of size 2^( 7) =       0.000478725299

      target function =                  N/A
              le_mean =     -16.905741288039
             les_mean =     286.140942635530
             stat err =       0.000464956707
             autocorr =       1.283550396838
              std dev =       0.580391510837
             le_variance =       0.336854305852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934060910
                                         uncertainty =       0.003441385223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398773
  error estimate for blocks of size 2^( 2) =       0.000423429457
  error estimate for blocks of size 2^( 3) =       0.000436606145
  error estimate for blocks of size 2^( 4) =       0.000448927661
  error estimate for blocks of size 2^( 5) =       0.000461154714
  error estimate for blocks of size 2^( 6) =       0.000471019152
  error estimate for blocks of size 2^( 7) =       0.000478725299

      target function =                  N/A
              le_mean =     -16.905741288039
             les_mean =     286.140942635530
             stat err =       0.000464956707
             autocorr =       1.283550396838
              std dev =       0.580391510837
             le_variance =       0.336854305852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741288039        initial  <--
     1.5625e+24     1.5625e+25             3.4021e-29       -16.905741288039
     6.2500e+24     6.2500e+25             8.5054e-30       -16.905741288039
     2.5000e+25     2.5000e+26             0.0000e+00       -16.905741288039

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5996
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8987
    reference variance = 0.352352
====================================================
  Execution time = 3.9356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4252e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0526e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342569854526
                                         uncertainty =       0.004551726715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342569854526
                                         uncertainty =       0.004551726715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413836882
  error estimate for blocks of size 2^( 2) =       0.000426929390
  error estimate for blocks of size 2^( 3) =       0.000440192299
  error estimate for blocks of size 2^( 4) =       0.000452731611
  error estimate for blocks of size 2^( 5) =       0.000462533738
  error estimate for blocks of size 2^( 6) =       0.000470978997
  error estimate for blocks of size 2^( 7) =       0.000475739927

      target function =                  N/A
              le_mean =     -16.905932057206
             les_mean =     286.153060482095
             stat err =       0.000465496068
             autocorr =       1.265242136151
              std dev =       0.585253731718
             le_variance =       0.342521930490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593205721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932057206       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9889e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0317
    reference variance = 0.551365
====================================================
  Execution time = 3.8877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4130e-01
  Total weights = 2.0000e+06
  Execution time = 3.6905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413097342
  error estimate for blocks of size 2^( 2) =       0.000425923367
  error estimate for blocks of size 2^( 3) =       0.000439471232
  error estimate for blocks of size 2^( 4) =       0.000452663669
  error estimate for blocks of size 2^( 5) =       0.000463010779
  error estimate for blocks of size 2^( 6) =       0.000471785510
  error estimate for blocks of size 2^( 7) =       0.000477538935

      target function =                  N/A
              le_mean =     -16.905275478454
             les_mean =     286.129637660269
             stat err =       0.000466249723
             autocorr =       1.273891301129
              std dev =       0.584207864125
             le_variance =       0.341298828505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413097342
  error estimate for blocks of size 2^( 2) =       0.000425923367
  error estimate for blocks of size 2^( 3) =       0.000439471232
  error estimate for blocks of size 2^( 4) =       0.000452663669
  error estimate for blocks of size 2^( 5) =       0.000463010779
  error estimate for blocks of size 2^( 6) =       0.000471785510
  error estimate for blocks of size 2^( 7) =       0.000477538935

      target function =                  N/A
              le_mean =     -16.905275478454
             les_mean =     286.129637660269
             stat err =       0.000466249723
             autocorr =       1.273891301129
              std dev =       0.584207864125
             le_variance =       0.341298828505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413097342
  error estimate for blocks of size 2^( 2) =       0.000425923367
  error estimate for blocks of size 2^( 3) =       0.000439471232
  error estimate for blocks of size 2^( 4) =       0.000452663669
  error estimate for blocks of size 2^( 5) =       0.000463010779
  error estimate for blocks of size 2^( 6) =       0.000471785510
  error estimate for blocks of size 2^( 7) =       0.000477538935

      target function =                  N/A
              le_mean =     -16.905275478454
             les_mean =     286.129637660269
             stat err =       0.000466249723
             autocorr =       1.273891301129
              std dev =       0.584207864125
             le_variance =       0.341298828505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341336115242
                                         uncertainty =       0.004109434865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413097342
  error estimate for blocks of size 2^( 2) =       0.000425923367
  error estimate for blocks of size 2^( 3) =       0.000439471232
  error estimate for blocks of size 2^( 4) =       0.000452663669
  error estimate for blocks of size 2^( 5) =       0.000463010779
  error estimate for blocks of size 2^( 6) =       0.000471785510
  error estimate for blocks of size 2^( 7) =       0.000477538935

      target function =                  N/A
              le_mean =     -16.905275478454
             les_mean =     286.129637660269
             stat err =       0.000466249723
             autocorr =       1.273891301129
              std dev =       0.584207864125
             le_variance =       0.341298828505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905275478454        initial  <--
     1.5625e+25     1.5625e+26             0.0000e+00       -16.905275478454
     6.2500e+25     6.2500e+26             0.0000e+00       -16.905275478454
     2.5000e+26     2.5000e+27             0.0000e+00       -16.905275478454

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4839
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0738e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8756
    reference variance = 0.435019
====================================================
  Execution time = 3.9201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3692e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0636e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337003886789
                                         uncertainty =       0.005200253780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337003886789
                                         uncertainty =       0.005200253780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437689
  error estimate for blocks of size 2^( 2) =       0.000423160689
  error estimate for blocks of size 2^( 3) =       0.000436494925
  error estimate for blocks of size 2^( 4) =       0.000448273802
  error estimate for blocks of size 2^( 5) =       0.000457982377
  error estimate for blocks of size 2^( 6) =       0.000466240115
  error estimate for blocks of size 2^( 7) =       0.000468672355

      target function =                  N/A
              le_mean =     -16.905555488887
             les_mean =     286.134724412735
             stat err =       0.000460292162
             autocorr =       1.257687347356
              std dev =       0.580446546504
             le_variance =       0.336918193349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555548889e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905555488887       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9844e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.321423
====================================================
  Execution time = 3.9335e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4049e-01
  Total weights = 2.0000e+06
  Execution time = 3.6968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412609344
  error estimate for blocks of size 2^( 2) =       0.000425149370
  error estimate for blocks of size 2^( 3) =       0.000437915790
  error estimate for blocks of size 2^( 4) =       0.000450479756
  error estimate for blocks of size 2^( 5) =       0.000461236590
  error estimate for blocks of size 2^( 6) =       0.000471697202
  error estimate for blocks of size 2^( 7) =       0.000479190054

      target function =                  N/A
              le_mean =     -16.905659004844
             les_mean =     286.141799160121
             stat err =       0.000465650900
             autocorr =       1.273628518957
              std dev =       0.583517730935
             le_variance =       0.340492942316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412609344
  error estimate for blocks of size 2^( 2) =       0.000425149370
  error estimate for blocks of size 2^( 3) =       0.000437915790
  error estimate for blocks of size 2^( 4) =       0.000450479756
  error estimate for blocks of size 2^( 5) =       0.000461236590
  error estimate for blocks of size 2^( 6) =       0.000471697202
  error estimate for blocks of size 2^( 7) =       0.000479190054

      target function =                  N/A
              le_mean =     -16.905659004844
             les_mean =     286.141799160121
             stat err =       0.000465650900
             autocorr =       1.273628518957
              std dev =       0.583517730935
             le_variance =       0.340492942316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412609344
  error estimate for blocks of size 2^( 2) =       0.000425149370
  error estimate for blocks of size 2^( 3) =       0.000437915790
  error estimate for blocks of size 2^( 4) =       0.000450479756
  error estimate for blocks of size 2^( 5) =       0.000461236590
  error estimate for blocks of size 2^( 6) =       0.000471697202
  error estimate for blocks of size 2^( 7) =       0.000479190054

      target function =                  N/A
              le_mean =     -16.905659004844
             les_mean =     286.141799160121
             stat err =       0.000465650900
             autocorr =       1.273628518957
              std dev =       0.583517730935
             le_variance =       0.340492942316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340394998166
                                         uncertainty =       0.003391820288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412609344
  error estimate for blocks of size 2^( 2) =       0.000425149370
  error estimate for blocks of size 2^( 3) =       0.000437915790
  error estimate for blocks of size 2^( 4) =       0.000450479756
  error estimate for blocks of size 2^( 5) =       0.000461236590
  error estimate for blocks of size 2^( 6) =       0.000471697202
  error estimate for blocks of size 2^( 7) =       0.000479190054

      target function =                  N/A
              le_mean =     -16.905659004844
             les_mean =     286.141799160121
             stat err =       0.000465650900
             autocorr =       1.273628518957
              std dev =       0.583517730935
             le_variance =       0.340492942316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905659004844        initial  <--
     1.5625e+26     1.5625e+27             0.0000e+00       -16.905659004844
     6.2500e+26     6.2500e+27             0.0000e+00       -16.905659004844
     2.5000e+27     2.5000e+28             0.0000e+00       -16.905659004844

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9589
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0785e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.7709
    reference variance = 0.333005
====================================================
  Execution time = 4.1662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337400363287
                                         uncertainty =       0.002945374737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337400363287
                                         uncertainty =       0.002945374737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410693810
  error estimate for blocks of size 2^( 2) =       0.000423347647
  error estimate for blocks of size 2^( 3) =       0.000436080221
  error estimate for blocks of size 2^( 4) =       0.000447331391
  error estimate for blocks of size 2^( 5) =       0.000457758284
  error estimate for blocks of size 2^( 6) =       0.000465157664
  error estimate for blocks of size 2^( 7) =       0.000471935405

      target function =                  N/A
              le_mean =     -16.905415683356
             les_mean =     286.130418069429
             stat err =       0.000460545686
             autocorr =       1.257503268455
              std dev =       0.580808755996
             le_variance =       0.337338811041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690541568336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905415683356       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2432e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.969
    reference variance = 1.42587
====================================================
  Execution time = 4.0920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7288e-01
  Total weights = 2.0000e+06
  Execution time = 3.6861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431788767
  error estimate for blocks of size 2^( 2) =       0.000443661829
  error estimate for blocks of size 2^( 3) =       0.000455790055
  error estimate for blocks of size 2^( 4) =       0.000466708128
  error estimate for blocks of size 2^( 5) =       0.000475565602
  error estimate for blocks of size 2^( 6) =       0.000481879016
  error estimate for blocks of size 2^( 7) =       0.000487507271

      target function =                  N/A
              le_mean =     -16.905752144887
             les_mean =     286.177338475884
             stat err =       0.000477915004
             autocorr =       1.225063645476
              std dev =       0.610641529855
             le_variance =       0.372883077983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431788767
  error estimate for blocks of size 2^( 2) =       0.000443661829
  error estimate for blocks of size 2^( 3) =       0.000455790055
  error estimate for blocks of size 2^( 4) =       0.000466708128
  error estimate for blocks of size 2^( 5) =       0.000475565602
  error estimate for blocks of size 2^( 6) =       0.000481879016
  error estimate for blocks of size 2^( 7) =       0.000487507271

      target function =                  N/A
              le_mean =     -16.905752144887
             les_mean =     286.177338475884
             stat err =       0.000477915004
             autocorr =       1.225063645476
              std dev =       0.610641529855
             le_variance =       0.372883077983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431788767
  error estimate for blocks of size 2^( 2) =       0.000443661829
  error estimate for blocks of size 2^( 3) =       0.000455790055
  error estimate for blocks of size 2^( 4) =       0.000466708128
  error estimate for blocks of size 2^( 5) =       0.000475565602
  error estimate for blocks of size 2^( 6) =       0.000481879016
  error estimate for blocks of size 2^( 7) =       0.000487507271

      target function =                  N/A
              le_mean =     -16.905752144887
             les_mean =     286.177338475884
             stat err =       0.000477915004
             autocorr =       1.225063645476
              std dev =       0.610641529855
             le_variance =       0.372883077983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372979865523
                                         uncertainty =       0.026084627966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431788767
  error estimate for blocks of size 2^( 2) =       0.000443661829
  error estimate for blocks of size 2^( 3) =       0.000455790055
  error estimate for blocks of size 2^( 4) =       0.000466708128
  error estimate for blocks of size 2^( 5) =       0.000475565602
  error estimate for blocks of size 2^( 6) =       0.000481879016
  error estimate for blocks of size 2^( 7) =       0.000487507271

      target function =                  N/A
              le_mean =     -16.905752144887
             les_mean =     286.177338475884
             stat err =       0.000477915004
             autocorr =       1.225063645476
              std dev =       0.610641529855
             le_variance =       0.372883077983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905752144887        initial  <--
     1.5625e+27     1.5625e+28             0.0000e+00       -16.905752144887
     6.2500e+27     6.2500e+28             0.0000e+00       -16.905752144887
     2.5000e+28     2.5000e+29             0.0000e+00       -16.905752144887

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.4851
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1192e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8408
    reference variance = 0.281262
====================================================
  Execution time = 3.9648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0692e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350001314890
                                         uncertainty =       0.006556813797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350001314890
                                         uncertainty =       0.006556813797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418340165
  error estimate for blocks of size 2^( 2) =       0.000430451565
  error estimate for blocks of size 2^( 3) =       0.000443798627
  error estimate for blocks of size 2^( 4) =       0.000456586568
  error estimate for blocks of size 2^( 5) =       0.000467739119
  error estimate for blocks of size 2^( 6) =       0.000477866032
  error estimate for blocks of size 2^( 7) =       0.000483118284

      target function =                  N/A
              le_mean =     -16.905160839796
             les_mean =     286.134479832218
             stat err =       0.000471327501
             autocorr =       1.269364748513
              std dev =       0.591622335495
             le_variance =       0.350016987856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690516083980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160839796       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0348e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.987
    reference variance = 0.230508
====================================================
  Execution time = 3.8994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3999e-01
  Total weights = 2.0000e+06
  Execution time = 3.6952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412302116
  error estimate for blocks of size 2^( 2) =       0.000425235061
  error estimate for blocks of size 2^( 3) =       0.000438793111
  error estimate for blocks of size 2^( 4) =       0.000451731826
  error estimate for blocks of size 2^( 5) =       0.000461109907
  error estimate for blocks of size 2^( 6) =       0.000469584008
  error estimate for blocks of size 2^( 7) =       0.000474293074

      target function =                  N/A
              le_mean =     -16.906976905433
             les_mean =     286.185853981249
             stat err =       0.000464179704
             autocorr =       1.267480148044
              std dev =       0.583083244826
             le_variance =       0.339986070397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412302116
  error estimate for blocks of size 2^( 2) =       0.000425235061
  error estimate for blocks of size 2^( 3) =       0.000438793111
  error estimate for blocks of size 2^( 4) =       0.000451731826
  error estimate for blocks of size 2^( 5) =       0.000461109907
  error estimate for blocks of size 2^( 6) =       0.000469584008
  error estimate for blocks of size 2^( 7) =       0.000474293074

      target function =                  N/A
              le_mean =     -16.906976905433
             les_mean =     286.185853981249
             stat err =       0.000464179704
             autocorr =       1.267480148044
              std dev =       0.583083244826
             le_variance =       0.339986070397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412302116
  error estimate for blocks of size 2^( 2) =       0.000425235061
  error estimate for blocks of size 2^( 3) =       0.000438793111
  error estimate for blocks of size 2^( 4) =       0.000451731826
  error estimate for blocks of size 2^( 5) =       0.000461109907
  error estimate for blocks of size 2^( 6) =       0.000469584008
  error estimate for blocks of size 2^( 7) =       0.000474293074

      target function =                  N/A
              le_mean =     -16.906976905433
             les_mean =     286.185853981249
             stat err =       0.000464179704
             autocorr =       1.267480148044
              std dev =       0.583083244826
             le_variance =       0.339986070397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008828777
                                         uncertainty =       0.003931290658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412302116
  error estimate for blocks of size 2^( 2) =       0.000425235061
  error estimate for blocks of size 2^( 3) =       0.000438793111
  error estimate for blocks of size 2^( 4) =       0.000451731826
  error estimate for blocks of size 2^( 5) =       0.000461109907
  error estimate for blocks of size 2^( 6) =       0.000469584008
  error estimate for blocks of size 2^( 7) =       0.000474293074

      target function =                  N/A
              le_mean =     -16.906976905433
             les_mean =     286.185853981249
             stat err =       0.000464179704
             autocorr =       1.267480148044
              std dev =       0.583083244826
             le_variance =       0.339986070397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906976905433        initial  <--
     1.5625e+28     1.5625e+29             0.0000e+00       -16.906976905433
     6.2500e+28     6.2500e+29             0.0000e+00       -16.906976905433
     2.5000e+29     2.5000e+30             0.0000e+00       -16.906976905433

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6073
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0797e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.291151
====================================================
  Execution time = 3.9564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3620e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0822e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335982553311
                                         uncertainty =       0.003959700831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335982553311
                                         uncertainty =       0.003959700831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409997117
  error estimate for blocks of size 2^( 2) =       0.000422793506
  error estimate for blocks of size 2^( 3) =       0.000436053123
  error estimate for blocks of size 2^( 4) =       0.000448628724
  error estimate for blocks of size 2^( 5) =       0.000459869086
  error estimate for blocks of size 2^( 6) =       0.000468493844
  error estimate for blocks of size 2^( 7) =       0.000474883213

      target function =                  N/A
              le_mean =     -16.904736089528
             les_mean =     286.106297360251
             stat err =       0.000462968717
             autocorr =       1.275092486571
              std dev =       0.579823483278
             le_variance =       0.336195271760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690473608953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736089528       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904736089528       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904736089527       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+29 is 3.021737e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736089528       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904736089528       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904736089528       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904736086726       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+29 is 1.474799e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736089528       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904736089528       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904736089528       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904736086726       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+30 is 3.686996e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0393e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.380477
====================================================
  Execution time = 3.9351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3972e-01
  Total weights = 2.0000e+06
  Execution time = 3.6909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412140072
  error estimate for blocks of size 2^( 2) =       0.000425103046
  error estimate for blocks of size 2^( 3) =       0.000438119730
  error estimate for blocks of size 2^( 4) =       0.000450897549
  error estimate for blocks of size 2^( 5) =       0.000461380735
  error estimate for blocks of size 2^( 6) =       0.000470752608
  error estimate for blocks of size 2^( 7) =       0.000481886491

      target function =                  N/A
              le_mean =     -16.905471118697
             les_mean =     286.134672453741
             stat err =       0.000466229346
             autocorr =       1.279703994354
              std dev =       0.582854079939
             le_variance =       0.339718878501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412140072
  error estimate for blocks of size 2^( 2) =       0.000425103046
  error estimate for blocks of size 2^( 3) =       0.000438119730
  error estimate for blocks of size 2^( 4) =       0.000450897549
  error estimate for blocks of size 2^( 5) =       0.000461380735
  error estimate for blocks of size 2^( 6) =       0.000470752608
  error estimate for blocks of size 2^( 7) =       0.000481886491

      target function =                  N/A
              le_mean =     -16.905471118697
             les_mean =     286.134672453741
             stat err =       0.000466229346
             autocorr =       1.279703994354
              std dev =       0.582854079939
             le_variance =       0.339718878501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412140072
  error estimate for blocks of size 2^( 2) =       0.000425103046
  error estimate for blocks of size 2^( 3) =       0.000438119730
  error estimate for blocks of size 2^( 4) =       0.000450897549
  error estimate for blocks of size 2^( 5) =       0.000461380735
  error estimate for blocks of size 2^( 6) =       0.000470752608
  error estimate for blocks of size 2^( 7) =       0.000481886491

      target function =                  N/A
              le_mean =     -16.905471118697
             les_mean =     286.134672453741
             stat err =       0.000466229346
             autocorr =       1.279703994354
              std dev =       0.582854079939
             le_variance =       0.339718878501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414012851
                                         uncertainty =       0.004445303669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412140072
  error estimate for blocks of size 2^( 2) =       0.000425103046
  error estimate for blocks of size 2^( 3) =       0.000438119730
  error estimate for blocks of size 2^( 4) =       0.000450897549
  error estimate for blocks of size 2^( 5) =       0.000461380735
  error estimate for blocks of size 2^( 6) =       0.000470752608
  error estimate for blocks of size 2^( 7) =       0.000481886491

      target function =                  N/A
              le_mean =     -16.905471118697
             les_mean =     286.134672453741
             stat err =       0.000466229346
             autocorr =       1.279703994354
              std dev =       0.582854079939
             le_variance =       0.339718878501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905471118697        initial  <--
     1.5625e+29     1.5625e+30             3.0217e-34       -16.905471118697
     6.2500e+29     6.2500e+30             1.4748e-34       -16.905471118697
     2.5000e+30     2.5000e+31             3.6870e-35       -16.905471118697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9335
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0833e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.29076
====================================================
  Execution time = 4.1160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0701e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339896841937
                                         uncertainty =       0.004529347323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339896841937
                                         uncertainty =       0.004529347323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412232422
  error estimate for blocks of size 2^( 2) =       0.000425283793
  error estimate for blocks of size 2^( 3) =       0.000438173472
  error estimate for blocks of size 2^( 4) =       0.000449995536
  error estimate for blocks of size 2^( 5) =       0.000461050438
  error estimate for blocks of size 2^( 6) =       0.000468447430
  error estimate for blocks of size 2^( 7) =       0.000474023780

      target function =                  N/A
              le_mean =     -16.905732589725
             les_mean =     286.143665364586
             stat err =       0.000463379296
             autocorr =       1.263539894913
              std dev =       0.582984681813
             le_variance =       0.339871139228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573258973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732589725       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3408e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.190962
====================================================
  Execution time = 3.9109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3912e-01
  Total weights = 2.0000e+06
  Execution time = 3.6778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411774794
  error estimate for blocks of size 2^( 2) =       0.000424356939
  error estimate for blocks of size 2^( 3) =       0.000437209083
  error estimate for blocks of size 2^( 4) =       0.000449355324
  error estimate for blocks of size 2^( 5) =       0.000460618419
  error estimate for blocks of size 2^( 6) =       0.000469230704
  error estimate for blocks of size 2^( 7) =       0.000475562368

      target function =                  N/A
              le_mean =     -16.904831645834
             les_mean =     286.112449766848
             stat err =       0.000463691704
             autocorr =       1.268058044466
              std dev =       0.582337498734
             le_variance =       0.339116962432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411774794
  error estimate for blocks of size 2^( 2) =       0.000424356939
  error estimate for blocks of size 2^( 3) =       0.000437209083
  error estimate for blocks of size 2^( 4) =       0.000449355324
  error estimate for blocks of size 2^( 5) =       0.000460618419
  error estimate for blocks of size 2^( 6) =       0.000469230704
  error estimate for blocks of size 2^( 7) =       0.000475562368

      target function =                  N/A
              le_mean =     -16.904831645834
             les_mean =     286.112449766848
             stat err =       0.000463691704
             autocorr =       1.268058044466
              std dev =       0.582337498734
             le_variance =       0.339116962432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411774794
  error estimate for blocks of size 2^( 2) =       0.000424356939
  error estimate for blocks of size 2^( 3) =       0.000437209083
  error estimate for blocks of size 2^( 4) =       0.000449355324
  error estimate for blocks of size 2^( 5) =       0.000460618419
  error estimate for blocks of size 2^( 6) =       0.000469230704
  error estimate for blocks of size 2^( 7) =       0.000475562368

      target function =                  N/A
              le_mean =     -16.904831645834
             les_mean =     286.112449766848
             stat err =       0.000463691704
             autocorr =       1.268058044466
              std dev =       0.582337498734
             le_variance =       0.339116962432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177678046
                                         uncertainty =       0.003425979559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411774794
  error estimate for blocks of size 2^( 2) =       0.000424356939
  error estimate for blocks of size 2^( 3) =       0.000437209083
  error estimate for blocks of size 2^( 4) =       0.000449355324
  error estimate for blocks of size 2^( 5) =       0.000460618419
  error estimate for blocks of size 2^( 6) =       0.000469230704
  error estimate for blocks of size 2^( 7) =       0.000475562368

      target function =                  N/A
              le_mean =     -16.904831645834
             les_mean =     286.112449766848
             stat err =       0.000463691704
             autocorr =       1.268058044466
              std dev =       0.582337498734
             le_variance =       0.339116962432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904831645834        initial  <--
     1.5625e+30     1.5625e+31             0.0000e+00       -16.904831645834
     6.2500e+30     6.2500e+31             0.0000e+00       -16.904831645834
     2.5000e+31     2.5000e+32             0.0000e+00       -16.904831645834

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6689
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1108e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9454
    reference variance = 1.2205
====================================================
  Execution time = 3.9582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0725e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340178604486
                                         uncertainty =       0.003208906555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340178604486
                                         uncertainty =       0.003208906555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412368538
  error estimate for blocks of size 2^( 2) =       0.000425329492
  error estimate for blocks of size 2^( 3) =       0.000438214574
  error estimate for blocks of size 2^( 4) =       0.000450683640
  error estimate for blocks of size 2^( 5) =       0.000461295940
  error estimate for blocks of size 2^( 6) =       0.000469782698
  error estimate for blocks of size 2^( 7) =       0.000473277926

      target function =                  N/A
              le_mean =     -16.905685515981
             les_mean =     286.142298216813
             stat err =       0.000463760051
             autocorr =       1.264781850977
              std dev =       0.583177178564
             le_variance =       0.340095621598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568551598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905685515981       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0314e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.212509
====================================================
  Execution time = 3.8949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4074e-01
  Total weights = 2.0000e+06
  Execution time = 3.6992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412761571
  error estimate for blocks of size 2^( 2) =       0.000425134443
  error estimate for blocks of size 2^( 3) =       0.000438069951
  error estimate for blocks of size 2^( 4) =       0.000450172659
  error estimate for blocks of size 2^( 5) =       0.000458997945
  error estimate for blocks of size 2^( 6) =       0.000466758157
  error estimate for blocks of size 2^( 7) =       0.000473090723

      target function =                  N/A
              le_mean =     -16.906088349724
             les_mean =     286.156567347048
             stat err =       0.000462254871
             autocorr =       1.254193308206
              std dev =       0.583733011532
             le_variance =       0.340744228752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412761571
  error estimate for blocks of size 2^( 2) =       0.000425134443
  error estimate for blocks of size 2^( 3) =       0.000438069951
  error estimate for blocks of size 2^( 4) =       0.000450172659
  error estimate for blocks of size 2^( 5) =       0.000458997945
  error estimate for blocks of size 2^( 6) =       0.000466758157
  error estimate for blocks of size 2^( 7) =       0.000473090723

      target function =                  N/A
              le_mean =     -16.906088349724
             les_mean =     286.156567347048
             stat err =       0.000462254871
             autocorr =       1.254193308206
              std dev =       0.583733011532
             le_variance =       0.340744228752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412761571
  error estimate for blocks of size 2^( 2) =       0.000425134443
  error estimate for blocks of size 2^( 3) =       0.000438069951
  error estimate for blocks of size 2^( 4) =       0.000450172659
  error estimate for blocks of size 2^( 5) =       0.000458997945
  error estimate for blocks of size 2^( 6) =       0.000466758157
  error estimate for blocks of size 2^( 7) =       0.000473090723

      target function =                  N/A
              le_mean =     -16.906088349724
             les_mean =     286.156567347048
             stat err =       0.000462254871
             autocorr =       1.254193308206
              std dev =       0.583733011532
             le_variance =       0.340744228752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835818826
                                         uncertainty =       0.005812357074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412761571
  error estimate for blocks of size 2^( 2) =       0.000425134443
  error estimate for blocks of size 2^( 3) =       0.000438069951
  error estimate for blocks of size 2^( 4) =       0.000450172659
  error estimate for blocks of size 2^( 5) =       0.000458997945
  error estimate for blocks of size 2^( 6) =       0.000466758157
  error estimate for blocks of size 2^( 7) =       0.000473090723

      target function =                  N/A
              le_mean =     -16.906088349724
             les_mean =     286.156567347048
             stat err =       0.000462254871
             autocorr =       1.254193308206
              std dev =       0.583733011532
             le_variance =       0.340744228752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906088349724        initial  <--
     1.5625e+31     1.5625e+32             0.0000e+00       -16.906088349724
     6.2500e+31     6.2500e+32             0.0000e+00       -16.906088349724
     2.5000e+32     2.5000e+33             0.0000e+00       -16.906088349724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5785
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0790e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8682
    reference variance = 0.329928
====================================================
  Execution time = 3.9206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4529e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0619e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347803679
                                         uncertainty =       0.004713486147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347803679
                                         uncertainty =       0.004713486147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415503917
  error estimate for blocks of size 2^( 2) =       0.000427958563
  error estimate for blocks of size 2^( 3) =       0.000440745629
  error estimate for blocks of size 2^( 4) =       0.000452512623
  error estimate for blocks of size 2^( 5) =       0.000462730300
  error estimate for blocks of size 2^( 6) =       0.000471227192
  error estimate for blocks of size 2^( 7) =       0.000475393954

      target function =                  N/A
              le_mean =     -16.905722942079
             les_mean =     286.148755031232
             stat err =       0.000465466017
             autocorr =       1.254947953863
              std dev =       0.587611274167
             le_variance =       0.345287009528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572294208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+32, overlap shift 1.5625e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722942079       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9832e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9475
    reference variance = 0.279147
====================================================
  Execution time = 4.0527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.0000e+06
  Execution time = 3.6875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411532638
  error estimate for blocks of size 2^( 2) =       0.000424016687
  error estimate for blocks of size 2^( 3) =       0.000436964623
  error estimate for blocks of size 2^( 4) =       0.000448758445
  error estimate for blocks of size 2^( 5) =       0.000460969826
  error estimate for blocks of size 2^( 6) =       0.000470343535
  error estimate for blocks of size 2^( 7) =       0.000475867503

      target function =                  N/A
              le_mean =     -16.905703630857
             les_mean =     286.141533308520
             stat err =       0.000463984827
             autocorr =       1.271156406040
              std dev =       0.581995037350
             le_variance =       0.338718223500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411532638
  error estimate for blocks of size 2^( 2) =       0.000424016687
  error estimate for blocks of size 2^( 3) =       0.000436964623
  error estimate for blocks of size 2^( 4) =       0.000448758445
  error estimate for blocks of size 2^( 5) =       0.000460969826
  error estimate for blocks of size 2^( 6) =       0.000470343535
  error estimate for blocks of size 2^( 7) =       0.000475867503

      target function =                  N/A
              le_mean =     -16.905703630857
             les_mean =     286.141533308520
             stat err =       0.000463984827
             autocorr =       1.271156406040
              std dev =       0.581995037350
             le_variance =       0.338718223500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411532638
  error estimate for blocks of size 2^( 2) =       0.000424016687
  error estimate for blocks of size 2^( 3) =       0.000436964623
  error estimate for blocks of size 2^( 4) =       0.000448758445
  error estimate for blocks of size 2^( 5) =       0.000460969826
  error estimate for blocks of size 2^( 6) =       0.000470343535
  error estimate for blocks of size 2^( 7) =       0.000475867503

      target function =                  N/A
              le_mean =     -16.905703630857
             les_mean =     286.141533308520
             stat err =       0.000463984827
             autocorr =       1.271156406040
              std dev =       0.581995037350
             le_variance =       0.338718223500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338638468917
                                         uncertainty =       0.004705081224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411532638
  error estimate for blocks of size 2^( 2) =       0.000424016687
  error estimate for blocks of size 2^( 3) =       0.000436964623
  error estimate for blocks of size 2^( 4) =       0.000448758445
  error estimate for blocks of size 2^( 5) =       0.000460969826
  error estimate for blocks of size 2^( 6) =       0.000470343535
  error estimate for blocks of size 2^( 7) =       0.000475867503

      target function =                  N/A
              le_mean =     -16.905703630857
             les_mean =     286.141533308520
             stat err =       0.000463984827
             autocorr =       1.271156406040
              std dev =       0.581995037350
             le_variance =       0.338718223500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905703630857        initial  <--
     1.5625e+32     1.5625e+33             0.0000e+00       -16.905703630857
     6.2500e+32     6.2500e+33             0.0000e+00       -16.905703630857
     2.5000e+33     2.5000e+34             0.0000e+00       -16.905703630857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.1269
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.088287e-01 1 1  ON 0
 uu_1                 1.421394e-01 1 1  ON 1
 uu_2                 4.085865e-02 1 1  ON 2
 uu_3                -2.127760e-02 1 1  ON 3
 uu_4                -6.583160e-02 1 1  ON 4
 uu_5                -9.968775e-02 1 1  ON 5
 uu_6                -1.260869e-01 1 1  ON 6
 uu_7                -1.389497e-01 1 1  ON 7
 uu_8                -1.311958e-01 1 1  ON 8
 uu_9                -1.014965e-01 1 1  ON 9
 ud_0                 4.492740e-01 1 1  ON 10
 ud_1                 1.828397e-01 1 1  ON 11
 ud_2                 6.191140e-02 1 1  ON 12
 ud_3                -9.882894e-03 1 1  ON 13
 ud_4                -6.715984e-02 1 1  ON 14
 ud_5                -1.084819e-01 1 1  ON 15
 ud_6                -1.353600e-01 1 1  ON 16
 ud_7                -1.512096e-01 1 1  ON 17
 ud_8                -1.512118e-01 1 1  ON 18
 ud_9                -1.397322e-01 1 1  ON 19
 eO_0                -7.653960e-01 1 1  ON 20
 eO_1                -4.432091e-01 1 1  ON 21
 eO_2                -2.003563e-02 1 1  ON 22
 eO_3                 3.023636e-01 1 1  ON 23
 eO_4                 5.268878e-01 1 1  ON 24
 eO_5                 4.858510e-01 1 1  ON 25
 eO_6                 2.552489e-01 1 1  ON 26
 eO_7                -4.703172e-02 1 1  ON 27
 eO_8                -2.180656e-01 1 1  ON 28
 eO_9                -7.687124e-02 1 1  ON 29
eH1_0                -2.423444e-01 1 1  ON 30
eH1_1                -1.422499e-01 1 1  ON 31
eH1_2                -9.543944e-02 1 1  ON 32
eH1_3                -4.174668e-02 1 1  ON 33
eH1_4                 6.509188e-03 1 1  ON 34
eH1_5                 4.070110e-02 1 1  ON 35
eH1_6                 9.819769e-02 1 1  ON 36
eH1_7                 1.506488e-01 1 1  ON 37
eH1_8                 1.724042e-01 1 1  ON 38
eH1_9                 5.742368e-02 1 1  ON 39
eH2_0                -2.371710e-01 1 1  ON 40
eH2_1                -1.378225e-01 1 1  ON 41
eH2_2                -9.170119e-02 1 1  ON 42
eH2_3                -3.778373e-02 1 1  ON 43
eH2_4                 9.913179e-03 1 1  ON 44
eH2_5                 4.331544e-02 1 1  ON 45
eH2_6                 9.907932e-02 1 1  ON 46
eH2_7                 1.498290e-01 1 1  ON 47
eH2_8                 1.755320e-01 1 1  ON 48
eH2_9                 4.436520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0896e+02 secs
  Total Execution time = 4.3991e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
