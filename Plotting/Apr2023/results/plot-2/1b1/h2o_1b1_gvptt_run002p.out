Rank =    0  Free Memory = 73747 MB
Rank =    1  Free Memory = 73747 MB
Rank =    2  Free Memory = 73747 MB
Rank =    3  Free Memory = 73747 MB
Rank =    4  Free Memory = 73747 MB
Rank =    5  Free Memory = 73747 MB
Rank =    6  Free Memory = 73747 MB
Rank =    7  Free Memory = 73747 MB
Rank =    8  Free Memory = 73747 MB
Rank =    9  Free Memory = 73747 MB
Rank =   10  Free Memory = 73747 MB
Rank =   11  Free Memory = 73747 MB
Rank =   12  Free Memory = 73747 MB
Rank =   13  Free Memory = 73747 MB
Rank =   14  Free Memory = 73747 MB
Rank =   15  Free Memory = 73735 MB
Rank =   16  Free Memory = 73733 MB
Rank =   17  Free Memory = 73733 MB
Rank =   18  Free Memory = 73733 MB
Rank =   19  Free Memory = 73733 MB
Rank =   20  Free Memory = 73733 MB
Rank =   21  Free Memory = 73733 MB
Rank =   22  Free Memory = 73733 MB
Rank =   23  Free Memory = 73733 MB
Rank =   24  Free Memory = 73733 MB
Rank =   25  Free Memory = 73732 MB
Rank =   26  Free Memory = 73732 MB
Rank =   27  Free Memory = 73732 MB
Rank =   28  Free Memory = 73732 MB
Rank =   29  Free Memory = 73732 MB
Rank =   30  Free Memory = 73732 MB
Rank =   31  Free Memory = 73732 MB
Rank =   32  Free Memory = 72555 MB
Rank =   33  Free Memory = 72555 MB
Rank =   34  Free Memory = 72554 MB
Rank =   35  Free Memory = 72554 MB
Rank =   36  Free Memory = 72554 MB
Rank =   37  Free Memory = 72554 MB
Rank =   38  Free Memory = 72554 MB
Rank =   39  Free Memory = 72554 MB
Rank =   40  Free Memory = 72554 MB
Rank =   41  Free Memory = 72554 MB
Rank =   42  Free Memory = 72554 MB
Rank =   43  Free Memory = 72554 MB
Rank =   44  Free Memory = 72554 MB
Rank =   45  Free Memory = 72554 MB
Rank =   46  Free Memory = 72554 MB
Rank =   47  Free Memory = 72554 MB
Rank =   48  Free Memory = 72554 MB
Rank =   49  Free Memory = 72554 MB
Rank =   50  Free Memory = 72554 MB
Rank =   51  Free Memory = 72554 MB
Rank =   52  Free Memory = 72554 MB
Rank =   53  Free Memory = 72554 MB
Rank =   54  Free Memory = 72554 MB
Rank =   55  Free Memory = 72554 MB
Rank =   56  Free Memory = 72554 MB
Rank =   57  Free Memory = 72554 MB
Rank =   58  Free Memory = 72554 MB
Rank =   59  Free Memory = 72554 MB
Rank =   60  Free Memory = 72554 MB
Rank =   61  Free Memory = 72554 MB
Rank =   62  Free Memory = 72554 MB
Rank =   63  Free Memory = 72554 MB
Rank =   64  Free Memory = 57736 MB
Rank =   65  Free Memory = 57736 MB
Rank =   66  Free Memory = 57736 MB
Rank =   67  Free Memory = 57736 MB
Rank =   68  Free Memory = 57736 MB
Rank =   69  Free Memory = 57736 MB
Rank =   70  Free Memory = 57736 MB
Rank =   71  Free Memory = 57736 MB
Rank =   72  Free Memory = 57736 MB
Rank =   73  Free Memory = 57736 MB
Rank =   74  Free Memory = 57736 MB
Rank =   75  Free Memory = 57736 MB
Rank =   76  Free Memory = 57736 MB
Rank =   77  Free Memory = 57736 MB
Rank =   78  Free Memory = 57736 MB
Rank =   79  Free Memory = 57736 MB
Rank =   80  Free Memory = 57736 MB
Rank =   81  Free Memory = 57736 MB
Rank =   82  Free Memory = 57736 MB
Rank =   83  Free Memory = 57736 MB
Rank =   84  Free Memory = 57736 MB
Rank =   85  Free Memory = 57736 MB
Rank =   86  Free Memory = 57736 MB
Rank =   87  Free Memory = 57736 MB
Rank =   88  Free Memory = 57736 MB
Rank =   89  Free Memory = 57736 MB
Rank =   90  Free Memory = 57736 MB
Rank =   91  Free Memory = 57736 MB
Rank =   92  Free Memory = 57736 MB
Rank =   93  Free Memory = 57736 MB
Rank =   94  Free Memory = 57736 MB
Rank =   95  Free Memory = 57736 MB
Rank =   96  Free Memory = 79352 MB
Rank =   97  Free Memory = 79352 MB
Rank =   98  Free Memory = 79352 MB
Rank =   99  Free Memory = 79352 MB
Rank =  100  Free Memory = 79352 MB
Rank =  101  Free Memory = 79352 MB
Rank =  102  Free Memory = 79352 MB
Rank =  103  Free Memory = 79352 MB
Rank =  104  Free Memory = 79352 MB
Rank =  105  Free Memory = 79352 MB
Rank =  106  Free Memory = 79352 MB
Rank =  107  Free Memory = 79352 MB
Rank =  108  Free Memory = 79352 MB
Rank =  109  Free Memory = 79352 MB
Rank =  110  Free Memory = 79352 MB
Rank =  111  Free Memory = 79352 MB
Rank =  112  Free Memory = 79352 MB
Rank =  113  Free Memory = 79352 MB
Rank =  114  Free Memory = 79352 MB
Rank =  115  Free Memory = 79352 MB
Rank =  116  Free Memory = 79352 MB
Rank =  117  Free Memory = 79352 MB
Rank =  118  Free Memory = 79352 MB
Rank =  119  Free Memory = 79352 MB
Rank =  120  Free Memory = 79352 MB
Rank =  121  Free Memory = 79352 MB
Rank =  122  Free Memory = 79352 MB
Rank =  123  Free Memory = 79352 MB
Rank =  124  Free Memory = 79352 MB
Rank =  125  Free Memory = 79352 MB
Rank =  126  Free Memory = 79352 MB
Rank =  127  Free Memory = 79352 MB
  Input file(s): opt_h2o_1b1_gvptt_run002p.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002p.xml

  Project = H2O
  date    = 2023-04-17 10:07:35 PDT
  host    = n0051.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 215

  Range of prime numbers to use as seeds over processors and threads = 1327-2333


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.093897e-01    1         1  ON     0
     uu_1                 1.426949e-01    1         1  ON     1
     uu_2                 4.116452e-02    1         1  ON     2
     uu_3                -2.105986e-02    1         1  ON     3
     uu_4                -6.594210e-02    1         1  ON     4
     uu_5                -1.001285e-01    1         1  ON     5
     uu_6                -1.268130e-01    1         1  ON     6
     uu_7                -1.397879e-01    1         1  ON     7
     uu_8                -1.320753e-01    1         1  ON     8
     uu_9                -1.018918e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.495834e-01    1         1  ON     0
     ud_1                 1.832527e-01    1         1  ON     1
     ud_2                 6.186281e-02    1         1  ON     2
     ud_3                -9.987698e-03    1         1  ON     3
     ud_4                -6.697310e-02    1         1  ON     4
     ud_5                -1.082638e-01    1         1  ON     5
     ud_6                -1.352595e-01    1         1  ON     6
     ud_7                -1.512209e-01    1         1  ON     7
     ud_8                -1.512214e-01    1         1  ON     8
     ud_9                -1.402193e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.657036e-01    1         1  ON     0
     eO_1                -4.432280e-01    1         1  ON     1
     eO_2                -2.013322e-02    1         1  ON     2
     eO_3                 3.024883e-01    1         1  ON     3
     eO_4                 5.274380e-01    1         1  ON     4
     eO_5                 4.867845e-01    1         1  ON     5
     eO_6                 2.562433e-01    1         1  ON     6
     eO_7                -4.645302e-02    1         1  ON     7
     eO_8                -2.193471e-01    1         1  ON     8
     eO_9                -7.815238e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.433126e-01    1         1  ON     0
     eH1_1                -1.428303e-01    1         1  ON     1
     eH1_2                -9.588572e-02    1         1  ON     2
     eH1_3                -4.192951e-02    1         1  ON     3
     eH1_4                 5.791022e-03    1         1  ON     4
     eH1_5                 4.058011e-02    1         1  ON     5
     eH1_6                 9.791532e-02    1         1  ON     6
     eH1_7                 1.510336e-01    1         1  ON     7
     eH1_8                 1.737557e-01    1         1  ON     8
     eH1_9                 5.895928e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.388134e-01    1         1  ON     0
     eH2_1                -1.389753e-01    1         1  ON     1
     eH2_2                -9.213665e-02    1         1  ON     2
     eH2_3                -3.793524e-02    1         1  ON     3
     eH2_4                 9.853838e-03    1         1  ON     4
     eH2_5                 4.294163e-02    1         1  ON     5
     eH2_6                 9.879544e-02    1         1  ON     6
     eH2_7                 1.505162e-01    1         1  ON     7
     eH2_8                 1.766670e-01    1         1  ON     8
     eH2_9                 4.638256e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.970434e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.6933e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8295
    reference variance = 0.390954
====================================================
  Execution time = 3.6784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3429e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0147e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334341648464
                                         uncertainty =       0.002829948880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334341648464
                                         uncertainty =       0.002829948880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408831904
  error estimate for blocks of size 2^( 2) =       0.000421612487
  error estimate for blocks of size 2^( 3) =       0.000435186952
  error estimate for blocks of size 2^( 4) =       0.000447153414
  error estimate for blocks of size 2^( 5) =       0.000459468534
  error estimate for blocks of size 2^( 6) =       0.000466801335
  error estimate for blocks of size 2^( 7) =       0.000473094509

      target function =                  N/A
              le_mean =     -16.905754594752
             les_mean =     286.138825303069
             stat err =       0.000461629448
             autocorr =       1.274962615036
              std dev =       0.578175624031
             le_variance =       0.334287052224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690575459475e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905754594752       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905755202680       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905755180305       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905755668989       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905755782042       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905755839192       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756393530       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905755992613       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905756164603       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905756164478       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.027298e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905754594752       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905754817368       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905754876544       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905755098010       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905755123815       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905754944670       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905755131626       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905755058769       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.536725e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905754594752       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905754657723       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905754686942       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905754764590       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905754732993       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905754706038       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905754742936       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905754728411       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.448769e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7059e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.092981e-01                 1 1 ON  0
uu_1  1.427070e-01                 1 1 ON  1
uu_2  4.123820e-02                 1 1 ON  2
uu_3  -2.109945e-02                1 1 ON  3
uu_4  -6.602062e-02                1 1 ON  4
uu_5  -1.001115e-01                1 1 ON  5
uu_6  -1.268098e-01                1 1 ON  6
uu_7  -1.397977e-01                1 1 ON  7
uu_8  -1.320597e-01                1 1 ON  8
uu_9  -1.019196e-01                1 1 ON  9
ud_0  4.495788e-01                 1 1 ON  10
ud_1  1.832778e-01                 1 1 ON  11
ud_2  6.192246e-02                 1 1 ON  12
ud_3  -9.971906e-03                1 1 ON  13
ud_4  -6.698237e-02                1 1 ON  14
ud_5  -1.082360e-01                1 1 ON  15
ud_6  -1.352667e-01                1 1 ON  16
ud_7  -1.512182e-01                1 1 ON  17
ud_8  -1.513117e-01                1 1 ON  18
ud_9  -1.402276e-01                1 1 ON  19
eO_0  -7.656501e-01                1 1 ON  20
eO_1  -4.432066e-01                1 1 ON  21
eO_2  -2.019842e-02                1 1 ON  22
eO_3  3.024493e-01                 1 1 ON  23
eO_4  5.275050e-01                 1 1 ON  24
eO_5  4.868103e-01                 1 1 ON  25
eO_6  2.563358e-01                 1 1 ON  26
eO_7  -4.637535e-02                1 1 ON  27
eO_8  -2.194373e-01                1 1 ON  28
eO_9  -7.826895e-02                1 1 ON  29
eH1_0 -2.434886e-01                1 1 ON  30
eH1_1 -1.428400e-01                1 1 ON  31
eH1_2 -9.598659e-02                1 1 ON  32
eH1_3 -4.190676e-02                1 1 ON  33
eH1_4 5.791135e-03                 1 1 ON  34
eH1_5 4.050442e-02                 1 1 ON  35
eH1_6 9.794178e-02                 1 1 ON  36
eH1_7 1.511085e-01                 1 1 ON  37
eH1_8 1.738399e-01                 1 1 ON  38
eH1_9 5.911475e-02                 1 1 ON  39
eH2_0 -2.389840e-01                1 1 ON  40
eH2_1 -1.391163e-01                1 1 ON  41
eH2_2 -9.210404e-02                1 1 ON  42
eH2_3 -3.795841e-02                1 1 ON  43
eH2_4 9.807974e-03                 1 1 ON  44
eH2_5 4.296073e-02                 1 1 ON  45
eH2_6 9.874162e-02                 1 1 ON  46
eH2_7 1.505204e-01                 1 1 ON  47
eH2_8 1.767638e-01                 1 1 ON  48
eH2_9 4.663624e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.3425
====================================================
  Execution time = 3.6136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4524e-01
  Total weights = 2.0000e+06
  Execution time = 3.3684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345381573685
                                         uncertainty =       0.006467725063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345381573685
                                         uncertainty =       0.006467725063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415535839
  error estimate for blocks of size 2^( 2) =       0.000428091239
  error estimate for blocks of size 2^( 3) =       0.000441067640
  error estimate for blocks of size 2^( 4) =       0.000453160206
  error estimate for blocks of size 2^( 5) =       0.000463993642
  error estimate for blocks of size 2^( 6) =       0.000471990053
  error estimate for blocks of size 2^( 7) =       0.000476995199

      target function =                  N/A
              le_mean =     -16.906307185281
             les_mean =     286.168562537743
             stat err =       0.000466534775
             autocorr =       1.260523853386
              std dev =       0.587656419464
             le_variance =       0.345340067337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345192622960
                                         uncertainty =       0.006460769422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345192622960
                                         uncertainty =       0.006460769422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415422261
  error estimate for blocks of size 2^( 2) =       0.000427979423
  error estimate for blocks of size 2^( 3) =       0.000440955800
  error estimate for blocks of size 2^( 4) =       0.000453057229
  error estimate for blocks of size 2^( 5) =       0.000463895919
  error estimate for blocks of size 2^( 6) =       0.000471902951
  error estimate for blocks of size 2^( 7) =       0.000476901967

      target function =                  N/A
              le_mean =     -16.906310386065
             les_mean =     286.168482007860
             stat err =       0.000466439517
             autocorr =       1.260698228676
              std dev =       0.587495796140
             le_variance =       0.345151310483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345180364232
                                         uncertainty =       0.006460851765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345180364232
                                         uncertainty =       0.006460851765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415414885
  error estimate for blocks of size 2^( 2) =       0.000427973396
  error estimate for blocks of size 2^( 3) =       0.000440950801
  error estimate for blocks of size 2^( 4) =       0.000453051558
  error estimate for blocks of size 2^( 5) =       0.000463889197
  error estimate for blocks of size 2^( 6) =       0.000471894958
  error estimate for blocks of size 2^( 7) =       0.000476893413

      target function =                  N/A
              le_mean =     -16.906309690073
             les_mean =     286.168446217425
             stat err =       0.000466432281
             autocorr =       1.260703887472
              std dev =       0.587485364358
             le_variance =       0.345139053335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345349991340
                                         uncertainty =       0.006466626260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345349991340
                                         uncertainty =       0.006466626260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415516857
  error estimate for blocks of size 2^( 2) =       0.000428072754
  error estimate for blocks of size 2^( 3) =       0.000441049307
  error estimate for blocks of size 2^( 4) =       0.000453143098
  error estimate for blocks of size 2^( 5) =       0.000463977094
  error estimate for blocks of size 2^( 6) =       0.000471974925
  error estimate for blocks of size 2^( 7) =       0.000476978937

      target function =                  N/A
              le_mean =     -16.906307520770
             les_mean =     286.168542330608
             stat err =       0.000466518513
             autocorr =       1.260551147442
              std dev =       0.587629574156
             le_variance =       0.345308516423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906307185281        initial
     2.5000e-01     2.5000e+00             1.0273e-03       -16.906310386065  <--
     1.0000e+00     1.0000e+01             2.5367e-04       -16.906309690073
     4.0000e+00     4.0000e+01             6.4488e-05       -16.906307520770

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.3116e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.091792e-01 1 1  ON 0
 uu_1                 1.427250e-01 1 1  ON 1
 uu_2                 4.128529e-02 1 1  ON 2
 uu_3                -2.114929e-02 1 1  ON 3
 uu_4                -6.617954e-02 1 1  ON 4
 uu_5                -1.001433e-01 1 1  ON 5
 uu_6                -1.268221e-01 1 1  ON 6
 uu_7                -1.398328e-01 1 1  ON 7
 uu_8                -1.320209e-01 1 1  ON 8
 uu_9                -1.020006e-01 1 1  ON 9
 ud_0                 4.496437e-01 1 1  ON 10
 ud_1                 1.833518e-01 1 1  ON 11
 ud_2                 6.201810e-02 1 1  ON 12
 ud_3                -9.904938e-03 1 1  ON 13
 ud_4                -6.698130e-02 1 1  ON 14
 ud_5                -1.082002e-01 1 1  ON 15
 ud_6                -1.352825e-01 1 1  ON 16
 ud_7                -1.512326e-01 1 1  ON 17
 ud_8                -1.515550e-01 1 1  ON 18
 ud_9                -1.402537e-01 1 1  ON 19
 eO_0                -7.655304e-01 1 1  ON 20
 eO_1                -4.431596e-01 1 1  ON 21
 eO_2                -2.024433e-02 1 1  ON 22
 eO_3                 3.022970e-01 1 1  ON 23
 eO_4                 5.276232e-01 1 1  ON 24
 eO_5                 4.869108e-01 1 1  ON 25
 eO_6                 2.566226e-01 1 1  ON 26
 eO_7                -4.613882e-02 1 1  ON 27
 eO_8                -2.197087e-01 1 1  ON 28
 eO_9                -7.862508e-02 1 1  ON 29
eH1_0                -2.439307e-01 1 1  ON 30
eH1_1                -1.429611e-01 1 1  ON 31
eH1_2                -9.619021e-02 1 1  ON 32
eH1_3                -4.191917e-02 1 1  ON 33
eH1_4                 5.752064e-03 1 1  ON 34
eH1_5                 4.031787e-02 1 1  ON 35
eH1_6                 9.800333e-02 1 1  ON 36
eH1_7                 1.513218e-01 1 1  ON 37
eH1_8                 1.740969e-01 1 1  ON 38
eH1_9                 5.959209e-02 1 1  ON 39
eH2_0                -2.394454e-01 1 1  ON 40
eH2_1                -1.393698e-01 1 1  ON 41
eH2_2                -9.215215e-02 1 1  ON 42
eH2_3                -3.803018e-02 1 1  ON 43
eH2_4                 9.637689e-03 1 1  ON 44
eH2_5                 4.294100e-02 1 1  ON 45
eH2_6                 9.859204e-02 1 1  ON 46
eH2_7                 1.505419e-01 1 1  ON 47
eH2_8                 1.770565e-01 1 1  ON 48
eH2_9                 4.740986e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0021e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6859e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.181677
====================================================
  Execution time = 3.6793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0039e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335014733170
                                         uncertainty =       0.002712726259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335014733170
                                         uncertainty =       0.002712726259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409286018
  error estimate for blocks of size 2^( 2) =       0.000422358869
  error estimate for blocks of size 2^( 3) =       0.000434949660
  error estimate for blocks of size 2^( 4) =       0.000447195103
  error estimate for blocks of size 2^( 5) =       0.000457703039
  error estimate for blocks of size 2^( 6) =       0.000466038043
  error estimate for blocks of size 2^( 7) =       0.000470290365

      target function =                  N/A
              le_mean =     -16.905217053128
             les_mean =     286.121393534389
             stat err =       0.000460306638
             autocorr =       1.264854756591
              std dev =       0.578817837094
             le_variance =       0.335030088538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690521705313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905217053128       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905219753528       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905218638311       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905220456193       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905226233037       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905225158250       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905226351612       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905226461952       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905226276191       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905225940300       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905225885087       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905226654484       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905226811739       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.572864e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905217053128       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905218680571       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905218370617       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905218139995       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905220714389       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905221075934       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905220833369       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905221290227       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905220784550       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905220819125       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.918192e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905217053128       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905217681647       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905217675309       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905217356328       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905217602648       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905218199457       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905218137426       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905218205170       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905218150755       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.955020e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6842e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.096250e-01 1 1  ON 0
 uu_1                 1.428000e-01 1 1  ON 1
 uu_2                 4.122586e-02 1 1  ON 2
 uu_3                -2.103401e-02 1 1  ON 3
 uu_4                -6.613059e-02 1 1  ON 4
 uu_5                -1.002092e-01 1 1  ON 5
 uu_6                -1.271133e-01 1 1  ON 6
 uu_7                -1.401012e-01 1 1  ON 7
 uu_8                -1.322236e-01 1 1  ON 8
 uu_9                -1.023376e-01 1 1  ON 9
 ud_0                 4.498731e-01 1 1  ON 10
 ud_1                 1.835370e-01 1 1  ON 11
 ud_2                 6.210099e-02 1 1  ON 12
 ud_3                -9.826431e-03 1 1  ON 13
 ud_4                -6.685031e-02 1 1  ON 14
 ud_5                -1.081066e-01 1 1  ON 15
 ud_6                -1.350410e-01 1 1  ON 16
 ud_7                -1.512216e-01 1 1  ON 17
 ud_8                -1.520650e-01 1 1  ON 18
 ud_9                -1.405847e-01 1 1  ON 19
 eO_0                -7.655422e-01 1 1  ON 20
 eO_1                -4.429074e-01 1 1  ON 21
 eO_2                -2.032594e-02 1 1  ON 22
 eO_3                 3.020615e-01 1 1  ON 23
 eO_4                 5.276576e-01 1 1  ON 24
 eO_5                 4.872024e-01 1 1  ON 25
 eO_6                 2.573086e-01 1 1  ON 26
 eO_7                -4.605487e-02 1 1  ON 27
 eO_8                -2.201759e-01 1 1  ON 28
 eO_9                -7.909798e-02 1 1  ON 29
eH1_0                -2.443743e-01 1 1  ON 30
eH1_1                -1.433367e-01 1 1  ON 31
eH1_2                -9.621000e-02 1 1  ON 32
eH1_3                -4.185789e-02 1 1  ON 33
eH1_4                 5.882657e-03 1 1  ON 34
eH1_5                 4.001505e-02 1 1  ON 35
eH1_6                 9.792160e-02 1 1  ON 36
eH1_7                 1.513921e-01 1 1  ON 37
eH1_8                 1.744162e-01 1 1  ON 38
eH1_9                 6.023526e-02 1 1  ON 39
eH2_0                -2.401372e-01 1 1  ON 40
eH2_1                -1.396182e-01 1 1  ON 41
eH2_2                -9.232043e-02 1 1  ON 42
eH2_3                -3.817606e-02 1 1  ON 43
eH2_4                 9.522927e-03 1 1  ON 44
eH2_5                 4.254784e-02 1 1  ON 45
eH2_6                 9.875997e-02 1 1  ON 46
eH2_7                 1.511293e-01 1 1  ON 47
eH2_8                 1.773992e-01 1 1  ON 48
eH2_9                 4.800922e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.216342
====================================================
  Execution time = 3.6276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3954e-01
  Total weights = 2.0000e+06
  Execution time = 3.3724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339427725193
                                         uncertainty =       0.003117895488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339427725193
                                         uncertainty =       0.003117895488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411925631
  error estimate for blocks of size 2^( 2) =       0.000424164144
  error estimate for blocks of size 2^( 3) =       0.000436932168
  error estimate for blocks of size 2^( 4) =       0.000449023857
  error estimate for blocks of size 2^( 5) =       0.000459187192
  error estimate for blocks of size 2^( 6) =       0.000464685082
  error estimate for blocks of size 2^( 7) =       0.000468360484

      target function =                  N/A
              le_mean =     -16.906554617652
             les_mean =     286.170954320138
             stat err =       0.000460314154
             autocorr =       1.248737134982
              std dev =       0.582550813366
             le_variance =       0.339365450154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339707201823
                                         uncertainty =       0.003119480638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339707201823
                                         uncertainty =       0.003119480638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412095072
  error estimate for blocks of size 2^( 2) =       0.000424318551
  error estimate for blocks of size 2^( 3) =       0.000437068301
  error estimate for blocks of size 2^( 4) =       0.000449143788
  error estimate for blocks of size 2^( 5) =       0.000459292756
  error estimate for blocks of size 2^( 6) =       0.000464805027
  error estimate for blocks of size 2^( 7) =       0.000468466013

      target function =                  N/A
              le_mean =     -16.906552031651
             les_mean =     286.171146125984
             stat err =       0.000460426896
             autocorr =       1.248321723164
              std dev =       0.582790439934
             le_variance =       0.339644696878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339783451048
                                         uncertainty =       0.003119901039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339783451048
                                         uncertainty =       0.003119901039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412141304
  error estimate for blocks of size 2^( 2) =       0.000424364344
  error estimate for blocks of size 2^( 3) =       0.000437115650
  error estimate for blocks of size 2^( 4) =       0.000449192862
  error estimate for blocks of size 2^( 5) =       0.000459341998
  error estimate for blocks of size 2^( 6) =       0.000464852400
  error estimate for blocks of size 2^( 7) =       0.000468514535

      target function =                  N/A
              le_mean =     -16.906551763418
             les_mean =     286.171213267700
             stat err =       0.000460475449
             autocorr =       1.248304909596
              std dev =       0.582855821312
             le_variance =       0.339720908438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507621525
                                         uncertainty =       0.003118433428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507621525
                                         uncertainty =       0.003118433428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411974084
  error estimate for blocks of size 2^( 2) =       0.000424209500
  error estimate for blocks of size 2^( 3) =       0.000436974248
  error estimate for blocks of size 2^( 4) =       0.000449062885
  error estimate for blocks of size 2^( 5) =       0.000459223169
  error estimate for blocks of size 2^( 6) =       0.000464722990
  error estimate for blocks of size 2^( 7) =       0.000468396066

      target function =                  N/A
              le_mean =     -16.906553702212
             les_mean =     286.171003208609
             stat err =       0.000460351278
             autocorr =       1.248644794323
              std dev =       0.582619337600
             le_variance =       0.339445292545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906554617652        initial  <--
     6.2500e-02     6.2500e-01             2.5729e-03       -16.906552031651
     2.5000e-01     2.5000e+00             6.9182e-04       -16.906551763418
     1.0000e+00     1.0000e+01             1.9550e-04       -16.906553702212

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2458
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091792e-01 1 1  ON 0
 uu_1                 1.427250e-01 1 1  ON 1
 uu_2                 4.128529e-02 1 1  ON 2
 uu_3                -2.114929e-02 1 1  ON 3
 uu_4                -6.617954e-02 1 1  ON 4
 uu_5                -1.001433e-01 1 1  ON 5
 uu_6                -1.268221e-01 1 1  ON 6
 uu_7                -1.398328e-01 1 1  ON 7
 uu_8                -1.320209e-01 1 1  ON 8
 uu_9                -1.020006e-01 1 1  ON 9
 ud_0                 4.496437e-01 1 1  ON 10
 ud_1                 1.833518e-01 1 1  ON 11
 ud_2                 6.201810e-02 1 1  ON 12
 ud_3                -9.904938e-03 1 1  ON 13
 ud_4                -6.698130e-02 1 1  ON 14
 ud_5                -1.082002e-01 1 1  ON 15
 ud_6                -1.352825e-01 1 1  ON 16
 ud_7                -1.512326e-01 1 1  ON 17
 ud_8                -1.515550e-01 1 1  ON 18
 ud_9                -1.402537e-01 1 1  ON 19
 eO_0                -7.655304e-01 1 1  ON 20
 eO_1                -4.431596e-01 1 1  ON 21
 eO_2                -2.024433e-02 1 1  ON 22
 eO_3                 3.022970e-01 1 1  ON 23
 eO_4                 5.276232e-01 1 1  ON 24
 eO_5                 4.869108e-01 1 1  ON 25
 eO_6                 2.566226e-01 1 1  ON 26
 eO_7                -4.613882e-02 1 1  ON 27
 eO_8                -2.197087e-01 1 1  ON 28
 eO_9                -7.862508e-02 1 1  ON 29
eH1_0                -2.439307e-01 1 1  ON 30
eH1_1                -1.429611e-01 1 1  ON 31
eH1_2                -9.619021e-02 1 1  ON 32
eH1_3                -4.191917e-02 1 1  ON 33
eH1_4                 5.752064e-03 1 1  ON 34
eH1_5                 4.031787e-02 1 1  ON 35
eH1_6                 9.800333e-02 1 1  ON 36
eH1_7                 1.513218e-01 1 1  ON 37
eH1_8                 1.740969e-01 1 1  ON 38
eH1_9                 5.959209e-02 1 1  ON 39
eH2_0                -2.394454e-01 1 1  ON 40
eH2_1                -1.393698e-01 1 1  ON 41
eH2_2                -9.215215e-02 1 1  ON 42
eH2_3                -3.803018e-02 1 1  ON 43
eH2_4                 9.637689e-03 1 1  ON 44
eH2_5                 4.294100e-02 1 1  ON 45
eH2_6                 9.859204e-02 1 1  ON 46
eH2_7                 1.505419e-01 1 1  ON 47
eH2_8                 1.770565e-01 1 1  ON 48
eH2_9                 4.740986e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0010e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.310341
====================================================
  Execution time = 3.6605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0180e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341845490029
                                         uncertainty =       0.004454232754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341845490029
                                         uncertainty =       0.004454232754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413454168
  error estimate for blocks of size 2^( 2) =       0.000426056857
  error estimate for blocks of size 2^( 3) =       0.000439309781
  error estimate for blocks of size 2^( 4) =       0.000452100785
  error estimate for blocks of size 2^( 5) =       0.000462857494
  error estimate for blocks of size 2^( 6) =       0.000471679738
  error estimate for blocks of size 2^( 7) =       0.000477599730

      target function =                  N/A
              le_mean =     -16.906247929263
             les_mean =     286.163107572949
             stat err =       0.000466059437
             autocorr =       1.270655624342
              std dev =       0.584712491902
             le_variance =       0.341888698186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624792926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247929263       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248920083       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906248779490       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906248597719       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906248500831       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248634342       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906248812574       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906248811714       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.573177e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247929263       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248226355       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906248186084       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906248140414       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906248099412       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248135675       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906248176575       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906248173571       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.204983e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247929263       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248007432       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906247997328       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906247985949       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906247974150       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906247983210       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906247993272       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.230384e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6793e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.092185e-01 1 1  ON 0
 uu_1                 1.427358e-01 1 1  ON 1
 uu_2                 4.127648e-02 1 1  ON 2
 uu_3                -2.113045e-02 1 1  ON 3
 uu_4                -6.618823e-02 1 1  ON 4
 uu_5                -1.001839e-01 1 1  ON 5
 uu_6                -1.268731e-01 1 1  ON 6
 uu_7                -1.398610e-01 1 1  ON 7
 uu_8                -1.320135e-01 1 1  ON 8
 uu_9                -1.020107e-01 1 1  ON 9
 ud_0                 4.496475e-01 1 1  ON 10
 ud_1                 1.833679e-01 1 1  ON 11
 ud_2                 6.201922e-02 1 1  ON 12
 ud_3                -9.880340e-03 1 1  ON 13
 ud_4                -6.697116e-02 1 1  ON 14
 ud_5                -1.082087e-01 1 1  ON 15
 ud_6                -1.352487e-01 1 1  ON 16
 ud_7                -1.512337e-01 1 1  ON 17
 ud_8                -1.515558e-01 1 1  ON 18
 ud_9                -1.402778e-01 1 1  ON 19
 eO_0                -7.655039e-01 1 1  ON 20
 eO_1                -4.430960e-01 1 1  ON 21
 eO_2                -2.027518e-02 1 1  ON 22
 eO_3                 3.022535e-01 1 1  ON 23
 eO_4                 5.276430e-01 1 1  ON 24
 eO_5                 4.869285e-01 1 1  ON 25
 eO_6                 2.566195e-01 1 1  ON 26
 eO_7                -4.609214e-02 1 1  ON 27
 eO_8                -2.197399e-01 1 1  ON 28
 eO_9                -7.868144e-02 1 1  ON 29
eH1_0                -2.439691e-01 1 1  ON 30
eH1_1                -1.429797e-01 1 1  ON 31
eH1_2                -9.619294e-02 1 1  ON 32
eH1_3                -4.194854e-02 1 1  ON 33
eH1_4                 5.764518e-03 1 1  ON 34
eH1_5                 4.026012e-02 1 1  ON 35
eH1_6                 9.802481e-02 1 1  ON 36
eH1_7                 1.513142e-01 1 1  ON 37
eH1_8                 1.741331e-01 1 1  ON 38
eH1_9                 5.966141e-02 1 1  ON 39
eH2_0                -2.394933e-01 1 1  ON 40
eH2_1                -1.393644e-01 1 1  ON 41
eH2_2                -9.218243e-02 1 1  ON 42
eH2_3                -3.806960e-02 1 1  ON 43
eH2_4                 9.609952e-03 1 1  ON 44
eH2_5                 4.292263e-02 1 1  ON 45
eH2_6                 9.861633e-02 1 1  ON 46
eH2_7                 1.505293e-01 1 1  ON 47
eH2_8                 1.771007e-01 1 1  ON 48
eH2_9                 4.750191e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8527
    reference variance = 0.28612
====================================================
  Execution time = 3.8870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3610e-01
  Total weights = 2.0000e+06
  Execution time = 3.3666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336173481632
                                         uncertainty =       0.002738327449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336173481632
                                         uncertainty =       0.002738327449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409931828
  error estimate for blocks of size 2^( 2) =       0.000422609088
  error estimate for blocks of size 2^( 3) =       0.000435363099
  error estimate for blocks of size 2^( 4) =       0.000448023456
  error estimate for blocks of size 2^( 5) =       0.000458834925
  error estimate for blocks of size 2^( 6) =       0.000466281184
  error estimate for blocks of size 2^( 7) =       0.000471654032

      target function =                  N/A
              le_mean =     -16.905645422165
             les_mean =     286.136935179321
             stat err =       0.000461198399
             autocorr =       1.265762730367
              std dev =       0.579731150962
             le_variance =       0.336088207396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336204141219
                                         uncertainty =       0.002738668249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336204141219
                                         uncertainty =       0.002738668249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409950536
  error estimate for blocks of size 2^( 2) =       0.000422625398
  error estimate for blocks of size 2^( 3) =       0.000435377498
  error estimate for blocks of size 2^( 4) =       0.000448035848
  error estimate for blocks of size 2^( 5) =       0.000458847009
  error estimate for blocks of size 2^( 6) =       0.000466297293
  error estimate for blocks of size 2^( 7) =       0.000471669857

      target function =                  N/A
              le_mean =     -16.905645371331
             les_mean =     286.136964137015
             stat err =       0.000461212501
             autocorr =       1.265724609074
              std dev =       0.579757607869
             le_variance =       0.336118883882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336197889171
                                         uncertainty =       0.002738585075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336197889171
                                         uncertainty =       0.002738585075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409946720
  error estimate for blocks of size 2^( 2) =       0.000422622311
  error estimate for blocks of size 2^( 3) =       0.000435375163
  error estimate for blocks of size 2^( 4) =       0.000448034050
  error estimate for blocks of size 2^( 5) =       0.000458845302
  error estimate for blocks of size 2^( 6) =       0.000466293806
  error estimate for blocks of size 2^( 7) =       0.000471666276

      target function =                  N/A
              le_mean =     -16.905645314597
             les_mean =     286.136955961424
             stat err =       0.000461209859
             autocorr =       1.265733667326
              std dev =       0.579752211321
             le_variance =       0.336112626532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336177069484
                                         uncertainty =       0.002738366701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336177069484
                                         uncertainty =       0.002738366701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409934017
  error estimate for blocks of size 2^( 2) =       0.000422611035
  error estimate for blocks of size 2^( 3) =       0.000435364893
  error estimate for blocks of size 2^( 4) =       0.000448025028
  error estimate for blocks of size 2^( 5) =       0.000458836482
  error estimate for blocks of size 2^( 6) =       0.000466283044
  error estimate for blocks of size 2^( 7) =       0.000471655826

      target function =                  N/A
              le_mean =     -16.905645395721
             les_mean =     286.136937874413
             stat err =       0.000461200095
             autocorr =       1.265758520307
              std dev =       0.579734246512
             le_variance =       0.336091796579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905645422165        initial  <--
     6.2500e-01     6.2500e+00             3.5732e-04       -16.905645371331
     2.5000e+00     2.5000e+01             9.2050e-05       -16.905645314597
     1.0000e+01     1.0000e+02             2.2304e-05       -16.905645395721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.7936
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.091792e-01 1 1  ON 0
 uu_1                 1.427250e-01 1 1  ON 1
 uu_2                 4.128529e-02 1 1  ON 2
 uu_3                -2.114929e-02 1 1  ON 3
 uu_4                -6.617954e-02 1 1  ON 4
 uu_5                -1.001433e-01 1 1  ON 5
 uu_6                -1.268221e-01 1 1  ON 6
 uu_7                -1.398328e-01 1 1  ON 7
 uu_8                -1.320209e-01 1 1  ON 8
 uu_9                -1.020006e-01 1 1  ON 9
 ud_0                 4.496437e-01 1 1  ON 10
 ud_1                 1.833518e-01 1 1  ON 11
 ud_2                 6.201810e-02 1 1  ON 12
 ud_3                -9.904938e-03 1 1  ON 13
 ud_4                -6.698130e-02 1 1  ON 14
 ud_5                -1.082002e-01 1 1  ON 15
 ud_6                -1.352825e-01 1 1  ON 16
 ud_7                -1.512326e-01 1 1  ON 17
 ud_8                -1.515550e-01 1 1  ON 18
 ud_9                -1.402537e-01 1 1  ON 19
 eO_0                -7.655304e-01 1 1  ON 20
 eO_1                -4.431596e-01 1 1  ON 21
 eO_2                -2.024433e-02 1 1  ON 22
 eO_3                 3.022970e-01 1 1  ON 23
 eO_4                 5.276232e-01 1 1  ON 24
 eO_5                 4.869108e-01 1 1  ON 25
 eO_6                 2.566226e-01 1 1  ON 26
 eO_7                -4.613882e-02 1 1  ON 27
 eO_8                -2.197087e-01 1 1  ON 28
 eO_9                -7.862508e-02 1 1  ON 29
eH1_0                -2.439307e-01 1 1  ON 30
eH1_1                -1.429611e-01 1 1  ON 31
eH1_2                -9.619021e-02 1 1  ON 32
eH1_3                -4.191917e-02 1 1  ON 33
eH1_4                 5.752064e-03 1 1  ON 34
eH1_5                 4.031787e-02 1 1  ON 35
eH1_6                 9.800333e-02 1 1  ON 36
eH1_7                 1.513218e-01 1 1  ON 37
eH1_8                 1.740969e-01 1 1  ON 38
eH1_9                 5.959209e-02 1 1  ON 39
eH2_0                -2.394454e-01 1 1  ON 40
eH2_1                -1.393698e-01 1 1  ON 41
eH2_2                -9.215215e-02 1 1  ON 42
eH2_3                -3.803018e-02 1 1  ON 43
eH2_4                 9.637689e-03 1 1  ON 44
eH2_5                 4.294100e-02 1 1  ON 45
eH2_6                 9.859204e-02 1 1  ON 46
eH2_7                 1.505419e-01 1 1  ON 47
eH2_8                 1.770565e-01 1 1  ON 48
eH2_9                 4.740986e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0260e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8654
    reference variance = 0.192807
====================================================
  Execution time = 3.7052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 5.4797e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0084e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.548380381893
                                         uncertainty =       0.204514864214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.548380381893
                                         uncertainty =       0.204514864214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000523437837
  error estimate for blocks of size 2^( 2) =       0.000533241387
  error estimate for blocks of size 2^( 3) =       0.000543825419
  error estimate for blocks of size 2^( 4) =       0.000553866827
  error estimate for blocks of size 2^( 5) =       0.000561945815
  error estimate for blocks of size 2^( 6) =       0.000568108413
  error estimate for blocks of size 2^( 7) =       0.000570125059

      target function =                  N/A
              le_mean =     -16.907061480137
             les_mean =     286.396701956569
             stat err =       0.000563511529
             autocorr =       1.158978518596
              std dev =       0.740252887475
             le_variance =       0.547974337415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690706148014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907061480137       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907061426263       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907061365288       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907061328758       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907061356704       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907061415115       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907061414331       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907061407877       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.717801e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907061480137       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907061466469       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907061450320       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907061440457       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907061447238       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907061461851       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907061461846       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907061460264       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.514524e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907061480137       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907061476707       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907061472610       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907061470097       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907061471774       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907061475427       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907061475440       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907061475047       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.393114e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7143e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091827e-01 1 1  ON 0
 uu_1                 1.427233e-01 1 1  ON 1
 uu_2                 4.128724e-02 1 1  ON 2
 uu_3                -2.114811e-02 1 1  ON 3
 uu_4                -6.617708e-02 1 1  ON 4
 uu_5                -1.001478e-01 1 1  ON 5
 uu_6                -1.268226e-01 1 1  ON 6
 uu_7                -1.398349e-01 1 1  ON 7
 uu_8                -1.320248e-01 1 1  ON 8
 uu_9                -1.020040e-01 1 1  ON 9
 ud_0                 4.496478e-01 1 1  ON 10
 ud_1                 1.833522e-01 1 1  ON 11
 ud_2                 6.202472e-02 1 1  ON 12
 ud_3                -9.905587e-03 1 1  ON 13
 ud_4                -6.698119e-02 1 1  ON 14
 ud_5                -1.081976e-01 1 1  ON 15
 ud_6                -1.352829e-01 1 1  ON 16
 ud_7                -1.512409e-01 1 1  ON 17
 ud_8                -1.515583e-01 1 1  ON 18
 ud_9                -1.402538e-01 1 1  ON 19
 eO_0                -7.655250e-01 1 1  ON 20
 eO_1                -4.431564e-01 1 1  ON 21
 eO_2                -2.024987e-02 1 1  ON 22
 eO_3                 3.022978e-01 1 1  ON 23
 eO_4                 5.276221e-01 1 1  ON 24
 eO_5                 4.869161e-01 1 1  ON 25
 eO_6                 2.566252e-01 1 1  ON 26
 eO_7                -4.613939e-02 1 1  ON 27
 eO_8                -2.197148e-01 1 1  ON 28
 eO_9                -7.862924e-02 1 1  ON 29
eH1_0                -2.439338e-01 1 1  ON 30
eH1_1                -1.429625e-01 1 1  ON 31
eH1_2                -9.619265e-02 1 1  ON 32
eH1_3                -4.192476e-02 1 1  ON 33
eH1_4                 5.754023e-03 1 1  ON 34
eH1_5                 4.031244e-02 1 1  ON 35
eH1_6                 9.800267e-02 1 1  ON 36
eH1_7                 1.513254e-01 1 1  ON 37
eH1_8                 1.741029e-01 1 1  ON 38
eH1_9                 5.959923e-02 1 1  ON 39
eH2_0                -2.394466e-01 1 1  ON 40
eH2_1                -1.393725e-01 1 1  ON 41
eH2_2                -9.216167e-02 1 1  ON 42
eH2_3                -3.802896e-02 1 1  ON 43
eH2_4                 9.639891e-03 1 1  ON 44
eH2_5                 4.294181e-02 1 1  ON 45
eH2_6                 9.859351e-02 1 1  ON 46
eH2_7                 1.505406e-01 1 1  ON 47
eH2_8                 1.770569e-01 1 1  ON 48
eH2_9                 4.741726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9865
    reference variance = 0.388139
====================================================
  Execution time = 3.6105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4627e-01
  Total weights = 2.0000e+06
  Execution time = 3.3745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195115792
                                         uncertainty =       0.004823818373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195115792
                                         uncertainty =       0.004823818373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416093123
  error estimate for blocks of size 2^( 2) =       0.000428688627
  error estimate for blocks of size 2^( 3) =       0.000441592228
  error estimate for blocks of size 2^( 4) =       0.000453613120
  error estimate for blocks of size 2^( 5) =       0.000463706569
  error estimate for blocks of size 2^( 6) =       0.000470234799
  error estimate for blocks of size 2^( 7) =       0.000474496497

      target function =                  N/A
              le_mean =     -16.906065937489
             les_mean =     286.161332283423
             stat err =       0.000465512746
             autocorr =       1.251647619743
              std dev =       0.588444537599
             le_variance =       0.346266973830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195763702
                                         uncertainty =       0.004823981403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195763702
                                         uncertainty =       0.004823981403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416093510
  error estimate for blocks of size 2^( 2) =       0.000428689230
  error estimate for blocks of size 2^( 3) =       0.000441592898
  error estimate for blocks of size 2^( 4) =       0.000453613718
  error estimate for blocks of size 2^( 5) =       0.000463707317
  error estimate for blocks of size 2^( 6) =       0.000470235785
  error estimate for blocks of size 2^( 7) =       0.000474498364

      target function =                  N/A
              le_mean =     -16.906066033549
             les_mean =     286.161336175260
             stat err =       0.000465513796
             autocorr =       1.251650937361
              std dev =       0.588445084672
             le_variance =       0.346267617674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195428987
                                         uncertainty =       0.004823902211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195428987
                                         uncertainty =       0.004823902211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416093310
  error estimate for blocks of size 2^( 2) =       0.000428688930
  error estimate for blocks of size 2^( 3) =       0.000441592573
  error estimate for blocks of size 2^( 4) =       0.000453613432
  error estimate for blocks of size 2^( 5) =       0.000463706964
  error estimate for blocks of size 2^( 6) =       0.000470235324
  error estimate for blocks of size 2^( 7) =       0.000474497482

      target function =                  N/A
              le_mean =     -16.906065987468
             les_mean =     286.161334284447
             stat err =       0.000465513300
             autocorr =       1.251649475425
              std dev =       0.588444801973
             le_variance =       0.346267284969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195153815
                                         uncertainty =       0.004823828928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346195153815
                                         uncertainty =       0.004823828928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416093146
  error estimate for blocks of size 2^( 2) =       0.000428688664
  error estimate for blocks of size 2^( 3) =       0.000441592271
  error estimate for blocks of size 2^( 4) =       0.000453613159
  error estimate for blocks of size 2^( 5) =       0.000463706618
  error estimate for blocks of size 2^( 6) =       0.000470234865
  error estimate for blocks of size 2^( 7) =       0.000474496621

      target function =                  N/A
              le_mean =     -16.906065943718
             les_mean =     286.161332531817
             stat err =       0.000465512816
             autocorr =       1.251647858530
              std dev =       0.588444569689
             le_variance =       0.346267011596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906065937489        initial
     6.2500e+00     6.2500e+01             3.7178e-05       -16.906066033549  <--
     2.5000e+01     2.5000e+02             9.5145e-06       -16.906065987468
     1.0000e+02     1.0000e+03             2.3931e-06       -16.906065943718

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 5.3101e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091929e-01 1 1  ON 0
 uu_1                 1.427188e-01 1 1  ON 1
 uu_2                 4.129287e-02 1 1  ON 2
 uu_3                -2.114461e-02 1 1  ON 3
 uu_4                -6.617001e-02 1 1  ON 4
 uu_5                -1.001608e-01 1 1  ON 5
 uu_6                -1.268241e-01 1 1  ON 6
 uu_7                -1.398411e-01 1 1  ON 7
 uu_8                -1.320365e-01 1 1  ON 8
 uu_9                -1.020142e-01 1 1  ON 9
 ud_0                 4.496598e-01 1 1  ON 10
 ud_1                 1.833541e-01 1 1  ON 11
 ud_2                 6.204358e-02 1 1  ON 12
 ud_3                -9.906813e-03 1 1  ON 13
 ud_4                -6.698070e-02 1 1  ON 14
 ud_5                -1.081904e-01 1 1  ON 15
 ud_6                -1.352840e-01 1 1  ON 16
 ud_7                -1.512655e-01 1 1  ON 17
 ud_8                -1.515680e-01 1 1  ON 18
 ud_9                -1.402541e-01 1 1  ON 19
 eO_0                -7.655089e-01 1 1  ON 20
 eO_1                -4.431470e-01 1 1  ON 21
 eO_2                -2.026574e-02 1 1  ON 22
 eO_3                 3.022999e-01 1 1  ON 23
 eO_4                 5.276191e-01 1 1  ON 24
 eO_5                 4.869318e-01 1 1  ON 25
 eO_6                 2.566333e-01 1 1  ON 26
 eO_7                -4.614106e-02 1 1  ON 27
 eO_8                -2.197331e-01 1 1  ON 28
 eO_9                -7.864166e-02 1 1  ON 29
eH1_0                -2.439431e-01 1 1  ON 30
eH1_1                -1.429667e-01 1 1  ON 31
eH1_2                -9.620012e-02 1 1  ON 32
eH1_3                -4.194109e-02 1 1  ON 33
eH1_4                 5.759644e-03 1 1  ON 34
eH1_5                 4.029632e-02 1 1  ON 35
eH1_6                 9.800068e-02 1 1  ON 36
eH1_7                 1.513361e-01 1 1  ON 37
eH1_8                 1.741209e-01 1 1  ON 38
eH1_9                 5.962053e-02 1 1  ON 39
eH2_0                -2.394503e-01 1 1  ON 40
eH2_1                -1.393809e-01 1 1  ON 41
eH2_2                -9.218933e-02 1 1  ON 42
eH2_3                -3.802574e-02 1 1  ON 43
eH2_4                 9.646527e-03 1 1  ON 44
eH2_5                 4.294434e-02 1 1  ON 45
eH2_6                 9.859790e-02 1 1  ON 46
eH2_7                 1.505369e-01 1 1  ON 47
eH2_8                 1.770580e-01 1 1  ON 48
eH2_9                 4.743934e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0025e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9237
    reference variance = 0.20267
====================================================
  Execution time = 3.6902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0110e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337221765893
                                         uncertainty =       0.003279372385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337221765893
                                         uncertainty =       0.003279372385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647583
  error estimate for blocks of size 2^( 2) =       0.000423299076
  error estimate for blocks of size 2^( 3) =       0.000436749661
  error estimate for blocks of size 2^( 4) =       0.000449428565
  error estimate for blocks of size 2^( 5) =       0.000460333242
  error estimate for blocks of size 2^( 6) =       0.000469383367
  error estimate for blocks of size 2^( 7) =       0.000476427795

      target function =                  N/A
              le_mean =     -16.906703639166
             les_mean =     286.173890648201
             stat err =       0.000463893242
             autocorr =       1.276137735070
              std dev =       0.580743380728
             le_variance =       0.337262874260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670363917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703639166       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703461197       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703397940       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703712666       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906704052772       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703951563       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703844401       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703907812       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.559216e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703639166       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703591122       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703570473       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703648912       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703738911       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703715228       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703687635       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703702168       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.101107e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703639166       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703626910       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703621370       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703640933       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703663672       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703657881       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703651038       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.026760e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7020e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091785e-01 1 1  ON 0
 uu_1                 1.427278e-01 1 1  ON 1
 uu_2                 4.130300e-02 1 1  ON 2
 uu_3                -2.113261e-02 1 1  ON 3
 uu_4                -6.616934e-02 1 1  ON 4
 uu_5                -1.001778e-01 1 1  ON 5
 uu_6                -1.268390e-01 1 1  ON 6
 uu_7                -1.398335e-01 1 1  ON 7
 uu_8                -1.320383e-01 1 1  ON 8
 uu_9                -1.020272e-01 1 1  ON 9
 ud_0                 4.496469e-01 1 1  ON 10
 ud_1                 1.833550e-01 1 1  ON 11
 ud_2                 6.205363e-02 1 1  ON 12
 ud_3                -9.895671e-03 1 1  ON 13
 ud_4                -6.697443e-02 1 1  ON 14
 ud_5                -1.081857e-01 1 1  ON 15
 ud_6                -1.352699e-01 1 1  ON 16
 ud_7                -1.512566e-01 1 1  ON 17
 ud_8                -1.515745e-01 1 1  ON 18
 ud_9                -1.402750e-01 1 1  ON 19
 eO_0                -7.655036e-01 1 1  ON 20
 eO_1                -4.431229e-01 1 1  ON 21
 eO_2                -2.028594e-02 1 1  ON 22
 eO_3                 3.022701e-01 1 1  ON 23
 eO_4                 5.276360e-01 1 1  ON 24
 eO_5                 4.869556e-01 1 1  ON 25
 eO_6                 2.566521e-01 1 1  ON 26
 eO_7                -4.613300e-02 1 1  ON 27
 eO_8                -2.197503e-01 1 1  ON 28
 eO_9                -7.866737e-02 1 1  ON 29
eH1_0                -2.439569e-01 1 1  ON 30
eH1_1                -1.429827e-01 1 1  ON 31
eH1_2                -9.620622e-02 1 1  ON 32
eH1_3                -4.195596e-02 1 1  ON 33
eH1_4                 5.780964e-03 1 1  ON 34
eH1_5                 4.027899e-02 1 1  ON 35
eH1_6                 9.800120e-02 1 1  ON 36
eH1_7                 1.513427e-01 1 1  ON 37
eH1_8                 1.741369e-01 1 1  ON 38
eH1_9                 5.964573e-02 1 1  ON 39
eH2_0                -2.394913e-01 1 1  ON 40
eH2_1                -1.393551e-01 1 1  ON 41
eH2_2                -9.220750e-02 1 1  ON 42
eH2_3                -3.804432e-02 1 1  ON 43
eH2_4                 9.645849e-03 1 1  ON 44
eH2_5                 4.294769e-02 1 1  ON 45
eH2_6                 9.859963e-02 1 1  ON 46
eH2_7                 1.505290e-01 1 1  ON 47
eH2_8                 1.770793e-01 1 1  ON 48
eH2_9                 4.747440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.345634
====================================================
  Execution time = 3.6000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.0000e+06
  Execution time = 3.3593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335859135085
                                         uncertainty =       0.003173752055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335859135085
                                         uncertainty =       0.003173752055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409813344
  error estimate for blocks of size 2^( 2) =       0.000422668188
  error estimate for blocks of size 2^( 3) =       0.000435572947
  error estimate for blocks of size 2^( 4) =       0.000447788470
  error estimate for blocks of size 2^( 5) =       0.000459946028
  error estimate for blocks of size 2^( 6) =       0.000469220539
  error estimate for blocks of size 2^( 7) =       0.000472013542

      target function =                  N/A
              le_mean =     -16.906026756994
             les_mean =     286.149634494795
             stat err =       0.000462242145
             autocorr =       1.272233676678
              std dev =       0.579563589740
             le_variance =       0.335893954552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335780780567
                                         uncertainty =       0.003172850291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335780780567
                                         uncertainty =       0.003172850291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409765544
  error estimate for blocks of size 2^( 2) =       0.000422622134
  error estimate for blocks of size 2^( 3) =       0.000435529263
  error estimate for blocks of size 2^( 4) =       0.000447746627
  error estimate for blocks of size 2^( 5) =       0.000459907105
  error estimate for blocks of size 2^( 6) =       0.000469181358
  error estimate for blocks of size 2^( 7) =       0.000471973906

      target function =                  N/A
              le_mean =     -16.906026810527
             les_mean =     286.149557952718
             stat err =       0.000462202249
             autocorr =       1.272310859476
              std dev =       0.579495989945
             le_variance =       0.335815602362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335814517656
                                         uncertainty =       0.003173252672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335814517656
                                         uncertainty =       0.003173252672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409786126
  error estimate for blocks of size 2^( 2) =       0.000422641994
  error estimate for blocks of size 2^( 3) =       0.000435548131
  error estimate for blocks of size 2^( 4) =       0.000447764743
  error estimate for blocks of size 2^( 5) =       0.000459923987
  error estimate for blocks of size 2^( 6) =       0.000469198257
  error estimate for blocks of size 2^( 7) =       0.000471991044

      target function =                  N/A
              le_mean =     -16.906026752243
             les_mean =     286.149589718396
             stat err =       0.000462219508
             autocorr =       1.272278065143
              std dev =       0.579525097624
             le_variance =       0.335849338776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335853521119
                                         uncertainty =       0.003173690749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335853521119
                                         uncertainty =       0.003173690749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409809920
  error estimate for blocks of size 2^( 2) =       0.000422664883
  error estimate for blocks of size 2^( 3) =       0.000435569814
  error estimate for blocks of size 2^( 4) =       0.000447785475
  error estimate for blocks of size 2^( 5) =       0.000459943256
  error estimate for blocks of size 2^( 6) =       0.000469217736
  error estimate for blocks of size 2^( 7) =       0.000472010733

      target function =                  N/A
              le_mean =     -16.906026755811
             les_mean =     286.149628840796
             stat err =       0.000462239300
             autocorr =       1.272239282115
              std dev =       0.579558746421
             le_variance =       0.335888340553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906026756994        initial
     1.5625e+00     1.5625e+01             1.5592e-04       -16.906026810527  <--
     6.2500e+00     6.2500e+01             4.1011e-05       -16.906026752243
     2.5000e+01     2.5000e+02             1.0268e-05       -16.906026755811

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 5.2909e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091451e-01 1 1  ON 0
 uu_1                 1.427523e-01 1 1  ON 1
 uu_2                 4.132930e-02 1 1  ON 2
 uu_3                -2.109917e-02 1 1  ON 3
 uu_4                -6.616877e-02 1 1  ON 4
 uu_5                -1.002239e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320434e-01 1 1  ON 8
 uu_9                -1.020651e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833592e-01 1 1  ON 11
 ud_2                 6.207992e-02 1 1  ON 12
 ud_3                -9.863584e-03 1 1  ON 13
 ud_4                -6.695609e-02 1 1  ON 14
 ud_5                -1.081730e-01 1 1  ON 15
 ud_6                -1.352320e-01 1 1  ON 16
 ud_7                -1.512303e-01 1 1  ON 17
 ud_8                -1.515937e-01 1 1  ON 18
 ud_9                -1.403366e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430633e-01 1 1  ON 21
 eO_2                -2.033732e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870250e-01 1 1  ON 25
 eO_6                 2.567073e-01 1 1  ON 26
 eO_7                -4.610929e-02 1 1  ON 27
 eO_8                -2.198008e-01 1 1  ON 28
 eO_9                -7.874295e-02 1 1  ON 29
eH1_0                -2.439977e-01 1 1  ON 30
eH1_1                -1.430278e-01 1 1  ON 31
eH1_2                -9.622609e-02 1 1  ON 32
eH1_3                -4.199548e-02 1 1  ON 33
eH1_4                 5.840483e-03 1 1  ON 34
eH1_5                 4.022885e-02 1 1  ON 35
eH1_6                 9.800160e-02 1 1  ON 36
eH1_7                 1.513619e-01 1 1  ON 37
eH1_8                 1.741839e-01 1 1  ON 38
eH1_9                 5.971968e-02 1 1  ON 39
eH2_0                -2.396063e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225615e-02 1 1  ON 42
eH2_3                -3.809497e-02 1 1  ON 43
eH2_4                 9.643196e-03 1 1  ON 44
eH2_5                 4.295741e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505058e-01 1 1  ON 47
eH2_8                 1.771417e-01 1 1  ON 48
eH2_9                 4.757726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8409
    reference variance = 0.457757
====================================================
  Execution time = 3.6741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3660e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0110e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336612139676
                                         uncertainty =       0.003715540879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336612139676
                                         uncertainty =       0.003715540879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410243627
  error estimate for blocks of size 2^( 2) =       0.000423136861
  error estimate for blocks of size 2^( 3) =       0.000435999632
  error estimate for blocks of size 2^( 4) =       0.000448369361
  error estimate for blocks of size 2^( 5) =       0.000458890676
  error estimate for blocks of size 2^( 6) =       0.000465937754
  error estimate for blocks of size 2^( 7) =       0.000472458538

      target function =                  N/A
              le_mean =     -16.905201146013
             les_mean =     286.122425285475
             stat err =       0.000461414082
             autocorr =       1.265021783330
              std dev =       0.580172100858
             le_variance =       0.336599666614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520114601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201146013       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905201542664       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905202520601       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905202634307       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905201995746       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201245442       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905202030519       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905202360523       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905202397509       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.867965e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201146013       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905201278818       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905201486378       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905201633384       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905201323134       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201258908       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905201454082       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905201537472       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905201532337       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.253670e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905201146013       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905201182291       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905201228443       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905201271314       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905201260205       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905201186668       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905201229490       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905201249326       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.107759e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6858e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092086e-01 1 1  ON 0
 uu_1                 1.427844e-01 1 1  ON 1
 uu_2                 4.130424e-02 1 1  ON 2
 uu_3                -2.104197e-02 1 1  ON 3
 uu_4                -6.615501e-02 1 1  ON 4
 uu_5                -1.002364e-01 1 1  ON 5
 uu_6                -1.269225e-01 1 1  ON 6
 uu_7                -1.398806e-01 1 1  ON 7
 uu_8                -1.321037e-01 1 1  ON 8
 uu_9                -1.021526e-01 1 1  ON 9
 ud_0                 4.496432e-01 1 1  ON 10
 ud_1                 1.833578e-01 1 1  ON 11
 ud_2                 6.212989e-02 1 1  ON 12
 ud_3                -9.779312e-03 1 1  ON 13
 ud_4                -6.693671e-02 1 1  ON 14
 ud_5                -1.080777e-01 1 1  ON 15
 ud_6                -1.351980e-01 1 1  ON 16
 ud_7                -1.512700e-01 1 1  ON 17
 ud_8                -1.516826e-01 1 1  ON 18
 ud_9                -1.404318e-01 1 1  ON 19
 eO_0                -7.654374e-01 1 1  ON 20
 eO_1                -4.429730e-01 1 1  ON 21
 eO_2                -2.041435e-02 1 1  ON 22
 eO_3                 3.021633e-01 1 1  ON 23
 eO_4                 5.276747e-01 1 1  ON 24
 eO_5                 4.870684e-01 1 1  ON 25
 eO_6                 2.568327e-01 1 1  ON 26
 eO_7                -4.607296e-02 1 1  ON 27
 eO_8                -2.199183e-01 1 1  ON 28
 eO_9                -7.884611e-02 1 1  ON 29
eH1_0                -2.439896e-01 1 1  ON 30
eH1_1                -1.430771e-01 1 1  ON 31
eH1_2                -9.625331e-02 1 1  ON 32
eH1_3                -4.205463e-02 1 1  ON 33
eH1_4                 5.805502e-03 1 1  ON 34
eH1_5                 4.024334e-02 1 1  ON 35
eH1_6                 9.794284e-02 1 1  ON 36
eH1_7                 1.513588e-01 1 1  ON 37
eH1_8                 1.742685e-01 1 1  ON 38
eH1_9                 5.983387e-02 1 1  ON 39
eH2_0                -2.397038e-01 1 1  ON 40
eH2_1                -1.392850e-01 1 1  ON 41
eH2_2                -9.229258e-02 1 1  ON 42
eH2_3                -3.814648e-02 1 1  ON 43
eH2_4                 9.576438e-03 1 1  ON 44
eH2_5                 4.296015e-02 1 1  ON 45
eH2_6                 9.861443e-02 1 1  ON 46
eH2_7                 1.505360e-01 1 1  ON 47
eH2_8                 1.772165e-01 1 1  ON 48
eH2_9                 4.770128e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8282
    reference variance = 0.420428
====================================================
  Execution time = 3.7671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.0000e+06
  Execution time = 3.3637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794923653
                                         uncertainty =       0.003008743123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335794923653
                                         uncertainty =       0.003008743123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409789659
  error estimate for blocks of size 2^( 2) =       0.000422817922
  error estimate for blocks of size 2^( 3) =       0.000436122783
  error estimate for blocks of size 2^( 4) =       0.000447854326
  error estimate for blocks of size 2^( 5) =       0.000459164134
  error estimate for blocks of size 2^( 6) =       0.000467550567
  error estimate for blocks of size 2^( 7) =       0.000471726711

      target function =                  N/A
              le_mean =     -16.906560806195
             les_mean =     286.167653254475
             stat err =       0.000461573934
             autocorr =       1.268704739620
              std dev =       0.579530093113
             le_variance =       0.335855128824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335795072890
                                         uncertainty =       0.003008984913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335795072890
                                         uncertainty =       0.003008984913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409789662
  error estimate for blocks of size 2^( 2) =       0.000422817899
  error estimate for blocks of size 2^( 3) =       0.000436123898
  error estimate for blocks of size 2^( 4) =       0.000447852502
  error estimate for blocks of size 2^( 5) =       0.000459163458
  error estimate for blocks of size 2^( 6) =       0.000467547576
  error estimate for blocks of size 2^( 7) =       0.000471725060

      target function =                  N/A
              le_mean =     -16.906559485963
             les_mean =     286.167608618501
             stat err =       0.000461572149
             autocorr =       1.268694904016
              std dev =       0.579530097603
             le_variance =       0.335855134028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335819901752
                                         uncertainty =       0.003009005777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335819901752
                                         uncertainty =       0.003009005777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409804834
  error estimate for blocks of size 2^( 2) =       0.000422832573
  error estimate for blocks of size 2^( 3) =       0.000436138197
  error estimate for blocks of size 2^( 4) =       0.000447867277
  error estimate for blocks of size 2^( 5) =       0.000459177503
  error estimate for blocks of size 2^( 6) =       0.000467562056
  error estimate for blocks of size 2^( 7) =       0.000471739670

      target function =                  N/A
              le_mean =     -16.906559748363
             les_mean =     286.167642361207
             stat err =       0.000461586627
             autocorr =       1.268680547766
              std dev =       0.579551554387
             le_variance =       0.335880004192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335800125843
                                         uncertainty =       0.003008786705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335800125843
                                         uncertainty =       0.003008786705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409792824
  error estimate for blocks of size 2^( 2) =       0.000422820960
  error estimate for blocks of size 2^( 3) =       0.000436125898
  error estimate for blocks of size 2^( 4) =       0.000447857035
  error estimate for blocks of size 2^( 5) =       0.000459166860
  error estimate for blocks of size 2^( 6) =       0.000467552962
  error estimate for blocks of size 2^( 7) =       0.000471729359

      target function =                  N/A
              le_mean =     -16.906560631027
             les_mean =     286.167652519617
             stat err =       0.000461576554
             autocorr =       1.268699542502
              std dev =       0.579534569247
             le_variance =       0.335860316953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906560806195        initial  <--
     3.9062e-01     3.9062e+00             4.8680e-04       -16.906559485963
     1.5625e+00     1.5625e+01             1.2537e-04       -16.906559748363
     6.2500e+00     6.2500e+01             3.1078e-05       -16.906560631027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5488
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.091451e-01 1 1  ON 0
 uu_1                 1.427523e-01 1 1  ON 1
 uu_2                 4.132930e-02 1 1  ON 2
 uu_3                -2.109917e-02 1 1  ON 3
 uu_4                -6.616877e-02 1 1  ON 4
 uu_5                -1.002239e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320434e-01 1 1  ON 8
 uu_9                -1.020651e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833592e-01 1 1  ON 11
 ud_2                 6.207992e-02 1 1  ON 12
 ud_3                -9.863584e-03 1 1  ON 13
 ud_4                -6.695609e-02 1 1  ON 14
 ud_5                -1.081730e-01 1 1  ON 15
 ud_6                -1.352320e-01 1 1  ON 16
 ud_7                -1.512303e-01 1 1  ON 17
 ud_8                -1.515937e-01 1 1  ON 18
 ud_9                -1.403366e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430633e-01 1 1  ON 21
 eO_2                -2.033732e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870250e-01 1 1  ON 25
 eO_6                 2.567073e-01 1 1  ON 26
 eO_7                -4.610929e-02 1 1  ON 27
 eO_8                -2.198008e-01 1 1  ON 28
 eO_9                -7.874295e-02 1 1  ON 29
eH1_0                -2.439977e-01 1 1  ON 30
eH1_1                -1.430278e-01 1 1  ON 31
eH1_2                -9.622609e-02 1 1  ON 32
eH1_3                -4.199548e-02 1 1  ON 33
eH1_4                 5.840483e-03 1 1  ON 34
eH1_5                 4.022885e-02 1 1  ON 35
eH1_6                 9.800160e-02 1 1  ON 36
eH1_7                 1.513619e-01 1 1  ON 37
eH1_8                 1.741839e-01 1 1  ON 38
eH1_9                 5.971968e-02 1 1  ON 39
eH2_0                -2.396063e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225615e-02 1 1  ON 42
eH2_3                -3.809497e-02 1 1  ON 43
eH2_4                 9.643196e-03 1 1  ON 44
eH2_5                 4.295741e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505058e-01 1 1  ON 47
eH2_8                 1.771417e-01 1 1  ON 48
eH2_9                 4.757726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0143e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.359505
====================================================
  Execution time = 3.6699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4374e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0056e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343850000393
                                         uncertainty =       0.005179522524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343850000393
                                         uncertainty =       0.005179522524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414570194
  error estimate for blocks of size 2^( 2) =       0.000427740938
  error estimate for blocks of size 2^( 3) =       0.000441425693
  error estimate for blocks of size 2^( 4) =       0.000454222313
  error estimate for blocks of size 2^( 5) =       0.000466590358
  error estimate for blocks of size 2^( 6) =       0.000475921261
  error estimate for blocks of size 2^( 7) =       0.000481714817

      target function =                  N/A
              le_mean =     -16.905602910388
             les_mean =     286.143146483080
             stat err =       0.000469612187
             autocorr =       1.283165188254
              std dev =       0.586290790680
             le_variance =       0.343736891236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560291039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905602910388       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905602914827       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905602637894       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602765225       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603157283       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905603149329       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603123279       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603124150       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.092313e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905602910388       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905602911541       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905602838439       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602868337       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905602968925       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905602971232       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905602962692       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905602962921       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.782318e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905602910388       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905602910679       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905602892145       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602899484       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905602924744       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905602925627       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905602923404       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905602923451       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.461582e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6763e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091507e-01 1 1  ON 0
 uu_1                 1.427496e-01 1 1  ON 1
 uu_2                 4.132527e-02 1 1  ON 2
 uu_3                -2.110057e-02 1 1  ON 3
 uu_4                -6.617231e-02 1 1  ON 4
 uu_5                -1.002264e-01 1 1  ON 5
 uu_6                -1.268927e-01 1 1  ON 6
 uu_7                -1.398212e-01 1 1  ON 7
 uu_8                -1.320401e-01 1 1  ON 8
 uu_9                -1.020610e-01 1 1  ON 9
 ud_0                 4.496119e-01 1 1  ON 10
 ud_1                 1.833574e-01 1 1  ON 11
 ud_2                 6.208068e-02 1 1  ON 12
 ud_3                -9.869783e-03 1 1  ON 13
 ud_4                -6.695892e-02 1 1  ON 14
 ud_5                -1.081783e-01 1 1  ON 15
 ud_6                -1.352337e-01 1 1  ON 16
 ud_7                -1.512306e-01 1 1  ON 17
 ud_8                -1.515869e-01 1 1  ON 18
 ud_9                -1.403277e-01 1 1  ON 19
 eO_0                -7.654793e-01 1 1  ON 20
 eO_1                -4.430623e-01 1 1  ON 21
 eO_2                -2.034481e-02 1 1  ON 22
 eO_3                 3.021812e-01 1 1  ON 23
 eO_4                 5.276887e-01 1 1  ON 24
 eO_5                 4.870238e-01 1 1  ON 25
 eO_6                 2.567105e-01 1 1  ON 26
 eO_7                -4.610347e-02 1 1  ON 27
 eO_8                -2.198035e-01 1 1  ON 28
 eO_9                -7.874834e-02 1 1  ON 29
eH1_0                -2.440049e-01 1 1  ON 30
eH1_1                -1.430319e-01 1 1  ON 31
eH1_2                -9.622555e-02 1 1  ON 32
eH1_3                -4.199737e-02 1 1  ON 33
eH1_4                 5.840307e-03 1 1  ON 34
eH1_5                 4.022864e-02 1 1  ON 35
eH1_6                 9.799739e-02 1 1  ON 36
eH1_7                 1.513606e-01 1 1  ON 37
eH1_8                 1.741914e-01 1 1  ON 38
eH1_9                 5.973017e-02 1 1  ON 39
eH2_0                -2.396175e-01 1 1  ON 40
eH2_1                -1.392918e-01 1 1  ON 41
eH2_2                -9.226175e-02 1 1  ON 42
eH2_3                -3.810565e-02 1 1  ON 43
eH2_4                 9.632577e-03 1 1  ON 44
eH2_5                 4.295543e-02 1 1  ON 45
eH2_6                 9.860433e-02 1 1  ON 46
eH2_7                 1.505100e-01 1 1  ON 47
eH2_8                 1.771539e-01 1 1  ON 48
eH2_9                 4.759508e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0274
    reference variance = 0.771636
====================================================
  Execution time = 3.6091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3758e-01
  Total weights = 2.0000e+06
  Execution time = 3.3691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565728851
                                         uncertainty =       0.004244324921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565728851
                                         uncertainty =       0.004244324921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410842625
  error estimate for blocks of size 2^( 2) =       0.000423534378
  error estimate for blocks of size 2^( 3) =       0.000436679924
  error estimate for blocks of size 2^( 4) =       0.000448281448
  error estimate for blocks of size 2^( 5) =       0.000458944529
  error estimate for blocks of size 2^( 6) =       0.000465029255
  error estimate for blocks of size 2^( 7) =       0.000471169999

      target function =                  N/A
              le_mean =     -16.905740217124
             les_mean =     286.141635445473
             stat err =       0.000460856308
             autocorr =       1.258288075679
              std dev =       0.581019212582
             le_variance =       0.337583325390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337560189924
                                         uncertainty =       0.004244197435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337560189924
                                         uncertainty =       0.004244197435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410839261
  error estimate for blocks of size 2^( 2) =       0.000423531666
  error estimate for blocks of size 2^( 3) =       0.000436677713
  error estimate for blocks of size 2^( 4) =       0.000448279811
  error estimate for blocks of size 2^( 5) =       0.000458942681
  error estimate for blocks of size 2^( 6) =       0.000465027633
  error estimate for blocks of size 2^( 7) =       0.000471167399

      target function =                  N/A
              le_mean =     -16.905740197875
             les_mean =     286.141629265618
             stat err =       0.000460854381
             autocorr =       1.258298161838
              std dev =       0.581014454514
             le_variance =       0.337577796354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337562468522
                                         uncertainty =       0.004244253643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337562468522
                                         uncertainty =       0.004244253643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410840644
  error estimate for blocks of size 2^( 2) =       0.000423532751
  error estimate for blocks of size 2^( 3) =       0.000436678578
  error estimate for blocks of size 2^( 4) =       0.000448280408
  error estimate for blocks of size 2^( 5) =       0.000458943394
  error estimate for blocks of size 2^( 6) =       0.000465028261
  error estimate for blocks of size 2^( 7) =       0.000471168510

      target function =                  N/A
              le_mean =     -16.905740196469
             les_mean =     286.141631491876
             stat err =       0.000460855143
             autocorr =       1.258293849746
              std dev =       0.581016411263
             le_variance =       0.337580070157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565303143
                                         uncertainty =       0.004244315746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337565303143
                                         uncertainty =       0.004244315746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410842367
  error estimate for blocks of size 2^( 2) =       0.000423534164
  error estimate for blocks of size 2^( 3) =       0.000436679747
  error estimate for blocks of size 2^( 4) =       0.000448281310
  error estimate for blocks of size 2^( 5) =       0.000458944379
  error estimate for blocks of size 2^( 6) =       0.000465029123
  error estimate for blocks of size 2^( 7) =       0.000471169805

      target function =                  N/A
              le_mean =     -16.905740213955
             les_mean =     286.141634913276
             stat err =       0.000460856154
             autocorr =       1.258288822446
              std dev =       0.581018846789
             le_variance =       0.337582900324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905740217124        initial  <--
     3.9062e+00     3.9062e+01             7.0923e-05       -16.905740197875
     1.5625e+01     1.5625e+02             1.7823e-05       -16.905740196469
     6.2500e+01     6.2500e+02             4.4616e-06       -16.905740213955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0106
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091451e-01 1 1  ON 0
 uu_1                 1.427523e-01 1 1  ON 1
 uu_2                 4.132930e-02 1 1  ON 2
 uu_3                -2.109917e-02 1 1  ON 3
 uu_4                -6.616877e-02 1 1  ON 4
 uu_5                -1.002239e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320434e-01 1 1  ON 8
 uu_9                -1.020651e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833592e-01 1 1  ON 11
 ud_2                 6.207992e-02 1 1  ON 12
 ud_3                -9.863584e-03 1 1  ON 13
 ud_4                -6.695609e-02 1 1  ON 14
 ud_5                -1.081730e-01 1 1  ON 15
 ud_6                -1.352320e-01 1 1  ON 16
 ud_7                -1.512303e-01 1 1  ON 17
 ud_8                -1.515937e-01 1 1  ON 18
 ud_9                -1.403366e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430633e-01 1 1  ON 21
 eO_2                -2.033732e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870250e-01 1 1  ON 25
 eO_6                 2.567073e-01 1 1  ON 26
 eO_7                -4.610929e-02 1 1  ON 27
 eO_8                -2.198008e-01 1 1  ON 28
 eO_9                -7.874295e-02 1 1  ON 29
eH1_0                -2.439977e-01 1 1  ON 30
eH1_1                -1.430278e-01 1 1  ON 31
eH1_2                -9.622609e-02 1 1  ON 32
eH1_3                -4.199548e-02 1 1  ON 33
eH1_4                 5.840483e-03 1 1  ON 34
eH1_5                 4.022885e-02 1 1  ON 35
eH1_6                 9.800160e-02 1 1  ON 36
eH1_7                 1.513619e-01 1 1  ON 37
eH1_8                 1.741839e-01 1 1  ON 38
eH1_9                 5.971968e-02 1 1  ON 39
eH2_0                -2.396063e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225615e-02 1 1  ON 42
eH2_3                -3.809497e-02 1 1  ON 43
eH2_4                 9.643196e-03 1 1  ON 44
eH2_5                 4.295741e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505058e-01 1 1  ON 47
eH2_8                 1.771417e-01 1 1  ON 48
eH2_9                 4.757726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9788e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.991
    reference variance = 0.225422
====================================================
  Execution time = 3.6901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4024e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0245e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231389220
                                         uncertainty =       0.004055319088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340231389220
                                         uncertainty =       0.004055319088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412459020
  error estimate for blocks of size 2^( 2) =       0.000424997672
  error estimate for blocks of size 2^( 3) =       0.000438029292
  error estimate for blocks of size 2^( 4) =       0.000449953174
  error estimate for blocks of size 2^( 5) =       0.000461904448
  error estimate for blocks of size 2^( 6) =       0.000469146413
  error estimate for blocks of size 2^( 7) =       0.000475821767

      target function =                  N/A
              le_mean =     -16.905833131599
             les_mean =     286.147438590473
             stat err =       0.000464206451
             autocorr =       1.266661965761
              std dev =       0.583305140671
             le_variance =       0.340244887133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583313160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833131599       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905833138817       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905833138489       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833137771       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833141273       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905833144174       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905833145154       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905833147159       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.422213e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833131599       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905833133409       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905833133322       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833133140       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833134018       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905833134739       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905833134980       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905833135481       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.356033e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833131599       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905833132052       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905833132030       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833131984       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833132203       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905833132384       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905833132443       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905833132569       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.390386e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7153e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091459e-01 1 1  ON 0
 uu_1                 1.427520e-01 1 1  ON 1
 uu_2                 4.132986e-02 1 1  ON 2
 uu_3                -2.109968e-02 1 1  ON 3
 uu_4                -6.616882e-02 1 1  ON 4
 uu_5                -1.002241e-01 1 1  ON 5
 uu_6                -1.268845e-01 1 1  ON 6
 uu_7                -1.398144e-01 1 1  ON 7
 uu_8                -1.320434e-01 1 1  ON 8
 uu_9                -1.020660e-01 1 1  ON 9
 ud_0                 4.496157e-01 1 1  ON 10
 ud_1                 1.833598e-01 1 1  ON 11
 ud_2                 6.208035e-02 1 1  ON 12
 ud_3                -9.862992e-03 1 1  ON 13
 ud_4                -6.695573e-02 1 1  ON 14
 ud_5                -1.081732e-01 1 1  ON 15
 ud_6                -1.352322e-01 1 1  ON 16
 ud_7                -1.512305e-01 1 1  ON 17
 ud_8                -1.515934e-01 1 1  ON 18
 ud_9                -1.403371e-01 1 1  ON 19
 eO_0                -7.654808e-01 1 1  ON 20
 eO_1                -4.430631e-01 1 1  ON 21
 eO_2                -2.033780e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276827e-01 1 1  ON 24
 eO_5                 4.870261e-01 1 1  ON 25
 eO_6                 2.567079e-01 1 1  ON 26
 eO_7                -4.610925e-02 1 1  ON 27
 eO_8                -2.198015e-01 1 1  ON 28
 eO_9                -7.874386e-02 1 1  ON 29
eH1_0                -2.439984e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622599e-02 1 1  ON 32
eH1_3                -4.199591e-02 1 1  ON 33
eH1_4                 5.840693e-03 1 1  ON 34
eH1_5                 4.022832e-02 1 1  ON 35
eH1_6                 9.800104e-02 1 1  ON 36
eH1_7                 1.513621e-01 1 1  ON 37
eH1_8                 1.741848e-01 1 1  ON 38
eH1_9                 5.972079e-02 1 1  ON 39
eH2_0                -2.396070e-01 1 1  ON 40
eH2_1                -1.392928e-01 1 1  ON 41
eH2_2                -9.225629e-02 1 1  ON 42
eH2_3                -3.809520e-02 1 1  ON 43
eH2_4                 9.642500e-03 1 1  ON 44
eH2_5                 4.295739e-02 1 1  ON 45
eH2_6                 9.860469e-02 1 1  ON 46
eH2_7                 1.505060e-01 1 1  ON 47
eH2_8                 1.771421e-01 1 1  ON 48
eH2_9                 4.757862e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8413
    reference variance = 0.330945
====================================================
  Execution time = 3.6064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4571e-01
  Total weights = 2.0000e+06
  Execution time = 3.3525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733837547
                                         uncertainty =       0.010181523547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733837547
                                         uncertainty =       0.010181523547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415759500
  error estimate for blocks of size 2^( 2) =       0.000428474179
  error estimate for blocks of size 2^( 3) =       0.000441531550
  error estimate for blocks of size 2^( 4) =       0.000453602036
  error estimate for blocks of size 2^( 5) =       0.000463864124
  error estimate for blocks of size 2^( 6) =       0.000471989908
  error estimate for blocks of size 2^( 7) =       0.000479933153

      target function =                  N/A
              le_mean =     -16.906109539319
             les_mean =     286.162251506054
             stat err =       0.000467347305
             autocorr =       1.263557828540
              std dev =       0.587972723400
             le_variance =       0.345711923462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345730092180
                                         uncertainty =       0.010181415604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345730092180
                                         uncertainty =       0.010181415604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415757247
  error estimate for blocks of size 2^( 2) =       0.000428472018
  error estimate for blocks of size 2^( 3) =       0.000441529486
  error estimate for blocks of size 2^( 4) =       0.000453600075
  error estimate for blocks of size 2^( 5) =       0.000463862261
  error estimate for blocks of size 2^( 6) =       0.000471988140
  error estimate for blocks of size 2^( 7) =       0.000479931294

      target function =                  N/A
              le_mean =     -16.906109526042
             les_mean =     286.162247311266
             stat err =       0.000467345442
             autocorr =       1.263561445792
              std dev =       0.587969537972
             le_variance =       0.345708177583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345731945646
                                         uncertainty =       0.010181469040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345731945646
                                         uncertainty =       0.010181469040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415758362
  error estimate for blocks of size 2^( 2) =       0.000428473087
  error estimate for blocks of size 2^( 3) =       0.000441530507
  error estimate for blocks of size 2^( 4) =       0.000453601045
  error estimate for blocks of size 2^( 5) =       0.000463863183
  error estimate for blocks of size 2^( 6) =       0.000471989015
  error estimate for blocks of size 2^( 7) =       0.000479932214

      target function =                  N/A
              le_mean =     -16.906109532617
             les_mean =     286.162249387309
             stat err =       0.000467346364
             autocorr =       1.263559655261
              std dev =       0.587971114345
             le_variance =       0.345710031305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733600439
                                         uncertainty =       0.010181516717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345733600439
                                         uncertainty =       0.010181516717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415759357
  error estimate for blocks of size 2^( 2) =       0.000428474042
  error estimate for blocks of size 2^( 3) =       0.000441531419
  error estimate for blocks of size 2^( 4) =       0.000453601912
  error estimate for blocks of size 2^( 5) =       0.000463864006
  error estimate for blocks of size 2^( 6) =       0.000471989796
  error estimate for blocks of size 2^( 7) =       0.000479933035

      target function =                  N/A
              le_mean =     -16.906109538478
             les_mean =     286.162251240474
             stat err =       0.000467347187
             autocorr =       1.263558057454
              std dev =       0.587972521741
             le_variance =       0.345711686323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906109539319        initial  <--
     3.9062e+01     3.9062e+02             5.4222e-06       -16.906109526042
     1.5625e+02     1.5625e+03             1.3560e-06       -16.906109532617
     6.2500e+02     6.2500e+03             3.3904e-07       -16.906109538478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9386
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091451e-01 1 1  ON 0
 uu_1                 1.427523e-01 1 1  ON 1
 uu_2                 4.132930e-02 1 1  ON 2
 uu_3                -2.109917e-02 1 1  ON 3
 uu_4                -6.616877e-02 1 1  ON 4
 uu_5                -1.002239e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320434e-01 1 1  ON 8
 uu_9                -1.020651e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833592e-01 1 1  ON 11
 ud_2                 6.207992e-02 1 1  ON 12
 ud_3                -9.863584e-03 1 1  ON 13
 ud_4                -6.695609e-02 1 1  ON 14
 ud_5                -1.081730e-01 1 1  ON 15
 ud_6                -1.352320e-01 1 1  ON 16
 ud_7                -1.512303e-01 1 1  ON 17
 ud_8                -1.515937e-01 1 1  ON 18
 ud_9                -1.403366e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430633e-01 1 1  ON 21
 eO_2                -2.033732e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870250e-01 1 1  ON 25
 eO_6                 2.567073e-01 1 1  ON 26
 eO_7                -4.610929e-02 1 1  ON 27
 eO_8                -2.198008e-01 1 1  ON 28
 eO_9                -7.874295e-02 1 1  ON 29
eH1_0                -2.439977e-01 1 1  ON 30
eH1_1                -1.430278e-01 1 1  ON 31
eH1_2                -9.622609e-02 1 1  ON 32
eH1_3                -4.199548e-02 1 1  ON 33
eH1_4                 5.840483e-03 1 1  ON 34
eH1_5                 4.022885e-02 1 1  ON 35
eH1_6                 9.800160e-02 1 1  ON 36
eH1_7                 1.513619e-01 1 1  ON 37
eH1_8                 1.741839e-01 1 1  ON 38
eH1_9                 5.971968e-02 1 1  ON 39
eH2_0                -2.396063e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225615e-02 1 1  ON 42
eH2_3                -3.809497e-02 1 1  ON 43
eH2_4                 9.643196e-03 1 1  ON 44
eH2_5                 4.295741e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505058e-01 1 1  ON 47
eH2_8                 1.771417e-01 1 1  ON 48
eH2_9                 4.757726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.167146
====================================================
  Execution time = 3.7366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3762e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0026e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337700216434
                                         uncertainty =       0.004969367503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337700216434
                                         uncertainty =       0.004969367503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410867588
  error estimate for blocks of size 2^( 2) =       0.000423195931
  error estimate for blocks of size 2^( 3) =       0.000436475982
  error estimate for blocks of size 2^( 4) =       0.000449033546
  error estimate for blocks of size 2^( 5) =       0.000457441938
  error estimate for blocks of size 2^( 6) =       0.000464241163
  error estimate for blocks of size 2^( 7) =       0.000469802134

      target function =                  N/A
              le_mean =     -16.905284935961
             les_mean =     286.126282947261
             stat err =       0.000460129695
             autocorr =       1.254171011915
              std dev =       0.581054515549
             le_variance =       0.337624350040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528493596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284935961       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284936941       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284936737       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284936930       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284937141       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284937602       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905284938219       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905284938298       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.916422e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284935961       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284936206       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284936155       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284936203       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284936256       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284936371       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905284936527       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905284936546       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.729688e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284935961       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284936022       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284936010       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284936022       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284936029       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284936060       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905284936101       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905284936105       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.324586e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7399e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091452e-01 1 1  ON 0
 uu_1                 1.427524e-01 1 1  ON 1
 uu_2                 4.132924e-02 1 1  ON 2
 uu_3                -2.109918e-02 1 1  ON 3
 uu_4                -6.616882e-02 1 1  ON 4
 uu_5                -1.002240e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320435e-01 1 1  ON 8
 uu_9                -1.020651e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833593e-01 1 1  ON 11
 ud_2                 6.207995e-02 1 1  ON 12
 ud_3                -9.863501e-03 1 1  ON 13
 ud_4                -6.695611e-02 1 1  ON 14
 ud_5                -1.081730e-01 1 1  ON 15
 ud_6                -1.352320e-01 1 1  ON 16
 ud_7                -1.512304e-01 1 1  ON 17
 ud_8                -1.515938e-01 1 1  ON 18
 ud_9                -1.403367e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430632e-01 1 1  ON 21
 eO_2                -2.033743e-02 1 1  ON 22
 eO_3                 3.021826e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870251e-01 1 1  ON 25
 eO_6                 2.567074e-01 1 1  ON 26
 eO_7                -4.610928e-02 1 1  ON 27
 eO_8                -2.198009e-01 1 1  ON 28
 eO_9                -7.874302e-02 1 1  ON 29
eH1_0                -2.439978e-01 1 1  ON 30
eH1_1                -1.430278e-01 1 1  ON 31
eH1_2                -9.622613e-02 1 1  ON 32
eH1_3                -4.199549e-02 1 1  ON 33
eH1_4                 5.840567e-03 1 1  ON 34
eH1_5                 4.022879e-02 1 1  ON 35
eH1_6                 9.800157e-02 1 1  ON 36
eH1_7                 1.513619e-01 1 1  ON 37
eH1_8                 1.741840e-01 1 1  ON 38
eH1_9                 5.971975e-02 1 1  ON 39
eH2_0                -2.396063e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225621e-02 1 1  ON 42
eH2_3                -3.809502e-02 1 1  ON 43
eH2_4                 9.643222e-03 1 1  ON 44
eH2_5                 4.295739e-02 1 1  ON 45
eH2_6                 9.860461e-02 1 1  ON 46
eH2_7                 1.505058e-01 1 1  ON 47
eH2_8                 1.771417e-01 1 1  ON 48
eH2_9                 4.757737e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9408
    reference variance = 0.379889
====================================================
  Execution time = 3.8308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3980e-01
  Total weights = 2.0000e+06
  Execution time = 3.3515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887540591
                                         uncertainty =       0.003885513154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887540591
                                         uncertainty =       0.003885513154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412191840
  error estimate for blocks of size 2^( 2) =       0.000424909793
  error estimate for blocks of size 2^( 3) =       0.000437744839
  error estimate for blocks of size 2^( 4) =       0.000450665331
  error estimate for blocks of size 2^( 5) =       0.000462116683
  error estimate for blocks of size 2^( 6) =       0.000472362023
  error estimate for blocks of size 2^( 7) =       0.000479414232

      target function =                  N/A
              le_mean =     -16.905992155343
             les_mean =     286.152374813224
             stat err =       0.000466139567
             autocorr =       1.278889897518
              std dev =       0.582927291008
             le_variance =       0.339804226602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887716553
                                         uncertainty =       0.003885514731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887716553
                                         uncertainty =       0.003885514731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412191947
  error estimate for blocks of size 2^( 2) =       0.000424909893
  error estimate for blocks of size 2^( 3) =       0.000437744933
  error estimate for blocks of size 2^( 4) =       0.000450665419
  error estimate for blocks of size 2^( 5) =       0.000462116769
  error estimate for blocks of size 2^( 6) =       0.000472362105
  error estimate for blocks of size 2^( 7) =       0.000479414309

      target function =                  N/A
              le_mean =     -16.905992155350
             les_mean =     286.152374989349
             stat err =       0.000466139651
             autocorr =       1.278889691997
              std dev =       0.582927441884
             le_variance =       0.339804402501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887628647
                                         uncertainty =       0.003885513943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887628647
                                         uncertainty =       0.003885513943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412191894
  error estimate for blocks of size 2^( 2) =       0.000424909843
  error estimate for blocks of size 2^( 3) =       0.000437744886
  error estimate for blocks of size 2^( 4) =       0.000450665375
  error estimate for blocks of size 2^( 5) =       0.000462116726
  error estimate for blocks of size 2^( 6) =       0.000472362064
  error estimate for blocks of size 2^( 7) =       0.000479414270

      target function =                  N/A
              le_mean =     -16.905992155346
             les_mean =     286.152374901336
             stat err =       0.000466139609
             autocorr =       1.278889794641
              std dev =       0.582927366510
             le_variance =       0.339804314626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887551600
                                         uncertainty =       0.003885513253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339887551600
                                         uncertainty =       0.003885513253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412191847
  error estimate for blocks of size 2^( 2) =       0.000424909799
  error estimate for blocks of size 2^( 3) =       0.000437744845
  error estimate for blocks of size 2^( 4) =       0.000450665337
  error estimate for blocks of size 2^( 5) =       0.000462116689
  error estimate for blocks of size 2^( 6) =       0.000472362028
  error estimate for blocks of size 2^( 7) =       0.000479414236

      target function =                  N/A
              le_mean =     -16.905992155343
             les_mean =     286.152374824238
             stat err =       0.000466139573
             autocorr =       1.278889884646
              std dev =       0.582927300447
             le_variance =       0.339804237607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905992155343        initial
     3.9062e+02     3.9062e+03             6.9164e-07       -16.905992155350  <--
     1.5625e+03     1.5625e+04             1.7297e-07       -16.905992155346
     6.2500e+03     6.2500e+04             4.3246e-08       -16.905992155343

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 5.5203e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091458e-01 1 1  ON 0
 uu_1                 1.427525e-01 1 1  ON 1
 uu_2                 4.132904e-02 1 1  ON 2
 uu_3                -2.109923e-02 1 1  ON 3
 uu_4                -6.616896e-02 1 1  ON 4
 uu_5                -1.002242e-01 1 1  ON 5
 uu_6                -1.268841e-01 1 1  ON 6
 uu_7                -1.398142e-01 1 1  ON 7
 uu_8                -1.320437e-01 1 1  ON 8
 uu_9                -1.020654e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833595e-01 1 1  ON 11
 ud_2                 6.208003e-02 1 1  ON 12
 ud_3                -9.863254e-03 1 1  ON 13
 ud_4                -6.695615e-02 1 1  ON 14
 ud_5                -1.081729e-01 1 1  ON 15
 ud_6                -1.352319e-01 1 1  ON 16
 ud_7                -1.512307e-01 1 1  ON 17
 ud_8                -1.515941e-01 1 1  ON 18
 ud_9                -1.403368e-01 1 1  ON 19
 eO_0                -7.654811e-01 1 1  ON 20
 eO_1                -4.430631e-01 1 1  ON 21
 eO_2                -2.033773e-02 1 1  ON 22
 eO_3                 3.021828e-01 1 1  ON 23
 eO_4                 5.276829e-01 1 1  ON 24
 eO_5                 4.870253e-01 1 1  ON 25
 eO_6                 2.567076e-01 1 1  ON 26
 eO_7                -4.610926e-02 1 1  ON 27
 eO_8                -2.198012e-01 1 1  ON 28
 eO_9                -7.874324e-02 1 1  ON 29
eH1_0                -2.439980e-01 1 1  ON 30
eH1_1                -1.430280e-01 1 1  ON 31
eH1_2                -9.622625e-02 1 1  ON 32
eH1_3                -4.199552e-02 1 1  ON 33
eH1_4                 5.840819e-03 1 1  ON 34
eH1_5                 4.022862e-02 1 1  ON 35
eH1_6                 9.800149e-02 1 1  ON 36
eH1_7                 1.513621e-01 1 1  ON 37
eH1_8                 1.741842e-01 1 1  ON 38
eH1_9                 5.971997e-02 1 1  ON 39
eH2_0                -2.396066e-01 1 1  ON 40
eH2_1                -1.392926e-01 1 1  ON 41
eH2_2                -9.225640e-02 1 1  ON 42
eH2_3                -3.809520e-02 1 1  ON 43
eH2_4                 9.643298e-03 1 1  ON 44
eH2_5                 4.295734e-02 1 1  ON 45
eH2_6                 9.860467e-02 1 1  ON 46
eH2_7                 1.505059e-01 1 1  ON 47
eH2_8                 1.771418e-01 1 1  ON 48
eH2_9                 4.757770e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0261e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9129
    reference variance = 0.265866
====================================================
  Execution time = 3.7217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340400984415
                                         uncertainty =       0.007699560639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340400984415
                                         uncertainty =       0.007699560639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412571453
  error estimate for blocks of size 2^( 2) =       0.000425004327
  error estimate for blocks of size 2^( 3) =       0.000437572693
  error estimate for blocks of size 2^( 4) =       0.000449159142
  error estimate for blocks of size 2^( 5) =       0.000459519873
  error estimate for blocks of size 2^( 6) =       0.000467909790
  error estimate for blocks of size 2^( 7) =       0.000473113891

      target function =                  N/A
              le_mean =     -16.905580655165
             les_mean =     286.139087526280
             stat err =       0.000462425674
             autocorr =       1.256277339679
              std dev =       0.583464144759
             le_variance =       0.340430408219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558065516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580655165       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580664285       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580667757       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580669598       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580672200       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580674102       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580674749       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580675128       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.482844e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580655165       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580657448       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580658318       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580658778       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580659428       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580659903       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580660068       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580660162       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.207908e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580655165       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580655736       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580655953       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580656068       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580656231       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580656351       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580656390       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580656415       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.552027e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7310e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091460e-01 1 1  ON 0
 uu_1                 1.427527e-01 1 1  ON 1
 uu_2                 4.132879e-02 1 1  ON 2
 uu_3                -2.109888e-02 1 1  ON 3
 uu_4                -6.616909e-02 1 1  ON 4
 uu_5                -1.002243e-01 1 1  ON 5
 uu_6                -1.268842e-01 1 1  ON 6
 uu_7                -1.398145e-01 1 1  ON 7
 uu_8                -1.320441e-01 1 1  ON 8
 uu_9                -1.020656e-01 1 1  ON 9
 ud_0                 4.496163e-01 1 1  ON 10
 ud_1                 1.833600e-01 1 1  ON 11
 ud_2                 6.207987e-02 1 1  ON 12
 ud_3                -9.863015e-03 1 1  ON 13
 ud_4                -6.695623e-02 1 1  ON 14
 ud_5                -1.081727e-01 1 1  ON 15
 ud_6                -1.352318e-01 1 1  ON 16
 ud_7                -1.512309e-01 1 1  ON 17
 ud_8                -1.515943e-01 1 1  ON 18
 ud_9                -1.403371e-01 1 1  ON 19
 eO_0                -7.654812e-01 1 1  ON 20
 eO_1                -4.430628e-01 1 1  ON 21
 eO_2                -2.033778e-02 1 1  ON 22
 eO_3                 3.021829e-01 1 1  ON 23
 eO_4                 5.276828e-01 1 1  ON 24
 eO_5                 4.870254e-01 1 1  ON 25
 eO_6                 2.567082e-01 1 1  ON 26
 eO_7                -4.610918e-02 1 1  ON 27
 eO_8                -2.198016e-01 1 1  ON 28
 eO_9                -7.874357e-02 1 1  ON 29
eH1_0                -2.439982e-01 1 1  ON 30
eH1_1                -1.430280e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199556e-02 1 1  ON 33
eH1_4                 5.840668e-03 1 1  ON 34
eH1_5                 4.022841e-02 1 1  ON 35
eH1_6                 9.800134e-02 1 1  ON 36
eH1_7                 1.513621e-01 1 1  ON 37
eH1_8                 1.741845e-01 1 1  ON 38
eH1_9                 5.972035e-02 1 1  ON 39
eH2_0                -2.396069e-01 1 1  ON 40
eH2_1                -1.392925e-01 1 1  ON 41
eH2_2                -9.225664e-02 1 1  ON 42
eH2_3                -3.809551e-02 1 1  ON 43
eH2_4                 9.642918e-03 1 1  ON 44
eH2_5                 4.295730e-02 1 1  ON 45
eH2_6                 9.860465e-02 1 1  ON 46
eH2_7                 1.505062e-01 1 1  ON 47
eH2_8                 1.771422e-01 1 1  ON 48
eH2_9                 4.757832e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.223373
====================================================
  Execution time = 3.6034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2994e-01
  Total weights = 2.0000e+06
  Execution time = 3.3512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329956968593
                                         uncertainty =       0.002399663677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329956968593
                                         uncertainty =       0.002399663677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406163895
  error estimate for blocks of size 2^( 2) =       0.000418803364
  error estimate for blocks of size 2^( 3) =       0.000431980600
  error estimate for blocks of size 2^( 4) =       0.000444039296
  error estimate for blocks of size 2^( 5) =       0.000454337908
  error estimate for blocks of size 2^( 6) =       0.000462164791
  error estimate for blocks of size 2^( 7) =       0.000467087870

      target function =                  N/A
              le_mean =     -16.905687354092
             les_mean =     286.132202968957
             stat err =       0.000456907466
             autocorr =       1.265475900137
              std dev =       0.574402489224
             le_variance =       0.329938219626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329957400498
                                         uncertainty =       0.002399674490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329957400498
                                         uncertainty =       0.002399674490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406164161
  error estimate for blocks of size 2^( 2) =       0.000418803575
  error estimate for blocks of size 2^( 3) =       0.000431980763
  error estimate for blocks of size 2^( 4) =       0.000444039406
  error estimate for blocks of size 2^( 5) =       0.000454338038
  error estimate for blocks of size 2^( 6) =       0.000462164863
  error estimate for blocks of size 2^( 7) =       0.000467087922

      target function =                  N/A
              le_mean =     -16.905687355164
             les_mean =     286.132203436463
             stat err =       0.000456907557
             autocorr =       1.265474750141
              std dev =       0.574402864624
             le_variance =       0.329938650889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329957184536
                                         uncertainty =       0.002399669099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329957184536
                                         uncertainty =       0.002399669099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406164028
  error estimate for blocks of size 2^( 2) =       0.000418803469
  error estimate for blocks of size 2^( 3) =       0.000431980681
  error estimate for blocks of size 2^( 4) =       0.000444039351
  error estimate for blocks of size 2^( 5) =       0.000454337973
  error estimate for blocks of size 2^( 6) =       0.000462164827
  error estimate for blocks of size 2^( 7) =       0.000467087896

      target function =                  N/A
              le_mean =     -16.905687354628
             les_mean =     286.132203202694
             stat err =       0.000456907512
             autocorr =       1.265475323744
              std dev =       0.574402676914
             le_variance =       0.329938435246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329956995579
                                         uncertainty =       0.002399664356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329956995579
                                         uncertainty =       0.002399664356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406163912
  error estimate for blocks of size 2^( 2) =       0.000418803377
  error estimate for blocks of size 2^( 3) =       0.000431980610
  error estimate for blocks of size 2^( 4) =       0.000444039303
  error estimate for blocks of size 2^( 5) =       0.000454337916
  error estimate for blocks of size 2^( 6) =       0.000462164796
  error estimate for blocks of size 2^( 7) =       0.000467087873

      target function =                  N/A
              le_mean =     -16.905687354158
             les_mean =     286.132202998145
             stat err =       0.000456907472
             autocorr =       1.265475828045
              std dev =       0.574402512679
             le_variance =       0.329938246572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905687354092        initial
     9.7656e+01     9.7656e+02             2.4828e-06       -16.905687355164  <--
     3.9062e+02     3.9062e+03             6.2079e-07       -16.905687354628
     1.5625e+03     1.5625e+04             1.5520e-07       -16.905687354158

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 5.2983e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0030e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9423
    reference variance = 0.297783
====================================================
  Execution time = 3.7055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0073e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358178675139
                                         uncertainty =       0.022203354361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358178675139
                                         uncertainty =       0.022203354361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423151384
  error estimate for blocks of size 2^( 2) =       0.000435813771
  error estimate for blocks of size 2^( 3) =       0.000448806894
  error estimate for blocks of size 2^( 4) =       0.000461158046
  error estimate for blocks of size 2^( 5) =       0.000472140786
  error estimate for blocks of size 2^( 6) =       0.000479912761
  error estimate for blocks of size 2^( 7) =       0.000484242597

      target function =                  N/A
              le_mean =     -16.905336103150
             les_mean =     286.148502769613
             stat err =       0.000474363547
             autocorr =       1.256698463999
              std dev =       0.598426426738
             le_variance =       0.358114188219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533610315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905336103150       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905336111752       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905336141206       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905336144400       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905336138363       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905336136346       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905336140265       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.742925e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905336103150       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905336105311       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905336112739       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905336113534       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905336112024       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905336111483       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905336112447       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.937519e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905336103150       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905336103691       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905336105552       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905336105750       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905336105373       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905336105235       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905336105475       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.844921e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7135e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091482e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132794e-02 1 1  ON 2
 uu_3                -2.109729e-02 1 1  ON 3
 uu_4                -6.617082e-02 1 1  ON 4
 uu_5                -1.002252e-01 1 1  ON 5
 uu_6                -1.268849e-01 1 1  ON 6
 uu_7                -1.398163e-01 1 1  ON 7
 uu_8                -1.320458e-01 1 1  ON 8
 uu_9                -1.020659e-01 1 1  ON 9
 ud_0                 4.496175e-01 1 1  ON 10
 ud_1                 1.833606e-01 1 1  ON 11
 ud_2                 6.207993e-02 1 1  ON 12
 ud_3                -9.861763e-03 1 1  ON 13
 ud_4                -6.695635e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352313e-01 1 1  ON 16
 ud_7                -1.512329e-01 1 1  ON 17
 ud_8                -1.515954e-01 1 1  ON 18
 ud_9                -1.403378e-01 1 1  ON 19
 eO_0                -7.654815e-01 1 1  ON 20
 eO_1                -4.430608e-01 1 1  ON 21
 eO_2                -2.033922e-02 1 1  ON 22
 eO_3                 3.021824e-01 1 1  ON 23
 eO_4                 5.276830e-01 1 1  ON 24
 eO_5                 4.870270e-01 1 1  ON 25
 eO_6                 2.567105e-01 1 1  ON 26
 eO_7                -4.610851e-02 1 1  ON 27
 eO_8                -2.198037e-01 1 1  ON 28
 eO_9                -7.874565e-02 1 1  ON 29
eH1_0                -2.439986e-01 1 1  ON 30
eH1_1                -1.430298e-01 1 1  ON 31
eH1_2                -9.622646e-02 1 1  ON 32
eH1_3                -4.199689e-02 1 1  ON 33
eH1_4                 5.839667e-03 1 1  ON 34
eH1_5                 4.022634e-02 1 1  ON 35
eH1_6                 9.800086e-02 1 1  ON 36
eH1_7                 1.513636e-01 1 1  ON 37
eH1_8                 1.741872e-01 1 1  ON 38
eH1_9                 5.972331e-02 1 1  ON 39
eH2_0                -2.396097e-01 1 1  ON 40
eH2_1                -1.392940e-01 1 1  ON 41
eH2_2                -9.225850e-02 1 1  ON 42
eH2_3                -3.809708e-02 1 1  ON 43
eH2_4                 9.640592e-03 1 1  ON 44
eH2_5                 4.295690e-02 1 1  ON 45
eH2_6                 9.860610e-02 1 1  ON 46
eH2_7                 1.505081e-01 1 1  ON 47
eH2_8                 1.771450e-01 1 1  ON 48
eH2_9                 4.758212e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.281185
====================================================
  Execution time = 3.5764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.0000e+06
  Execution time = 3.3421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342641307390
                                         uncertainty =       0.003969060694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342641307390
                                         uncertainty =       0.003969060694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413927621
  error estimate for blocks of size 2^( 2) =       0.000427082169
  error estimate for blocks of size 2^( 3) =       0.000440841465
  error estimate for blocks of size 2^( 4) =       0.000453980424
  error estimate for blocks of size 2^( 5) =       0.000467866527
  error estimate for blocks of size 2^( 6) =       0.000479678481
  error estimate for blocks of size 2^( 7) =       0.000486616773

      target function =                  N/A
              le_mean =     -16.904914222505
             les_mean =     286.118796849914
             stat err =       0.000472035551
             autocorr =       1.300470791504
              std dev =       0.585382055593
             le_variance =       0.342672151011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342646354313
                                         uncertainty =       0.003969105521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342646354313
                                         uncertainty =       0.003969105521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413930669
  error estimate for blocks of size 2^( 2) =       0.000427085106
  error estimate for blocks of size 2^( 3) =       0.000440844286
  error estimate for blocks of size 2^( 4) =       0.000453983164
  error estimate for blocks of size 2^( 5) =       0.000467869266
  error estimate for blocks of size 2^( 6) =       0.000479681203
  error estimate for blocks of size 2^( 7) =       0.000486619593

      target function =                  N/A
              le_mean =     -16.904914198700
             les_mean =     286.118801090857
             stat err =       0.000472038306
             autocorr =       1.300466822969
              std dev =       0.585386365391
             le_variance =       0.342677196786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342643869953
                                         uncertainty =       0.003969083368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342643869953
                                         uncertainty =       0.003969083368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413929168
  error estimate for blocks of size 2^( 2) =       0.000427083660
  error estimate for blocks of size 2^( 3) =       0.000440842898
  error estimate for blocks of size 2^( 4) =       0.000453981816
  error estimate for blocks of size 2^( 5) =       0.000467867918
  error estimate for blocks of size 2^( 6) =       0.000479679864
  error estimate for blocks of size 2^( 7) =       0.000486618206

      target function =                  N/A
              le_mean =     -16.904914210417
             les_mean =     286.118799003204
             stat err =       0.000472036951
             autocorr =       1.300468781861
              std dev =       0.585384243879
             le_variance =       0.342674712982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342641628913
                                         uncertainty =       0.003969063537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342641628913
                                         uncertainty =       0.003969063537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413927815
  error estimate for blocks of size 2^( 2) =       0.000427082356
  error estimate for blocks of size 2^( 3) =       0.000440841645
  error estimate for blocks of size 2^( 4) =       0.000453980598
  error estimate for blocks of size 2^( 5) =       0.000467866702
  error estimate for blocks of size 2^( 6) =       0.000479678655
  error estimate for blocks of size 2^( 7) =       0.000486616953

      target function =                  N/A
              le_mean =     -16.904914220984
             les_mean =     286.118797119949
             stat err =       0.000472035727
             autocorr =       1.300470539513
              std dev =       0.585382330156
             le_variance =       0.342672472459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904914222505        initial  <--
     2.4414e+01     2.4414e+02             7.7429e-06       -16.904914198700
     9.7656e+01     9.7656e+02             1.9375e-06       -16.904914210417
     3.9062e+02     3.9062e+03             4.8449e-07       -16.904914220984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.6114
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8886
    reference variance = 0.235561
====================================================
  Execution time = 3.6805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0415e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340185784879
                                         uncertainty =       0.003637401125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340185784879
                                         uncertainty =       0.003637401125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412475476
  error estimate for blocks of size 2^( 2) =       0.000425366898
  error estimate for blocks of size 2^( 3) =       0.000438351939
  error estimate for blocks of size 2^( 4) =       0.000450132545
  error estimate for blocks of size 2^( 5) =       0.000461224705
  error estimate for blocks of size 2^( 6) =       0.000469545513
  error estimate for blocks of size 2^( 7) =       0.000475375462

      target function =                  N/A
              le_mean =     -16.906087507721
             les_mean =     286.156066684861
             stat err =       0.000464069556
             autocorr =       1.265813996931
              std dev =       0.583328412037
             le_variance =       0.340272036289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608750772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087507721       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087508423       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087509445       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087510423       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087512699       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087513701       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087513301       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087513231       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.268941e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087507721       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087507896       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087508152       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087508396       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087508966       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087509216       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087509116       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087509098       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.067375e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087507721       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087507765       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087507828       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087507890       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087508032       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087508096       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087508069       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087508066       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.168525e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0283e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427537e-01 1 1  ON 1
 uu_2                 4.132812e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616952e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320455e-01 1 1  ON 8
 uu_9                -1.020663e-01 1 1  ON 9
 ud_0                 4.496161e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207941e-02 1 1  ON 12
 ud_3                -9.862164e-03 1 1  ON 13
 ud_4                -6.695636e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352315e-01 1 1  ON 16
 ud_7                -1.512313e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403382e-01 1 1  ON 19
 eO_0                -7.654815e-01 1 1  ON 20
 eO_1                -4.430617e-01 1 1  ON 21
 eO_2                -2.033796e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276822e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610885e-02 1 1  ON 27
 eO_8                -2.198030e-01 1 1  ON 28
 eO_9                -7.874474e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430282e-01 1 1  ON 31
eH1_2                -9.622629e-02 1 1  ON 32
eH1_3                -4.199564e-02 1 1  ON 33
eH1_4                 5.840176e-03 1 1  ON 34
eH1_5                 4.022787e-02 1 1  ON 35
eH1_6                 9.800095e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972163e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392925e-01 1 1  ON 41
eH2_2                -9.225748e-02 1 1  ON 42
eH2_3                -3.809659e-02 1 1  ON 43
eH2_4                 9.641671e-03 1 1  ON 44
eH2_5                 4.295716e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505070e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0239
    reference variance = 0.381637
====================================================
  Execution time = 3.6971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4206e-01
  Total weights = 2.0000e+06
  Execution time = 3.3564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047242514
                                         uncertainty =       0.004608283141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047242514
                                         uncertainty =       0.004608283141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556906
  error estimate for blocks of size 2^( 2) =       0.000426345791
  error estimate for blocks of size 2^( 3) =       0.000439909672
  error estimate for blocks of size 2^( 4) =       0.000452357206
  error estimate for blocks of size 2^( 5) =       0.000463350623
  error estimate for blocks of size 2^( 6) =       0.000471205796
  error estimate for blocks of size 2^( 7) =       0.000477588055

      target function =                  N/A
              le_mean =     -16.905273967999
             les_mean =     286.130346390413
             stat err =       0.000466125420
             autocorr =       1.270384017595
              std dev =       0.584857784709
             le_variance =       0.342058628335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342046938217
                                         uncertainty =       0.004608280762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342046938217
                                         uncertainty =       0.004608280762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556722
  error estimate for blocks of size 2^( 2) =       0.000426345605
  error estimate for blocks of size 2^( 3) =       0.000439909483
  error estimate for blocks of size 2^( 4) =       0.000452357016
  error estimate for blocks of size 2^( 5) =       0.000463350432
  error estimate for blocks of size 2^( 6) =       0.000471205615
  error estimate for blocks of size 2^( 7) =       0.000477587868

      target function =                  N/A
              le_mean =     -16.905273967676
             les_mean =     286.130346075089
             stat err =       0.000466125233
             autocorr =       1.270384128035
              std dev =       0.584857524482
             le_variance =       0.342058323943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047090199
                                         uncertainty =       0.004608281950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047090199
                                         uncertainty =       0.004608281950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556813
  error estimate for blocks of size 2^( 2) =       0.000426345698
  error estimate for blocks of size 2^( 3) =       0.000439909577
  error estimate for blocks of size 2^( 4) =       0.000452357111
  error estimate for blocks of size 2^( 5) =       0.000463350528
  error estimate for blocks of size 2^( 6) =       0.000471205705
  error estimate for blocks of size 2^( 7) =       0.000477587961

      target function =                  N/A
              le_mean =     -16.905273967838
             les_mean =     286.130346232591
             stat err =       0.000466125326
             autocorr =       1.270384072886
              std dev =       0.584857654453
             le_variance =       0.342058475973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047223469
                                         uncertainty =       0.004608282992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342047223469
                                         uncertainty =       0.004608282992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556894
  error estimate for blocks of size 2^( 2) =       0.000426345779
  error estimate for blocks of size 2^( 3) =       0.000439909660
  error estimate for blocks of size 2^( 4) =       0.000452357194
  error estimate for blocks of size 2^( 5) =       0.000463350611
  error estimate for blocks of size 2^( 6) =       0.000471205784
  error estimate for blocks of size 2^( 7) =       0.000477588043

      target function =                  N/A
              le_mean =     -16.905273967979
             les_mean =     286.130346370679
             stat err =       0.000466125408
             autocorr =       1.270384024509
              std dev =       0.584857768423
             le_variance =       0.342058609284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905273967999        initial  <--
     2.4414e+02     2.4414e+03             8.2689e-07       -16.905273967676
     9.7656e+02     9.7656e+03             2.0674e-07       -16.905273967838
     3.9062e+03     3.9062e+04             5.1685e-08       -16.905273967979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8993
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0421e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.159131
====================================================
  Execution time = 3.7450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0272e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343171260065
                                         uncertainty =       0.004867989271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343171260065
                                         uncertainty =       0.004867989271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414186602
  error estimate for blocks of size 2^( 2) =       0.000427008960
  error estimate for blocks of size 2^( 3) =       0.000439985487
  error estimate for blocks of size 2^( 4) =       0.000452473526
  error estimate for blocks of size 2^( 5) =       0.000463565510
  error estimate for blocks of size 2^( 6) =       0.000472748284
  error estimate for blocks of size 2^( 7) =       0.000474883015

      target function =                  N/A
              le_mean =     -16.906017611203
             les_mean =     286.156532381268
             stat err =       0.000465917584
             autocorr =       1.265394986587
              std dev =       0.585748309867
             le_variance =       0.343101082512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601761120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017611203       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017611362       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017611547       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017611643       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017611728       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017611673       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017611756       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.502885e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017611203       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017611243       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017611289       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017611313       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017611334       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017611328       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017611340       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.875744e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017611203       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017611213       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017611225       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017611231       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017611237       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017611232       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017611231       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.689373e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7729e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862290e-03 1 1  ON 13
 ud_4                -6.695648e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874457e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199569e-02 1 1  ON 33
eH1_4                 5.840208e-03 1 1  ON 34
eH1_5                 4.022778e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972152e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809645e-02 1 1  ON 43
eH2_4                 9.641767e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860458e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9105
    reference variance = 0.228187
====================================================
  Execution time = 3.6167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 3.3424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647354759
                                         uncertainty =       0.002686966388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647354759
                                         uncertainty =       0.002686966388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828592
  error estimate for blocks of size 2^( 2) =       0.000424203808
  error estimate for blocks of size 2^( 3) =       0.000437805469
  error estimate for blocks of size 2^( 4) =       0.000450058473
  error estimate for blocks of size 2^( 5) =       0.000461181879
  error estimate for blocks of size 2^( 6) =       0.000469009616
  error estimate for blocks of size 2^( 7) =       0.000473535557

      target function =                  N/A
              le_mean =     -16.906092643888
             les_mean =     286.153528578360
             stat err =       0.000463446381
             autocorr =       1.272558246867
              std dev =       0.580999366100
             le_variance =       0.337560263408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647340926
                                         uncertainty =       0.002686966370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647340926
                                         uncertainty =       0.002686966370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828583
  error estimate for blocks of size 2^( 2) =       0.000424203800
  error estimate for blocks of size 2^( 3) =       0.000437805462
  error estimate for blocks of size 2^( 4) =       0.000450058466
  error estimate for blocks of size 2^( 5) =       0.000461181871
  error estimate for blocks of size 2^( 6) =       0.000469009608
  error estimate for blocks of size 2^( 7) =       0.000473535548

      target function =                  N/A
              le_mean =     -16.906092643785
             les_mean =     286.153528561010
             stat err =       0.000463446373
             autocorr =       1.272558254732
              std dev =       0.580999354170
             le_variance =       0.337560249545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647347841
                                         uncertainty =       0.002686966379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647347841
                                         uncertainty =       0.002686966379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828587
  error estimate for blocks of size 2^( 2) =       0.000424203804
  error estimate for blocks of size 2^( 3) =       0.000437805466
  error estimate for blocks of size 2^( 4) =       0.000450058470
  error estimate for blocks of size 2^( 5) =       0.000461181875
  error estimate for blocks of size 2^( 6) =       0.000469009612
  error estimate for blocks of size 2^( 7) =       0.000473535553

      target function =                  N/A
              le_mean =     -16.906092643837
             les_mean =     286.153528569683
             stat err =       0.000463446377
             autocorr =       1.272558250808
              std dev =       0.580999360133
             le_variance =       0.337560256475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647353895
                                         uncertainty =       0.002686966387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337647353895
                                         uncertainty =       0.002686966387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828591
  error estimate for blocks of size 2^( 2) =       0.000424203807
  error estimate for blocks of size 2^( 3) =       0.000437805469
  error estimate for blocks of size 2^( 4) =       0.000450058473
  error estimate for blocks of size 2^( 5) =       0.000461181879
  error estimate for blocks of size 2^( 6) =       0.000469009616
  error estimate for blocks of size 2^( 7) =       0.000473535557

      target function =                  N/A
              le_mean =     -16.906092643882
             les_mean =     286.153528577275
             stat err =       0.000463446381
             autocorr =       1.272558247351
              std dev =       0.580999365354
             le_variance =       0.337560262542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906092643888        initial  <--
     2.4414e+03     2.4414e+04             7.5029e-08       -16.906092643785
     9.7656e+03     9.7656e+04             1.8757e-08       -16.906092643837
     3.9062e+04     3.9062e+05             4.6894e-09       -16.906092643882

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0120
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0075e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9185
    reference variance = 0.298527
====================================================
  Execution time = 3.7275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0105e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331434013874
                                         uncertainty =       0.002740355854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331434013874
                                         uncertainty =       0.002740355854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407112578
  error estimate for blocks of size 2^( 2) =       0.000419821193
  error estimate for blocks of size 2^( 3) =       0.000432335427
  error estimate for blocks of size 2^( 4) =       0.000443646868
  error estimate for blocks of size 2^( 5) =       0.000453361008
  error estimate for blocks of size 2^( 6) =       0.000459147457
  error estimate for blocks of size 2^( 7) =       0.000462341319

      target function =                  N/A
              le_mean =     -16.905760088705
             les_mean =     286.136205313687
             stat err =       0.000454624163
             autocorr =       1.247027377492
              std dev =       0.575744129423
             le_variance =       0.331481302565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576008871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760088705       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760088690       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760088670       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760088671       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760088665       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760088699       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760088697       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760088682       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 8.722264e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760088705       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760088702       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760088697       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760088697       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760088722       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760088671       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760088746       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760088712       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.180570e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760088705       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760088704       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760088703       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760088703       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760088670       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760088534       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760088820       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760088647       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.451427e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7388e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862300e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840215e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8247
    reference variance = 0.203725
====================================================
  Execution time = 3.6008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3786e-01
  Total weights = 2.0000e+06
  Execution time = 3.3433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900199550
                                         uncertainty =       0.003499456575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900199550
                                         uncertainty =       0.003499456575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013333
  error estimate for blocks of size 2^( 2) =       0.000423557797
  error estimate for blocks of size 2^( 3) =       0.000436310578
  error estimate for blocks of size 2^( 4) =       0.000448025852
  error estimate for blocks of size 2^( 5) =       0.000458480464
  error estimate for blocks of size 2^( 6) =       0.000466609254
  error estimate for blocks of size 2^( 7) =       0.000470049862

      target function =                  N/A
              le_mean =     -16.905751246755
             les_mean =     286.142288968454
             stat err =       0.000460791358
             autocorr =       1.256888724536
              std dev =       0.581260630220
             le_variance =       0.337863920244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900196827
                                         uncertainty =       0.003499456560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900196827
                                         uncertainty =       0.003499456560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013332
  error estimate for blocks of size 2^( 2) =       0.000423557795
  error estimate for blocks of size 2^( 3) =       0.000436310576
  error estimate for blocks of size 2^( 4) =       0.000448025851
  error estimate for blocks of size 2^( 5) =       0.000458480463
  error estimate for blocks of size 2^( 6) =       0.000466609253
  error estimate for blocks of size 2^( 7) =       0.000470049861

      target function =                  N/A
              le_mean =     -16.905751246719
             les_mean =     286.142288964515
             stat err =       0.000460791357
             autocorr =       1.256888726782
              std dev =       0.581260627879
             le_variance =       0.337863917522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900198189
                                         uncertainty =       0.003499456567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900198189
                                         uncertainty =       0.003499456567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013332
  error estimate for blocks of size 2^( 2) =       0.000423557796
  error estimate for blocks of size 2^( 3) =       0.000436310577
  error estimate for blocks of size 2^( 4) =       0.000448025852
  error estimate for blocks of size 2^( 5) =       0.000458480464
  error estimate for blocks of size 2^( 6) =       0.000466609253
  error estimate for blocks of size 2^( 7) =       0.000470049862

      target function =                  N/A
              le_mean =     -16.905751246737
             les_mean =     286.142288966485
             stat err =       0.000460791358
             autocorr =       1.256888725664
              std dev =       0.581260629049
             le_variance =       0.337863918883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900199380
                                         uncertainty =       0.003499456574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337900199380
                                         uncertainty =       0.003499456574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013333
  error estimate for blocks of size 2^( 2) =       0.000423557797
  error estimate for blocks of size 2^( 3) =       0.000436310578
  error estimate for blocks of size 2^( 4) =       0.000448025852
  error estimate for blocks of size 2^( 5) =       0.000458480464
  error estimate for blocks of size 2^( 6) =       0.000466609254
  error estimate for blocks of size 2^( 7) =       0.000470049862

      target function =                  N/A
              le_mean =     -16.905751246752
             les_mean =     286.142288968207
             stat err =       0.000460791358
             autocorr =       1.256888724678
              std dev =       0.581260630074
             le_variance =       0.337863920074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905751246755        initial  <--
     2.4414e+04     2.4414e+05             8.7223e-09       -16.905751246719
     9.7656e+04     9.7656e+05             2.1806e-09       -16.905751246737
     3.9062e+05     3.9062e+06             5.4514e-10       -16.905751246752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9468
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0034e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8395
    reference variance = 0.135377
====================================================
  Execution time = 3.7122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4485e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0307e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344888853328
                                         uncertainty =       0.004180232783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344888853328
                                         uncertainty =       0.004180232783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415239704
  error estimate for blocks of size 2^( 2) =       0.000428305496
  error estimate for blocks of size 2^( 3) =       0.000441666516
  error estimate for blocks of size 2^( 4) =       0.000453937574
  error estimate for blocks of size 2^( 5) =       0.000463622064
  error estimate for blocks of size 2^( 6) =       0.000470877184
  error estimate for blocks of size 2^( 7) =       0.000476976532

      target function =                  N/A
              le_mean =     -16.905676909368
             les_mean =     286.146759614690
             stat err =       0.000466353338
             autocorr =       1.261340774027
              std dev =       0.587237620721
             le_variance =       0.344848023190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567690937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905676909368       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905676909368       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905676909370       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905676909369       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905676909370       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676909370       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676909195       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905676909406       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.280415e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905676909368       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905676909368       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905676909368       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905676909368       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905676909306       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676909291       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676909808       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905676909287       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.320106e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905676909368       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905676909368       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905676909368       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905676909278       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905676907930       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676909571       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676909445       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905676906463       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 5.800256e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7436e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641778e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.19478
====================================================
  Execution time = 3.6649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3016e-01
  Total weights = 2.0000e+06
  Execution time = 3.3513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861631
                                         uncertainty =       0.002659977499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861631
                                         uncertainty =       0.002659977499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406299320
  error estimate for blocks of size 2^( 2) =       0.000419081395
  error estimate for blocks of size 2^( 3) =       0.000432224356
  error estimate for blocks of size 2^( 4) =       0.000444661513
  error estimate for blocks of size 2^( 5) =       0.000454451271
  error estimate for blocks of size 2^( 6) =       0.000463496072
  error estimate for blocks of size 2^( 7) =       0.000470103163

      target function =                  N/A
              le_mean =     -16.905740054687
             les_mean =     286.134204905974
             stat err =       0.000458178005
             autocorr =       1.271675437340
              std dev =       0.574594008317
             le_variance =       0.330158274393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861753
                                         uncertainty =       0.002659977502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861753
                                         uncertainty =       0.002659977502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406299320
  error estimate for blocks of size 2^( 2) =       0.000419081396
  error estimate for blocks of size 2^( 3) =       0.000432224356
  error estimate for blocks of size 2^( 4) =       0.000444661513
  error estimate for blocks of size 2^( 5) =       0.000454451271
  error estimate for blocks of size 2^( 6) =       0.000463496072
  error estimate for blocks of size 2^( 7) =       0.000470103163

      target function =                  N/A
              le_mean =     -16.905740054689
             les_mean =     286.134204906143
             stat err =       0.000458178005
             autocorr =       1.271675437232
              std dev =       0.574594008422
             le_variance =       0.330158274515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861692
                                         uncertainty =       0.002659977501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861692
                                         uncertainty =       0.002659977501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406299320
  error estimate for blocks of size 2^( 2) =       0.000419081395
  error estimate for blocks of size 2^( 3) =       0.000432224356
  error estimate for blocks of size 2^( 4) =       0.000444661513
  error estimate for blocks of size 2^( 5) =       0.000454451271
  error estimate for blocks of size 2^( 6) =       0.000463496072
  error estimate for blocks of size 2^( 7) =       0.000470103163

      target function =                  N/A
              le_mean =     -16.905740054688
             les_mean =     286.134204906059
             stat err =       0.000458178005
             autocorr =       1.271675437299
              std dev =       0.574594008369
             le_variance =       0.330158274454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861639
                                         uncertainty =       0.002659977499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144861639
                                         uncertainty =       0.002659977499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406299320
  error estimate for blocks of size 2^( 2) =       0.000419081395
  error estimate for blocks of size 2^( 3) =       0.000432224356
  error estimate for blocks of size 2^( 4) =       0.000444661513
  error estimate for blocks of size 2^( 5) =       0.000454451271
  error estimate for blocks of size 2^( 6) =       0.000463496072
  error estimate for blocks of size 2^( 7) =       0.000470103163

      target function =                  N/A
              le_mean =     -16.905740054687
             les_mean =     286.134204905985
             stat err =       0.000458178005
             autocorr =       1.271675437342
              std dev =       0.574594008323
             le_variance =       0.330158274401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905740054687        initial
     2.4414e+05     2.4414e+06             9.2804e-10       -16.905740054689  <--
     9.7656e+05     9.7656e+06             2.3201e-10       -16.905740054688
     3.9062e+06     3.9062e+07             5.8003e-11       -16.905740054687

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 5.3563e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8347
    reference variance = 0.329567
====================================================
  Execution time = 3.6819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0046e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339523945729
                                         uncertainty =       0.006299046291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339523945729
                                         uncertainty =       0.006299046291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412032244
  error estimate for blocks of size 2^( 2) =       0.000425625637
  error estimate for blocks of size 2^( 3) =       0.000438822724
  error estimate for blocks of size 2^( 4) =       0.000451652071
  error estimate for blocks of size 2^( 5) =       0.000464210439
  error estimate for blocks of size 2^( 6) =       0.000476064029
  error estimate for blocks of size 2^( 7) =       0.000483886583

      target function =                  N/A
              le_mean =     -16.906730936964
             les_mean =     286.177091946099
             stat err =       0.000468953280
             autocorr =       1.295378690261
              std dev =       0.582701588270
             le_variance =       0.339541140972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673093696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730936964       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906730936980       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906730936974       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906730936972       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906730936936       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906730936968       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906730936968       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906730936947       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.450034e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730936964       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906730936968       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906730936967       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906730936969       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906730936942       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906730936911       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906730936975       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906730936847       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.112509e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730936964       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906730936965       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906730936965       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906730936965       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906730937173       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906730936895       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906730937138       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906730938146       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.781273e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6872e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9811
    reference variance = 0.43975
====================================================
  Execution time = 3.5941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5916e-01
  Total weights = 2.0000e+06
  Execution time = 3.3554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541037
                                         uncertainty =       0.014612417111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541037
                                         uncertainty =       0.014612417111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423768678
  error estimate for blocks of size 2^( 2) =       0.000436660688
  error estimate for blocks of size 2^( 3) =       0.000449457162
  error estimate for blocks of size 2^( 4) =       0.000461521008
  error estimate for blocks of size 2^( 5) =       0.000472239380
  error estimate for blocks of size 2^( 6) =       0.000478951054
  error estimate for blocks of size 2^( 7) =       0.000485574581

      target function =                  N/A
              le_mean =     -16.905831831341
             les_mean =     286.166309514448
             stat err =       0.000474571505
             autocorr =       1.254138818270
              std dev =       0.599299411360
             le_variance =       0.359159784456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233542358
                                         uncertainty =       0.014612416977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233542358
                                         uncertainty =       0.014612416977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423768679
  error estimate for blocks of size 2^( 2) =       0.000436660689
  error estimate for blocks of size 2^( 3) =       0.000449457163
  error estimate for blocks of size 2^( 4) =       0.000461521008
  error estimate for blocks of size 2^( 5) =       0.000472239380
  error estimate for blocks of size 2^( 6) =       0.000478951055
  error estimate for blocks of size 2^( 7) =       0.000485574581

      target function =                  N/A
              le_mean =     -16.905831831322
             les_mean =     286.166309515146
             stat err =       0.000474571506
             autocorr =       1.254138817442
              std dev =       0.599299412462
             le_variance =       0.359159785777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541697
                                         uncertainty =       0.014612417044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541697
                                         uncertainty =       0.014612417044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423768678
  error estimate for blocks of size 2^( 2) =       0.000436660688
  error estimate for blocks of size 2^( 3) =       0.000449457163
  error estimate for blocks of size 2^( 4) =       0.000461521008
  error estimate for blocks of size 2^( 5) =       0.000472239380
  error estimate for blocks of size 2^( 6) =       0.000478951054
  error estimate for blocks of size 2^( 7) =       0.000485574581

      target function =                  N/A
              le_mean =     -16.905831831331
             les_mean =     286.166309514797
             stat err =       0.000474571506
             autocorr =       1.254138817853
              std dev =       0.599299411911
             le_variance =       0.359159785117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541120
                                         uncertainty =       0.014612417103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359233541120
                                         uncertainty =       0.014612417103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423768678
  error estimate for blocks of size 2^( 2) =       0.000436660688
  error estimate for blocks of size 2^( 3) =       0.000449457162
  error estimate for blocks of size 2^( 4) =       0.000461521008
  error estimate for blocks of size 2^( 5) =       0.000472239380
  error estimate for blocks of size 2^( 6) =       0.000478951054
  error estimate for blocks of size 2^( 7) =       0.000485574581

      target function =                  N/A
              le_mean =     -16.905831831340
             les_mean =     286.166309514492
             stat err =       0.000474571506
             autocorr =       1.254138818210
              std dev =       0.599299411429
             le_variance =       0.359159784539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905831831341        initial  <--
     6.1035e+04     6.1035e+05             4.4500e-09       -16.905831831322
     2.4414e+05     2.4414e+06             1.1125e-09       -16.905831831331
     9.7656e+05     9.7656e+06             2.7813e-10       -16.905831831340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8596
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9635
    reference variance = 0.321868
====================================================
  Execution time = 3.7021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3685e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0047e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336938852284
                                         uncertainty =       0.003632545212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336938852284
                                         uncertainty =       0.003632545212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410397010
  error estimate for blocks of size 2^( 2) =       0.000422923865
  error estimate for blocks of size 2^( 3) =       0.000435816563
  error estimate for blocks of size 2^( 4) =       0.000447807217
  error estimate for blocks of size 2^( 5) =       0.000457727235
  error estimate for blocks of size 2^( 6) =       0.000466481220
  error estimate for blocks of size 2^( 7) =       0.000471389482

      target function =                  N/A
              le_mean =     -16.906488686131
             les_mean =     286.166210936884
             stat err =       0.000460851288
             autocorr =       1.260994628944
              std dev =       0.580389016984
             le_variance =       0.336851411036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648868613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488686131       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488686132       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488686132       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906488686133       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906488686173       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488685985       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488686092       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488686596       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.162828e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488686131       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488686131       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488686131       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906488686320       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906488686353       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488686213       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488686837       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488686059       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 7.907036e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488686131       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488686131       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488686131       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906488693557       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906488683591       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488683061       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488685749       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488696533       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.976781e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7076e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.315634
====================================================
  Execution time = 3.5587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4634e-01
  Total weights = 2.0000e+06
  Execution time = 3.3438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021768
                                         uncertainty =       0.006940836696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021768
                                         uncertainty =       0.006940836696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416134230
  error estimate for blocks of size 2^( 2) =       0.000428995533
  error estimate for blocks of size 2^( 3) =       0.000442323363
  error estimate for blocks of size 2^( 4) =       0.000454855637
  error estimate for blocks of size 2^( 5) =       0.000465548697
  error estimate for blocks of size 2^( 6) =       0.000472572038
  error estimate for blocks of size 2^( 7) =       0.000477402258

      target function =                  N/A
              le_mean =     -16.905491434159
             les_mean =     286.141975852020
             stat err =       0.000467594658
             autocorr =       1.262618646782
              std dev =       0.588502671842
             le_variance =       0.346335394765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021944
                                         uncertainty =       0.006940836699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021944
                                         uncertainty =       0.006940836699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416134230
  error estimate for blocks of size 2^( 2) =       0.000428995533
  error estimate for blocks of size 2^( 3) =       0.000442323363
  error estimate for blocks of size 2^( 4) =       0.000454855637
  error estimate for blocks of size 2^( 5) =       0.000465548698
  error estimate for blocks of size 2^( 6) =       0.000472572038
  error estimate for blocks of size 2^( 7) =       0.000477402258

      target function =                  N/A
              le_mean =     -16.905491434159
             les_mean =     286.141975852202
             stat err =       0.000467594658
             autocorr =       1.262618646632
              std dev =       0.588502671991
             le_variance =       0.346335394940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021856
                                         uncertainty =       0.006940836698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021856
                                         uncertainty =       0.006940836698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416134230
  error estimate for blocks of size 2^( 2) =       0.000428995533
  error estimate for blocks of size 2^( 3) =       0.000442323363
  error estimate for blocks of size 2^( 4) =       0.000454855637
  error estimate for blocks of size 2^( 5) =       0.000465548697
  error estimate for blocks of size 2^( 6) =       0.000472572038
  error estimate for blocks of size 2^( 7) =       0.000477402258

      target function =                  N/A
              le_mean =     -16.905491434159
             les_mean =     286.141975852111
             stat err =       0.000467594658
             autocorr =       1.262618646698
              std dev =       0.588502671916
             le_variance =       0.346335394852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021779
                                         uncertainty =       0.006940836696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346254021779
                                         uncertainty =       0.006940836696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416134230
  error estimate for blocks of size 2^( 2) =       0.000428995533
  error estimate for blocks of size 2^( 3) =       0.000442323363
  error estimate for blocks of size 2^( 4) =       0.000454855637
  error estimate for blocks of size 2^( 5) =       0.000465548697
  error estimate for blocks of size 2^( 6) =       0.000472572038
  error estimate for blocks of size 2^( 7) =       0.000477402258

      target function =                  N/A
              le_mean =     -16.905491434159
             les_mean =     286.141975852032
             stat err =       0.000467594658
             autocorr =       1.262618646768
              std dev =       0.588502671851
             le_variance =       0.346335394776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905491434159        initial
     6.1035e+05     6.1035e+06             3.1628e-10       -16.905491434159  <--
     2.4414e+06     2.4414e+07             7.9070e-11       -16.905491434159
     9.7656e+06     9.7656e+07             1.9768e-11       -16.905491434159

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 5.2437e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7934
    reference variance = 0.548093
====================================================
  Execution time = 3.7276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3960e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0289e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339661007750
                                         uncertainty =       0.003867123158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339661007750
                                         uncertainty =       0.003867123158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412067323
  error estimate for blocks of size 2^( 2) =       0.000425090490
  error estimate for blocks of size 2^( 3) =       0.000437760953
  error estimate for blocks of size 2^( 4) =       0.000449737367
  error estimate for blocks of size 2^( 5) =       0.000460383978
  error estimate for blocks of size 2^( 6) =       0.000468252432
  error estimate for blocks of size 2^( 7) =       0.000473732430

      target function =                  N/A
              le_mean =     -16.905698601363
             les_mean =     286.142243988393
             stat err =       0.000463026552
             autocorr =       1.262628065214
              std dev =       0.582751197397
             le_variance =       0.339598958068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569860136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601363       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698601365       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698601364       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698601382       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698601394       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698601387       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698601374       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698601322       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.589339e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601363       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698601363       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698601363       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698601289       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698600992       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698600865       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698601427       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698601042       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.973349e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601363       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698601363       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698601363       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698601183       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698600771       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698601366       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698601503       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698602270       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.933374e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7676e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862301e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199567e-02 1 1  ON 33
eH1_4                 5.840214e-03 1 1  ON 34
eH1_5                 4.022780e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9335
    reference variance = 0.347599
====================================================
  Execution time = 3.6526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5080e-01
  Total weights = 2.0000e+06
  Execution time = 3.3465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932657737
                                         uncertainty =       0.016468589611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932657737
                                         uncertainty =       0.016468589611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418808252
  error estimate for blocks of size 2^( 2) =       0.000431305572
  error estimate for blocks of size 2^( 3) =       0.000444278713
  error estimate for blocks of size 2^( 4) =       0.000456061129
  error estimate for blocks of size 2^( 5) =       0.000467616796
  error estimate for blocks of size 2^( 6) =       0.000475183503
  error estimate for blocks of size 2^( 7) =       0.000478119001

      target function =                  N/A
              le_mean =     -16.906083850840
             les_mean =     286.166471700934
             stat err =       0.000469245107
             autocorr =       1.255362191403
              std dev =       0.592284310701
             le_variance =       0.350800704702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932658359
                                         uncertainty =       0.016468589634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932658359
                                         uncertainty =       0.016468589634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418808253
  error estimate for blocks of size 2^( 2) =       0.000431305572
  error estimate for blocks of size 2^( 3) =       0.000444278713
  error estimate for blocks of size 2^( 4) =       0.000456061129
  error estimate for blocks of size 2^( 5) =       0.000467616796
  error estimate for blocks of size 2^( 6) =       0.000475183504
  error estimate for blocks of size 2^( 7) =       0.000478119001

      target function =                  N/A
              le_mean =     -16.906083850842
             les_mean =     286.166471701616
             stat err =       0.000469245108
             autocorr =       1.255362190653
              std dev =       0.592284311227
             le_variance =       0.350800705325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932658048
                                         uncertainty =       0.016468589622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932658048
                                         uncertainty =       0.016468589622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418808253
  error estimate for blocks of size 2^( 2) =       0.000431305572
  error estimate for blocks of size 2^( 3) =       0.000444278713
  error estimate for blocks of size 2^( 4) =       0.000456061129
  error estimate for blocks of size 2^( 5) =       0.000467616796
  error estimate for blocks of size 2^( 6) =       0.000475183503
  error estimate for blocks of size 2^( 7) =       0.000478119001

      target function =                  N/A
              le_mean =     -16.906083850841
             les_mean =     286.166471701275
             stat err =       0.000469245107
             autocorr =       1.255362191031
              std dev =       0.592284310964
             le_variance =       0.350800705014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932657775
                                         uncertainty =       0.016468589612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350932657775
                                         uncertainty =       0.016468589612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418808253
  error estimate for blocks of size 2^( 2) =       0.000431305572
  error estimate for blocks of size 2^( 3) =       0.000444278713
  error estimate for blocks of size 2^( 4) =       0.000456061129
  error estimate for blocks of size 2^( 5) =       0.000467616796
  error estimate for blocks of size 2^( 6) =       0.000475183503
  error estimate for blocks of size 2^( 7) =       0.000478119001

      target function =                  N/A
              le_mean =     -16.906083850840
             les_mean =     286.166471700977
             stat err =       0.000469245107
             autocorr =       1.255362191357
              std dev =       0.592284310734
             le_variance =       0.350800704741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906083850840        initial
     1.5259e+05     1.5259e+06             1.5893e-09       -16.906083850842  <--
     6.1035e+05     6.1035e+06             3.9733e-10       -16.906083850841
     2.4414e+06     2.4414e+07             9.9334e-11       -16.906083850840

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 5.3379e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616946e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862300e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840213e-03 1 1  ON 34
eH1_5                 4.022779e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0107e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.249453
====================================================
  Execution time = 3.6861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333279253595
                                         uncertainty =       0.002424439040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333279253595
                                         uncertainty =       0.002424439040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408655052
  error estimate for blocks of size 2^( 2) =       0.000421751309
  error estimate for blocks of size 2^( 3) =       0.000435061851
  error estimate for blocks of size 2^( 4) =       0.000447811584
  error estimate for blocks of size 2^( 5) =       0.000459503363
  error estimate for blocks of size 2^( 6) =       0.000468448661
  error estimate for blocks of size 2^( 7) =       0.000473875607

      target function =                  N/A
              le_mean =     -16.905895426880
             les_mean =     286.143297921099
             stat err =       0.000462409804
             autocorr =       1.280384244227
              std dev =       0.577925517259
             le_variance =       0.333997903499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589542688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895426880       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895426913       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895426926       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895426907       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895426907       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895426917       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895426941       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895426920       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.119816e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895426880       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895426888       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895426891       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895426924       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895426882       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895426864       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895426830       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895427008       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.779956e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895426880       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895426882       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895426883       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895426925       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895427678       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895427341       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895426833       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895427085       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.449891e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6848e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862300e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430619e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840213e-03 1 1  ON 34
eH1_5                 4.022779e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9542
    reference variance = 0.282563
====================================================
  Execution time = 3.5952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4669e-01
  Total weights = 2.0000e+06
  Execution time = 3.3578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729834984
                                         uncertainty =       0.005698805905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729834984
                                         uncertainty =       0.005698805905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416346895
  error estimate for blocks of size 2^( 2) =       0.000429095867
  error estimate for blocks of size 2^( 3) =       0.000441782164
  error estimate for blocks of size 2^( 4) =       0.000453881803
  error estimate for blocks of size 2^( 5) =       0.000465690078
  error estimate for blocks of size 2^( 6) =       0.000474155552
  error estimate for blocks of size 2^( 7) =       0.000480698780

      target function =                  N/A
              le_mean =     -16.906588159840
             les_mean =     286.179412506459
             stat err =       0.000468606553
             autocorr =       1.266794169727
              std dev =       0.588803425056
             le_variance =       0.346689473357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729838176
                                         uncertainty =       0.005698805979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729838176
                                         uncertainty =       0.005698805979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416346897
  error estimate for blocks of size 2^( 2) =       0.000429095869
  error estimate for blocks of size 2^( 3) =       0.000441782165
  error estimate for blocks of size 2^( 4) =       0.000453881805
  error estimate for blocks of size 2^( 5) =       0.000465690080
  error estimate for blocks of size 2^( 6) =       0.000474155553
  error estimate for blocks of size 2^( 7) =       0.000480698781

      target function =                  N/A
              le_mean =     -16.906588159869
             les_mean =     286.179412510639
             stat err =       0.000468606555
             autocorr =       1.266794166564
              std dev =       0.588803427765
             le_variance =       0.346689476548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729836580
                                         uncertainty =       0.005698805942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729836580
                                         uncertainty =       0.005698805942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416346896
  error estimate for blocks of size 2^( 2) =       0.000429095868
  error estimate for blocks of size 2^( 3) =       0.000441782165
  error estimate for blocks of size 2^( 4) =       0.000453881804
  error estimate for blocks of size 2^( 5) =       0.000465690079
  error estimate for blocks of size 2^( 6) =       0.000474155553
  error estimate for blocks of size 2^( 7) =       0.000480698781

      target function =                  N/A
              le_mean =     -16.906588159855
             les_mean =     286.179412508549
             stat err =       0.000468606554
             autocorr =       1.266794168139
              std dev =       0.588803426410
             le_variance =       0.346689474953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729835183
                                         uncertainty =       0.005698805910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729835183
                                         uncertainty =       0.005698805910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416346895
  error estimate for blocks of size 2^( 2) =       0.000429095867
  error estimate for blocks of size 2^( 3) =       0.000441782164
  error estimate for blocks of size 2^( 4) =       0.000453881803
  error estimate for blocks of size 2^( 5) =       0.000465690078
  error estimate for blocks of size 2^( 6) =       0.000474155552
  error estimate for blocks of size 2^( 7) =       0.000480698780

      target function =                  N/A
              le_mean =     -16.906588159842
             les_mean =     286.179412506720
             stat err =       0.000468606553
             autocorr =       1.266794169528
              std dev =       0.588803425225
             le_variance =       0.346689473557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906588159840        initial
     3.8147e+04     3.8147e+05             7.1198e-09       -16.906588159869  <--
     1.5259e+05     1.5259e+06             1.7800e-09       -16.906588159855
     6.1035e+05     6.1035e+06             4.4499e-10       -16.906588159842

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 5.2876e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132805e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862299e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081721e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033793e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874456e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840213e-03 1 1  ON 34
eH1_5                 4.022779e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972150e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641777e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860457e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758019e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8552
    reference variance = 0.302236
====================================================
  Execution time = 3.7140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333327906405
                                         uncertainty =       0.002907234730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333327906405
                                         uncertainty =       0.002907234730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408279948
  error estimate for blocks of size 2^( 2) =       0.000421230370
  error estimate for blocks of size 2^( 3) =       0.000434426117
  error estimate for blocks of size 2^( 4) =       0.000446183274
  error estimate for blocks of size 2^( 5) =       0.000456733822
  error estimate for blocks of size 2^( 6) =       0.000466000186
  error estimate for blocks of size 2^( 7) =       0.000471499930

      target function =                  N/A
              le_mean =     -16.905763874472
             les_mean =     286.138237044367
             stat err =       0.000460104303
             autocorr =       1.269978850270
              std dev =       0.577395039516
             le_variance =       0.333385031657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576387447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763874472       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763874487       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763874498       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763874509       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763874534       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763874514       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763874527       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763874518       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.443286e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763874472       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763874476       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763874479       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763874477       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763874497       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763874495       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763874510       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763874480       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.108224e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763874472       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763874473       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763874474       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763874488       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763874457       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763874587       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763874447       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763874613       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.527057e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7114e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427535e-01 1 1  ON 1
 uu_2                 4.132804e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862298e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033794e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610895e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874457e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840211e-03 1 1  ON 34
eH1_5                 4.022779e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741853e-01 1 1  ON 38
eH1_9                 5.972151e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641774e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860458e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.853
    reference variance = 0.346727
====================================================
  Execution time = 3.6043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4400e-01
  Total weights = 2.0000e+06
  Execution time = 3.3634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101637997
                                         uncertainty =       0.006312788793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101637997
                                         uncertainty =       0.006312788793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414726493
  error estimate for blocks of size 2^( 2) =       0.000426797787
  error estimate for blocks of size 2^( 3) =       0.000439489589
  error estimate for blocks of size 2^( 4) =       0.000450937392
  error estimate for blocks of size 2^( 5) =       0.000460744858
  error estimate for blocks of size 2^( 6) =       0.000468319501
  error estimate for blocks of size 2^( 7) =       0.000471079359

      target function =                  N/A
              le_mean =     -16.905903800227
             les_mean =     286.153579258954
             stat err =       0.000462770278
             autocorr =       1.245108954518
              std dev =       0.586511831438
             le_variance =       0.343996128416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101634825
                                         uncertainty =       0.006312788728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101634825
                                         uncertainty =       0.006312788728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414726491
  error estimate for blocks of size 2^( 2) =       0.000426797786
  error estimate for blocks of size 2^( 3) =       0.000439489588
  error estimate for blocks of size 2^( 4) =       0.000450937390
  error estimate for blocks of size 2^( 5) =       0.000460744857
  error estimate for blocks of size 2^( 6) =       0.000468319500
  error estimate for blocks of size 2^( 7) =       0.000471079358

      target function =                  N/A
              le_mean =     -16.905903800251
             les_mean =     286.153579256591
             stat err =       0.000462770276
             autocorr =       1.245108958268
              std dev =       0.586511828734
             le_variance =       0.343996125245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101636411
                                         uncertainty =       0.006312788761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101636411
                                         uncertainty =       0.006312788761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414726492
  error estimate for blocks of size 2^( 2) =       0.000426797786
  error estimate for blocks of size 2^( 3) =       0.000439489589
  error estimate for blocks of size 2^( 4) =       0.000450937391
  error estimate for blocks of size 2^( 5) =       0.000460744858
  error estimate for blocks of size 2^( 6) =       0.000468319501
  error estimate for blocks of size 2^( 7) =       0.000471079359

      target function =                  N/A
              le_mean =     -16.905903800239
             les_mean =     286.153579257772
             stat err =       0.000462770277
             autocorr =       1.245108956389
              std dev =       0.586511830086
             le_variance =       0.343996126831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101637799
                                         uncertainty =       0.006312788789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101637799
                                         uncertainty =       0.006312788789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414726493
  error estimate for blocks of size 2^( 2) =       0.000426797787
  error estimate for blocks of size 2^( 3) =       0.000439489589
  error estimate for blocks of size 2^( 4) =       0.000450937391
  error estimate for blocks of size 2^( 5) =       0.000460744858
  error estimate for blocks of size 2^( 6) =       0.000468319501
  error estimate for blocks of size 2^( 7) =       0.000471079359

      target function =                  N/A
              le_mean =     -16.905903800229
             les_mean =     286.153579258806
             stat err =       0.000462770278
             autocorr =       1.245108954752
              std dev =       0.586511831269
             le_variance =       0.343996128218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905903800227        initial
     9.5367e+03     9.5367e+04             2.4433e-08       -16.905903800251  <--
     3.8147e+04     3.8147e+05             6.1082e-09       -16.905903800239
     1.5259e+05     1.5259e+06             1.5271e-09       -16.905903800229

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 5.2986e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862293e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874458e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840205e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972153e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809645e-02 1 1  ON 43
eH2_4                 9.641763e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0011e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9866
    reference variance = 0.35509
====================================================
  Execution time = 3.6583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0591e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345307147375
                                         uncertainty =       0.006776781493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345307147375
                                         uncertainty =       0.006776781493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415616611
  error estimate for blocks of size 2^( 2) =       0.000428441601
  error estimate for blocks of size 2^( 3) =       0.000440704930
  error estimate for blocks of size 2^( 4) =       0.000452300088
  error estimate for blocks of size 2^( 5) =       0.000461067414
  error estimate for blocks of size 2^( 6) =       0.000468567428
  error estimate for blocks of size 2^( 7) =       0.000471615287

      target function =                  N/A
              le_mean =     -16.907378626692
             les_mean =     286.204926188765
             stat err =       0.000463387554
             autocorr =       1.243091040568
              std dev =       0.587770648443
             le_variance =       0.345474335171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690737862669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907378626692       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907378627007       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907378626952       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907378627158       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907378626999       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907378627216       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907378627339       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907378627321       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.041066e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907378626692       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907378626771       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907378626757       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907378626809       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907378626775       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907378626822       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907378626849       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907378626850       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.602684e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907378626692       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907378626712       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907378626709       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907378626721       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907378626711       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907378626824       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907378626739       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907378626707       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.506722e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7235e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132804e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862294e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874460e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199569e-02 1 1  ON 33
eH1_4                 5.840208e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972155e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809646e-02 1 1  ON 43
eH2_4                 9.641767e-03 1 1  ON 44
eH2_5                 4.295716e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.176807
====================================================
  Execution time = 3.5899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4216e-01
  Total weights = 2.0000e+06
  Execution time = 3.3641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266289436
                                         uncertainty =       0.003324237421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266289436
                                         uncertainty =       0.003324237421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413621038
  error estimate for blocks of size 2^( 2) =       0.000426137021
  error estimate for blocks of size 2^( 3) =       0.000439308805
  error estimate for blocks of size 2^( 4) =       0.000451642177
  error estimate for blocks of size 2^( 5) =       0.000461390510
  error estimate for blocks of size 2^( 6) =       0.000468861238
  error estimate for blocks of size 2^( 7) =       0.000473650641

      target function =                  N/A
              le_mean =     -16.905926812160
             les_mean =     286.152525933179
             stat err =       0.000463886141
             autocorr =       1.257817277711
              std dev =       0.584948481626
             le_variance =       0.342164726156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266293852
                                         uncertainty =       0.003324237611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266293852
                                         uncertainty =       0.003324237611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413621041
  error estimate for blocks of size 2^( 2) =       0.000426137022
  error estimate for blocks of size 2^( 3) =       0.000439308806
  error estimate for blocks of size 2^( 4) =       0.000451642178
  error estimate for blocks of size 2^( 5) =       0.000461390511
  error estimate for blocks of size 2^( 6) =       0.000468861239
  error estimate for blocks of size 2^( 7) =       0.000473650642

      target function =                  N/A
              le_mean =     -16.905926812027
             les_mean =     286.152525933122
             stat err =       0.000463886142
             autocorr =       1.257817267270
              std dev =       0.584948485405
             le_variance =       0.342164730578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266291644
                                         uncertainty =       0.003324237516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266291644
                                         uncertainty =       0.003324237516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413621039
  error estimate for blocks of size 2^( 2) =       0.000426137022
  error estimate for blocks of size 2^( 3) =       0.000439308806
  error estimate for blocks of size 2^( 4) =       0.000451642177
  error estimate for blocks of size 2^( 5) =       0.000461390510
  error estimate for blocks of size 2^( 6) =       0.000468861239
  error estimate for blocks of size 2^( 7) =       0.000473650641

      target function =                  N/A
              le_mean =     -16.905926812094
             les_mean =     286.152525933150
             stat err =       0.000463886142
             autocorr =       1.257817272486
              std dev =       0.584948483515
             le_variance =       0.342164728367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266289712
                                         uncertainty =       0.003324237433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342266289712
                                         uncertainty =       0.003324237433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413621038
  error estimate for blocks of size 2^( 2) =       0.000426137021
  error estimate for blocks of size 2^( 3) =       0.000439308805
  error estimate for blocks of size 2^( 4) =       0.000451642177
  error estimate for blocks of size 2^( 5) =       0.000461390510
  error estimate for blocks of size 2^( 6) =       0.000468861238
  error estimate for blocks of size 2^( 7) =       0.000473650641

      target function =                  N/A
              le_mean =     -16.905926812152
             les_mean =     286.152525933175
             stat err =       0.000463886141
             autocorr =       1.257817277056
              std dev =       0.584948481862
             le_variance =       0.342164726432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905926812160        initial  <--
     2.3842e+03     2.3842e+04             1.0411e-07       -16.905926812027
     9.5367e+03     9.5367e+04             2.6027e-08       -16.905926812094
     3.8147e+04     3.8147e+05             6.5067e-09       -16.905926812152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8536
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862293e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874458e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840205e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972153e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809645e-02 1 1  ON 43
eH2_4                 9.641763e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0010e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9094
    reference variance = 0.185198
====================================================
  Execution time = 3.7065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335824518862
                                         uncertainty =       0.003225015908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335824518862
                                         uncertainty =       0.003225015908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409817802
  error estimate for blocks of size 2^( 2) =       0.000422302936
  error estimate for blocks of size 2^( 3) =       0.000435343815
  error estimate for blocks of size 2^( 4) =       0.000447658402
  error estimate for blocks of size 2^( 5) =       0.000457412773
  error estimate for blocks of size 2^( 6) =       0.000466096524
  error estimate for blocks of size 2^( 7) =       0.000471577459

      target function =                  N/A
              le_mean =     -16.905737735315
             les_mean =     286.139869469738
             stat err =       0.000460686289
             autocorr =       1.263656205024
              std dev =       0.579569894338
             le_variance =       0.335901262422


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573773532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737735315       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737735362       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737735355       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737735326       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737735339       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737735362       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737735376       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737735369       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.165006e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737735315       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737735327       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737735325       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737735308       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737735322       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737735033       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737735266       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737735350       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.912522e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737735315       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737735318       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737735318       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737735273       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737735369       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737735137       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737735319       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737734386       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.281302e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7181e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109785e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862293e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033794e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874458e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199568e-02 1 1  ON 33
eH1_4                 5.840204e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972153e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809645e-02 1 1  ON 43
eH2_4                 9.641763e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9419
    reference variance = 0.334116
====================================================
  Execution time = 3.6287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4063e-01
  Total weights = 2.0000e+06
  Execution time = 3.3606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739154992
                                         uncertainty =       0.003416013690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739154992
                                         uncertainty =       0.003416013690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691304
  error estimate for blocks of size 2^( 2) =       0.000425740880
  error estimate for blocks of size 2^( 3) =       0.000439068837
  error estimate for blocks of size 2^( 4) =       0.000452468663
  error estimate for blocks of size 2^( 5) =       0.000465562714
  error estimate for blocks of size 2^( 6) =       0.000474391680
  error estimate for blocks of size 2^( 7) =       0.000481940306

      target function =                  N/A
              le_mean =     -16.905330516577
             les_mean =     286.130827930014
             stat err =       0.000468590841
             autocorr =       1.289249448904
              std dev =       0.583633639884
             le_variance =       0.340628225605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155482
                                         uncertainty =       0.003416013719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155482
                                         uncertainty =       0.003416013719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691305
  error estimate for blocks of size 2^( 2) =       0.000425740880
  error estimate for blocks of size 2^( 3) =       0.000439068837
  error estimate for blocks of size 2^( 4) =       0.000452468663
  error estimate for blocks of size 2^( 5) =       0.000465562715
  error estimate for blocks of size 2^( 6) =       0.000474391680
  error estimate for blocks of size 2^( 7) =       0.000481940306

      target function =                  N/A
              le_mean =     -16.905330516637
             les_mean =     286.130827932508
             stat err =       0.000468590841
             autocorr =       1.289249448598
              std dev =       0.583633640304
             le_variance =       0.340628226095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155237
                                         uncertainty =       0.003416013704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155237
                                         uncertainty =       0.003416013704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691305
  error estimate for blocks of size 2^( 2) =       0.000425740880
  error estimate for blocks of size 2^( 3) =       0.000439068837
  error estimate for blocks of size 2^( 4) =       0.000452468663
  error estimate for blocks of size 2^( 5) =       0.000465562715
  error estimate for blocks of size 2^( 6) =       0.000474391680
  error estimate for blocks of size 2^( 7) =       0.000481940306

      target function =                  N/A
              le_mean =     -16.905330516607
             les_mean =     286.130827931261
             stat err =       0.000468590841
             autocorr =       1.289249448750
              std dev =       0.583633640094
             le_variance =       0.340628225850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155022
                                         uncertainty =       0.003416013692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739155022
                                         uncertainty =       0.003416013692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691305
  error estimate for blocks of size 2^( 2) =       0.000425740880
  error estimate for blocks of size 2^( 3) =       0.000439068837
  error estimate for blocks of size 2^( 4) =       0.000452468663
  error estimate for blocks of size 2^( 5) =       0.000465562714
  error estimate for blocks of size 2^( 6) =       0.000474391680
  error estimate for blocks of size 2^( 7) =       0.000481940306

      target function =                  N/A
              le_mean =     -16.905330516581
             les_mean =     286.130827930170
             stat err =       0.000468590841
             autocorr =       1.289249448889
              std dev =       0.583633639911
             le_variance =       0.340628225635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905330516577        initial
     2.3842e+04     2.3842e+05             1.1650e-08       -16.905330516637  <--
     9.5367e+04     9.5367e+05             2.9125e-09       -16.905330516607
     3.8147e+05     3.8147e+06             7.2813e-10       -16.905330516581

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 5.3231e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109784e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862290e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654817e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033794e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874458e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199569e-02 1 1  ON 33
eH1_4                 5.840203e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800091e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972154e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809645e-02 1 1  ON 43
eH2_4                 9.641763e-03 1 1  ON 44
eH2_5                 4.295717e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771435e-01 1 1  ON 48
eH2_9                 4.758022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.326279
====================================================
  Execution time = 3.6986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3808e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0084e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125364102
                                         uncertainty =       0.003793471575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338125364102
                                         uncertainty =       0.003793471575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411143916
  error estimate for blocks of size 2^( 2) =       0.000423775955
  error estimate for blocks of size 2^( 3) =       0.000436557010
  error estimate for blocks of size 2^( 4) =       0.000448717677
  error estimate for blocks of size 2^( 5) =       0.000458580948
  error estimate for blocks of size 2^( 6) =       0.000467188772
  error estimate for blocks of size 2^( 7) =       0.000470501090

      target function =                  N/A
              le_mean =     -16.906097776610
             les_mean =     286.154220502093
             stat err =       0.000461247122
             autocorr =       1.258576456002
              std dev =       0.581445301672
             le_variance =       0.338078638836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609777661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906097776610       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097776520       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097776659       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906097776635       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906097776687       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906097776731       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906097776688       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906097776695       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.639061e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906097776610       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097776587       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097776622       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906097776617       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906097776626       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906097776640       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906097776592       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906097776624       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.159775e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906097776610       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097776604       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097776613       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906097776612       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906097776616       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906097776621       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906097776617       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906097776586       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.899443e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7077e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091469e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109784e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320453e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862286e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198028e-01 1 1  ON 28
 eO_9                -7.874459e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199569e-02 1 1  ON 33
eH1_4                 5.840201e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800090e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972155e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641758e-03 1 1  ON 44
eH2_5                 4.295716e-02 1 1  ON 45
eH2_6                 9.860459e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758023e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9484
    reference variance = 0.401097
====================================================
  Execution time = 3.5921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4523e-01
  Total weights = 2.0000e+06
  Execution time = 3.3487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223637801
                                         uncertainty =       0.005422001952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223637801
                                         uncertainty =       0.005422001952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415468020
  error estimate for blocks of size 2^( 2) =       0.000428000355
  error estimate for blocks of size 2^( 3) =       0.000440845545
  error estimate for blocks of size 2^( 4) =       0.000453435440
  error estimate for blocks of size 2^( 5) =       0.000464773308
  error estimate for blocks of size 2^( 6) =       0.000473085525
  error estimate for blocks of size 2^( 7) =       0.000475447776

      target function =                  N/A
              le_mean =     -16.905340862526
             les_mean =     286.135776857277
             stat err =       0.000466685512
             autocorr =       1.261750357001
              std dev =       0.587560508975
             le_variance =       0.345227351707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223649255
                                         uncertainty =       0.005422002213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223649255
                                         uncertainty =       0.005422002213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415468027
  error estimate for blocks of size 2^( 2) =       0.000428000361
  error estimate for blocks of size 2^( 3) =       0.000440845551
  error estimate for blocks of size 2^( 4) =       0.000453435445
  error estimate for blocks of size 2^( 5) =       0.000464773313
  error estimate for blocks of size 2^( 6) =       0.000473085531
  error estimate for blocks of size 2^( 7) =       0.000475447782

      target function =                  N/A
              le_mean =     -16.905340862799
             les_mean =     286.135776877992
             stat err =       0.000466685518
             autocorr =       1.261750347432
              std dev =       0.587560518730
             le_variance =       0.345227363170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223643528
                                         uncertainty =       0.005422002083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223643528
                                         uncertainty =       0.005422002083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415468024
  error estimate for blocks of size 2^( 2) =       0.000428000358
  error estimate for blocks of size 2^( 3) =       0.000440845548
  error estimate for blocks of size 2^( 4) =       0.000453435442
  error estimate for blocks of size 2^( 5) =       0.000464773311
  error estimate for blocks of size 2^( 6) =       0.000473085528
  error estimate for blocks of size 2^( 7) =       0.000475447779

      target function =                  N/A
              le_mean =     -16.905340862663
             les_mean =     286.135776867635
             stat err =       0.000466685515
             autocorr =       1.261750352213
              std dev =       0.587560513853
             le_variance =       0.345227357439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223638517
                                         uncertainty =       0.005422001969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345223638517
                                         uncertainty =       0.005422001969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415468021
  error estimate for blocks of size 2^( 2) =       0.000428000355
  error estimate for blocks of size 2^( 3) =       0.000440845546
  error estimate for blocks of size 2^( 4) =       0.000453435440
  error estimate for blocks of size 2^( 5) =       0.000464773308
  error estimate for blocks of size 2^( 6) =       0.000473085525
  error estimate for blocks of size 2^( 7) =       0.000475447776

      target function =                  N/A
              le_mean =     -16.905340862543
             les_mean =     286.135776858572
             stat err =       0.000466685512
             autocorr =       1.261750356397
              std dev =       0.587560509584
             le_variance =       0.345227352423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905340862526        initial
     5.9605e+03     5.9605e+04             4.6391e-08       -16.905340862799  <--
     2.3842e+04     2.3842e+05             1.1598e-08       -16.905340862663
     9.5367e+04     9.5367e+05             2.8994e-09       -16.905340862543

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 5.2806e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862272e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874461e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199570e-02 1 1  ON 33
eH1_4                 5.840196e-03 1 1  ON 34
eH1_5                 4.022778e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972157e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809643e-02 1 1  ON 43
eH2_4                 9.641740e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.0497
    reference variance = 0.517825
====================================================
  Execution time = 3.6714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3992e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0100e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339805408623
                                         uncertainty =       0.004208963800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339805408623
                                         uncertainty =       0.004208963800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412263073
  error estimate for blocks of size 2^( 2) =       0.000425469380
  error estimate for blocks of size 2^( 3) =       0.000439181348
  error estimate for blocks of size 2^( 4) =       0.000451674296
  error estimate for blocks of size 2^( 5) =       0.000461817149
  error estimate for blocks of size 2^( 6) =       0.000469759747
  error estimate for blocks of size 2^( 7) =       0.000476556899

      target function =                  N/A
              le_mean =     -16.905093775646
             les_mean =     286.122117076667
             stat err =       0.000464952023
             autocorr =       1.271942299107
              std dev =       0.583028029553
             le_variance =       0.339921683244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509377565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905093775646       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905093775570       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905093775735       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905093775771       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905093775916       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905093775943       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905093775952       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.500648e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905093775646       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905093775627       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905093775668       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905093775677       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905093775714       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905093775720       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905093775720       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.751700e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905093775646       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905093775641       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905093775652       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905093775654       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905093775664       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905093775689       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905093775764       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.379298e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6928e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132801e-02 1 1  ON 2
 uu_3                -2.109782e-02 1 1  ON 3
 uu_4                -6.616948e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862258e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512313e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874463e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840195e-03 1 1  ON 34
eH1_5                 4.022774e-02 1 1  ON 35
eH1_6                 9.800087e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972160e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225739e-02 1 1  ON 42
eH2_3                -3.809643e-02 1 1  ON 43
eH2_4                 9.641730e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860461e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758027e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.290441
====================================================
  Execution time = 3.6159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.0000e+06
  Execution time = 3.3780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744819607
                                         uncertainty =       0.003075063180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744819607
                                         uncertainty =       0.003075063180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410351677
  error estimate for blocks of size 2^( 2) =       0.000423435122
  error estimate for blocks of size 2^( 3) =       0.000436996893
  error estimate for blocks of size 2^( 4) =       0.000449756783
  error estimate for blocks of size 2^( 5) =       0.000460083317
  error estimate for blocks of size 2^( 6) =       0.000468976249
  error estimate for blocks of size 2^( 7) =       0.000474332688

      target function =                  N/A
              le_mean =     -16.905258226821
             les_mean =     286.124532544208
             stat err =       0.000463287259
             autocorr =       1.274642190828
              std dev =       0.580324906504
             le_variance =       0.336776997108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744862495
                                         uncertainty =       0.003075063578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744862495
                                         uncertainty =       0.003075063578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410351703
  error estimate for blocks of size 2^( 2) =       0.000423435145
  error estimate for blocks of size 2^( 3) =       0.000436996914
  error estimate for blocks of size 2^( 4) =       0.000449756803
  error estimate for blocks of size 2^( 5) =       0.000460083337
  error estimate for blocks of size 2^( 6) =       0.000468976267
  error estimate for blocks of size 2^( 7) =       0.000474332705

      target function =                  N/A
              le_mean =     -16.905258226606
             les_mean =     286.124532579887
             stat err =       0.000463287278
             autocorr =       1.274642129118
              std dev =       0.580324943496
             le_variance =       0.336777040044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744841056
                                         uncertainty =       0.003075063379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744841056
                                         uncertainty =       0.003075063379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410351690
  error estimate for blocks of size 2^( 2) =       0.000423435134
  error estimate for blocks of size 2^( 3) =       0.000436996904
  error estimate for blocks of size 2^( 4) =       0.000449756793
  error estimate for blocks of size 2^( 5) =       0.000460083327
  error estimate for blocks of size 2^( 6) =       0.000468976258
  error estimate for blocks of size 2^( 7) =       0.000474332696

      target function =                  N/A
              le_mean =     -16.905258226713
             les_mean =     286.124532562051
             stat err =       0.000463287269
             autocorr =       1.274642159962
              std dev =       0.580324925004
             le_variance =       0.336777018581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744822288
                                         uncertainty =       0.003075063205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744822288
                                         uncertainty =       0.003075063205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410351678
  error estimate for blocks of size 2^( 2) =       0.000423435123
  error estimate for blocks of size 2^( 3) =       0.000436996895
  error estimate for blocks of size 2^( 4) =       0.000449756784
  error estimate for blocks of size 2^( 5) =       0.000460083319
  error estimate for blocks of size 2^( 6) =       0.000468976250
  error estimate for blocks of size 2^( 7) =       0.000474332689

      target function =                  N/A
              le_mean =     -16.905258226807
             les_mean =     286.124532546438
             stat err =       0.000463287261
             autocorr =       1.274642186970
              std dev =       0.580324908816
             le_variance =       0.336776999793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905258226821        initial  <--
     1.4901e+03     1.4901e+04             1.5006e-07       -16.905258226606
     5.9605e+03     5.9605e+04             3.7517e-08       -16.905258226713
     2.3842e+04     2.3842e+05             9.3793e-09       -16.905258226807

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1526
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132803e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862272e-03 1 1  ON 13
 ud_4                -6.695649e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874461e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199570e-02 1 1  ON 33
eH1_4                 5.840196e-03 1 1  ON 34
eH1_5                 4.022778e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972157e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809643e-02 1 1  ON 43
eH2_4                 9.641740e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0009e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.154183
====================================================
  Execution time = 3.6649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0041e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332490692412
                                         uncertainty =       0.003090648065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332490692412
                                         uncertainty =       0.003090648065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407785672
  error estimate for blocks of size 2^( 2) =       0.000420838518
  error estimate for blocks of size 2^( 3) =       0.000433955631
  error estimate for blocks of size 2^( 4) =       0.000446303035
  error estimate for blocks of size 2^( 5) =       0.000456414080
  error estimate for blocks of size 2^( 6) =       0.000463526470
  error estimate for blocks of size 2^( 7) =       0.000469394389

      target function =                  N/A
              le_mean =     -16.906451925746
             les_mean =     286.160694859419
             stat err =       0.000458909493
             autocorr =       1.266456157958
              std dev =       0.576696027501
             le_variance =       0.332578308136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645192575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451925746       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451925724       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451925741       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906451925776       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906451925778       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906451925818       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451925814       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906451925804       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.382663e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451925746       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451925741       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451925745       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906451925754       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906451925792       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906451925757       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451925704       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906451925681       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.456676e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906451925746       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451925745       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906451925746       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906451925766       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906451925755       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906451925697       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906451925766       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906451925792       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.641702e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6698e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862271e-03 1 1  ON 13
 ud_4                -6.695650e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610894e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874461e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199570e-02 1 1  ON 33
eH1_4                 5.840196e-03 1 1  ON 34
eH1_5                 4.022778e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972157e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809643e-02 1 1  ON 43
eH2_4                 9.641737e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860460e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9176
    reference variance = 0.175755
====================================================
  Execution time = 3.5673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4628e-01
  Total weights = 2.0000e+06
  Execution time = 3.3471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649792
                                         uncertainty =       0.005322458657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649792
                                         uncertainty =       0.005322458657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416098405
  error estimate for blocks of size 2^( 2) =       0.000428748547
  error estimate for blocks of size 2^( 3) =       0.000441790921
  error estimate for blocks of size 2^( 4) =       0.000453644283
  error estimate for blocks of size 2^( 5) =       0.000464948343
  error estimate for blocks of size 2^( 6) =       0.000472794778
  error estimate for blocks of size 2^( 7) =       0.000474696145

      target function =                  N/A
              le_mean =     -16.906375215482
             les_mean =     286.171798519266
             stat err =       0.000466520887
             autocorr =       1.257042850882
              std dev =       0.588452008021
             le_variance =       0.346275765744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308648641
                                         uncertainty =       0.005322458439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308648641
                                         uncertainty =       0.005322458439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416098405
  error estimate for blocks of size 2^( 2) =       0.000428748547
  error estimate for blocks of size 2^( 3) =       0.000441790920
  error estimate for blocks of size 2^( 4) =       0.000453644282
  error estimate for blocks of size 2^( 5) =       0.000464948342
  error estimate for blocks of size 2^( 6) =       0.000472794777
  error estimate for blocks of size 2^( 7) =       0.000474696145

      target function =                  N/A
              le_mean =     -16.906375215515
             les_mean =     286.171798519228
             stat err =       0.000466520886
             autocorr =       1.257042852885
              std dev =       0.588452007040
             le_variance =       0.346275764589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649216
                                         uncertainty =       0.005322458548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649216
                                         uncertainty =       0.005322458548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416098405
  error estimate for blocks of size 2^( 2) =       0.000428748547
  error estimate for blocks of size 2^( 3) =       0.000441790921
  error estimate for blocks of size 2^( 4) =       0.000453644282
  error estimate for blocks of size 2^( 5) =       0.000464948342
  error estimate for blocks of size 2^( 6) =       0.000472794777
  error estimate for blocks of size 2^( 7) =       0.000474696145

      target function =                  N/A
              le_mean =     -16.906375215498
             les_mean =     286.171798519247
             stat err =       0.000466520887
             autocorr =       1.257042851880
              std dev =       0.588452007530
             le_variance =       0.346275765167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649720
                                         uncertainty =       0.005322458643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346308649720
                                         uncertainty =       0.005322458643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416098405
  error estimate for blocks of size 2^( 2) =       0.000428748547
  error estimate for blocks of size 2^( 3) =       0.000441790921
  error estimate for blocks of size 2^( 4) =       0.000453644283
  error estimate for blocks of size 2^( 5) =       0.000464948343
  error estimate for blocks of size 2^( 6) =       0.000472794778
  error estimate for blocks of size 2^( 7) =       0.000474696145

      target function =                  N/A
              le_mean =     -16.906375215484
             les_mean =     286.171798519263
             stat err =       0.000466520887
             autocorr =       1.257042850999
              std dev =       0.588452007960
             le_variance =       0.346275765672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906375215482        initial
     1.4901e+04     1.4901e+05             1.3827e-08       -16.906375215515  <--
     5.9605e+04     5.9605e+05             3.4567e-09       -16.906375215498
     2.3842e+05     2.3842e+06             8.6417e-10       -16.906375215484

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 5.2554e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109783e-02 1 1  ON 3
 uu_4                -6.616947e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862267e-03 1 1  ON 13
 ud_4                -6.695650e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033795e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610893e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874462e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622623e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840196e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972158e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225738e-02 1 1  ON 42
eH2_3                -3.809643e-02 1 1  ON 43
eH2_4                 9.641727e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860461e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9259e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8369
    reference variance = 0.188816
====================================================
  Execution time = 3.6678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0058e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852611513
                                         uncertainty =       0.004324542937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852611513
                                         uncertainty =       0.004324542937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410976713
  error estimate for blocks of size 2^( 2) =       0.000423806048
  error estimate for blocks of size 2^( 3) =       0.000437208864
  error estimate for blocks of size 2^( 4) =       0.000450630450
  error estimate for blocks of size 2^( 5) =       0.000462701825
  error estimate for blocks of size 2^( 6) =       0.000473561006
  error estimate for blocks of size 2^( 7) =       0.000476074812

      target function =                  N/A
              le_mean =     -16.905802546554
             les_mean =     286.143963292189
             stat err =       0.000465742023
             autocorr =       1.284270247906
              std dev =       0.581208842003
             le_variance =       0.337803718022


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580254655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905802546554       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905802546794       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905802547031       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905802547003       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905802546941       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905802547009       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905802547043       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802547063       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.533369e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905802546554       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905802546614       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905802546673       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905802546666       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905802546652       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905802546646       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905802546669       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802546685       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.633346e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905802546554       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905802546569       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905802546584       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905802546536       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905802546578       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905802546533       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905802546585       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802546579       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.083368e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6743e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109782e-02 1 1  ON 3
 uu_4                -6.616948e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862263e-03 1 1  ON 13
 ud_4                -6.695650e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033796e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870257e-01 1 1  ON 25
 eO_6                 2.567098e-01 1 1  ON 26
 eO_7                -4.610893e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874462e-02 1 1  ON 29
eH1_0                -2.439987e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840200e-03 1 1  ON 34
eH1_5                 4.022777e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972159e-02 1 1  ON 39
eH2_0                -2.396081e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225739e-02 1 1  ON 42
eH2_3                -3.809644e-02 1 1  ON 43
eH2_4                 9.641719e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860461e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758027e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.170002
====================================================
  Execution time = 3.5533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3362e-01
  Total weights = 2.0000e+06
  Execution time = 3.3645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669322414
                                         uncertainty =       0.003005508793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669322414
                                         uncertainty =       0.003005508793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408426811
  error estimate for blocks of size 2^( 2) =       0.000421069544
  error estimate for blocks of size 2^( 3) =       0.000434615446
  error estimate for blocks of size 2^( 4) =       0.000447068370
  error estimate for blocks of size 2^( 5) =       0.000458074974
  error estimate for blocks of size 2^( 6) =       0.000463803850
  error estimate for blocks of size 2^( 7) =       0.000469388491

      target function =                  N/A
              le_mean =     -16.905539010729
             les_mean =     286.130873996875
             stat err =       0.000459583921
             autocorr =       1.266196663343
              std dev =       0.577602735792
             le_variance =       0.333624920395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669329760
                                         uncertainty =       0.003005508884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669329760
                                         uncertainty =       0.003005508884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408426816
  error estimate for blocks of size 2^( 2) =       0.000421069548
  error estimate for blocks of size 2^( 3) =       0.000434615450
  error estimate for blocks of size 2^( 4) =       0.000447068375
  error estimate for blocks of size 2^( 5) =       0.000458074978
  error estimate for blocks of size 2^( 6) =       0.000463803854
  error estimate for blocks of size 2^( 7) =       0.000469388496

      target function =                  N/A
              le_mean =     -16.905539010999
             les_mean =     286.130874013329
             stat err =       0.000459583926
             autocorr =       1.266196661653
              std dev =       0.577602742153
             le_variance =       0.333624927742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669326088
                                         uncertainty =       0.003005508839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669326088
                                         uncertainty =       0.003005508839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408426814
  error estimate for blocks of size 2^( 2) =       0.000421069546
  error estimate for blocks of size 2^( 3) =       0.000434615448
  error estimate for blocks of size 2^( 4) =       0.000447068372
  error estimate for blocks of size 2^( 5) =       0.000458074976
  error estimate for blocks of size 2^( 6) =       0.000463803852
  error estimate for blocks of size 2^( 7) =       0.000469388493

      target function =                  N/A
              le_mean =     -16.905539010864
             les_mean =     286.130874005103
             stat err =       0.000459583923
             autocorr =       1.266196662497
              std dev =       0.577602738973
             le_variance =       0.333624924069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669322873
                                         uncertainty =       0.003005508799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333669322873
                                         uncertainty =       0.003005508799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408426812
  error estimate for blocks of size 2^( 2) =       0.000421069544
  error estimate for blocks of size 2^( 3) =       0.000434615446
  error estimate for blocks of size 2^( 4) =       0.000447068371
  error estimate for blocks of size 2^( 5) =       0.000458074974
  error estimate for blocks of size 2^( 6) =       0.000463803850
  error estimate for blocks of size 2^( 7) =       0.000469388491

      target function =                  N/A
              le_mean =     -16.905539010746
             les_mean =     286.130873997903
             stat err =       0.000459583921
             autocorr =       1.266196663240
              std dev =       0.577602736190
             le_variance =       0.333624920854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905539010729        initial
     3.7253e+03     3.7253e+04             6.5334e-08       -16.905539010999  <--
     1.4901e+04     1.4901e+05             1.6333e-08       -16.905539010864
     5.9605e+04     5.9605e+05             4.0834e-09       -16.905539010746

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 5.2509e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 0.807123
====================================================
  Execution time = 3.6452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4671e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0179e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346724914366
                                         uncertainty =       0.005164688085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346724914366
                                         uncertainty =       0.005164688085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416358841
  error estimate for blocks of size 2^( 2) =       0.000429001428
  error estimate for blocks of size 2^( 3) =       0.000441868110
  error estimate for blocks of size 2^( 4) =       0.000454054969
  error estimate for blocks of size 2^( 5) =       0.000465150706
  error estimate for blocks of size 2^( 6) =       0.000472527763
  error estimate for blocks of size 2^( 7) =       0.000478553954

      target function =                  N/A
              le_mean =     -16.905895515451
             les_mean =     286.156012374859
             stat err =       0.000467571848
             autocorr =       1.261133690830
              std dev =       0.588820319688
             le_variance =       0.346709368877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589551545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895515451       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895516040       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895517430       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895517699       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895517710       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895517799       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895517670       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895517597       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.276858e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895515451       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895515598       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895515946       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895516012       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895516015       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895516038       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895516007       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895515993       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.692353e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895515451       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895515488       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895515574       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895515591       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895515576       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895515598       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895515593       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895515594       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.423101e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6763e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132800e-02 1 1  ON 2
 uu_3                -2.109778e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207939e-02 1 1  ON 12
 ud_3                -9.862256e-03 1 1  ON 13
 ud_4                -6.695653e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515948e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033801e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276822e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610889e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874468e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430282e-01 1 1  ON 31
eH1_2                -9.622626e-02 1 1  ON 32
eH1_3                -4.199573e-02 1 1  ON 33
eH1_4                 5.840201e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800088e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741855e-01 1 1  ON 38
eH1_9                 5.972168e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809653e-02 1 1  ON 43
eH2_4                 9.641698e-03 1 1  ON 44
eH2_5                 4.295711e-02 1 1  ON 45
eH2_6                 9.860462e-02 1 1  ON 46
eH2_7                 1.505069e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758038e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.410484
====================================================
  Execution time = 3.6577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4334e-01
  Total weights = 2.0000e+06
  Execution time = 3.3556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410637198
                                         uncertainty =       0.004641747412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410637198
                                         uncertainty =       0.004641747412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330872
  error estimate for blocks of size 2^( 2) =       0.000427311216
  error estimate for blocks of size 2^( 3) =       0.000440473997
  error estimate for blocks of size 2^( 4) =       0.000453360297
  error estimate for blocks of size 2^( 5) =       0.000464080130
  error estimate for blocks of size 2^( 6) =       0.000474429628
  error estimate for blocks of size 2^( 7) =       0.000481655349

      target function =                  N/A
              le_mean =     -16.905507813616
             les_mean =     286.139534407647
             stat err =       0.000468381351
             autocorr =       1.277922748960
              std dev =       0.585952338587
             le_variance =       0.343340143095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410628661
                                         uncertainty =       0.004641746605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410628661
                                         uncertainty =       0.004641746605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330867
  error estimate for blocks of size 2^( 2) =       0.000427311213
  error estimate for blocks of size 2^( 3) =       0.000440473996
  error estimate for blocks of size 2^( 4) =       0.000453360297
  error estimate for blocks of size 2^( 5) =       0.000464080132
  error estimate for blocks of size 2^( 6) =       0.000474429633
  error estimate for blocks of size 2^( 7) =       0.000481655348

      target function =                  N/A
              le_mean =     -16.905507813489
             les_mean =     286.139534394844
             stat err =       0.000468381353
             autocorr =       1.277922790702
              std dev =       0.585952331312
             le_variance =       0.343340134570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410632931
                                         uncertainty =       0.004641747008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410632931
                                         uncertainty =       0.004641747008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330869
  error estimate for blocks of size 2^( 2) =       0.000427311215
  error estimate for blocks of size 2^( 3) =       0.000440473996
  error estimate for blocks of size 2^( 4) =       0.000453360297
  error estimate for blocks of size 2^( 5) =       0.000464080131
  error estimate for blocks of size 2^( 6) =       0.000474429631
  error estimate for blocks of size 2^( 7) =       0.000481655348

      target function =                  N/A
              le_mean =     -16.905507813552
             les_mean =     286.139534401241
             stat err =       0.000468381352
             autocorr =       1.277922769843
              std dev =       0.585952334950
             le_variance =       0.343340138834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410636664
                                         uncertainty =       0.004641747361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343410636664
                                         uncertainty =       0.004641747361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330872
  error estimate for blocks of size 2^( 2) =       0.000427311216
  error estimate for blocks of size 2^( 3) =       0.000440473997
  error estimate for blocks of size 2^( 4) =       0.000453360297
  error estimate for blocks of size 2^( 5) =       0.000464080130
  error estimate for blocks of size 2^( 6) =       0.000474429628
  error estimate for blocks of size 2^( 7) =       0.000481655349

      target function =                  N/A
              le_mean =     -16.905507813608
             les_mean =     286.139534406846
             stat err =       0.000468381351
             autocorr =       1.277922751576
              std dev =       0.585952338132
             le_variance =       0.343340142563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905507813616        initial  <--
     9.3132e+02     9.3132e+03             2.2769e-07       -16.905507813489
     3.7253e+03     3.7253e+04             5.6924e-08       -16.905507813552
     1.4901e+04     1.4901e+05             1.4231e-08       -16.905507813608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4741
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0024e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9607
    reference variance = 0.23893
====================================================
  Execution time = 3.7023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0214e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377731410053
                                         uncertainty =       0.028790651234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377731410053
                                         uncertainty =       0.028790651234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434507412
  error estimate for blocks of size 2^( 2) =       0.000446406095
  error estimate for blocks of size 2^( 3) =       0.000459036383
  error estimate for blocks of size 2^( 4) =       0.000470748865
  error estimate for blocks of size 2^( 5) =       0.000481435479
  error estimate for blocks of size 2^( 6) =       0.000488744288
  error estimate for blocks of size 2^( 7) =       0.000494677317

      target function =                  N/A
              le_mean =     -16.905385194671
             les_mean =     286.169641773436
             stat err =       0.000483901488
             autocorr =       1.240279415711
              std dev =       0.614486274891
             le_variance =       0.377593382030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538519467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905385194671       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905385194806       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905385194812       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905385194871       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905385194852       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905385194869       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905385194879       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905385194886       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.272467e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905385194671       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905385194705       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905385194706       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905385194723       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905385194716       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905385194719       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905385194721       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905385194736       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.681176e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905385194671       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905385194679       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905385194680       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905385194685       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905385194696       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905385194683       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905385194626       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905385194637       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.420294e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7245e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616950e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862253e-03 1 1  ON 13
 ud_4                -6.695651e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874465e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622625e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840208e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972163e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641698e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.431109
====================================================
  Execution time = 3.6016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4518e-01
  Total weights = 2.0000e+06
  Execution time = 3.3515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070836653
                                         uncertainty =       0.004042364001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070836653
                                         uncertainty =       0.004042364001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415437823
  error estimate for blocks of size 2^( 2) =       0.000428543475
  error estimate for blocks of size 2^( 3) =       0.000441903997
  error estimate for blocks of size 2^( 4) =       0.000454123743
  error estimate for blocks of size 2^( 5) =       0.000465555371
  error estimate for blocks of size 2^( 6) =       0.000475222058
  error estimate for blocks of size 2^( 7) =       0.000479732271

      target function =                  N/A
              le_mean =     -16.906231638000
             les_mean =     286.165845194724
             stat err =       0.000468658361
             autocorr =       1.272625644527
              std dev =       0.587517803659
             le_variance =       0.345177169616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070853224
                                         uncertainty =       0.004042364164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070853224
                                         uncertainty =       0.004042364164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415437833
  error estimate for blocks of size 2^( 2) =       0.000428543485
  error estimate for blocks of size 2^( 3) =       0.000441904006
  error estimate for blocks of size 2^( 4) =       0.000454123752
  error estimate for blocks of size 2^( 5) =       0.000465555379
  error estimate for blocks of size 2^( 6) =       0.000475222065
  error estimate for blocks of size 2^( 7) =       0.000479732278

      target function =                  N/A
              le_mean =     -16.906231637915
             les_mean =     286.165845208450
             stat err =       0.000468658368
             autocorr =       1.272625625440
              std dev =       0.587517817772
             le_variance =       0.345177186200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070844938
                                         uncertainty =       0.004042364082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070844938
                                         uncertainty =       0.004042364082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415437828
  error estimate for blocks of size 2^( 2) =       0.000428543480
  error estimate for blocks of size 2^( 3) =       0.000441904001
  error estimate for blocks of size 2^( 4) =       0.000454123748
  error estimate for blocks of size 2^( 5) =       0.000465555375
  error estimate for blocks of size 2^( 6) =       0.000475222061
  error estimate for blocks of size 2^( 7) =       0.000479732274

      target function =                  N/A
              le_mean =     -16.906231637957
             les_mean =     286.165845201587
             stat err =       0.000468658364
             autocorr =       1.272625634987
              std dev =       0.587517810716
             le_variance =       0.345177177908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070837688
                                         uncertainty =       0.004042364011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345070837688
                                         uncertainty =       0.004042364011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415437824
  error estimate for blocks of size 2^( 2) =       0.000428543476
  error estimate for blocks of size 2^( 3) =       0.000441903997
  error estimate for blocks of size 2^( 4) =       0.000454123744
  error estimate for blocks of size 2^( 5) =       0.000465555372
  error estimate for blocks of size 2^( 6) =       0.000475222058
  error estimate for blocks of size 2^( 7) =       0.000479732271

      target function =                  N/A
              le_mean =     -16.906231637994
             les_mean =     286.165845195582
             stat err =       0.000468658361
             autocorr =       1.272625643333
              std dev =       0.587517804541
             le_variance =       0.345177170653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906231638000        initial  <--
     9.3132e+03     9.3132e+04             2.2725e-08       -16.906231637915
     3.7253e+04     3.7253e+05             5.6812e-09       -16.906231637957
     1.4901e+05     1.4901e+06             1.4203e-09       -16.906231637994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9133
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0017e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9497
    reference variance = 0.290796
====================================================
  Execution time = 3.7102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3722e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0045e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337295997997
                                         uncertainty =       0.003867365932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337295997997
                                         uncertainty =       0.003867365932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410620673
  error estimate for blocks of size 2^( 2) =       0.000423838214
  error estimate for blocks of size 2^( 3) =       0.000436835286
  error estimate for blocks of size 2^( 4) =       0.000449675338
  error estimate for blocks of size 2^( 5) =       0.000460339194
  error estimate for blocks of size 2^( 6) =       0.000470208839
  error estimate for blocks of size 2^( 7) =       0.000477174806

      target function =                  N/A
              le_mean =     -16.906150777022
             les_mean =     286.155152601057
             stat err =       0.000464349544
             autocorr =       1.278817075002
              std dev =       0.580705324825
             le_variance =       0.337218674280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615077702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150777022       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150777023       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150777021       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150777049       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150777003       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150777021       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150777032       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150776972       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.517067e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150777022       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150777022       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150777021       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150776991       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150777021       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150777050       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150777013       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150777162       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.292672e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150777022       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150777022       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150777022       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150777021       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150776981       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150776739       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150777457       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150777007       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.573168e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7154e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616950e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972163e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.293075
====================================================
  Execution time = 3.5964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4080e-01
  Total weights = 2.0000e+06
  Execution time = 3.3783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238339
                                         uncertainty =       0.004114168843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238339
                                         uncertainty =       0.004114168843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412795699
  error estimate for blocks of size 2^( 2) =       0.000425565458
  error estimate for blocks of size 2^( 3) =       0.000438893867
  error estimate for blocks of size 2^( 4) =       0.000450571736
  error estimate for blocks of size 2^( 5) =       0.000461305549
  error estimate for blocks of size 2^( 6) =       0.000468274461
  error estimate for blocks of size 2^( 7) =       0.000478147753

      target function =                  N/A
              le_mean =     -16.906414156486
             les_mean =     286.167640038802
             stat err =       0.000464574875
             autocorr =       1.266604740542
              std dev =       0.583781276308
             le_variance =       0.340800578568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238151
                                         uncertainty =       0.004114168833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238151
                                         uncertainty =       0.004114168833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412795699
  error estimate for blocks of size 2^( 2) =       0.000425565458
  error estimate for blocks of size 2^( 3) =       0.000438893867
  error estimate for blocks of size 2^( 4) =       0.000450571736
  error estimate for blocks of size 2^( 5) =       0.000461305549
  error estimate for blocks of size 2^( 6) =       0.000468274461
  error estimate for blocks of size 2^( 7) =       0.000478147752

      target function =                  N/A
              le_mean =     -16.906414156474
             les_mean =     286.167640038207
             stat err =       0.000464574875
             autocorr =       1.266604740972
              std dev =       0.583781276148
             le_variance =       0.340800578381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238245
                                         uncertainty =       0.004114168838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238245
                                         uncertainty =       0.004114168838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412795699
  error estimate for blocks of size 2^( 2) =       0.000425565458
  error estimate for blocks of size 2^( 3) =       0.000438893867
  error estimate for blocks of size 2^( 4) =       0.000450571736
  error estimate for blocks of size 2^( 5) =       0.000461305549
  error estimate for blocks of size 2^( 6) =       0.000468274461
  error estimate for blocks of size 2^( 7) =       0.000478147752

      target function =                  N/A
              le_mean =     -16.906414156480
             les_mean =     286.167640038504
             stat err =       0.000464574875
             autocorr =       1.266604740757
              std dev =       0.583781276228
             le_variance =       0.340800578475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238327
                                         uncertainty =       0.004114168842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340843238327
                                         uncertainty =       0.004114168842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412795699
  error estimate for blocks of size 2^( 2) =       0.000425565458
  error estimate for blocks of size 2^( 3) =       0.000438893867
  error estimate for blocks of size 2^( 4) =       0.000450571736
  error estimate for blocks of size 2^( 5) =       0.000461305549
  error estimate for blocks of size 2^( 6) =       0.000468274461
  error estimate for blocks of size 2^( 7) =       0.000478147753

      target function =                  N/A
              le_mean =     -16.906414156485
             les_mean =     286.167640038765
             stat err =       0.000464574875
             autocorr =       1.266604740572
              std dev =       0.583781276299
             le_variance =       0.340800578557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906414156486        initial  <--
     9.3132e+04     9.3132e+05             2.5171e-09       -16.906414156474
     3.7253e+05     3.7253e+06             6.2927e-10       -16.906414156480
     1.4901e+06     1.4901e+07             1.5732e-10       -16.906414156485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9319
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0009e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8925
    reference variance = 0.249694
====================================================
  Execution time = 3.7303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0028e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340352290193
                                         uncertainty =       0.003479280347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340352290193
                                         uncertainty =       0.003479280347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412550991
  error estimate for blocks of size 2^( 2) =       0.000425141012
  error estimate for blocks of size 2^( 3) =       0.000438111313
  error estimate for blocks of size 2^( 4) =       0.000450333907
  error estimate for blocks of size 2^( 5) =       0.000459832790
  error estimate for blocks of size 2^( 6) =       0.000468172348
  error estimate for blocks of size 2^( 7) =       0.000469390728

      target function =                  N/A
              le_mean =     -16.906492081939
             les_mean =     286.169870986211
             stat err =       0.000461932443
             autocorr =       1.253723198360
              std dev =       0.583435206136
             le_variance =       0.340396639759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649208194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906492081939       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906492081939       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906492081940       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906492081966       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906492081940       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906492082021       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906492081894       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906492081787       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.546876e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906492081939       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906492081939       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906492081939       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906492081983       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906492082196       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906492080969       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906492085640       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906492080152       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.367184e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906492081939       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906492081939       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906492081939       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906492082317       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906492086789       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906492063286       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906492080773       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906492085024       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.591808e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8602e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.357146
====================================================
  Execution time = 3.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3947e-01
  Total weights = 2.0000e+06
  Execution time = 3.3560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247026
                                         uncertainty =       0.005426705420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247026
                                         uncertainty =       0.005426705420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411991626
  error estimate for blocks of size 2^( 2) =       0.000424952561
  error estimate for blocks of size 2^( 3) =       0.000437813365
  error estimate for blocks of size 2^( 4) =       0.000450024748
  error estimate for blocks of size 2^( 5) =       0.000460323277
  error estimate for blocks of size 2^( 6) =       0.000468873638
  error estimate for blocks of size 2^( 7) =       0.000473937159

      target function =                  N/A
              le_mean =     -16.905554068062
             les_mean =     286.137232377989
             stat err =       0.000463289706
             autocorr =       1.264528213443
              std dev =       0.582644144877
             le_variance =       0.339474199559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596246974
                                         uncertainty =       0.005426705414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596246974
                                         uncertainty =       0.005426705414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411991626
  error estimate for blocks of size 2^( 2) =       0.000424952561
  error estimate for blocks of size 2^( 3) =       0.000437813365
  error estimate for blocks of size 2^( 4) =       0.000450024748
  error estimate for blocks of size 2^( 5) =       0.000460323277
  error estimate for blocks of size 2^( 6) =       0.000468873638
  error estimate for blocks of size 2^( 7) =       0.000473937159

      target function =                  N/A
              le_mean =     -16.905554068062
             les_mean =     286.137232377928
             stat err =       0.000463289706
             autocorr =       1.264528213493
              std dev =       0.582644144832
             le_variance =       0.339474199507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247000
                                         uncertainty =       0.005426705417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247000
                                         uncertainty =       0.005426705417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411991626
  error estimate for blocks of size 2^( 2) =       0.000424952561
  error estimate for blocks of size 2^( 3) =       0.000437813365
  error estimate for blocks of size 2^( 4) =       0.000450024748
  error estimate for blocks of size 2^( 5) =       0.000460323277
  error estimate for blocks of size 2^( 6) =       0.000468873638
  error estimate for blocks of size 2^( 7) =       0.000473937159

      target function =                  N/A
              le_mean =     -16.905554068062
             les_mean =     286.137232377958
             stat err =       0.000463289706
             autocorr =       1.264528213464
              std dev =       0.582644144854
             le_variance =       0.339474199533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247023
                                         uncertainty =       0.005426705420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339596247023
                                         uncertainty =       0.005426705420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411991626
  error estimate for blocks of size 2^( 2) =       0.000424952561
  error estimate for blocks of size 2^( 3) =       0.000437813365
  error estimate for blocks of size 2^( 4) =       0.000450024748
  error estimate for blocks of size 2^( 5) =       0.000460323277
  error estimate for blocks of size 2^( 6) =       0.000468873638
  error estimate for blocks of size 2^( 7) =       0.000473937159

      target function =                  N/A
              le_mean =     -16.905554068062
             les_mean =     286.137232377985
             stat err =       0.000463289706
             autocorr =       1.264528213455
              std dev =       0.582644144874
             le_variance =       0.339474199556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905554068062        initial  <--
     9.3132e+05     9.3132e+06             2.5469e-10       -16.905554068062
     3.7253e+06     3.7253e+07             6.3672e-11       -16.905554068062
     1.4901e+07     1.4901e+08             1.5918e-11       -16.905554068062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8336
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8923
    reference variance = 0.31564
====================================================
  Execution time = 3.6373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348647258996
                                         uncertainty =       0.009400136206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348647258996
                                         uncertainty =       0.009400136206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417536281
  error estimate for blocks of size 2^( 2) =       0.000430035391
  error estimate for blocks of size 2^( 3) =       0.000442636930
  error estimate for blocks of size 2^( 4) =       0.000453811213
  error estimate for blocks of size 2^( 5) =       0.000463305830
  error estimate for blocks of size 2^( 6) =       0.000469834186
  error estimate for blocks of size 2^( 7) =       0.000473446222

      target function =                  N/A
              le_mean =     -16.905628966696
             les_mean =     286.148963676472
             stat err =       0.000465099363
             autocorr =       1.240803621852
              std dev =       0.590485470790
             le_variance =       0.348673091214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690562896670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628966696       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628966696       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628966696       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628966696       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628966833       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905628964247       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905628962144       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905628972167       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.343606e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628966696       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628966696       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628966696       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628974096       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628966696       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905628996361       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905628971349       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905628971459       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 5.858750e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628966696       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628966696       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628966696       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628966696       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628966696       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905629105429       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905629043655       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905629171867       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.464497e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6223e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9706
    reference variance = 0.353862
====================================================
  Execution time = 3.5864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4227e-01
  Total weights = 2.0000e+06
  Execution time = 3.3679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387443
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387443
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413686175
  error estimate for blocks of size 2^( 2) =       0.000426450389
  error estimate for blocks of size 2^( 3) =       0.000439816171
  error estimate for blocks of size 2^( 4) =       0.000451815777
  error estimate for blocks of size 2^( 5) =       0.000463310417
  error estimate for blocks of size 2^( 6) =       0.000471537973
  error estimate for blocks of size 2^( 7) =       0.000477278977

      target function =                  N/A
              le_mean =     -16.905082695456
             les_mean =     286.124093272447
             stat err =       0.000465985786
             autocorr =       1.268829663979
              std dev =       0.585040599764
             le_variance =       0.342272503373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387440
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387440
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413686175
  error estimate for blocks of size 2^( 2) =       0.000426450389
  error estimate for blocks of size 2^( 3) =       0.000439816171
  error estimate for blocks of size 2^( 4) =       0.000451815777
  error estimate for blocks of size 2^( 5) =       0.000463310417
  error estimate for blocks of size 2^( 6) =       0.000471537973
  error estimate for blocks of size 2^( 7) =       0.000477278977

      target function =                  N/A
              le_mean =     -16.905082695456
             les_mean =     286.124093272445
             stat err =       0.000465985786
             autocorr =       1.268829663986
              std dev =       0.585040599762
             le_variance =       0.342272503370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387441
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387441
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413686175
  error estimate for blocks of size 2^( 2) =       0.000426450389
  error estimate for blocks of size 2^( 3) =       0.000439816171
  error estimate for blocks of size 2^( 4) =       0.000451815777
  error estimate for blocks of size 2^( 5) =       0.000463310417
  error estimate for blocks of size 2^( 6) =       0.000471537973
  error estimate for blocks of size 2^( 7) =       0.000477278977

      target function =                  N/A
              le_mean =     -16.905082695456
             les_mean =     286.124093272446
             stat err =       0.000465985786
             autocorr =       1.268829663989
              std dev =       0.585040599763
             le_variance =       0.342272503371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387442
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342134387442
                                         uncertainty =       0.005353225341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413686175
  error estimate for blocks of size 2^( 2) =       0.000426450389
  error estimate for blocks of size 2^( 3) =       0.000439816171
  error estimate for blocks of size 2^( 4) =       0.000451815777
  error estimate for blocks of size 2^( 5) =       0.000463310417
  error estimate for blocks of size 2^( 6) =       0.000471537973
  error estimate for blocks of size 2^( 7) =       0.000477278977

      target function =                  N/A
              le_mean =     -16.905082695456
             les_mean =     286.124093272446
             stat err =       0.000465985786
             autocorr =       1.268829663980
              std dev =       0.585040599764
             le_variance =       0.342272503373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905082695456        initial
     9.3132e+06     9.3132e+07             2.3436e-11       -16.905082695456  <--
     3.7253e+07     3.7253e+08             5.8588e-12       -16.905082695456
     1.4901e+08     1.4901e+09             1.4645e-12       -16.905082695456

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 5.2828e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.182087
====================================================
  Execution time = 3.6282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4092e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341041728358
                                         uncertainty =       0.004336518343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341041728358
                                         uncertainty =       0.004336518343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412867730
  error estimate for blocks of size 2^( 2) =       0.000425489603
  error estimate for blocks of size 2^( 3) =       0.000438384177
  error estimate for blocks of size 2^( 4) =       0.000450575760
  error estimate for blocks of size 2^( 5) =       0.000460891168
  error estimate for blocks of size 2^( 6) =       0.000466624554
  error estimate for blocks of size 2^( 7) =       0.000471693773

      target function =                  N/A
              le_mean =     -16.905832573059
             les_mean =     286.148094342948
             stat err =       0.000462446314
             autocorr =       1.254586946458
              std dev =       0.583883143365
             le_variance =       0.340919525105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583257306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905832573059       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905832573059       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905832573059       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905832573522       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905832572488       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905832573109       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905832575225       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905832572932       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.246902e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905832573059       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905832573059       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905832573059       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905832573059       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905832573032       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905832567898       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905832570587       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905832575380       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.311728e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905832573059       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905832573059       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905832573059       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905832573059       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905832572721       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905832559131       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905832573059       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905832569839       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 5.779342e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6392e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.361893
====================================================
  Execution time = 3.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.0000e+06
  Execution time = 3.3525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806676
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806676
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110842
  error estimate for blocks of size 2^( 2) =       0.000425465496
  error estimate for blocks of size 2^( 3) =       0.000438339201
  error estimate for blocks of size 2^( 4) =       0.000450265526
  error estimate for blocks of size 2^( 5) =       0.000461293613
  error estimate for blocks of size 2^( 6) =       0.000468912866
  error estimate for blocks of size 2^( 7) =       0.000471879811

      target function =                  N/A
              le_mean =     -16.906175122168
             les_mean =     286.158427784051
             stat err =       0.000463087954
             autocorr =       1.262696239888
              std dev =       0.582812742214
             le_variance =       0.339670692487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806604
                                         uncertainty =       0.004304866219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806604
                                         uncertainty =       0.004304866219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110842
  error estimate for blocks of size 2^( 2) =       0.000425465496
  error estimate for blocks of size 2^( 3) =       0.000438339201
  error estimate for blocks of size 2^( 4) =       0.000450265526
  error estimate for blocks of size 2^( 5) =       0.000461293613
  error estimate for blocks of size 2^( 6) =       0.000468912866
  error estimate for blocks of size 2^( 7) =       0.000471879811

      target function =                  N/A
              le_mean =     -16.906175122168
             les_mean =     286.158427783985
             stat err =       0.000463087954
             autocorr =       1.262696239958
              std dev =       0.582812742152
             le_variance =       0.339670692415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806640
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806640
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110842
  error estimate for blocks of size 2^( 2) =       0.000425465496
  error estimate for blocks of size 2^( 3) =       0.000438339201
  error estimate for blocks of size 2^( 4) =       0.000450265526
  error estimate for blocks of size 2^( 5) =       0.000461293613
  error estimate for blocks of size 2^( 6) =       0.000468912866
  error estimate for blocks of size 2^( 7) =       0.000471879811

      target function =                  N/A
              le_mean =     -16.906175122168
             les_mean =     286.158427784018
             stat err =       0.000463087954
             autocorr =       1.262696239925
              std dev =       0.582812742183
             le_variance =       0.339670692451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806671
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339516806671
                                         uncertainty =       0.004304866220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110842
  error estimate for blocks of size 2^( 2) =       0.000425465496
  error estimate for blocks of size 2^( 3) =       0.000438339201
  error estimate for blocks of size 2^( 4) =       0.000450265526
  error estimate for blocks of size 2^( 5) =       0.000461293613
  error estimate for blocks of size 2^( 6) =       0.000468912866
  error estimate for blocks of size 2^( 7) =       0.000471879811

      target function =                  N/A
              le_mean =     -16.906175122168
             les_mean =     286.158427784047
             stat err =       0.000463087954
             autocorr =       1.262696239888
              std dev =       0.582812742210
             le_variance =       0.339670692482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906175122168        initial
     2.3283e+06     2.3283e+07             9.2469e-11       -16.906175122168  <--
     9.3132e+06     9.3132e+07             2.3117e-11       -16.906175122168
     3.7253e+07     3.7253e+08             5.7793e-12       -16.906175122168

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 5.2782e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9182e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.208709
====================================================
  Execution time = 3.6274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3475e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0294e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334752761221
                                         uncertainty =       0.003185998933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334752761221
                                         uncertainty =       0.003185998933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409117534
  error estimate for blocks of size 2^( 2) =       0.000421915062
  error estimate for blocks of size 2^( 3) =       0.000435104323
  error estimate for blocks of size 2^( 4) =       0.000447498573
  error estimate for blocks of size 2^( 5) =       0.000459836702
  error estimate for blocks of size 2^( 6) =       0.000467792838
  error estimate for blocks of size 2^( 7) =       0.000476650100

      target function =                  N/A
              le_mean =     -16.905605222042
             les_mean =     286.134242069121
             stat err =       0.000462944553
             autocorr =       1.280447487643
              std dev =       0.578579564950
             le_variance =       0.334754312978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560522204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905605222042       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905605222042       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905605222042       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905605222046       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905605221880       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905605222035       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905605222433       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905605221975       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.624654e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905605222042       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905605222042       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905605222042       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905605220061       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905605224247       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905605222011       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905605222123       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905605222210       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.061632e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905605222042       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905605222042       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905605222042       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905605222042       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905605220496       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905605219537       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905605223676       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905605218049       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.265413e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7771e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8755
    reference variance = 0.245016
====================================================
  Execution time = 3.6474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3103e-01
  Total weights = 2.0000e+06
  Execution time = 3.3623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387120
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387120
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406832682
  error estimate for blocks of size 2^( 2) =       0.000419996268
  error estimate for blocks of size 2^( 3) =       0.000433307356
  error estimate for blocks of size 2^( 4) =       0.000446499540
  error estimate for blocks of size 2^( 5) =       0.000458370155
  error estimate for blocks of size 2^( 6) =       0.000466808635
  error estimate for blocks of size 2^( 7) =       0.000469476154

      target function =                  N/A
              le_mean =     -16.906424608122
             les_mean =     286.158218526647
             stat err =       0.000460288621
             autocorr =       1.280055529641
              std dev =       0.575348296283
             le_variance =       0.331025662035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387161
                                         uncertainty =       0.003057606216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387161
                                         uncertainty =       0.003057606216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406832682
  error estimate for blocks of size 2^( 2) =       0.000419996268
  error estimate for blocks of size 2^( 3) =       0.000433307356
  error estimate for blocks of size 2^( 4) =       0.000446499540
  error estimate for blocks of size 2^( 5) =       0.000458370155
  error estimate for blocks of size 2^( 6) =       0.000466808635
  error estimate for blocks of size 2^( 7) =       0.000469476154

      target function =                  N/A
              le_mean =     -16.906424608121
             les_mean =     286.158218526645
             stat err =       0.000460288621
             autocorr =       1.280055529639
              std dev =       0.575348296318
             le_variance =       0.331025662076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387140
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387140
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406832682
  error estimate for blocks of size 2^( 2) =       0.000419996268
  error estimate for blocks of size 2^( 3) =       0.000433307356
  error estimate for blocks of size 2^( 4) =       0.000446499540
  error estimate for blocks of size 2^( 5) =       0.000458370155
  error estimate for blocks of size 2^( 6) =       0.000466808635
  error estimate for blocks of size 2^( 7) =       0.000469476154

      target function =                  N/A
              le_mean =     -16.906424608122
             les_mean =     286.158218526646
             stat err =       0.000460288621
             autocorr =       1.280055529638
              std dev =       0.575348296300
             le_variance =       0.331025662056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387123
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330827387123
                                         uncertainty =       0.003057606215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406832682
  error estimate for blocks of size 2^( 2) =       0.000419996268
  error estimate for blocks of size 2^( 3) =       0.000433307356
  error estimate for blocks of size 2^( 4) =       0.000446499540
  error estimate for blocks of size 2^( 5) =       0.000458370155
  error estimate for blocks of size 2^( 6) =       0.000466808635
  error estimate for blocks of size 2^( 7) =       0.000469476154

      target function =                  N/A
              le_mean =     -16.906424608122
             les_mean =     286.158218526647
             stat err =       0.000460288621
             autocorr =       1.280055529642
              std dev =       0.575348296285
             le_variance =       0.331025662038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906424608122        initial  <--
     5.8208e+05     5.8208e+06             3.6247e-10       -16.906424608121
     2.3283e+06     2.3283e+07             9.0616e-11       -16.906424608122
     9.3132e+06     9.3132e+07             2.2654e-11       -16.906424608122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4100
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9306
    reference variance = 0.257315
====================================================
  Execution time = 3.6604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4980e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349868359277
                                         uncertainty =       0.009572871369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349868359277
                                         uncertainty =       0.009572871369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418210019
  error estimate for blocks of size 2^( 2) =       0.000431162329
  error estimate for blocks of size 2^( 3) =       0.000444116405
  error estimate for blocks of size 2^( 4) =       0.000455837490
  error estimate for blocks of size 2^( 5) =       0.000465313758
  error estimate for blocks of size 2^( 6) =       0.000471090786
  error estimate for blocks of size 2^( 7) =       0.000473918665

      target function =                  N/A
              le_mean =     -16.905506082303
             les_mean =     286.145934964481
             stat err =       0.000466540175
             autocorr =       1.244483746413
              std dev =       0.591438281301
             le_variance =       0.349799240589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690550608230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506082303       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905506082303       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905506082303       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905506081450       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905506086547       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905506083235       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905506083145       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.920692e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506082303       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905506082303       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905506082303       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905506082303       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905506082303       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905506078655       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905506025523       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 9.802816e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905506082303       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905506082303       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905506082303       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905506089577       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905506096325       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905506086435       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905506068387       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.450412e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6504e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.320899
====================================================
  Execution time = 3.6305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.0000e+06
  Execution time = 3.3461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829439
                                         uncertainty =       0.005560106235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829439
                                         uncertainty =       0.005560106235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414592646
  error estimate for blocks of size 2^( 2) =       0.000426817634
  error estimate for blocks of size 2^( 3) =       0.000439710139
  error estimate for blocks of size 2^( 4) =       0.000451745642
  error estimate for blocks of size 2^( 5) =       0.000460669518
  error estimate for blocks of size 2^( 6) =       0.000468625622
  error estimate for blocks of size 2^( 7) =       0.000473209212

      target function =                  N/A
              le_mean =     -16.906789042749
             les_mean =     286.183289688151
             stat err =       0.000463562499
             autocorr =       1.250182460663
              std dev =       0.586322542653
             le_variance =       0.343774124024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829449
                                         uncertainty =       0.005560106236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829449
                                         uncertainty =       0.005560106236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414592646
  error estimate for blocks of size 2^( 2) =       0.000426817634
  error estimate for blocks of size 2^( 3) =       0.000439710139
  error estimate for blocks of size 2^( 4) =       0.000451745642
  error estimate for blocks of size 2^( 5) =       0.000460669518
  error estimate for blocks of size 2^( 6) =       0.000468625622
  error estimate for blocks of size 2^( 7) =       0.000473209212

      target function =                  N/A
              le_mean =     -16.906789042749
             les_mean =     286.183289688172
             stat err =       0.000463562499
             autocorr =       1.250182460643
              std dev =       0.586322542662
             le_variance =       0.343774124034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829444
                                         uncertainty =       0.005560106236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829444
                                         uncertainty =       0.005560106236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414592646
  error estimate for blocks of size 2^( 2) =       0.000426817634
  error estimate for blocks of size 2^( 3) =       0.000439710139
  error estimate for blocks of size 2^( 4) =       0.000451745642
  error estimate for blocks of size 2^( 5) =       0.000460669518
  error estimate for blocks of size 2^( 6) =       0.000468625622
  error estimate for blocks of size 2^( 7) =       0.000473209212

      target function =                  N/A
              le_mean =     -16.906789042749
             les_mean =     286.183289688162
             stat err =       0.000463562499
             autocorr =       1.250182460654
              std dev =       0.586322542658
             le_variance =       0.343774124029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829440
                                         uncertainty =       0.005560106235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343841829440
                                         uncertainty =       0.005560106235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414592646
  error estimate for blocks of size 2^( 2) =       0.000426817634
  error estimate for blocks of size 2^( 3) =       0.000439710139
  error estimate for blocks of size 2^( 4) =       0.000451745642
  error estimate for blocks of size 2^( 5) =       0.000460669518
  error estimate for blocks of size 2^( 6) =       0.000468625622
  error estimate for blocks of size 2^( 7) =       0.000473209212

      target function =                  N/A
              le_mean =     -16.906789042749
             les_mean =     286.183289688153
             stat err =       0.000463562499
             autocorr =       1.250182460659
              std dev =       0.586322542654
             le_variance =       0.343774124024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906789042749        initial
     5.8208e+06     5.8208e+07             3.9207e-11       -16.906789042749  <--
     2.3283e+07     2.3283e+08             9.8028e-12       -16.906789042749
     9.3132e+07     9.3132e+08             2.4504e-12       -16.906789042749

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 5.3224e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9466
    reference variance = 0.558897
====================================================
  Execution time = 3.6367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047709457
                                         uncertainty =       0.002911937254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047709457
                                         uncertainty =       0.002911937254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410534212
  error estimate for blocks of size 2^( 2) =       0.000423187709
  error estimate for blocks of size 2^( 3) =       0.000436229152
  error estimate for blocks of size 2^( 4) =       0.000448058362
  error estimate for blocks of size 2^( 5) =       0.000457978173
  error estimate for blocks of size 2^( 6) =       0.000466282872
  error estimate for blocks of size 2^( 7) =       0.000470152301

      target function =                  N/A
              le_mean =     -16.906111009347
             les_mean =     286.153665970392
             stat err =       0.000460617927
             autocorr =       1.258876025902
              std dev =       0.580583050532
             le_variance =       0.337076678565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611100935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111009347       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111009347       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111009348       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111009348       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111010194       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111009320       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906111009160       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111011436       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.427850e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111009347       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111009347       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111009347       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111009691       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111009347       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111009535       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906111008892       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111006948       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.569626e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111009347       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111009347       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111009347       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111009347       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111010188       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111006393       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906110923625       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111014830       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 8.923801e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6365e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9637
    reference variance = 0.402306
====================================================
  Execution time = 3.6067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3654e-01
  Total weights = 2.0000e+06
  Execution time = 3.3335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379764032
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379764032
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410208152
  error estimate for blocks of size 2^( 2) =       0.000423481034
  error estimate for blocks of size 2^( 3) =       0.000437068011
  error estimate for blocks of size 2^( 4) =       0.000449769094
  error estimate for blocks of size 2^( 5) =       0.000461004298
  error estimate for blocks of size 2^( 6) =       0.000469656979
  error estimate for blocks of size 2^( 7) =       0.000475297000

      target function =                  N/A
              le_mean =     -16.905433689345
             les_mean =     286.130229513233
             stat err =       0.000463931843
             autocorr =       1.279086129083
              std dev =       0.580121932590
             le_variance =       0.336541456672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379763903
                                         uncertainty =       0.002982518518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379763903
                                         uncertainty =       0.002982518518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410208152
  error estimate for blocks of size 2^( 2) =       0.000423481034
  error estimate for blocks of size 2^( 3) =       0.000437068011
  error estimate for blocks of size 2^( 4) =       0.000449769094
  error estimate for blocks of size 2^( 5) =       0.000461004297
  error estimate for blocks of size 2^( 6) =       0.000469656979
  error estimate for blocks of size 2^( 7) =       0.000475296999

      target function =                  N/A
              le_mean =     -16.905433689345
             les_mean =     286.130229513109
             stat err =       0.000463931842
             autocorr =       1.279086129208
              std dev =       0.580121932478
             le_variance =       0.336541456542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379763968
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379763968
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410208152
  error estimate for blocks of size 2^( 2) =       0.000423481034
  error estimate for blocks of size 2^( 3) =       0.000437068011
  error estimate for blocks of size 2^( 4) =       0.000449769094
  error estimate for blocks of size 2^( 5) =       0.000461004297
  error estimate for blocks of size 2^( 6) =       0.000469656979
  error estimate for blocks of size 2^( 7) =       0.000475296999

      target function =                  N/A
              le_mean =     -16.905433689345
             les_mean =     286.130229513171
             stat err =       0.000463931843
             autocorr =       1.279086129142
              std dev =       0.580121932534
             le_variance =       0.336541456607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379764024
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379764024
                                         uncertainty =       0.002982518519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410208152
  error estimate for blocks of size 2^( 2) =       0.000423481034
  error estimate for blocks of size 2^( 3) =       0.000437068011
  error estimate for blocks of size 2^( 4) =       0.000449769094
  error estimate for blocks of size 2^( 5) =       0.000461004298
  error estimate for blocks of size 2^( 6) =       0.000469656979
  error estimate for blocks of size 2^( 7) =       0.000475297000

      target function =                  N/A
              le_mean =     -16.905433689345
             les_mean =     286.130229513225
             stat err =       0.000463931843
             autocorr =       1.279086129088
              std dev =       0.580121932583
             le_variance =       0.336541456664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905433689345        initial
     1.4552e+06     1.4552e+07             1.4278e-10       -16.905433689345  <--
     5.8208e+06     5.8208e+07             3.5696e-11       -16.905433689345
     2.3283e+07     2.3283e+08             8.9238e-12       -16.905433689345

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 5.2873e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.219793
====================================================
  Execution time = 3.6455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0449e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690047804
                                         uncertainty =       0.006272353352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690047804
                                         uncertainty =       0.006272353352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413927626
  error estimate for blocks of size 2^( 2) =       0.000426571070
  error estimate for blocks of size 2^( 3) =       0.000439534337
  error estimate for blocks of size 2^( 4) =       0.000452905754
  error estimate for blocks of size 2^( 5) =       0.000463154143
  error estimate for blocks of size 2^( 6) =       0.000469260162
  error estimate for blocks of size 2^( 7) =       0.000472648810

      target function =                  N/A
              le_mean =     -16.906240905626
             les_mean =     286.163653547047
             stat err =       0.000464492217
             autocorr =       1.259238686840
              std dev =       0.585382062705
             le_variance =       0.342672159337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624090563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240905626       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240905626       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240905629       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906240905672       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240905629       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240905629       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240905624       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240905566       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.478742e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240905626       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240905626       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240905626       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906240905626       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240905611       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240904810       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240905227       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240904855       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.369685e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240905626       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240905626       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240905626       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906240905626       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240905626       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240905829       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240904619       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240906626       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.424213e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7049e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972163e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8685
    reference variance = 0.302442
====================================================
  Execution time = 3.6348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3229e-01
  Total weights = 2.0000e+06
  Execution time = 3.3616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265961
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265961
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407608178
  error estimate for blocks of size 2^( 2) =       0.000420465372
  error estimate for blocks of size 2^( 3) =       0.000434268307
  error estimate for blocks of size 2^( 4) =       0.000447095701
  error estimate for blocks of size 2^( 5) =       0.000457995417
  error estimate for blocks of size 2^( 6) =       0.000465373710
  error estimate for blocks of size 2^( 7) =       0.000469184591

      target function =                  N/A
              le_mean =     -16.905861775176
             les_mean =     286.140451048998
             stat err =       0.000459912355
             autocorr =       1.273105441988
              std dev =       0.576445013685
             le_variance =       0.332288853802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265973
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265973
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407608178
  error estimate for blocks of size 2^( 2) =       0.000420465372
  error estimate for blocks of size 2^( 3) =       0.000434268307
  error estimate for blocks of size 2^( 4) =       0.000447095701
  error estimate for blocks of size 2^( 5) =       0.000457995417
  error estimate for blocks of size 2^( 6) =       0.000465373710
  error estimate for blocks of size 2^( 7) =       0.000469184591

      target function =                  N/A
              le_mean =     -16.905861775172
             les_mean =     286.140451048891
             stat err =       0.000459912355
             autocorr =       1.273105441948
              std dev =       0.576445013696
             le_variance =       0.332288853815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265967
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265967
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407608178
  error estimate for blocks of size 2^( 2) =       0.000420465372
  error estimate for blocks of size 2^( 3) =       0.000434268307
  error estimate for blocks of size 2^( 4) =       0.000447095701
  error estimate for blocks of size 2^( 5) =       0.000457995417
  error estimate for blocks of size 2^( 6) =       0.000465373710
  error estimate for blocks of size 2^( 7) =       0.000469184591

      target function =                  N/A
              le_mean =     -16.905861775174
             les_mean =     286.140451048945
             stat err =       0.000459912355
             autocorr =       1.273105441974
              std dev =       0.576445013690
             le_variance =       0.332288853808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265961
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332351265961
                                         uncertainty =       0.003030640509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407608178
  error estimate for blocks of size 2^( 2) =       0.000420465372
  error estimate for blocks of size 2^( 3) =       0.000434268307
  error estimate for blocks of size 2^( 4) =       0.000447095701
  error estimate for blocks of size 2^( 5) =       0.000457995417
  error estimate for blocks of size 2^( 6) =       0.000465373710
  error estimate for blocks of size 2^( 7) =       0.000469184591

      target function =                  N/A
              le_mean =     -16.905861775175
             les_mean =     286.140451048992
             stat err =       0.000459912355
             autocorr =       1.273105441990
              std dev =       0.576445013685
             le_variance =       0.332288853803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905861775176        initial  <--
     3.6380e+05     3.6380e+06             5.4787e-10       -16.905861775172
     1.4552e+06     1.4552e+07             1.3697e-10       -16.905861775174
     5.8208e+06     5.8208e+07             3.4242e-11       -16.905861775175

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2512
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0031e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9514
    reference variance = 0.195222
====================================================
  Execution time = 3.6403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4626e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346344821939
                                         uncertainty =       0.005725581428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346344821939
                                         uncertainty =       0.005725581428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416088402
  error estimate for blocks of size 2^( 2) =       0.000428419038
  error estimate for blocks of size 2^( 3) =       0.000441739899
  error estimate for blocks of size 2^( 4) =       0.000454596446
  error estimate for blocks of size 2^( 5) =       0.000464974135
  error estimate for blocks of size 2^( 6) =       0.000472697515
  error estimate for blocks of size 2^( 7) =       0.000477058993

      target function =                  N/A
              le_mean =     -16.905398238780
             les_mean =     286.138748555790
             stat err =       0.000467331772
             autocorr =       1.261477168364
              std dev =       0.588437861789
             le_variance =       0.346259117186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539823878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398238780       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398238780       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398238780       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398240306       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398238780       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398238262       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398238675       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398238940       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 5.882143e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398238780       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398238780       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398238780       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398238780       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398246596       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398229311       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398244024       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398234972       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.470538e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398238780       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398238780       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398238780       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398238780       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398274509       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398240217       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398206095       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398284645       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.676257e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6388e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972163e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.21039
====================================================
  Execution time = 3.6502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 3.3500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004729
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004729
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562916
  error estimate for blocks of size 2^( 2) =       0.000422888968
  error estimate for blocks of size 2^( 3) =       0.000435975522
  error estimate for blocks of size 2^( 4) =       0.000447389184
  error estimate for blocks of size 2^( 5) =       0.000457683668
  error estimate for blocks of size 2^( 6) =       0.000465418276
  error estimate for blocks of size 2^( 7) =       0.000468558000

      target function =                  N/A
              le_mean =     -16.905609916391
             les_mean =     286.136770292692
             stat err =       0.000459762282
             autocorr =       1.254028020805
              std dev =       0.580623644102
             le_variance =       0.337123816091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004749
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004749
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562916
  error estimate for blocks of size 2^( 2) =       0.000422888969
  error estimate for blocks of size 2^( 3) =       0.000435975522
  error estimate for blocks of size 2^( 4) =       0.000447389184
  error estimate for blocks of size 2^( 5) =       0.000457683668
  error estimate for blocks of size 2^( 6) =       0.000465418276
  error estimate for blocks of size 2^( 7) =       0.000468558000

      target function =                  N/A
              le_mean =     -16.905609916391
             les_mean =     286.136770292711
             stat err =       0.000459762282
             autocorr =       1.254028020792
              std dev =       0.580623644119
             le_variance =       0.337123816110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004739
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004739
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562916
  error estimate for blocks of size 2^( 2) =       0.000422888968
  error estimate for blocks of size 2^( 3) =       0.000435975522
  error estimate for blocks of size 2^( 4) =       0.000447389184
  error estimate for blocks of size 2^( 5) =       0.000457683668
  error estimate for blocks of size 2^( 6) =       0.000465418276
  error estimate for blocks of size 2^( 7) =       0.000468558000

      target function =                  N/A
              le_mean =     -16.905609916391
             les_mean =     286.136770292702
             stat err =       0.000459762282
             autocorr =       1.254028020800
              std dev =       0.580623644111
             le_variance =       0.337123816100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004730
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337229004730
                                         uncertainty =       0.004845706962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562916
  error estimate for blocks of size 2^( 2) =       0.000422888968
  error estimate for blocks of size 2^( 3) =       0.000435975522
  error estimate for blocks of size 2^( 4) =       0.000447389184
  error estimate for blocks of size 2^( 5) =       0.000457683668
  error estimate for blocks of size 2^( 6) =       0.000465418276
  error estimate for blocks of size 2^( 7) =       0.000468558000

      target function =                  N/A
              le_mean =     -16.905609916391
             les_mean =     286.136770292693
             stat err =       0.000459762282
             autocorr =       1.254028020799
              std dev =       0.580623644103
             le_variance =       0.337123816092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905609916391        initial  <--
     3.6380e+06     3.6380e+07             5.8821e-11       -16.905609916391
     1.4552e+07     1.4552e+08             1.4705e-11       -16.905609916391
     5.8208e+07     5.8208e+08             3.6763e-12       -16.905609916391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3854
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8802
    reference variance = 0.193515
====================================================
  Execution time = 3.6334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4072e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0092e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340781888636
                                         uncertainty =       0.004305832658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340781888636
                                         uncertainty =       0.004305832658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412745763
  error estimate for blocks of size 2^( 2) =       0.000425500426
  error estimate for blocks of size 2^( 3) =       0.000439287225
  error estimate for blocks of size 2^( 4) =       0.000451931179
  error estimate for blocks of size 2^( 5) =       0.000462367153
  error estimate for blocks of size 2^( 6) =       0.000469415886
  error estimate for blocks of size 2^( 7) =       0.000472783646

      target function =                  N/A
              le_mean =     -16.904931763687
             les_mean =     286.117435894330
             stat err =       0.000464124466
             autocorr =       1.264455871822
              std dev =       0.583710655881
             le_variance =       0.340718129789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690493176369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931763687       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931763687       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904931763687       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904931763230       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904931776065       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904931773609       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904931772948       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904931854912       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 6.827030e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931763687       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931763687       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904931763687       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904931763687       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904931814985       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904931718684       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904931828387       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904931511979       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.707224e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931763687       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931763687       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904931763687       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904931708652       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904931809570       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904931885539       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904931769829       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904931650196       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.267640e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6434e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0378
    reference variance = 0.899126
====================================================
  Execution time = 3.5738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3350e-01
  Total weights = 2.0000e+06
  Execution time = 3.3554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052890
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052890
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408353315
  error estimate for blocks of size 2^( 2) =       0.000420967804
  error estimate for blocks of size 2^( 3) =       0.000433501839
  error estimate for blocks of size 2^( 4) =       0.000444947829
  error estimate for blocks of size 2^( 5) =       0.000453515043
  error estimate for blocks of size 2^( 6) =       0.000459044553
  error estimate for blocks of size 2^( 7) =       0.000463787367

      target function =                  N/A
              le_mean =     -16.907079181538
             les_mean =     286.182831144063
             stat err =       0.000455323698
             autocorr =       1.243278253111
              std dev =       0.577498796546
             le_variance =       0.333504860012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052892
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052892
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408353315
  error estimate for blocks of size 2^( 2) =       0.000420967804
  error estimate for blocks of size 2^( 3) =       0.000433501839
  error estimate for blocks of size 2^( 4) =       0.000444947829
  error estimate for blocks of size 2^( 5) =       0.000453515043
  error estimate for blocks of size 2^( 6) =       0.000459044553
  error estimate for blocks of size 2^( 7) =       0.000463787367

      target function =                  N/A
              le_mean =     -16.907079181538
             les_mean =     286.182831144064
             stat err =       0.000455323698
             autocorr =       1.243278253107
              std dev =       0.577498796547
             le_variance =       0.333504860013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052891
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052891
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408353315
  error estimate for blocks of size 2^( 2) =       0.000420967804
  error estimate for blocks of size 2^( 3) =       0.000433501839
  error estimate for blocks of size 2^( 4) =       0.000444947829
  error estimate for blocks of size 2^( 5) =       0.000453515043
  error estimate for blocks of size 2^( 6) =       0.000459044553
  error estimate for blocks of size 2^( 7) =       0.000463787367

      target function =                  N/A
              le_mean =     -16.907079181538
             les_mean =     286.182831144063
             stat err =       0.000455323698
             autocorr =       1.243278253106
              std dev =       0.577498796546
             le_variance =       0.333504860013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052890
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332468052890
                                         uncertainty =       0.002954693228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408353315
  error estimate for blocks of size 2^( 2) =       0.000420967804
  error estimate for blocks of size 2^( 3) =       0.000433501839
  error estimate for blocks of size 2^( 4) =       0.000444947829
  error estimate for blocks of size 2^( 5) =       0.000453515043
  error estimate for blocks of size 2^( 6) =       0.000459044553
  error estimate for blocks of size 2^( 7) =       0.000463787367

      target function =                  N/A
              le_mean =     -16.907079181538
             les_mean =     286.182831144063
             stat err =       0.000455323698
             autocorr =       1.243278253105
              std dev =       0.577498796546
             le_variance =       0.333504860012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907079181538        initial
     3.6380e+07     3.6380e+08             6.8270e-12       -16.907079181538
     1.4552e+08     1.4552e+09             1.7072e-12       -16.907079181538
     5.8208e+08     5.8208e+09             4.2676e-13       -16.907079181538  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+08     and shift_s =   5.8208e+09
*****************************************************************************

  Execution time = 5.2652e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0715
    reference variance = 1.17159
====================================================
  Execution time = 3.6488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0433e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343179999574
                                         uncertainty =       0.003688490608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343179999574
                                         uncertainty =       0.003688490608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414263642
  error estimate for blocks of size 2^( 2) =       0.000426905009
  error estimate for blocks of size 2^( 3) =       0.000439888252
  error estimate for blocks of size 2^( 4) =       0.000452101736
  error estimate for blocks of size 2^( 5) =       0.000461241247
  error estimate for blocks of size 2^( 6) =       0.000468886645
  error estimate for blocks of size 2^( 7) =       0.000474568913

      target function =                  N/A
              le_mean =     -16.906023276427
             les_mean =     286.156851581616
             stat err =       0.000464199635
             autocorr =       1.255613428912
              std dev =       0.585857260883
             le_variance =       0.343228730130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602327643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023276427       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023276427       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023276427       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023276427       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906023276427       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023258559       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023247177       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023360614       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.815040e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023276427       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023276427       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023276427       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023275944       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906022991379       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024001537       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023289791       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023091804       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.538242e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023276427       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023276427       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023276427       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023300818       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906024041713       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023276427       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021754741       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023313185       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.133176e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7350e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8287
    reference variance = 0.340756
====================================================
  Execution time = 3.6171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4065e-01
  Total weights = 2.0000e+06
  Execution time = 3.3454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412703750
  error estimate for blocks of size 2^( 2) =       0.000425624335
  error estimate for blocks of size 2^( 3) =       0.000438054453
  error estimate for blocks of size 2^( 4) =       0.000449183076
  error estimate for blocks of size 2^( 5) =       0.000458978773
  error estimate for blocks of size 2^( 6) =       0.000466654213
  error estimate for blocks of size 2^( 7) =       0.000470587440

      target function =                  N/A
              le_mean =     -16.906740821779
             les_mean =     286.178533815390
             stat err =       0.000461350875
             autocorr =       1.249642729436
              std dev =       0.583651240819
             le_variance =       0.340648770909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412703750
  error estimate for blocks of size 2^( 2) =       0.000425624335
  error estimate for blocks of size 2^( 3) =       0.000438054453
  error estimate for blocks of size 2^( 4) =       0.000449183076
  error estimate for blocks of size 2^( 5) =       0.000458978773
  error estimate for blocks of size 2^( 6) =       0.000466654213
  error estimate for blocks of size 2^( 7) =       0.000470587440

      target function =                  N/A
              le_mean =     -16.906740821779
             les_mean =     286.178533815390
             stat err =       0.000461350875
             autocorr =       1.249642729432
              std dev =       0.583651240819
             le_variance =       0.340648770909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412703750
  error estimate for blocks of size 2^( 2) =       0.000425624335
  error estimate for blocks of size 2^( 3) =       0.000438054453
  error estimate for blocks of size 2^( 4) =       0.000449183076
  error estimate for blocks of size 2^( 5) =       0.000458978773
  error estimate for blocks of size 2^( 6) =       0.000466654213
  error estimate for blocks of size 2^( 7) =       0.000470587440

      target function =                  N/A
              le_mean =     -16.906740821779
             les_mean =     286.178533815390
             stat err =       0.000461350875
             autocorr =       1.249642729436
              std dev =       0.583651240819
             le_variance =       0.340648770909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340701422849
                                         uncertainty =       0.004079881492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412703750
  error estimate for blocks of size 2^( 2) =       0.000425624335
  error estimate for blocks of size 2^( 3) =       0.000438054453
  error estimate for blocks of size 2^( 4) =       0.000449183076
  error estimate for blocks of size 2^( 5) =       0.000458978773
  error estimate for blocks of size 2^( 6) =       0.000466654213
  error estimate for blocks of size 2^( 7) =       0.000470587440

      target function =                  N/A
              le_mean =     -16.906740821779
             les_mean =     286.178533815390
             stat err =       0.000461350875
             autocorr =       1.249642729434
              std dev =       0.583651240819
             le_variance =       0.340648770909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906740821779        initial  <--
     1.4552e+08     1.4552e+09             1.8150e-12       -16.906740821779
     5.8208e+08     5.8208e+09             4.5382e-13       -16.906740821779
     2.3283e+09     2.3283e+10             1.1332e-13       -16.906740821779

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1110
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0047e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9425
    reference variance = 0.239097
====================================================
  Execution time = 3.6671e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3500e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0069e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335012469128
                                         uncertainty =       0.002906346970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335012469128
                                         uncertainty =       0.002906346970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409266108
  error estimate for blocks of size 2^( 2) =       0.000422414402
  error estimate for blocks of size 2^( 3) =       0.000435214961
  error estimate for blocks of size 2^( 4) =       0.000447620395
  error estimate for blocks of size 2^( 5) =       0.000457864577
  error estimate for blocks of size 2^( 6) =       0.000465216951
  error estimate for blocks of size 2^( 7) =       0.000467883573

      target function =                  N/A
              le_mean =     -16.905829472968
             les_mean =     286.142067495181
             stat err =       0.000459646374
             autocorr =       1.261351461860
              std dev =       0.578789679946
             le_variance =       0.334997493613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582947297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829472968       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829472968       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829472968       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829585087       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829437077       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829611286       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905829879286       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905830828981       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.498000e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829472968       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829472968       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829472968       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905828728016       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829678299       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829470960       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905829505612       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905832447942       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 3.743392e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829472968       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829472968       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829472968       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829319581       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905838555490       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905824589182       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905851234624       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887696849       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905850809863       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905624767379       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905884355111       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905847746545       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905923476694       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905868241442       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905797172296       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905575943581       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906491877041       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906520663987       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907386830966       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905277084889       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904953966582       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905559006126       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905778713052       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906791235043       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903416549764       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906904719104       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907110866521       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904676533156       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.903794931201       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906644877187       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905269370190       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.909700135429       residual = 2.00e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.909618662713       residual = 1.95e-03           smallest_sin_value = 9.92e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.18e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 9.207455e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6778e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.393108
====================================================
  Execution time = 3.6329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3948e-01
  Total weights = 2.0000e+06
  Execution time = 3.3481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411993362
  error estimate for blocks of size 2^( 2) =       0.000424830306
  error estimate for blocks of size 2^( 3) =       0.000438064482
  error estimate for blocks of size 2^( 4) =       0.000450400132
  error estimate for blocks of size 2^( 5) =       0.000461615272
  error estimate for blocks of size 2^( 6) =       0.000469668621
  error estimate for blocks of size 2^( 7) =       0.000474836581

      target function =                  N/A
              le_mean =     -16.906187637014
             les_mean =     286.158657308555
             stat err =       0.000464130151
             autocorr =       1.269109596114
              std dev =       0.582646599896
             le_variance =       0.339477060370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411993362
  error estimate for blocks of size 2^( 2) =       0.000424830306
  error estimate for blocks of size 2^( 3) =       0.000438064482
  error estimate for blocks of size 2^( 4) =       0.000450400132
  error estimate for blocks of size 2^( 5) =       0.000461615272
  error estimate for blocks of size 2^( 6) =       0.000469668621
  error estimate for blocks of size 2^( 7) =       0.000474836581

      target function =                  N/A
              le_mean =     -16.906187637014
             les_mean =     286.158657308555
             stat err =       0.000464130151
             autocorr =       1.269109596118
              std dev =       0.582646599896
             le_variance =       0.339477060370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411993362
  error estimate for blocks of size 2^( 2) =       0.000424830306
  error estimate for blocks of size 2^( 3) =       0.000438064482
  error estimate for blocks of size 2^( 4) =       0.000450400132
  error estimate for blocks of size 2^( 5) =       0.000461615272
  error estimate for blocks of size 2^( 6) =       0.000469668621
  error estimate for blocks of size 2^( 7) =       0.000474836581

      target function =                  N/A
              le_mean =     -16.906187637014
             les_mean =     286.158657308555
             stat err =       0.000464130151
             autocorr =       1.269109596115
              std dev =       0.582646599896
             le_variance =       0.339477060370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451305750
                                         uncertainty =       0.006135251756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411993362
  error estimate for blocks of size 2^( 2) =       0.000424830306
  error estimate for blocks of size 2^( 3) =       0.000438064482
  error estimate for blocks of size 2^( 4) =       0.000450400132
  error estimate for blocks of size 2^( 5) =       0.000461615272
  error estimate for blocks of size 2^( 6) =       0.000469668621
  error estimate for blocks of size 2^( 7) =       0.000474836581

      target function =                  N/A
              le_mean =     -16.906187637014
             les_mean =     286.158657308555
             stat err =       0.000464130151
             autocorr =       1.269109596115
              std dev =       0.582646599896
             le_variance =       0.339477060370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906187637014        initial
     1.4552e+09     1.4552e+10             1.4980e-13       -16.906187637014
     5.8208e+09     5.8208e+10             3.7434e-14       -16.906187637014
     2.3283e+10     2.3283e+11             9.2075e-15       -16.906187637014  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 5.3201e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091470e-01 1 1  ON 0
 uu_1                 1.427536e-01 1 1  ON 1
 uu_2                 4.132802e-02 1 1  ON 2
 uu_3                -2.109781e-02 1 1  ON 3
 uu_4                -6.616949e-02 1 1  ON 4
 uu_5                -1.002247e-01 1 1  ON 5
 uu_6                -1.268844e-01 1 1  ON 6
 uu_7                -1.398153e-01 1 1  ON 7
 uu_8                -1.320454e-01 1 1  ON 8
 uu_9                -1.020661e-01 1 1  ON 9
 ud_0                 4.496162e-01 1 1  ON 10
 ud_1                 1.833616e-01 1 1  ON 11
 ud_2                 6.207938e-02 1 1  ON 12
 ud_3                -9.862251e-03 1 1  ON 13
 ud_4                -6.695652e-02 1 1  ON 14
 ud_5                -1.081720e-01 1 1  ON 15
 ud_6                -1.352314e-01 1 1  ON 16
 ud_7                -1.512314e-01 1 1  ON 17
 ud_8                -1.515949e-01 1 1  ON 18
 ud_9                -1.403381e-01 1 1  ON 19
 eO_0                -7.654816e-01 1 1  ON 20
 eO_1                -4.430618e-01 1 1  ON 21
 eO_2                -2.033799e-02 1 1  ON 22
 eO_3                 3.021832e-01 1 1  ON 23
 eO_4                 5.276823e-01 1 1  ON 24
 eO_5                 4.870258e-01 1 1  ON 25
 eO_6                 2.567099e-01 1 1  ON 26
 eO_7                -4.610891e-02 1 1  ON 27
 eO_8                -2.198029e-01 1 1  ON 28
 eO_9                -7.874464e-02 1 1  ON 29
eH1_0                -2.439988e-01 1 1  ON 30
eH1_1                -1.430281e-01 1 1  ON 31
eH1_2                -9.622624e-02 1 1  ON 32
eH1_3                -4.199571e-02 1 1  ON 33
eH1_4                 5.840212e-03 1 1  ON 34
eH1_5                 4.022776e-02 1 1  ON 35
eH1_6                 9.800089e-02 1 1  ON 36
eH1_7                 1.513623e-01 1 1  ON 37
eH1_8                 1.741854e-01 1 1  ON 38
eH1_9                 5.972162e-02 1 1  ON 39
eH2_0                -2.396082e-01 1 1  ON 40
eH2_1                -1.392924e-01 1 1  ON 41
eH2_2                -9.225741e-02 1 1  ON 42
eH2_3                -3.809648e-02 1 1  ON 43
eH2_4                 9.641697e-03 1 1  ON 44
eH2_5                 4.295715e-02 1 1  ON 45
eH2_6                 9.860463e-02 1 1  ON 46
eH2_7                 1.505068e-01 1 1  ON 47
eH2_8                 1.771436e-01 1 1  ON 48
eH2_9                 4.758032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9985e+01 secs
  Total Execution time = 4.0135e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
