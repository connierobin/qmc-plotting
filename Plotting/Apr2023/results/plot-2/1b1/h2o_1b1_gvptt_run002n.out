Rank =    0  Free Memory = 71020 MB
Rank =    1  Free Memory = 71020 MB
Rank =    2  Free Memory = 71020 MB
Rank =    3  Free Memory = 71020 MB
Rank =    4  Free Memory = 71020 MB
Rank =    5  Free Memory = 71020 MB
Rank =    6  Free Memory = 71020 MB
Rank =    7  Free Memory = 71020 MB
Rank =    8  Free Memory = 71019 MB
Rank =    9  Free Memory = 71019 MB
Rank =   10  Free Memory = 71019 MB
Rank =   11  Free Memory = 71019 MB
Rank =   12  Free Memory = 71019 MB
Rank =   13  Free Memory = 71019 MB
Rank =   14  Free Memory = 71018 MB
Rank =   15  Free Memory = 71006 MB
Rank =   16  Free Memory = 71006 MB
Rank =   17  Free Memory = 71006 MB
Rank =   18  Free Memory = 71005 MB
Rank =   19  Free Memory = 71005 MB
Rank =   20  Free Memory = 71005 MB
Rank =   21  Free Memory = 71005 MB
Rank =   22  Free Memory = 71005 MB
Rank =   23  Free Memory = 71005 MB
Rank =   24  Free Memory = 71005 MB
Rank =   25  Free Memory = 71005 MB
Rank =   26  Free Memory = 71005 MB
Rank =   27  Free Memory = 71005 MB
Rank =   28  Free Memory = 71005 MB
Rank =   29  Free Memory = 71005 MB
Rank =   30  Free Memory = 71005 MB
Rank =   31  Free Memory = 71005 MB
Rank =   32  Free Memory = 85508 MB
Rank =   33  Free Memory = 85508 MB
Rank =   34  Free Memory = 85508 MB
Rank =   35  Free Memory = 85508 MB
Rank =   36  Free Memory = 85508 MB
Rank =   37  Free Memory = 85508 MB
Rank =   38  Free Memory = 85508 MB
Rank =   39  Free Memory = 85508 MB
Rank =   40  Free Memory = 85508 MB
Rank =   41  Free Memory = 85508 MB
Rank =   42  Free Memory = 85508 MB
Rank =   43  Free Memory = 85508 MB
Rank =   44  Free Memory = 85508 MB
Rank =   45  Free Memory = 85507 MB
Rank =   46  Free Memory = 85507 MB
Rank =   47  Free Memory = 85507 MB
Rank =   48  Free Memory = 85507 MB
Rank =   49  Free Memory = 85507 MB
Rank =   50  Free Memory = 85507 MB
Rank =   51  Free Memory = 85507 MB
Rank =   52  Free Memory = 85507 MB
Rank =   53  Free Memory = 85507 MB
Rank =   54  Free Memory = 85507 MB
Rank =   55  Free Memory = 85507 MB
Rank =   56  Free Memory = 85507 MB
Rank =   57  Free Memory = 85507 MB
Rank =   58  Free Memory = 85507 MB
Rank =   59  Free Memory = 85507 MB
Rank =   60  Free Memory = 85507 MB
Rank =   61  Free Memory = 85507 MB
Rank =   62  Free Memory = 85507 MB
Rank =   63  Free Memory = 85507 MB
Rank =   64  Free Memory = 85583 MB
Rank =   65  Free Memory = 85583 MB
Rank =   66  Free Memory = 85583 MB
Rank =   67  Free Memory = 85583 MB
Rank =   68  Free Memory = 85583 MB
Rank =   69  Free Memory = 85583 MB
Rank =   70  Free Memory = 85583 MB
Rank =   71  Free Memory = 85583 MB
Rank =   72  Free Memory = 85583 MB
Rank =   73  Free Memory = 85583 MB
Rank =   74  Free Memory = 85583 MB
Rank =   75  Free Memory = 85583 MB
Rank =   76  Free Memory = 85583 MB
Rank =   77  Free Memory = 85583 MB
Rank =   78  Free Memory = 85583 MB
Rank =   79  Free Memory = 85583 MB
Rank =   80  Free Memory = 85583 MB
Rank =   81  Free Memory = 85583 MB
Rank =   82  Free Memory = 85583 MB
Rank =   83  Free Memory = 85583 MB
Rank =   84  Free Memory = 85583 MB
Rank =   85  Free Memory = 85583 MB
Rank =   86  Free Memory = 85583 MB
Rank =   87  Free Memory = 85582 MB
Rank =   88  Free Memory = 85582 MB
Rank =   89  Free Memory = 85582 MB
Rank =   90  Free Memory = 85582 MB
Rank =   91  Free Memory = 85582 MB
Rank =   92  Free Memory = 85582 MB
Rank =   93  Free Memory = 85582 MB
Rank =   94  Free Memory = 85582 MB
Rank =   95  Free Memory = 85582 MB
Rank =   96  Free Memory = 73473 MB
Rank =   97  Free Memory = 73473 MB
Rank =   98  Free Memory = 73473 MB
Rank =   99  Free Memory = 73473 MB
Rank =  100  Free Memory = 73473 MB
Rank =  101  Free Memory = 73473 MB
Rank =  102  Free Memory = 73473 MB
Rank =  103  Free Memory = 73473 MB
Rank =  104  Free Memory = 73473 MB
Rank =  105  Free Memory = 73473 MB
Rank =  106  Free Memory = 73473 MB
Rank =  107  Free Memory = 73473 MB
Rank =  108  Free Memory = 73473 MB
Rank =  109  Free Memory = 73473 MB
Rank =  110  Free Memory = 73473 MB
Rank =  111  Free Memory = 73473 MB
Rank =  112  Free Memory = 73473 MB
Rank =  113  Free Memory = 73473 MB
Rank =  114  Free Memory = 73473 MB
Rank =  115  Free Memory = 73473 MB
Rank =  116  Free Memory = 73473 MB
Rank =  117  Free Memory = 73473 MB
Rank =  118  Free Memory = 73473 MB
Rank =  119  Free Memory = 73473 MB
Rank =  120  Free Memory = 73473 MB
Rank =  121  Free Memory = 73473 MB
Rank =  122  Free Memory = 73473 MB
Rank =  123  Free Memory = 73473 MB
Rank =  124  Free Memory = 73473 MB
Rank =  125  Free Memory = 73473 MB
Rank =  126  Free Memory = 73473 MB
Rank =  127  Free Memory = 73473 MB
  Input file(s): opt_h2o_1b1_gvptt_run002n.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002n.xml

  Project = H2O
  date    = 2023-04-13 17:14:50 PDT
  host    = n0063.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 762

  Range of prime numbers to use as seeds over processors and threads = 5821-6949


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.090692e-01    1         1  ON     0
     uu_1                 1.424780e-01    1         1  ON     1
     uu_2                 4.112147e-02    1         1  ON     2
     uu_3                -2.111963e-02    1         1  ON     3
     uu_4                -6.581937e-02    1         1  ON     4
     uu_5                -1.000957e-01    1         1  ON     5
     uu_6                -1.266762e-01    1         1  ON     6
     uu_7                -1.392537e-01    1         1  ON     7
     uu_8                -1.316921e-01    1         1  ON     8
     uu_9                -1.016838e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.493288e-01    1         1  ON     0
     ud_1                 1.829987e-01    1         1  ON     1
     ud_2                 6.172728e-02    1         1  ON     2
     ud_3                -1.004149e-02    1         1  ON     3
     ud_4                -6.709348e-02    1         1  ON     4
     ud_5                -1.083422e-01    1         1  ON     5
     ud_6                -1.351565e-01    1         1  ON     6
     ud_7                -1.509817e-01    1         1  ON     7
     ud_8                -1.512016e-01    1         1  ON     8
     ud_9                -1.399171e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.656072e-01    1         1  ON     0
     eO_1                -4.433207e-01    1         1  ON     1
     eO_2                -2.002962e-02    1         1  ON     2
     eO_3                 3.023020e-01    1         1  ON     3
     eO_4                 5.272076e-01    1         1  ON     4
     eO_5                 4.864248e-01    1         1  ON     5
     eO_6                 2.559067e-01    1         1  ON     6
     eO_7                -4.658725e-02    1         1  ON     7
     eO_8                -2.187744e-01    1         1  ON     8
     eO_9                -7.764479e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.429881e-01    1         1  ON     0
     eH1_1                -1.423758e-01    1         1  ON     1
     eH1_2                -9.587614e-02    1         1  ON     2
     eH1_3                -4.185248e-02    1         1  ON     3
     eH1_4                 6.102402e-03    1         1  ON     4
     eH1_5                 4.068930e-02    1         1  ON     5
     eH1_6                 9.815442e-02    1         1  ON     6
     eH1_7                 1.507540e-01    1         1  ON     7
     eH1_8                 1.730501e-01    1         1  ON     8
     eH1_9                 5.837509e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.380736e-01    1         1  ON     0
     eH2_1                -1.383943e-01    1         1  ON     1
     eH2_2                -9.198377e-02    1         1  ON     2
     eH2_3                -3.793344e-02    1         1  ON     3
     eH2_4                 9.690900e-03    1         1  ON     4
     eH2_5                 4.286513e-02    1         1  ON     5
     eH2_6                 9.887253e-02    1         1  ON     6
     eH2_7                 1.502626e-01    1         1  ON     7
     eH2_8                 1.763177e-01    1         1  ON     8
     eH2_9                 4.573296e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.853252e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.5739e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.447132
====================================================
  Execution time = 2.1149e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341644942380
                                         uncertainty =       0.004770097647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341644942380
                                         uncertainty =       0.004770097647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413266642
  error estimate for blocks of size 2^( 2) =       0.000425909538
  error estimate for blocks of size 2^( 3) =       0.000438790555
  error estimate for blocks of size 2^( 4) =       0.000451065746
  error estimate for blocks of size 2^( 5) =       0.000461325788
  error estimate for blocks of size 2^( 6) =       0.000469489398
  error estimate for blocks of size 2^( 7) =       0.000474603576

      target function =                  N/A
              le_mean =     -16.905484363456
             les_mean =     286.136980026446
             stat err =       0.000464121127
             autocorr =       1.261252310302
              std dev =       0.584447289467
             le_variance =       0.341578634165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690548436346e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484363456       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905483705720       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905485361181       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905486032972       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905485717428       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905486065368       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905485324604       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905485906111       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905486133646       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905486103778       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.388300e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484363456       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905484113065       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905484502705       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484774039       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905484678465       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905484935470       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905484701051       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905484811655       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.979687e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905484363456       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905484291448       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905484380557       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484454721       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905484428165       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905484511877       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905484452138       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905484474814       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.295123e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6968e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.091632e-01                 1 1 ON  0
uu_1  1.425572e-01                 1 1 ON  1
uu_2  4.111582e-02                 1 1 ON  2
uu_3  -2.110497e-02                1 1 ON  3
uu_4  -6.587013e-02                1 1 ON  4
uu_5  -1.000842e-01                1 1 ON  5
uu_6  -1.267093e-01                1 1 ON  6
uu_7  -1.394106e-01                1 1 ON  7
uu_8  -1.317889e-01                1 1 ON  8
uu_9  -1.017326e-01                1 1 ON  9
ud_0  4.493949e-01                 1 1 ON  10
ud_1  1.830791e-01                 1 1 ON  11
ud_2  6.176154e-02                 1 1 ON  12
ud_3  -1.004138e-02                1 1 ON  13
ud_4  -6.705183e-02                1 1 ON  14
ud_5  -1.083242e-01                1 1 ON  15
ud_6  -1.351927e-01                1 1 ON  16
ud_7  -1.510533e-01                1 1 ON  17
ud_8  -1.512033e-01                1 1 ON  18
ud_9  -1.399915e-01                1 1 ON  19
eO_0  -7.656257e-01                1 1 ON  20
eO_1  -4.432916e-01                1 1 ON  21
eO_2  -2.007877e-02                1 1 ON  22
eO_3  3.023761e-01                 1 1 ON  23
eO_4  5.272551e-01                 1 1 ON  24
eO_5  4.865075e-01                 1 1 ON  25
eO_6  2.559899e-01                 1 1 ON  26
eO_7  -4.655525e-02                1 1 ON  27
eO_8  -2.189159e-01                1 1 ON  28
eO_9  -7.776969e-02                1 1 ON  29
eH1_0 -2.430648e-01                1 1 ON  30
eH1_1 -1.425167e-01                1 1 ON  31
eH1_2 -9.584884e-02                1 1 ON  32
eH1_3 -4.186351e-02                1 1 ON  33
eH1_4 6.012037e-03                 1 1 ON  34
eH1_5 4.066997e-02                 1 1 ON  35
eH1_6 9.808805e-02                 1 1 ON  36
eH1_7 1.508238e-01                 1 1 ON  37
eH1_8 1.732249e-01                 1 1 ON  38
eH1_9 5.851883e-02                 1 1 ON  39
eH2_0 -2.382716e-01                1 1 ON  40
eH2_1 -1.385890e-01                1 1 ON  41
eH2_2 -9.200196e-02                1 1 ON  42
eH2_3 -3.791668e-02                1 1 ON  43
eH2_4 9.762958e-03                 1 1 ON  44
eH2_5 4.288675e-02                 1 1 ON  45
eH2_6 9.884695e-02                 1 1 ON  46
eH2_7 1.503263e-01                 1 1 ON  47
eH2_8 1.764046e-01                 1 1 ON  48
eH2_9 4.589326e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 0.24712
====================================================
  Execution time = 2.0348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.0000e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340156796241
                                         uncertainty =       0.004526809148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340156796241
                                         uncertainty =       0.004526809148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412382182
  error estimate for blocks of size 2^( 2) =       0.000425285343
  error estimate for blocks of size 2^( 3) =       0.000438578594
  error estimate for blocks of size 2^( 4) =       0.000451258837
  error estimate for blocks of size 2^( 5) =       0.000462267708
  error estimate for blocks of size 2^( 6) =       0.000471284787
  error estimate for blocks of size 2^( 7) =       0.000476502637

      target function =                  N/A
              le_mean =     -16.905848852093
             les_mean =     286.147843367479
             stat err =       0.000465328492
             autocorr =       1.273267067870
              std dev =       0.583196474383
             le_variance =       0.340118127733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275938783
                                         uncertainty =       0.004527286995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275938783
                                         uncertainty =       0.004527286995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412454322
  error estimate for blocks of size 2^( 2) =       0.000425350234
  error estimate for blocks of size 2^( 3) =       0.000438636733
  error estimate for blocks of size 2^( 4) =       0.000451311880
  error estimate for blocks of size 2^( 5) =       0.000462319251
  error estimate for blocks of size 2^( 6) =       0.000471336118
  error estimate for blocks of size 2^( 7) =       0.000476563400

      target function =                  N/A
              le_mean =     -16.905854044196
             les_mean =     286.148137929607
             stat err =       0.000465382662
             autocorr =       1.273118067078
              std dev =       0.583298496541
             le_variance =       0.340237136067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340221631607
                                         uncertainty =       0.004526860323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340221631607
                                         uncertainty =       0.004526860323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421423
  error estimate for blocks of size 2^( 2) =       0.000425320264
  error estimate for blocks of size 2^( 3) =       0.000438609805
  error estimate for blocks of size 2^( 4) =       0.000451287426
  error estimate for blocks of size 2^( 5) =       0.000462296138
  error estimate for blocks of size 2^( 6) =       0.000471313505
  error estimate for blocks of size 2^( 7) =       0.000476537762

      target function =                  N/A
              le_mean =     -16.905852629110
             les_mean =     286.148035806871
             stat err =       0.000465358708
             autocorr =       1.273190114252
              std dev =       0.583251969368
             le_variance =       0.340182859772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340164765290
                                         uncertainty =       0.004526792489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340164765290
                                         uncertainty =       0.004526792489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412387003
  error estimate for blocks of size 2^( 2) =       0.000425289563
  error estimate for blocks of size 2^( 3) =       0.000438582304
  error estimate for blocks of size 2^( 4) =       0.000451262210
  error estimate for blocks of size 2^( 5) =       0.000462271142
  error estimate for blocks of size 2^( 6) =       0.000471288322
  error estimate for blocks of size 2^( 7) =       0.000476507100

      target function =                  N/A
              le_mean =     -16.905849337553
             les_mean =     286.147867734131
             stat err =       0.000465332193
             autocorr =       1.273257552832
              std dev =       0.583203292301
             le_variance =       0.340126080151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905848852093        initial
     2.5000e-01     2.5000e+00             7.3883e-04       -16.905854044196  <--
     1.0000e+00     1.0000e+01             1.9797e-04       -16.905852629110
     4.0000e+00     4.0000e+01             5.2951e-05       -16.905849337553

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9884e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116423e-02 1 1  ON 2
 uu_3                -2.105999e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397875e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832525e-01 1 1  ON 11
 ud_2                 6.186275e-02 1 1  ON 12
 ud_3                -9.988066e-03 1 1  ON 13
 ud_4                -6.697315e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432286e-01 1 1  ON 21
 eO_2                -2.013297e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867837e-01 1 1  ON 25
 eO_6                 2.562427e-01 1 1  ON 26
 eO_7                -4.645317e-02 1 1  ON 27
 eO_8                -2.193465e-01 1 1  ON 28
 eO_9                -7.815174e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428300e-01 1 1  ON 31
eH1_2                -9.588533e-02 1 1  ON 32
eH1_3                -4.192964e-02 1 1  ON 33
eH1_4                 5.791224e-03 1 1  ON 34
eH1_5                 4.058032e-02 1 1  ON 35
eH1_6                 9.791555e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737551e-01 1 1  ON 38
eH1_9                 5.895849e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213654e-02 1 1  ON 42
eH2_3                -3.793473e-02 1 1  ON 43
eH2_4                 9.854189e-03 1 1  ON 44
eH2_5                 4.294138e-02 1 1  ON 45
eH2_6                 9.879507e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.21882
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356029285873
                                         uncertainty =       0.012239160978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356029285873
                                         uncertainty =       0.012239160978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421858969
  error estimate for blocks of size 2^( 2) =       0.000434211619
  error estimate for blocks of size 2^( 3) =       0.000447203832
  error estimate for blocks of size 2^( 4) =       0.000459503561
  error estimate for blocks of size 2^( 5) =       0.000470090840
  error estimate for blocks of size 2^( 6) =       0.000479453462
  error estimate for blocks of size 2^( 7) =       0.000487626986

      target function =                  N/A
              le_mean =     -16.905854541912
             les_mean =     286.163847593290
             stat err =       0.000474168713
             autocorr =       1.263371905974
              std dev =       0.596598674965
             le_variance =       0.355929978970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585454191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854541912       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905861108477       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905859154550       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905857535357       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905859200761       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861406681       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905862710072       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905863400520       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862880431       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905861809154       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905862068534       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905862905230       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905863223687       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.661951e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854541912       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858192820       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905856697234       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905856062461       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905856768898       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905857359848       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905857917064       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858247089       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905858111289       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905857872068       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.175630e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854541912       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905855857050       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905855183618       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905855085468       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905855131675       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905855295594       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905855433912       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905855578992       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905855538168       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.305259e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6586e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.097414e-01 1 1  ON 0
 uu_1                 1.427656e-01 1 1  ON 1
 uu_2                 4.116797e-02 1 1  ON 2
 uu_3                -2.130060e-02 1 1  ON 3
 uu_4                -6.625422e-02 1 1  ON 4
 uu_5                -1.006193e-01 1 1  ON 5
 uu_6                -1.272179e-01 1 1  ON 6
 uu_7                -1.402364e-01 1 1  ON 7
 uu_8                -1.319326e-01 1 1  ON 8
 uu_9                -1.015825e-01 1 1  ON 9
 ud_0                 4.496546e-01 1 1  ON 10
 ud_1                 1.830895e-01 1 1  ON 11
 ud_2                 6.186668e-02 1 1  ON 12
 ud_3                -9.977067e-03 1 1  ON 13
 ud_4                -6.703588e-02 1 1  ON 14
 ud_5                -1.083801e-01 1 1  ON 15
 ud_6                -1.350615e-01 1 1  ON 16
 ud_7                -1.513597e-01 1 1  ON 17
 ud_8                -1.511799e-01 1 1  ON 18
 ud_9                -1.400166e-01 1 1  ON 19
 eO_0                -7.657084e-01 1 1  ON 20
 eO_1                -4.429095e-01 1 1  ON 21
 eO_2                -2.032985e-02 1 1  ON 22
 eO_3                 3.022923e-01 1 1  ON 23
 eO_4                 5.275438e-01 1 1  ON 24
 eO_5                 4.871065e-01 1 1  ON 25
 eO_6                 2.563813e-01 1 1  ON 26
 eO_7                -4.613941e-02 1 1  ON 27
 eO_8                -2.196324e-01 1 1  ON 28
 eO_9                -7.859898e-02 1 1  ON 29
eH1_0                -2.438361e-01 1 1  ON 30
eH1_1                -1.432235e-01 1 1  ON 31
eH1_2                -9.622268e-02 1 1  ON 32
eH1_3                -4.177787e-02 1 1  ON 33
eH1_4                 5.955304e-03 1 1  ON 34
eH1_5                 4.011201e-02 1 1  ON 35
eH1_6                 9.755896e-02 1 1  ON 36
eH1_7                 1.510202e-01 1 1  ON 37
eH1_8                 1.744054e-01 1 1  ON 38
eH1_9                 5.987605e-02 1 1  ON 39
eH2_0                -2.392610e-01 1 1  ON 40
eH2_1                -1.392303e-01 1 1  ON 41
eH2_2                -9.227221e-02 1 1  ON 42
eH2_3                -3.817357e-02 1 1  ON 43
eH2_4                 9.786196e-03 1 1  ON 44
eH2_5                 4.265179e-02 1 1  ON 45
eH2_6                 9.843065e-02 1 1  ON 46
eH2_7                 1.508422e-01 1 1  ON 47
eH2_8                 1.772828e-01 1 1  ON 48
eH2_9                 4.719311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8299
    reference variance = 0.256671
====================================================
  Execution time = 2.0106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4582e-01
  Total weights = 2.0000e+06
  Execution time = 1.8877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345624151787
                                         uncertainty =       0.005299240692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345624151787
                                         uncertainty =       0.005299240692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415679579
  error estimate for blocks of size 2^( 2) =       0.000428812156
  error estimate for blocks of size 2^( 3) =       0.000442514120
  error estimate for blocks of size 2^( 4) =       0.000455437022
  error estimate for blocks of size 2^( 5) =       0.000467209181
  error estimate for blocks of size 2^( 6) =       0.000476175822
  error estimate for blocks of size 2^( 7) =       0.000484350470

      target function =                  N/A
              le_mean =     -16.905207485722
             les_mean =     286.131618988076
             stat err =       0.000470793124
             autocorr =       1.282752418889
              std dev =       0.587859698875
             le_variance =       0.345579025561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345979560225
                                         uncertainty =       0.005305846889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345979560225
                                         uncertainty =       0.005305846889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415893155
  error estimate for blocks of size 2^( 2) =       0.000429016209
  error estimate for blocks of size 2^( 3) =       0.000442705470
  error estimate for blocks of size 2^( 4) =       0.000455621423
  error estimate for blocks of size 2^( 5) =       0.000467396418
  error estimate for blocks of size 2^( 6) =       0.000476338270
  error estimate for blocks of size 2^( 7) =       0.000484504904

      target function =                  N/A
              le_mean =     -16.905204025863
             les_mean =     286.131857216639
             stat err =       0.000470965254
             autocorr =       1.282372478421
              std dev =       0.588161740967
             le_variance =       0.345934233537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346123199282
                                         uncertainty =       0.005308606747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346123199282
                                         uncertainty =       0.005308606747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415979477
  error estimate for blocks of size 2^( 2) =       0.000429097975
  error estimate for blocks of size 2^( 3) =       0.000442782781
  error estimate for blocks of size 2^( 4) =       0.000455696677
  error estimate for blocks of size 2^( 5) =       0.000467475371
  error estimate for blocks of size 2^( 6) =       0.000476421652
  error estimate for blocks of size 2^( 7) =       0.000484594392

      target function =                  N/A
              le_mean =     -16.905203179307
             les_mean =     286.131972211648
             stat err =       0.000471047023
             autocorr =       1.282285457357
              std dev =       0.588283818424
             le_variance =       0.346077851020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345732557630
                                         uncertainty =       0.005301462301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345732557630
                                         uncertainty =       0.005301462301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415744740
  error estimate for blocks of size 2^( 2) =       0.000428874183
  error estimate for blocks of size 2^( 3) =       0.000442572338
  error estimate for blocks of size 2^( 4) =       0.000455493119
  error estimate for blocks of size 2^( 5) =       0.000467266423
  error estimate for blocks of size 2^( 6) =       0.000476229228
  error estimate for blocks of size 2^( 7) =       0.000484403949

      target function =                  N/A
              le_mean =     -16.905205952701
             les_mean =     286.131675508044
             stat err =       0.000470848180
             autocorr =       1.282650294999
              std dev =       0.587951849765
             le_variance =       0.345687377642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905207485722        initial  <--
     6.2500e-02     6.2500e-01             3.6620e-03       -16.905204025863
     2.5000e-01     2.5000e+00             9.1756e-04       -16.905203179307
     1.0000e+00     1.0000e+01             2.3053e-04       -16.905205952701

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.6037
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116423e-02 1 1  ON 2
 uu_3                -2.105999e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397875e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832525e-01 1 1  ON 11
 ud_2                 6.186275e-02 1 1  ON 12
 ud_3                -9.988066e-03 1 1  ON 13
 ud_4                -6.697315e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432286e-01 1 1  ON 21
 eO_2                -2.013297e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867837e-01 1 1  ON 25
 eO_6                 2.562427e-01 1 1  ON 26
 eO_7                -4.645317e-02 1 1  ON 27
 eO_8                -2.193465e-01 1 1  ON 28
 eO_9                -7.815174e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428300e-01 1 1  ON 31
eH1_2                -9.588533e-02 1 1  ON 32
eH1_3                -4.192964e-02 1 1  ON 33
eH1_4                 5.791224e-03 1 1  ON 34
eH1_5                 4.058032e-02 1 1  ON 35
eH1_6                 9.791555e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737551e-01 1 1  ON 38
eH1_9                 5.895849e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213654e-02 1 1  ON 42
eH2_3                -3.793473e-02 1 1  ON 43
eH2_4                 9.854189e-03 1 1  ON 44
eH2_5                 4.294138e-02 1 1  ON 45
eH2_6                 9.879507e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.233105
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236833368
                                         uncertainty =       0.002393704948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332236833368
                                         uncertainty =       0.002393704948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407661462
  error estimate for blocks of size 2^( 2) =       0.000420200479
  error estimate for blocks of size 2^( 3) =       0.000432916024
  error estimate for blocks of size 2^( 4) =       0.000443935920
  error estimate for blocks of size 2^( 5) =       0.000454316173
  error estimate for blocks of size 2^( 6) =       0.000461820256
  error estimate for blocks of size 2^( 7) =       0.000467933909

      target function =                  N/A
              le_mean =     -16.906523771553
             les_mean =     286.162921606683
             stat err =       0.000457001564
             autocorr =       1.256712857187
              std dev =       0.576520368065
             le_variance =       0.332375734793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652377155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523771553       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906524469019       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906525487696       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906525668758       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906525585676       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906525784582       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906525885155       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906525894257       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906525921354       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.517320e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523771553       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906523980176       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906524348863       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906524365605       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906524307239       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906524331328       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906524343936       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906524340479       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.199811e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523771553       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906523826402       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523929653       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906523930820       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906523913172       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523918162       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523919118       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906523917091       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.054102e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6228e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093833e-01 1 1  ON 0
 uu_1                 1.426907e-01 1 1  ON 1
 uu_2                 4.119443e-02 1 1  ON 2
 uu_3                -2.104912e-02 1 1  ON 3
 uu_4                -6.594389e-02 1 1  ON 4
 uu_5                -1.001137e-01 1 1  ON 5
 uu_6                -1.268030e-01 1 1  ON 6
 uu_7                -1.398318e-01 1 1  ON 7
 uu_8                -1.321097e-01 1 1  ON 8
 uu_9                -1.019235e-01 1 1  ON 9
 ud_0                 4.496547e-01 1 1  ON 10
 ud_1                 1.832546e-01 1 1  ON 11
 ud_2                 6.189878e-02 1 1  ON 12
 ud_3                -9.988795e-03 1 1  ON 13
 ud_4                -6.698846e-02 1 1  ON 14
 ud_5                -1.082593e-01 1 1  ON 15
 ud_6                -1.352472e-01 1 1  ON 16
 ud_7                -1.512270e-01 1 1  ON 17
 ud_8                -1.512687e-01 1 1  ON 18
 ud_9                -1.402440e-01 1 1  ON 19
 eO_0                -7.657333e-01 1 1  ON 20
 eO_1                -4.431603e-01 1 1  ON 21
 eO_2                -2.015676e-02 1 1  ON 22
 eO_3                 3.024931e-01 1 1  ON 23
 eO_4                 5.274558e-01 1 1  ON 24
 eO_5                 4.868041e-01 1 1  ON 25
 eO_6                 2.562890e-01 1 1  ON 26
 eO_7                -4.642245e-02 1 1  ON 27
 eO_8                -2.194096e-01 1 1  ON 28
 eO_9                -7.821425e-02 1 1  ON 29
eH1_0                -2.433662e-01 1 1  ON 30
eH1_1                -1.428513e-01 1 1  ON 31
eH1_2                -9.588994e-02 1 1  ON 32
eH1_3                -4.193936e-02 1 1  ON 33
eH1_4                 5.767642e-03 1 1  ON 34
eH1_5                 4.054052e-02 1 1  ON 35
eH1_6                 9.789079e-02 1 1  ON 36
eH1_7                 1.510836e-01 1 1  ON 37
eH1_8                 1.738337e-01 1 1  ON 38
eH1_9                 5.901881e-02 1 1  ON 39
eH2_0                -2.389325e-01 1 1  ON 40
eH2_1                -1.389837e-01 1 1  ON 41
eH2_2                -9.214503e-02 1 1  ON 42
eH2_3                -3.797509e-02 1 1  ON 43
eH2_4                 9.861239e-03 1 1  ON 44
eH2_5                 4.298367e-02 1 1  ON 45
eH2_6                 9.880511e-02 1 1  ON 46
eH2_7                 1.505249e-01 1 1  ON 47
eH2_8                 1.767214e-01 1 1  ON 48
eH2_9                 4.643800e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 0.388227
====================================================
  Execution time = 2.7071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3952e-01
  Total weights = 2.0000e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339494032452
                                         uncertainty =       0.003723742637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339494032452
                                         uncertainty =       0.003723742637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412002633
  error estimate for blocks of size 2^( 2) =       0.000424851768
  error estimate for blocks of size 2^( 3) =       0.000438177019
  error estimate for blocks of size 2^( 4) =       0.000451989387
  error estimate for blocks of size 2^( 5) =       0.000464550438
  error estimate for blocks of size 2^( 6) =       0.000473322565
  error estimate for blocks of size 2^( 7) =       0.000481558707

      target function =                  N/A
              le_mean =     -16.905798948282
             les_mean =     286.145530249424
             stat err =       0.000467855274
             autocorr =       1.289505134800
              std dev =       0.582659711529
             le_variance =       0.339492339439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339567008726
                                         uncertainty =       0.003725974970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339567008726
                                         uncertainty =       0.003725974970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412046927
  error estimate for blocks of size 2^( 2) =       0.000424892083
  error estimate for blocks of size 2^( 3) =       0.000438215130
  error estimate for blocks of size 2^( 4) =       0.000452026307
  error estimate for blocks of size 2^( 5) =       0.000464586386
  error estimate for blocks of size 2^( 6) =       0.000473358731
  error estimate for blocks of size 2^( 7) =       0.000481594953

      target function =                  N/A
              le_mean =     -16.905797596798
             les_mean =     286.145557553408
             stat err =       0.000467891594
             autocorr =       1.289428092711
              std dev =       0.582722351812
             le_variance =       0.339565339302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339546816305
                                         uncertainty =       0.003725380052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339546816305
                                         uncertainty =       0.003725380052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412034665
  error estimate for blocks of size 2^( 2) =       0.000424881168
  error estimate for blocks of size 2^( 3) =       0.000438205211
  error estimate for blocks of size 2^( 4) =       0.000452016662
  error estimate for blocks of size 2^( 5) =       0.000464576873
  error estimate for blocks of size 2^( 6) =       0.000473348927
  error estimate for blocks of size 2^( 7) =       0.000481585267

      target function =                  N/A
              le_mean =     -16.905797782808
             les_mean =     286.145543633111
             stat err =       0.000467881932
             autocorr =       1.289451583345
              std dev =       0.582705010862
             le_variance =       0.339545129684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339501219536
                                         uncertainty =       0.003723973474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339501219536
                                         uncertainty =       0.003723973474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412006995
  error estimate for blocks of size 2^( 2) =       0.000424855772
  error estimate for blocks of size 2^( 3) =       0.000438180871
  error estimate for blocks of size 2^( 4) =       0.000451993112
  error estimate for blocks of size 2^( 5) =       0.000464554044
  error estimate for blocks of size 2^( 6) =       0.000473326156
  error estimate for blocks of size 2^( 7) =       0.000481562321

      target function =                  N/A
              le_mean =     -16.905798772038
             les_mean =     286.145531477990
             stat err =       0.000467858908
             autocorr =       1.289497867509
              std dev =       0.582665879458
             le_variance =       0.339499527085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905798948282        initial  <--
     6.2500e-01     6.2500e+00             4.5173e-04       -16.905797596798
     2.5000e+00     2.5000e+01             1.1998e-04       -16.905797782808
     1.0000e+01     1.0000e+02             3.0541e-05       -16.905798772038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 36.6698
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116423e-02 1 1  ON 2
 uu_3                -2.105999e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397875e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832525e-01 1 1  ON 11
 ud_2                 6.186275e-02 1 1  ON 12
 ud_3                -9.988066e-03 1 1  ON 13
 ud_4                -6.697315e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432286e-01 1 1  ON 21
 eO_2                -2.013297e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867837e-01 1 1  ON 25
 eO_6                 2.562427e-01 1 1  ON 26
 eO_7                -4.645317e-02 1 1  ON 27
 eO_8                -2.193465e-01 1 1  ON 28
 eO_9                -7.815174e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428300e-01 1 1  ON 31
eH1_2                -9.588533e-02 1 1  ON 32
eH1_3                -4.192964e-02 1 1  ON 33
eH1_4                 5.791224e-03 1 1  ON 34
eH1_5                 4.058032e-02 1 1  ON 35
eH1_6                 9.791555e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737551e-01 1 1  ON 38
eH1_9                 5.895849e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213654e-02 1 1  ON 42
eH2_3                -3.793473e-02 1 1  ON 43
eH2_4                 9.854189e-03 1 1  ON 44
eH2_5                 4.294138e-02 1 1  ON 45
eH2_6                 9.879507e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.388524
====================================================
  Execution time = 2.0674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353105195469
                                         uncertainty =       0.013345187827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353105195469
                                         uncertainty =       0.013345187827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420102265
  error estimate for blocks of size 2^( 2) =       0.000433007826
  error estimate for blocks of size 2^( 3) =       0.000446091777
  error estimate for blocks of size 2^( 4) =       0.000458234727
  error estimate for blocks of size 2^( 5) =       0.000468742929
  error estimate for blocks of size 2^( 6) =       0.000477424194
  error estimate for blocks of size 2^( 7) =       0.000483244825

      target function =                  N/A
              le_mean =     -16.906016104288
             les_mean =     286.166352168544
             stat err =       0.000471911669
             autocorr =       1.261860615848
              std dev =       0.594114321134
             le_variance =       0.352971826576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601610429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016104288       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016108478       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016260302       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016255018       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016174576       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016165898       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016186351       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016210697       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.799813e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016104288       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016105357       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016143880       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016145841       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016126791       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016120479       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016124444       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016130751       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.515819e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016104288       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016104557       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016114223       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016114928       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016110135       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016108397       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016109303       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016110893       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.379965e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6259e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.093884e-01 1 1  ON 0
 uu_1                 1.426928e-01 1 1  ON 1
 uu_2                 4.116671e-02 1 1  ON 2
 uu_3                -2.106279e-02 1 1  ON 3
 uu_4                -6.594063e-02 1 1  ON 4
 uu_5                -1.001339e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397866e-01 1 1  ON 7
 uu_8                -1.320762e-01 1 1  ON 8
 uu_9                -1.018946e-01 1 1  ON 9
 ud_0                 4.495875e-01 1 1  ON 10
 ud_1                 1.832526e-01 1 1  ON 11
 ud_2                 6.186426e-02 1 1  ON 12
 ud_3                -9.990183e-03 1 1  ON 13
 ud_4                -6.697334e-02 1 1  ON 14
 ud_5                -1.082679e-01 1 1  ON 15
 ud_6                -1.352531e-01 1 1  ON 16
 ud_7                -1.512231e-01 1 1  ON 17
 ud_8                -1.512254e-01 1 1  ON 18
 ud_9                -1.402195e-01 1 1  ON 19
 eO_0                -7.657066e-01 1 1  ON 20
 eO_1                -4.432263e-01 1 1  ON 21
 eO_2                -2.013496e-02 1 1  ON 22
 eO_3                 3.024899e-01 1 1  ON 23
 eO_4                 5.274417e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562487e-01 1 1  ON 26
 eO_7                -4.645189e-02 1 1  ON 27
 eO_8                -2.193512e-01 1 1  ON 28
 eO_9                -7.815647e-02 1 1  ON 29
eH1_0                -2.433191e-01 1 1  ON 30
eH1_1                -1.428317e-01 1 1  ON 31
eH1_2                -9.588714e-02 1 1  ON 32
eH1_3                -4.192971e-02 1 1  ON 33
eH1_4                 5.790797e-03 1 1  ON 34
eH1_5                 4.057664e-02 1 1  ON 35
eH1_6                 9.791303e-02 1 1  ON 36
eH1_7                 1.510365e-01 1 1  ON 37
eH1_8                 1.737600e-01 1 1  ON 38
eH1_9                 5.896610e-02 1 1  ON 39
eH2_0                -2.388196e-01 1 1  ON 40
eH2_1                -1.389761e-01 1 1  ON 41
eH2_2                -9.214131e-02 1 1  ON 42
eH2_3                -3.793807e-02 1 1  ON 43
eH2_4                 9.852352e-03 1 1  ON 44
eH2_5                 4.293322e-02 1 1  ON 45
eH2_6                 9.879659e-02 1 1  ON 46
eH2_7                 1.505231e-01 1 1  ON 47
eH2_8                 1.766740e-01 1 1  ON 48
eH2_9                 4.639112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.16372
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.0000e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421225839
                                         uncertainty =       0.004222871334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421225839
                                         uncertainty =       0.004222871334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531333
  error estimate for blocks of size 2^( 2) =       0.000425233406
  error estimate for blocks of size 2^( 3) =       0.000438532668
  error estimate for blocks of size 2^( 4) =       0.000450712440
  error estimate for blocks of size 2^( 5) =       0.000461912419
  error estimate for blocks of size 2^( 6) =       0.000469974232
  error estimate for blocks of size 2^( 7) =       0.000478187363

      target function =                  N/A
              le_mean =     -16.905117097939
             les_mean =     286.123348125819
             stat err =       0.000465196613
             autocorr =       1.271625444167
              std dev =       0.583407405643
             le_variance =       0.340364200959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340429464457
                                         uncertainty =       0.004223083624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340429464457
                                         uncertainty =       0.004223083624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412536326
  error estimate for blocks of size 2^( 2) =       0.000425238100
  error estimate for blocks of size 2^( 3) =       0.000438536811
  error estimate for blocks of size 2^( 4) =       0.000450716089
  error estimate for blocks of size 2^( 5) =       0.000461915536
  error estimate for blocks of size 2^( 6) =       0.000469977989
  error estimate for blocks of size 2^( 7) =       0.000478191799

      target function =                  N/A
              le_mean =     -16.905117036233
             les_mean =     286.123354278635
             stat err =       0.000465200353
             autocorr =       1.271615109855
              std dev =       0.583414466803
             le_variance =       0.340372440075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340425354156
                                         uncertainty =       0.004222980173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340425354156
                                         uncertainty =       0.004222980173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412533835
  error estimate for blocks of size 2^( 2) =       0.000425235759
  error estimate for blocks of size 2^( 3) =       0.000438534739
  error estimate for blocks of size 2^( 4) =       0.000450714253
  error estimate for blocks of size 2^( 5) =       0.000461913947
  error estimate for blocks of size 2^( 6) =       0.000469976097
  error estimate for blocks of size 2^( 7) =       0.000478189581

      target function =                  N/A
              le_mean =     -16.905117063899
             les_mean =     286.123351103548
             stat err =       0.000465198469
             autocorr =       1.271620166152
              std dev =       0.583410944018
             le_variance =       0.340368329600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421741151
                                         uncertainty =       0.004222885025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421741151
                                         uncertainty =       0.004222885025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531645
  error estimate for blocks of size 2^( 2) =       0.000425233699
  error estimate for blocks of size 2^( 3) =       0.000438532926
  error estimate for blocks of size 2^( 4) =       0.000450712665
  error estimate for blocks of size 2^( 5) =       0.000461912608
  error estimate for blocks of size 2^( 6) =       0.000469974464
  error estimate for blocks of size 2^( 7) =       0.000478187639

      target function =                  N/A
              le_mean =     -16.905117093510
             les_mean =     286.123348491418
             stat err =       0.000465196844
             autocorr =       1.271624781221
              std dev =       0.583407847319
             le_variance =       0.340364716314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905117097939        initial  <--
     6.2500e+00     6.2500e+01             3.7998e-05       -16.905117036233
     2.5000e+01     2.5000e+02             9.5158e-06       -16.905117063899
     1.0000e+02     1.0000e+03             2.3800e-06       -16.905117093510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0587
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116423e-02 1 1  ON 2
 uu_3                -2.105999e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397875e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832525e-01 1 1  ON 11
 ud_2                 6.186275e-02 1 1  ON 12
 ud_3                -9.988066e-03 1 1  ON 13
 ud_4                -6.697315e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432286e-01 1 1  ON 21
 eO_2                -2.013297e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867837e-01 1 1  ON 25
 eO_6                 2.562427e-01 1 1  ON 26
 eO_7                -4.645317e-02 1 1  ON 27
 eO_8                -2.193465e-01 1 1  ON 28
 eO_9                -7.815174e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428300e-01 1 1  ON 31
eH1_2                -9.588533e-02 1 1  ON 32
eH1_3                -4.192964e-02 1 1  ON 33
eH1_4                 5.791224e-03 1 1  ON 34
eH1_5                 4.058032e-02 1 1  ON 35
eH1_6                 9.791555e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737551e-01 1 1  ON 38
eH1_9                 5.895849e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213654e-02 1 1  ON 42
eH2_3                -3.793473e-02 1 1  ON 43
eH2_4                 9.854189e-03 1 1  ON 44
eH2_5                 4.294138e-02 1 1  ON 45
eH2_6                 9.879507e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9627
    reference variance = 0.222042
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344723796744
                                         uncertainty =       0.008095438689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344723796744
                                         uncertainty =       0.008095438689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415100506
  error estimate for blocks of size 2^( 2) =       0.000427801985
  error estimate for blocks of size 2^( 3) =       0.000440990414
  error estimate for blocks of size 2^( 4) =       0.000453523643
  error estimate for blocks of size 2^( 5) =       0.000466580762
  error estimate for blocks of size 2^( 6) =       0.000475127769
  error estimate for blocks of size 2^( 7) =       0.000481976397

      target function =                  N/A
              le_mean =     -16.906197207540
             les_mean =     286.164120707478
             stat err =       0.000469302143
             autocorr =       1.278199223005
              std dev =       0.587040764812
             le_variance =       0.344616859551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619720754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906197207540       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906197210701       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906197227774       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906197230868       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906197232762       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906197233540       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906197234724       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906197234025       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.125251e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906197207540       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906197208332       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906197212617       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906197213390       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906197213866       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906197214061       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906197214356       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906197214181       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.031720e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906197207540       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906197207738       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906197208810       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906197209004       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906197209123       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906197209172       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906197209244       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906197209201       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.579557e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6118e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.093898e-01 1 1  ON 0
 uu_1                 1.426943e-01 1 1  ON 1
 uu_2                 4.116453e-02 1 1  ON 2
 uu_3                -2.106023e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001283e-01 1 1  ON 5
 uu_6                -1.268131e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018915e-01 1 1  ON 9
 ud_0                 4.495841e-01 1 1  ON 10
 ud_1                 1.832524e-01 1 1  ON 11
 ud_2                 6.186306e-02 1 1  ON 12
 ud_3                -9.987947e-03 1 1  ON 13
 ud_4                -6.697354e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512210e-01 1 1  ON 18
 ud_9                -1.402194e-01 1 1  ON 19
 eO_0                -7.657032e-01 1 1  ON 20
 eO_1                -4.432285e-01 1 1  ON 21
 eO_2                -2.013341e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274386e-01 1 1  ON 24
 eO_5                 4.867842e-01 1 1  ON 25
 eO_6                 2.562428e-01 1 1  ON 26
 eO_7                -4.645298e-02 1 1  ON 27
 eO_8                -2.193469e-01 1 1  ON 28
 eO_9                -7.815226e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428304e-01 1 1  ON 31
eH1_2                -9.588606e-02 1 1  ON 32
eH1_3                -4.192966e-02 1 1  ON 33
eH1_4                 5.791152e-03 1 1  ON 34
eH1_5                 4.058007e-02 1 1  ON 35
eH1_6                 9.791585e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895934e-02 1 1  ON 39
eH2_0                -2.388135e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213648e-02 1 1  ON 42
eH2_3                -3.793462e-02 1 1  ON 43
eH2_4                 9.853919e-03 1 1  ON 44
eH2_5                 4.294161e-02 1 1  ON 45
eH2_6                 9.879492e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766669e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9615
    reference variance = 0.277925
====================================================
  Execution time = 2.0175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5249e-01
  Total weights = 2.0000e+06
  Execution time = 1.8868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352500237574
                                         uncertainty =       0.010179355697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352500237574
                                         uncertainty =       0.010179355697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419815925
  error estimate for blocks of size 2^( 2) =       0.000432884956
  error estimate for blocks of size 2^( 3) =       0.000445555904
  error estimate for blocks of size 2^( 4) =       0.000457965775
  error estimate for blocks of size 2^( 5) =       0.000469341104
  error estimate for blocks of size 2^( 6) =       0.000479551078
  error estimate for blocks of size 2^( 7) =       0.000487087620

      target function =                  N/A
              le_mean =     -16.905324426982
             les_mean =     286.142484626456
             stat err =       0.000473486394
             autocorr =       1.272029523938
              std dev =       0.593709374355
             le_variance =       0.352490821198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352502324944
                                         uncertainty =       0.010179403477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352502324944
                                         uncertainty =       0.010179403477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419817167
  error estimate for blocks of size 2^( 2) =       0.000432886125
  error estimate for blocks of size 2^( 3) =       0.000445556989
  error estimate for blocks of size 2^( 4) =       0.000457966821
  error estimate for blocks of size 2^( 5) =       0.000469342096
  error estimate for blocks of size 2^( 6) =       0.000479552095
  error estimate for blocks of size 2^( 7) =       0.000487088589

      target function =                  N/A
              le_mean =     -16.905324411728
             les_mean =     286.142486196857
             stat err =       0.000473487400
             autocorr =       1.272027399586
              std dev =       0.593711131233
             le_variance =       0.352492907350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352501286453
                                         uncertainty =       0.010179379806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352501286453
                                         uncertainty =       0.010179379806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419816549
  error estimate for blocks of size 2^( 2) =       0.000432885544
  error estimate for blocks of size 2^( 3) =       0.000445556449
  error estimate for blocks of size 2^( 4) =       0.000457966301
  error estimate for blocks of size 2^( 5) =       0.000469341603
  error estimate for blocks of size 2^( 6) =       0.000479551589
  error estimate for blocks of size 2^( 7) =       0.000487088108

      target function =                  N/A
              le_mean =     -16.905324419315
             les_mean =     286.142485415513
             stat err =       0.000473486900
             autocorr =       1.272028458133
              std dev =       0.593710257166
             le_variance =       0.352491869464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352500368839
                                         uncertainty =       0.010179358717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352500368839
                                         uncertainty =       0.010179358717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419816003
  error estimate for blocks of size 2^( 2) =       0.000432885030
  error estimate for blocks of size 2^( 3) =       0.000445555972
  error estimate for blocks of size 2^( 4) =       0.000457965841
  error estimate for blocks of size 2^( 5) =       0.000469341167
  error estimate for blocks of size 2^( 6) =       0.000479551142
  error estimate for blocks of size 2^( 7) =       0.000487087681

      target function =                  N/A
              le_mean =     -16.905324426021
             les_mean =     286.142484725170
             stat err =       0.000473486458
             autocorr =       1.272029390606
              std dev =       0.593709484838
             le_variance =       0.352490952386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905324426982        initial  <--
     6.2500e+01     6.2500e+02             4.1253e-06       -16.905324411728
     2.5000e+02     2.5000e+03             1.0317e-06       -16.905324419315
     1.0000e+03     1.0000e+04             2.5796e-07       -16.905324426021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7094
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116423e-02 1 1  ON 2
 uu_3                -2.105999e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397875e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832525e-01 1 1  ON 11
 ud_2                 6.186275e-02 1 1  ON 12
 ud_3                -9.988066e-03 1 1  ON 13
 ud_4                -6.697315e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432286e-01 1 1  ON 21
 eO_2                -2.013297e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867837e-01 1 1  ON 25
 eO_6                 2.562427e-01 1 1  ON 26
 eO_7                -4.645317e-02 1 1  ON 27
 eO_8                -2.193465e-01 1 1  ON 28
 eO_9                -7.815174e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428300e-01 1 1  ON 31
eH1_2                -9.588533e-02 1 1  ON 32
eH1_3                -4.192964e-02 1 1  ON 33
eH1_4                 5.791224e-03 1 1  ON 34
eH1_5                 4.058032e-02 1 1  ON 35
eH1_6                 9.791555e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737551e-01 1 1  ON 38
eH1_9                 5.895849e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213654e-02 1 1  ON 42
eH2_3                -3.793473e-02 1 1  ON 43
eH2_4                 9.854189e-03 1 1  ON 44
eH2_5                 4.294138e-02 1 1  ON 45
eH2_6                 9.879507e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.632722
====================================================
  Execution time = 2.0437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345144513794
                                         uncertainty =       0.004390571172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345144513794
                                         uncertainty =       0.004390571172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415391910
  error estimate for blocks of size 2^( 2) =       0.000427757372
  error estimate for blocks of size 2^( 3) =       0.000440935376
  error estimate for blocks of size 2^( 4) =       0.000453901094
  error estimate for blocks of size 2^( 5) =       0.000466488195
  error estimate for blocks of size 2^( 6) =       0.000473916348
  error estimate for blocks of size 2^( 7) =       0.000476079977

      target function =                  N/A
              le_mean =     -16.906473833803
             les_mean =     286.173958197879
             stat err =       0.000467596403
             autocorr =       1.267144830707
              std dev =       0.587452872454
             le_variance =       0.345100877355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647383380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473833803       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473834634       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473834991       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473834523       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906473834248       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906473834303       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906473834548       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473834498       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.664121e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473833803       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473834011       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473834100       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473833983       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906473833914       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906473833929       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906473833988       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473833977       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 9.164238e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473833803       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473833855       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473833878       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473833849       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906473833832       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906473833835       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906473833852       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473833845       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 2.291306e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6071e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.116424e-02 1 1  ON 2
 uu_3                -2.105998e-02 1 1  ON 3
 uu_4                -6.594185e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397876e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018914e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832526e-01 1 1  ON 11
 ud_2                 6.186273e-02 1 1  ON 12
 ud_3                -9.988030e-03 1 1  ON 13
 ud_4                -6.697316e-02 1 1  ON 14
 ud_5                -1.082640e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657030e-01 1 1  ON 20
 eO_1                -4.432285e-01 1 1  ON 21
 eO_2                -2.013298e-02 1 1  ON 22
 eO_3                 3.024885e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867838e-01 1 1  ON 25
 eO_6                 2.562428e-01 1 1  ON 26
 eO_7                -4.645315e-02 1 1  ON 27
 eO_8                -2.193466e-01 1 1  ON 28
 eO_9                -7.815179e-02 1 1  ON 29
eH1_0                -2.433122e-01 1 1  ON 30
eH1_1                -1.428301e-01 1 1  ON 31
eH1_2                -9.588536e-02 1 1  ON 32
eH1_3                -4.192965e-02 1 1  ON 33
eH1_4                 5.791203e-03 1 1  ON 34
eH1_5                 4.058028e-02 1 1  ON 35
eH1_6                 9.791551e-02 1 1  ON 36
eH1_7                 1.510335e-01 1 1  ON 37
eH1_8                 1.737552e-01 1 1  ON 38
eH1_9                 5.895856e-02 1 1  ON 39
eH2_0                -2.388125e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213659e-02 1 1  ON 42
eH2_3                -3.793476e-02 1 1  ON 43
eH2_4                 9.854131e-03 1 1  ON 44
eH2_5                 4.294141e-02 1 1  ON 45
eH2_6                 9.879512e-02 1 1  ON 46
eH2_7                 1.505160e-01 1 1  ON 47
eH2_8                 1.766665e-01 1 1  ON 48
eH2_9                 4.638168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9786
    reference variance = 0.430117
====================================================
  Execution time = 2.0275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4080e-01
  Total weights = 2.0000e+06
  Execution time = 1.9018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795101810
                                         uncertainty =       0.003760056749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795101810
                                         uncertainty =       0.003760056749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412794115
  error estimate for blocks of size 2^( 2) =       0.000425561864
  error estimate for blocks of size 2^( 3) =       0.000439157506
  error estimate for blocks of size 2^( 4) =       0.000451911485
  error estimate for blocks of size 2^( 5) =       0.000462979340
  error estimate for blocks of size 2^( 6) =       0.000471436489
  error estimate for blocks of size 2^( 7) =       0.000478864889

      target function =                  N/A
              le_mean =     -16.905287330459
             les_mean =     286.129537518244
             stat err =       0.000466298051
             autocorr =       1.276028001427
              std dev =       0.583779036331
             le_variance =       0.340797963260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795179962
                                         uncertainty =       0.003760056795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795179962
                                         uncertainty =       0.003760056795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412794163
  error estimate for blocks of size 2^( 2) =       0.000425561905
  error estimate for blocks of size 2^( 3) =       0.000439157539
  error estimate for blocks of size 2^( 4) =       0.000451911511
  error estimate for blocks of size 2^( 5) =       0.000462979361
  error estimate for blocks of size 2^( 6) =       0.000471436508
  error estimate for blocks of size 2^( 7) =       0.000478864915

      target function =                  N/A
              le_mean =     -16.905287331914
             les_mean =     286.129537645633
             stat err =       0.000466298074
             autocorr =       1.276027836983
              std dev =       0.583779103301
             le_variance =       0.340798041451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795140892
                                         uncertainty =       0.003760056771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795140892
                                         uncertainty =       0.003760056771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412794139
  error estimate for blocks of size 2^( 2) =       0.000425561885
  error estimate for blocks of size 2^( 3) =       0.000439157522
  error estimate for blocks of size 2^( 4) =       0.000451911498
  error estimate for blocks of size 2^( 5) =       0.000462979351
  error estimate for blocks of size 2^( 6) =       0.000471436498
  error estimate for blocks of size 2^( 7) =       0.000478864902

      target function =                  N/A
              le_mean =     -16.905287331187
             les_mean =     286.129537581970
             stat err =       0.000466298062
             autocorr =       1.276027919171
              std dev =       0.583779069821
             le_variance =       0.340798002361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795106695
                                         uncertainty =       0.003760056752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795106695
                                         uncertainty =       0.003760056752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412794118
  error estimate for blocks of size 2^( 2) =       0.000425561867
  error estimate for blocks of size 2^( 3) =       0.000439157508
  error estimate for blocks of size 2^( 4) =       0.000451911486
  error estimate for blocks of size 2^( 5) =       0.000462979341
  error estimate for blocks of size 2^( 6) =       0.000471436490
  error estimate for blocks of size 2^( 7) =       0.000478864891

      target function =                  N/A
              le_mean =     -16.905287330550
             les_mean =     286.129537526210
             stat err =       0.000466298052
             autocorr =       1.276027991145
              std dev =       0.583779040518
             le_variance =       0.340797968148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905287330459        initial
     6.2500e+02     6.2500e+03             3.6641e-07       -16.905287331914  <--
     2.5000e+03     2.5000e+04             9.1642e-08       -16.905287331187
     1.0000e+04     1.0000e+05             2.2913e-08       -16.905287330550

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.9880e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426946e-01 1 1  ON 1
 uu_2                 4.116427e-02 1 1  ON 2
 uu_3                -2.105994e-02 1 1  ON 3
 uu_4                -6.594188e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397876e-01 1 1  ON 7
 uu_8                -1.320748e-01 1 1  ON 8
 uu_9                -1.018915e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832526e-01 1 1  ON 11
 ud_2                 6.186265e-02 1 1  ON 12
 ud_3                -9.987924e-03 1 1  ON 13
 ud_4                -6.697318e-02 1 1  ON 14
 ud_5                -1.082639e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657032e-01 1 1  ON 20
 eO_1                -4.432283e-01 1 1  ON 21
 eO_2                -2.013301e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867839e-01 1 1  ON 25
 eO_6                 2.562429e-01 1 1  ON 26
 eO_7                -4.645308e-02 1 1  ON 27
 eO_8                -2.193467e-01 1 1  ON 28
 eO_9                -7.815193e-02 1 1  ON 29
eH1_0                -2.433123e-01 1 1  ON 30
eH1_1                -1.428301e-01 1 1  ON 31
eH1_2                -9.588545e-02 1 1  ON 32
eH1_3                -4.192968e-02 1 1  ON 33
eH1_4                 5.791138e-03 1 1  ON 34
eH1_5                 4.058015e-02 1 1  ON 35
eH1_6                 9.791541e-02 1 1  ON 36
eH1_7                 1.510337e-01 1 1  ON 37
eH1_8                 1.737554e-01 1 1  ON 38
eH1_9                 5.895876e-02 1 1  ON 39
eH2_0                -2.388128e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213674e-02 1 1  ON 42
eH2_3                -3.793487e-02 1 1  ON 43
eH2_4                 9.853954e-03 1 1  ON 44
eH2_5                 4.294150e-02 1 1  ON 45
eH2_6                 9.879528e-02 1 1  ON 46
eH2_7                 1.505161e-01 1 1  ON 47
eH2_8                 1.766666e-01 1 1  ON 48
eH2_9                 4.638192e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9419
    reference variance = 0.242336
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339385542757
                                         uncertainty =       0.004305180011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339385542757
                                         uncertainty =       0.004305180011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411897760
  error estimate for blocks of size 2^( 2) =       0.000424655646
  error estimate for blocks of size 2^( 3) =       0.000438052530
  error estimate for blocks of size 2^( 4) =       0.000449907990
  error estimate for blocks of size 2^( 5) =       0.000459518855
  error estimate for blocks of size 2^( 6) =       0.000468451207
  error estimate for blocks of size 2^( 7) =       0.000471777423

      target function =                  N/A
              le_mean =     -16.905639416622
             les_mean =     286.139963444712
             stat err =       0.000462413869
             autocorr =       1.260325843016
              std dev =       0.582511398620
             le_variance =       0.339319529522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563941662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639416622       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639419060       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639419417       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639419679       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639418194       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639419935       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639420590       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.779630e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639416622       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639417232       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639417322       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639417389       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639417019       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639417456       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639417617       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.449977e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639416622       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639416775       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639416797       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639416814       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639416721       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639416830       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639416871       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.112551e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6378e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426946e-01 1 1  ON 1
 uu_2                 4.116422e-02 1 1  ON 2
 uu_3                -2.105997e-02 1 1  ON 3
 uu_4                -6.594203e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268131e-01 1 1  ON 6
 uu_7                -1.397876e-01 1 1  ON 7
 uu_8                -1.320747e-01 1 1  ON 8
 uu_9                -1.018917e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832529e-01 1 1  ON 11
 ud_2                 6.186266e-02 1 1  ON 12
 ud_3                -9.987878e-03 1 1  ON 13
 ud_4                -6.697323e-02 1 1  ON 14
 ud_5                -1.082639e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512210e-01 1 1  ON 18
 ud_9                -1.402191e-01 1 1  ON 19
 eO_0                -7.657033e-01 1 1  ON 20
 eO_1                -4.432281e-01 1 1  ON 21
 eO_2                -2.013313e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274378e-01 1 1  ON 24
 eO_5                 4.867839e-01 1 1  ON 25
 eO_6                 2.562431e-01 1 1  ON 26
 eO_7                -4.645295e-02 1 1  ON 27
 eO_8                -2.193469e-01 1 1  ON 28
 eO_9                -7.815215e-02 1 1  ON 29
eH1_0                -2.433125e-01 1 1  ON 30
eH1_1                -1.428301e-01 1 1  ON 31
eH1_2                -9.588552e-02 1 1  ON 32
eH1_3                -4.192985e-02 1 1  ON 33
eH1_4                 5.791114e-03 1 1  ON 34
eH1_5                 4.058007e-02 1 1  ON 35
eH1_6                 9.791544e-02 1 1  ON 36
eH1_7                 1.510338e-01 1 1  ON 37
eH1_8                 1.737555e-01 1 1  ON 38
eH1_9                 5.895903e-02 1 1  ON 39
eH2_0                -2.388132e-01 1 1  ON 40
eH2_1                -1.389749e-01 1 1  ON 41
eH2_2                -9.213684e-02 1 1  ON 42
eH2_3                -3.793486e-02 1 1  ON 43
eH2_4                 9.853850e-03 1 1  ON 44
eH2_5                 4.294149e-02 1 1  ON 45
eH2_6                 9.879540e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766668e-01 1 1  ON 48
eH2_9                 4.638220e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.141465
====================================================
  Execution time = 2.0544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.0000e+06
  Execution time = 1.8883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688692804
                                         uncertainty =       0.003424345181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688692804
                                         uncertainty =       0.003424345181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410900185
  error estimate for blocks of size 2^( 2) =       0.000423677864
  error estimate for blocks of size 2^( 3) =       0.000437105659
  error estimate for blocks of size 2^( 4) =       0.000448889138
  error estimate for blocks of size 2^( 5) =       0.000461415798
  error estimate for blocks of size 2^( 6) =       0.000470084802
  error estimate for blocks of size 2^( 7) =       0.000475301216

      target function =                  N/A
              le_mean =     -16.905400071857
             les_mean =     286.130229345594
             stat err =       0.000463922739
             autocorr =       1.274731283522
              std dev =       0.581100615115
             le_variance =       0.337677924888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688859176
                                         uncertainty =       0.003424347133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688859176
                                         uncertainty =       0.003424347133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410900286
  error estimate for blocks of size 2^( 2) =       0.000423677942
  error estimate for blocks of size 2^( 3) =       0.000437105713
  error estimate for blocks of size 2^( 4) =       0.000448889173
  error estimate for blocks of size 2^( 5) =       0.000461415828
  error estimate for blocks of size 2^( 6) =       0.000470084803
  error estimate for blocks of size 2^( 7) =       0.000475301212

      target function =                  N/A
              le_mean =     -16.905400071097
             les_mean =     286.130229485398
             stat err =       0.000463922754
             autocorr =       1.274730745226
              std dev =       0.581100757522
             le_variance =       0.337678090393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688775693
                                         uncertainty =       0.003424346154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688775693
                                         uncertainty =       0.003424346154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410900236
  error estimate for blocks of size 2^( 2) =       0.000423677903
  error estimate for blocks of size 2^( 3) =       0.000437105686
  error estimate for blocks of size 2^( 4) =       0.000448889155
  error estimate for blocks of size 2^( 5) =       0.000461415813
  error estimate for blocks of size 2^( 6) =       0.000470084803
  error estimate for blocks of size 2^( 7) =       0.000475301214

      target function =                  N/A
              le_mean =     -16.905400071476
             les_mean =     286.130229415164
             stat err =       0.000463922746
             autocorr =       1.274731014380
              std dev =       0.581100686063
             le_variance =       0.337678007343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688703155
                                         uncertainty =       0.003424345303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337688703155
                                         uncertainty =       0.003424345303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410900192
  error estimate for blocks of size 2^( 2) =       0.000423677868
  error estimate for blocks of size 2^( 3) =       0.000437105662
  error estimate for blocks of size 2^( 4) =       0.000448889140
  error estimate for blocks of size 2^( 5) =       0.000461415800
  error estimate for blocks of size 2^( 6) =       0.000470084802
  error estimate for blocks of size 2^( 7) =       0.000475301215

      target function =                  N/A
              le_mean =     -16.905400071809
             les_mean =     286.130229354274
             stat err =       0.000463922739
             autocorr =       1.274731249871
              std dev =       0.581100623975
             le_variance =       0.337677935184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905400071857        initial  <--
     1.5625e+02     1.5625e+03             1.7796e-06       -16.905400071097
     6.2500e+02     6.2500e+03             4.4500e-07       -16.905400071476
     2.5000e+03     2.5000e+04             1.1126e-07       -16.905400071809

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0740
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426946e-01 1 1  ON 1
 uu_2                 4.116427e-02 1 1  ON 2
 uu_3                -2.105994e-02 1 1  ON 3
 uu_4                -6.594188e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397876e-01 1 1  ON 7
 uu_8                -1.320748e-01 1 1  ON 8
 uu_9                -1.018915e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832526e-01 1 1  ON 11
 ud_2                 6.186265e-02 1 1  ON 12
 ud_3                -9.987924e-03 1 1  ON 13
 ud_4                -6.697318e-02 1 1  ON 14
 ud_5                -1.082639e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657032e-01 1 1  ON 20
 eO_1                -4.432283e-01 1 1  ON 21
 eO_2                -2.013301e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274376e-01 1 1  ON 24
 eO_5                 4.867839e-01 1 1  ON 25
 eO_6                 2.562429e-01 1 1  ON 26
 eO_7                -4.645308e-02 1 1  ON 27
 eO_8                -2.193467e-01 1 1  ON 28
 eO_9                -7.815193e-02 1 1  ON 29
eH1_0                -2.433123e-01 1 1  ON 30
eH1_1                -1.428301e-01 1 1  ON 31
eH1_2                -9.588545e-02 1 1  ON 32
eH1_3                -4.192968e-02 1 1  ON 33
eH1_4                 5.791138e-03 1 1  ON 34
eH1_5                 4.058015e-02 1 1  ON 35
eH1_6                 9.791541e-02 1 1  ON 36
eH1_7                 1.510337e-01 1 1  ON 37
eH1_8                 1.737554e-01 1 1  ON 38
eH1_9                 5.895876e-02 1 1  ON 39
eH2_0                -2.388128e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213674e-02 1 1  ON 42
eH2_3                -3.793487e-02 1 1  ON 43
eH2_4                 9.853954e-03 1 1  ON 44
eH2_5                 4.294150e-02 1 1  ON 45
eH2_6                 9.879528e-02 1 1  ON 46
eH2_7                 1.505161e-01 1 1  ON 47
eH2_8                 1.766666e-01 1 1  ON 48
eH2_9                 4.638192e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9453
    reference variance = 0.246683
====================================================
  Execution time = 2.2868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337649352260
                                         uncertainty =       0.004471586945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337649352260
                                         uncertainty =       0.004471586945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410952192
  error estimate for blocks of size 2^( 2) =       0.000423883314
  error estimate for blocks of size 2^( 3) =       0.000436941909
  error estimate for blocks of size 2^( 4) =       0.000449018105
  error estimate for blocks of size 2^( 5) =       0.000459489689
  error estimate for blocks of size 2^( 6) =       0.000466136558
  error estimate for blocks of size 2^( 7) =       0.000472278954

      target function =                  N/A
              le_mean =     -16.906164687221
             les_mean =     286.156167670158
             stat err =       0.000461730826
             autocorr =       1.262394630025
              std dev =       0.581174162886
             le_variance =       0.337763407606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616468722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164687221       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164687725       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906164688005       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906164688112       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906164688394       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164688399       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906164688316       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164688249       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.431809e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164687221       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164687347       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906164687417       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906164687444       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906164687512       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164687519       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906164687493       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164687477       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.579547e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164687221       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164687252       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906164687270       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906164687277       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906164687292       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164687303       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906164687294       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164687262       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 8.948883e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8430e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426946e-01 1 1  ON 1
 uu_2                 4.116429e-02 1 1  ON 2
 uu_3                -2.105993e-02 1 1  ON 3
 uu_4                -6.594187e-02 1 1  ON 4
 uu_5                -1.001286e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397876e-01 1 1  ON 7
 uu_8                -1.320748e-01 1 1  ON 8
 uu_9                -1.018916e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186265e-02 1 1  ON 12
 ud_3                -9.987923e-03 1 1  ON 13
 ud_4                -6.697319e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512209e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657032e-01 1 1  ON 20
 eO_1                -4.432283e-01 1 1  ON 21
 eO_2                -2.013300e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274377e-01 1 1  ON 24
 eO_5                 4.867839e-01 1 1  ON 25
 eO_6                 2.562429e-01 1 1  ON 26
 eO_7                -4.645308e-02 1 1  ON 27
 eO_8                -2.193467e-01 1 1  ON 28
 eO_9                -7.815195e-02 1 1  ON 29
eH1_0                -2.433123e-01 1 1  ON 30
eH1_1                -1.428301e-01 1 1  ON 31
eH1_2                -9.588546e-02 1 1  ON 32
eH1_3                -4.192967e-02 1 1  ON 33
eH1_4                 5.791125e-03 1 1  ON 34
eH1_5                 4.058015e-02 1 1  ON 35
eH1_6                 9.791539e-02 1 1  ON 36
eH1_7                 1.510337e-01 1 1  ON 37
eH1_8                 1.737554e-01 1 1  ON 38
eH1_9                 5.895880e-02 1 1  ON 39
eH2_0                -2.388128e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213674e-02 1 1  ON 42
eH2_3                -3.793488e-02 1 1  ON 43
eH2_4                 9.853947e-03 1 1  ON 44
eH2_5                 4.294149e-02 1 1  ON 45
eH2_6                 9.879528e-02 1 1  ON 46
eH2_7                 1.505161e-01 1 1  ON 47
eH2_8                 1.766666e-01 1 1  ON 48
eH2_9                 4.638194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.222795
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872204810
                                         uncertainty =       0.004978681462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872204810
                                         uncertainty =       0.004978681462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356311
  error estimate for blocks of size 2^( 2) =       0.000423234122
  error estimate for blocks of size 2^( 3) =       0.000436568789
  error estimate for blocks of size 2^( 4) =       0.000448301269
  error estimate for blocks of size 2^( 5) =       0.000459751103
  error estimate for blocks of size 2^( 6) =       0.000467023441
  error estimate for blocks of size 2^( 7) =       0.000471932151

      target function =                  N/A
              le_mean =     -16.905814954134
             les_mean =     286.143363698413
             stat err =       0.000461751991
             autocorr =       1.266179622784
              std dev =       0.580331459930
             le_variance =       0.336784603385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872149123
                                         uncertainty =       0.004978679957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872149123
                                         uncertainty =       0.004978679957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356277
  error estimate for blocks of size 2^( 2) =       0.000423234088
  error estimate for blocks of size 2^( 3) =       0.000436568755
  error estimate for blocks of size 2^( 4) =       0.000448301235
  error estimate for blocks of size 2^( 5) =       0.000459751070
  error estimate for blocks of size 2^( 6) =       0.000467023409
  error estimate for blocks of size 2^( 7) =       0.000471932120

      target function =                  N/A
              le_mean =     -16.905814954513
             les_mean =     286.143363655512
             stat err =       0.000461751959
             autocorr =       1.266179655812
              std dev =       0.580331411915
             le_variance =       0.336784547656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872176956
                                         uncertainty =       0.004978680709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872176956
                                         uncertainty =       0.004978680709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356294
  error estimate for blocks of size 2^( 2) =       0.000423234105
  error estimate for blocks of size 2^( 3) =       0.000436568772
  error estimate for blocks of size 2^( 4) =       0.000448301252
  error estimate for blocks of size 2^( 5) =       0.000459751086
  error estimate for blocks of size 2^( 6) =       0.000467023425
  error estimate for blocks of size 2^( 7) =       0.000471932136

      target function =                  N/A
              le_mean =     -16.905814954324
             les_mean =     286.143363676952
             stat err =       0.000461751975
             autocorr =       1.266179639310
              std dev =       0.580331435914
             le_variance =       0.336784575510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872201327
                                         uncertainty =       0.004978681368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336872201327
                                         uncertainty =       0.004978681368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356309
  error estimate for blocks of size 2^( 2) =       0.000423234120
  error estimate for blocks of size 2^( 3) =       0.000436568787
  error estimate for blocks of size 2^( 4) =       0.000448301266
  error estimate for blocks of size 2^( 5) =       0.000459751101
  error estimate for blocks of size 2^( 6) =       0.000467023439
  error estimate for blocks of size 2^( 7) =       0.000471932149

      target function =                  N/A
              le_mean =     -16.905814954158
             les_mean =     286.143363695730
             stat err =       0.000461751989
             autocorr =       1.266179624852
              std dev =       0.580331456928
             le_variance =       0.336784599900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905814954134        initial
     1.5625e+03     1.5625e+04             1.4318e-07       -16.905814954513  <--
     6.2500e+03     6.2500e+04             3.5795e-08       -16.905814954324
     2.5000e+04     2.5000e+05             8.9489e-09       -16.905814954158

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.9727e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426946e-01 1 1  ON 1
 uu_2                 4.116434e-02 1 1  ON 2
 uu_3                -2.105992e-02 1 1  ON 3
 uu_4                -6.594187e-02 1 1  ON 4
 uu_5                -1.001286e-01 1 1  ON 5
 uu_6                -1.268129e-01 1 1  ON 6
 uu_7                -1.397877e-01 1 1  ON 7
 uu_8                -1.320749e-01 1 1  ON 8
 uu_9                -1.018916e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186265e-02 1 1  ON 12
 ud_3                -9.987920e-03 1 1  ON 13
 ud_4                -6.697319e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512212e-01 1 1  ON 17
 ud_8                -1.512210e-01 1 1  ON 18
 ud_9                -1.402190e-01 1 1  ON 19
 eO_0                -7.657033e-01 1 1  ON 20
 eO_1                -4.432282e-01 1 1  ON 21
 eO_2                -2.013298e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274377e-01 1 1  ON 24
 eO_5                 4.867839e-01 1 1  ON 25
 eO_6                 2.562429e-01 1 1  ON 26
 eO_7                -4.645308e-02 1 1  ON 27
 eO_8                -2.193468e-01 1 1  ON 28
 eO_9                -7.815201e-02 1 1  ON 29
eH1_0                -2.433124e-01 1 1  ON 30
eH1_1                -1.428302e-01 1 1  ON 31
eH1_2                -9.588551e-02 1 1  ON 32
eH1_3                -4.192966e-02 1 1  ON 33
eH1_4                 5.791084e-03 1 1  ON 34
eH1_5                 4.058014e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510337e-01 1 1  ON 37
eH1_8                 1.737554e-01 1 1  ON 38
eH1_9                 5.895891e-02 1 1  ON 39
eH2_0                -2.388129e-01 1 1  ON 40
eH2_1                -1.389748e-01 1 1  ON 41
eH2_2                -9.213674e-02 1 1  ON 42
eH2_3                -3.793492e-02 1 1  ON 43
eH2_4                 9.853924e-03 1 1  ON 44
eH2_5                 4.294148e-02 1 1  ON 45
eH2_6                 9.879531e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766666e-01 1 1  ON 48
eH2_9                 4.638201e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8748
    reference variance = 0.23576
====================================================
  Execution time = 2.1000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344171341374
                                         uncertainty =       0.007313859334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344171341374
                                         uncertainty =       0.007313859334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414920746
  error estimate for blocks of size 2^( 2) =       0.000427604118
  error estimate for blocks of size 2^( 3) =       0.000441183380
  error estimate for blocks of size 2^( 4) =       0.000453740229
  error estimate for blocks of size 2^( 5) =       0.000466191399
  error estimate for blocks of size 2^( 6) =       0.000475815902
  error estimate for blocks of size 2^( 7) =       0.000480298644

      target function =                  N/A
              le_mean =     -16.906189730788
             les_mean =     286.163569491446
             stat err =       0.000469011544
             autocorr =       1.277723154058
              std dev =       0.586786545696
             le_variance =       0.344318450210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618973079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906189730788       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906189732645       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189732465       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906189732575       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906189732430       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906189732840       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189733101       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189732993       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.412646e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906189730788       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906189731252       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189731207       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906189731235       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906189731199       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906189731301       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189731366       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189731340       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.353231e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906189730788       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906189730904       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189730893       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906189730900       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906189730890       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906189730917       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189730927       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189730925       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.383122e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6585e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426947e-01 1 1  ON 1
 uu_2                 4.116438e-02 1 1  ON 2
 uu_3                -2.105990e-02 1 1  ON 3
 uu_4                -6.594192e-02 1 1  ON 4
 uu_5                -1.001286e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397877e-01 1 1  ON 7
 uu_8                -1.320750e-01 1 1  ON 8
 uu_9                -1.018917e-01 1 1  ON 9
 ud_0                 4.495833e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186269e-02 1 1  ON 12
 ud_3                -9.987865e-03 1 1  ON 13
 ud_4                -6.697317e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512211e-01 1 1  ON 17
 ud_8                -1.512211e-01 1 1  ON 18
 ud_9                -1.402191e-01 1 1  ON 19
 eO_0                -7.657033e-01 1 1  ON 20
 eO_1                -4.432282e-01 1 1  ON 21
 eO_2                -2.013304e-02 1 1  ON 22
 eO_3                 3.024884e-01 1 1  ON 23
 eO_4                 5.274378e-01 1 1  ON 24
 eO_5                 4.867841e-01 1 1  ON 25
 eO_6                 2.562430e-01 1 1  ON 26
 eO_7                -4.645307e-02 1 1  ON 27
 eO_8                -2.193468e-01 1 1  ON 28
 eO_9                -7.815210e-02 1 1  ON 29
eH1_0                -2.433124e-01 1 1  ON 30
eH1_1                -1.428302e-01 1 1  ON 31
eH1_2                -9.588556e-02 1 1  ON 32
eH1_3                -4.192962e-02 1 1  ON 33
eH1_4                 5.791068e-03 1 1  ON 34
eH1_5                 4.058013e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510337e-01 1 1  ON 37
eH1_8                 1.737555e-01 1 1  ON 38
eH1_9                 5.895900e-02 1 1  ON 39
eH2_0                -2.388130e-01 1 1  ON 40
eH2_1                -1.389750e-01 1 1  ON 41
eH2_2                -9.213671e-02 1 1  ON 42
eH2_3                -3.793500e-02 1 1  ON 43
eH2_4                 9.853903e-03 1 1  ON 44
eH2_5                 4.294152e-02 1 1  ON 45
eH2_6                 9.879534e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766667e-01 1 1  ON 48
eH2_9                 4.638214e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.409449
====================================================
  Execution time = 2.0140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.0000e+06
  Execution time = 1.8998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034247623
                                         uncertainty =       0.002891570479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034247623
                                         uncertainty =       0.002891570479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411135100
  error estimate for blocks of size 2^( 2) =       0.000424075168
  error estimate for blocks of size 2^( 3) =       0.000437751739
  error estimate for blocks of size 2^( 4) =       0.000450335499
  error estimate for blocks of size 2^( 5) =       0.000461603616
  error estimate for blocks of size 2^( 6) =       0.000470232610
  error estimate for blocks of size 2^( 7) =       0.000476402334

      target function =                  N/A
              le_mean =     -16.905396856586
             les_mean =     286.130506851033
             stat err =       0.000464643515
             autocorr =       1.277234520719
              std dev =       0.581432834807
             le_variance =       0.338064141392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034212060
                                         uncertainty =       0.002891570072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034212060
                                         uncertainty =       0.002891570072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411135079
  error estimate for blocks of size 2^( 2) =       0.000424075141
  error estimate for blocks of size 2^( 3) =       0.000437751707
  error estimate for blocks of size 2^( 4) =       0.000450335469
  error estimate for blocks of size 2^( 5) =       0.000461603591
  error estimate for blocks of size 2^( 6) =       0.000470232585
  error estimate for blocks of size 2^( 7) =       0.000476402299

      target function =                  N/A
              le_mean =     -16.905396857282
             les_mean =     286.130506839038
             stat err =       0.000464643486
             autocorr =       1.277234496420
              std dev =       0.581432804252
             le_variance =       0.338064105860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034229846
                                         uncertainty =       0.002891570276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034229846
                                         uncertainty =       0.002891570276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411135089
  error estimate for blocks of size 2^( 2) =       0.000424075155
  error estimate for blocks of size 2^( 3) =       0.000437751723
  error estimate for blocks of size 2^( 4) =       0.000450335484
  error estimate for blocks of size 2^( 5) =       0.000461603604
  error estimate for blocks of size 2^( 6) =       0.000470232597
  error estimate for blocks of size 2^( 7) =       0.000476402316

      target function =                  N/A
              le_mean =     -16.905396856934
             les_mean =     286.130506845027
             stat err =       0.000464643500
             autocorr =       1.277234508558
              std dev =       0.581432819534
             le_variance =       0.338064123631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034245401
                                         uncertainty =       0.002891570454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338034245401
                                         uncertainty =       0.002891570454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411135099
  error estimate for blocks of size 2^( 2) =       0.000424075166
  error estimate for blocks of size 2^( 3) =       0.000437751737
  error estimate for blocks of size 2^( 4) =       0.000450335497
  error estimate for blocks of size 2^( 5) =       0.000461603615
  error estimate for blocks of size 2^( 6) =       0.000470232608
  error estimate for blocks of size 2^( 7) =       0.000476402332

      target function =                  N/A
              le_mean =     -16.905396856630
             les_mean =     286.130506850282
             stat err =       0.000464643513
             autocorr =       1.277234519194
              std dev =       0.581432832898
             le_variance =       0.338064139172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905396856586        initial
     3.9062e+02     3.9062e+03             5.4126e-07       -16.905396857282  <--
     1.5625e+03     1.5625e+04             1.3532e-07       -16.905396856934
     6.2500e+03     6.2500e+04             3.3831e-08       -16.905396856630

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9719e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.179813
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3633e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326481177
                                         uncertainty =       0.002690499752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336326481177
                                         uncertainty =       0.002690499752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410077110
  error estimate for blocks of size 2^( 2) =       0.000423508879
  error estimate for blocks of size 2^( 3) =       0.000437004203
  error estimate for blocks of size 2^( 4) =       0.000449975857
  error estimate for blocks of size 2^( 5) =       0.000460653909
  error estimate for blocks of size 2^( 6) =       0.000468834319
  error estimate for blocks of size 2^( 7) =       0.000475573301

      target function =                  N/A
              le_mean =     -16.905253264821
             les_mean =     286.123914252643
             stat err =       0.000463759346
             autocorr =       1.278952139647
              std dev =       0.579936611259
             le_variance =       0.336326473079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525326482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253264821       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253275392       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905253276868       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253273345       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905253275395       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905253278203       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905253278274       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905253278483       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.811612e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253264821       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253267467       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905253267841       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253266957       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905253267462       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905253268165       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905253268185       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905253268238       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 7.032595e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905253264821       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905253265483       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905253265576       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905253265355       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905253265481       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905253265657       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905253265661       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905253265674       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.758372e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6381e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.093899e-01 1 1  ON 0
 uu_1                 1.426950e-01 1 1  ON 1
 uu_2                 4.116457e-02 1 1  ON 2
 uu_3                -2.105970e-02 1 1  ON 3
 uu_4                -6.594205e-02 1 1  ON 4
 uu_5                -1.001287e-01 1 1  ON 5
 uu_6                -1.268132e-01 1 1  ON 6
 uu_7                -1.397882e-01 1 1  ON 7
 uu_8                -1.320755e-01 1 1  ON 8
 uu_9                -1.018921e-01 1 1  ON 9
 ud_0                 4.495836e-01 1 1  ON 10
 ud_1                 1.832528e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987870e-03 1 1  ON 13
 ud_4                -6.697317e-02 1 1  ON 14
 ud_5                -1.082639e-01 1 1  ON 15
 ud_6                -1.352594e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512212e-01 1 1  ON 18
 ud_9                -1.402194e-01 1 1  ON 19
 eO_0                -7.657040e-01 1 1  ON 20
 eO_1                -4.432278e-01 1 1  ON 21
 eO_2                -2.013318e-02 1 1  ON 22
 eO_3                 3.024881e-01 1 1  ON 23
 eO_4                 5.274384e-01 1 1  ON 24
 eO_5                 4.867848e-01 1 1  ON 25
 eO_6                 2.562435e-01 1 1  ON 26
 eO_7                -4.645290e-02 1 1  ON 27
 eO_8                -2.193474e-01 1 1  ON 28
 eO_9                -7.815276e-02 1 1  ON 29
eH1_0                -2.433129e-01 1 1  ON 30
eH1_1                -1.428305e-01 1 1  ON 31
eH1_2                -9.588588e-02 1 1  ON 32
eH1_3                -4.192963e-02 1 1  ON 33
eH1_4                 5.790861e-03 1 1  ON 34
eH1_5                 4.058007e-02 1 1  ON 35
eH1_6                 9.791526e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737560e-01 1 1  ON 38
eH1_9                 5.895987e-02 1 1  ON 39
eH2_0                -2.388141e-01 1 1  ON 40
eH2_1                -1.389754e-01 1 1  ON 41
eH2_2                -9.213647e-02 1 1  ON 42
eH2_3                -3.793563e-02 1 1  ON 43
eH2_4                 9.853744e-03 1 1  ON 44
eH2_5                 4.294150e-02 1 1  ON 45
eH2_6                 9.879575e-02 1 1  ON 46
eH2_7                 1.505164e-01 1 1  ON 47
eH2_8                 1.766672e-01 1 1  ON 48
eH2_9                 4.638303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.126821
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3555e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453145560
                                         uncertainty =       0.002819631885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453145560
                                         uncertainty =       0.002819631885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409604679
  error estimate for blocks of size 2^( 2) =       0.000421733007
  error estimate for blocks of size 2^( 3) =       0.000434553908
  error estimate for blocks of size 2^( 4) =       0.000446641657
  error estimate for blocks of size 2^( 5) =       0.000456356623
  error estimate for blocks of size 2^( 6) =       0.000464771411
  error estimate for blocks of size 2^( 7) =       0.000470849714

      target function =                  N/A
              le_mean =     -16.905400642318
             les_mean =     286.128122695023
             stat err =       0.000459654851
             autocorr =       1.259313556350
              std dev =       0.579268491745
             le_variance =       0.335551985528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454001577
                                         uncertainty =       0.002819631084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335454001577
                                         uncertainty =       0.002819631084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409605202
  error estimate for blocks of size 2^( 2) =       0.000421733495
  error estimate for blocks of size 2^( 3) =       0.000434554358
  error estimate for blocks of size 2^( 4) =       0.000446642068
  error estimate for blocks of size 2^( 5) =       0.000456357022
  error estimate for blocks of size 2^( 6) =       0.000464771801
  error estimate for blocks of size 2^( 7) =       0.000470850066

      target function =                  N/A
              le_mean =     -16.905400636547
             les_mean =     286.128123356932
             stat err =       0.000459655240
             autocorr =       1.259312468907
              std dev =       0.579269231472
             le_variance =       0.335552842530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453574084
                                         uncertainty =       0.002819631480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453574084
                                         uncertainty =       0.002819631480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409604940
  error estimate for blocks of size 2^( 2) =       0.000421733251
  error estimate for blocks of size 2^( 3) =       0.000434554133
  error estimate for blocks of size 2^( 4) =       0.000446641863
  error estimate for blocks of size 2^( 5) =       0.000456356823
  error estimate for blocks of size 2^( 6) =       0.000464771606
  error estimate for blocks of size 2^( 7) =       0.000470849890

      target function =                  N/A
              le_mean =     -16.905400639425
             les_mean =     286.128123026247
             stat err =       0.000459655046
             autocorr =       1.259313012023
              std dev =       0.579268862054
             le_variance =       0.335552414545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453199141
                                         uncertainty =       0.002819631834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335453199141
                                         uncertainty =       0.002819631834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409604711
  error estimate for blocks of size 2^( 2) =       0.000421733038
  error estimate for blocks of size 2^( 3) =       0.000434553936
  error estimate for blocks of size 2^( 4) =       0.000446641683
  error estimate for blocks of size 2^( 5) =       0.000456356648
  error estimate for blocks of size 2^( 6) =       0.000464771435
  error estimate for blocks of size 2^( 7) =       0.000470849736

      target function =                  N/A
              le_mean =     -16.905400641956
             les_mean =     286.128122736425
             stat err =       0.000459654875
             autocorr =       1.259313488299
              std dev =       0.579268538046
             le_variance =       0.335552039170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905400642318        initial  <--
     9.7656e+01     9.7656e+02             2.8116e-06       -16.905400636547
     3.9062e+02     3.9062e+03             7.0326e-07       -16.905400639425
     1.5625e+03     1.5625e+04             1.7584e-07       -16.905400641956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7483
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.287514
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358161113830
                                         uncertainty =       0.021693623562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358161113830
                                         uncertainty =       0.021693623562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423184066
  error estimate for blocks of size 2^( 2) =       0.000435568360
  error estimate for blocks of size 2^( 3) =       0.000448395408
  error estimate for blocks of size 2^( 4) =       0.000460487851
  error estimate for blocks of size 2^( 5) =       0.000470208407
  error estimate for blocks of size 2^( 6) =       0.000475998106
  error estimate for blocks of size 2^( 7) =       0.000479843382

      target function =                  N/A
              le_mean =     -16.905252339642
             les_mean =     286.145725995882
             stat err =       0.000471634437
             autocorr =       1.242088099283
              std dev =       0.598472645984
             le_variance =       0.358169507991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525233964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252339642       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905252341639       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905252341436       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905252341496       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905252341688       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905252341504       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905252341531       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905252341535       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.161840e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252339642       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905252340141       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905252340091       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905252340104       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905252340154       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905252340109       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905252340112       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905252340119       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.405325e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252339642       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905252339767       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905252339754       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905252339758       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905252339770       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905252339755       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905252339787       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905252339767       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.351377e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6438e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.093896e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116453e-02 1 1  ON 2
 uu_3                -2.105983e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495835e-01 1 1  ON 10
 ud_1                 1.832528e-01 1 1  ON 11
 ud_2                 6.186283e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193472e-01 1 1  ON 28
 eO_9                -7.815241e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588574e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791034e-03 1 1  ON 34
eH1_5                 4.058013e-02 1 1  ON 35
eH1_6                 9.791531e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895931e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213663e-02 1 1  ON 42
eH2_3                -3.793525e-02 1 1  ON 43
eH2_4                 9.853809e-03 1 1  ON 44
eH2_5                 4.294161e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638260e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.214707
====================================================
  Execution time = 2.0121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4754e-01
  Total weights = 2.0000e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494086159
                                         uncertainty =       0.009479732242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494086159
                                         uncertainty =       0.009479732242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416854571
  error estimate for blocks of size 2^( 2) =       0.000429137173
  error estimate for blocks of size 2^( 3) =       0.000442043212
  error estimate for blocks of size 2^( 4) =       0.000454390299
  error estimate for blocks of size 2^( 5) =       0.000464648214
  error estimate for blocks of size 2^( 6) =       0.000470642627
  error estimate for blocks of size 2^( 7) =       0.000474539823

      target function =                  N/A
              le_mean =     -16.906250136349
             les_mean =     286.168828966151
             stat err =       0.000466055241
             autocorr =       1.249987457524
              std dev =       0.589521388174
             le_variance =       0.347535467115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494180391
                                         uncertainty =       0.009479736190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494180391
                                         uncertainty =       0.009479736190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416854628
  error estimate for blocks of size 2^( 2) =       0.000429137225
  error estimate for blocks of size 2^( 3) =       0.000442043259
  error estimate for blocks of size 2^( 4) =       0.000454390342
  error estimate for blocks of size 2^( 5) =       0.000464648257
  error estimate for blocks of size 2^( 6) =       0.000470642672
  error estimate for blocks of size 2^( 7) =       0.000474539868

      target function =                  N/A
              le_mean =     -16.906250135849
             les_mean =     286.168829043378
             stat err =       0.000466055285
             autocorr =       1.249987355024
              std dev =       0.589521468017
             le_variance =       0.347535561253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494133289
                                         uncertainty =       0.009479734216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494133289
                                         uncertainty =       0.009479734216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416854599
  error estimate for blocks of size 2^( 2) =       0.000429137199
  error estimate for blocks of size 2^( 3) =       0.000442043235
  error estimate for blocks of size 2^( 4) =       0.000454390321
  error estimate for blocks of size 2^( 5) =       0.000464648235
  error estimate for blocks of size 2^( 6) =       0.000470642649
  error estimate for blocks of size 2^( 7) =       0.000474539846

      target function =                  N/A
              le_mean =     -16.906250136099
             les_mean =     286.168829004775
             stat err =       0.000466055263
             autocorr =       1.249987406274
              std dev =       0.589521428107
             le_variance =       0.347535514197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494092051
                                         uncertainty =       0.009479732488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347494092051
                                         uncertainty =       0.009479732488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416854575
  error estimate for blocks of size 2^( 2) =       0.000429137176
  error estimate for blocks of size 2^( 3) =       0.000442043215
  error estimate for blocks of size 2^( 4) =       0.000454390302
  error estimate for blocks of size 2^( 5) =       0.000464648217
  error estimate for blocks of size 2^( 6) =       0.000470642630
  error estimate for blocks of size 2^( 7) =       0.000474539826

      target function =                  N/A
              le_mean =     -16.906250136318
             les_mean =     286.168828970979
             stat err =       0.000466055244
             autocorr =       1.249987451118
              std dev =       0.589521393166
             le_variance =       0.347535473000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906250136349        initial  <--
     9.7656e+02     9.7656e+03             2.1618e-07       -16.906250135849
     3.9062e+03     3.9062e+04             5.4053e-08       -16.906250136099
     1.5625e+04     1.5625e+05             1.3514e-08       -16.906250136318

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6216
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8504
    reference variance = 0.618755
====================================================
  Execution time = 2.0363e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4428e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344263930844
                                         uncertainty =       0.006186187017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344263930844
                                         uncertainty =       0.006186187017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414895517
  error estimate for blocks of size 2^( 2) =       0.000427699986
  error estimate for blocks of size 2^( 3) =       0.000441921619
  error estimate for blocks of size 2^( 4) =       0.000454686445
  error estimate for blocks of size 2^( 5) =       0.000465730718
  error estimate for blocks of size 2^( 6) =       0.000475156288
  error estimate for blocks of size 2^( 7) =       0.000480923121

      target function =                  N/A
              le_mean =     -16.905690674674
             les_mean =     286.146653595349
             stat err =       0.000469124143
             autocorr =       1.278492204628
              std dev =       0.586750866822
             le_variance =       0.344276579716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569067467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690674674       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690674703       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690674728       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690674785       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690674773       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690674793       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690674785       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690674790       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.215499e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690674674       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690674682       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690674688       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690674702       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690674648       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690674686       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690674699       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690674701       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.538753e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690674674       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690674676       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690674678       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690674594       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690674639       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690674686       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690674619       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690674637       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.384688e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791019e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9678
    reference variance = 0.482003
====================================================
  Execution time = 1.9930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4789e-01
  Total weights = 2.0000e+06
  Execution time = 1.8943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936268607
                                         uncertainty =       0.007933898240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936268607
                                         uncertainty =       0.007933898240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417065028
  error estimate for blocks of size 2^( 2) =       0.000429840003
  error estimate for blocks of size 2^( 3) =       0.000442701724
  error estimate for blocks of size 2^( 4) =       0.000454391984
  error estimate for blocks of size 2^( 5) =       0.000464181940
  error estimate for blocks of size 2^( 6) =       0.000471119895
  error estimate for blocks of size 2^( 7) =       0.000476384752

      target function =                  N/A
              le_mean =     -16.906590827052
             les_mean =     286.180699694186
             stat err =       0.000466519643
             autocorr =       1.251216088444
              std dev =       0.589819018645
             le_variance =       0.347886474755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936275140
                                         uncertainty =       0.007933898469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936275140
                                         uncertainty =       0.007933898469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417065032
  error estimate for blocks of size 2^( 2) =       0.000429840007
  error estimate for blocks of size 2^( 3) =       0.000442701727
  error estimate for blocks of size 2^( 4) =       0.000454391988
  error estimate for blocks of size 2^( 5) =       0.000464181943
  error estimate for blocks of size 2^( 6) =       0.000471119898
  error estimate for blocks of size 2^( 7) =       0.000476384755

      target function =                  N/A
              le_mean =     -16.906590827019
             les_mean =     286.180699699577
             stat err =       0.000466519646
             autocorr =       1.251216081934
              std dev =       0.589819024184
             le_variance =       0.347886481290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936271873
                                         uncertainty =       0.007933898354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936271873
                                         uncertainty =       0.007933898354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417065030
  error estimate for blocks of size 2^( 2) =       0.000429840005
  error estimate for blocks of size 2^( 3) =       0.000442701726
  error estimate for blocks of size 2^( 4) =       0.000454391986
  error estimate for blocks of size 2^( 5) =       0.000464181941
  error estimate for blocks of size 2^( 6) =       0.000471119896
  error estimate for blocks of size 2^( 7) =       0.000476384754

      target function =                  N/A
              le_mean =     -16.906590827036
             les_mean =     286.180699696882
             stat err =       0.000466519644
             autocorr =       1.251216085185
              std dev =       0.589819021414
             le_variance =       0.347886478022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936269015
                                         uncertainty =       0.007933898254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347936269015
                                         uncertainty =       0.007933898254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417065028
  error estimate for blocks of size 2^( 2) =       0.000429840003
  error estimate for blocks of size 2^( 3) =       0.000442701724
  error estimate for blocks of size 2^( 4) =       0.000454391984
  error estimate for blocks of size 2^( 5) =       0.000464181940
  error estimate for blocks of size 2^( 6) =       0.000471119895
  error estimate for blocks of size 2^( 7) =       0.000476384753

      target function =                  N/A
              le_mean =     -16.906590827050
             les_mean =     286.180699694523
             stat err =       0.000466519643
             autocorr =       1.251216088041
              std dev =       0.589819018991
             le_variance =       0.347886475163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906590827052        initial  <--
     9.7656e+03     9.7656e+04             2.2155e-08       -16.906590827019
     3.9062e+04     3.9062e+05             5.5388e-09       -16.906590827036
     1.5625e+05     1.5625e+06             1.3847e-09       -16.906590827050

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4822
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9012
    reference variance = 0.57408
====================================================
  Execution time = 2.1520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337676961555
                                         uncertainty =       0.002920573462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337676961555
                                         uncertainty =       0.002920573462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410939059
  error estimate for blocks of size 2^( 2) =       0.000423770496
  error estimate for blocks of size 2^( 3) =       0.000436664663
  error estimate for blocks of size 2^( 4) =       0.000448365572
  error estimate for blocks of size 2^( 5) =       0.000459125255
  error estimate for blocks of size 2^( 6) =       0.000465505659
  error estimate for blocks of size 2^( 7) =       0.000470310382

      target function =                  N/A
              le_mean =     -16.905738518575
             les_mean =     286.141736509641
             stat err =       0.000460826717
             autocorr =       1.257536086146
              std dev =       0.581155590256
             le_variance =       0.337741820086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573851857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738518575       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738518587       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738518588       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738518585       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738518581       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738518558       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738518588       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905738518610       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.222633e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738518575       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738518578       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738518578       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738518573       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738518552       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738518648       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738518545       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905738518709       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 8.056587e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738518575       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738518576       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738518576       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738518088       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738518575       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738517966       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738528373       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905738519084       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.014135e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7432e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853839e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9601
    reference variance = 0.448728
====================================================
  Execution time = 2.0164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4254e-01
  Total weights = 2.0000e+06
  Execution time = 1.9005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145660
                                         uncertainty =       0.003484495637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145660
                                         uncertainty =       0.003484495637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413846864
  error estimate for blocks of size 2^( 2) =       0.000426682222
  error estimate for blocks of size 2^( 3) =       0.000439873162
  error estimate for blocks of size 2^( 4) =       0.000452087467
  error estimate for blocks of size 2^( 5) =       0.000463523287
  error estimate for blocks of size 2^( 6) =       0.000471744916
  error estimate for blocks of size 2^( 7) =       0.000480101654

      target function =                  N/A
              le_mean =     -16.905181197604
             les_mean =     286.127689605966
             stat err =       0.000466864331
             autocorr =       1.272629694405
              std dev =       0.585267847582
             le_variance =       0.342538453414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494146128
                                         uncertainty =       0.003484495644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494146128
                                         uncertainty =       0.003484495644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413846864
  error estimate for blocks of size 2^( 2) =       0.000426682222
  error estimate for blocks of size 2^( 3) =       0.000439873162
  error estimate for blocks of size 2^( 4) =       0.000452087468
  error estimate for blocks of size 2^( 5) =       0.000463523287
  error estimate for blocks of size 2^( 6) =       0.000471744916
  error estimate for blocks of size 2^( 7) =       0.000480101654

      target function =                  N/A
              le_mean =     -16.905181197593
             les_mean =     286.127689606060
             stat err =       0.000466864331
             autocorr =       1.272629694179
              std dev =       0.585267847981
             le_variance =       0.342538453880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145894
                                         uncertainty =       0.003484495641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145894
                                         uncertainty =       0.003484495641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413846864
  error estimate for blocks of size 2^( 2) =       0.000426682222
  error estimate for blocks of size 2^( 3) =       0.000439873162
  error estimate for blocks of size 2^( 4) =       0.000452087467
  error estimate for blocks of size 2^( 5) =       0.000463523287
  error estimate for blocks of size 2^( 6) =       0.000471744916
  error estimate for blocks of size 2^( 7) =       0.000480101654

      target function =                  N/A
              le_mean =     -16.905181197598
             les_mean =     286.127689606013
             stat err =       0.000466864331
             autocorr =       1.272629694292
              std dev =       0.585267847782
             le_variance =       0.342538453647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145689
                                         uncertainty =       0.003484495638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342494145689
                                         uncertainty =       0.003484495638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413846864
  error estimate for blocks of size 2^( 2) =       0.000426682222
  error estimate for blocks of size 2^( 3) =       0.000439873162
  error estimate for blocks of size 2^( 4) =       0.000452087467
  error estimate for blocks of size 2^( 5) =       0.000463523287
  error estimate for blocks of size 2^( 6) =       0.000471744916
  error estimate for blocks of size 2^( 7) =       0.000480101654

      target function =                  N/A
              le_mean =     -16.905181197603
             les_mean =     286.127689605972
             stat err =       0.000466864331
             autocorr =       1.272629694397
              std dev =       0.585267847607
             le_variance =       0.342538453443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905181197604        initial  <--
     9.7656e+04     9.7656e+05             3.2226e-09       -16.905181197593
     3.9062e+05     3.9062e+06             8.0566e-10       -16.905181197598
     1.5625e+06     1.5625e+07             2.0141e-10       -16.905181197603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7482
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8532
    reference variance = 0.367047
====================================================
  Execution time = 2.0916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4969e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810450939
                                         uncertainty =       0.010033486528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349810450939
                                         uncertainty =       0.010033486528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418143380
  error estimate for blocks of size 2^( 2) =       0.000430789465
  error estimate for blocks of size 2^( 3) =       0.000443234793
  error estimate for blocks of size 2^( 4) =       0.000454146180
  error estimate for blocks of size 2^( 5) =       0.000464203483
  error estimate for blocks of size 2^( 6) =       0.000470419133
  error estimate for blocks of size 2^( 7) =       0.000475777693

      target function =                  N/A
              le_mean =     -16.905773428531
             les_mean =     286.154862815006
             stat err =       0.000466136622
             autocorr =       1.242727754928
              std dev =       0.591344039482
             le_variance =       0.349687773031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577342853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773428531       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773428531       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773428532       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773428533       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773428562       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773428528       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773428760       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773428960       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.413315e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773428531       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773428531       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773428531       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773428918       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773430632       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773427788       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773428824       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773429168       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.033278e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773428531       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773428531       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773428531       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773428531       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773428531       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773434380       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773433957       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773439953       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.508281e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.198063
====================================================
  Execution time = 2.0626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3347e-01
  Total weights = 2.0000e+06
  Execution time = 1.8942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216497
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216497
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408332971
  error estimate for blocks of size 2^( 2) =       0.000421125162
  error estimate for blocks of size 2^( 3) =       0.000434582361
  error estimate for blocks of size 2^( 4) =       0.000446931586
  error estimate for blocks of size 2^( 5) =       0.000458302960
  error estimate for blocks of size 2^( 6) =       0.000466210765
  error estimate for blocks of size 2^( 7) =       0.000472502846

      target function =                  N/A
              le_mean =     -16.905475347851
             les_mean =     286.128568200109
             stat err =       0.000460987039
             autocorr =       1.274525512906
              std dev =       0.577470025235
             le_variance =       0.333471630044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216377
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216377
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408332971
  error estimate for blocks of size 2^( 2) =       0.000421125162
  error estimate for blocks of size 2^( 3) =       0.000434582361
  error estimate for blocks of size 2^( 4) =       0.000446931586
  error estimate for blocks of size 2^( 5) =       0.000458302960
  error estimate for blocks of size 2^( 6) =       0.000466210765
  error estimate for blocks of size 2^( 7) =       0.000472502846

      target function =                  N/A
              le_mean =     -16.905475347851
             les_mean =     286.128568199997
             stat err =       0.000460987039
             autocorr =       1.274525513014
              std dev =       0.577470025131
             le_variance =       0.333471629924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216437
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216437
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408332971
  error estimate for blocks of size 2^( 2) =       0.000421125162
  error estimate for blocks of size 2^( 3) =       0.000434582361
  error estimate for blocks of size 2^( 4) =       0.000446931586
  error estimate for blocks of size 2^( 5) =       0.000458302960
  error estimate for blocks of size 2^( 6) =       0.000466210765
  error estimate for blocks of size 2^( 7) =       0.000472502846

      target function =                  N/A
              le_mean =     -16.905475347851
             les_mean =     286.128568200053
             stat err =       0.000460987039
             autocorr =       1.274525512954
              std dev =       0.577470025183
             le_variance =       0.333471629984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216489
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333433216489
                                         uncertainty =       0.002562299844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408332971
  error estimate for blocks of size 2^( 2) =       0.000421125162
  error estimate for blocks of size 2^( 3) =       0.000434582361
  error estimate for blocks of size 2^( 4) =       0.000446931586
  error estimate for blocks of size 2^( 5) =       0.000458302960
  error estimate for blocks of size 2^( 6) =       0.000466210765
  error estimate for blocks of size 2^( 7) =       0.000472502846

      target function =                  N/A
              le_mean =     -16.905475347851
             les_mean =     286.128568200102
             stat err =       0.000460987039
             autocorr =       1.274525512920
              std dev =       0.577470025228
             le_variance =       0.333471630037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905475347851        initial
     9.7656e+05     9.7656e+06             2.4133e-10       -16.905475347851  <--
     3.9062e+06     3.9062e+07             6.0333e-11       -16.905475347851
     1.5625e+07     1.5625e+08             1.5083e-11       -16.905475347851

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 3.0181e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8886
    reference variance = 0.229885
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020014214
                                         uncertainty =       0.004934733576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343020014214
                                         uncertainty =       0.004934733576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414132475
  error estimate for blocks of size 2^( 2) =       0.000426938727
  error estimate for blocks of size 2^( 3) =       0.000439819026
  error estimate for blocks of size 2^( 4) =       0.000452118858
  error estimate for blocks of size 2^( 5) =       0.000462993517
  error estimate for blocks of size 2^( 6) =       0.000473720656
  error estimate for blocks of size 2^( 7) =       0.000480170448

      target function =                  N/A
              le_mean =     -16.906187640679
             les_mean =     286.162191783940
             stat err =       0.000467250870
             autocorr =       1.272980237144
              std dev =       0.585671762682
             le_variance =       0.343011413603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618764068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187640679       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187640681       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187640682       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187640737       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187640682       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187640640       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187640557       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187640867       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 8.589687e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187640679       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187640679       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187640680       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187640838       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187640680       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187640680       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187640495       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187640749       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.147422e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187640679       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187640679       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187640679       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187640679       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187640947       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187640708       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187637429       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187643182       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 5.368566e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6302e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9671
    reference variance = 0.193305
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4188e-01
  Total weights = 2.0000e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852392924
                                         uncertainty =       0.004139213152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852392924
                                         uncertainty =       0.004139213152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413446751
  error estimate for blocks of size 2^( 2) =       0.000426449964
  error estimate for blocks of size 2^( 3) =       0.000439388259
  error estimate for blocks of size 2^( 4) =       0.000452099499
  error estimate for blocks of size 2^( 5) =       0.000462050170
  error estimate for blocks of size 2^( 6) =       0.000469119217
  error estimate for blocks of size 2^( 7) =       0.000475803679

      target function =                  N/A
              le_mean =     -16.905303134366
             les_mean =     286.131150325641
             stat err =       0.000464768141
             autocorr =       1.263669590779
              std dev =       0.584702002554
             le_variance =       0.341876431791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852393158
                                         uncertainty =       0.004139213157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852393158
                                         uncertainty =       0.004139213157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413446751
  error estimate for blocks of size 2^( 2) =       0.000426449964
  error estimate for blocks of size 2^( 3) =       0.000439388260
  error estimate for blocks of size 2^( 4) =       0.000452099499
  error estimate for blocks of size 2^( 5) =       0.000462050170
  error estimate for blocks of size 2^( 6) =       0.000469119217
  error estimate for blocks of size 2^( 7) =       0.000475803680

      target function =                  N/A
              le_mean =     -16.905303134369
             les_mean =     286.131150325982
             stat err =       0.000464768142
             autocorr =       1.263669590669
              std dev =       0.584702002754
             le_variance =       0.341876432025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852393041
                                         uncertainty =       0.004139213155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852393041
                                         uncertainty =       0.004139213155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413446751
  error estimate for blocks of size 2^( 2) =       0.000426449964
  error estimate for blocks of size 2^( 3) =       0.000439388259
  error estimate for blocks of size 2^( 4) =       0.000452099499
  error estimate for blocks of size 2^( 5) =       0.000462050170
  error estimate for blocks of size 2^( 6) =       0.000469119217
  error estimate for blocks of size 2^( 7) =       0.000475803680

      target function =                  N/A
              le_mean =     -16.905303134367
             les_mean =     286.131150325811
             stat err =       0.000464768142
             autocorr =       1.263669590724
              std dev =       0.584702002654
             le_variance =       0.341876431908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852392938
                                         uncertainty =       0.004139213152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341852392938
                                         uncertainty =       0.004139213152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413446751
  error estimate for blocks of size 2^( 2) =       0.000426449964
  error estimate for blocks of size 2^( 3) =       0.000439388259
  error estimate for blocks of size 2^( 4) =       0.000452099499
  error estimate for blocks of size 2^( 5) =       0.000462050170
  error estimate for blocks of size 2^( 6) =       0.000469119217
  error estimate for blocks of size 2^( 7) =       0.000475803679

      target function =                  N/A
              le_mean =     -16.905303134366
             les_mean =     286.131150325662
             stat err =       0.000464768141
             autocorr =       1.263669590774
              std dev =       0.584702002567
             le_variance =       0.341876431806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905303134366        initial
     2.4414e+05     2.4414e+06             8.5897e-10       -16.905303134369  <--
     9.7656e+05     9.7656e+06             2.1474e-10       -16.905303134367
     3.9062e+06     3.9062e+07             5.3686e-11       -16.905303134366

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 3.0169e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013321e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192950e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793523e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879543e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.825
    reference variance = 0.376169
====================================================
  Execution time = 2.1091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5290e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352936458731
                                         uncertainty =       0.007257204162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352936458731
                                         uncertainty =       0.007257204162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420060613
  error estimate for blocks of size 2^( 2) =       0.000432290910
  error estimate for blocks of size 2^( 3) =       0.000444616393
  error estimate for blocks of size 2^( 4) =       0.000457873336
  error estimate for blocks of size 2^( 5) =       0.000468347941
  error estimate for blocks of size 2^( 6) =       0.000476386503
  error estimate for blocks of size 2^( 7) =       0.000481465073

      target function =                  N/A
              le_mean =     -16.906439123444
             les_mean =     286.180585495848
             stat err =       0.000471018213
             autocorr =       1.257336366950
              std dev =       0.594055416249
             le_variance =       0.352901837575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643912344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439123444       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439123461       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439123461       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439123459       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439123453       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439123479       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439123469       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439123473       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.781445e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439123444       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439123448       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439123448       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439123579       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439123451       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439123467       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439123478       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439123447       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.453616e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439123444       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439123445       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439123445       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439123445       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439123889       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439123574       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439123904       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439123196       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.363404e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6666e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737556e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853839e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9012
    reference variance = 0.150334
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5127e-01
  Total weights = 2.0000e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485840
                                         uncertainty =       0.008226814048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485840
                                         uncertainty =       0.008226814048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419085736
  error estimate for blocks of size 2^( 2) =       0.000431752122
  error estimate for blocks of size 2^( 3) =       0.000444333487
  error estimate for blocks of size 2^( 4) =       0.000456250304
  error estimate for blocks of size 2^( 5) =       0.000467399720
  error estimate for blocks of size 2^( 6) =       0.000475792567
  error estimate for blocks of size 2^( 7) =       0.000479756584

      target function =                  N/A
              le_mean =     -16.905856421485
             les_mean =     286.159246876944
             stat err =       0.000469799794
             autocorr =       1.256666054542
              std dev =       0.592676732036
             le_variance =       0.351265708697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362484398
                                         uncertainty =       0.008226814018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362484398
                                         uncertainty =       0.008226814018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419085735
  error estimate for blocks of size 2^( 2) =       0.000431752121
  error estimate for blocks of size 2^( 3) =       0.000444333486
  error estimate for blocks of size 2^( 4) =       0.000456250304
  error estimate for blocks of size 2^( 5) =       0.000467399719
  error estimate for blocks of size 2^( 6) =       0.000475792566
  error estimate for blocks of size 2^( 7) =       0.000479756583

      target function =                  N/A
              le_mean =     -16.905856421504
             les_mean =     286.159246876147
             stat err =       0.000469799793
             autocorr =       1.256666055868
              std dev =       0.592676730822
             le_variance =       0.351265707258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485119
                                         uncertainty =       0.008226814033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485119
                                         uncertainty =       0.008226814033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419085736
  error estimate for blocks of size 2^( 2) =       0.000431752122
  error estimate for blocks of size 2^( 3) =       0.000444333486
  error estimate for blocks of size 2^( 4) =       0.000456250304
  error estimate for blocks of size 2^( 5) =       0.000467399719
  error estimate for blocks of size 2^( 6) =       0.000475792566
  error estimate for blocks of size 2^( 7) =       0.000479756584

      target function =                  N/A
              le_mean =     -16.905856421495
             les_mean =     286.159246876545
             stat err =       0.000469799793
             autocorr =       1.256666055196
              std dev =       0.592676731429
             le_variance =       0.351265707978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485750
                                         uncertainty =       0.008226814046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351362485750
                                         uncertainty =       0.008226814046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419085736
  error estimate for blocks of size 2^( 2) =       0.000431752122
  error estimate for blocks of size 2^( 3) =       0.000444333487
  error estimate for blocks of size 2^( 4) =       0.000456250304
  error estimate for blocks of size 2^( 5) =       0.000467399720
  error estimate for blocks of size 2^( 6) =       0.000475792567
  error estimate for blocks of size 2^( 7) =       0.000479756584

      target function =                  N/A
              le_mean =     -16.905856421487
             les_mean =     286.159246876894
             stat err =       0.000469799794
             autocorr =       1.256666054619
              std dev =       0.592676731960
             le_variance =       0.351265708607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905856421485        initial
     6.1035e+04     6.1035e+05             3.7814e-09       -16.905856421504  <--
     2.4414e+05     2.4414e+06             9.4536e-10       -16.905856421495
     9.7656e+05     9.7656e+06             2.3634e-10       -16.905856421487

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 2.9936e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987700e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853839e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8734
    reference variance = 0.228387
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996217189
                                         uncertainty =       0.005586517823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996217189
                                         uncertainty =       0.005586517823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415287547
  error estimate for blocks of size 2^( 2) =       0.000427780280
  error estimate for blocks of size 2^( 3) =       0.000441171460
  error estimate for blocks of size 2^( 4) =       0.000453849321
  error estimate for blocks of size 2^( 5) =       0.000463277780
  error estimate for blocks of size 2^( 6) =       0.000472784047
  error estimate for blocks of size 2^( 7) =       0.000478542161

      target function =                  N/A
              le_mean =     -16.905618351362
             les_mean =     286.144859163027
             stat err =       0.000467113328
             autocorr =       1.265163635272
              std dev =       0.587305281432
             le_variance =       0.344927493598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561835136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905618351362       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905618351376       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905618351422       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618351456       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905618351411       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618351420       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905618351432       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618351418       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.551830e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905618351362       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905618351365       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905618351377       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618351399       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905618351371       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618351357       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905618351359       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618351401       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.879584e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905618351362       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905618351362       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905618351365       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618351317       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905618351366       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618351365       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905618351489       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618350158       residual = 8.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.698963e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6150e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987701e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791018e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853840e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.247552
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3952e-01
  Total weights = 2.0000e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574585802
                                         uncertainty =       0.005372922047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574585802
                                         uncertainty =       0.005372922047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412017039
  error estimate for blocks of size 2^( 2) =       0.000425405839
  error estimate for blocks of size 2^( 3) =       0.000439166777
  error estimate for blocks of size 2^( 4) =       0.000451577818
  error estimate for blocks of size 2^( 5) =       0.000463327966
  error estimate for blocks of size 2^( 6) =       0.000471837256
  error estimate for blocks of size 2^( 7) =       0.000474621280

      target function =                  N/A
              le_mean =     -16.905347893397
             les_mean =     286.130303307800
             stat err =       0.000465341080
             autocorr =       1.275593900310
              std dev =       0.582680084426
             le_variance =       0.339516080786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574591839
                                         uncertainty =       0.005372922171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574591839
                                         uncertainty =       0.005372922171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412017043
  error estimate for blocks of size 2^( 2) =       0.000425405842
  error estimate for blocks of size 2^( 3) =       0.000439166780
  error estimate for blocks of size 2^( 4) =       0.000451577821
  error estimate for blocks of size 2^( 5) =       0.000463327969
  error estimate for blocks of size 2^( 6) =       0.000471837259
  error estimate for blocks of size 2^( 7) =       0.000474621283

      target function =                  N/A
              le_mean =     -16.905347893391
             les_mean =     286.130303313654
             stat err =       0.000465341083
             autocorr =       1.275593893948
              std dev =       0.582680089605
             le_variance =       0.339516086822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574588820
                                         uncertainty =       0.005372922109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574588820
                                         uncertainty =       0.005372922109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412017041
  error estimate for blocks of size 2^( 2) =       0.000425405840
  error estimate for blocks of size 2^( 3) =       0.000439166778
  error estimate for blocks of size 2^( 4) =       0.000451577819
  error estimate for blocks of size 2^( 5) =       0.000463327968
  error estimate for blocks of size 2^( 6) =       0.000471837258
  error estimate for blocks of size 2^( 7) =       0.000474621282

      target function =                  N/A
              le_mean =     -16.905347893394
             les_mean =     286.130303310727
             stat err =       0.000465341082
             autocorr =       1.275593897126
              std dev =       0.582680087015
             le_variance =       0.339516083804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574586179
                                         uncertainty =       0.005372922055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339574586179
                                         uncertainty =       0.005372922055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412017039
  error estimate for blocks of size 2^( 2) =       0.000425405839
  error estimate for blocks of size 2^( 3) =       0.000439166777
  error estimate for blocks of size 2^( 4) =       0.000451577818
  error estimate for blocks of size 2^( 5) =       0.000463327966
  error estimate for blocks of size 2^( 6) =       0.000471837257
  error estimate for blocks of size 2^( 7) =       0.000474621280

      target function =                  N/A
              le_mean =     -16.905347893396
             les_mean =     286.130303308166
             stat err =       0.000465341080
             autocorr =       1.275593899914
              std dev =       0.582680084749
             le_variance =       0.339516081163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905347893397        initial  <--
     1.5259e+04     1.5259e+05             1.5518e-08       -16.905347893391
     6.1035e+04     6.1035e+05             3.8796e-09       -16.905347893394
     2.4414e+05     2.4414e+06             9.6990e-10       -16.905347893396

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9391
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987700e-03 1 1  ON 13
 ud_4                -6.697309e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853839e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8805
    reference variance = 0.20508
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334323384083
                                         uncertainty =       0.002625821400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334323384083
                                         uncertainty =       0.002625821400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868204
  error estimate for blocks of size 2^( 2) =       0.000421503804
  error estimate for blocks of size 2^( 3) =       0.000434460053
  error estimate for blocks of size 2^( 4) =       0.000445753741
  error estimate for blocks of size 2^( 5) =       0.000455877885
  error estimate for blocks of size 2^( 6) =       0.000462406305
  error estimate for blocks of size 2^( 7) =       0.000466571733

      target function =                  N/A
              le_mean =     -16.906286342235
             les_mean =     286.156864135410
             stat err =       0.000457652416
             autocorr =       1.252866626464
              std dev =       0.578226959713
             le_variance =       0.334346416939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628634224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286342235       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286342238       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286342238       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286342245       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286342241       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286342131       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286342364       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286342237       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.413381e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286342235       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286342236       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286342236       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286342236       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286342235       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286341922       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286342114       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286342142       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.533452e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286342235       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286342235       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286342235       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286342235       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286339915       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286342610       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286343764       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286341656       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 8.833626e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6509e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987700e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853839e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8574
    reference variance = 0.516426
====================================================
  Execution time = 2.2763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4296e-01
  Total weights = 2.0000e+06
  Execution time = 1.9076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862305021
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862305021
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414099662
  error estimate for blocks of size 2^( 2) =       0.000426404507
  error estimate for blocks of size 2^( 3) =       0.000438467155
  error estimate for blocks of size 2^( 4) =       0.000450576637
  error estimate for blocks of size 2^( 5) =       0.000460669392
  error estimate for blocks of size 2^( 6) =       0.000468934117
  error estimate for blocks of size 2^( 7) =       0.000473623064

      target function =                  N/A
              le_mean =     -16.906358775186
             les_mean =     286.167923924453
             stat err =       0.000463450803
             autocorr =       1.252557075345
              std dev =       0.585625358584
             le_variance =       0.342957060616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862304898
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862304898
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414099662
  error estimate for blocks of size 2^( 2) =       0.000426404507
  error estimate for blocks of size 2^( 3) =       0.000438467155
  error estimate for blocks of size 2^( 4) =       0.000450576637
  error estimate for blocks of size 2^( 5) =       0.000460669392
  error estimate for blocks of size 2^( 6) =       0.000468934117
  error estimate for blocks of size 2^( 7) =       0.000473623064

      target function =                  N/A
              le_mean =     -16.906358775200
             les_mean =     286.167923924795
             stat err =       0.000463450802
             autocorr =       1.252557075302
              std dev =       0.585625358478
             le_variance =       0.342957060493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862304960
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862304960
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414099662
  error estimate for blocks of size 2^( 2) =       0.000426404507
  error estimate for blocks of size 2^( 3) =       0.000438467155
  error estimate for blocks of size 2^( 4) =       0.000450576637
  error estimate for blocks of size 2^( 5) =       0.000460669392
  error estimate for blocks of size 2^( 6) =       0.000468934117
  error estimate for blocks of size 2^( 7) =       0.000473623064

      target function =                  N/A
              le_mean =     -16.906358775193
             les_mean =     286.167923924624
             stat err =       0.000463450803
             autocorr =       1.252557075323
              std dev =       0.585625358531
             le_variance =       0.342957060555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862305013
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342862305013
                                         uncertainty =       0.003680501417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414099662
  error estimate for blocks of size 2^( 2) =       0.000426404507
  error estimate for blocks of size 2^( 3) =       0.000438467155
  error estimate for blocks of size 2^( 4) =       0.000450576637
  error estimate for blocks of size 2^( 5) =       0.000460669392
  error estimate for blocks of size 2^( 6) =       0.000468934117
  error estimate for blocks of size 2^( 7) =       0.000473623064

      target function =                  N/A
              le_mean =     -16.906358775187
             les_mean =     286.167923924474
             stat err =       0.000463450803
             autocorr =       1.252557075343
              std dev =       0.585625358577
             le_variance =       0.342957060609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906358775186        initial
     1.5259e+05     1.5259e+06             1.4134e-09       -16.906358775200  <--
     6.1035e+05     6.1035e+06             3.5335e-10       -16.906358775193
     2.4414e+06     2.4414e+07             8.8336e-11       -16.906358775187

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 3.2370e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987699e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791019e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9173
    reference variance = 0.253052
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336271493886
                                         uncertainty =       0.003706412315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336271493886
                                         uncertainty =       0.003706412315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127844
  error estimate for blocks of size 2^( 2) =       0.000422677579
  error estimate for blocks of size 2^( 3) =       0.000435628596
  error estimate for blocks of size 2^( 4) =       0.000447637266
  error estimate for blocks of size 2^( 5) =       0.000458556452
  error estimate for blocks of size 2^( 6) =       0.000465850721
  error estimate for blocks of size 2^( 7) =       0.000470234224

      target function =                  N/A
              le_mean =     -16.905897366042
             les_mean =     286.145775279774
             stat err =       0.000460569666
             autocorr =       1.261107626838
              std dev =       0.580008359266
             le_variance =       0.336409696819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589736604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905897366042       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905897366041       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905897366045       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905897366055       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905897366054       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905897366047       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897366055       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905897365935       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.828921e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905897366042       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905897366042       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905897366043       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905897366044       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905897366093       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905897366033       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897365857       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905897366183       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.707230e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905897366042       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905897366042       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905897366043       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905897366043       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905897366043       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905897366179       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897365886       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905897365901       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.268077e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.426170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6097e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594209e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987699e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815237e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791020e-03 1 1  ON 34
eH1_5                 4.058012e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.172109
====================================================
  Execution time = 2.0282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4954e-01
  Total weights = 2.0000e+06
  Execution time = 1.8982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467232809
                                         uncertainty =       0.006648267761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467232809
                                         uncertainty =       0.006648267761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418057266
  error estimate for blocks of size 2^( 2) =       0.000430468433
  error estimate for blocks of size 2^( 3) =       0.000443344650
  error estimate for blocks of size 2^( 4) =       0.000455550042
  error estimate for blocks of size 2^( 5) =       0.000466833504
  error estimate for blocks of size 2^( 6) =       0.000474973921
  error estimate for blocks of size 2^( 7) =       0.000481953804

      target function =                  N/A
              le_mean =     -16.906091773328
             les_mean =     286.165482628874
             stat err =       0.000469827818
             autocorr =       1.263007419723
              std dev =       0.591222255550
             le_variance =       0.349543755458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467236431
                                         uncertainty =       0.006648267929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467236431
                                         uncertainty =       0.006648267929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418057268
  error estimate for blocks of size 2^( 2) =       0.000430468435
  error estimate for blocks of size 2^( 3) =       0.000443344652
  error estimate for blocks of size 2^( 4) =       0.000455550044
  error estimate for blocks of size 2^( 5) =       0.000466833506
  error estimate for blocks of size 2^( 6) =       0.000474973923
  error estimate for blocks of size 2^( 7) =       0.000481953806

      target function =                  N/A
              le_mean =     -16.906091773329
             les_mean =     286.165482632518
             stat err =       0.000469827819
             autocorr =       1.263007415831
              std dev =       0.591222258616
             le_variance =       0.349543759083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467234620
                                         uncertainty =       0.006648267845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467234620
                                         uncertainty =       0.006648267845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418057267
  error estimate for blocks of size 2^( 2) =       0.000430468434
  error estimate for blocks of size 2^( 3) =       0.000443344651
  error estimate for blocks of size 2^( 4) =       0.000455550043
  error estimate for blocks of size 2^( 5) =       0.000466833505
  error estimate for blocks of size 2^( 6) =       0.000474973922
  error estimate for blocks of size 2^( 7) =       0.000481953805

      target function =                  N/A
              le_mean =     -16.906091773328
             les_mean =     286.165482630696
             stat err =       0.000469827819
             autocorr =       1.263007417770
              std dev =       0.591222257083
             le_variance =       0.349543757270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467233035
                                         uncertainty =       0.006648267772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349467233035
                                         uncertainty =       0.006648267772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418057266
  error estimate for blocks of size 2^( 2) =       0.000430468433
  error estimate for blocks of size 2^( 3) =       0.000443344651
  error estimate for blocks of size 2^( 4) =       0.000455550042
  error estimate for blocks of size 2^( 5) =       0.000466833504
  error estimate for blocks of size 2^( 6) =       0.000474973921
  error estimate for blocks of size 2^( 7) =       0.000481953804

      target function =                  N/A
              le_mean =     -16.906091773328
             les_mean =     286.165482629102
             stat err =       0.000469827818
             autocorr =       1.263007419475
              std dev =       0.591222255742
             le_variance =       0.349543755684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906091773328        initial
     3.8147e+04     3.8147e+05             6.8289e-09       -16.906091773329  <--
     1.5259e+05     1.5259e+06             1.7072e-09       -16.906091773328
     6.1035e+05     6.1035e+06             4.2681e-10       -16.906091773328

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9858e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.239488
====================================================
  Execution time = 2.0630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3957e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339423417404
                                         uncertainty =       0.003632194539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339423417404
                                         uncertainty =       0.003632194539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412050005
  error estimate for blocks of size 2^( 2) =       0.000424974552
  error estimate for blocks of size 2^( 3) =       0.000437785350
  error estimate for blocks of size 2^( 4) =       0.000449128018
  error estimate for blocks of size 2^( 5) =       0.000459938324
  error estimate for blocks of size 2^( 6) =       0.000466695843
  error estimate for blocks of size 2^( 7) =       0.000471073568

      target function =                  N/A
              le_mean =     -16.905647863745
             les_mean =     286.140499935976
             stat err =       0.000461708938
             autocorr =       1.255557820350
              std dev =       0.582726705070
             le_variance =       0.339570412802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564786375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647863745       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647863774       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647863769       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647863696       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905647863695       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905647863659       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905647863711       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.083499e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647863745       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647863752       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647863751       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647863733       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905647863742       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905647863732       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905647863762       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.208766e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647863745       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647863747       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647863747       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647863742       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905647863833       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905647863712       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905647863912       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.302193e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6159e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987697e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853837e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.269761
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4552e-01
  Total weights = 2.0000e+06
  Execution time = 1.8964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476915
                                         uncertainty =       0.007022366458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476915
                                         uncertainty =       0.007022366458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415644220
  error estimate for blocks of size 2^( 2) =       0.000428613998
  error estimate for blocks of size 2^( 3) =       0.000441570358
  error estimate for blocks of size 2^( 4) =       0.000454291587
  error estimate for blocks of size 2^( 5) =       0.000465842412
  error estimate for blocks of size 2^( 6) =       0.000472722173
  error estimate for blocks of size 2^( 7) =       0.000476350356

      target function =                  N/A
              le_mean =     -16.905524208025
             les_mean =     286.142268810257
             stat err =       0.000467301632
             autocorr =       1.264011732616
              std dev =       0.587809692770
             le_variance =       0.345520234914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462475367
                                         uncertainty =       0.007022366280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462475367
                                         uncertainty =       0.007022366280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415644219
  error estimate for blocks of size 2^( 2) =       0.000428613997
  error estimate for blocks of size 2^( 3) =       0.000441570357
  error estimate for blocks of size 2^( 4) =       0.000454291586
  error estimate for blocks of size 2^( 5) =       0.000465842411
  error estimate for blocks of size 2^( 6) =       0.000472722173
  error estimate for blocks of size 2^( 7) =       0.000476350356

      target function =                  N/A
              le_mean =     -16.905524207969
             les_mean =     286.142268806819
             stat err =       0.000467301632
             autocorr =       1.264011735681
              std dev =       0.587809691449
             le_variance =       0.345520233361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476141
                                         uncertainty =       0.007022366369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476141
                                         uncertainty =       0.007022366369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415644219
  error estimate for blocks of size 2^( 2) =       0.000428613997
  error estimate for blocks of size 2^( 3) =       0.000441570357
  error estimate for blocks of size 2^( 4) =       0.000454291587
  error estimate for blocks of size 2^( 5) =       0.000465842412
  error estimate for blocks of size 2^( 6) =       0.000472722173
  error estimate for blocks of size 2^( 7) =       0.000476350356

      target function =                  N/A
              le_mean =     -16.905524207997
             les_mean =     286.142268808538
             stat err =       0.000467301632
             autocorr =       1.264011734143
              std dev =       0.587809692109
             le_variance =       0.345520234138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476819
                                         uncertainty =       0.007022366447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345462476819
                                         uncertainty =       0.007022366447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415644220
  error estimate for blocks of size 2^( 2) =       0.000428613998
  error estimate for blocks of size 2^( 3) =       0.000441570358
  error estimate for blocks of size 2^( 4) =       0.000454291587
  error estimate for blocks of size 2^( 5) =       0.000465842412
  error estimate for blocks of size 2^( 6) =       0.000472722173
  error estimate for blocks of size 2^( 7) =       0.000476350356

      target function =                  N/A
              le_mean =     -16.905524208021
             les_mean =     286.142268810042
             stat err =       0.000467301632
             autocorr =       1.264011732804
              std dev =       0.587809692687
             le_variance =       0.345520234817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905524208025        initial  <--
     9.5367e+03     9.5367e+04             2.0835e-08       -16.905524207969
     3.8147e+04     3.8147e+05             5.2088e-09       -16.905524207997
     1.5259e+05     1.5259e+06             1.3022e-09       -16.905524208021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0753
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8489
    reference variance = 0.245477
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338515774839
                                         uncertainty =       0.004505485484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338515774839
                                         uncertainty =       0.004505485484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411376192
  error estimate for blocks of size 2^( 2) =       0.000424393012
  error estimate for blocks of size 2^( 3) =       0.000437459493
  error estimate for blocks of size 2^( 4) =       0.000449359286
  error estimate for blocks of size 2^( 5) =       0.000459448804
  error estimate for blocks of size 2^( 6) =       0.000466947908
  error estimate for blocks of size 2^( 7) =       0.000472788872

      target function =                  N/A
              le_mean =     -16.905703692431
             les_mean =     286.141277910439
             stat err =       0.000462136217
             autocorr =       1.262006821392
              std dev =       0.581773790577
             le_variance =       0.338460743402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570369243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905703692431       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905703692430       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905703692426       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905703692427       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905703692434       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905703692403       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905703692432       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905703692390       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 1.913582e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905703692431       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905703692431       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905703692430       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905703692430       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905703692430       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905703692325       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905703692481       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905703694598       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 4.783962e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905703692431       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905703692431       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905703692430       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905703692668       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905703692431       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905703692431       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905703692745       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905703692168       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.195989e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6212e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791021e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853837e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8851
    reference variance = 0.29091
====================================================
  Execution time = 2.0495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4231e-01
  Total weights = 2.0000e+06
  Execution time = 1.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104299
                                         uncertainty =       0.005210434088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104299
                                         uncertainty =       0.005210434088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413707058
  error estimate for blocks of size 2^( 2) =       0.000426496833
  error estimate for blocks of size 2^( 3) =       0.000439904271
  error estimate for blocks of size 2^( 4) =       0.000452170877
  error estimate for blocks of size 2^( 5) =       0.000463203610
  error estimate for blocks of size 2^( 6) =       0.000470435313
  error estimate for blocks of size 2^( 7) =       0.000473730219

      target function =                  N/A
              le_mean =     -16.905092889240
             les_mean =     286.124472482991
             stat err =       0.000464885005
             autocorr =       1.262714636884
              std dev =       0.585070132818
             le_variance =       0.342307060316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104078
                                         uncertainty =       0.005210434097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104078
                                         uncertainty =       0.005210434097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413707058
  error estimate for blocks of size 2^( 2) =       0.000426496833
  error estimate for blocks of size 2^( 3) =       0.000439904271
  error estimate for blocks of size 2^( 4) =       0.000452170877
  error estimate for blocks of size 2^( 5) =       0.000463203610
  error estimate for blocks of size 2^( 6) =       0.000470435312
  error estimate for blocks of size 2^( 7) =       0.000473730219

      target function =                  N/A
              le_mean =     -16.905092889234
             les_mean =     286.124472482565
             stat err =       0.000464885005
             autocorr =       1.262714636862
              std dev =       0.585070132630
             le_variance =       0.342307060095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104188
                                         uncertainty =       0.005210434092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104188
                                         uncertainty =       0.005210434092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413707058
  error estimate for blocks of size 2^( 2) =       0.000426496833
  error estimate for blocks of size 2^( 3) =       0.000439904271
  error estimate for blocks of size 2^( 4) =       0.000452170877
  error estimate for blocks of size 2^( 5) =       0.000463203610
  error estimate for blocks of size 2^( 6) =       0.000470435313
  error estimate for blocks of size 2^( 7) =       0.000473730219

      target function =                  N/A
              le_mean =     -16.905092889237
             les_mean =     286.124472482778
             stat err =       0.000464885005
             autocorr =       1.262714636869
              std dev =       0.585070132724
             le_variance =       0.342307060206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104285
                                         uncertainty =       0.005210434089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235104285
                                         uncertainty =       0.005210434089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413707058
  error estimate for blocks of size 2^( 2) =       0.000426496833
  error estimate for blocks of size 2^( 3) =       0.000439904271
  error estimate for blocks of size 2^( 4) =       0.000452170877
  error estimate for blocks of size 2^( 5) =       0.000463203610
  error estimate for blocks of size 2^( 6) =       0.000470435313
  error estimate for blocks of size 2^( 7) =       0.000473730219

      target function =                  N/A
              le_mean =     -16.905092889239
             les_mean =     286.124472482964
             stat err =       0.000464885005
             autocorr =       1.262714636884
              std dev =       0.585070132807
             le_variance =       0.342307060302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905092889240        initial  <--
     9.5367e+04     9.5367e+05             1.9136e-09       -16.905092889234
     3.8147e+05     3.8147e+06             4.7840e-10       -16.905092889237
     1.5259e+06     1.5259e+07             1.1960e-10       -16.905092889239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0677
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.347927
====================================================
  Execution time = 2.0811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344896055439
                                         uncertainty =       0.005542612795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344896055439
                                         uncertainty =       0.005542612795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415211493
  error estimate for blocks of size 2^( 2) =       0.000428084800
  error estimate for blocks of size 2^( 3) =       0.000441323493
  error estimate for blocks of size 2^( 4) =       0.000453817136
  error estimate for blocks of size 2^( 5) =       0.000463798225
  error estimate for blocks of size 2^( 6) =       0.000473410244
  error estimate for blocks of size 2^( 7) =       0.000478777939

      target function =                  N/A
              le_mean =     -16.906559949674
             les_mean =     286.176570327508
             stat err =       0.000467450886
             autocorr =       1.267457021784
              std dev =       0.587197724776
             le_variance =       0.344801167982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655994967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906559949674       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906559949675       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906559949674       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906559949722       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906559949884       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906559950723       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906559950822       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906559950121       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.048175e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906559949674       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906559949674       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906559949674       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906559951133       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906559949734       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906559949591       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906559951065       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906559950896       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.620437e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906559949674       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906559949674       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906559949674       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906559942425       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906559940848       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906559949771       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906559956391       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906559949532       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.905114e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6400e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.702123
====================================================
  Execution time = 2.0783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3595e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736871
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736871
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409850255
  error estimate for blocks of size 2^( 2) =       0.000422872816
  error estimate for blocks of size 2^( 3) =       0.000436505846
  error estimate for blocks of size 2^( 4) =       0.000449012213
  error estimate for blocks of size 2^( 5) =       0.000461408685
  error estimate for blocks of size 2^( 6) =       0.000472274405
  error estimate for blocks of size 2^( 7) =       0.000476612290

      target function =                  N/A
              le_mean =     -16.905696105870
             les_mean =     286.138515119844
             stat err =       0.000464826898
             autocorr =       1.286269829301
              std dev =       0.579615789797
             le_variance =       0.335954463782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736841
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736841
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409850255
  error estimate for blocks of size 2^( 2) =       0.000422872816
  error estimate for blocks of size 2^( 3) =       0.000436505846
  error estimate for blocks of size 2^( 4) =       0.000449012213
  error estimate for blocks of size 2^( 5) =       0.000461408685
  error estimate for blocks of size 2^( 6) =       0.000472274405
  error estimate for blocks of size 2^( 7) =       0.000476612290

      target function =                  N/A
              le_mean =     -16.905696105871
             les_mean =     286.138515119846
             stat err =       0.000464826898
             autocorr =       1.286269829338
              std dev =       0.579615789771
             le_variance =       0.335954463752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736856
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736856
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409850255
  error estimate for blocks of size 2^( 2) =       0.000422872816
  error estimate for blocks of size 2^( 3) =       0.000436505846
  error estimate for blocks of size 2^( 4) =       0.000449012213
  error estimate for blocks of size 2^( 5) =       0.000461408685
  error estimate for blocks of size 2^( 6) =       0.000472274405
  error estimate for blocks of size 2^( 7) =       0.000476612290

      target function =                  N/A
              le_mean =     -16.905696105871
             les_mean =     286.138515119845
             stat err =       0.000464826898
             autocorr =       1.286269829313
              std dev =       0.579615789784
             le_variance =       0.335954463767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736869
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912736869
                                         uncertainty =       0.003638056906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409850255
  error estimate for blocks of size 2^( 2) =       0.000422872816
  error estimate for blocks of size 2^( 3) =       0.000436505846
  error estimate for blocks of size 2^( 4) =       0.000449012213
  error estimate for blocks of size 2^( 5) =       0.000461408685
  error estimate for blocks of size 2^( 6) =       0.000472274405
  error estimate for blocks of size 2^( 7) =       0.000476612290

      target function =                  N/A
              le_mean =     -16.905696105870
             les_mean =     286.138515119844
             stat err =       0.000464826898
             autocorr =       1.286269829298
              std dev =       0.579615789796
             le_variance =       0.335954463780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905696105870        initial
     9.5367e+05     9.5367e+06             3.0482e-10       -16.905696105871  <--
     3.8147e+06     3.8147e+07             7.6204e-11       -16.905696105871
     1.5259e+07     1.5259e+08             1.9051e-11       -16.905696105870

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 3.0329e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.215671
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332129850058
                                         uncertainty =       0.002587668050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332129850058
                                         uncertainty =       0.002587668050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407531261
  error estimate for blocks of size 2^( 2) =       0.000420889623
  error estimate for blocks of size 2^( 3) =       0.000434425744
  error estimate for blocks of size 2^( 4) =       0.000447544408
  error estimate for blocks of size 2^( 5) =       0.000459731170
  error estimate for blocks of size 2^( 6) =       0.000469074900
  error estimate for blocks of size 2^( 7) =       0.000476895480

      target function =                  N/A
              le_mean =     -16.906066060565
             les_mean =     286.147232935252
             stat err =       0.000463311489
             autocorr =       1.292481346436
              std dev =       0.576336236198
             le_variance =       0.332163457155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606606056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066060565       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066060567       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066060569       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066060567       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066060580       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066060568       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066060564       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066060641       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.134030e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066060565       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066060565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066060566       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066060508       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066060542       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066060554       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066060408       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066060328       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.835079e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066060565       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066060565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066060565       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066060565       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066060494       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066059232       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066060185       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066064944       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.087715e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6783e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895927e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.436489
====================================================
  Execution time = 2.0414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3897e-01
  Total weights = 2.0000e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028804093
                                         uncertainty =       0.003110069289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028804093
                                         uncertainty =       0.003110069289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682817
  error estimate for blocks of size 2^( 2) =       0.000424618180
  error estimate for blocks of size 2^( 3) =       0.000437947457
  error estimate for blocks of size 2^( 4) =       0.000450642384
  error estimate for blocks of size 2^( 5) =       0.000463478166
  error estimate for blocks of size 2^( 6) =       0.000473314088
  error estimate for blocks of size 2^( 7) =       0.000479610130

      target function =                  N/A
              le_mean =     -16.905449569042
             les_mean =     286.133190446152
             stat err =       0.000466761192
             autocorr =       1.285476076692
              std dev =       0.582207423689
             le_variance =       0.338965484199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028803583
                                         uncertainty =       0.003110069286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028803583
                                         uncertainty =       0.003110069286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682817
  error estimate for blocks of size 2^( 2) =       0.000424618179
  error estimate for blocks of size 2^( 3) =       0.000437947457
  error estimate for blocks of size 2^( 4) =       0.000450642384
  error estimate for blocks of size 2^( 5) =       0.000463478166
  error estimate for blocks of size 2^( 6) =       0.000473314088
  error estimate for blocks of size 2^( 7) =       0.000479610130

      target function =                  N/A
              le_mean =     -16.905449569043
             les_mean =     286.133190445655
             stat err =       0.000466761192
             autocorr =       1.285476077176
              std dev =       0.582207423252
             le_variance =       0.338965483689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028803838
                                         uncertainty =       0.003110069288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028803838
                                         uncertainty =       0.003110069288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682817
  error estimate for blocks of size 2^( 2) =       0.000424618179
  error estimate for blocks of size 2^( 3) =       0.000437947457
  error estimate for blocks of size 2^( 4) =       0.000450642384
  error estimate for blocks of size 2^( 5) =       0.000463478166
  error estimate for blocks of size 2^( 6) =       0.000473314088
  error estimate for blocks of size 2^( 7) =       0.000479610130

      target function =                  N/A
              le_mean =     -16.905449569043
             les_mean =     286.133190445904
             stat err =       0.000466761192
             autocorr =       1.285476076939
              std dev =       0.582207423471
             le_variance =       0.338965483944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028804061
                                         uncertainty =       0.003110069289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028804061
                                         uncertainty =       0.003110069289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682817
  error estimate for blocks of size 2^( 2) =       0.000424618180
  error estimate for blocks of size 2^( 3) =       0.000437947457
  error estimate for blocks of size 2^( 4) =       0.000450642384
  error estimate for blocks of size 2^( 5) =       0.000463478166
  error estimate for blocks of size 2^( 6) =       0.000473314088
  error estimate for blocks of size 2^( 7) =       0.000479610130

      target function =                  N/A
              le_mean =     -16.905449569042
             les_mean =     286.133190446121
             stat err =       0.000466761192
             autocorr =       1.285476076711
              std dev =       0.582207423662
             le_variance =       0.338965484167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905449569042        initial
     2.3842e+05     2.3842e+06             1.1340e-09       -16.905449569043  <--
     9.5367e+05     9.5367e+06             2.8351e-10       -16.905449569043
     3.8147e+06     3.8147e+07             7.0877e-11       -16.905449569042

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 3.3395e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0185e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9417
    reference variance = 0.187134
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298862670
                                         uncertainty =       0.002793295914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298862670
                                         uncertainty =       0.002793295914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410683681
  error estimate for blocks of size 2^( 2) =       0.000423708187
  error estimate for blocks of size 2^( 3) =       0.000437431467
  error estimate for blocks of size 2^( 4) =       0.000449966709
  error estimate for blocks of size 2^( 5) =       0.000460970472
  error estimate for blocks of size 2^( 6) =       0.000469650167
  error estimate for blocks of size 2^( 7) =       0.000475797512

      target function =                  N/A
              le_mean =     -16.906173998844
             les_mean =     286.156041281415
             stat err =       0.000464096215
             autocorr =       1.277030184282
              std dev =       0.580794430832
             le_variance =       0.337322170886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617399884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906173998844       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906173998851       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906173998871       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173998865       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173998865       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173998880       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906173998829       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173998829       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.289275e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906173998844       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906173998846       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906173998851       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173998811       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173998852       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173998847       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906173998995       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173998841       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.072319e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906173998844       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906173998844       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906173998846       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173998773       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173998708       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173999948       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906173997186       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173996989       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.680787e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6479e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853837e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 1.00619
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386229895
                                         uncertainty =       0.002298524736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386229895
                                         uncertainty =       0.002298524736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777499
  error estimate for blocks of size 2^( 2) =       0.000423185976
  error estimate for blocks of size 2^( 3) =       0.000436572003
  error estimate for blocks of size 2^( 4) =       0.000448369637
  error estimate for blocks of size 2^( 5) =       0.000459713059
  error estimate for blocks of size 2^( 6) =       0.000466703541
  error estimate for blocks of size 2^( 7) =       0.000471489257

      target function =                  N/A
              le_mean =     -16.905421866918
             les_mean =     286.130764636317
             stat err =       0.000461568874
             autocorr =       1.262582414484
              std dev =       0.580927109531
             le_variance =       0.337476306588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386230685
                                         uncertainty =       0.002298524744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386230685
                                         uncertainty =       0.002298524744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777499
  error estimate for blocks of size 2^( 2) =       0.000423185977
  error estimate for blocks of size 2^( 3) =       0.000436572003
  error estimate for blocks of size 2^( 4) =       0.000448369637
  error estimate for blocks of size 2^( 5) =       0.000459713060
  error estimate for blocks of size 2^( 6) =       0.000466703542
  error estimate for blocks of size 2^( 7) =       0.000471489257

      target function =                  N/A
              le_mean =     -16.905421866911
             les_mean =     286.130764636880
             stat err =       0.000461568874
             autocorr =       1.262582414156
              std dev =       0.580927110211
             le_variance =       0.337476307378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386230290
                                         uncertainty =       0.002298524740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386230290
                                         uncertainty =       0.002298524740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777499
  error estimate for blocks of size 2^( 2) =       0.000423185977
  error estimate for blocks of size 2^( 3) =       0.000436572003
  error estimate for blocks of size 2^( 4) =       0.000448369637
  error estimate for blocks of size 2^( 5) =       0.000459713060
  error estimate for blocks of size 2^( 6) =       0.000466703542
  error estimate for blocks of size 2^( 7) =       0.000471489257

      target function =                  N/A
              le_mean =     -16.905421866915
             les_mean =     286.130764636598
             stat err =       0.000461568874
             autocorr =       1.262582414325
              std dev =       0.580927109871
             le_variance =       0.337476306983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386229944
                                         uncertainty =       0.002298524737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337386229944
                                         uncertainty =       0.002298524737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777499
  error estimate for blocks of size 2^( 2) =       0.000423185976
  error estimate for blocks of size 2^( 3) =       0.000436572003
  error estimate for blocks of size 2^( 4) =       0.000448369637
  error estimate for blocks of size 2^( 5) =       0.000459713060
  error estimate for blocks of size 2^( 6) =       0.000466703541
  error estimate for blocks of size 2^( 7) =       0.000471489257

      target function =                  N/A
              le_mean =     -16.905421866918
             les_mean =     286.130764636352
             stat err =       0.000461568874
             autocorr =       1.262582414461
              std dev =       0.580927109574
             le_variance =       0.337476306638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905421866918        initial  <--
     5.9605e+04     5.9605e+05             4.2893e-09       -16.905421866911
     2.3842e+05     2.3842e+06             1.0723e-09       -16.905421866915
     9.5367e+05     9.5367e+06             2.6808e-10       -16.905421866918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9818
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9427
    reference variance = 0.23586
====================================================
  Execution time = 2.0682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3793e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338009626257
                                         uncertainty =       0.003934410605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338009626257
                                         uncertainty =       0.003934410605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411054678
  error estimate for blocks of size 2^( 2) =       0.000424044061
  error estimate for blocks of size 2^( 3) =       0.000437330023
  error estimate for blocks of size 2^( 4) =       0.000449519496
  error estimate for blocks of size 2^( 5) =       0.000460005275
  error estimate for blocks of size 2^( 6) =       0.000467103102
  error estimate for blocks of size 2^( 7) =       0.000471233701

      target function =                  N/A
              le_mean =     -16.905936027281
             les_mean =     286.148604685628
             stat err =       0.000461965393
             autocorr =       1.263047538183
              std dev =       0.581319100044
             le_variance =       0.337931896076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593602728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936027281       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905936027281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905936027281       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905936027121       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905936027455       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936026746       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936027042       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936027073       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 3.886169e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936027281       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905936027281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905936027281       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905936027281       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905936026366       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936029799       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936027281       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936027557       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 9.715418e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936027281       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905936027281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905936027281       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905936027636       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905936025822       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936026622       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936023863       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936025595       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.428858e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.441158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6238e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9349
    reference variance = 0.244341
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4241e-01
  Total weights = 2.0000e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951603
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951603
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413769932
  error estimate for blocks of size 2^( 2) =       0.000427255725
  error estimate for blocks of size 2^( 3) =       0.000441018738
  error estimate for blocks of size 2^( 4) =       0.000454319234
  error estimate for blocks of size 2^( 5) =       0.000467099775
  error estimate for blocks of size 2^( 6) =       0.000474283392
  error estimate for blocks of size 2^( 7) =       0.000481443949

      target function =                  N/A
              le_mean =     -16.905536965553
             les_mean =     286.139591036298
             stat err =       0.000469286587
             autocorr =       1.286347856710
              std dev =       0.585159050035
             le_variance =       0.342411113838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951504
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951504
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413769932
  error estimate for blocks of size 2^( 2) =       0.000427255725
  error estimate for blocks of size 2^( 3) =       0.000441018738
  error estimate for blocks of size 2^( 4) =       0.000454319234
  error estimate for blocks of size 2^( 5) =       0.000467099775
  error estimate for blocks of size 2^( 6) =       0.000474283391
  error estimate for blocks of size 2^( 7) =       0.000481443949

      target function =                  N/A
              le_mean =     -16.905536965552
             les_mean =     286.139591036189
             stat err =       0.000469286587
             autocorr =       1.286347856792
              std dev =       0.585159049951
             le_variance =       0.342411113739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951553
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951553
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413769932
  error estimate for blocks of size 2^( 2) =       0.000427255725
  error estimate for blocks of size 2^( 3) =       0.000441018738
  error estimate for blocks of size 2^( 4) =       0.000454319234
  error estimate for blocks of size 2^( 5) =       0.000467099775
  error estimate for blocks of size 2^( 6) =       0.000474283392
  error estimate for blocks of size 2^( 7) =       0.000481443949

      target function =                  N/A
              le_mean =     -16.905536965552
             les_mean =     286.139591036244
             stat err =       0.000469286587
             autocorr =       1.286347856750
              std dev =       0.585159049993
             le_variance =       0.342411113789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951596
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342425951596
                                         uncertainty =       0.007052728213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413769932
  error estimate for blocks of size 2^( 2) =       0.000427255725
  error estimate for blocks of size 2^( 3) =       0.000441018738
  error estimate for blocks of size 2^( 4) =       0.000454319234
  error estimate for blocks of size 2^( 5) =       0.000467099775
  error estimate for blocks of size 2^( 6) =       0.000474283392
  error estimate for blocks of size 2^( 7) =       0.000481443949

      target function =                  N/A
              le_mean =     -16.905536965553
             les_mean =     286.139591036292
             stat err =       0.000469286587
             autocorr =       1.286347856720
              std dev =       0.585159050030
             le_variance =       0.342411113832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905536965553        initial  <--
     5.9605e+05     5.9605e+06             3.8862e-10       -16.905536965552
     2.3842e+06     2.3842e+07             9.7154e-11       -16.905536965552
     9.5367e+06     9.5367e+07             2.4289e-11       -16.905536965553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1602
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.887
    reference variance = 0.390535
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4495e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344990655179
                                         uncertainty =       0.006369714959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344990655179
                                         uncertainty =       0.006369714959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415302300
  error estimate for blocks of size 2^( 2) =       0.000427491371
  error estimate for blocks of size 2^( 3) =       0.000440774923
  error estimate for blocks of size 2^( 4) =       0.000452619919
  error estimate for blocks of size 2^( 5) =       0.000463512465
  error estimate for blocks of size 2^( 6) =       0.000472615596
  error estimate for blocks of size 2^( 7) =       0.000474843256

      target function =                  N/A
              le_mean =     -16.905982832339
             les_mean =     286.157207355477
             stat err =       0.000465897809
             autocorr =       1.258498388762
              std dev =       0.587326145007
             le_variance =       0.344952000609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598283234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982832339       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982832339       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982832339       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982831654       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982830408       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982850855       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982832245       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.868662e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982832339       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982832339       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982832339       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982832339       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982837719       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982833061       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982807077       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.671546e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982832339       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982832339       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982832339       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982843311       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982832985       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982844179       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982856648       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.417924e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6479e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9143
    reference variance = 0.319668
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.0000e+06
  Execution time = 1.9410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489921
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489921
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066368
  error estimate for blocks of size 2^( 2) =       0.000421980543
  error estimate for blocks of size 2^( 3) =       0.000435406483
  error estimate for blocks of size 2^( 4) =       0.000448049815
  error estimate for blocks of size 2^( 5) =       0.000458295438
  error estimate for blocks of size 2^( 6) =       0.000465051909
  error estimate for blocks of size 2^( 7) =       0.000468718373

      target function =                  N/A
              le_mean =     -16.905527620782
             les_mean =     286.131534556357
             stat err =       0.000460028884
             autocorr =       1.264685826902
              std dev =       0.578507205374
             le_variance =       0.334670586669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489916
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489916
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066368
  error estimate for blocks of size 2^( 2) =       0.000421980543
  error estimate for blocks of size 2^( 3) =       0.000435406483
  error estimate for blocks of size 2^( 4) =       0.000448049815
  error estimate for blocks of size 2^( 5) =       0.000458295438
  error estimate for blocks of size 2^( 6) =       0.000465051909
  error estimate for blocks of size 2^( 7) =       0.000468718373

      target function =                  N/A
              le_mean =     -16.905527620782
             les_mean =     286.131534556354
             stat err =       0.000460028884
             autocorr =       1.264685826895
              std dev =       0.578507205370
             le_variance =       0.334670586665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489918
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489918
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066368
  error estimate for blocks of size 2^( 2) =       0.000421980543
  error estimate for blocks of size 2^( 3) =       0.000435406483
  error estimate for blocks of size 2^( 4) =       0.000448049815
  error estimate for blocks of size 2^( 5) =       0.000458295438
  error estimate for blocks of size 2^( 6) =       0.000465051909
  error estimate for blocks of size 2^( 7) =       0.000468718373

      target function =                  N/A
              le_mean =     -16.905527620782
             les_mean =     286.131534556355
             stat err =       0.000460028884
             autocorr =       1.264685826891
              std dev =       0.578507205372
             le_variance =       0.334670586667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489920
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334715489920
                                         uncertainty =       0.002537669072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066368
  error estimate for blocks of size 2^( 2) =       0.000421980543
  error estimate for blocks of size 2^( 3) =       0.000435406483
  error estimate for blocks of size 2^( 4) =       0.000448049815
  error estimate for blocks of size 2^( 5) =       0.000458295438
  error estimate for blocks of size 2^( 6) =       0.000465051909
  error estimate for blocks of size 2^( 7) =       0.000468718373

      target function =                  N/A
              le_mean =     -16.905527620782
             les_mean =     286.131534556357
             stat err =       0.000460028884
             autocorr =       1.264685826897
              std dev =       0.578507205374
             le_variance =       0.334670586669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905527620782        initial
     5.9605e+06     5.9605e+07             3.8687e-11       -16.905527620782  <--
     2.3842e+07     2.3842e+08             9.6715e-12       -16.905527620782
     9.5367e+07     9.5367e+08             2.4179e-12       -16.905527620782

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.9862e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0135
    reference variance = 0.284782
====================================================
  Execution time = 2.0872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739504578
                                         uncertainty =       0.003124811090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340739504578
                                         uncertainty =       0.003124811090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412723247
  error estimate for blocks of size 2^( 2) =       0.000425606791
  error estimate for blocks of size 2^( 3) =       0.000439008156
  error estimate for blocks of size 2^( 4) =       0.000451537292
  error estimate for blocks of size 2^( 5) =       0.000463147864
  error estimate for blocks of size 2^( 6) =       0.000470115526
  error estimate for blocks of size 2^( 7) =       0.000477344860

      target function =                  N/A
              le_mean =     -16.906186565443
             les_mean =     286.159824972566
             stat err =       0.000465536386
             autocorr =       1.272299620869
              std dev =       0.583678813500
             le_variance =       0.340680957329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618656544e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186565443       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186565443       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186565444       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186565444       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186565444       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186565444       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186565634       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186565507       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.021528e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186565443       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186565443       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186565443       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186565443       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186565444       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186561805       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186565589       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186567591       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.053811e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186565443       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186565443       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186565443       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186565443       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186571303       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186557521       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186576603       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186568312       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.263458e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6445e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0345
    reference variance = 0.551855
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3317e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466827
                                         uncertainty =       0.002522719527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466827
                                         uncertainty =       0.002522719527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148498
  error estimate for blocks of size 2^( 2) =       0.000420995175
  error estimate for blocks of size 2^( 3) =       0.000433911941
  error estimate for blocks of size 2^( 4) =       0.000446463129
  error estimate for blocks of size 2^( 5) =       0.000457797805
  error estimate for blocks of size 2^( 6) =       0.000465242791
  error estimate for blocks of size 2^( 7) =       0.000470616616

      target function =                  N/A
              le_mean =     -16.905399834835
             les_mean =     286.125713801673
             stat err =       0.000460030085
             autocorr =       1.270387069183
              std dev =       0.577209141153
             le_variance =       0.333170392631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466792
                                         uncertainty =       0.002522719526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466792
                                         uncertainty =       0.002522719526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148498
  error estimate for blocks of size 2^( 2) =       0.000420995175
  error estimate for blocks of size 2^( 3) =       0.000433911941
  error estimate for blocks of size 2^( 4) =       0.000446463129
  error estimate for blocks of size 2^( 5) =       0.000457797805
  error estimate for blocks of size 2^( 6) =       0.000465242791
  error estimate for blocks of size 2^( 7) =       0.000470616616

      target function =                  N/A
              le_mean =     -16.905399834834
             les_mean =     286.125713801621
             stat err =       0.000460030085
             autocorr =       1.270387069226
              std dev =       0.577209141123
             le_variance =       0.333170392596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466810
                                         uncertainty =       0.002522719526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466810
                                         uncertainty =       0.002522719526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148498
  error estimate for blocks of size 2^( 2) =       0.000420995175
  error estimate for blocks of size 2^( 3) =       0.000433911941
  error estimate for blocks of size 2^( 4) =       0.000446463129
  error estimate for blocks of size 2^( 5) =       0.000457797805
  error estimate for blocks of size 2^( 6) =       0.000465242791
  error estimate for blocks of size 2^( 7) =       0.000470616616

      target function =                  N/A
              le_mean =     -16.905399834834
             les_mean =     286.125713801647
             stat err =       0.000460030085
             autocorr =       1.270387069211
              std dev =       0.577209141138
             le_variance =       0.333170392613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466825
                                         uncertainty =       0.002522719527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333128466825
                                         uncertainty =       0.002522719527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148498
  error estimate for blocks of size 2^( 2) =       0.000420995175
  error estimate for blocks of size 2^( 3) =       0.000433911941
  error estimate for blocks of size 2^( 4) =       0.000446463129
  error estimate for blocks of size 2^( 5) =       0.000457797805
  error estimate for blocks of size 2^( 6) =       0.000465242791
  error estimate for blocks of size 2^( 7) =       0.000470616616

      target function =                  N/A
              le_mean =     -16.905399834835
             les_mean =     286.125713801670
             stat err =       0.000460030085
             autocorr =       1.270387069183
              std dev =       0.577209141152
             le_variance =       0.333170392629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905399834835        initial  <--
     1.4901e+06     1.4901e+07             2.0215e-10       -16.905399834834
     5.9605e+06     5.9605e+07             5.0538e-11       -16.905399834834
     2.3842e+07     2.3842e+08             1.2635e-11       -16.905399834835

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7701
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.356337
====================================================
  Execution time = 2.1074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4421e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344334084726
                                         uncertainty =       0.005463216628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344334084726
                                         uncertainty =       0.005463216628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414857610
  error estimate for blocks of size 2^( 2) =       0.000427701167
  error estimate for blocks of size 2^( 3) =       0.000440812881
  error estimate for blocks of size 2^( 4) =       0.000452418314
  error estimate for blocks of size 2^( 5) =       0.000461758899
  error estimate for blocks of size 2^( 6) =       0.000468905265
  error estimate for blocks of size 2^( 7) =       0.000475952799

      target function =                  N/A
              le_mean =     -16.906362810789
             les_mean =     286.169316991526
             stat err =       0.000464758819
             autocorr =       1.255038812524
              std dev =       0.586697258911
             le_variance =       0.344213673614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636281079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362810789       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362810789       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362810789       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362812073       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362819301       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362810778       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362783549       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.656273e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362810789       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362810789       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362810789       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362810789       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363090729       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362801525       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362799676       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 4.139923e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362810789       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362810789       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362810789       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362781240       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362804788       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362896831       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362644613       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.035169e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.448081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6714e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9452
    reference variance = 0.834629
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4340e-01
  Total weights = 2.0000e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641648
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641648
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414369141
  error estimate for blocks of size 2^( 2) =       0.000427078447
  error estimate for blocks of size 2^( 3) =       0.000440508074
  error estimate for blocks of size 2^( 4) =       0.000453314843
  error estimate for blocks of size 2^( 5) =       0.000465251155
  error estimate for blocks of size 2^( 6) =       0.000474164514
  error estimate for blocks of size 2^( 7) =       0.000482189033

      target function =                  N/A
              le_mean =     -16.906241333775
             les_mean =     286.164399434833
             stat err =       0.000468729886
             autocorr =       1.279588945648
              std dev =       0.586006459599
             le_variance =       0.343403570692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641649
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641649
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414369141
  error estimate for blocks of size 2^( 2) =       0.000427078447
  error estimate for blocks of size 2^( 3) =       0.000440508074
  error estimate for blocks of size 2^( 4) =       0.000453314843
  error estimate for blocks of size 2^( 5) =       0.000465251155
  error estimate for blocks of size 2^( 6) =       0.000474164514
  error estimate for blocks of size 2^( 7) =       0.000482189033

      target function =                  N/A
              le_mean =     -16.906241333775
             les_mean =     286.164399434834
             stat err =       0.000468729886
             autocorr =       1.279588945648
              std dev =       0.586006459600
             le_variance =       0.343403570693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641649
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641649
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414369141
  error estimate for blocks of size 2^( 2) =       0.000427078447
  error estimate for blocks of size 2^( 3) =       0.000440508074
  error estimate for blocks of size 2^( 4) =       0.000453314843
  error estimate for blocks of size 2^( 5) =       0.000465251155
  error estimate for blocks of size 2^( 6) =       0.000474164514
  error estimate for blocks of size 2^( 7) =       0.000482189033

      target function =                  N/A
              le_mean =     -16.906241333775
             les_mean =     286.164399434834
             stat err =       0.000468729886
             autocorr =       1.279588945651
              std dev =       0.586006459599
             le_variance =       0.343403570692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641648
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343447641648
                                         uncertainty =       0.004877837491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414369141
  error estimate for blocks of size 2^( 2) =       0.000427078447
  error estimate for blocks of size 2^( 3) =       0.000440508074
  error estimate for blocks of size 2^( 4) =       0.000453314843
  error estimate for blocks of size 2^( 5) =       0.000465251155
  error estimate for blocks of size 2^( 6) =       0.000474164514
  error estimate for blocks of size 2^( 7) =       0.000482189033

      target function =                  N/A
              le_mean =     -16.906241333775
             les_mean =     286.164399434833
             stat err =       0.000468729886
             autocorr =       1.279588945639
              std dev =       0.586006459599
             le_variance =       0.343403570692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906241333775        initial  <--
     1.4901e+07     1.4901e+08             1.6563e-11       -16.906241333775
     5.9605e+07     5.9605e+08             4.1399e-12       -16.906241333775
     2.3842e+08     2.3842e+09             1.0352e-12       -16.906241333775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0098
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.211126
====================================================
  Execution time = 2.2666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339016338490
                                         uncertainty =       0.003836083085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339016338490
                                         uncertainty =       0.003836083085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411722086
  error estimate for blocks of size 2^( 2) =       0.000424869204
  error estimate for blocks of size 2^( 3) =       0.000437838609
  error estimate for blocks of size 2^( 4) =       0.000449269531
  error estimate for blocks of size 2^( 5) =       0.000459067792
  error estimate for blocks of size 2^( 6) =       0.000465515202
  error estimate for blocks of size 2^( 7) =       0.000468021526

      target function =                  N/A
              le_mean =     -16.906075420908
             les_mean =     286.154416120934
             stat err =       0.000460468513
             autocorr =       1.250810580219
              std dev =       0.582262958640
             le_variance =       0.339030153004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607542091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075420908       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075420908       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075420908       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075420908       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075420908       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906075430853       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075498786       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906075366524       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.689458e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075420908       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075420908       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075420908       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075488075       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075236553       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906075417489       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075085987       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906075598922       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 4.224398e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075420908       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075420908       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075420908       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906074846321       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075420908       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076488717       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906074699674       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906073180469       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 1.055968e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.450650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8230e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8802
    reference variance = 0.186562
====================================================
  Execution time = 2.0231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3705e-01
  Total weights = 2.0000e+06
  Execution time = 1.8983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410519151
  error estimate for blocks of size 2^( 2) =       0.000423272701
  error estimate for blocks of size 2^( 3) =       0.000435784982
  error estimate for blocks of size 2^( 4) =       0.000448195033
  error estimate for blocks of size 2^( 5) =       0.000457145041
  error estimate for blocks of size 2^( 6) =       0.000464984148
  error estimate for blocks of size 2^( 7) =       0.000468866285

      target function =                  N/A
              le_mean =     -16.905625397535
             les_mean =     286.137221860310
             stat err =       0.000459797627
             autocorr =       1.254488273535
              std dev =       0.580561751278
             le_variance =       0.337051947046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410519151
  error estimate for blocks of size 2^( 2) =       0.000423272701
  error estimate for blocks of size 2^( 3) =       0.000435784982
  error estimate for blocks of size 2^( 4) =       0.000448195033
  error estimate for blocks of size 2^( 5) =       0.000457145041
  error estimate for blocks of size 2^( 6) =       0.000464984148
  error estimate for blocks of size 2^( 7) =       0.000468866285

      target function =                  N/A
              le_mean =     -16.905625397535
             les_mean =     286.137221860309
             stat err =       0.000459797627
             autocorr =       1.254488273537
              std dev =       0.580561751277
             le_variance =       0.337051947046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410519151
  error estimate for blocks of size 2^( 2) =       0.000423272701
  error estimate for blocks of size 2^( 3) =       0.000435784982
  error estimate for blocks of size 2^( 4) =       0.000448195033
  error estimate for blocks of size 2^( 5) =       0.000457145041
  error estimate for blocks of size 2^( 6) =       0.000464984148
  error estimate for blocks of size 2^( 7) =       0.000468866285

      target function =                  N/A
              le_mean =     -16.905625397535
             les_mean =     286.137221860309
             stat err =       0.000459797627
             autocorr =       1.254488273530
              std dev =       0.580561751277
             le_variance =       0.337051947046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337007528989
                                         uncertainty =       0.003260003899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410519151
  error estimate for blocks of size 2^( 2) =       0.000423272701
  error estimate for blocks of size 2^( 3) =       0.000435784982
  error estimate for blocks of size 2^( 4) =       0.000448195033
  error estimate for blocks of size 2^( 5) =       0.000457145041
  error estimate for blocks of size 2^( 6) =       0.000464984148
  error estimate for blocks of size 2^( 7) =       0.000468866285

      target function =                  N/A
              le_mean =     -16.905625397535
             les_mean =     286.137221860310
             stat err =       0.000459797627
             autocorr =       1.254488273535
              std dev =       0.580561751277
             le_variance =       0.337051947046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905625397535        initial  <--
     1.4901e+08     1.4901e+09             1.6895e-12       -16.905625397535
     5.9605e+08     5.9605e+09             4.2244e-13       -16.905625397535
     2.3842e+09     2.3842e+10             1.0560e-13       -16.905625397535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7951
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.858
    reference variance = 0.167228
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4129e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279565862
                                         uncertainty =       0.003820047053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279565862
                                         uncertainty =       0.003820047053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413093303
  error estimate for blocks of size 2^( 2) =       0.000425845230
  error estimate for blocks of size 2^( 3) =       0.000438926611
  error estimate for blocks of size 2^( 4) =       0.000451483201
  error estimate for blocks of size 2^( 5) =       0.000462025126
  error estimate for blocks of size 2^( 6) =       0.000467684232
  error estimate for blocks of size 2^( 7) =       0.000471720383

      target function =                  N/A
              le_mean =     -16.905547781372
             les_mean =     286.138837771463
             stat err =       0.000463228236
             autocorr =       1.257458724887
              std dev =       0.584202151537
             le_variance =       0.341292153861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554778137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547781372       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547781372       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547781372       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905546806060       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547918210       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905548511105       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547973951       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547628741       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 1.809046e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547781372       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547781372       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547781372       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547781372       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547854518       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551481255       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905548205007       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905546070898       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 4.522973e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547781372       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547781372       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547781372       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547781372       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547083869       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547792047       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905549524446       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905556405893       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905522223171       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905353490527       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905469470265       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906017880660       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905974028337       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906135525717       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906325657167       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906178774007       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904308655459       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906240386389       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904735009428       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906129579040       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906525133853       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902897532334       residual = 9.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.901994408255       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904508671443       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904890958618       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908878508162       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905148683948       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904608042168       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906418971698       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.902944150390       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906734162879       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.904850568345       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.909070026363       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.905532936841       residual = 2.68e-05           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.910982618018       residual = 4.13e-03           smallest_sin_value = 9.91e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.37e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.131330e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6084e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8356
    reference variance = 0.264382
====================================================
  Execution time = 1.9964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4207e-01
  Total weights = 2.0000e+06
  Execution time = 1.8868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413566574
  error estimate for blocks of size 2^( 2) =       0.000426324308
  error estimate for blocks of size 2^( 3) =       0.000438951752
  error estimate for blocks of size 2^( 4) =       0.000451231208
  error estimate for blocks of size 2^( 5) =       0.000461175870
  error estimate for blocks of size 2^( 6) =       0.000467016936
  error estimate for blocks of size 2^( 7) =       0.000472710859

      target function =                  N/A
              le_mean =     -16.906369014629
             les_mean =     286.167387710232
             stat err =       0.000463033718
             autocorr =       1.253528968227
              std dev =       0.584871458075
             le_variance =       0.342074622471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413566574
  error estimate for blocks of size 2^( 2) =       0.000426324308
  error estimate for blocks of size 2^( 3) =       0.000438951752
  error estimate for blocks of size 2^( 4) =       0.000451231208
  error estimate for blocks of size 2^( 5) =       0.000461175870
  error estimate for blocks of size 2^( 6) =       0.000467016936
  error estimate for blocks of size 2^( 7) =       0.000472710859

      target function =                  N/A
              le_mean =     -16.906369014629
             les_mean =     286.167387710232
             stat err =       0.000463033718
             autocorr =       1.253528968225
              std dev =       0.584871458075
             le_variance =       0.342074622471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413566574
  error estimate for blocks of size 2^( 2) =       0.000426324308
  error estimate for blocks of size 2^( 3) =       0.000438951752
  error estimate for blocks of size 2^( 4) =       0.000451231208
  error estimate for blocks of size 2^( 5) =       0.000461175870
  error estimate for blocks of size 2^( 6) =       0.000467016936
  error estimate for blocks of size 2^( 7) =       0.000472710859

      target function =                  N/A
              le_mean =     -16.906369014629
             les_mean =     286.167387710232
             stat err =       0.000463033718
             autocorr =       1.253528968226
              std dev =       0.584871458075
             le_variance =       0.342074622471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342032765995
                                         uncertainty =       0.005587775627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413566574
  error estimate for blocks of size 2^( 2) =       0.000426324308
  error estimate for blocks of size 2^( 3) =       0.000438951752
  error estimate for blocks of size 2^( 4) =       0.000451231208
  error estimate for blocks of size 2^( 5) =       0.000461175870
  error estimate for blocks of size 2^( 6) =       0.000467016936
  error estimate for blocks of size 2^( 7) =       0.000472710859

      target function =                  N/A
              le_mean =     -16.906369014629
             les_mean =     286.167387710232
             stat err =       0.000463033718
             autocorr =       1.253528968227
              std dev =       0.584871458075
             le_variance =       0.342074622471


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906369014629        initial  <--
     1.4901e+09     1.4901e+10             1.8090e-13       -16.906369014629
     5.9605e+09     5.9605e+10             4.5230e-14       -16.906369014629
     2.3842e+10     2.3842e+11             1.1313e-14       -16.906369014629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4821
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5573e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.0067
    reference variance = 0.354207
====================================================
  Execution time = 2.0369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5017e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350297949359
                                         uncertainty =       0.010810036483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350297949359
                                         uncertainty =       0.010810036483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418431297
  error estimate for blocks of size 2^( 2) =       0.000430974457
  error estimate for blocks of size 2^( 3) =       0.000444034860
  error estimate for blocks of size 2^( 4) =       0.000457493477
  error estimate for blocks of size 2^( 5) =       0.000467230751
  error estimate for blocks of size 2^( 6) =       0.000475335937
  error estimate for blocks of size 2^( 7) =       0.000479884991

      target function =                  N/A
              le_mean =     -16.905727466757
             les_mean =     286.153790505485
             stat err =       0.000469986289
             autocorr =       1.261601091022
              std dev =       0.591751214882
             le_variance =       0.350169500314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572746676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727466757       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905727466757       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905727466757       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905727466757       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905727798696       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905727744639       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905727466757       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.468661e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727466757       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905727466757       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905727466757       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905725536268       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726919924       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905727466757       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905724353795       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905700127564       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905782308694       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905494461002       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904823520570       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906538221719       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904384429559       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903655352070       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906652382735       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907173861705       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905865267484       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906452331389       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906223794462       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907973775809       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909193797923       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904607735464       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910352329910       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905751450655       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.913166745543       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.912230222250       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903829382891       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904436007403       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.900380929306       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906723139204       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.895857232033       residual = 1.23e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.908446007352       residual = 2.32e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.896728165447       residual = 1.02e-02           smallest_sin_value = 9.99e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 3.698562e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727466757       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905727466757       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905727466757       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905727466757       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905727466757       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905514131984       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905695856210       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905755445032       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905984916076       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907408321583       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905824918680       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907809333257       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904662981907       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.912965238510       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907671199544       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906905212480       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.926095439551       residual = 5.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.924139821422       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.846348360753       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905905243059       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.895046166625       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.926056413616       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.908272516565       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.876802094264       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.914622555345       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.896678158012       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.926150403639       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906906696652       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.901315747991       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.900961145986       residual = 7.10e-03           smallest_sin_value = 9.99e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 8.530963e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.501537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6055e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9384
    reference variance = 0.315791
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4697e-01
  Total weights = 2.0000e+06
  Execution time = 1.8985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416518254
  error estimate for blocks of size 2^( 2) =       0.000428703245
  error estimate for blocks of size 2^( 3) =       0.000441527631
  error estimate for blocks of size 2^( 4) =       0.000453216126
  error estimate for blocks of size 2^( 5) =       0.000461792744
  error estimate for blocks of size 2^( 6) =       0.000467608990
  error estimate for blocks of size 2^( 7) =       0.000469341212

      target function =                  N/A
              le_mean =     -16.906632813224
             les_mean =     286.181207820090
             stat err =       0.000462989768
             autocorr =       1.235590917032
              std dev =       0.589045764249
             le_variance =       0.346974912379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416518254
  error estimate for blocks of size 2^( 2) =       0.000428703245
  error estimate for blocks of size 2^( 3) =       0.000441527631
  error estimate for blocks of size 2^( 4) =       0.000453216126
  error estimate for blocks of size 2^( 5) =       0.000461792744
  error estimate for blocks of size 2^( 6) =       0.000467608990
  error estimate for blocks of size 2^( 7) =       0.000469341212

      target function =                  N/A
              le_mean =     -16.906632813224
             les_mean =     286.181207820090
             stat err =       0.000462989768
             autocorr =       1.235590917034
              std dev =       0.589045764249
             le_variance =       0.346974912379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416518254
  error estimate for blocks of size 2^( 2) =       0.000428703245
  error estimate for blocks of size 2^( 3) =       0.000441527631
  error estimate for blocks of size 2^( 4) =       0.000453216126
  error estimate for blocks of size 2^( 5) =       0.000461792744
  error estimate for blocks of size 2^( 6) =       0.000467608990
  error estimate for blocks of size 2^( 7) =       0.000469341212

      target function =                  N/A
              le_mean =     -16.906632813224
             les_mean =     286.181207820090
             stat err =       0.000462989768
             autocorr =       1.235590917034
              std dev =       0.589045764249
             le_variance =       0.346974912379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347016780550
                                         uncertainty =       0.007632896852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416518254
  error estimate for blocks of size 2^( 2) =       0.000428703245
  error estimate for blocks of size 2^( 3) =       0.000441527631
  error estimate for blocks of size 2^( 4) =       0.000453216126
  error estimate for blocks of size 2^( 5) =       0.000461792744
  error estimate for blocks of size 2^( 6) =       0.000467608990
  error estimate for blocks of size 2^( 7) =       0.000469341212

      target function =                  N/A
              le_mean =     -16.906632813224
             les_mean =     286.181207820090
             stat err =       0.000462989768
             autocorr =       1.235590917034
              std dev =       0.589045764249
             le_variance =       0.346974912379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906632813224        initial  <--
     1.4901e+10     1.4901e+11             1.4687e-14       -16.906632813224
     5.9605e+10     5.9605e+11             3.6986e-15       -16.906632813224
     2.3842e+11     2.3842e+12             8.5310e-16       -16.906632813224

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3932
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.223977
====================================================
  Execution time = 2.0369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337750185195
                                         uncertainty =       0.003419928734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337750185195
                                         uncertainty =       0.003419928734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410948085
  error estimate for blocks of size 2^( 2) =       0.000423903383
  error estimate for blocks of size 2^( 3) =       0.000437648547
  error estimate for blocks of size 2^( 4) =       0.000449917942
  error estimate for blocks of size 2^( 5) =       0.000459487224
  error estimate for blocks of size 2^( 6) =       0.000467015801
  error estimate for blocks of size 2^( 7) =       0.000470693482

      target function =                  N/A
              le_mean =     -16.906126416193
             les_mean =     286.154866888329
             stat err =       0.000461778612
             autocorr =       1.262681177564
              std dev =       0.581168355038
             le_variance =       0.337756656898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612641619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126416193       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126416193       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126416193       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126416193       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044441703       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759713962       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906146906445       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906604137101       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904719890215       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906419087298       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907325131039       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909396285271       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904475612466       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908710525656       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906441215293       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.895648863020       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911813564857       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908439814929       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.918582093197       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.917874644573       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.901517362577       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906865586554       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.891728443288       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907572917802       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.879662590528       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.900166905590       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.925134863385       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909929178693       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908692451813       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.883384089296       residual = 6.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.907037184686       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.924462324896       residual = 4.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.928826890754       residual = 6.86e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.881035298311       residual = 8.06e-02           smallest_sin_value = 9.94e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.44e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 1.778026e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126416193       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126416193       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126416193       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126416193       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906081187438       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906959355340       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403099039       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908961793971       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906274739332       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.901723471140       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905310511644       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907292040538       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.896074290925       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909316527609       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.940295596821       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.918302541431       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.934002300897       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.934562542974       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905620469714       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.895141171489       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.931810322160       residual = 9.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.822080616168       residual = 9.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.748874479010       residual = 3.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.949429421110       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.804189364080       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.954191674462       residual = 3.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.884838375033       residual = 6.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.928740209363       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.817157961772       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.962830061772       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.829817168215       residual = 8.18e-01           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+11 is 1.969219e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126416193       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126416193       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126416193       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126416193       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907006957071       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903246717038       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.890031482699       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.921172587873       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.912039203616       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911520352721       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.887506904839       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.861439395670       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.756739085787       residual = 3.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918899124078       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.865366389383       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.877561423776       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.766810146527       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.889427625703       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.795947237858       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.079236688714       residual = 3.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.849646878725       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.921150692838       residual = 5.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.066675416701       residual = 3.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.246685712284       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.829482242283       residual = 7.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.089886790589       residual = 4.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.933338626389       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.790048218717       residual = 1.82e+00           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 6.537803e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.541324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5909e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8013
    reference variance = 0.240565
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3981e-01
  Total weights = 2.0000e+06
  Execution time = 1.8890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412194876
  error estimate for blocks of size 2^( 2) =       0.000425471358
  error estimate for blocks of size 2^( 3) =       0.000438501687
  error estimate for blocks of size 2^( 4) =       0.000450500739
  error estimate for blocks of size 2^( 5) =       0.000461315329
  error estimate for blocks of size 2^( 6) =       0.000469525982
  error estimate for blocks of size 2^( 7) =       0.000474589606

      target function =                  N/A
              le_mean =     -16.905408169547
             les_mean =     286.132634441406
             stat err =       0.000463982914
             autocorr =       1.267064717784
              std dev =       0.582931584608
             le_variance =       0.339809232334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412194876
  error estimate for blocks of size 2^( 2) =       0.000425471358
  error estimate for blocks of size 2^( 3) =       0.000438501687
  error estimate for blocks of size 2^( 4) =       0.000450500739
  error estimate for blocks of size 2^( 5) =       0.000461315329
  error estimate for blocks of size 2^( 6) =       0.000469525982
  error estimate for blocks of size 2^( 7) =       0.000474589606

      target function =                  N/A
              le_mean =     -16.905408169547
             les_mean =     286.132634441406
             stat err =       0.000463982914
             autocorr =       1.267064717784
              std dev =       0.582931584608
             le_variance =       0.339809232334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412194876
  error estimate for blocks of size 2^( 2) =       0.000425471358
  error estimate for blocks of size 2^( 3) =       0.000438501687
  error estimate for blocks of size 2^( 4) =       0.000450500739
  error estimate for blocks of size 2^( 5) =       0.000461315329
  error estimate for blocks of size 2^( 6) =       0.000469525982
  error estimate for blocks of size 2^( 7) =       0.000474589606

      target function =                  N/A
              le_mean =     -16.905408169547
             les_mean =     286.132634441406
             stat err =       0.000463982914
             autocorr =       1.267064717785
              std dev =       0.582931584608
             le_variance =       0.339809232334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819313043
                                         uncertainty =       0.004890096064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412194876
  error estimate for blocks of size 2^( 2) =       0.000425471358
  error estimate for blocks of size 2^( 3) =       0.000438501687
  error estimate for blocks of size 2^( 4) =       0.000450500739
  error estimate for blocks of size 2^( 5) =       0.000461315329
  error estimate for blocks of size 2^( 6) =       0.000469525982
  error estimate for blocks of size 2^( 7) =       0.000474589606

      target function =                  N/A
              le_mean =     -16.905408169547
             les_mean =     286.132634441406
             stat err =       0.000463982914
             autocorr =       1.267064717784
              std dev =       0.582931584608
             le_variance =       0.339809232334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905408169547        initial  <--
     1.4901e+11     1.4901e+12             1.7780e-15       -16.905408169547
     5.9605e+11     5.9605e+12             1.9692e-16       -16.905408169547
     2.3842e+12     2.3842e+13             6.5378e-17       -16.905408169547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5555
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5520e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8559
    reference variance = 0.452573
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343729969359
                                         uncertainty =       0.003967754707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343729969359
                                         uncertainty =       0.003967754707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414471047
  error estimate for blocks of size 2^( 2) =       0.000426857874
  error estimate for blocks of size 2^( 3) =       0.000440304025
  error estimate for blocks of size 2^( 4) =       0.000452479432
  error estimate for blocks of size 2^( 5) =       0.000464162520
  error estimate for blocks of size 2^( 6) =       0.000473109730
  error estimate for blocks of size 2^( 7) =       0.000477091931

      target function =                  N/A
              le_mean =     -16.905595968727
             les_mean =     286.142747383128
             stat err =       0.000466710903
             autocorr =       1.267965679544
              std dev =       0.586150575417
             le_variance =       0.343572497061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559596873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595968727       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595968727       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595968727       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595968727       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905699357262       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906385249337       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958532726       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907851773380       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907994803350       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.900790916988       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911706819138       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.918664776411       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.917519745361       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.855655876553       residual = 3.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896676743779       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.933147121070       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.915472871909       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.936302865998       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.888484487111       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.895476496127       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912194734332       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.824105383508       residual = 8.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.898677569084       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.860572212636       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.826514720670       residual = 8.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.962160685549       residual = 5.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.941559987127       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.940056476341       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.692007436568       residual = 5.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.991444444359       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.867794616282       residual = 5.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.954361911112       residual = 3.19e-01           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 9.999936e-17

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595968727       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595968727       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595968727       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904935416390       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906785950518       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.889982698163       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.900651589762       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.898007365856       residual = 7.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.853369154329       residual = 3.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.917977396631       residual = 3.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.686271204862       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.886494696039       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.189359235168       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.881828312099       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.829784888227       residual = 8.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896720449300       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.756864300877       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.487032706601       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.423541582435       residual = 2.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.815941156928       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.942945440117       residual = 3.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.091126819547       residual = 8.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.238579357787       residual = 3.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -18.583632881383       residual = 3.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.070960851472       residual = 4.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.390469797025       residual = 3.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.451850455990       residual = 2.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.477207497824       residual = 2.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.658460772866       residual = 7.45e+01           smallest_sin_value = 9.98e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.201280727010       residual = 6.37e+01           smallest_sin_value = 9.98e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.612886414938       residual = 1.23e+01           smallest_sin_value = 9.96e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.452941602823       residual = 4.56e+01           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+12 is 5.715144e-18

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595968727       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595968727       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.570251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5780e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.462844
====================================================
  Execution time = 1.9911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3960e-01
  Total weights = 2.0000e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412069421
  error estimate for blocks of size 2^( 2) =       0.000424834289
  error estimate for blocks of size 2^( 3) =       0.000438090251
  error estimate for blocks of size 2^( 4) =       0.000450331268
  error estimate for blocks of size 2^( 5) =       0.000461159674
  error estimate for blocks of size 2^( 6) =       0.000468299618
  error estimate for blocks of size 2^( 7) =       0.000474474920

      target function =                  N/A
              le_mean =     -16.906227470753
             les_mean =     286.160129537843
             stat err =       0.000463566370
             autocorr =       1.265560961040
              std dev =       0.582754163277
             le_variance =       0.339602414817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412069421
  error estimate for blocks of size 2^( 2) =       0.000424834289
  error estimate for blocks of size 2^( 3) =       0.000438090251
  error estimate for blocks of size 2^( 4) =       0.000450331268
  error estimate for blocks of size 2^( 5) =       0.000461159674
  error estimate for blocks of size 2^( 6) =       0.000468299618
  error estimate for blocks of size 2^( 7) =       0.000474474920

      target function =                  N/A
              le_mean =     -16.906227470753
             les_mean =     286.160129537843
             stat err =       0.000463566370
             autocorr =       1.265560961040
              std dev =       0.582754163277
             le_variance =       0.339602414817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412069421
  error estimate for blocks of size 2^( 2) =       0.000424834289
  error estimate for blocks of size 2^( 3) =       0.000438090251
  error estimate for blocks of size 2^( 4) =       0.000450331268
  error estimate for blocks of size 2^( 5) =       0.000461159674
  error estimate for blocks of size 2^( 6) =       0.000468299618
  error estimate for blocks of size 2^( 7) =       0.000474474920

      target function =                  N/A
              le_mean =     -16.906227470753
             les_mean =     286.160129537843
             stat err =       0.000463566370
             autocorr =       1.265560961041
              std dev =       0.582754163277
             le_variance =       0.339602414817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339652335799
                                         uncertainty =       0.003390441587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412069421
  error estimate for blocks of size 2^( 2) =       0.000424834289
  error estimate for blocks of size 2^( 3) =       0.000438090251
  error estimate for blocks of size 2^( 4) =       0.000450331268
  error estimate for blocks of size 2^( 5) =       0.000461159674
  error estimate for blocks of size 2^( 6) =       0.000468299618
  error estimate for blocks of size 2^( 7) =       0.000474474920

      target function =                  N/A
              le_mean =     -16.906227470753
             les_mean =     286.160129537843
             stat err =       0.000463566370
             autocorr =       1.265560961040
              std dev =       0.582754163277
             le_variance =       0.339602414817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906227470753        initial  <--
     1.4901e+12     1.4901e+13             9.9999e-17       -16.906227470753
     5.9605e+12     5.9605e+13             5.7151e-18       -16.906227470753
     2.3842e+13     2.3842e+14             0.0000e+00       -16.906227470753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4405
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.493068
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3348e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333484103988
                                         uncertainty =       0.002963853666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333484103988
                                         uncertainty =       0.002963853666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408336494
  error estimate for blocks of size 2^( 2) =       0.000421379592
  error estimate for blocks of size 2^( 3) =       0.000435161004
  error estimate for blocks of size 2^( 4) =       0.000447440629
  error estimate for blocks of size 2^( 5) =       0.000457539968
  error estimate for blocks of size 2^( 6) =       0.000464800540
  error estimate for blocks of size 2^( 7) =       0.000468678252

      target function =                  N/A
              le_mean =     -16.906162071761
             les_mean =     286.151793214426
             stat err =       0.000459614847
             autocorr =       1.266927339945
              std dev =       0.577475007687
             le_variance =       0.333477384503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616207176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162071761       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.571301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6960e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.166163
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5675e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422347200
  error estimate for blocks of size 2^( 2) =       0.000435239958
  error estimate for blocks of size 2^( 3) =       0.000448948215
  error estimate for blocks of size 2^( 4) =       0.000462422260
  error estimate for blocks of size 2^( 5) =       0.000474401099
  error estimate for blocks of size 2^( 6) =       0.000482856131
  error estimate for blocks of size 2^( 7) =       0.000488327822

      target function =                  N/A
              le_mean =     -16.904996763447
             les_mean =     286.135669707633
             stat err =       0.000477001828
             autocorr =       1.275559874378
              std dev =       0.597289137569
             le_variance =       0.356754313858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422347200
  error estimate for blocks of size 2^( 2) =       0.000435239958
  error estimate for blocks of size 2^( 3) =       0.000448948215
  error estimate for blocks of size 2^( 4) =       0.000462422260
  error estimate for blocks of size 2^( 5) =       0.000474401099
  error estimate for blocks of size 2^( 6) =       0.000482856131
  error estimate for blocks of size 2^( 7) =       0.000488327822

      target function =                  N/A
              le_mean =     -16.904996763447
             les_mean =     286.135669707633
             stat err =       0.000477001828
             autocorr =       1.275559874378
              std dev =       0.597289137569
             le_variance =       0.356754313858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422347200
  error estimate for blocks of size 2^( 2) =       0.000435239958
  error estimate for blocks of size 2^( 3) =       0.000448948215
  error estimate for blocks of size 2^( 4) =       0.000462422260
  error estimate for blocks of size 2^( 5) =       0.000474401099
  error estimate for blocks of size 2^( 6) =       0.000482856131
  error estimate for blocks of size 2^( 7) =       0.000488327822

      target function =                  N/A
              le_mean =     -16.904996763447
             les_mean =     286.135669707633
             stat err =       0.000477001828
             autocorr =       1.275559874378
              std dev =       0.597289137569
             le_variance =       0.356754313858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356857671453
                                         uncertainty =       0.013328949663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422347200
  error estimate for blocks of size 2^( 2) =       0.000435239958
  error estimate for blocks of size 2^( 3) =       0.000448948215
  error estimate for blocks of size 2^( 4) =       0.000462422260
  error estimate for blocks of size 2^( 5) =       0.000474401099
  error estimate for blocks of size 2^( 6) =       0.000482856131
  error estimate for blocks of size 2^( 7) =       0.000488327822

      target function =                  N/A
              le_mean =     -16.904996763447
             les_mean =     286.135669707633
             stat err =       0.000477001828
             autocorr =       1.275559874378
              std dev =       0.597289137569
             le_variance =       0.356754313858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904996763447        initial  <--
     1.4901e+13     1.4901e+14             0.0000e+00       -16.904996763447
     5.9605e+13     5.9605e+14             0.0000e+00       -16.904996763447
     2.3842e+14     2.3842e+15             0.0000e+00       -16.904996763447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7890
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.153322
====================================================
  Execution time = 2.0328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339506175001
                                         uncertainty =       0.004161676906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339506175001
                                         uncertainty =       0.004161676906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412015077
  error estimate for blocks of size 2^( 2) =       0.000424789326
  error estimate for blocks of size 2^( 3) =       0.000437526586
  error estimate for blocks of size 2^( 4) =       0.000449034207
  error estimate for blocks of size 2^( 5) =       0.000458637940
  error estimate for blocks of size 2^( 6) =       0.000465052443
  error estimate for blocks of size 2^( 7) =       0.000466582458

      target function =                  N/A
              le_mean =     -16.905562098663
             les_mean =     286.137542549993
             stat err =       0.000459826762
             autocorr =       1.245553164633
              std dev =       0.582677310345
             le_variance =       0.339512847991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556209866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905562098663       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.572264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5989e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.22516
====================================================
  Execution time = 1.9902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3795e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411067454
  error estimate for blocks of size 2^( 2) =       0.000423549645
  error estimate for blocks of size 2^( 3) =       0.000436867998
  error estimate for blocks of size 2^( 4) =       0.000449316639
  error estimate for blocks of size 2^( 5) =       0.000459998146
  error estimate for blocks of size 2^( 6) =       0.000468739622
  error estimate for blocks of size 2^( 7) =       0.000475499604

      target function =                  N/A
              le_mean =     -16.905795311085
             les_mean =     286.143867834556
             stat err =       0.000463388503
             autocorr =       1.270762300846
              std dev =       0.581337168276
             le_variance =       0.337952903219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411067454
  error estimate for blocks of size 2^( 2) =       0.000423549645
  error estimate for blocks of size 2^( 3) =       0.000436867998
  error estimate for blocks of size 2^( 4) =       0.000449316639
  error estimate for blocks of size 2^( 5) =       0.000459998146
  error estimate for blocks of size 2^( 6) =       0.000468739622
  error estimate for blocks of size 2^( 7) =       0.000475499604

      target function =                  N/A
              le_mean =     -16.905795311085
             les_mean =     286.143867834556
             stat err =       0.000463388503
             autocorr =       1.270762300846
              std dev =       0.581337168276
             le_variance =       0.337952903219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411067454
  error estimate for blocks of size 2^( 2) =       0.000423549645
  error estimate for blocks of size 2^( 3) =       0.000436867998
  error estimate for blocks of size 2^( 4) =       0.000449316639
  error estimate for blocks of size 2^( 5) =       0.000459998146
  error estimate for blocks of size 2^( 6) =       0.000468739622
  error estimate for blocks of size 2^( 7) =       0.000475499604

      target function =                  N/A
              le_mean =     -16.905795311085
             les_mean =     286.143867834556
             stat err =       0.000463388503
             autocorr =       1.270762300846
              std dev =       0.581337168276
             le_variance =       0.337952903219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012028667
                                         uncertainty =       0.003206649895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411067454
  error estimate for blocks of size 2^( 2) =       0.000423549645
  error estimate for blocks of size 2^( 3) =       0.000436867998
  error estimate for blocks of size 2^( 4) =       0.000449316639
  error estimate for blocks of size 2^( 5) =       0.000459998146
  error estimate for blocks of size 2^( 6) =       0.000468739622
  error estimate for blocks of size 2^( 7) =       0.000475499604

      target function =                  N/A
              le_mean =     -16.905795311085
             les_mean =     286.143867834556
             stat err =       0.000463388503
             autocorr =       1.270762300846
              std dev =       0.581337168276
             le_variance =       0.337952903219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905795311085        initial  <--
     1.4901e+14     1.4901e+15             0.0000e+00       -16.905795311085
     5.9605e+14     5.9605e+15             0.0000e+00       -16.905795311085
     2.3842e+15     2.3842e+16             0.0000e+00       -16.905795311085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4973
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.281114
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338847627980
                                         uncertainty =       0.004448095338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338847627980
                                         uncertainty =       0.004448095338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411554895
  error estimate for blocks of size 2^( 2) =       0.000424176698
  error estimate for blocks of size 2^( 3) =       0.000437151095
  error estimate for blocks of size 2^( 4) =       0.000449218115
  error estimate for blocks of size 2^( 5) =       0.000459990832
  error estimate for blocks of size 2^( 6) =       0.000467839901
  error estimate for blocks of size 2^( 7) =       0.000470446331

      target function =                  N/A
              le_mean =     -16.905553758407
             les_mean =     286.136502572788
             stat err =       0.000461873795
             autocorr =       1.259479495162
              std dev =       0.582026514680
             le_variance =       0.338754863790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555375841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553758407       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.573306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5861e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8374
    reference variance = 0.240848
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4035e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525116
  error estimate for blocks of size 2^( 2) =       0.000425175238
  error estimate for blocks of size 2^( 3) =       0.000437780470
  error estimate for blocks of size 2^( 4) =       0.000450397920
  error estimate for blocks of size 2^( 5) =       0.000460120190
  error estimate for blocks of size 2^( 6) =       0.000469197889
  error estimate for blocks of size 2^( 7) =       0.000472941473

      target function =                  N/A
              le_mean =     -16.905585573349
             les_mean =     286.139177349778
             stat err =       0.000463164368
             autocorr =       1.260577328613
              std dev =       0.583398613411
             le_variance =       0.340353942129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525116
  error estimate for blocks of size 2^( 2) =       0.000425175238
  error estimate for blocks of size 2^( 3) =       0.000437780470
  error estimate for blocks of size 2^( 4) =       0.000450397920
  error estimate for blocks of size 2^( 5) =       0.000460120190
  error estimate for blocks of size 2^( 6) =       0.000469197889
  error estimate for blocks of size 2^( 7) =       0.000472941473

      target function =                  N/A
              le_mean =     -16.905585573349
             les_mean =     286.139177349778
             stat err =       0.000463164368
             autocorr =       1.260577328613
              std dev =       0.583398613411
             le_variance =       0.340353942129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525116
  error estimate for blocks of size 2^( 2) =       0.000425175238
  error estimate for blocks of size 2^( 3) =       0.000437780470
  error estimate for blocks of size 2^( 4) =       0.000450397920
  error estimate for blocks of size 2^( 5) =       0.000460120190
  error estimate for blocks of size 2^( 6) =       0.000469197889
  error estimate for blocks of size 2^( 7) =       0.000472941473

      target function =                  N/A
              le_mean =     -16.905585573349
             les_mean =     286.139177349778
             stat err =       0.000463164368
             autocorr =       1.260577328613
              std dev =       0.583398613411
             le_variance =       0.340353942129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340434204141
                                         uncertainty =       0.005154816346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525116
  error estimate for blocks of size 2^( 2) =       0.000425175238
  error estimate for blocks of size 2^( 3) =       0.000437780470
  error estimate for blocks of size 2^( 4) =       0.000450397920
  error estimate for blocks of size 2^( 5) =       0.000460120190
  error estimate for blocks of size 2^( 6) =       0.000469197889
  error estimate for blocks of size 2^( 7) =       0.000472941473

      target function =                  N/A
              le_mean =     -16.905585573349
             les_mean =     286.139177349778
             stat err =       0.000463164368
             autocorr =       1.260577328613
              std dev =       0.583398613411
             le_variance =       0.340353942129


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905585573349        initial  <--
     1.4901e+15     1.4901e+16             0.0000e+00       -16.905585573349
     5.9605e+15     5.9605e+16             0.0000e+00       -16.905585573349
     2.3842e+16     2.3842e+17             0.0000e+00       -16.905585573349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6327
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5501e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8824
    reference variance = 0.198923
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4552e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345632157373
                                         uncertainty =       0.004759715392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345632157373
                                         uncertainty =       0.004759715392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415641458
  error estimate for blocks of size 2^( 2) =       0.000427945841
  error estimate for blocks of size 2^( 3) =       0.000440858073
  error estimate for blocks of size 2^( 4) =       0.000452609297
  error estimate for blocks of size 2^( 5) =       0.000462752028
  error estimate for blocks of size 2^( 6) =       0.000470534515
  error estimate for blocks of size 2^( 7) =       0.000472800039

      target function =                  N/A
              le_mean =     -16.906515707925
             les_mean =     286.175788852481
             stat err =       0.000464673970
             autocorr =       1.249853096785
              std dev =       0.587805786753
             le_variance =       0.345515642941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651570792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906515707925       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.574309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5829e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.224049
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5778e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422954610
  error estimate for blocks of size 2^( 2) =       0.000435635421
  error estimate for blocks of size 2^( 3) =       0.000448342430
  error estimate for blocks of size 2^( 4) =       0.000460561477
  error estimate for blocks of size 2^( 5) =       0.000471139127
  error estimate for blocks of size 2^( 6) =       0.000477674031
  error estimate for blocks of size 2^( 7) =       0.000484637015

      target function =                  N/A
              le_mean =     -16.906597125460
             les_mean =     286.190807388035
             stat err =       0.000473502912
             autocorr =       1.253307917849
              std dev =       0.598148145784
             le_variance =       0.357781204304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422954610
  error estimate for blocks of size 2^( 2) =       0.000435635421
  error estimate for blocks of size 2^( 3) =       0.000448342430
  error estimate for blocks of size 2^( 4) =       0.000460561477
  error estimate for blocks of size 2^( 5) =       0.000471139127
  error estimate for blocks of size 2^( 6) =       0.000477674031
  error estimate for blocks of size 2^( 7) =       0.000484637015

      target function =                  N/A
              le_mean =     -16.906597125460
             les_mean =     286.190807388035
             stat err =       0.000473502912
             autocorr =       1.253307917849
              std dev =       0.598148145784
             le_variance =       0.357781204304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422954610
  error estimate for blocks of size 2^( 2) =       0.000435635421
  error estimate for blocks of size 2^( 3) =       0.000448342430
  error estimate for blocks of size 2^( 4) =       0.000460561477
  error estimate for blocks of size 2^( 5) =       0.000471139127
  error estimate for blocks of size 2^( 6) =       0.000477674031
  error estimate for blocks of size 2^( 7) =       0.000484637015

      target function =                  N/A
              le_mean =     -16.906597125460
             les_mean =     286.190807388035
             stat err =       0.000473502912
             autocorr =       1.253307917849
              std dev =       0.598148145784
             le_variance =       0.357781204304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357812248461
                                         uncertainty =       0.011608141629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422954610
  error estimate for blocks of size 2^( 2) =       0.000435635421
  error estimate for blocks of size 2^( 3) =       0.000448342430
  error estimate for blocks of size 2^( 4) =       0.000460561477
  error estimate for blocks of size 2^( 5) =       0.000471139127
  error estimate for blocks of size 2^( 6) =       0.000477674031
  error estimate for blocks of size 2^( 7) =       0.000484637015

      target function =                  N/A
              le_mean =     -16.906597125460
             les_mean =     286.190807388035
             stat err =       0.000473502912
             autocorr =       1.253307917849
              std dev =       0.598148145784
             le_variance =       0.357781204304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906597125460        initial  <--
     1.4901e+16     1.4901e+17             0.0000e+00       -16.906597125460
     5.9605e+16     5.9605e+17             0.0000e+00       -16.906597125460
     2.3842e+17     2.3842e+18             0.0000e+00       -16.906597125460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7270
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.295278
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336520143911
                                         uncertainty =       0.002856786838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336520143911
                                         uncertainty =       0.002856786838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410207551
  error estimate for blocks of size 2^( 2) =       0.000422647277
  error estimate for blocks of size 2^( 3) =       0.000435308943
  error estimate for blocks of size 2^( 4) =       0.000447467872
  error estimate for blocks of size 2^( 5) =       0.000457687869
  error estimate for blocks of size 2^( 6) =       0.000464619157
  error estimate for blocks of size 2^( 7) =       0.000468481338

      target function =                  N/A
              le_mean =     -16.906195925970
             les_mean =     286.156000989526
             stat err =       0.000459564059
             autocorr =       1.255118732977
              std dev =       0.580121082616
             le_variance =       0.336540470495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619592597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+17, overlap shift 1.4901e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195925970       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195925970       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195925970       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906195925968       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+17 is 3.634159e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195925970       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195925970       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195925970       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+17 is 9.085398e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195925970       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195925970       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195925970       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906195925971       residual = 5.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 2.271350e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.575771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5900e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.260595
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.0000e+06
  Execution time = 1.9018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390263
  error estimate for blocks of size 2^( 2) =       0.000421578605
  error estimate for blocks of size 2^( 3) =       0.000435207338
  error estimate for blocks of size 2^( 4) =       0.000447650989
  error estimate for blocks of size 2^( 5) =       0.000459875647
  error estimate for blocks of size 2^( 6) =       0.000469016485
  error estimate for blocks of size 2^( 7) =       0.000477323658

      target function =                  N/A
              le_mean =     -16.907053014394
             les_mean =     286.182006678177
             stat err =       0.000463466695
             autocorr =       1.287912338658
              std dev =       0.577551048345
             le_variance =       0.333565213444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390263
  error estimate for blocks of size 2^( 2) =       0.000421578605
  error estimate for blocks of size 2^( 3) =       0.000435207338
  error estimate for blocks of size 2^( 4) =       0.000447650989
  error estimate for blocks of size 2^( 5) =       0.000459875647
  error estimate for blocks of size 2^( 6) =       0.000469016485
  error estimate for blocks of size 2^( 7) =       0.000477323658

      target function =                  N/A
              le_mean =     -16.907053014394
             les_mean =     286.182006678177
             stat err =       0.000463466695
             autocorr =       1.287912338658
              std dev =       0.577551048345
             le_variance =       0.333565213444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390263
  error estimate for blocks of size 2^( 2) =       0.000421578605
  error estimate for blocks of size 2^( 3) =       0.000435207338
  error estimate for blocks of size 2^( 4) =       0.000447650989
  error estimate for blocks of size 2^( 5) =       0.000459875647
  error estimate for blocks of size 2^( 6) =       0.000469016485
  error estimate for blocks of size 2^( 7) =       0.000477323658

      target function =                  N/A
              le_mean =     -16.907053014394
             les_mean =     286.182006678177
             stat err =       0.000463466695
             autocorr =       1.287912338658
              std dev =       0.577551048345
             le_variance =       0.333565213444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333667218199
                                         uncertainty =       0.002896206907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390263
  error estimate for blocks of size 2^( 2) =       0.000421578605
  error estimate for blocks of size 2^( 3) =       0.000435207338
  error estimate for blocks of size 2^( 4) =       0.000447650989
  error estimate for blocks of size 2^( 5) =       0.000459875647
  error estimate for blocks of size 2^( 6) =       0.000469016485
  error estimate for blocks of size 2^( 7) =       0.000477323658

      target function =                  N/A
              le_mean =     -16.907053014394
             les_mean =     286.182006678177
             stat err =       0.000463466695
             autocorr =       1.287912338658
              std dev =       0.577551048345
             le_variance =       0.333565213444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907053014394        initial  <--
     1.4901e+17     1.4901e+18             3.6342e-22       -16.907053014394
     5.9605e+17     5.9605e+18             9.0854e-23       -16.907053014394
     2.3842e+18     2.3842e+19             2.2713e-23       -16.907053014394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5593
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.307383
====================================================
  Execution time = 2.0449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346044087210
                                         uncertainty =       0.006021083633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346044087210
                                         uncertainty =       0.006021083633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415938037
  error estimate for blocks of size 2^( 2) =       0.000433497368
  error estimate for blocks of size 2^( 3) =       0.000455355296
  error estimate for blocks of size 2^( 4) =       0.000484576666
  error estimate for blocks of size 2^( 5) =       0.000527110962
  error estimate for blocks of size 2^( 6) =       0.000588912638
  error estimate for blocks of size 2^( 7) =       0.000692033726

      target function =                  N/A
              le_mean =     -16.907325488402
             les_mean =     286.203663898725
             stat err =       0.000573158498
             autocorr =       1.898856723117
              std dev =       0.588225212799
             le_variance =       0.346008900973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690732548840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+18, overlap shift 1.4901e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907325488402       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+18 is 6.870844e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907325488402       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.576914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5956e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9926
    reference variance = 0.417186
====================================================
  Execution time = 2.1893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3673e-01
  Total weights = 2.0000e+06
  Execution time = 2.0811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410321462
  error estimate for blocks of size 2^( 2) =       0.000423194416
  error estimate for blocks of size 2^( 3) =       0.000436000570
  error estimate for blocks of size 2^( 4) =       0.000447754120
  error estimate for blocks of size 2^( 5) =       0.000458024449
  error estimate for blocks of size 2^( 6) =       0.000465668662
  error estimate for blocks of size 2^( 7) =       0.000468734497

      target function =                  N/A
              le_mean =     -16.906458330020
             les_mean =     286.165060501031
             stat err =       0.000460045432
             autocorr =       1.257051230843
              std dev =       0.580282176791
             le_variance =       0.336727404701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410321462
  error estimate for blocks of size 2^( 2) =       0.000423194416
  error estimate for blocks of size 2^( 3) =       0.000436000570
  error estimate for blocks of size 2^( 4) =       0.000447754120
  error estimate for blocks of size 2^( 5) =       0.000458024449
  error estimate for blocks of size 2^( 6) =       0.000465668662
  error estimate for blocks of size 2^( 7) =       0.000468734497

      target function =                  N/A
              le_mean =     -16.906458330020
             les_mean =     286.165060501031
             stat err =       0.000460045432
             autocorr =       1.257051230843
              std dev =       0.580282176791
             le_variance =       0.336727404701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410321462
  error estimate for blocks of size 2^( 2) =       0.000423194416
  error estimate for blocks of size 2^( 3) =       0.000436000570
  error estimate for blocks of size 2^( 4) =       0.000447754120
  error estimate for blocks of size 2^( 5) =       0.000458024449
  error estimate for blocks of size 2^( 6) =       0.000465668662
  error estimate for blocks of size 2^( 7) =       0.000468734497

      target function =                  N/A
              le_mean =     -16.906458330020
             les_mean =     286.165060501031
             stat err =       0.000460045432
             autocorr =       1.257051230843
              std dev =       0.580282176791
             le_variance =       0.336727404701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668596252
                                         uncertainty =       0.002703503391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410321462
  error estimate for blocks of size 2^( 2) =       0.000423194416
  error estimate for blocks of size 2^( 3) =       0.000436000570
  error estimate for blocks of size 2^( 4) =       0.000447754120
  error estimate for blocks of size 2^( 5) =       0.000458024449
  error estimate for blocks of size 2^( 6) =       0.000465668662
  error estimate for blocks of size 2^( 7) =       0.000468734497

      target function =                  N/A
              le_mean =     -16.906458330020
             les_mean =     286.165060501031
             stat err =       0.000460045432
             autocorr =       1.257051230843
              std dev =       0.580282176791
             le_variance =       0.336727404701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906458330020        initial  <--
     1.4901e+18     1.4901e+19             6.8708e-23       -16.906458330020
     5.9605e+18     5.9605e+19             0.0000e+00       -16.906458330020
     2.3842e+19     2.3842e+20             0.0000e+00       -16.906458330020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6038
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.963
    reference variance = 0.207855
====================================================
  Execution time = 2.0258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352751590889
                                         uncertainty =       0.014696559253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352751590889
                                         uncertainty =       0.014696559253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420038140
  error estimate for blocks of size 2^( 2) =       0.000432330447
  error estimate for blocks of size 2^( 3) =       0.000445244915
  error estimate for blocks of size 2^( 4) =       0.000457475485
  error estimate for blocks of size 2^( 5) =       0.000468138692
  error estimate for blocks of size 2^( 6) =       0.000475993043
  error estimate for blocks of size 2^( 7) =       0.000481385094

      target function =                  N/A
              le_mean =     -16.906035455232
             les_mean =     286.166898715593
             stat err =       0.000470748079
             autocorr =       1.256028975965
              std dev =       0.594023634614
             le_variance =       0.352864078480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603545523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+19, overlap shift 1.4901e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035455232       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.577968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5889e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.32867
====================================================
  Execution time = 1.9937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3613e-01
  Total weights = 2.0000e+06
  Execution time = 1.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955377
  error estimate for blocks of size 2^( 2) =       0.000422784266
  error estimate for blocks of size 2^( 3) =       0.000435604103
  error estimate for blocks of size 2^( 4) =       0.000447614089
  error estimate for blocks of size 2^( 5) =       0.000459023518
  error estimate for blocks of size 2^( 6) =       0.000466726427
  error estimate for blocks of size 2^( 7) =       0.000470926726

      target function =                  N/A
              le_mean =     -16.906091511554
             les_mean =     286.152056851399
             stat err =       0.000461072690
             autocorr =       1.264927468900
              std dev =       0.579764454264
             le_variance =       0.336126822428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955377
  error estimate for blocks of size 2^( 2) =       0.000422784266
  error estimate for blocks of size 2^( 3) =       0.000435604103
  error estimate for blocks of size 2^( 4) =       0.000447614089
  error estimate for blocks of size 2^( 5) =       0.000459023518
  error estimate for blocks of size 2^( 6) =       0.000466726427
  error estimate for blocks of size 2^( 7) =       0.000470926726

      target function =                  N/A
              le_mean =     -16.906091511554
             les_mean =     286.152056851399
             stat err =       0.000461072690
             autocorr =       1.264927468900
              std dev =       0.579764454264
             le_variance =       0.336126822428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955377
  error estimate for blocks of size 2^( 2) =       0.000422784266
  error estimate for blocks of size 2^( 3) =       0.000435604103
  error estimate for blocks of size 2^( 4) =       0.000447614089
  error estimate for blocks of size 2^( 5) =       0.000459023518
  error estimate for blocks of size 2^( 6) =       0.000466726427
  error estimate for blocks of size 2^( 7) =       0.000470926726

      target function =                  N/A
              le_mean =     -16.906091511554
             les_mean =     286.152056851399
             stat err =       0.000461072690
             autocorr =       1.264927468900
              std dev =       0.579764454264
             le_variance =       0.336126822428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336163833230
                                         uncertainty =       0.003952807811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409955377
  error estimate for blocks of size 2^( 2) =       0.000422784266
  error estimate for blocks of size 2^( 3) =       0.000435604103
  error estimate for blocks of size 2^( 4) =       0.000447614089
  error estimate for blocks of size 2^( 5) =       0.000459023518
  error estimate for blocks of size 2^( 6) =       0.000466726427
  error estimate for blocks of size 2^( 7) =       0.000470926726

      target function =                  N/A
              le_mean =     -16.906091511554
             les_mean =     286.152056851399
             stat err =       0.000461072690
             autocorr =       1.264927468900
              std dev =       0.579764454264
             le_variance =       0.336126822428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906091511554        initial  <--
     1.4901e+19     1.4901e+20             0.0000e+00       -16.906091511554
     5.9605e+19     5.9605e+20             0.0000e+00       -16.906091511554
     2.3842e+20     2.3842e+21             0.0000e+00       -16.906091511554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3532
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093897e-01 1 1  ON 0
 uu_1                 1.426949e-01 1 1  ON 1
 uu_2                 4.116452e-02 1 1  ON 2
 uu_3                -2.105986e-02 1 1  ON 3
 uu_4                -6.594210e-02 1 1  ON 4
 uu_5                -1.001285e-01 1 1  ON 5
 uu_6                -1.268130e-01 1 1  ON 6
 uu_7                -1.397879e-01 1 1  ON 7
 uu_8                -1.320753e-01 1 1  ON 8
 uu_9                -1.018918e-01 1 1  ON 9
 ud_0                 4.495834e-01 1 1  ON 10
 ud_1                 1.832527e-01 1 1  ON 11
 ud_2                 6.186281e-02 1 1  ON 12
 ud_3                -9.987698e-03 1 1  ON 13
 ud_4                -6.697310e-02 1 1  ON 14
 ud_5                -1.082638e-01 1 1  ON 15
 ud_6                -1.352595e-01 1 1  ON 16
 ud_7                -1.512209e-01 1 1  ON 17
 ud_8                -1.512214e-01 1 1  ON 18
 ud_9                -1.402193e-01 1 1  ON 19
 eO_0                -7.657036e-01 1 1  ON 20
 eO_1                -4.432280e-01 1 1  ON 21
 eO_2                -2.013322e-02 1 1  ON 22
 eO_3                 3.024883e-01 1 1  ON 23
 eO_4                 5.274380e-01 1 1  ON 24
 eO_5                 4.867845e-01 1 1  ON 25
 eO_6                 2.562433e-01 1 1  ON 26
 eO_7                -4.645302e-02 1 1  ON 27
 eO_8                -2.193471e-01 1 1  ON 28
 eO_9                -7.815238e-02 1 1  ON 29
eH1_0                -2.433126e-01 1 1  ON 30
eH1_1                -1.428303e-01 1 1  ON 31
eH1_2                -9.588572e-02 1 1  ON 32
eH1_3                -4.192951e-02 1 1  ON 33
eH1_4                 5.791022e-03 1 1  ON 34
eH1_5                 4.058011e-02 1 1  ON 35
eH1_6                 9.791532e-02 1 1  ON 36
eH1_7                 1.510336e-01 1 1  ON 37
eH1_8                 1.737557e-01 1 1  ON 38
eH1_9                 5.895928e-02 1 1  ON 39
eH2_0                -2.388134e-01 1 1  ON 40
eH2_1                -1.389753e-01 1 1  ON 41
eH2_2                -9.213665e-02 1 1  ON 42
eH2_3                -3.793524e-02 1 1  ON 43
eH2_4                 9.853838e-03 1 1  ON 44
eH2_5                 4.294163e-02 1 1  ON 45
eH2_6                 9.879544e-02 1 1  ON 46
eH2_7                 1.505162e-01 1 1  ON 47
eH2_8                 1.766670e-01 1 1  ON 48
eH2_9                 4.638256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5248e+01 secs
  Total Execution time = 2.2754e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
