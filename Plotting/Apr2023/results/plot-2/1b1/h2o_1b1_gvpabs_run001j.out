Rank =    0  Free Memory = 88433 MB
Rank =    1  Free Memory = 88433 MB
Rank =    2  Free Memory = 88433 MB
Rank =    3  Free Memory = 88433 MB
Rank =    4  Free Memory = 88433 MB
Rank =    5  Free Memory = 88433 MB
Rank =    6  Free Memory = 88433 MB
Rank =    7  Free Memory = 88433 MB
Rank =    8  Free Memory = 88433 MB
Rank =    9  Free Memory = 88433 MB
Rank =   10  Free Memory = 88433 MB
Rank =   11  Free Memory = 88433 MB
Rank =   12  Free Memory = 88433 MB
Rank =   13  Free Memory = 88433 MB
Rank =   14  Free Memory = 88433 MB
Rank =   15  Free Memory = 88421 MB
Rank =   16  Free Memory = 88421 MB
Rank =   17  Free Memory = 88421 MB
Rank =   18  Free Memory = 88421 MB
Rank =   19  Free Memory = 88421 MB
Rank =   20  Free Memory = 88421 MB
Rank =   21  Free Memory = 88420 MB
Rank =   22  Free Memory = 88420 MB
Rank =   23  Free Memory = 88420 MB
Rank =   24  Free Memory = 88420 MB
Rank =   25  Free Memory = 88420 MB
Rank =   26  Free Memory = 88420 MB
Rank =   27  Free Memory = 88420 MB
Rank =   28  Free Memory = 88420 MB
Rank =   29  Free Memory = 88420 MB
Rank =   30  Free Memory = 88420 MB
Rank =   31  Free Memory = 88420 MB
Rank =   32  Free Memory = 88553 MB
Rank =   33  Free Memory = 88553 MB
Rank =   34  Free Memory = 88553 MB
Rank =   35  Free Memory = 88553 MB
Rank =   36  Free Memory = 88553 MB
Rank =   37  Free Memory = 88553 MB
Rank =   38  Free Memory = 88553 MB
Rank =   39  Free Memory = 88553 MB
Rank =   40  Free Memory = 88553 MB
Rank =   41  Free Memory = 88553 MB
Rank =   42  Free Memory = 88553 MB
Rank =   43  Free Memory = 88553 MB
Rank =   44  Free Memory = 88552 MB
Rank =   45  Free Memory = 88552 MB
Rank =   46  Free Memory = 88552 MB
Rank =   47  Free Memory = 88552 MB
Rank =   48  Free Memory = 88552 MB
Rank =   49  Free Memory = 88552 MB
Rank =   50  Free Memory = 88552 MB
Rank =   51  Free Memory = 88552 MB
Rank =   52  Free Memory = 88552 MB
Rank =   53  Free Memory = 88552 MB
Rank =   54  Free Memory = 88552 MB
Rank =   55  Free Memory = 88552 MB
Rank =   56  Free Memory = 88552 MB
Rank =   57  Free Memory = 88552 MB
Rank =   58  Free Memory = 88552 MB
Rank =   59  Free Memory = 88552 MB
Rank =   60  Free Memory = 88552 MB
Rank =   61  Free Memory = 88552 MB
Rank =   62  Free Memory = 88552 MB
Rank =   63  Free Memory = 88552 MB
Rank =   64  Free Memory = 87243 MB
Rank =   65  Free Memory = 87243 MB
Rank =   66  Free Memory = 87243 MB
Rank =   67  Free Memory = 87243 MB
Rank =   68  Free Memory = 87243 MB
Rank =   69  Free Memory = 87243 MB
Rank =   70  Free Memory = 87243 MB
Rank =   71  Free Memory = 87243 MB
Rank =   72  Free Memory = 87243 MB
Rank =   73  Free Memory = 87242 MB
Rank =   74  Free Memory = 87242 MB
Rank =   75  Free Memory = 87242 MB
Rank =   76  Free Memory = 87242 MB
Rank =   77  Free Memory = 87242 MB
Rank =   78  Free Memory = 87242 MB
Rank =   79  Free Memory = 87242 MB
Rank =   80  Free Memory = 87242 MB
Rank =   81  Free Memory = 87242 MB
Rank =   82  Free Memory = 87242 MB
Rank =   83  Free Memory = 87242 MB
Rank =   84  Free Memory = 87242 MB
Rank =   85  Free Memory = 87242 MB
Rank =   86  Free Memory = 87242 MB
Rank =   87  Free Memory = 87242 MB
Rank =   88  Free Memory = 87242 MB
Rank =   89  Free Memory = 87242 MB
Rank =   90  Free Memory = 87242 MB
Rank =   91  Free Memory = 87242 MB
Rank =   92  Free Memory = 87242 MB
Rank =   93  Free Memory = 87242 MB
Rank =   94  Free Memory = 87242 MB
Rank =   95  Free Memory = 87242 MB
Rank =   96  Free Memory = 91011 MB
Rank =   97  Free Memory = 91011 MB
Rank =   98  Free Memory = 91011 MB
Rank =   99  Free Memory = 91011 MB
Rank =  100  Free Memory = 91011 MB
Rank =  101  Free Memory = 91011 MB
Rank =  102  Free Memory = 91011 MB
Rank =  103  Free Memory = 91011 MB
Rank =  104  Free Memory = 91011 MB
Rank =  105  Free Memory = 91011 MB
Rank =  106  Free Memory = 91011 MB
Rank =  107  Free Memory = 91011 MB
Rank =  108  Free Memory = 91011 MB
Rank =  109  Free Memory = 91011 MB
Rank =  110  Free Memory = 91011 MB
Rank =  111  Free Memory = 91011 MB
Rank =  112  Free Memory = 91011 MB
Rank =  113  Free Memory = 91011 MB
Rank =  114  Free Memory = 91011 MB
Rank =  115  Free Memory = 91011 MB
Rank =  116  Free Memory = 91011 MB
Rank =  117  Free Memory = 91011 MB
Rank =  118  Free Memory = 91011 MB
Rank =  119  Free Memory = 91011 MB
Rank =  120  Free Memory = 91011 MB
Rank =  121  Free Memory = 91011 MB
Rank =  122  Free Memory = 91011 MB
Rank =  123  Free Memory = 91011 MB
Rank =  124  Free Memory = 91011 MB
Rank =  125  Free Memory = 91011 MB
Rank =  126  Free Memory = 91011 MB
Rank =  127  Free Memory = 91011 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001j.xml

  Project = H2O
  date    = 2023-04-02 10:38:55 PDT
  host    = n0020.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 431

  Range of prime numbers to use as seeds over processors and threads = 3019-4073


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.091882e-01    1         1  ON     0
     uu_1                 1.424756e-01    1         1  ON     1
     uu_2                 4.098565e-02    1         1  ON     2
     uu_3                -2.132497e-02    1         1  ON     3
     uu_4                -6.660016e-02    1         1  ON     4
     uu_5                -1.013739e-01    1         1  ON     5
     uu_6                -1.283791e-01    1         1  ON     6
     uu_7                -1.414692e-01    1         1  ON     7
     uu_8                -1.334578e-01    1         1  ON     8
     uu_9                -1.050591e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.477293e-01    1         1  ON     0
     ud_1                 1.824639e-01    1         1  ON     1
     ud_2                 6.291332e-02    1         1  ON     2
     ud_3                -7.587006e-03    1         1  ON     3
     ud_4                -6.482290e-02    1         1  ON     4
     ud_5                -1.069225e-01    1         1  ON     5
     ud_6                -1.349526e-01    1         1  ON     6
     ud_7                -1.520023e-01    1         1  ON     7
     ud_8                -1.529484e-01    1         1  ON     8
     ud_9                -1.433847e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.600895e-01    1         1  ON     0
     eO_1                -4.399389e-01    1         1  ON     1
     eO_2                -2.169448e-02    1         1  ON     2
     eO_3                 2.987002e-01    1         1  ON     3
     eO_4                 5.254014e-01    1         1  ON     4
     eO_5                 4.877411e-01    1         1  ON     5
     eO_6                 2.599543e-01    1         1  ON     6
     eO_7                -4.072154e-02    1         1  ON     7
     eO_8                -2.214374e-01    1         1  ON     8
     eO_9                -8.650635e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.446292e-01    1         1  ON     0
     eH1_1                -1.452581e-01    1         1  ON     1
     eH1_2                -9.858415e-02    1         1  ON     2
     eH1_3                -4.483527e-02    1         1  ON     3
     eH1_4                 3.337486e-03    1         1  ON     4
     eH1_5                 3.810846e-02    1         1  ON     5
     eH1_6                 9.659622e-02    1         1  ON     6
     eH1_7                 1.541040e-01    1         1  ON     7
     eH1_8                 1.772383e-01    1         1  ON     8
     eH1_9                 6.793013e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.423306e-01    1         1  ON     0
     eH2_1                -1.429476e-01    1         1  ON     1
     eH2_2                -9.645385e-02    1         1  ON     2
     eH2_3                -4.248615e-02    1         1  ON     3
     eH2_4                 5.559886e-03    1         1  ON     4
     eH2_5                 4.021241e-02    1         1  ON     5
     eH2_6                 9.947929e-02    1         1  ON     6
     eH2_7                 1.552573e-01    1         1  ON     7
     eH2_8                 1.827555e-01    1         1  ON     8
     eH2_9                 5.749579e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 6.920388e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.3922e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9431
    reference variance = 0.359142
====================================================
  Execution time = 2.1308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343203219138
                                         uncertainty =       0.006186345666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343203219138
                                         uncertainty =       0.006186345666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414233860
  error estimate for blocks of size 2^( 2) =       0.000427017419
  error estimate for blocks of size 2^( 3) =       0.000440936049
  error estimate for blocks of size 2^( 4) =       0.000453655939
  error estimate for blocks of size 2^( 5) =       0.000464925695
  error estimate for blocks of size 2^( 6) =       0.000473141461
  error estimate for blocks of size 2^( 7) =       0.000476698532

      target function =                  N/A
              le_mean =     -16.905255795143
             les_mean =     286.130852709723
             stat err =       0.000467105407
             autocorr =       1.271565089950
              std dev =       0.585815143282
             le_variance =       0.343179382099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690525579514e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905255795143       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905257666327       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905261993890       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905263908432       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905262700820       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905263673830       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905263926204       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905263745673       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905263360435       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905263284727       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905263400135       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.194334e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905255795143       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905256486029       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905258611367       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905258501796       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905258538770       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905258699951       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905258857150       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905258767377       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.335613e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905255795143       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905255991245       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905256544633       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905256620780       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905256602497       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905256616558       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905256676756       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905256663682       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 8.529662e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6950e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.092931e-01                 1 1 ON  0
uu_1  1.425369e-01                 1 1 ON  1
uu_2  4.103000e-02                 1 1 ON  2
uu_3  -2.138498e-02                1 1 ON  3
uu_4  -6.668601e-02                1 1 ON  4
uu_5  -1.013664e-01                1 1 ON  5
uu_6  -1.284738e-01                1 1 ON  6
uu_7  -1.415897e-01                1 1 ON  7
uu_8  -1.334892e-01                1 1 ON  8
uu_9  -1.050353e-01                1 1 ON  9
ud_0  4.480214e-01                 1 1 ON  10
ud_1  1.825962e-01                 1 1 ON  11
ud_2  6.289932e-02                 1 1 ON  12
ud_3  -7.736856e-03                1 1 ON  13
ud_4  -6.489851e-02                1 1 ON  14
ud_5  -1.070806e-01                1 1 ON  15
ud_6  -1.349356e-01                1 1 ON  16
ud_7  -1.520759e-01                1 1 ON  17
ud_8  -1.529385e-01                1 1 ON  18
ud_9  -1.433473e-01                1 1 ON  19
eO_0  -7.601806e-01                1 1 ON  20
eO_1  -4.398739e-01                1 1 ON  21
eO_2  -2.160937e-02                1 1 ON  22
eO_3  2.986670e-01                 1 1 ON  23
eO_4  5.255284e-01                 1 1 ON  24
eO_5  4.877691e-01                 1 1 ON  25
eO_6  2.599587e-01                 1 1 ON  26
eO_7  -4.071577e-02                1 1 ON  27
eO_8  -2.215188e-01                1 1 ON  28
eO_9  -8.660217e-02                1 1 ON  29
eH1_0 -2.449418e-01                1 1 ON  30
eH1_1 -1.453769e-01                1 1 ON  31
eH1_2 -9.871376e-02                1 1 ON  32
eH1_3 -4.476054e-02                1 1 ON  33
eH1_4 3.414550e-03                 1 1 ON  34
eH1_5 3.813496e-02                 1 1 ON  35
eH1_6 9.665528e-02                 1 1 ON  36
eH1_7 1.541552e-01                 1 1 ON  37
eH1_8 1.773518e-01                 1 1 ON  38
eH1_9 6.808658e-02                 1 1 ON  39
eH2_0 -2.426642e-01                1 1 ON  40
eH2_1 -1.431175e-01                1 1 ON  41
eH2_2 -9.639029e-02                1 1 ON  42
eH2_3 -4.249363e-02                1 1 ON  43
eH2_4 5.737444e-03                 1 1 ON  44
eH2_5 4.027692e-02                 1 1 ON  45
eH2_6 9.945716e-02                 1 1 ON  46
eH2_7 1.551885e-01                 1 1 ON  47
eH2_8 1.828542e-01                 1 1 ON  48
eH2_9 5.767041e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8597
    reference variance = 0.361379
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3901e-01
  Total weights = 2.0000e+06
  Execution time = 1.8689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338841986814
                                         uncertainty =       0.004240452237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338841986814
                                         uncertainty =       0.004240452237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411559449
  error estimate for blocks of size 2^( 2) =       0.000424108472
  error estimate for blocks of size 2^( 3) =       0.000437306242
  error estimate for blocks of size 2^( 4) =       0.000449118186
  error estimate for blocks of size 2^( 5) =       0.000458759415
  error estimate for blocks of size 2^( 6) =       0.000467015717
  error estimate for blocks of size 2^( 7) =       0.000470823935

      target function =                  N/A
              le_mean =     -16.905321559236
             les_mean =     286.128659211851
             stat err =       0.000461429313
             autocorr =       1.257028738967
              std dev =       0.582032954449
             le_variance =       0.338762360065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339484318121
                                         uncertainty =       0.004247062705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339484318121
                                         uncertainty =       0.004247062705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411949166
  error estimate for blocks of size 2^( 2) =       0.000424468390
  error estimate for blocks of size 2^( 3) =       0.000437632450
  error estimate for blocks of size 2^( 4) =       0.000449421371
  error estimate for blocks of size 2^( 5) =       0.000459060545
  error estimate for blocks of size 2^( 6) =       0.000467323869
  error estimate for blocks of size 2^( 7) =       0.000471145909

      target function =                  N/A
              le_mean =     -16.905320594175
             les_mean =     286.129268453634
             stat err =       0.000461737923
             autocorr =       1.256330298506
              std dev =       0.582584098220
             le_variance =       0.339404231499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338995603
                                         uncertainty =       0.004245695658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338995603
                                         uncertainty =       0.004245695658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411861028
  error estimate for blocks of size 2^( 2) =       0.000424387004
  error estimate for blocks of size 2^( 3) =       0.000437558711
  error estimate for blocks of size 2^( 4) =       0.000449352230
  error estimate for blocks of size 2^( 5) =       0.000458991162
  error estimate for blocks of size 2^( 6) =       0.000467251150
  error estimate for blocks of size 2^( 7) =       0.000471067157

      target function =                  N/A
              le_mean =     -16.905320026339
             les_mean =     286.129104036624
             stat err =       0.000461665425
             autocorr =       1.256473408916
              std dev =       0.582459452068
             le_variance =       0.339259013303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338913492351
                                         uncertainty =       0.004241215287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338913492351
                                         uncertainty =       0.004241215287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602851
  error estimate for blocks of size 2^( 2) =       0.000424148440
  error estimate for blocks of size 2^( 3) =       0.000437342369
  error estimate for blocks of size 2^( 4) =       0.000449151532
  error estimate for blocks of size 2^( 5) =       0.000458792330
  error estimate for blocks of size 2^( 6) =       0.000467049124
  error estimate for blocks of size 2^( 7) =       0.000470858258

      target function =                  N/A
              le_mean =     -16.905321118139
             les_mean =     286.128715751612
             stat err =       0.000461462811
             autocorr =       1.256946132007
              std dev =       0.582094333968
             le_variance =       0.338833813637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905321559236        initial  <--
     2.5000e-01     2.5000e+00             1.1943e-03       -16.905320594175
     1.0000e+00     1.0000e+01             3.3356e-04       -16.905320026339
     4.0000e+00     4.0000e+01             8.5297e-05       -16.905321118139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1031
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587006e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.317729
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339246197172
                                         uncertainty =       0.003043886961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339246197172
                                         uncertainty =       0.003043886961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411814649
  error estimate for blocks of size 2^( 2) =       0.000424459807
  error estimate for blocks of size 2^( 3) =       0.000437398125
  error estimate for blocks of size 2^( 4) =       0.000449820737
  error estimate for blocks of size 2^( 5) =       0.000460885910
  error estimate for blocks of size 2^( 6) =       0.000469431210
  error estimate for blocks of size 2^( 7) =       0.000474353229

      target function =                  N/A
              le_mean =     -16.906685359999
             les_mean =     286.175192302455
             stat err =       0.000463622771
             autocorr =       1.267435697861
              std dev =       0.582393861614
             le_variance =       0.339182610045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668536000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906685359999       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906687051571       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906687105730       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906687068181       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906687041305       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906687035266       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906687184550       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906687135074       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.175288e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906685359999       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906685804766       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906685817310       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906685809389       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906685802156       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906685796094       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906685831917       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906685820928       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.979301e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906685359999       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906685472647       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906685475730       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906685473859       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906685472024       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906685470183       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906685478988       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906685476358       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 7.475084e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8193e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.092024e-01 1 1  ON 0
 uu_1                 1.424742e-01 1 1  ON 1
 uu_2                 4.099157e-02 1 1  ON 2
 uu_3                -2.132246e-02 1 1  ON 3
 uu_4                -6.660449e-02 1 1  ON 4
 uu_5                -1.013707e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.414962e-01 1 1  ON 7
 uu_8                -1.334624e-01 1 1  ON 8
 uu_9                -1.050589e-01 1 1  ON 9
 ud_0                 4.477566e-01 1 1  ON 10
 ud_1                 1.824847e-01 1 1  ON 11
 ud_2                 6.291498e-02 1 1  ON 12
 ud_3                -7.597634e-03 1 1  ON 13
 ud_4                -6.483455e-02 1 1  ON 14
 ud_5                -1.069325e-01 1 1  ON 15
 ud_6                -1.349551e-01 1 1  ON 16
 ud_7                -1.520114e-01 1 1  ON 17
 ud_8                -1.529503e-01 1 1  ON 18
 ud_9                -1.433853e-01 1 1  ON 19
 eO_0                -7.600981e-01 1 1  ON 20
 eO_1                -4.399198e-01 1 1  ON 21
 eO_2                -2.169584e-02 1 1  ON 22
 eO_3                 2.987037e-01 1 1  ON 23
 eO_4                 5.254136e-01 1 1  ON 24
 eO_5                 4.877403e-01 1 1  ON 25
 eO_6                 2.599496e-01 1 1  ON 26
 eO_7                -4.071882e-02 1 1  ON 27
 eO_8                -2.214463e-01 1 1  ON 28
 eO_9                -8.651816e-02 1 1  ON 29
eH1_0                -2.446590e-01 1 1  ON 30
eH1_1                -1.452696e-01 1 1  ON 31
eH1_2                -9.857982e-02 1 1  ON 32
eH1_3                -4.483423e-02 1 1  ON 33
eH1_4                 3.347163e-03 1 1  ON 34
eH1_5                 3.810294e-02 1 1  ON 35
eH1_6                 9.659761e-02 1 1  ON 36
eH1_7                 1.541108e-01 1 1  ON 37
eH1_8                 1.772482e-01 1 1  ON 38
eH1_9                 6.794387e-02 1 1  ON 39
eH2_0                -2.423528e-01 1 1  ON 40
eH2_1                -1.429548e-01 1 1  ON 41
eH2_2                -9.646489e-02 1 1  ON 42
eH2_3                -4.248480e-02 1 1  ON 43
eH2_4                 5.562895e-03 1 1  ON 44
eH2_5                 4.021752e-02 1 1  ON 45
eH2_6                 9.946867e-02 1 1  ON 46
eH2_7                 1.552560e-01 1 1  ON 47
eH2_8                 1.827685e-01 1 1  ON 48
eH2_9                 5.752154e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9307
    reference variance = 0.172392
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.0000e+06
  Execution time = 1.8709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338946329364
                                         uncertainty =       0.004000423352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338946329364
                                         uncertainty =       0.004000423352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411594312
  error estimate for blocks of size 2^( 2) =       0.000424105622
  error estimate for blocks of size 2^( 3) =       0.000437043753
  error estimate for blocks of size 2^( 4) =       0.000448326590
  error estimate for blocks of size 2^( 5) =       0.000457968793
  error estimate for blocks of size 2^( 6) =       0.000466804290
  error estimate for blocks of size 2^( 7) =       0.000472232166

      target function =                  N/A
              le_mean =     -16.905673058133
             les_mean =     286.140601134746
             stat err =       0.000461332959
             autocorr =       1.256290968254
              std dev =       0.582082258498
             le_variance =       0.338819755658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339020993833
                                         uncertainty =       0.004001245995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339020993833
                                         uncertainty =       0.004001245995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411639642
  error estimate for blocks of size 2^( 2) =       0.000424147145
  error estimate for blocks of size 2^( 3) =       0.000437080793
  error estimate for blocks of size 2^( 4) =       0.000448359858
  error estimate for blocks of size 2^( 5) =       0.000457999443
  error estimate for blocks of size 2^( 6) =       0.000466834671
  error estimate for blocks of size 2^( 7) =       0.000472263552

      target function =                  N/A
              le_mean =     -16.905673439366
             les_mean =     286.140688658072
             stat err =       0.000461364381
             autocorr =       1.256185401530
              std dev =       0.582146363921
             le_variance =       0.338894389026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338984902959
                                         uncertainty =       0.004000855159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338984902959
                                         uncertainty =       0.004000855159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411617731
  error estimate for blocks of size 2^( 2) =       0.000424127043
  error estimate for blocks of size 2^( 3) =       0.000437062812
  error estimate for blocks of size 2^( 4) =       0.000448343696
  error estimate for blocks of size 2^( 5) =       0.000457984504
  error estimate for blocks of size 2^( 6) =       0.000466819841
  error estimate for blocks of size 2^( 7) =       0.000472248189

      target function =                  N/A
              le_mean =     -16.905673257310
             les_mean =     286.140646426652
             stat err =       0.000461349058
             autocorr =       1.256235686666
              std dev =       0.582115377880
             le_variance =       0.338858313165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338951175155
                                         uncertainty =       0.004000477930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338951175155
                                         uncertainty =       0.004000477930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411597254
  error estimate for blocks of size 2^( 2) =       0.000424108310
  error estimate for blocks of size 2^( 3) =       0.000437046142
  error estimate for blocks of size 2^( 4) =       0.000448328732
  error estimate for blocks of size 2^( 5) =       0.000457970757
  error estimate for blocks of size 2^( 6) =       0.000466806233
  error estimate for blocks of size 2^( 7) =       0.000472234167

      target function =                  N/A
              le_mean =     -16.905673081687
             les_mean =     286.140606774889
             stat err =       0.000461334972
             autocorr =       1.256283971102
              std dev =       0.582086419204
             le_variance =       0.338824599422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905673058133        initial
     2.5000e+00     2.5000e+01             1.1753e-04       -16.905673439366  <--
     1.0000e+01     1.0000e+02             2.9793e-05       -16.905673257310
     4.0000e+01     4.0000e+02             7.4751e-06       -16.905673081687

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9852e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.092432e-01 1 1  ON 0
 uu_1                 1.424725e-01 1 1  ON 1
 uu_2                 4.100709e-02 1 1  ON 2
 uu_3                -2.131503e-02 1 1  ON 3
 uu_4                -6.661536e-02 1 1  ON 4
 uu_5                -1.013636e-01 1 1  ON 5
 uu_6                -1.283999e-01 1 1  ON 6
 uu_7                -1.415747e-01 1 1  ON 7
 uu_8                -1.334768e-01 1 1  ON 8
 uu_9                -1.050586e-01 1 1  ON 9
 ud_0                 4.478355e-01 1 1  ON 10
 ud_1                 1.825414e-01 1 1  ON 11
 ud_2                 6.292273e-02 1 1  ON 12
 ud_3                -7.627355e-03 1 1  ON 13
 ud_4                -6.486799e-02 1 1  ON 14
 ud_5                -1.069615e-01 1 1  ON 15
 ud_6                -1.349628e-01 1 1  ON 16
 ud_7                -1.520371e-01 1 1  ON 17
 ud_8                -1.529560e-01 1 1  ON 18
 ud_9                -1.433872e-01 1 1  ON 19
 eO_0                -7.601213e-01 1 1  ON 20
 eO_1                -4.398663e-01 1 1  ON 21
 eO_2                -2.169647e-02 1 1  ON 22
 eO_3                 2.987118e-01 1 1  ON 23
 eO_4                 5.254485e-01 1 1  ON 24
 eO_5                 4.877383e-01 1 1  ON 25
 eO_6                 2.599359e-01 1 1  ON 26
 eO_7                -4.071070e-02 1 1  ON 27
 eO_8                -2.214724e-01 1 1  ON 28
 eO_9                -8.655308e-02 1 1  ON 29
eH1_0                -2.447468e-01 1 1  ON 30
eH1_1                -1.453021e-01 1 1  ON 31
eH1_2                -9.856907e-02 1 1  ON 32
eH1_3                -4.483080e-02 1 1  ON 33
eH1_4                 3.375765e-03 1 1  ON 34
eH1_5                 3.808666e-02 1 1  ON 35
eH1_6                 9.660167e-02 1 1  ON 36
eH1_7                 1.541309e-01 1 1  ON 37
eH1_8                 1.772776e-01 1 1  ON 38
eH1_9                 6.798449e-02 1 1  ON 39
eH2_0                -2.424182e-01 1 1  ON 40
eH2_1                -1.429774e-01 1 1  ON 41
eH2_2                -9.649564e-02 1 1  ON 42
eH2_3                -4.248188e-02 1 1  ON 43
eH2_4                 5.572425e-03 1 1  ON 44
eH2_5                 4.023226e-02 1 1  ON 45
eH2_6                 9.943748e-02 1 1  ON 46
eH2_7                 1.552521e-01 1 1  ON 47
eH2_8                 1.828070e-01 1 1  ON 48
eH2_9                 5.759769e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.978
    reference variance = 1.12458
====================================================
  Execution time = 2.3024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4539e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345433352519
                                         uncertainty =       0.006957983205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345433352519
                                         uncertainty =       0.006957983205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415564753
  error estimate for blocks of size 2^( 2) =       0.000427878696
  error estimate for blocks of size 2^( 3) =       0.000441518464
  error estimate for blocks of size 2^( 4) =       0.000453584766
  error estimate for blocks of size 2^( 5) =       0.000464816994
  error estimate for blocks of size 2^( 6) =       0.000469608572
  error estimate for blocks of size 2^( 7) =       0.000475417344

      target function =                  N/A
              le_mean =     -16.906157551366
             les_mean =     286.163551106020
             stat err =       0.000465856919
             autocorr =       1.256688645164
              std dev =       0.587697309089
             le_variance =       0.345388127110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615755137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157551366       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161436580       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906159553897       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906159845046       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906159630488       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906159698444       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906159881516       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906160140586       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906160217320       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906160180072       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.318369e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157551366       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158733435       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158123724       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158115809       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158099969       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158044539       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158104152       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158169300       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906158170434       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.377823e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157551366       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157863834       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157702017       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157689621       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157685402       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157667326       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157682240       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906157697200       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.455804e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8639e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.092618e-01 1 1  ON 0
 uu_1                 1.425057e-01 1 1  ON 1
 uu_2                 4.100445e-02 1 1  ON 2
 uu_3                -2.133768e-02 1 1  ON 3
 uu_4                -6.662842e-02 1 1  ON 4
 uu_5                -1.013877e-01 1 1  ON 5
 uu_6                -1.284435e-01 1 1  ON 6
 uu_7                -1.416150e-01 1 1  ON 7
 uu_8                -1.334529e-01 1 1  ON 8
 uu_9                -1.050552e-01 1 1  ON 9
 ud_0                 4.478817e-01 1 1  ON 10
 ud_1                 1.826272e-01 1 1  ON 11
 ud_2                 6.289497e-02 1 1  ON 12
 ud_3                -7.692122e-03 1 1  ON 13
 ud_4                -6.488693e-02 1 1  ON 14
 ud_5                -1.069699e-01 1 1  ON 15
 ud_6                -1.349994e-01 1 1  ON 16
 ud_7                -1.520437e-01 1 1  ON 17
 ud_8                -1.529491e-01 1 1  ON 18
 ud_9                -1.433620e-01 1 1  ON 19
 eO_0                -7.601696e-01 1 1  ON 20
 eO_1                -4.398406e-01 1 1  ON 21
 eO_2                -2.165060e-02 1 1  ON 22
 eO_3                 2.987427e-01 1 1  ON 23
 eO_4                 5.254621e-01 1 1  ON 24
 eO_5                 4.877430e-01 1 1  ON 25
 eO_6                 2.599229e-01 1 1  ON 26
 eO_7                -4.069810e-02 1 1  ON 27
 eO_8                -2.214984e-01 1 1  ON 28
 eO_9                -8.659151e-02 1 1  ON 29
eH1_0                -2.448845e-01 1 1  ON 30
eH1_1                -1.454132e-01 1 1  ON 31
eH1_2                -9.854837e-02 1 1  ON 32
eH1_3                -4.477940e-02 1 1  ON 33
eH1_4                 3.425697e-03 1 1  ON 34
eH1_5                 3.804925e-02 1 1  ON 35
eH1_6                 9.660079e-02 1 1  ON 36
eH1_7                 1.541459e-01 1 1  ON 37
eH1_8                 1.773422e-01 1 1  ON 38
eH1_9                 6.806242e-02 1 1  ON 39
eH2_0                -2.425289e-01 1 1  ON 40
eH2_1                -1.430259e-01 1 1  ON 41
eH2_2                -9.648994e-02 1 1  ON 42
eH2_3                -4.246832e-02 1 1  ON 43
eH2_4                 5.604908e-03 1 1  ON 44
eH2_5                 4.021243e-02 1 1  ON 45
eH2_6                 9.942968e-02 1 1  ON 46
eH2_7                 1.552599e-01 1 1  ON 47
eH2_8                 1.828470e-01 1 1  ON 48
eH2_9                 5.767824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8142
    reference variance = 0.414586
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339555967244
                                         uncertainty =       0.005042193782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339555967244
                                         uncertainty =       0.005042193782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411990241
  error estimate for blocks of size 2^( 2) =       0.000424650957
  error estimate for blocks of size 2^( 3) =       0.000437584041
  error estimate for blocks of size 2^( 4) =       0.000449650323
  error estimate for blocks of size 2^( 5) =       0.000459632757
  error estimate for blocks of size 2^( 6) =       0.000467638764
  error estimate for blocks of size 2^( 7) =       0.000473662729

      target function =                  N/A
              le_mean =     -16.906120352668
             les_mean =     286.156377126685
             stat err =       0.000462646143
             autocorr =       1.261025981352
              std dev =       0.582642186521
             le_variance =       0.339471917514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339717194476
                                         uncertainty =       0.005053564451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339717194476
                                         uncertainty =       0.005053564451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412087957
  error estimate for blocks of size 2^( 2) =       0.000424738078
  error estimate for blocks of size 2^( 3) =       0.000437660842
  error estimate for blocks of size 2^( 4) =       0.000449720423
  error estimate for blocks of size 2^( 5) =       0.000459697544
  error estimate for blocks of size 2^( 6) =       0.000467702376
  error estimate for blocks of size 2^( 7) =       0.000473738711

      target function =                  N/A
              le_mean =     -16.906119321600
             les_mean =     286.156503315057
             stat err =       0.000462714764
             autocorr =       1.260801937057
              std dev =       0.582780377759
             le_variance =       0.339632968701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339635851821
                                         uncertainty =       0.005048755436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339635851821
                                         uncertainty =       0.005048755436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412038652
  error estimate for blocks of size 2^( 2) =       0.000424693063
  error estimate for blocks of size 2^( 3) =       0.000437619994
  error estimate for blocks of size 2^( 4) =       0.000449682654
  error estimate for blocks of size 2^( 5) =       0.000459662019
  error estimate for blocks of size 2^( 6) =       0.000467666511
  error estimate for blocks of size 2^( 7) =       0.000473698383

      target function =                  N/A
              le_mean =     -16.906119427430
             les_mean =     286.156425625545
             stat err =       0.000462677392
             autocorr =       1.260899994378
              std dev =       0.582710649297
             le_variance =       0.339551700804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339564227287
                                         uncertainty =       0.005043020954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339564227287
                                         uncertainty =       0.005043020954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411995246
  error estimate for blocks of size 2^( 2) =       0.000424655171
  error estimate for blocks of size 2^( 3) =       0.000437587483
  error estimate for blocks of size 2^( 4) =       0.000449653349
  error estimate for blocks of size 2^( 5) =       0.000459635389
  error estimate for blocks of size 2^( 6) =       0.000467641163
  error estimate for blocks of size 2^( 7) =       0.000473666235

      target function =                  N/A
              le_mean =     -16.906120186239
             les_mean =     286.156379747027
             stat err =       0.000462649034
             autocorr =       1.261011101560
              std dev =       0.582649264321
             le_variance =       0.339480165214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906120352668        initial  <--
     6.2500e-01     6.2500e+00             5.3184e-04       -16.906119321600
     2.5000e+00     2.5000e+01             1.3778e-04       -16.906119427430
     1.0000e+01     1.0000e+02             3.4558e-05       -16.906120186239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8841
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.092432e-01 1 1  ON 0
 uu_1                 1.424725e-01 1 1  ON 1
 uu_2                 4.100709e-02 1 1  ON 2
 uu_3                -2.131503e-02 1 1  ON 3
 uu_4                -6.661536e-02 1 1  ON 4
 uu_5                -1.013636e-01 1 1  ON 5
 uu_6                -1.283999e-01 1 1  ON 6
 uu_7                -1.415747e-01 1 1  ON 7
 uu_8                -1.334768e-01 1 1  ON 8
 uu_9                -1.050586e-01 1 1  ON 9
 ud_0                 4.478355e-01 1 1  ON 10
 ud_1                 1.825414e-01 1 1  ON 11
 ud_2                 6.292273e-02 1 1  ON 12
 ud_3                -7.627355e-03 1 1  ON 13
 ud_4                -6.486799e-02 1 1  ON 14
 ud_5                -1.069615e-01 1 1  ON 15
 ud_6                -1.349628e-01 1 1  ON 16
 ud_7                -1.520371e-01 1 1  ON 17
 ud_8                -1.529560e-01 1 1  ON 18
 ud_9                -1.433872e-01 1 1  ON 19
 eO_0                -7.601213e-01 1 1  ON 20
 eO_1                -4.398663e-01 1 1  ON 21
 eO_2                -2.169647e-02 1 1  ON 22
 eO_3                 2.987118e-01 1 1  ON 23
 eO_4                 5.254485e-01 1 1  ON 24
 eO_5                 4.877383e-01 1 1  ON 25
 eO_6                 2.599359e-01 1 1  ON 26
 eO_7                -4.071070e-02 1 1  ON 27
 eO_8                -2.214724e-01 1 1  ON 28
 eO_9                -8.655308e-02 1 1  ON 29
eH1_0                -2.447468e-01 1 1  ON 30
eH1_1                -1.453021e-01 1 1  ON 31
eH1_2                -9.856907e-02 1 1  ON 32
eH1_3                -4.483080e-02 1 1  ON 33
eH1_4                 3.375765e-03 1 1  ON 34
eH1_5                 3.808666e-02 1 1  ON 35
eH1_6                 9.660167e-02 1 1  ON 36
eH1_7                 1.541309e-01 1 1  ON 37
eH1_8                 1.772776e-01 1 1  ON 38
eH1_9                 6.798449e-02 1 1  ON 39
eH2_0                -2.424182e-01 1 1  ON 40
eH2_1                -1.429774e-01 1 1  ON 41
eH2_2                -9.649564e-02 1 1  ON 42
eH2_3                -4.248188e-02 1 1  ON 43
eH2_4                 5.572425e-03 1 1  ON 44
eH2_5                 4.023226e-02 1 1  ON 45
eH2_6                 9.943748e-02 1 1  ON 46
eH2_7                 1.552521e-01 1 1  ON 47
eH2_8                 1.828070e-01 1 1  ON 48
eH2_9                 5.759769e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.487721
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353243005129
                                         uncertainty =       0.011796023302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353243005129
                                         uncertainty =       0.011796023302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420340366
  error estimate for blocks of size 2^( 2) =       0.000433001508
  error estimate for blocks of size 2^( 3) =       0.000446337800
  error estimate for blocks of size 2^( 4) =       0.000458865887
  error estimate for blocks of size 2^( 5) =       0.000469396982
  error estimate for blocks of size 2^( 6) =       0.000477198643
  error estimate for blocks of size 2^( 7) =       0.000481910399

      target function =                  N/A
              le_mean =     -16.905988230056
             les_mean =     286.165809904927
             stat err =       0.000471842978
             autocorr =       1.260064557413
              std dev =       0.594451046610
             le_variance =       0.353372046816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598823006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988230056       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988614434       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988598857       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988671297       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988697192       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988618044       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988637718       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988645069       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.200495e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988230056       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988328376       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988323981       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988342349       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988351497       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988330627       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988334189       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988336091       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.306565e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988230056       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988254779       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988253650       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988258256       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988260713       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988255433       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988256236       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988256713       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.270409e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6325e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092450e-01 1 1  ON 0
 uu_1                 1.424762e-01 1 1  ON 1
 uu_2                 4.100808e-02 1 1  ON 2
 uu_3                -2.131738e-02 1 1  ON 3
 uu_4                -6.662021e-02 1 1  ON 4
 uu_5                -1.013622e-01 1 1  ON 5
 uu_6                -1.284027e-01 1 1  ON 6
 uu_7                -1.415797e-01 1 1  ON 7
 uu_8                -1.334804e-01 1 1  ON 8
 uu_9                -1.050569e-01 1 1  ON 9
 ud_0                 4.478446e-01 1 1  ON 10
 ud_1                 1.825476e-01 1 1  ON 11
 ud_2                 6.292266e-02 1 1  ON 12
 ud_3                -7.635427e-03 1 1  ON 13
 ud_4                -6.487199e-02 1 1  ON 14
 ud_5                -1.069614e-01 1 1  ON 15
 ud_6                -1.349631e-01 1 1  ON 16
 ud_7                -1.520419e-01 1 1  ON 17
 ud_8                -1.529586e-01 1 1  ON 18
 ud_9                -1.433856e-01 1 1  ON 19
 eO_0                -7.601278e-01 1 1  ON 20
 eO_1                -4.398677e-01 1 1  ON 21
 eO_2                -2.169302e-02 1 1  ON 22
 eO_3                 2.987153e-01 1 1  ON 23
 eO_4                 5.254556e-01 1 1  ON 24
 eO_5                 4.877403e-01 1 1  ON 25
 eO_6                 2.599358e-01 1 1  ON 26
 eO_7                -4.071200e-02 1 1  ON 27
 eO_8                -2.214752e-01 1 1  ON 28
 eO_9                -8.655673e-02 1 1  ON 29
eH1_0                -2.447563e-01 1 1  ON 30
eH1_1                -1.453050e-01 1 1  ON 31
eH1_2                -9.856856e-02 1 1  ON 32
eH1_3                -4.482993e-02 1 1  ON 33
eH1_4                 3.379092e-03 1 1  ON 34
eH1_5                 3.808517e-02 1 1  ON 35
eH1_6                 9.660403e-02 1 1  ON 36
eH1_7                 1.541265e-01 1 1  ON 37
eH1_8                 1.772800e-01 1 1  ON 38
eH1_9                 6.799194e-02 1 1  ON 39
eH2_0                -2.424313e-01 1 1  ON 40
eH2_1                -1.429809e-01 1 1  ON 41
eH2_2                -9.649400e-02 1 1  ON 42
eH2_3                -4.248129e-02 1 1  ON 43
eH2_4                 5.573076e-03 1 1  ON 44
eH2_5                 4.023195e-02 1 1  ON 45
eH2_6                 9.943316e-02 1 1  ON 46
eH2_7                 1.552534e-01 1 1  ON 47
eH2_8                 1.828121e-01 1 1  ON 48
eH2_9                 5.760789e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.196354
====================================================
  Execution time = 2.0501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4410e-01
  Total weights = 2.0000e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129784867
                                         uncertainty =       0.007095240162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129784867
                                         uncertainty =       0.007095240162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414782126
  error estimate for blocks of size 2^( 2) =       0.000427760873
  error estimate for blocks of size 2^( 3) =       0.000440599271
  error estimate for blocks of size 2^( 4) =       0.000452783557
  error estimate for blocks of size 2^( 5) =       0.000464000754
  error estimate for blocks of size 2^( 6) =       0.000472115551
  error estimate for blocks of size 2^( 7) =       0.000476949044

      target function =                  N/A
              le_mean =     -16.905496610386
             les_mean =     286.139903895924
             stat err =       0.000466462226
             autocorr =       1.264715656597
              std dev =       0.586590508093
             le_variance =       0.344088424185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344156876994
                                         uncertainty =       0.007095900587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344156876994
                                         uncertainty =       0.007095900587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414798448
  error estimate for blocks of size 2^( 2) =       0.000427775716
  error estimate for blocks of size 2^( 3) =       0.000440612320
  error estimate for blocks of size 2^( 4) =       0.000452795289
  error estimate for blocks of size 2^( 5) =       0.000464012951
  error estimate for blocks of size 2^( 6) =       0.000472127099
  error estimate for blocks of size 2^( 7) =       0.000476961153

      target function =                  N/A
              le_mean =     -16.905496408026
             les_mean =     286.139924134656
             stat err =       0.000466474123
             autocorr =       1.264680634470
              std dev =       0.586613590813
             le_variance =       0.344115504927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344143423179
                                         uncertainty =       0.007095578383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344143423179
                                         uncertainty =       0.007095578383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414790343
  error estimate for blocks of size 2^( 2) =       0.000427768338
  error estimate for blocks of size 2^( 3) =       0.000440605822
  error estimate for blocks of size 2^( 4) =       0.000452789436
  error estimate for blocks of size 2^( 5) =       0.000464006875
  error estimate for blocks of size 2^( 6) =       0.000472121339
  error estimate for blocks of size 2^( 7) =       0.000476955112

      target function =                  N/A
              le_mean =     -16.905496504990
             les_mean =     286.139913964943
             stat err =       0.000466468191
             autocorr =       1.264697891072
              std dev =       0.586602128163
             le_variance =       0.344102056766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344131491052
                                         uncertainty =       0.007095282690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344131491052
                                         uncertainty =       0.007095282690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414783154
  error estimate for blocks of size 2^( 2) =       0.000427761806
  error estimate for blocks of size 2^( 3) =       0.000440600090
  error estimate for blocks of size 2^( 4) =       0.000452784291
  error estimate for blocks of size 2^( 5) =       0.000464001518
  error estimate for blocks of size 2^( 6) =       0.000472116274
  error estimate for blocks of size 2^( 7) =       0.000476949801

      target function =                  N/A
              le_mean =     -16.905496596811
             les_mean =     286.139905142395
             stat err =       0.000466462971
             autocorr =       1.264713426471
              std dev =       0.586591961804
             le_variance =       0.344090129653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905496610386        initial  <--
     6.2500e+00     6.2500e+01             5.2005e-05       -16.905496408026
     2.5000e+01     2.5000e+02             1.3066e-05       -16.905496504990
     1.0000e+02     1.0000e+03             3.2704e-06       -16.905496596811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9240
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092432e-01 1 1  ON 0
 uu_1                 1.424725e-01 1 1  ON 1
 uu_2                 4.100709e-02 1 1  ON 2
 uu_3                -2.131503e-02 1 1  ON 3
 uu_4                -6.661536e-02 1 1  ON 4
 uu_5                -1.013636e-01 1 1  ON 5
 uu_6                -1.283999e-01 1 1  ON 6
 uu_7                -1.415747e-01 1 1  ON 7
 uu_8                -1.334768e-01 1 1  ON 8
 uu_9                -1.050586e-01 1 1  ON 9
 ud_0                 4.478355e-01 1 1  ON 10
 ud_1                 1.825414e-01 1 1  ON 11
 ud_2                 6.292273e-02 1 1  ON 12
 ud_3                -7.627355e-03 1 1  ON 13
 ud_4                -6.486799e-02 1 1  ON 14
 ud_5                -1.069615e-01 1 1  ON 15
 ud_6                -1.349628e-01 1 1  ON 16
 ud_7                -1.520371e-01 1 1  ON 17
 ud_8                -1.529560e-01 1 1  ON 18
 ud_9                -1.433872e-01 1 1  ON 19
 eO_0                -7.601213e-01 1 1  ON 20
 eO_1                -4.398663e-01 1 1  ON 21
 eO_2                -2.169647e-02 1 1  ON 22
 eO_3                 2.987118e-01 1 1  ON 23
 eO_4                 5.254485e-01 1 1  ON 24
 eO_5                 4.877383e-01 1 1  ON 25
 eO_6                 2.599359e-01 1 1  ON 26
 eO_7                -4.071070e-02 1 1  ON 27
 eO_8                -2.214724e-01 1 1  ON 28
 eO_9                -8.655308e-02 1 1  ON 29
eH1_0                -2.447468e-01 1 1  ON 30
eH1_1                -1.453021e-01 1 1  ON 31
eH1_2                -9.856907e-02 1 1  ON 32
eH1_3                -4.483080e-02 1 1  ON 33
eH1_4                 3.375765e-03 1 1  ON 34
eH1_5                 3.808666e-02 1 1  ON 35
eH1_6                 9.660167e-02 1 1  ON 36
eH1_7                 1.541309e-01 1 1  ON 37
eH1_8                 1.772776e-01 1 1  ON 38
eH1_9                 6.798449e-02 1 1  ON 39
eH2_0                -2.424182e-01 1 1  ON 40
eH2_1                -1.429774e-01 1 1  ON 41
eH2_2                -9.649564e-02 1 1  ON 42
eH2_3                -4.248188e-02 1 1  ON 43
eH2_4                 5.572425e-03 1 1  ON 44
eH2_5                 4.023226e-02 1 1  ON 45
eH2_6                 9.943748e-02 1 1  ON 46
eH2_7                 1.552521e-01 1 1  ON 47
eH2_8                 1.828070e-01 1 1  ON 48
eH2_9                 5.759769e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8005
    reference variance = 0.216397
====================================================
  Execution time = 2.0754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992583905
                                         uncertainty =       0.003227622687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992583905
                                         uncertainty =       0.003227622687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409854373
  error estimate for blocks of size 2^( 2) =       0.000422951792
  error estimate for blocks of size 2^( 3) =       0.000435904510
  error estimate for blocks of size 2^( 4) =       0.000448133272
  error estimate for blocks of size 2^( 5) =       0.000458929348
  error estimate for blocks of size 2^( 6) =       0.000466178292
  error estimate for blocks of size 2^( 7) =       0.000470364224

      target function =                  N/A
              le_mean =     -16.905982400275
             les_mean =     286.148201964364
             stat err =       0.000460901284
             autocorr =       1.264610227926
              std dev =       0.579621612731
             le_variance =       0.335961213945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598240027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982400275       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982468563       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982491151       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982496249       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982492260       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982488361       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982491339       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905982489277       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.644666e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982400275       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982417386       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982423031       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982424332       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982423357       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982422365       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982423114       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905982422599       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.412178e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982400275       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982404555       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982405966       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982406292       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982406051       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982405801       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982405992       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905982405862       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.531078e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6359e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092429e-01 1 1  ON 0
 uu_1                 1.424730e-01 1 1  ON 1
 uu_2                 4.100724e-02 1 1  ON 2
 uu_3                -2.131536e-02 1 1  ON 3
 uu_4                -6.661580e-02 1 1  ON 4
 uu_5                -1.013633e-01 1 1  ON 5
 uu_6                -1.284001e-01 1 1  ON 6
 uu_7                -1.415747e-01 1 1  ON 7
 uu_8                -1.334769e-01 1 1  ON 8
 uu_9                -1.050586e-01 1 1  ON 9
 ud_0                 4.478367e-01 1 1  ON 10
 ud_1                 1.825425e-01 1 1  ON 11
 ud_2                 6.292243e-02 1 1  ON 12
 ud_3                -7.627834e-03 1 1  ON 13
 ud_4                -6.486862e-02 1 1  ON 14
 ud_5                -1.069617e-01 1 1  ON 15
 ud_6                -1.349633e-01 1 1  ON 16
 ud_7                -1.520372e-01 1 1  ON 17
 ud_8                -1.529559e-01 1 1  ON 18
 ud_9                -1.433873e-01 1 1  ON 19
 eO_0                -7.601222e-01 1 1  ON 20
 eO_1                -4.398659e-01 1 1  ON 21
 eO_2                -2.169593e-02 1 1  ON 22
 eO_3                 2.987122e-01 1 1  ON 23
 eO_4                 5.254486e-01 1 1  ON 24
 eO_5                 4.877387e-01 1 1  ON 25
 eO_6                 2.599357e-01 1 1  ON 26
 eO_7                -4.071060e-02 1 1  ON 27
 eO_8                -2.214728e-01 1 1  ON 28
 eO_9                -8.655357e-02 1 1  ON 29
eH1_0                -2.447482e-01 1 1  ON 30
eH1_1                -1.453025e-01 1 1  ON 31
eH1_2                -9.856927e-02 1 1  ON 32
eH1_3                -4.483103e-02 1 1  ON 33
eH1_4                 3.376031e-03 1 1  ON 34
eH1_5                 3.808708e-02 1 1  ON 35
eH1_6                 9.660183e-02 1 1  ON 36
eH1_7                 1.541309e-01 1 1  ON 37
eH1_8                 1.772780e-01 1 1  ON 38
eH1_9                 6.798523e-02 1 1  ON 39
eH2_0                -2.424194e-01 1 1  ON 40
eH2_1                -1.429779e-01 1 1  ON 41
eH2_2                -9.649567e-02 1 1  ON 42
eH2_3                -4.248179e-02 1 1  ON 43
eH2_4                 5.573012e-03 1 1  ON 44
eH2_5                 4.023230e-02 1 1  ON 45
eH2_6                 9.943751e-02 1 1  ON 46
eH2_7                 1.552520e-01 1 1  ON 47
eH2_8                 1.828074e-01 1 1  ON 48
eH2_9                 5.759846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8783
    reference variance = 0.379926
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3439e-01
  Total weights = 2.0000e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334476030045
                                         uncertainty =       0.002924986013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334476030045
                                         uncertainty =       0.002924986013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408896622
  error estimate for blocks of size 2^( 2) =       0.000421537584
  error estimate for blocks of size 2^( 3) =       0.000434090123
  error estimate for blocks of size 2^( 4) =       0.000444939756
  error estimate for blocks of size 2^( 5) =       0.000454849307
  error estimate for blocks of size 2^( 6) =       0.000461746287
  error estimate for blocks of size 2^( 7) =       0.000467379987

      target function =                  N/A
              le_mean =     -16.906428356112
             les_mean =     286.161712487417
             stat err =       0.000457228834
             autocorr =       1.250374696169
              std dev =       0.578267147849
             le_variance =       0.334392894281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334479544227
                                         uncertainty =       0.002925020638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334479544227
                                         uncertainty =       0.002925020638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408898769
  error estimate for blocks of size 2^( 2) =       0.000421539480
  error estimate for blocks of size 2^( 3) =       0.000434091763
  error estimate for blocks of size 2^( 4) =       0.000444941201
  error estimate for blocks of size 2^( 5) =       0.000454850610
  error estimate for blocks of size 2^( 6) =       0.000461747471
  error estimate for blocks of size 2^( 7) =       0.000467381183

      target function =                  N/A
              le_mean =     -16.906428356504
             les_mean =     286.161716012834
             stat err =       0.000457230116
             autocorr =       1.250368574291
              std dev =       0.578270184629
             le_variance =       0.334396406431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334477788000
                                         uncertainty =       0.002925003341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334477788000
                                         uncertainty =       0.002925003341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408897696
  error estimate for blocks of size 2^( 2) =       0.000421538533
  error estimate for blocks of size 2^( 3) =       0.000434090943
  error estimate for blocks of size 2^( 4) =       0.000444940478
  error estimate for blocks of size 2^( 5) =       0.000454849958
  error estimate for blocks of size 2^( 6) =       0.000461746878
  error estimate for blocks of size 2^( 7) =       0.000467380584

      target function =                  N/A
              le_mean =     -16.906428356273
             les_mean =     286.161714249814
             stat err =       0.000457229474
             autocorr =       1.250371628513
              std dev =       0.578268666987
             le_variance =       0.334394651219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334476249799
                                         uncertainty =       0.002924988180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334476249799
                                         uncertainty =       0.002924988180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408896756
  error estimate for blocks of size 2^( 2) =       0.000421537703
  error estimate for blocks of size 2^( 3) =       0.000434090225
  error estimate for blocks of size 2^( 4) =       0.000444939846
  error estimate for blocks of size 2^( 5) =       0.000454849389
  error estimate for blocks of size 2^( 6) =       0.000461746361
  error estimate for blocks of size 2^( 7) =       0.000467380061

      target function =                  N/A
              le_mean =     -16.906428356127
             les_mean =     286.161712707568
             stat err =       0.000457228914
             autocorr =       1.250374312482
              std dev =       0.578267337751
             le_variance =       0.334393113909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906428356112        initial
     6.2500e+01     6.2500e+02             5.6447e-06       -16.906428356504  <--
     2.5000e+02     2.5000e+03             1.4122e-06       -16.906428356273
     1.0000e+03     1.0000e+04             3.5311e-07       -16.906428356127

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 3.0097e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092419e-01 1 1  ON 0
 uu_1                 1.424745e-01 1 1  ON 1
 uu_2                 4.100766e-02 1 1  ON 2
 uu_3                -2.131635e-02 1 1  ON 3
 uu_4                -6.661711e-02 1 1  ON 4
 uu_5                -1.013622e-01 1 1  ON 5
 uu_6                -1.284008e-01 1 1  ON 6
 uu_7                -1.415749e-01 1 1  ON 7
 uu_8                -1.334771e-01 1 1  ON 8
 uu_9                -1.050586e-01 1 1  ON 9
 ud_0                 4.478402e-01 1 1  ON 10
 ud_1                 1.825457e-01 1 1  ON 11
 ud_2                 6.292155e-02 1 1  ON 12
 ud_3                -7.629271e-03 1 1  ON 13
 ud_4                -6.487053e-02 1 1  ON 14
 ud_5                -1.069621e-01 1 1  ON 15
 ud_6                -1.349649e-01 1 1  ON 16
 ud_7                -1.520374e-01 1 1  ON 17
 ud_8                -1.529559e-01 1 1  ON 18
 ud_9                -1.433873e-01 1 1  ON 19
 eO_0                -7.601247e-01 1 1  ON 20
 eO_1                -4.398646e-01 1 1  ON 21
 eO_2                -2.169429e-02 1 1  ON 22
 eO_3                 2.987136e-01 1 1  ON 23
 eO_4                 5.254489e-01 1 1  ON 24
 eO_5                 4.877397e-01 1 1  ON 25
 eO_6                 2.599352e-01 1 1  ON 26
 eO_7                -4.071030e-02 1 1  ON 27
 eO_8                -2.214739e-01 1 1  ON 28
 eO_9                -8.655504e-02 1 1  ON 29
eH1_0                -2.447524e-01 1 1  ON 30
eH1_1                -1.453035e-01 1 1  ON 31
eH1_2                -9.856986e-02 1 1  ON 32
eH1_3                -4.483171e-02 1 1  ON 33
eH1_4                 3.376828e-03 1 1  ON 34
eH1_5                 3.808837e-02 1 1  ON 35
eH1_6                 9.660232e-02 1 1  ON 36
eH1_7                 1.541309e-01 1 1  ON 37
eH1_8                 1.772794e-01 1 1  ON 38
eH1_9                 6.798745e-02 1 1  ON 39
eH2_0                -2.424230e-01 1 1  ON 40
eH2_1                -1.429796e-01 1 1  ON 41
eH2_2                -9.649577e-02 1 1  ON 42
eH2_3                -4.248152e-02 1 1  ON 43
eH2_4                 5.574768e-03 1 1  ON 44
eH2_5                 4.023240e-02 1 1  ON 45
eH2_6                 9.943759e-02 1 1  ON 46
eH2_7                 1.552515e-01 1 1  ON 47
eH2_8                 1.828085e-01 1 1  ON 48
eH2_9                 5.760076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.547679
====================================================
  Execution time = 2.1140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4139e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341408059593
                                         uncertainty =       0.004766427320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341408059593
                                         uncertainty =       0.004766427320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413154516
  error estimate for blocks of size 2^( 2) =       0.000426312201
  error estimate for blocks of size 2^( 3) =       0.000439246433
  error estimate for blocks of size 2^( 4) =       0.000451848953
  error estimate for blocks of size 2^( 5) =       0.000462388544
  error estimate for blocks of size 2^( 6) =       0.000470395337
  error estimate for blocks of size 2^( 7) =       0.000477139987

      target function =                  N/A
              le_mean =     -16.906165531412
             les_mean =     286.159826112352
             stat err =       0.000465443205
             autocorr =       1.269136638233
              std dev =       0.584288719331
             le_variance =       0.341393307538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616553141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165531412       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165741891       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165758135       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165737826       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165751656       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165749351       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165760144       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165759249       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165759390       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.974741e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165531412       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165584509       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165588817       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165583734       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165587041       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165586761       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165588905       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165589361       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165588929       residual = 9.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.959226e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165531412       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165544717       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165545809       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165544538       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165545355       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165545306       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165545768       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165545963       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165545831       residual = 9.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.241511e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6786e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092427e-01 1 1  ON 0
 uu_1                 1.424767e-01 1 1  ON 1
 uu_2                 4.100634e-02 1 1  ON 2
 uu_3                -2.131689e-02 1 1  ON 3
 uu_4                -6.661829e-02 1 1  ON 4
 uu_5                -1.013623e-01 1 1  ON 5
 uu_6                -1.284021e-01 1 1  ON 6
 uu_7                -1.415735e-01 1 1  ON 7
 uu_8                -1.334791e-01 1 1  ON 8
 uu_9                -1.050596e-01 1 1  ON 9
 ud_0                 4.478451e-01 1 1  ON 10
 ud_1                 1.825495e-01 1 1  ON 11
 ud_2                 6.292100e-02 1 1  ON 12
 ud_3                -7.631206e-03 1 1  ON 13
 ud_4                -6.487242e-02 1 1  ON 14
 ud_5                -1.069627e-01 1 1  ON 15
 ud_6                -1.349654e-01 1 1  ON 16
 ud_7                -1.520368e-01 1 1  ON 17
 ud_8                -1.529567e-01 1 1  ON 18
 ud_9                -1.433884e-01 1 1  ON 19
 eO_0                -7.601275e-01 1 1  ON 20
 eO_1                -4.398627e-01 1 1  ON 21
 eO_2                -2.169228e-02 1 1  ON 22
 eO_3                 2.987140e-01 1 1  ON 23
 eO_4                 5.254500e-01 1 1  ON 24
 eO_5                 4.877394e-01 1 1  ON 25
 eO_6                 2.599373e-01 1 1  ON 26
 eO_7                -4.070945e-02 1 1  ON 27
 eO_8                -2.214763e-01 1 1  ON 28
 eO_9                -8.655736e-02 1 1  ON 29
eH1_0                -2.447572e-01 1 1  ON 30
eH1_1                -1.453072e-01 1 1  ON 31
eH1_2                -9.856973e-02 1 1  ON 32
eH1_3                -4.483063e-02 1 1  ON 33
eH1_4                 3.377625e-03 1 1  ON 34
eH1_5                 3.808798e-02 1 1  ON 35
eH1_6                 9.660324e-02 1 1  ON 36
eH1_7                 1.541320e-01 1 1  ON 37
eH1_8                 1.772819e-01 1 1  ON 38
eH1_9                 6.798991e-02 1 1  ON 39
eH2_0                -2.424275e-01 1 1  ON 40
eH2_1                -1.429812e-01 1 1  ON 41
eH2_2                -9.649686e-02 1 1  ON 42
eH2_3                -4.248110e-02 1 1  ON 43
eH2_4                 5.577713e-03 1 1  ON 44
eH2_5                 4.023080e-02 1 1  ON 45
eH2_6                 9.943685e-02 1 1  ON 46
eH2_7                 1.552521e-01 1 1  ON 47
eH2_8                 1.828108e-01 1 1  ON 48
eH2_9                 5.760387e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.271127
====================================================
  Execution time = 2.0433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5355e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353576950549
                                         uncertainty =       0.010718748384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353576950549
                                         uncertainty =       0.010718748384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420441627
  error estimate for blocks of size 2^( 2) =       0.000432939051
  error estimate for blocks of size 2^( 3) =       0.000446154004
  error estimate for blocks of size 2^( 4) =       0.000458621638
  error estimate for blocks of size 2^( 5) =       0.000470728739
  error estimate for blocks of size 2^( 6) =       0.000477686005
  error estimate for blocks of size 2^( 7) =       0.000482739760

      target function =                  N/A
              le_mean =     -16.906407317811
             les_mean =     286.180150542036
             stat err =       0.000472444036
             autocorr =       1.262668439729
              std dev =       0.594594250782
             le_variance =       0.353542323063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353595378234
                                         uncertainty =       0.010719223698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353595378234
                                         uncertainty =       0.010719223698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420452590
  error estimate for blocks of size 2^( 2) =       0.000432948989
  error estimate for blocks of size 2^( 3) =       0.000446162838
  error estimate for blocks of size 2^( 4) =       0.000458629523
  error estimate for blocks of size 2^( 5) =       0.000470736618
  error estimate for blocks of size 2^( 6) =       0.000477693575
  error estimate for blocks of size 2^( 7) =       0.000482746972

      target function =                  N/A
              le_mean =     -16.906407389502
             les_mean =     286.180171404720
             stat err =       0.000472451672
             autocorr =       1.262643407299
              std dev =       0.594609755805
             le_variance =       0.353560761698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353586242578
                                         uncertainty =       0.010718989694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353586242578
                                         uncertainty =       0.010718989694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420447155
  error estimate for blocks of size 2^( 2) =       0.000432944061
  error estimate for blocks of size 2^( 3) =       0.000446158456
  error estimate for blocks of size 2^( 4) =       0.000458625610
  error estimate for blocks of size 2^( 5) =       0.000470732708
  error estimate for blocks of size 2^( 6) =       0.000477689817
  error estimate for blocks of size 2^( 7) =       0.000482743389

      target function =                  N/A
              le_mean =     -16.906407353700
             les_mean =     286.180161053086
             stat err =       0.000472447881
             autocorr =       1.262655789702
              std dev =       0.594602069140
             le_variance =       0.353551620626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353578114962
                                         uncertainty =       0.010718778697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353578114962
                                         uncertainty =       0.010718778697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420442320
  error estimate for blocks of size 2^( 2) =       0.000432939679
  error estimate for blocks of size 2^( 3) =       0.000446154562
  error estimate for blocks of size 2^( 4) =       0.000458622135
  error estimate for blocks of size 2^( 5) =       0.000470729237
  error estimate for blocks of size 2^( 6) =       0.000477686482
  error estimate for blocks of size 2^( 7) =       0.000482740215

      target function =                  N/A
              le_mean =     -16.906407322244
             les_mean =     286.180151857038
             stat err =       0.000472444517
             autocorr =       1.262666853118
              std dev =       0.594595230530
             le_variance =       0.353543488169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906407317811        initial
     1.5625e+01     1.5625e+02             1.9747e-05       -16.906407389502  <--
     6.2500e+01     6.2500e+02             4.9592e-06       -16.906407353700
     2.5000e+02     2.5000e+03             1.2415e-06       -16.906407322244

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9892e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092452e-01 1 1  ON 0
 uu_1                 1.424831e-01 1 1  ON 1
 uu_2                 4.100252e-02 1 1  ON 2
 uu_3                -2.131854e-02 1 1  ON 3
 uu_4                -6.662176e-02 1 1  ON 4
 uu_5                -1.013623e-01 1 1  ON 5
 uu_6                -1.284059e-01 1 1  ON 6
 uu_7                -1.415691e-01 1 1  ON 7
 uu_8                -1.334849e-01 1 1  ON 8
 uu_9                -1.050625e-01 1 1  ON 9
 ud_0                 4.478599e-01 1 1  ON 10
 ud_1                 1.825606e-01 1 1  ON 11
 ud_2                 6.291946e-02 1 1  ON 12
 ud_3                -7.636933e-03 1 1  ON 13
 ud_4                -6.487803e-02 1 1  ON 14
 ud_5                -1.069645e-01 1 1  ON 15
 ud_6                -1.349671e-01 1 1  ON 16
 ud_7                -1.520351e-01 1 1  ON 17
 ud_8                -1.529589e-01 1 1  ON 18
 ud_9                -1.433917e-01 1 1  ON 19
 eO_0                -7.601356e-01 1 1  ON 20
 eO_1                -4.398570e-01 1 1  ON 21
 eO_2                -2.168634e-02 1 1  ON 22
 eO_3                 2.987152e-01 1 1  ON 23
 eO_4                 5.254530e-01 1 1  ON 24
 eO_5                 4.877383e-01 1 1  ON 25
 eO_6                 2.599435e-01 1 1  ON 26
 eO_7                -4.070691e-02 1 1  ON 27
 eO_8                -2.214835e-01 1 1  ON 28
 eO_9                -8.656432e-02 1 1  ON 29
eH1_0                -2.447715e-01 1 1  ON 30
eH1_1                -1.453181e-01 1 1  ON 31
eH1_2                -9.856939e-02 1 1  ON 32
eH1_3                -4.482743e-02 1 1  ON 33
eH1_4                 3.380004e-03 1 1  ON 34
eH1_5                 3.808682e-02 1 1  ON 35
eH1_6                 9.660601e-02 1 1  ON 36
eH1_7                 1.541353e-01 1 1  ON 37
eH1_8                 1.772893e-01 1 1  ON 38
eH1_9                 6.799732e-02 1 1  ON 39
eH2_0                -2.424408e-01 1 1  ON 40
eH2_1                -1.429862e-01 1 1  ON 41
eH2_2                -9.650006e-02 1 1  ON 42
eH2_3                -4.247989e-02 1 1  ON 43
eH2_4                 5.586472e-03 1 1  ON 44
eH2_5                 4.022603e-02 1 1  ON 45
eH2_6                 9.943461e-02 1 1  ON 46
eH2_7                 1.552540e-01 1 1  ON 47
eH2_8                 1.828175e-01 1 1  ON 48
eH2_9                 5.761319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9475
    reference variance = 0.22513
====================================================
  Execution time = 2.1219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338963189426
                                         uncertainty =       0.003871674165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338963189426
                                         uncertainty =       0.003871674165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411795635
  error estimate for blocks of size 2^( 2) =       0.000424765034
  error estimate for blocks of size 2^( 3) =       0.000437658369
  error estimate for blocks of size 2^( 4) =       0.000449451362
  error estimate for blocks of size 2^( 5) =       0.000459450925
  error estimate for blocks of size 2^( 6) =       0.000467453185
  error estimate for blocks of size 2^( 7) =       0.000472091367

      target function =                  N/A
              le_mean =     -16.906072599072
             les_mean =     286.154441845235
             stat err =       0.000462111709
             autocorr =       1.259303670819
              std dev =       0.582366971677
             le_variance =       0.339151289701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607259907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906072599072       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906073112223       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906073439793       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906073426539       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906073313077       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906073287707       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906073333783       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906073353137       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.090619e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906072599072       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906072731756       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906072818218       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906072813075       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906072785825       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906072777725       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906072788908       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906072794242       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.757442e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906072599072       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906072632530       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906072654441       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906072653038       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906072646338       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906072644201       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906072646958       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906072648317       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.912816e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6854e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092466e-01 1 1  ON 0
 uu_1                 1.424880e-01 1 1  ON 1
 uu_2                 4.101131e-02 1 1  ON 2
 uu_3                -2.131946e-02 1 1  ON 3
 uu_4                -6.662258e-02 1 1  ON 4
 uu_5                -1.013633e-01 1 1  ON 5
 uu_6                -1.284114e-01 1 1  ON 6
 uu_7                -1.415768e-01 1 1  ON 7
 uu_8                -1.334894e-01 1 1  ON 8
 uu_9                -1.050653e-01 1 1  ON 9
 ud_0                 4.478678e-01 1 1  ON 10
 ud_1                 1.825713e-01 1 1  ON 11
 ud_2                 6.292110e-02 1 1  ON 12
 ud_3                -7.647995e-03 1 1  ON 13
 ud_4                -6.487856e-02 1 1  ON 14
 ud_5                -1.069672e-01 1 1  ON 15
 ud_6                -1.349585e-01 1 1  ON 16
 ud_7                -1.520312e-01 1 1  ON 17
 ud_8                -1.529687e-01 1 1  ON 18
 ud_9                -1.433976e-01 1 1  ON 19
 eO_0                -7.601435e-01 1 1  ON 20
 eO_1                -4.398539e-01 1 1  ON 21
 eO_2                -2.168083e-02 1 1  ON 22
 eO_3                 2.987283e-01 1 1  ON 23
 eO_4                 5.254505e-01 1 1  ON 24
 eO_5                 4.877392e-01 1 1  ON 25
 eO_6                 2.599485e-01 1 1  ON 26
 eO_7                -4.070507e-02 1 1  ON 27
 eO_8                -2.214919e-01 1 1  ON 28
 eO_9                -8.657364e-02 1 1  ON 29
eH1_0                -2.447867e-01 1 1  ON 30
eH1_1                -1.453236e-01 1 1  ON 31
eH1_2                -9.856962e-02 1 1  ON 32
eH1_3                -4.482530e-02 1 1  ON 33
eH1_4                 3.384221e-03 1 1  ON 34
eH1_5                 3.808301e-02 1 1  ON 35
eH1_6                 9.659812e-02 1 1  ON 36
eH1_7                 1.541337e-01 1 1  ON 37
eH1_8                 1.773000e-01 1 1  ON 38
eH1_9                 6.801152e-02 1 1  ON 39
eH2_0                -2.424684e-01 1 1  ON 40
eH2_1                -1.429962e-01 1 1  ON 41
eH2_2                -9.649063e-02 1 1  ON 42
eH2_3                -4.247853e-02 1 1  ON 43
eH2_4                 5.596503e-03 1 1  ON 44
eH2_5                 4.022314e-02 1 1  ON 45
eH2_6                 9.943486e-02 1 1  ON 46
eH2_7                 1.552554e-01 1 1  ON 47
eH2_8                 1.828234e-01 1 1  ON 48
eH2_9                 5.762494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.185561
====================================================
  Execution time = 2.2724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3637e-01
  Total weights = 2.0000e+06
  Execution time = 1.8546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343463529
                                         uncertainty =       0.003294856905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343463529
                                         uncertainty =       0.003294856905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410107178
  error estimate for blocks of size 2^( 2) =       0.000422387380
  error estimate for blocks of size 2^( 3) =       0.000435401751
  error estimate for blocks of size 2^( 4) =       0.000447487563
  error estimate for blocks of size 2^( 5) =       0.000457336694
  error estimate for blocks of size 2^( 6) =       0.000463750511
  error estimate for blocks of size 2^( 7) =       0.000471807750

      target function =                  N/A
              le_mean =     -16.905881798181
             les_mean =     286.145215000965
             stat err =       0.000460095630
             autocorr =       1.258639839753
              std dev =       0.579979133312
             le_variance =       0.336375795077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336340262975
                                         uncertainty =       0.003294951717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336340262975
                                         uncertainty =       0.003294951717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410105244
  error estimate for blocks of size 2^( 2) =       0.000422384301
  error estimate for blocks of size 2^( 3) =       0.000435397444
  error estimate for blocks of size 2^( 4) =       0.000447482496
  error estimate for blocks of size 2^( 5) =       0.000457332046
  error estimate for blocks of size 2^( 6) =       0.000463747429
  error estimate for blocks of size 2^( 7) =       0.000471804097

      target function =                  N/A
              le_mean =     -16.905881287219
             les_mean =     286.145194551120
             stat err =       0.000460091517
             autocorr =       1.258629211534
              std dev =       0.579976397593
             le_variance =       0.336372621764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336340434130
                                         uncertainty =       0.003294893501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336340434130
                                         uncertainty =       0.003294893501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410105340
  error estimate for blocks of size 2^( 2) =       0.000422384985
  error estimate for blocks of size 2^( 3) =       0.000435398752
  error estimate for blocks of size 2^( 4) =       0.000447484191
  error estimate for blocks of size 2^( 5) =       0.000457333562
  error estimate for blocks of size 2^( 6) =       0.000463748214
  error estimate for blocks of size 2^( 7) =       0.000471805216

      target function =                  N/A
              le_mean =     -16.905881527615
             les_mean =     286.145202837426
             stat err =       0.000460092796
             autocorr =       1.258635617777
              std dev =       0.579976533873
             le_variance =       0.336372779844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343029269
                                         uncertainty =       0.003294861083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343029269
                                         uncertainty =       0.003294861083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410106914
  error estimate for blocks of size 2^( 2) =       0.000422387047
  error estimate for blocks of size 2^( 3) =       0.000435401343
  error estimate for blocks of size 2^( 4) =       0.000447487109
  error estimate for blocks of size 2^( 5) =       0.000457336270
  error estimate for blocks of size 2^( 6) =       0.000463750194
  error estimate for blocks of size 2^( 7) =       0.000471807405

      target function =                  N/A
              le_mean =     -16.905881763292
             les_mean =     286.145213388839
             stat err =       0.000460095245
             autocorr =       1.258639351289
              std dev =       0.579978760479
             le_variance =       0.336375362607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905881798181        initial  <--
     3.9062e+00     3.9062e+01             1.0906e-04       -16.905881287219
     1.5625e+01     1.5625e+02             2.7574e-05       -16.905881527615
     6.2500e+01     6.2500e+02             6.9128e-06       -16.905881763292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1155
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092452e-01 1 1  ON 0
 uu_1                 1.424831e-01 1 1  ON 1
 uu_2                 4.100252e-02 1 1  ON 2
 uu_3                -2.131854e-02 1 1  ON 3
 uu_4                -6.662176e-02 1 1  ON 4
 uu_5                -1.013623e-01 1 1  ON 5
 uu_6                -1.284059e-01 1 1  ON 6
 uu_7                -1.415691e-01 1 1  ON 7
 uu_8                -1.334849e-01 1 1  ON 8
 uu_9                -1.050625e-01 1 1  ON 9
 ud_0                 4.478599e-01 1 1  ON 10
 ud_1                 1.825606e-01 1 1  ON 11
 ud_2                 6.291946e-02 1 1  ON 12
 ud_3                -7.636933e-03 1 1  ON 13
 ud_4                -6.487803e-02 1 1  ON 14
 ud_5                -1.069645e-01 1 1  ON 15
 ud_6                -1.349671e-01 1 1  ON 16
 ud_7                -1.520351e-01 1 1  ON 17
 ud_8                -1.529589e-01 1 1  ON 18
 ud_9                -1.433917e-01 1 1  ON 19
 eO_0                -7.601356e-01 1 1  ON 20
 eO_1                -4.398570e-01 1 1  ON 21
 eO_2                -2.168634e-02 1 1  ON 22
 eO_3                 2.987152e-01 1 1  ON 23
 eO_4                 5.254530e-01 1 1  ON 24
 eO_5                 4.877383e-01 1 1  ON 25
 eO_6                 2.599435e-01 1 1  ON 26
 eO_7                -4.070691e-02 1 1  ON 27
 eO_8                -2.214835e-01 1 1  ON 28
 eO_9                -8.656432e-02 1 1  ON 29
eH1_0                -2.447715e-01 1 1  ON 30
eH1_1                -1.453181e-01 1 1  ON 31
eH1_2                -9.856939e-02 1 1  ON 32
eH1_3                -4.482743e-02 1 1  ON 33
eH1_4                 3.380004e-03 1 1  ON 34
eH1_5                 3.808682e-02 1 1  ON 35
eH1_6                 9.660601e-02 1 1  ON 36
eH1_7                 1.541353e-01 1 1  ON 37
eH1_8                 1.772893e-01 1 1  ON 38
eH1_9                 6.799732e-02 1 1  ON 39
eH2_0                -2.424408e-01 1 1  ON 40
eH2_1                -1.429862e-01 1 1  ON 41
eH2_2                -9.650006e-02 1 1  ON 42
eH2_3                -4.247989e-02 1 1  ON 43
eH2_4                 5.586472e-03 1 1  ON 44
eH2_5                 4.022603e-02 1 1  ON 45
eH2_6                 9.943461e-02 1 1  ON 46
eH2_7                 1.552540e-01 1 1  ON 47
eH2_8                 1.828175e-01 1 1  ON 48
eH2_9                 5.761319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.35375
====================================================
  Execution time = 2.2961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3840e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338388469158
                                         uncertainty =       0.006076868520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338388469158
                                         uncertainty =       0.006076868520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411337188
  error estimate for blocks of size 2^( 2) =       0.000424384289
  error estimate for blocks of size 2^( 3) =       0.000437736738
  error estimate for blocks of size 2^( 4) =       0.000450883906
  error estimate for blocks of size 2^( 5) =       0.000462376412
  error estimate for blocks of size 2^( 6) =       0.000469863770
  error estimate for blocks of size 2^( 7) =       0.000474995970

      target function =                  N/A
              le_mean =     -16.906225210362
             les_mean =     286.158847258148
             stat err =       0.000464530014
             autocorr =       1.275356532911
              std dev =       0.581718629466
             le_variance =       0.338396563867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622521036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225210362       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225286230       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906225291881       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906225290165       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906225306636       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906225312604       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906225314020       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906225314303       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 9.991927e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225210362       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225229400       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906225230829       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906225230384       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906225234469       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906225235988       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906225236357       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906225236422       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.500424e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906225210362       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225215126       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906225215484       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906225215372       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906225216391       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906225216773       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906225216866       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906225216882       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.252587e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8644e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092453e-01 1 1  ON 0
 uu_1                 1.424834e-01 1 1  ON 1
 uu_2                 4.100292e-02 1 1  ON 2
 uu_3                -2.131874e-02 1 1  ON 3
 uu_4                -6.662193e-02 1 1  ON 4
 uu_5                -1.013623e-01 1 1  ON 5
 uu_6                -1.284058e-01 1 1  ON 6
 uu_7                -1.415701e-01 1 1  ON 7
 uu_8                -1.334857e-01 1 1  ON 8
 uu_9                -1.050625e-01 1 1  ON 9
 ud_0                 4.478617e-01 1 1  ON 10
 ud_1                 1.825618e-01 1 1  ON 11
 ud_2                 6.291924e-02 1 1  ON 12
 ud_3                -7.638028e-03 1 1  ON 13
 ud_4                -6.487855e-02 1 1  ON 14
 ud_5                -1.069641e-01 1 1  ON 15
 ud_6                -1.349677e-01 1 1  ON 16
 ud_7                -1.520353e-01 1 1  ON 17
 ud_8                -1.529591e-01 1 1  ON 18
 ud_9                -1.433919e-01 1 1  ON 19
 eO_0                -7.601360e-01 1 1  ON 20
 eO_1                -4.398567e-01 1 1  ON 21
 eO_2                -2.168553e-02 1 1  ON 22
 eO_3                 2.987153e-01 1 1  ON 23
 eO_4                 5.254531e-01 1 1  ON 24
 eO_5                 4.877386e-01 1 1  ON 25
 eO_6                 2.599437e-01 1 1  ON 26
 eO_7                -4.070666e-02 1 1  ON 27
 eO_8                -2.214841e-01 1 1  ON 28
 eO_9                -8.656525e-02 1 1  ON 29
eH1_0                -2.447740e-01 1 1  ON 30
eH1_1                -1.453188e-01 1 1  ON 31
eH1_2                -9.856969e-02 1 1  ON 32
eH1_3                -4.482667e-02 1 1  ON 33
eH1_4                 3.380623e-03 1 1  ON 34
eH1_5                 3.808639e-02 1 1  ON 35
eH1_6                 9.660627e-02 1 1  ON 36
eH1_7                 1.541355e-01 1 1  ON 37
eH1_8                 1.772902e-01 1 1  ON 38
eH1_9                 6.799822e-02 1 1  ON 39
eH2_0                -2.424426e-01 1 1  ON 40
eH2_1                -1.429875e-01 1 1  ON 41
eH2_2                -9.649955e-02 1 1  ON 42
eH2_3                -4.247996e-02 1 1  ON 43
eH2_4                 5.586920e-03 1 1  ON 44
eH2_5                 4.022646e-02 1 1  ON 45
eH2_6                 9.943403e-02 1 1  ON 46
eH2_7                 1.552542e-01 1 1  ON 47
eH2_8                 1.828185e-01 1 1  ON 48
eH2_9                 5.761449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.174528
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.0000e+06
  Execution time = 1.8618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340757330189
                                         uncertainty =       0.005212596552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340757330189
                                         uncertainty =       0.005212596552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412699041
  error estimate for blocks of size 2^( 2) =       0.000425282839
  error estimate for blocks of size 2^( 3) =       0.000437580858
  error estimate for blocks of size 2^( 4) =       0.000449648793
  error estimate for blocks of size 2^( 5) =       0.000459920062
  error estimate for blocks of size 2^( 6) =       0.000468432173
  error estimate for blocks of size 2^( 7) =       0.000471421205

      target function =                  N/A
              le_mean =     -16.906596053761
             les_mean =     286.173630951695
             stat err =       0.000462355558
             autocorr =       1.255119990097
              std dev =       0.583644581032
             le_variance =       0.340640996968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340761978370
                                         uncertainty =       0.005212741534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340761978370
                                         uncertainty =       0.005212741534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412701854
  error estimate for blocks of size 2^( 2) =       0.000425285365
  error estimate for blocks of size 2^( 3) =       0.000437583032
  error estimate for blocks of size 2^( 4) =       0.000449650729
  error estimate for blocks of size 2^( 5) =       0.000459921934
  error estimate for blocks of size 2^( 6) =       0.000468433924
  error estimate for blocks of size 2^( 7) =       0.000471422732

      target function =                  N/A
              le_mean =     -16.906596092244
             les_mean =     286.173636896670
             stat err =       0.000462357330
             autocorr =       1.255112496329
              std dev =       0.583648559238
             le_variance =       0.340645640700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340759658653
                                         uncertainty =       0.005212669282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340759658653
                                         uncertainty =       0.005212669282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412700450
  error estimate for blocks of size 2^( 2) =       0.000425284104
  error estimate for blocks of size 2^( 3) =       0.000437581946
  error estimate for blocks of size 2^( 4) =       0.000449649762
  error estimate for blocks of size 2^( 5) =       0.000459920999
  error estimate for blocks of size 2^( 6) =       0.000468433049
  error estimate for blocks of size 2^( 7) =       0.000471421969

      target function =                  N/A
              le_mean =     -16.906596072900
             les_mean =     286.173633925081
             stat err =       0.000462356445
             autocorr =       1.255116230318
              std dev =       0.583646573878
             le_variance =       0.340643323199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340757621354
                                         uncertainty =       0.005212605651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340757621354
                                         uncertainty =       0.005212605651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412699217
  error estimate for blocks of size 2^( 2) =       0.000425282997
  error estimate for blocks of size 2^( 3) =       0.000437580994
  error estimate for blocks of size 2^( 4) =       0.000449648914
  error estimate for blocks of size 2^( 5) =       0.000459920179
  error estimate for blocks of size 2^( 6) =       0.000468432283
  error estimate for blocks of size 2^( 7) =       0.000471421301

      target function =                  N/A
              le_mean =     -16.906596056143
             les_mean =     286.173631323129
             stat err =       0.000462355669
             autocorr =       1.255119519673
              std dev =       0.583644830230
             le_variance =       0.340641287854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906596053761        initial
     3.9062e+01     3.9062e+02             9.9919e-06       -16.906596092244  <--
     1.5625e+02     1.5625e+03             2.5004e-06       -16.906596072900
     6.2500e+02     6.2500e+03             6.2526e-07       -16.906596056143

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.9990e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092458e-01 1 1  ON 0
 uu_1                 1.424844e-01 1 1  ON 1
 uu_2                 4.100410e-02 1 1  ON 2
 uu_3                -2.131933e-02 1 1  ON 3
 uu_4                -6.662244e-02 1 1  ON 4
 uu_5                -1.013623e-01 1 1  ON 5
 uu_6                -1.284055e-01 1 1  ON 6
 uu_7                -1.415732e-01 1 1  ON 7
 uu_8                -1.334883e-01 1 1  ON 8
 uu_9                -1.050626e-01 1 1  ON 9
 ud_0                 4.478671e-01 1 1  ON 10
 ud_1                 1.825654e-01 1 1  ON 11
 ud_2                 6.291861e-02 1 1  ON 12
 ud_3                -7.641297e-03 1 1  ON 13
 ud_4                -6.488011e-02 1 1  ON 14
 ud_5                -1.069629e-01 1 1  ON 15
 ud_6                -1.349694e-01 1 1  ON 16
 ud_7                -1.520360e-01 1 1  ON 17
 ud_8                -1.529597e-01 1 1  ON 18
 ud_9                -1.433924e-01 1 1  ON 19
 eO_0                -7.601374e-01 1 1  ON 20
 eO_1                -4.398558e-01 1 1  ON 21
 eO_2                -2.168310e-02 1 1  ON 22
 eO_3                 2.987157e-01 1 1  ON 23
 eO_4                 5.254533e-01 1 1  ON 24
 eO_5                 4.877396e-01 1 1  ON 25
 eO_6                 2.599445e-01 1 1  ON 26
 eO_7                -4.070594e-02 1 1  ON 27
 eO_8                -2.214859e-01 1 1  ON 28
 eO_9                -8.656803e-02 1 1  ON 29
eH1_0                -2.447815e-01 1 1  ON 30
eH1_1                -1.453208e-01 1 1  ON 31
eH1_2                -9.857060e-02 1 1  ON 32
eH1_3                -4.482438e-02 1 1  ON 33
eH1_4                 3.382482e-03 1 1  ON 34
eH1_5                 3.808512e-02 1 1  ON 35
eH1_6                 9.660704e-02 1 1  ON 36
eH1_7                 1.541363e-01 1 1  ON 37
eH1_8                 1.772928e-01 1 1  ON 38
eH1_9                 6.800094e-02 1 1  ON 39
eH2_0                -2.424480e-01 1 1  ON 40
eH2_1                -1.429914e-01 1 1  ON 41
eH2_2                -9.649802e-02 1 1  ON 42
eH2_3                -4.248016e-02 1 1  ON 43
eH2_4                 5.588256e-03 1 1  ON 44
eH2_5                 4.022776e-02 1 1  ON 45
eH2_6                 9.943230e-02 1 1  ON 46
eH2_7                 1.552547e-01 1 1  ON 47
eH2_8                 1.828212e-01 1 1  ON 48
eH2_9                 5.761841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9129
    reference variance = 0.191982
====================================================
  Execution time = 2.0603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3468e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334619816200
                                         uncertainty =       0.003230540780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334619816200
                                         uncertainty =       0.003230540780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409074196
  error estimate for blocks of size 2^( 2) =       0.000421913235
  error estimate for blocks of size 2^( 3) =       0.000435375305
  error estimate for blocks of size 2^( 4) =       0.000447978511
  error estimate for blocks of size 2^( 5) =       0.000457749863
  error estimate for blocks of size 2^( 6) =       0.000465976771
  error estimate for blocks of size 2^( 7) =       0.000471077895

      target function =                  N/A
              le_mean =     -16.905695978672
             les_mean =     286.137239751531
             stat err =       0.000460695760
             autocorr =       1.268306619607
              std dev =       0.578518275939
             le_variance =       0.334683395595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569597867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695978672       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696222195       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696304631       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696285900       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696288748       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696276408       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696267802       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905696265763       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.213735e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695978672       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696040465       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696061778       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696056954       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696057524       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696054290       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696052163       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905696051320       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.071579e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695978672       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905695994178       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905695999552       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695998338       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905695998471       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695997652       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905695997122       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905695996892       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.690159e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6156e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.092484e-01 1 1  ON 0
 uu_1                 1.424860e-01 1 1  ON 1
 uu_2                 4.100592e-02 1 1  ON 2
 uu_3                -2.132178e-02 1 1  ON 3
 uu_4                -6.662200e-02 1 1  ON 4
 uu_5                -1.013619e-01 1 1  ON 5
 uu_6                -1.284098e-01 1 1  ON 6
 uu_7                -1.415775e-01 1 1  ON 7
 uu_8                -1.334888e-01 1 1  ON 8
 uu_9                -1.050619e-01 1 1  ON 9
 ud_0                 4.478778e-01 1 1  ON 10
 ud_1                 1.825699e-01 1 1  ON 11
 ud_2                 6.291635e-02 1 1  ON 12
 ud_3                -7.647379e-03 1 1  ON 13
 ud_4                -6.488068e-02 1 1  ON 14
 ud_5                -1.069679e-01 1 1  ON 15
 ud_6                -1.349692e-01 1 1  ON 16
 ud_7                -1.520384e-01 1 1  ON 17
 ud_8                -1.529610e-01 1 1  ON 18
 ud_9                -1.433901e-01 1 1  ON 19
 eO_0                -7.601394e-01 1 1  ON 20
 eO_1                -4.398570e-01 1 1  ON 21
 eO_2                -2.167941e-02 1 1  ON 22
 eO_3                 2.987178e-01 1 1  ON 23
 eO_4                 5.254557e-01 1 1  ON 24
 eO_5                 4.877405e-01 1 1  ON 25
 eO_6                 2.599442e-01 1 1  ON 26
 eO_7                -4.070673e-02 1 1  ON 27
 eO_8                -2.214877e-01 1 1  ON 28
 eO_9                -8.657054e-02 1 1  ON 29
eH1_0                -2.447879e-01 1 1  ON 30
eH1_1                -1.453231e-01 1 1  ON 31
eH1_2                -9.857116e-02 1 1  ON 32
eH1_3                -4.482316e-02 1 1  ON 33
eH1_4                 3.383845e-03 1 1  ON 34
eH1_5                 3.808510e-02 1 1  ON 35
eH1_6                 9.660573e-02 1 1  ON 36
eH1_7                 1.541350e-01 1 1  ON 37
eH1_8                 1.772957e-01 1 1  ON 38
eH1_9                 6.800609e-02 1 1  ON 39
eH2_0                -2.424557e-01 1 1  ON 40
eH2_1                -1.429945e-01 1 1  ON 41
eH2_2                -9.649695e-02 1 1  ON 42
eH2_3                -4.247936e-02 1 1  ON 43
eH2_4                 5.590639e-03 1 1  ON 44
eH2_5                 4.022770e-02 1 1  ON 45
eH2_6                 9.943006e-02 1 1  ON 46
eH2_7                 1.552540e-01 1 1  ON 47
eH2_8                 1.828237e-01 1 1  ON 48
eH2_9                 5.762431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8827
    reference variance = 0.386381
====================================================
  Execution time = 2.0166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 1.8586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338188630023
                                         uncertainty =       0.003491583255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338188630023
                                         uncertainty =       0.003491583255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411197574
  error estimate for blocks of size 2^( 2) =       0.000423816427
  error estimate for blocks of size 2^( 3) =       0.000436973748
  error estimate for blocks of size 2^( 4) =       0.000449409742
  error estimate for blocks of size 2^( 5) =       0.000461144820
  error estimate for blocks of size 2^( 6) =       0.000471936521
  error estimate for blocks of size 2^( 7) =       0.000475828450

      target function =                  N/A
              le_mean =     -16.905849348353
             les_mean =     286.145908910140
             stat err =       0.000464579883
             autocorr =       1.276496749506
              std dev =       0.581521186217
             le_variance =       0.338166890019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225969910
                                         uncertainty =       0.003492068180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225969910
                                         uncertainty =       0.003492068180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411220268
  error estimate for blocks of size 2^( 2) =       0.000423837352
  error estimate for blocks of size 2^( 3) =       0.000436992866
  error estimate for blocks of size 2^( 4) =       0.000449427507
  error estimate for blocks of size 2^( 5) =       0.000461162308
  error estimate for blocks of size 2^( 6) =       0.000471953243
  error estimate for blocks of size 2^( 7) =       0.000475844340

      target function =                  N/A
              le_mean =     -16.905849533520
             les_mean =     286.145952497787
             stat err =       0.000464596850
             autocorr =       1.276449091238
              std dev =       0.581553279485
             le_variance =       0.338204216880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207614743
                                         uncertainty =       0.003491830787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207614743
                                         uncertainty =       0.003491830787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411209112
  error estimate for blocks of size 2^( 2) =       0.000423827065
  error estimate for blocks of size 2^( 3) =       0.000436983466
  error estimate for blocks of size 2^( 4) =       0.000449418773
  error estimate for blocks of size 2^( 5) =       0.000461153714
  error estimate for blocks of size 2^( 6) =       0.000471945025
  error estimate for blocks of size 2^( 7) =       0.000475836521

      target function =                  N/A
              le_mean =     -16.905849442726
             les_mean =     286.145931079046
             stat err =       0.000464588508
             autocorr =       1.276472511121
              std dev =       0.581537503540
             le_variance =       0.338185868023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338191011921
                                         uncertainty =       0.003491614355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338191011921
                                         uncertainty =       0.003491614355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411199022
  error estimate for blocks of size 2^( 2) =       0.000423817762
  error estimate for blocks of size 2^( 3) =       0.000436974967
  error estimate for blocks of size 2^( 4) =       0.000449410875
  error estimate for blocks of size 2^( 5) =       0.000461145936
  error estimate for blocks of size 2^( 6) =       0.000471937588
  error estimate for blocks of size 2^( 7) =       0.000475829462

      target function =                  N/A
              le_mean =     -16.905849360053
             les_mean =     286.145911686786
             stat err =       0.000464580965
             autocorr =       1.276493706282
              std dev =       0.581523233474
             le_variance =       0.338169271070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905849348353        initial
     9.7656e+00     9.7656e+01             4.2137e-05       -16.905849533520  <--
     3.9062e+01     3.9062e+02             1.0716e-05       -16.905849442726
     1.5625e+02     1.5625e+03             2.6902e-06       -16.905849360053

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9554e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.092559e-01 1 1  ON 0
 uu_1                 1.424907e-01 1 1  ON 1
 uu_2                 4.101106e-02 1 1  ON 2
 uu_3                -2.132877e-02 1 1  ON 3
 uu_4                -6.662088e-02 1 1  ON 4
 uu_5                -1.013607e-01 1 1  ON 5
 uu_6                -1.284224e-01 1 1  ON 6
 uu_7                -1.415901e-01 1 1  ON 7
 uu_8                -1.334906e-01 1 1  ON 8
 uu_9                -1.050597e-01 1 1  ON 9
 ud_0                 4.479092e-01 1 1  ON 10
 ud_1                 1.825830e-01 1 1  ON 11
 ud_2                 6.290998e-02 1 1  ON 12
 ud_3                -7.665074e-03 1 1  ON 13
 ud_4                -6.488274e-02 1 1  ON 14
 ud_5                -1.069824e-01 1 1  ON 15
 ud_6                -1.349689e-01 1 1  ON 16
 ud_7                -1.520457e-01 1 1  ON 17
 ud_8                -1.529649e-01 1 1  ON 18
 ud_9                -1.433829e-01 1 1  ON 19
 eO_0                -7.601455e-01 1 1  ON 20
 eO_1                -4.398601e-01 1 1  ON 21
 eO_2                -2.166863e-02 1 1  ON 22
 eO_3                 2.987237e-01 1 1  ON 23
 eO_4                 5.254629e-01 1 1  ON 24
 eO_5                 4.877434e-01 1 1  ON 25
 eO_6                 2.599434e-01 1 1  ON 26
 eO_7                -4.070907e-02 1 1  ON 27
 eO_8                -2.214931e-01 1 1  ON 28
 eO_9                -8.657808e-02 1 1  ON 29
eH1_0                -2.448071e-01 1 1  ON 30
eH1_1                -1.453298e-01 1 1  ON 31
eH1_2                -9.857292e-02 1 1  ON 32
eH1_3                -4.481955e-02 1 1  ON 33
eH1_4                 3.387848e-03 1 1  ON 34
eH1_5                 3.808509e-02 1 1  ON 35
eH1_6                 9.660182e-02 1 1  ON 36
eH1_7                 1.541308e-01 1 1  ON 37
eH1_8                 1.773045e-01 1 1  ON 38
eH1_9                 6.802155e-02 1 1  ON 39
eH2_0                -2.424789e-01 1 1  ON 40
eH2_1                -1.430038e-01 1 1  ON 41
eH2_2                -9.649397e-02 1 1  ON 42
eH2_3                -4.247686e-02 1 1  ON 43
eH2_4                 5.597607e-03 1 1  ON 44
eH2_5                 4.022753e-02 1 1  ON 45
eH2_6                 9.942340e-02 1 1  ON 46
eH2_7                 1.552519e-01 1 1  ON 47
eH2_8                 1.828311e-01 1 1  ON 48
eH2_9                 5.764204e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.864
    reference variance = 0.223907
====================================================
  Execution time = 2.0803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337472648416
                                         uncertainty =       0.003929036611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337472648416
                                         uncertainty =       0.003929036611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410737754
  error estimate for blocks of size 2^( 2) =       0.000423256642
  error estimate for blocks of size 2^( 3) =       0.000435779380
  error estimate for blocks of size 2^( 4) =       0.000448001606
  error estimate for blocks of size 2^( 5) =       0.000457709940
  error estimate for blocks of size 2^( 6) =       0.000465450444
  error estimate for blocks of size 2^( 7) =       0.000469848079

      target function =                  N/A
              le_mean =     -16.906313367061
             les_mean =     286.160842501992
             stat err =       0.000460252517
             autocorr =       1.255634085853
              std dev =       0.580870902563
             le_variance =       0.337411005444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631336706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313367061       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313634302       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313840141       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313885599       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313993944       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906314087756       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314123403       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906314168822       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.143427e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313367061       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313437421       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313491688       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313500292       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313530542       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313554816       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313561813       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313575345       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.996775e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313367061       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313384887       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313398633       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313400605       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313408386       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313414540       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313416135       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313419631       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.578694e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6443e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.092570e-01 1 1  ON 0
 uu_1                 1.425006e-01 1 1  ON 1
 uu_2                 4.101891e-02 1 1  ON 2
 uu_3                -2.133142e-02 1 1  ON 3
 uu_4                -6.662865e-02 1 1  ON 4
 uu_5                -1.013625e-01 1 1  ON 5
 uu_6                -1.284281e-01 1 1  ON 6
 uu_7                -1.415972e-01 1 1  ON 7
 uu_8                -1.334972e-01 1 1  ON 8
 uu_9                -1.050614e-01 1 1  ON 9
 ud_0                 4.479392e-01 1 1  ON 10
 ud_1                 1.825984e-01 1 1  ON 11
 ud_2                 6.291126e-02 1 1  ON 12
 ud_3                -7.673155e-03 1 1  ON 13
 ud_4                -6.488722e-02 1 1  ON 14
 ud_5                -1.069886e-01 1 1  ON 15
 ud_6                -1.349702e-01 1 1  ON 16
 ud_7                -1.520620e-01 1 1  ON 17
 ud_8                -1.529738e-01 1 1  ON 18
 ud_9                -1.433764e-01 1 1  ON 19
 eO_0                -7.601624e-01 1 1  ON 20
 eO_1                -4.398489e-01 1 1  ON 21
 eO_2                -2.165223e-02 1 1  ON 22
 eO_3                 2.987279e-01 1 1  ON 23
 eO_4                 5.254686e-01 1 1  ON 24
 eO_5                 4.877456e-01 1 1  ON 25
 eO_6                 2.599481e-01 1 1  ON 26
 eO_7                -4.071167e-02 1 1  ON 27
 eO_8                -2.215036e-01 1 1  ON 28
 eO_9                -8.658971e-02 1 1  ON 29
eH1_0                -2.448346e-01 1 1  ON 30
eH1_1                -1.453522e-01 1 1  ON 31
eH1_2                -9.857350e-02 1 1  ON 32
eH1_3                -4.483218e-02 1 1  ON 33
eH1_4                 3.392257e-03 1 1  ON 34
eH1_5                 3.809321e-02 1 1  ON 35
eH1_6                 9.662030e-02 1 1  ON 36
eH1_7                 1.541418e-01 1 1  ON 37
eH1_8                 1.773105e-01 1 1  ON 38
eH1_9                 6.803527e-02 1 1  ON 39
eH2_0                -2.425066e-01 1 1  ON 40
eH2_1                -1.430154e-01 1 1  ON 41
eH2_2                -9.649011e-02 1 1  ON 42
eH2_3                -4.247896e-02 1 1  ON 43
eH2_4                 5.611244e-03 1 1  ON 44
eH2_5                 4.023096e-02 1 1  ON 45
eH2_6                 9.941848e-02 1 1  ON 46
eH2_7                 1.552466e-01 1 1  ON 47
eH2_8                 1.828397e-01 1 1  ON 48
eH2_9                 5.766212e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.224393
====================================================
  Execution time = 2.0088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3805e-01
  Total weights = 2.0000e+06
  Execution time = 1.8589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338096593308
                                         uncertainty =       0.003248015352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338096593308
                                         uncertainty =       0.003248015352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117119
  error estimate for blocks of size 2^( 2) =       0.000423626434
  error estimate for blocks of size 2^( 3) =       0.000436370735
  error estimate for blocks of size 2^( 4) =       0.000448125627
  error estimate for blocks of size 2^( 5) =       0.000457920092
  error estimate for blocks of size 2^( 6) =       0.000467888072
  error estimate for blocks of size 2^( 7) =       0.000471955446

      target function =                  N/A
              le_mean =     -16.906735637335
             les_mean =     286.175744312221
             stat err =       0.000461472309
             autocorr =       1.259969900079
              std dev =       0.581407404919
             le_variance =       0.338034570494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338169885578
                                         uncertainty =       0.003248867688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338169885578
                                         uncertainty =       0.003248867688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411161675
  error estimate for blocks of size 2^( 2) =       0.000423666689
  error estimate for blocks of size 2^( 3) =       0.000436406217
  error estimate for blocks of size 2^( 4) =       0.000448157964
  error estimate for blocks of size 2^( 5) =       0.000457951505
  error estimate for blocks of size 2^( 6) =       0.000467919537
  error estimate for blocks of size 2^( 7) =       0.000471983002

      target function =                  N/A
              le_mean =     -16.906735767962
             les_mean =     286.175822003905
             stat err =       0.000461503002
             autocorr =       1.259864412022
              std dev =       0.581470416494
             le_variance =       0.338107845257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338135148587
                                         uncertainty =       0.003248464164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338135148587
                                         uncertainty =       0.003248464164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411140558
  error estimate for blocks of size 2^( 2) =       0.000423647584
  error estimate for blocks of size 2^( 3) =       0.000436389355
  error estimate for blocks of size 2^( 4) =       0.000448142588
  error estimate for blocks of size 2^( 5) =       0.000457936582
  error estimate for blocks of size 2^( 6) =       0.000467904574
  error estimate for blocks of size 2^( 7) =       0.000471969848

      target function =                  N/A
              le_mean =     -16.906735706832
             les_mean =     286.175785207824
             stat err =       0.000461488398
             autocorr =       1.259914090121
              std dev =       0.581440552584
             le_variance =       0.338073116189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338101464979
                                         uncertainty =       0.003248072070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338101464979
                                         uncertainty =       0.003248072070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411120080
  error estimate for blocks of size 2^( 2) =       0.000423629104
  error estimate for blocks of size 2^( 3) =       0.000436373084
  error estimate for blocks of size 2^( 4) =       0.000448127765
  error estimate for blocks of size 2^( 5) =       0.000457922171
  error estimate for blocks of size 2^( 6) =       0.000467890152
  error estimate for blocks of size 2^( 7) =       0.000471957258

      target function =                  N/A
              le_mean =     -16.906735645072
             les_mean =     286.175749444257
             stat err =       0.000461474336
             autocorr =       1.259962817087
              std dev =       0.581411593400
             le_variance =       0.338039440940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906735637335        initial
     2.4414e+00     2.4414e+01             1.1434e-04       -16.906735767962  <--
     9.7656e+00     9.7656e+01             2.9968e-05       -16.906735706832
     3.9062e+01     3.9062e+02             7.5787e-06       -16.906735645072

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9483e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.092631e-01 1 1  ON 0
 uu_1                 1.425287e-01 1 1  ON 1
 uu_2                 4.103950e-02 1 1  ON 2
 uu_3                -2.133868e-02 1 1  ON 3
 uu_4                -6.665071e-02 1 1  ON 4
 uu_5                -1.013685e-01 1 1  ON 5
 uu_6                -1.284445e-01 1 1  ON 6
 uu_7                -1.416176e-01 1 1  ON 7
 uu_8                -1.335166e-01 1 1  ON 8
 uu_9                -1.050664e-01 1 1  ON 9
 ud_0                 4.480236e-01 1 1  ON 10
 ud_1                 1.826418e-01 1 1  ON 11
 ud_2                 6.291756e-02 1 1  ON 12
 ud_3                -7.694549e-03 1 1  ON 13
 ud_4                -6.490016e-02 1 1  ON 14
 ud_5                -1.070070e-01 1 1  ON 15
 ud_6                -1.349746e-01 1 1  ON 16
 ud_7                -1.521086e-01 1 1  ON 17
 ud_8                -1.529999e-01 1 1  ON 18
 ud_9                -1.433573e-01 1 1  ON 19
 eO_0                -7.602101e-01 1 1  ON 20
 eO_1                -4.398159e-01 1 1  ON 21
 eO_2                -2.160467e-02 1 1  ON 22
 eO_3                 2.987391e-01 1 1  ON 23
 eO_4                 5.254851e-01 1 1  ON 24
 eO_5                 4.877525e-01 1 1  ON 25
 eO_6                 2.599622e-01 1 1  ON 26
 eO_7                -4.071916e-02 1 1  ON 27
 eO_8                -2.215349e-01 1 1  ON 28
 eO_9                -8.662422e-02 1 1  ON 29
eH1_0                -2.449162e-01 1 1  ON 30
eH1_1                -1.454165e-01 1 1  ON 31
eH1_2                -9.857810e-02 1 1  ON 32
eH1_3                -4.486843e-02 1 1  ON 33
eH1_4                 3.403997e-03 1 1  ON 34
eH1_5                 3.811744e-02 1 1  ON 35
eH1_6                 9.667551e-02 1 1  ON 36
eH1_7                 1.541746e-01 1 1  ON 37
eH1_8                 1.773286e-01 1 1  ON 38
eH1_9                 6.807599e-02 1 1  ON 39
eH2_0                -2.425878e-01 1 1  ON 40
eH2_1                -1.430493e-01 1 1  ON 41
eH2_2                -9.648019e-02 1 1  ON 42
eH2_3                -4.248392e-02 1 1  ON 43
eH2_4                 5.650409e-03 1 1  ON 44
eH2_5                 4.024154e-02 1 1  ON 45
eH2_6                 9.940391e-02 1 1  ON 46
eH2_7                 1.552307e-01 1 1  ON 47
eH2_8                 1.828653e-01 1 1  ON 48
eH2_9                 5.772166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9526
    reference variance = 0.865725
====================================================
  Execution time = 2.0863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341717428106
                                         uncertainty =       0.012127827921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341717428106
                                         uncertainty =       0.012127827921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413377487
  error estimate for blocks of size 2^( 2) =       0.000425804815
  error estimate for blocks of size 2^( 3) =       0.000438781526
  error estimate for blocks of size 2^( 4) =       0.000451813847
  error estimate for blocks of size 2^( 5) =       0.000461427846
  error estimate for blocks of size 2^( 6) =       0.000467791471
  error estimate for blocks of size 2^( 7) =       0.000472440978

      target function =                  N/A
              le_mean =     -16.906615387535
             les_mean =     286.175405585411
             stat err =       0.000463368536
             autocorr =       1.256491162061
              std dev =       0.584604049128
             le_variance =       0.341761894257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661538753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906615387535       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906615423442       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906616442629       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616976694       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906616801080       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906617285644       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906617131406       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906617387469       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906617397613       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906617329417       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 5.648207e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906615387535       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906615398467       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906615572857       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906615786133       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906615851199       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906615811524       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906615901129       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906615910582       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906615932059       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.495922e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906615387535       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906615390425       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906615425662       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906615482452       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906615512613       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906615492772       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906615515475       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906615520311       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906615525445       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.804072e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6499e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.092392e-01 1 1  ON 0
 uu_1                 1.425562e-01 1 1  ON 1
 uu_2                 4.105178e-02 1 1  ON 2
 uu_3                -2.133313e-02 1 1  ON 3
 uu_4                -6.665069e-02 1 1  ON 4
 uu_5                -1.013564e-01 1 1  ON 5
 uu_6                -1.284886e-01 1 1  ON 6
 uu_7                -1.416648e-01 1 1  ON 7
 uu_8                -1.335400e-01 1 1  ON 8
 uu_9                -1.050713e-01 1 1  ON 9
 ud_0                 4.481528e-01 1 1  ON 10
 ud_1                 1.826957e-01 1 1  ON 11
 ud_2                 6.291618e-02 1 1  ON 12
 ud_3                -7.754113e-03 1 1  ON 13
 ud_4                -6.496103e-02 1 1  ON 14
 ud_5                -1.070132e-01 1 1  ON 15
 ud_6                -1.349629e-01 1 1  ON 16
 ud_7                -1.521089e-01 1 1  ON 17
 ud_8                -1.530290e-01 1 1  ON 18
 ud_9                -1.433724e-01 1 1  ON 19
 eO_0                -7.602400e-01 1 1  ON 20
 eO_1                -4.397565e-01 1 1  ON 21
 eO_2                -2.159796e-02 1 1  ON 22
 eO_3                 2.987693e-01 1 1  ON 23
 eO_4                 5.254897e-01 1 1  ON 24
 eO_5                 4.877625e-01 1 1  ON 25
 eO_6                 2.599902e-01 1 1  ON 26
 eO_7                -4.071234e-02 1 1  ON 27
 eO_8                -2.215846e-01 1 1  ON 28
 eO_9                -8.668004e-02 1 1  ON 29
eH1_0                -2.450658e-01 1 1  ON 30
eH1_1                -1.454474e-01 1 1  ON 31
eH1_2                -9.860760e-02 1 1  ON 32
eH1_3                -4.487920e-02 1 1  ON 33
eH1_4                 3.478946e-03 1 1  ON 34
eH1_5                 3.814759e-02 1 1  ON 35
eH1_6                 9.662897e-02 1 1  ON 36
eH1_7                 1.541475e-01 1 1  ON 37
eH1_8                 1.774011e-01 1 1  ON 38
eH1_9                 6.817872e-02 1 1  ON 39
eH2_0                -2.427339e-01 1 1  ON 40
eH2_1                -1.431311e-01 1 1  ON 41
eH2_2                -9.646593e-02 1 1  ON 42
eH2_3                -4.243734e-02 1 1  ON 43
eH2_4                 5.704743e-03 1 1  ON 44
eH2_5                 4.025253e-02 1 1  ON 45
eH2_6                 9.939678e-02 1 1  ON 46
eH2_7                 1.552254e-01 1 1  ON 47
eH2_8                 1.828998e-01 1 1  ON 48
eH2_9                 5.779699e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9192
    reference variance = 0.268598
====================================================
  Execution time = 2.0166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3665e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336680821692
                                         uncertainty =       0.003283855370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336680821692
                                         uncertainty =       0.003283855370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410226620
  error estimate for blocks of size 2^( 2) =       0.000423187694
  error estimate for blocks of size 2^( 3) =       0.000436376676
  error estimate for blocks of size 2^( 4) =       0.000448285459
  error estimate for blocks of size 2^( 5) =       0.000458496264
  error estimate for blocks of size 2^( 6) =       0.000464766212
  error estimate for blocks of size 2^( 7) =       0.000467824788

      target function =                  N/A
              le_mean =     -16.906779270099
             les_mean =     286.175756878823
             stat err =       0.000459843181
             autocorr =       1.256526995282
              std dev =       0.580148049436
             le_variance =       0.336571759265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336927551397
                                         uncertainty =       0.003286320393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336927551397
                                         uncertainty =       0.003286320393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410376895
  error estimate for blocks of size 2^( 2) =       0.000423325051
  error estimate for blocks of size 2^( 3) =       0.000436501138
  error estimate for blocks of size 2^( 4) =       0.000448402026
  error estimate for blocks of size 2^( 5) =       0.000458608000
  error estimate for blocks of size 2^( 6) =       0.000464885737
  error estimate for blocks of size 2^( 7) =       0.000467939350

      target function =                  N/A
              le_mean =     -16.906776918643
             les_mean =     286.175924000728
             stat err =       0.000459958778
             autocorr =       1.256238271092
              std dev =       0.580360571004
             le_variance =       0.336818392376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336845693010
                                         uncertainty =       0.003285558670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336845693010
                                         uncertainty =       0.003285558670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410327042
  error estimate for blocks of size 2^( 2) =       0.000423279716
  error estimate for blocks of size 2^( 3) =       0.000436460416
  error estimate for blocks of size 2^( 4) =       0.000448364167
  error estimate for blocks of size 2^( 5) =       0.000458571691
  error estimate for blocks of size 2^( 6) =       0.000464846035
  error estimate for blocks of size 2^( 7) =       0.000467901066

      target function =                  N/A
              le_mean =     -16.906777769831
             les_mean =     286.175870952765
             stat err =       0.000459920740
             autocorr =       1.256335725424
              std dev =       0.580290067713
             le_variance =       0.336736562687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336702990719
                                         uncertainty =       0.003284087616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336702990719
                                         uncertainty =       0.003284087616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410240124
  error estimate for blocks of size 2^( 2) =       0.000423200058
  error estimate for blocks of size 2^( 3) =       0.000436387918
  error estimate for blocks of size 2^( 4) =       0.000448296019
  error estimate for blocks of size 2^( 5) =       0.000458506371
  error estimate for blocks of size 2^( 6) =       0.000464776887
  error estimate for blocks of size 2^( 7) =       0.000467834972

      target function =                  N/A
              le_mean =     -16.906779044486
             les_mean =     286.175771409737
             stat err =       0.000459853562
             autocorr =       1.256501004524
              std dev =       0.580167147426
             le_variance =       0.336593918953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906779270099        initial  <--
     6.1035e-01     6.1035e+00             5.6482e-04       -16.906776918643
     2.4414e+00     2.4414e+01             1.4959e-04       -16.906777769831
     9.7656e+00     9.7656e+01             3.8041e-05       -16.906779044486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6148
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.092631e-01 1 1  ON 0
 uu_1                 1.425287e-01 1 1  ON 1
 uu_2                 4.103950e-02 1 1  ON 2
 uu_3                -2.133868e-02 1 1  ON 3
 uu_4                -6.665071e-02 1 1  ON 4
 uu_5                -1.013685e-01 1 1  ON 5
 uu_6                -1.284445e-01 1 1  ON 6
 uu_7                -1.416176e-01 1 1  ON 7
 uu_8                -1.335166e-01 1 1  ON 8
 uu_9                -1.050664e-01 1 1  ON 9
 ud_0                 4.480236e-01 1 1  ON 10
 ud_1                 1.826418e-01 1 1  ON 11
 ud_2                 6.291756e-02 1 1  ON 12
 ud_3                -7.694549e-03 1 1  ON 13
 ud_4                -6.490016e-02 1 1  ON 14
 ud_5                -1.070070e-01 1 1  ON 15
 ud_6                -1.349746e-01 1 1  ON 16
 ud_7                -1.521086e-01 1 1  ON 17
 ud_8                -1.529999e-01 1 1  ON 18
 ud_9                -1.433573e-01 1 1  ON 19
 eO_0                -7.602101e-01 1 1  ON 20
 eO_1                -4.398159e-01 1 1  ON 21
 eO_2                -2.160467e-02 1 1  ON 22
 eO_3                 2.987391e-01 1 1  ON 23
 eO_4                 5.254851e-01 1 1  ON 24
 eO_5                 4.877525e-01 1 1  ON 25
 eO_6                 2.599622e-01 1 1  ON 26
 eO_7                -4.071916e-02 1 1  ON 27
 eO_8                -2.215349e-01 1 1  ON 28
 eO_9                -8.662422e-02 1 1  ON 29
eH1_0                -2.449162e-01 1 1  ON 30
eH1_1                -1.454165e-01 1 1  ON 31
eH1_2                -9.857810e-02 1 1  ON 32
eH1_3                -4.486843e-02 1 1  ON 33
eH1_4                 3.403997e-03 1 1  ON 34
eH1_5                 3.811744e-02 1 1  ON 35
eH1_6                 9.667551e-02 1 1  ON 36
eH1_7                 1.541746e-01 1 1  ON 37
eH1_8                 1.773286e-01 1 1  ON 38
eH1_9                 6.807599e-02 1 1  ON 39
eH2_0                -2.425878e-01 1 1  ON 40
eH2_1                -1.430493e-01 1 1  ON 41
eH2_2                -9.648019e-02 1 1  ON 42
eH2_3                -4.248392e-02 1 1  ON 43
eH2_4                 5.650409e-03 1 1  ON 44
eH2_5                 4.024154e-02 1 1  ON 45
eH2_6                 9.940391e-02 1 1  ON 46
eH2_7                 1.552307e-01 1 1  ON 47
eH2_8                 1.828653e-01 1 1  ON 48
eH2_9                 5.772166e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8691
    reference variance = 0.278555
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240901580
                                         uncertainty =       0.003199925496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339240901580
                                         uncertainty =       0.003199925496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411821133
  error estimate for blocks of size 2^( 2) =       0.000424821845
  error estimate for blocks of size 2^( 3) =       0.000438361759
  error estimate for blocks of size 2^( 4) =       0.000450581669
  error estimate for blocks of size 2^( 5) =       0.000461681983
  error estimate for blocks of size 2^( 6) =       0.000473111750
  error estimate for blocks of size 2^( 7) =       0.000478618575

      target function =                  N/A
              le_mean =     -16.907080678574
             les_mean =     286.188570193878
             stat err =       0.000465998494
             autocorr =       1.280417992499
              std dev =       0.582403031972
             le_variance =       0.339193291650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690708067857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907080678574       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907080852348       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907081040837       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907081133637       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907081125777       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907081095294       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907081114847       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907081089377       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.702999e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907080678574       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907080722912       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907080771819       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907080795268       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907080793600       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907080785798       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907080790452       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907080784146       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.185020e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907080678574       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907080689716       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907080702060       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907080707938       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907080707543       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907080705582       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907080706730       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907080705157       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.968399e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6367e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.092612e-01 1 1  ON 0
 uu_1                 1.425323e-01 1 1  ON 1
 uu_2                 4.104148e-02 1 1  ON 2
 uu_3                -2.133565e-02 1 1  ON 3
 uu_4                -6.664686e-02 1 1  ON 4
 uu_5                -1.013712e-01 1 1  ON 5
 uu_6                -1.284465e-01 1 1  ON 6
 uu_7                -1.416232e-01 1 1  ON 7
 uu_8                -1.335242e-01 1 1  ON 8
 uu_9                -1.050674e-01 1 1  ON 9
 ud_0                 4.480287e-01 1 1  ON 10
 ud_1                 1.826479e-01 1 1  ON 11
 ud_2                 6.291569e-02 1 1  ON 12
 ud_3                -7.697935e-03 1 1  ON 13
 ud_4                -6.490482e-02 1 1  ON 14
 ud_5                -1.070093e-01 1 1  ON 15
 ud_6                -1.349759e-01 1 1  ON 16
 ud_7                -1.521079e-01 1 1  ON 17
 ud_8                -1.529991e-01 1 1  ON 18
 ud_9                -1.433560e-01 1 1  ON 19
 eO_0                -7.602163e-01 1 1  ON 20
 eO_1                -4.398086e-01 1 1  ON 21
 eO_2                -2.160633e-02 1 1  ON 22
 eO_3                 2.987421e-01 1 1  ON 23
 eO_4                 5.254885e-01 1 1  ON 24
 eO_5                 4.877516e-01 1 1  ON 25
 eO_6                 2.599661e-01 1 1  ON 26
 eO_7                -4.072007e-02 1 1  ON 27
 eO_8                -2.215393e-01 1 1  ON 28
 eO_9                -8.662791e-02 1 1  ON 29
eH1_0                -2.449280e-01 1 1  ON 30
eH1_1                -1.454206e-01 1 1  ON 31
eH1_2                -9.857555e-02 1 1  ON 32
eH1_3                -4.486362e-02 1 1  ON 33
eH1_4                 3.406048e-03 1 1  ON 34
eH1_5                 3.811619e-02 1 1  ON 35
eH1_6                 9.667090e-02 1 1  ON 36
eH1_7                 1.541745e-01 1 1  ON 37
eH1_8                 1.773319e-01 1 1  ON 38
eH1_9                 6.808341e-02 1 1  ON 39
eH2_0                -2.425976e-01 1 1  ON 40
eH2_1                -1.430529e-01 1 1  ON 41
eH2_2                -9.648306e-02 1 1  ON 42
eH2_3                -4.248245e-02 1 1  ON 43
eH2_4                 5.656574e-03 1 1  ON 44
eH2_5                 4.024177e-02 1 1  ON 45
eH2_6                 9.940045e-02 1 1  ON 46
eH2_7                 1.552301e-01 1 1  ON 47
eH2_8                 1.828702e-01 1 1  ON 48
eH2_9                 5.772911e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.24509
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4035e-01
  Total weights = 2.0000e+06
  Execution time = 1.8677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340335385193
                                         uncertainty =       0.004297494925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340335385193
                                         uncertainty =       0.004297494925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412521563
  error estimate for blocks of size 2^( 2) =       0.000425720289
  error estimate for blocks of size 2^( 3) =       0.000438258732
  error estimate for blocks of size 2^( 4) =       0.000450407464
  error estimate for blocks of size 2^( 5) =       0.000460703143
  error estimate for blocks of size 2^( 6) =       0.000470117256
  error estimate for blocks of size 2^( 7) =       0.000474956087

      target function =                  N/A
              le_mean =     -16.905234839958
             les_mean =     286.127312903260
             stat err =       0.000464045988
             autocorr =       1.265402637639
              std dev =       0.583393588671
             le_variance =       0.340348079302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340348189939
                                         uncertainty =       0.004297783495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340348189939
                                         uncertainty =       0.004297783495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412529325
  error estimate for blocks of size 2^( 2) =       0.000425726983
  error estimate for blocks of size 2^( 3) =       0.000438264273
  error estimate for blocks of size 2^( 4) =       0.000450412263
  error estimate for blocks of size 2^( 5) =       0.000460707839
  error estimate for blocks of size 2^( 6) =       0.000470121653
  error estimate for blocks of size 2^( 7) =       0.000474961450

      target function =                  N/A
              le_mean =     -16.905234909066
             les_mean =     286.127328048008
             stat err =       0.000464050801
             autocorr =       1.265381271508
              std dev =       0.583404565875
             le_variance =       0.340360887484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340341735325
                                         uncertainty =       0.004297637437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340341735325
                                         uncertainty =       0.004297637437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412525412
  error estimate for blocks of size 2^( 2) =       0.000425723591
  error estimate for blocks of size 2^( 3) =       0.000438261449
  error estimate for blocks of size 2^( 4) =       0.000450409805
  error estimate for blocks of size 2^( 5) =       0.000460705437
  error estimate for blocks of size 2^( 6) =       0.000470119387
  error estimate for blocks of size 2^( 7) =       0.000474958718

      target function =                  N/A
              le_mean =     -16.905234871902
             les_mean =     286.127320334944
             stat err =       0.000464048337
             autocorr =       1.265391834751
              std dev =       0.583399032356
             le_variance =       0.340354430954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336175809
                                         uncertainty =       0.004297512663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336175809
                                         uncertainty =       0.004297512663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412522042
  error estimate for blocks of size 2^( 2) =       0.000425720699
  error estimate for blocks of size 2^( 3) =       0.000438259069
  error estimate for blocks of size 2^( 4) =       0.000450407754
  error estimate for blocks of size 2^( 5) =       0.000460703427
  error estimate for blocks of size 2^( 6) =       0.000470117519
  error estimate for blocks of size 2^( 7) =       0.000474956413

      target function =                  N/A
              le_mean =     -16.905234843707
             les_mean =     286.127313820819
             stat err =       0.000464046278
             autocorr =       1.265401283109
              std dev =       0.583394266428
             le_variance =       0.340348870101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905234839958        initial
     6.1035e+00     6.1035e+01             4.7030e-05       -16.905234909066  <--
     2.4414e+01     2.4414e+02             1.1850e-05       -16.905234871902
     9.7656e+01     9.7656e+02             2.9684e-06       -16.905234843707

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.3177e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.092564e-01 1 1  ON 0
 uu_1                 1.425427e-01 1 1  ON 1
 uu_2                 4.104724e-02 1 1  ON 2
 uu_3                -2.132664e-02 1 1  ON 3
 uu_4                -6.663598e-02 1 1  ON 4
 uu_5                -1.013786e-01 1 1  ON 5
 uu_6                -1.284525e-01 1 1  ON 6
 uu_7                -1.416400e-01 1 1  ON 7
 uu_8                -1.335469e-01 1 1  ON 8
 uu_9                -1.050705e-01 1 1  ON 9
 ud_0                 4.480443e-01 1 1  ON 10
 ud_1                 1.826651e-01 1 1  ON 11
 ud_2                 6.291085e-02 1 1  ON 12
 ud_3                -7.708093e-03 1 1  ON 13
 ud_4                -6.491848e-02 1 1  ON 14
 ud_5                -1.070162e-01 1 1  ON 15
 ud_6                -1.349797e-01 1 1  ON 16
 ud_7                -1.521056e-01 1 1  ON 17
 ud_8                -1.529966e-01 1 1  ON 18
 ud_9                -1.433523e-01 1 1  ON 19
 eO_0                -7.602336e-01 1 1  ON 20
 eO_1                -4.397880e-01 1 1  ON 21
 eO_2                -2.161083e-02 1 1  ON 22
 eO_3                 2.987508e-01 1 1  ON 23
 eO_4                 5.254988e-01 1 1  ON 24
 eO_5                 4.877491e-01 1 1  ON 25
 eO_6                 2.599778e-01 1 1  ON 26
 eO_7                -4.072280e-02 1 1  ON 27
 eO_8                -2.215523e-01 1 1  ON 28
 eO_9                -8.663890e-02 1 1  ON 29
eH1_0                -2.449632e-01 1 1  ON 30
eH1_1                -1.454326e-01 1 1  ON 31
eH1_2                -9.856813e-02 1 1  ON 32
eH1_3                -4.484954e-02 1 1  ON 33
eH1_4                 3.412384e-03 1 1  ON 34
eH1_5                 3.811235e-02 1 1  ON 35
eH1_6                 9.665713e-02 1 1  ON 36
eH1_7                 1.541742e-01 1 1  ON 37
eH1_8                 1.773419e-01 1 1  ON 38
eH1_9                 6.810554e-02 1 1  ON 39
eH2_0                -2.426268e-01 1 1  ON 40
eH2_1                -1.430637e-01 1 1  ON 41
eH2_2                -9.649136e-02 1 1  ON 42
eH2_3                -4.247832e-02 1 1  ON 43
eH2_4                 5.674853e-03 1 1  ON 44
eH2_5                 4.024251e-02 1 1  ON 45
eH2_6                 9.939015e-02 1 1  ON 46
eH2_7                 1.552281e-01 1 1  ON 47
eH2_8                 1.828848e-01 1 1  ON 48
eH2_9                 5.775132e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8327
    reference variance = 1.37774
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5371e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340561272354
                                         uncertainty =       0.003760080101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340561272354
                                         uncertainty =       0.003760080101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420542871
  error estimate for blocks of size 2^( 2) =       0.000432719718
  error estimate for blocks of size 2^( 3) =       0.000445823547
  error estimate for blocks of size 2^( 4) =       0.000457822510
  error estimate for blocks of size 2^( 5) =       0.000460584784
  error estimate for blocks of size 2^( 6) =       0.000468372122
  error estimate for blocks of size 2^( 7) =       0.000473229481

      target function =                  N/A
              le_mean =     -16.905108766614
             les_mean =     286.136414846278
             stat err =       0.000465002224
             autocorr =       1.222614412029
              std dev =       0.594737431214
             le_variance =       0.353712612086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510876661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108766614       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905110234541       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905110758228       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905110714817       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905110174403       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905110510046       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905110683448       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905110671954       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905110615793       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.375556e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108766614       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905109167153       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905109309041       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905109316590       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905109159191       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905109204076       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905109281874       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905109283625       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.087616e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905108766614       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905108869091       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905108905280       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905108908660       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905108868510       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905108876799       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905108897765       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905108898608       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.532171e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6068e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.092754e-01 1 1  ON 0
 uu_1                 1.425456e-01 1 1  ON 1
 uu_2                 4.103861e-02 1 1  ON 2
 uu_3                -2.133318e-02 1 1  ON 3
 uu_4                -6.665321e-02 1 1  ON 4
 uu_5                -1.013665e-01 1 1  ON 5
 uu_6                -1.284517e-01 1 1  ON 6
 uu_7                -1.416680e-01 1 1  ON 7
 uu_8                -1.335588e-01 1 1  ON 8
 uu_9                -1.050654e-01 1 1  ON 9
 ud_0                 4.480877e-01 1 1  ON 10
 ud_1                 1.826926e-01 1 1  ON 11
 ud_2                 6.290837e-02 1 1  ON 12
 ud_3                -7.721736e-03 1 1  ON 13
 ud_4                -6.494522e-02 1 1  ON 14
 ud_5                -1.070253e-01 1 1  ON 15
 ud_6                -1.349909e-01 1 1  ON 16
 ud_7                -1.521118e-01 1 1  ON 17
 ud_8                -1.529940e-01 1 1  ON 18
 ud_9                -1.433543e-01 1 1  ON 19
 eO_0                -7.602448e-01 1 1  ON 20
 eO_1                -4.397729e-01 1 1  ON 21
 eO_2                -2.161323e-02 1 1  ON 22
 eO_3                 2.987738e-01 1 1  ON 23
 eO_4                 5.254972e-01 1 1  ON 24
 eO_5                 4.877678e-01 1 1  ON 25
 eO_6                 2.599742e-01 1 1  ON 26
 eO_7                -4.072268e-02 1 1  ON 27
 eO_8                -2.215653e-01 1 1  ON 28
 eO_9                -8.666045e-02 1 1  ON 29
eH1_0                -2.450037e-01 1 1  ON 30
eH1_1                -1.454538e-01 1 1  ON 31
eH1_2                -9.858405e-02 1 1  ON 32
eH1_3                -4.482750e-02 1 1  ON 33
eH1_4                 3.411291e-03 1 1  ON 34
eH1_5                 3.810766e-02 1 1  ON 35
eH1_6                 9.665923e-02 1 1  ON 36
eH1_7                 1.541727e-01 1 1  ON 37
eH1_8                 1.773700e-01 1 1  ON 38
eH1_9                 6.813904e-02 1 1  ON 39
eH2_0                -2.426876e-01 1 1  ON 40
eH2_1                -1.430755e-01 1 1  ON 41
eH2_2                -9.649779e-02 1 1  ON 42
eH2_3                -4.248388e-02 1 1  ON 43
eH2_4                 5.687803e-03 1 1  ON 44
eH2_5                 4.024744e-02 1 1  ON 45
eH2_6                 9.939103e-02 1 1  ON 46
eH2_7                 1.552405e-01 1 1  ON 47
eH2_8                 1.829032e-01 1 1  ON 48
eH2_9                 5.778277e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.856
    reference variance = 0.182102
====================================================
  Execution time = 2.2273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3106e-01
  Total weights = 2.0000e+06
  Execution time = 1.8564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331055533174
                                         uncertainty =       0.002674357878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331055533174
                                         uncertainty =       0.002674357878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406829601
  error estimate for blocks of size 2^( 2) =       0.000419755910
  error estimate for blocks of size 2^( 3) =       0.000432240019
  error estimate for blocks of size 2^( 4) =       0.000444901257
  error estimate for blocks of size 2^( 5) =       0.000456586127
  error estimate for blocks of size 2^( 6) =       0.000465517073
  error estimate for blocks of size 2^( 7) =       0.000470046654

      target function =                  N/A
              le_mean =     -16.905816086819
             les_mean =     286.137638044588
             stat err =       0.000459262778
             autocorr =       1.274375480199
              std dev =       0.575343939523
             le_variance =       0.331020648746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331194003735
                                         uncertainty =       0.002675425019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331194003735
                                         uncertainty =       0.002675425019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406914672
  error estimate for blocks of size 2^( 2) =       0.000419833736
  error estimate for blocks of size 2^( 3) =       0.000432310641
  error estimate for blocks of size 2^( 4) =       0.000444966923
  error estimate for blocks of size 2^( 5) =       0.000456649929
  error estimate for blocks of size 2^( 6) =       0.000465578508
  error estimate for blocks of size 2^( 7) =       0.000470104106

      target function =                  N/A
              le_mean =     -16.905816344557
             les_mean =     286.137785211177
             stat err =       0.000459324866
             autocorr =       1.274187133781
              std dev =       0.575464248116
             le_variance =       0.331159100860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132768184
                                         uncertainty =       0.002674967309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132768184
                                         uncertainty =       0.002674967309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406877056
  error estimate for blocks of size 2^( 2) =       0.000419799333
  error estimate for blocks of size 2^( 3) =       0.000432279463
  error estimate for blocks of size 2^( 4) =       0.000444937974
  error estimate for blocks of size 2^( 5) =       0.000456621809
  error estimate for blocks of size 2^( 6) =       0.000465551497
  error estimate for blocks of size 2^( 7) =       0.000470078939

      target function =                  N/A
              le_mean =     -16.905816212439
             les_mean =     286.137719520252
             stat err =       0.000459297555
             autocorr =       1.274271196472
              std dev =       0.575411050499
             le_variance =       0.331097877037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331065407258
                                         uncertainty =       0.002674436506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331065407258
                                         uncertainty =       0.002674436506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406835668
  error estimate for blocks of size 2^( 2) =       0.000419761456
  error estimate for blocks of size 2^( 3) =       0.000432245051
  error estimate for blocks of size 2^( 4) =       0.000444905939
  error estimate for blocks of size 2^( 5) =       0.000456590677
  error estimate for blocks of size 2^( 6) =       0.000465521462
  error estimate for blocks of size 2^( 7) =       0.000470050766

      target function =                  N/A
              le_mean =     -16.905816098778
             les_mean =     286.137648322162
             stat err =       0.000459267211
             autocorr =       1.274362073677
              std dev =       0.575352519743
             le_variance =       0.331030521975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905816086819        initial
     1.5259e+00     1.5259e+01             2.3756e-04       -16.905816344557  <--
     6.1035e+00     6.1035e+01             6.0876e-05       -16.905816212439
     2.4414e+01     2.4414e+02             1.5322e-05       -16.905816098778

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.1653e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.187156
====================================================
  Execution time = 2.0609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348695141287
                                         uncertainty =       0.014609649219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348695141287
                                         uncertainty =       0.014609649219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417637272
  error estimate for blocks of size 2^( 2) =       0.000430621532
  error estimate for blocks of size 2^( 3) =       0.000444000868
  error estimate for blocks of size 2^( 4) =       0.000456325256
  error estimate for blocks of size 2^( 5) =       0.000466783352
  error estimate for blocks of size 2^( 6) =       0.000475597072
  error estimate for blocks of size 2^( 7) =       0.000480614686

      target function =                  N/A
              le_mean =     -16.905836162900
             les_mean =     286.156137974570
             stat err =       0.000469830092
             autocorr =       1.265561215713
              std dev =       0.590628294417
             le_variance =       0.348841782166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583616290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836162900       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905837867756       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839377625       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905840117775       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905840578925       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905840543225       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905840383017       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839784324       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905840036567       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905840029632       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.103998e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836162900       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905836724852       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837201819       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905837283228       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905837408257       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905837505346       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905837485872       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905837365366       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.856000e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836162900       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905836315541       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905836439699       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905836450873       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905836478214       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905836507557       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905836510712       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905836489753       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.691944e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6209e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093095e-01 1 1  ON 0
 uu_1                 1.425768e-01 1 1  ON 1
 uu_2                 4.108115e-02 1 1  ON 2
 uu_3                -2.133715e-02 1 1  ON 3
 uu_4                -6.668546e-02 1 1  ON 4
 uu_5                -1.014302e-01 1 1  ON 5
 uu_6                -1.284430e-01 1 1  ON 6
 uu_7                -1.417952e-01 1 1  ON 7
 uu_8                -1.336573e-01 1 1  ON 8
 uu_9                -1.050608e-01 1 1  ON 9
 ud_0                 4.483139e-01 1 1  ON 10
 ud_1                 1.828035e-01 1 1  ON 11
 ud_2                 6.294680e-02 1 1  ON 12
 ud_3                -7.833383e-03 1 1  ON 13
 ud_4                -6.504985e-02 1 1  ON 14
 ud_5                -1.070443e-01 1 1  ON 15
 ud_6                -1.350025e-01 1 1  ON 16
 ud_7                -1.520999e-01 1 1  ON 17
 ud_8                -1.530051e-01 1 1  ON 18
 ud_9                -1.433839e-01 1 1  ON 19
 eO_0                -7.603233e-01 1 1  ON 20
 eO_1                -4.396483e-01 1 1  ON 21
 eO_2                -2.159853e-02 1 1  ON 22
 eO_3                 2.987672e-01 1 1  ON 23
 eO_4                 5.255902e-01 1 1  ON 24
 eO_5                 4.878312e-01 1 1  ON 25
 eO_6                 2.599965e-01 1 1  ON 26
 eO_7                -4.068197e-02 1 1  ON 27
 eO_8                -2.216636e-01 1 1  ON 28
 eO_9                -8.680771e-02 1 1  ON 29
eH1_0                -2.453098e-01 1 1  ON 30
eH1_1                -1.456314e-01 1 1  ON 31
eH1_2                -9.868821e-02 1 1  ON 32
eH1_3                -4.473565e-02 1 1  ON 33
eH1_4                 3.429332e-03 1 1  ON 34
eH1_5                 3.811788e-02 1 1  ON 35
eH1_6                 9.661910e-02 1 1  ON 36
eH1_7                 1.541946e-01 1 1  ON 37
eH1_8                 1.776059e-01 1 1  ON 38
eH1_9                 6.837853e-02 1 1  ON 39
eH2_0                -2.430305e-01 1 1  ON 40
eH2_1                -1.431461e-01 1 1  ON 41
eH2_2                -9.650009e-02 1 1  ON 42
eH2_3                -4.252422e-02 1 1  ON 43
eH2_4                 5.736662e-03 1 1  ON 44
eH2_5                 4.033625e-02 1 1  ON 45
eH2_6                 9.938579e-02 1 1  ON 46
eH2_7                 1.552459e-01 1 1  ON 47
eH2_8                 1.829971e-01 1 1  ON 48
eH2_9                 5.798539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8755
    reference variance = 0.32483
====================================================
  Execution time = 2.0577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5633e-01
  Total weights = 2.0000e+06
  Execution time = 1.8631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356380572229
                                         uncertainty =       0.011718665209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356380572229
                                         uncertainty =       0.011718665209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422066018
  error estimate for blocks of size 2^( 2) =       0.000434378937
  error estimate for blocks of size 2^( 3) =       0.000447237959
  error estimate for blocks of size 2^( 4) =       0.000458482904
  error estimate for blocks of size 2^( 5) =       0.000468030189
  error estimate for blocks of size 2^( 6) =       0.000474967068
  error estimate for blocks of size 2^( 7) =       0.000477987677

      target function =                  N/A
              le_mean =     -16.907024525744
             les_mean =     286.203757582657
             stat err =       0.000469866959
             autocorr =       1.239335928417
              std dev =       0.596891486539
             le_variance =       0.356279446703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356537498622
                                         uncertainty =       0.011751193116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356537498622
                                         uncertainty =       0.011751193116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422158931
  error estimate for blocks of size 2^( 2) =       0.000434463205
  error estimate for blocks of size 2^( 3) =       0.000447308978
  error estimate for blocks of size 2^( 4) =       0.000458545633
  error estimate for blocks of size 2^( 5) =       0.000468095276
  error estimate for blocks of size 2^( 6) =       0.000475027878
  error estimate for blocks of size 2^( 7) =       0.000478055568

      target function =                  N/A
              le_mean =     -16.907023496715
             les_mean =     286.203879665879
             stat err =       0.000469931089
             autocorr =       1.239128631825
              std dev =       0.597022885341
             le_variance =       0.356436325621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356481820479
                                         uncertainty =       0.011741013012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356481820479
                                         uncertainty =       0.011741013012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422125979
  error estimate for blocks of size 2^( 2) =       0.000434433826
  error estimate for blocks of size 2^( 3) =       0.000447284515
  error estimate for blocks of size 2^( 4) =       0.000458524406
  error estimate for blocks of size 2^( 5) =       0.000468073649
  error estimate for blocks of size 2^( 6) =       0.000475008986
  error estimate for blocks of size 2^( 7) =       0.000478034215

      target function =                  N/A
              le_mean =     -16.907023292727
             les_mean =     286.203817126718
             stat err =       0.000469910314
             autocorr =       1.239212522066
              std dev =       0.596976284369
             le_variance =       0.356380684099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356393403448
                                         uncertainty =       0.011721723218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356393403448
                                         uncertainty =       0.011721723218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422073618
  error estimate for blocks of size 2^( 2) =       0.000434385894
  error estimate for blocks of size 2^( 3) =       0.000447243800
  error estimate for blocks of size 2^( 4) =       0.000458488085
  error estimate for blocks of size 2^( 5) =       0.000468035660
  error estimate for blocks of size 2^( 6) =       0.000474972442
  error estimate for blocks of size 2^( 7) =       0.000477993649

      target function =                  N/A
              le_mean =     -16.907024286239
             les_mean =     286.203762314953
             stat err =       0.000469872459
             autocorr =       1.239320307405
              std dev =       0.596902234570
             le_variance =       0.356292277635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907024525744        initial  <--
     3.8147e-01     3.8147e+00             7.1040e-04       -16.907023496715
     1.5259e+00     1.5259e+01             1.8560e-04       -16.907023292727
     6.1035e+00     6.1035e+01             4.6919e-05       -16.907024286239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9782
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8579
    reference variance = 0.29985
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340807660093
                                         uncertainty =       0.005285594472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340807660093
                                         uncertainty =       0.005285594472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412799162
  error estimate for blocks of size 2^( 2) =       0.000425597563
  error estimate for blocks of size 2^( 3) =       0.000438947492
  error estimate for blocks of size 2^( 4) =       0.000450883859
  error estimate for blocks of size 2^( 5) =       0.000461641940
  error estimate for blocks of size 2^( 6) =       0.000469611608
  error estimate for blocks of size 2^( 7) =       0.000475135289

      target function =                  N/A
              le_mean =     -16.906650074245
             les_mean =     286.175622858276
             stat err =       0.000464318174
             autocorr =       1.265184180666
              std dev =       0.583786172938
             le_variance =       0.340806295714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665007424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650074245       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650251189       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650468191       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650455449       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650438556       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650417669       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650421653       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650425255       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.925485e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650074245       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650120179       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650176330       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650173740       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650169039       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650161787       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650162474       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650163579       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.254726e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650074245       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650085840       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650100002       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650099395       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650098205       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650096240       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650096383       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650096670       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.651230e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6299e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093268e-01 1 1  ON 0
 uu_1                 1.425522e-01 1 1  ON 1
 uu_2                 4.102342e-02 1 1  ON 2
 uu_3                -2.135334e-02 1 1  ON 3
 uu_4                -6.669612e-02 1 1  ON 4
 uu_5                -1.013444e-01 1 1  ON 5
 uu_6                -1.284571e-01 1 1  ON 6
 uu_7                -1.417473e-01 1 1  ON 7
 uu_8                -1.336010e-01 1 1  ON 8
 uu_9                -1.050538e-01 1 1  ON 9
 ud_0                 4.482092e-01 1 1  ON 10
 ud_1                 1.827834e-01 1 1  ON 11
 ud_2                 6.290099e-02 1 1  ON 12
 ud_3                -7.769451e-03 1 1  ON 13
 ud_4                -6.501647e-02 1 1  ON 14
 ud_5                -1.070470e-01 1 1  ON 15
 ud_6                -1.350205e-01 1 1  ON 16
 ud_7                -1.521301e-01 1 1  ON 17
 ud_8                -1.529897e-01 1 1  ON 18
 ud_9                -1.433611e-01 1 1  ON 19
 eO_0                -7.602818e-01 1 1  ON 20
 eO_1                -4.397293e-01 1 1  ON 21
 eO_2                -2.160536e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254967e-01 1 1  ON 24
 eO_5                 4.878336e-01 1 1  ON 25
 eO_6                 2.599719e-01 1 1  ON 26
 eO_7                -4.071889e-02 1 1  ON 27
 eO_8                -2.216137e-01 1 1  ON 28
 eO_9                -8.673726e-02 1 1  ON 29
eH1_0                -2.451468e-01 1 1  ON 30
eH1_1                -1.455171e-01 1 1  ON 31
eH1_2                -9.862913e-02 1 1  ON 32
eH1_3                -4.476542e-02 1 1  ON 33
eH1_4                 3.411343e-03 1 1  ON 34
eH1_5                 3.808737e-02 1 1  ON 35
eH1_6                 9.666668e-02 1 1  ON 36
eH1_7                 1.541642e-01 1 1  ON 37
eH1_8                 1.774655e-01 1 1  ON 38
eH1_9                 6.825567e-02 1 1  ON 39
eH2_0                -2.428855e-01 1 1  ON 40
eH2_1                -1.431133e-01 1 1  ON 41
eH2_2                -9.652191e-02 1 1  ON 42
eH2_3                -4.249450e-02 1 1  ON 43
eH2_4                 5.718330e-03 1 1  ON 44
eH2_5                 4.025923e-02 1 1  ON 45
eH2_6                 9.939349e-02 1 1  ON 46
eH2_7                 1.552781e-01 1 1  ON 47
eH2_8                 1.829659e-01 1 1  ON 48
eH2_9                 5.789554e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0121
    reference variance = 0.410794
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 1.8646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289045041
                                         uncertainty =       0.002802474380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289045041
                                         uncertainty =       0.002802474380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411206315
  error estimate for blocks of size 2^( 2) =       0.000423638375
  error estimate for blocks of size 2^( 3) =       0.000436457019
  error estimate for blocks of size 2^( 4) =       0.000447778559
  error estimate for blocks of size 2^( 5) =       0.000457775116
  error estimate for blocks of size 2^( 6) =       0.000465104568
  error estimate for blocks of size 2^( 7) =       0.000470027826

      target function =                  N/A
              le_mean =     -16.906817251426
             les_mean =     286.178650670642
             stat err =       0.000460171517
             autocorr =       1.252333267433
              std dev =       0.581533547281
             le_variance =       0.338181266613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292876090
                                         uncertainty =       0.002802453631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292876090
                                         uncertainty =       0.002802453631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411208661
  error estimate for blocks of size 2^( 2) =       0.000423639644
  error estimate for blocks of size 2^( 3) =       0.000436456487
  error estimate for blocks of size 2^( 4) =       0.000447776441
  error estimate for blocks of size 2^( 5) =       0.000457772185
  error estimate for blocks of size 2^( 6) =       0.000465102193
  error estimate for blocks of size 2^( 7) =       0.000470026201

      target function =                  N/A
              le_mean =     -16.906817129825
             les_mean =     286.178650417326
             stat err =       0.000460169255
             autocorr =       1.252306665766
              std dev =       0.581536864750
             le_variance =       0.338185125063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289674360
                                         uncertainty =       0.002802449119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289674360
                                         uncertainty =       0.002802449119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411206707
  error estimate for blocks of size 2^( 2) =       0.000423638241
  error estimate for blocks of size 2^( 3) =       0.000436455965
  error estimate for blocks of size 2^( 4) =       0.000447776688
  error estimate for blocks of size 2^( 5) =       0.000457772813
  error estimate for blocks of size 2^( 6) =       0.000465102558
  error estimate for blocks of size 2^( 7) =       0.000470026232

      target function =                  N/A
              le_mean =     -16.906817182963
             les_mean =     286.178649000410
             stat err =       0.000460169573
             autocorr =       1.252320295674
              std dev =       0.581534101652
             le_variance =       0.338181911384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289070876
                                         uncertainty =       0.002802470661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289070876
                                         uncertainty =       0.002802470661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411206332
  error estimate for blocks of size 2^( 2) =       0.000423638327
  error estimate for blocks of size 2^( 3) =       0.000436456855
  error estimate for blocks of size 2^( 4) =       0.000447778291
  error estimate for blocks of size 2^( 5) =       0.000457774793
  error estimate for blocks of size 2^( 6) =       0.000465104283
  error estimate for blocks of size 2^( 7) =       0.000470027594

      target function =                  N/A
              le_mean =     -16.906817241909
             les_mean =     286.178650376666
             stat err =       0.000460171241
             autocorr =       1.252331658166
              std dev =       0.581533571208
             le_variance =       0.338181294442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906817251426        initial  <--
     3.8147e+00     3.8147e+01             8.9255e-05       -16.906817129825
     1.5259e+01     1.5259e+02             2.2547e-05       -16.906817182963
     6.1035e+01     6.1035e+02             5.6512e-06       -16.906817241909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8162
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.250219
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333524539956
                                         uncertainty =       0.003125718650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333524539956
                                         uncertainty =       0.003125718650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408390297
  error estimate for blocks of size 2^( 2) =       0.000421157546
  error estimate for blocks of size 2^( 3) =       0.000434019591
  error estimate for blocks of size 2^( 4) =       0.000446314936
  error estimate for blocks of size 2^( 5) =       0.000456812474
  error estimate for blocks of size 2^( 6) =       0.000465538400
  error estimate for blocks of size 2^( 7) =       0.000470390201

      target function =                  N/A
              le_mean =     -16.906300263986
             les_mean =     286.156553719242
             stat err =       0.000459764003
             autocorr =       1.267415748900
              std dev =       0.577551097273
             le_variance =       0.333565269961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630026399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300263986       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300283224       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300266449       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300280343       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300302290       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300299592       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300302551       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300305425       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.066281e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300263986       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300268813       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300264508       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300268146       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300273537       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300272845       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300273572       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300274286       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.668105e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300263986       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300265194       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300264111       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300265031       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300266372       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300266198       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300266380       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300266559       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 6.671763e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6468e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093289e-01 1 1  ON 0
 uu_1                 1.425514e-01 1 1  ON 1
 uu_2                 4.102089e-02 1 1  ON 2
 uu_3                -2.135656e-02 1 1  ON 3
 uu_4                -6.669436e-02 1 1  ON 4
 uu_5                -1.013438e-01 1 1  ON 5
 uu_6                -1.284522e-01 1 1  ON 6
 uu_7                -1.417472e-01 1 1  ON 7
 uu_8                -1.335958e-01 1 1  ON 8
 uu_9                -1.050508e-01 1 1  ON 9
 ud_0                 4.482041e-01 1 1  ON 10
 ud_1                 1.827672e-01 1 1  ON 11
 ud_2                 6.290562e-02 1 1  ON 12
 ud_3                -7.759451e-03 1 1  ON 13
 ud_4                -6.501511e-02 1 1  ON 14
 ud_5                -1.070520e-01 1 1  ON 15
 ud_6                -1.350175e-01 1 1  ON 16
 ud_7                -1.521300e-01 1 1  ON 17
 ud_8                -1.529886e-01 1 1  ON 18
 ud_9                -1.433615e-01 1 1  ON 19
 eO_0                -7.602782e-01 1 1  ON 20
 eO_1                -4.397307e-01 1 1  ON 21
 eO_2                -2.161121e-02 1 1  ON 22
 eO_3                 2.988314e-01 1 1  ON 23
 eO_4                 5.254962e-01 1 1  ON 24
 eO_5                 4.878282e-01 1 1  ON 25
 eO_6                 2.599663e-01 1 1  ON 26
 eO_7                -4.072176e-02 1 1  ON 27
 eO_8                -2.216067e-01 1 1  ON 28
 eO_9                -8.672860e-02 1 1  ON 29
eH1_0                -2.451261e-01 1 1  ON 30
eH1_1                -1.455152e-01 1 1  ON 31
eH1_2                -9.862950e-02 1 1  ON 32
eH1_3                -4.477085e-02 1 1  ON 33
eH1_4                 3.406564e-03 1 1  ON 34
eH1_5                 3.809151e-02 1 1  ON 35
eH1_6                 9.666620e-02 1 1  ON 36
eH1_7                 1.541686e-01 1 1  ON 37
eH1_8                 1.774581e-01 1 1  ON 38
eH1_9                 6.824466e-02 1 1  ON 39
eH2_0                -2.428670e-01 1 1  ON 40
eH2_1                -1.431139e-01 1 1  ON 41
eH2_2                -9.652465e-02 1 1  ON 42
eH2_3                -4.249288e-02 1 1  ON 43
eH2_4                 5.715553e-03 1 1  ON 44
eH2_5                 4.026040e-02 1 1  ON 45
eH2_6                 9.939498e-02 1 1  ON 46
eH2_7                 1.552794e-01 1 1  ON 47
eH2_8                 1.829617e-01 1 1  ON 48
eH2_9                 5.788262e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8685
    reference variance = 0.125808
====================================================
  Execution time = 2.0782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274604480
                                         uncertainty =       0.003311520440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274604480
                                         uncertainty =       0.003311520440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410691988
  error estimate for blocks of size 2^( 2) =       0.000423287666
  error estimate for blocks of size 2^( 3) =       0.000435935024
  error estimate for blocks of size 2^( 4) =       0.000448608102
  error estimate for blocks of size 2^( 5) =       0.000459151590
  error estimate for blocks of size 2^( 6) =       0.000466725758
  error estimate for blocks of size 2^( 7) =       0.000471892278

      target function =                  N/A
              le_mean =     -16.905788940079
             les_mean =     286.143035335853
             stat err =       0.000461594432
             autocorr =       1.263248123542
              std dev =       0.580806179389
             le_variance =       0.337335818016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337277024135
                                         uncertainty =       0.003311548629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337277024135
                                         uncertainty =       0.003311548629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410693460
  error estimate for blocks of size 2^( 2) =       0.000423289017
  error estimate for blocks of size 2^( 3) =       0.000435936215
  error estimate for blocks of size 2^( 4) =       0.000448609174
  error estimate for blocks of size 2^( 5) =       0.000459152630
  error estimate for blocks of size 2^( 6) =       0.000466726785
  error estimate for blocks of size 2^( 7) =       0.000471893322

      target function =                  N/A
              le_mean =     -16.905788922623
             les_mean =     286.143037163876
             stat err =       0.000461595478
             autocorr =       1.263244792540
              std dev =       0.580808261196
             le_variance =       0.337338236273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337275809896
                                         uncertainty =       0.003311534500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337275809896
                                         uncertainty =       0.003311534500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410692721
  error estimate for blocks of size 2^( 2) =       0.000423288339
  error estimate for blocks of size 2^( 3) =       0.000435935617
  error estimate for blocks of size 2^( 4) =       0.000448608635
  error estimate for blocks of size 2^( 5) =       0.000459152107
  error estimate for blocks of size 2^( 6) =       0.000466726269
  error estimate for blocks of size 2^( 7) =       0.000471892797

      target function =                  N/A
              le_mean =     -16.905788931262
             les_mean =     286.143036242447
             stat err =       0.000461594952
             autocorr =       1.263246459379
              std dev =       0.580807216488
             le_variance =       0.337337022725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274754995
                                         uncertainty =       0.003311522196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274754995
                                         uncertainty =       0.003311522196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410692080
  error estimate for blocks of size 2^( 2) =       0.000423287750
  error estimate for blocks of size 2^( 3) =       0.000435935098
  error estimate for blocks of size 2^( 4) =       0.000448608168
  error estimate for blocks of size 2^( 5) =       0.000459151654
  error estimate for blocks of size 2^( 6) =       0.000466725822
  error estimate for blocks of size 2^( 7) =       0.000471892343

      target function =                  N/A
              le_mean =     -16.905788938969
             les_mean =     286.143035448752
             stat err =       0.000461594497
             autocorr =       1.263247915537
              std dev =       0.580806308887
             le_variance =       0.337335968443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905788940079        initial  <--
     3.8147e+01     3.8147e+02             1.0663e-05       -16.905788922623
     1.5259e+02     1.5259e+03             2.6681e-06       -16.905788931262
     6.1035e+02     6.1035e+03             6.6718e-07       -16.905788938969

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1731
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.303283
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333814433343
                                         uncertainty =       0.003056507331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333814433343
                                         uncertainty =       0.003056507331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408613154
  error estimate for blocks of size 2^( 2) =       0.000421222964
  error estimate for blocks of size 2^( 3) =       0.000434446766
  error estimate for blocks of size 2^( 4) =       0.000446279858
  error estimate for blocks of size 2^( 5) =       0.000457325835
  error estimate for blocks of size 2^( 6) =       0.000465829508
  error estimate for blocks of size 2^( 7) =       0.000469335217

      target function =                  N/A
              le_mean =     -16.906813173147
             les_mean =     286.174260924625
             stat err =       0.000459692605
             autocorr =       1.265640450403
              std dev =       0.577866264722
             le_variance =       0.333929419903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681317315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906813173147       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906813177972       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906813177385       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906813177055       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906813176485       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906813176329       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906813176816       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906813176766       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.437384e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906813173147       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906813174353       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906813174206       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906813174123       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906813173981       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906813173942       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906813174062       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906813174051       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.359589e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906813173147       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906813173448       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906813173412       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906813173392       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906813173358       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906813173347       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906813173374       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906813173372       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.899124e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6111e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102143e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669360e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335963e-01 1 1  ON 8
 uu_9                -1.050512e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827665e-01 1 1  ON 11
 ud_2                 6.290551e-02 1 1  ON 12
 ud_3                -7.758553e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529890e-01 1 1  ON 18
 ud_9                -1.433618e-01 1 1  ON 19
 eO_0                -7.602774e-01 1 1  ON 20
 eO_1                -4.397308e-01 1 1  ON 21
 eO_2                -2.161156e-02 1 1  ON 22
 eO_3                 2.988307e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072175e-02 1 1  ON 27
 eO_8                -2.216064e-01 1 1  ON 28
 eO_9                -8.672810e-02 1 1  ON 29
eH1_0                -2.451244e-01 1 1  ON 30
eH1_1                -1.455151e-01 1 1  ON 31
eH1_2                -9.862930e-02 1 1  ON 32
eH1_3                -4.477161e-02 1 1  ON 33
eH1_4                 3.406315e-03 1 1  ON 34
eH1_5                 3.809187e-02 1 1  ON 35
eH1_6                 9.666630e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774577e-01 1 1  ON 38
eH1_9                 6.824354e-02 1 1  ON 39
eH2_0                -2.428645e-01 1 1  ON 40
eH2_1                -1.431129e-01 1 1  ON 41
eH2_2                -9.652508e-02 1 1  ON 42
eH2_3                -4.249327e-02 1 1  ON 43
eH2_4                 5.715597e-03 1 1  ON 44
eH2_5                 4.026005e-02 1 1  ON 45
eH2_6                 9.939528e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829607e-01 1 1  ON 48
eH2_9                 5.788102e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8437
    reference variance = 0.178153
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3990e-01
  Total weights = 2.0000e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976707686
                                         uncertainty =       0.005577135966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976707686
                                         uncertainty =       0.005577135966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412249072
  error estimate for blocks of size 2^( 2) =       0.000424936702
  error estimate for blocks of size 2^( 3) =       0.000437804015
  error estimate for blocks of size 2^( 4) =       0.000450208541
  error estimate for blocks of size 2^( 5) =       0.000460957081
  error estimate for blocks of size 2^( 6) =       0.000466290609
  error estimate for blocks of size 2^( 7) =       0.000471670073

      target function =                  N/A
              le_mean =     -16.905924373386
             les_mean =     286.150177343597
             stat err =       0.000462281576
             autocorr =       1.257458893566
              std dev =       0.583008228855
             le_variance =       0.339898594913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976503915
                                         uncertainty =       0.005577135550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976503915
                                         uncertainty =       0.005577135550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412248949
  error estimate for blocks of size 2^( 2) =       0.000424936577
  error estimate for blocks of size 2^( 3) =       0.000437803883
  error estimate for blocks of size 2^( 4) =       0.000450208404
  error estimate for blocks of size 2^( 5) =       0.000460956952
  error estimate for blocks of size 2^( 6) =       0.000466290501
  error estimate for blocks of size 2^( 7) =       0.000471669971

      target function =                  N/A
              le_mean =     -16.905924369214
             les_mean =     286.150176998943
             stat err =       0.000462281457
             autocorr =       1.257458998850
              std dev =       0.583008054233
             le_variance =       0.339898391300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976605578
                                         uncertainty =       0.005577135756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976605578
                                         uncertainty =       0.005577135756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412249010
  error estimate for blocks of size 2^( 2) =       0.000424936639
  error estimate for blocks of size 2^( 3) =       0.000437803949
  error estimate for blocks of size 2^( 4) =       0.000450208472
  error estimate for blocks of size 2^( 5) =       0.000460957017
  error estimate for blocks of size 2^( 6) =       0.000466290555
  error estimate for blocks of size 2^( 7) =       0.000471670022

      target function =                  N/A
              le_mean =     -16.905924371299
             les_mean =     286.150177171013
             stat err =       0.000462281516
             autocorr =       1.257458946403
              std dev =       0.583008141353
             le_variance =       0.339898492884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976694916
                                         uncertainty =       0.005577135940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976694916
                                         uncertainty =       0.005577135940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412249064
  error estimate for blocks of size 2^( 2) =       0.000424936694
  error estimate for blocks of size 2^( 3) =       0.000437804007
  error estimate for blocks of size 2^( 4) =       0.000450208533
  error estimate for blocks of size 2^( 5) =       0.000460957073
  error estimate for blocks of size 2^( 6) =       0.000466290602
  error estimate for blocks of size 2^( 7) =       0.000471670066

      target function =                  N/A
              le_mean =     -16.905924373125
             les_mean =     286.150177322014
             stat err =       0.000462281569
             autocorr =       1.257458900172
              std dev =       0.583008217911
             le_variance =       0.339898582152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905924373386        initial  <--
     3.8147e+02     3.8147e+03             9.4374e-07       -16.905924369214
     1.5259e+03     1.5259e+04             2.3596e-07       -16.905924371299
     6.1035e+03     6.1035e+04             5.8991e-08       -16.905924373125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9629
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9136
    reference variance = 0.302954
====================================================
  Execution time = 2.3502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3657e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336656848605
                                         uncertainty =       0.004933950380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336656848605
                                         uncertainty =       0.004933950380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410224421
  error estimate for blocks of size 2^( 2) =       0.000422780133
  error estimate for blocks of size 2^( 3) =       0.000435564354
  error estimate for blocks of size 2^( 4) =       0.000447447892
  error estimate for blocks of size 2^( 5) =       0.000458506832
  error estimate for blocks of size 2^( 6) =       0.000465336624
  error estimate for blocks of size 2^( 7) =       0.000469063639

      target function =                  N/A
              le_mean =     -16.905698316007
             les_mean =     286.139203535227
             stat err =       0.000460088747
             autocorr =       1.257882860619
              std dev =       0.580144940225
             le_variance =       0.336568151669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569831601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698316007       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698316549       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698316538       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698316610       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698316621       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698316533       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698316562       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698316584       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 9.569610e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698316007       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698316143       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698316140       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698316158       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698316157       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698316135       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698316156       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698316138       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.392424e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698316007       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698316041       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698316040       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698316045       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698316045       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698316021       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698316019       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698315988       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.981075e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9215e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758492e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406358e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824347e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715590e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939526e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.625428
====================================================
  Execution time = 2.0232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.0000e+06
  Execution time = 2.1920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417729581
                                         uncertainty =       0.005128405955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417729581
                                         uncertainty =       0.005128405955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410779293
  error estimate for blocks of size 2^( 2) =       0.000423684953
  error estimate for blocks of size 2^( 3) =       0.000436622038
  error estimate for blocks of size 2^( 4) =       0.000448138735
  error estimate for blocks of size 2^( 5) =       0.000459543209
  error estimate for blocks of size 2^( 6) =       0.000466851276
  error estimate for blocks of size 2^( 7) =       0.000472178109

      target function =                  N/A
              le_mean =     -16.905765068356
             les_mean =     286.142371632228
             stat err =       0.000461677832
             autocorr =       1.263167545526
              std dev =       0.580929646799
             le_variance =       0.337479254530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417770368
                                         uncertainty =       0.005128405946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417770368
                                         uncertainty =       0.005128405946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410779317
  error estimate for blocks of size 2^( 2) =       0.000423684976
  error estimate for blocks of size 2^( 3) =       0.000436622059
  error estimate for blocks of size 2^( 4) =       0.000448138754
  error estimate for blocks of size 2^( 5) =       0.000459543228
  error estimate for blocks of size 2^( 6) =       0.000466851296
  error estimate for blocks of size 2^( 7) =       0.000472178128

      target function =                  N/A
              le_mean =     -16.905765068325
             les_mean =     286.142371672024
             stat err =       0.000461677852
             autocorr =       1.263167498102
              std dev =       0.580929681936
             le_variance =       0.337479295355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417749976
                                         uncertainty =       0.005128405950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417749976
                                         uncertainty =       0.005128405950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410779305
  error estimate for blocks of size 2^( 2) =       0.000423684965
  error estimate for blocks of size 2^( 3) =       0.000436622049
  error estimate for blocks of size 2^( 4) =       0.000448138745
  error estimate for blocks of size 2^( 5) =       0.000459543219
  error estimate for blocks of size 2^( 6) =       0.000466851286
  error estimate for blocks of size 2^( 7) =       0.000472178118

      target function =                  N/A
              le_mean =     -16.905765068341
             les_mean =     286.142371652127
             stat err =       0.000461677842
             autocorr =       1.263167521817
              std dev =       0.580929664369
             le_variance =       0.337479274943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417732131
                                         uncertainty =       0.005128405954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337417732131
                                         uncertainty =       0.005128405954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410779294
  error estimate for blocks of size 2^( 2) =       0.000423684955
  error estimate for blocks of size 2^( 3) =       0.000436622039
  error estimate for blocks of size 2^( 4) =       0.000448138736
  error estimate for blocks of size 2^( 5) =       0.000459543210
  error estimate for blocks of size 2^( 6) =       0.000466851277
  error estimate for blocks of size 2^( 7) =       0.000472178110

      target function =                  N/A
              le_mean =     -16.905765068354
             les_mean =     286.142371634716
             stat err =       0.000461677833
             autocorr =       1.263167542561
              std dev =       0.580929648995
             le_variance =       0.337479257082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905765068356        initial  <--
     3.8147e+03     3.8147e+04             9.5696e-08       -16.905765068325
     1.5259e+04     1.5259e+05             2.3924e-08       -16.905765068341
     6.1035e+04     6.1035e+05             5.9811e-09       -16.905765068354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2680
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102134e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758487e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406347e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.341917
====================================================
  Execution time = 2.0593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335866011986
                                         uncertainty =       0.003438787609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335866011986
                                         uncertainty =       0.003438787609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409724405
  error estimate for blocks of size 2^( 2) =       0.000422358452
  error estimate for blocks of size 2^( 3) =       0.000435173347
  error estimate for blocks of size 2^( 4) =       0.000446703478
  error estimate for blocks of size 2^( 5) =       0.000456405289
  error estimate for blocks of size 2^( 6) =       0.000463910544
  error estimate for blocks of size 2^( 7) =       0.000468600389

      target function =                  N/A
              le_mean =     -16.906557372329
             les_mean =     286.167430191647
             stat err =       0.000458904925
             autocorr =       1.254474307746
              std dev =       0.579437810002
             le_variance =       0.335748175660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655737233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557372329       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557372352       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557372370       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557372374       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906557372379       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557372385       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906557372350       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906557372379       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 8.262930e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557372329       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557372335       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557372339       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557372389       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906557372172       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557372335       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906557372343       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906557372164       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.065736e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557372329       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557372331       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557372332       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557372332       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906557372365       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557372142       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906557372212       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906557372362       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 5.164341e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6229e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758488e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161161e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878280e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672800e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406348e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715584e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8509
    reference variance = 0.277189
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3378e-01
  Total weights = 2.0000e+06
  Execution time = 1.8651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860828249
                                         uncertainty =       0.003805862251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860828249
                                         uncertainty =       0.003805862251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408524467
  error estimate for blocks of size 2^( 2) =       0.000421420674
  error estimate for blocks of size 2^( 3) =       0.000434696630
  error estimate for blocks of size 2^( 4) =       0.000447383302
  error estimate for blocks of size 2^( 5) =       0.000458561958
  error estimate for blocks of size 2^( 6) =       0.000470542462
  error estimate for blocks of size 2^( 7) =       0.000477805208

      target function =                  N/A
              le_mean =     -16.906268133779
             les_mean =     286.155686524778
             stat err =       0.000463573233
             autocorr =       1.287658082742
              std dev =       0.577740841947
             le_variance =       0.333784480454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860831303
                                         uncertainty =       0.003805862324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860831303
                                         uncertainty =       0.003805862324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408524469
  error estimate for blocks of size 2^( 2) =       0.000421420676
  error estimate for blocks of size 2^( 3) =       0.000434696631
  error estimate for blocks of size 2^( 4) =       0.000447383304
  error estimate for blocks of size 2^( 5) =       0.000458561960
  error estimate for blocks of size 2^( 6) =       0.000470542463
  error estimate for blocks of size 2^( 7) =       0.000477805210

      target function =                  N/A
              le_mean =     -16.906268133820
             les_mean =     286.155686529221
             stat err =       0.000463573234
             autocorr =       1.287658078238
              std dev =       0.577740844589
             le_variance =       0.333784483507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860829776
                                         uncertainty =       0.003805862288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860829776
                                         uncertainty =       0.003805862288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408524468
  error estimate for blocks of size 2^( 2) =       0.000421420675
  error estimate for blocks of size 2^( 3) =       0.000434696631
  error estimate for blocks of size 2^( 4) =       0.000447383303
  error estimate for blocks of size 2^( 5) =       0.000458561959
  error estimate for blocks of size 2^( 6) =       0.000470542463
  error estimate for blocks of size 2^( 7) =       0.000477805209

      target function =                  N/A
              le_mean =     -16.906268133799
             les_mean =     286.155686526999
             stat err =       0.000463573233
             autocorr =       1.287658080489
              std dev =       0.577740843268
             le_variance =       0.333784481980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860828440
                                         uncertainty =       0.003805862256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333860828440
                                         uncertainty =       0.003805862256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408524467
  error estimate for blocks of size 2^( 2) =       0.000421420674
  error estimate for blocks of size 2^( 3) =       0.000434696630
  error estimate for blocks of size 2^( 4) =       0.000447383302
  error estimate for blocks of size 2^( 5) =       0.000458561959
  error estimate for blocks of size 2^( 6) =       0.000470542462
  error estimate for blocks of size 2^( 7) =       0.000477805208

      target function =                  N/A
              le_mean =     -16.906268133781
             les_mean =     286.155686525055
             stat err =       0.000463573233
             autocorr =       1.287658082463
              std dev =       0.577740842112
             le_variance =       0.333784480644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906268133779        initial
     3.8147e+04     3.8147e+05             8.2629e-09       -16.906268133820  <--
     1.5259e+05     1.5259e+06             2.0657e-09       -16.906268133799
     6.1035e+05     6.1035e+06             5.1643e-10       -16.906268133781

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9739e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758490e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406349e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715582e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 0.390425
====================================================
  Execution time = 2.0395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340957452247
                                         uncertainty =       0.004357289007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340957452247
                                         uncertainty =       0.004357289007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412839407
  error estimate for blocks of size 2^( 2) =       0.000425761221
  error estimate for blocks of size 2^( 3) =       0.000438720168
  error estimate for blocks of size 2^( 4) =       0.000450159498
  error estimate for blocks of size 2^( 5) =       0.000461420647
  error estimate for blocks of size 2^( 6) =       0.000465997267
  error estimate for blocks of size 2^( 7) =       0.000469225485

      target function =                  N/A
              le_mean =     -16.905575710681
             les_mean =     286.139362690808
             stat err =       0.000461700724
             autocorr =       1.250716331873
              std dev =       0.583843088245
             le_variance =       0.340872751691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557571068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905575710681       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905575710690       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905575710646       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905575710698       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905575710737       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905575710722       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905575710725       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905575710726       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.120518e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905575710681       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905575710683       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905575710672       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905575710686       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905575710712       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905575710705       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905575710686       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905575710693       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.030134e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905575710681       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905575710681       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905575710678       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905575710682       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905575710574       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905575710642       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905575710690       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905575710673       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.575338e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5991e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758492e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406349e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824347e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715585e-03 1 1  ON 44
eH2_5                 4.026006e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8764
    reference variance = 0.411365
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4282e-01
  Total weights = 2.0000e+06
  Execution time = 1.8614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861615057
                                         uncertainty =       0.006212816522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861615057
                                         uncertainty =       0.006212816522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414014546
  error estimate for blocks of size 2^( 2) =       0.000427347074
  error estimate for blocks of size 2^( 3) =       0.000440398094
  error estimate for blocks of size 2^( 4) =       0.000452307901
  error estimate for blocks of size 2^( 5) =       0.000463387078
  error estimate for blocks of size 2^( 6) =       0.000471541358
  error estimate for blocks of size 2^( 7) =       0.000476642200

      target function =                  N/A
              le_mean =     -16.906575066679
             les_mean =     286.175096401686
             stat err =       0.000465969634
             autocorr =       1.266729933159
              std dev =       0.585504985336
             le_variance =       0.342816087853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861628187
                                         uncertainty =       0.006212816547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861628187
                                         uncertainty =       0.006212816547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414014553
  error estimate for blocks of size 2^( 2) =       0.000427347081
  error estimate for blocks of size 2^( 3) =       0.000440398101
  error estimate for blocks of size 2^( 4) =       0.000452307906
  error estimate for blocks of size 2^( 5) =       0.000463387083
  error estimate for blocks of size 2^( 6) =       0.000471541364
  error estimate for blocks of size 2^( 7) =       0.000476642205

      target function =                  N/A
              le_mean =     -16.906575066310
             les_mean =     286.175096402360
             stat err =       0.000465969640
             autocorr =       1.266729913889
              std dev =       0.585504996550
             le_variance =       0.342816100985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861621622
                                         uncertainty =       0.006212816534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861621622
                                         uncertainty =       0.006212816534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414014550
  error estimate for blocks of size 2^( 2) =       0.000427347077
  error estimate for blocks of size 2^( 3) =       0.000440398097
  error estimate for blocks of size 2^( 4) =       0.000452307903
  error estimate for blocks of size 2^( 5) =       0.000463387080
  error estimate for blocks of size 2^( 6) =       0.000471541361
  error estimate for blocks of size 2^( 7) =       0.000476642203

      target function =                  N/A
              le_mean =     -16.906575066494
             les_mean =     286.175096402023
             stat err =       0.000465969637
             autocorr =       1.266729923527
              std dev =       0.585504990943
             le_variance =       0.342816094419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861615878
                                         uncertainty =       0.006212816523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342861615878
                                         uncertainty =       0.006212816523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414014546
  error estimate for blocks of size 2^( 2) =       0.000427347074
  error estimate for blocks of size 2^( 3) =       0.000440398095
  error estimate for blocks of size 2^( 4) =       0.000452307901
  error estimate for blocks of size 2^( 5) =       0.000463387078
  error estimate for blocks of size 2^( 6) =       0.000471541359
  error estimate for blocks of size 2^( 7) =       0.000476642200

      target function =                  N/A
              le_mean =     -16.906575066656
             les_mean =     286.175096401728
             stat err =       0.000465969635
             autocorr =       1.266729931957
              std dev =       0.585504986037
             le_variance =       0.342816088674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906575066679        initial  <--
     9.5367e+03     9.5367e+04             4.1205e-08       -16.906575066310
     3.8147e+04     3.8147e+05             1.0301e-08       -16.906575066494
     1.5259e+05     1.5259e+06             2.5753e-09       -16.906575066656

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7755
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758490e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406349e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715582e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.189665
====================================================
  Execution time = 2.0620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342881006182
                                         uncertainty =       0.008875653033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342881006182
                                         uncertainty =       0.008875653033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414072147
  error estimate for blocks of size 2^( 2) =       0.000426339155
  error estimate for blocks of size 2^( 3) =       0.000439381613
  error estimate for blocks of size 2^( 4) =       0.000451106452
  error estimate for blocks of size 2^( 5) =       0.000461527201
  error estimate for blocks of size 2^( 6) =       0.000469013134
  error estimate for blocks of size 2^( 7) =       0.000473519311

      target function =                  N/A
              le_mean =     -16.906009417441
             les_mean =     286.156065736423
             stat err =       0.000463791525
             autocorr =       1.254566192832
              std dev =       0.585586445590
             le_variance =       0.342911485259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600941744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009417441       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906009417482       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906009417477       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906009417481       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906009417482       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906009417492       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906009417487       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906009417464       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906009417406       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 4.606182e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009417441       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906009417452       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906009417450       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906009417451       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906009417456       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906009417455       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906009416581       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906009417433       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906009417439       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.151546e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009417441       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906009417444       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906009417444       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906009417444       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906009417972       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906009416437       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906009417102       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906009417278       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906009417842       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.878866e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6207e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758490e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477167e-02 1 1  ON 33
eH1_4                 3.406349e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715582e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8964
    reference variance = 0.192381
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3479e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821013782
                                         uncertainty =       0.002859912821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821013782
                                         uncertainty =       0.002859912821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409139259
  error estimate for blocks of size 2^( 2) =       0.000421902155
  error estimate for blocks of size 2^( 3) =       0.000435109282
  error estimate for blocks of size 2^( 4) =       0.000448053854
  error estimate for blocks of size 2^( 5) =       0.000458660771
  error estimate for blocks of size 2^( 6) =       0.000466358140
  error estimate for blocks of size 2^( 7) =       0.000474798176

      target function =                  N/A
              le_mean =     -16.905977346546
             les_mean =     286.146859740420
             stat err =       0.000461967735
             autocorr =       1.274914269120
              std dev =       0.578610288452
             le_variance =       0.334789865903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821014265
                                         uncertainty =       0.002859912828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821014265
                                         uncertainty =       0.002859912828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409139259
  error estimate for blocks of size 2^( 2) =       0.000421902156
  error estimate for blocks of size 2^( 3) =       0.000435109282
  error estimate for blocks of size 2^( 4) =       0.000448053855
  error estimate for blocks of size 2^( 5) =       0.000458660771
  error estimate for blocks of size 2^( 6) =       0.000466358141
  error estimate for blocks of size 2^( 7) =       0.000474798176

      target function =                  N/A
              le_mean =     -16.905977346554
             les_mean =     286.146859741180
             stat err =       0.000461967736
             autocorr =       1.274914267851
              std dev =       0.578610288871
             le_variance =       0.334789866387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821014024
                                         uncertainty =       0.002859912824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821014024
                                         uncertainty =       0.002859912824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409139259
  error estimate for blocks of size 2^( 2) =       0.000421902156
  error estimate for blocks of size 2^( 3) =       0.000435109282
  error estimate for blocks of size 2^( 4) =       0.000448053854
  error estimate for blocks of size 2^( 5) =       0.000458660771
  error estimate for blocks of size 2^( 6) =       0.000466358140
  error estimate for blocks of size 2^( 7) =       0.000474798176

      target function =                  N/A
              le_mean =     -16.905977346550
             les_mean =     286.146859740800
             stat err =       0.000461967736
             autocorr =       1.274914268494
              std dev =       0.578610288662
             le_variance =       0.334789866145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821013812
                                         uncertainty =       0.002859912821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821013812
                                         uncertainty =       0.002859912821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409139259
  error estimate for blocks of size 2^( 2) =       0.000421902155
  error estimate for blocks of size 2^( 3) =       0.000435109282
  error estimate for blocks of size 2^( 4) =       0.000448053854
  error estimate for blocks of size 2^( 5) =       0.000458660771
  error estimate for blocks of size 2^( 6) =       0.000466358140
  error estimate for blocks of size 2^( 7) =       0.000474798176

      target function =                  N/A
              le_mean =     -16.905977346546
             les_mean =     286.146859740468
             stat err =       0.000461967735
             autocorr =       1.274914269030
              std dev =       0.578610288479
             le_variance =       0.334789865933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905977346546        initial
     9.5367e+04     9.5367e+05             4.6062e-09       -16.905977346554  <--
     3.8147e+05     3.8147e+06             1.1515e-09       -16.905977346550
     1.5259e+06     1.5259e+07             2.8789e-10       -16.905977346546

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 3.0173e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.239591
====================================================
  Execution time = 2.0251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339754049223
                                         uncertainty =       0.004410833786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339754049223
                                         uncertainty =       0.004410833786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412147333
  error estimate for blocks of size 2^( 2) =       0.000425112312
  error estimate for blocks of size 2^( 3) =       0.000438839765
  error estimate for blocks of size 2^( 4) =       0.000451653387
  error estimate for blocks of size 2^( 5) =       0.000463045420
  error estimate for blocks of size 2^( 6) =       0.000471562107
  error estimate for blocks of size 2^( 7) =       0.000476191537

      target function =                  N/A
              le_mean =     -16.905148778058
             les_mean =     286.123785886222
             stat err =       0.000465613113
             autocorr =       1.276278396043
              std dev =       0.582864347680
             le_variance =       0.339730847797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690514877806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148778058       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148778087       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148778118       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148778136       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148778145       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148778118       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148778123       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148778134       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905148778148       residual = 9.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.647565e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148778058       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148778066       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148778073       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148778078       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148778074       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148778136       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148778067       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148778058       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905148777962       residual = 9.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 4.118918e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905148778058       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905148778060       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905148778062       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905148778093       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905148777973       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905148777625       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905148778077       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905148777968       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905148778064       residual = 9.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.029730e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5872e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758493e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824347e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8722
    reference variance = 0.310066
====================================================
  Execution time = 2.0783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091764911
                                         uncertainty =       0.002567649102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091764911
                                         uncertainty =       0.002567649102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409239981
  error estimate for blocks of size 2^( 2) =       0.000422283800
  error estimate for blocks of size 2^( 3) =       0.000434569363
  error estimate for blocks of size 2^( 4) =       0.000447563045
  error estimate for blocks of size 2^( 5) =       0.000457424049
  error estimate for blocks of size 2^( 6) =       0.000464488266
  error estimate for blocks of size 2^( 7) =       0.000468881603

      target function =                  N/A
              le_mean =     -16.906562520451
             les_mean =     286.166810814756
             stat err =       0.000459589240
             autocorr =       1.261198929989
              std dev =       0.578752731580
             le_variance =       0.334954724312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091776272
                                         uncertainty =       0.002567649210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091776272
                                         uncertainty =       0.002567649210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409239988
  error estimate for blocks of size 2^( 2) =       0.000422283807
  error estimate for blocks of size 2^( 3) =       0.000434569369
  error estimate for blocks of size 2^( 4) =       0.000447563050
  error estimate for blocks of size 2^( 5) =       0.000457424054
  error estimate for blocks of size 2^( 6) =       0.000464488271
  error estimate for blocks of size 2^( 7) =       0.000468881607

      target function =                  N/A
              le_mean =     -16.906562520373
             les_mean =     286.166810823471
             stat err =       0.000459589246
             autocorr =       1.261198915441
              std dev =       0.578752741390
             le_variance =       0.334954735667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091770591
                                         uncertainty =       0.002567649156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091770591
                                         uncertainty =       0.002567649156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409239985
  error estimate for blocks of size 2^( 2) =       0.000422283803
  error estimate for blocks of size 2^( 3) =       0.000434569366
  error estimate for blocks of size 2^( 4) =       0.000447563047
  error estimate for blocks of size 2^( 5) =       0.000457424051
  error estimate for blocks of size 2^( 6) =       0.000464488268
  error estimate for blocks of size 2^( 7) =       0.000468881605

      target function =                  N/A
              le_mean =     -16.906562520412
             les_mean =     286.166810819113
             stat err =       0.000459589243
             autocorr =       1.261198922710
              std dev =       0.578752736485
             le_variance =       0.334954729989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091765621
                                         uncertainty =       0.002567649109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091765621
                                         uncertainty =       0.002567649109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409239982
  error estimate for blocks of size 2^( 2) =       0.000422283801
  error estimate for blocks of size 2^( 3) =       0.000434569363
  error estimate for blocks of size 2^( 4) =       0.000447563045
  error estimate for blocks of size 2^( 5) =       0.000457424049
  error estimate for blocks of size 2^( 6) =       0.000464488266
  error estimate for blocks of size 2^( 7) =       0.000468881603

      target function =                  N/A
              le_mean =     -16.906562520446
             les_mean =     286.166810815300
             stat err =       0.000459589241
             autocorr =       1.261198929081
              std dev =       0.578752732193
             le_variance =       0.334954725021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906562520451        initial  <--
     2.3842e+04     2.3842e+05             1.6476e-08       -16.906562520373
     9.5367e+04     9.5367e+05             4.1189e-09       -16.906562520412
     3.8147e+05     3.8147e+06             1.0297e-09       -16.906562520446

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2448
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8034
    reference variance = 0.223421
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342144171012
                                         uncertainty =       0.004235885900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342144171012
                                         uncertainty =       0.004235885900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413562237
  error estimate for blocks of size 2^( 2) =       0.000426274729
  error estimate for blocks of size 2^( 3) =       0.000438924356
  error estimate for blocks of size 2^( 4) =       0.000450750093
  error estimate for blocks of size 2^( 5) =       0.000459731638
  error estimate for blocks of size 2^( 6) =       0.000466191207
  error estimate for blocks of size 2^( 7) =       0.000471571009

      target function =                  N/A
              le_mean =     -16.906414536035
             les_mean =     286.168919740779
             stat err =       0.000462060987
             autocorr =       1.248293908267
              std dev =       0.584865324288
             le_variance =       0.342067447555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641453604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414536035       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414536044       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414536049       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414536051       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414536123       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414536046       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414536120       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414535766       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.352722e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414536035       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414536037       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414536038       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414536039       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414536138       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414535863       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414535639       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414536367       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.381805e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414536035       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414536036       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414536036       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414535509       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414535906       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414536840       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414536976       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414531521       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 8.454506e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7977e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8575
    reference variance = 0.143254
====================================================
  Execution time = 2.0422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3909e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277523
                                         uncertainty =       0.004382520638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277523
                                         uncertainty =       0.004382520638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411761089
  error estimate for blocks of size 2^( 2) =       0.000424173784
  error estimate for blocks of size 2^( 3) =       0.000436433454
  error estimate for blocks of size 2^( 4) =       0.000447089107
  error estimate for blocks of size 2^( 5) =       0.000456942650
  error estimate for blocks of size 2^( 6) =       0.000462932364
  error estimate for blocks of size 2^( 7) =       0.000467622649

      target function =                  N/A
              le_mean =     -16.906385500294
             les_mean =     286.164964904085
             stat err =       0.000458646692
             autocorr =       1.240697547230
              std dev =       0.582318116738
             le_variance =       0.339094389081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056278374
                                         uncertainty =       0.004382520648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056278374
                                         uncertainty =       0.004382520648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411761090
  error estimate for blocks of size 2^( 2) =       0.000424173784
  error estimate for blocks of size 2^( 3) =       0.000436433454
  error estimate for blocks of size 2^( 4) =       0.000447089107
  error estimate for blocks of size 2^( 5) =       0.000456942650
  error estimate for blocks of size 2^( 6) =       0.000462932364
  error estimate for blocks of size 2^( 7) =       0.000467622649

      target function =                  N/A
              le_mean =     -16.906385500289
             les_mean =     286.164964904768
             stat err =       0.000458646693
             autocorr =       1.240697546146
              std dev =       0.582318117468
             le_variance =       0.339094389931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277949
                                         uncertainty =       0.004382520643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277949
                                         uncertainty =       0.004382520643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411761089
  error estimate for blocks of size 2^( 2) =       0.000424173784
  error estimate for blocks of size 2^( 3) =       0.000436433454
  error estimate for blocks of size 2^( 4) =       0.000447089107
  error estimate for blocks of size 2^( 5) =       0.000456942650
  error estimate for blocks of size 2^( 6) =       0.000462932364
  error estimate for blocks of size 2^( 7) =       0.000467622649

      target function =                  N/A
              le_mean =     -16.906385500292
             les_mean =     286.164964904427
             stat err =       0.000458646693
             autocorr =       1.240697546691
              std dev =       0.582318117103
             le_variance =       0.339094389506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277576
                                         uncertainty =       0.004382520638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339056277576
                                         uncertainty =       0.004382520638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411761089
  error estimate for blocks of size 2^( 2) =       0.000424173784
  error estimate for blocks of size 2^( 3) =       0.000436433454
  error estimate for blocks of size 2^( 4) =       0.000447089107
  error estimate for blocks of size 2^( 5) =       0.000456942650
  error estimate for blocks of size 2^( 6) =       0.000462932364
  error estimate for blocks of size 2^( 7) =       0.000467622649

      target function =                  N/A
              le_mean =     -16.906385500294
             les_mean =     286.164964904128
             stat err =       0.000458646692
             autocorr =       1.240697547165
              std dev =       0.582318116783
             le_variance =       0.339094389134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906385500294        initial  <--
     2.3842e+05     2.3842e+06             1.3527e-09       -16.906385500289
     9.5367e+05     9.5367e+06             3.3818e-10       -16.906385500292
     3.8147e+06     3.8147e+07             8.4545e-11       -16.906385500294

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8645
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9276
    reference variance = 0.325769
====================================================
  Execution time = 2.3007e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361614127533
                                         uncertainty =       0.018088928078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361614127533
                                         uncertainty =       0.018088928078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425196767
  error estimate for blocks of size 2^( 2) =       0.000437466928
  error estimate for blocks of size 2^( 3) =       0.000450034700
  error estimate for blocks of size 2^( 4) =       0.000461737731
  error estimate for blocks of size 2^( 5) =       0.000472352942
  error estimate for blocks of size 2^( 6) =       0.000479676944
  error estimate for blocks of size 2^( 7) =       0.000483155627

      target function =                  N/A
              le_mean =     -16.906202861305
             les_mean =     286.181279587833
             stat err =       0.000474230811
             autocorr =       1.243940555689
              std dev =       0.601319034307
             le_variance =       0.361584581020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620286131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906202861305       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906202861306       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906202861306       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906202861306       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906202860920       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906202861306       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906202860778       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906202857122       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.611254e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906202861305       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906202861305       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906202861305       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906202861305       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906202864414       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906202858262       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906202838943       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906202881578       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 4.028110e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906202861305       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906202861305       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906202861305       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906202846783       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906202858170       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906202846148       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906203100803       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906202857656       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.006993e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8598e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.428962
====================================================
  Execution time = 2.0654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3639e-01
  Total weights = 2.0000e+06
  Execution time = 1.8606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720603
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720603
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410113545
  error estimate for blocks of size 2^( 2) =       0.000422014575
  error estimate for blocks of size 2^( 3) =       0.000434361106
  error estimate for blocks of size 2^( 4) =       0.000446026552
  error estimate for blocks of size 2^( 5) =       0.000456100784
  error estimate for blocks of size 2^( 6) =       0.000463605362
  error estimate for blocks of size 2^( 7) =       0.000466848189

      target function =                  N/A
              le_mean =     -16.905523478432
             les_mean =     286.133110151648
             stat err =       0.000458145222
             autocorr =       1.247952617018
              std dev =       0.579988137820
             le_variance =       0.336386240012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720656
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720656
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410113545
  error estimate for blocks of size 2^( 2) =       0.000422014575
  error estimate for blocks of size 2^( 3) =       0.000434361106
  error estimate for blocks of size 2^( 4) =       0.000446026552
  error estimate for blocks of size 2^( 5) =       0.000456100784
  error estimate for blocks of size 2^( 6) =       0.000463605362
  error estimate for blocks of size 2^( 7) =       0.000466848189

      target function =                  N/A
              le_mean =     -16.905523478432
             les_mean =     286.133110151698
             stat err =       0.000458145222
             autocorr =       1.247952616955
              std dev =       0.579988137866
             le_variance =       0.336386240065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720630
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720630
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410113545
  error estimate for blocks of size 2^( 2) =       0.000422014575
  error estimate for blocks of size 2^( 3) =       0.000434361106
  error estimate for blocks of size 2^( 4) =       0.000446026552
  error estimate for blocks of size 2^( 5) =       0.000456100784
  error estimate for blocks of size 2^( 6) =       0.000463605362
  error estimate for blocks of size 2^( 7) =       0.000466848189

      target function =                  N/A
              le_mean =     -16.905523478432
             les_mean =     286.133110151673
             stat err =       0.000458145222
             autocorr =       1.247952616989
              std dev =       0.579988137843
             le_variance =       0.336386240039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720607
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468720607
                                         uncertainty =       0.003261139649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410113545
  error estimate for blocks of size 2^( 2) =       0.000422014575
  error estimate for blocks of size 2^( 3) =       0.000434361106
  error estimate for blocks of size 2^( 4) =       0.000446026552
  error estimate for blocks of size 2^( 5) =       0.000456100784
  error estimate for blocks of size 2^( 6) =       0.000463605362
  error estimate for blocks of size 2^( 7) =       0.000466848189

      target function =                  N/A
              le_mean =     -16.905523478432
             les_mean =     286.133110151652
             stat err =       0.000458145222
             autocorr =       1.247952617016
              std dev =       0.579988137823
             le_variance =       0.336386240016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905523478432        initial  <--
     2.3842e+06     2.3842e+07             1.6113e-10       -16.905523478432
     9.5367e+06     9.5367e+07             4.0281e-11       -16.905523478432
     3.8147e+07     3.8147e+08             1.0070e-11       -16.905523478432

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0385
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9657
    reference variance = 0.456217
====================================================
  Execution time = 2.0618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4035e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340362082322
                                         uncertainty =       0.006146362912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340362082322
                                         uncertainty =       0.006146362912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412524114
  error estimate for blocks of size 2^( 2) =       0.000424800400
  error estimate for blocks of size 2^( 3) =       0.000437313102
  error estimate for blocks of size 2^( 4) =       0.000449516226
  error estimate for blocks of size 2^( 5) =       0.000459365600
  error estimate for blocks of size 2^( 6) =       0.000466272423
  error estimate for blocks of size 2^( 7) =       0.000468716560

      target function =                  N/A
              le_mean =     -16.907074108656
             les_mean =     286.189507035377
             stat err =       0.000460967702
             autocorr =       1.248654578054
              std dev =       0.583397197426
             le_variance =       0.340352289965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690707410866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074108656       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074108656       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074108656       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074111713       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907074135805       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907074110391       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907074104760       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907074124190       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.360047e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074108656       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074108656       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074108656       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074140124       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907074034138       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907074145791       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907074054903       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907074084469       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.400123e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074108656       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074108656       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074108656       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074108656       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907074111132       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907074120842       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907076763743       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907074503840       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 8.495783e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6200e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.212319
====================================================
  Execution time = 2.0273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697583
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697583
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412585072
  error estimate for blocks of size 2^( 2) =       0.000425362913
  error estimate for blocks of size 2^( 3) =       0.000438742102
  error estimate for blocks of size 2^( 4) =       0.000451406842
  error estimate for blocks of size 2^( 5) =       0.000462532890
  error estimate for blocks of size 2^( 6) =       0.000470458284
  error estimate for blocks of size 2^( 7) =       0.000474490630

      target function =                  N/A
              le_mean =     -16.906072550908
             les_mean =     286.155741809901
             stat err =       0.000464722162
             autocorr =       1.268702355927
              std dev =       0.583483404691
             le_variance =       0.340452883550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697586
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697586
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412585072
  error estimate for blocks of size 2^( 2) =       0.000425362913
  error estimate for blocks of size 2^( 3) =       0.000438742102
  error estimate for blocks of size 2^( 4) =       0.000451406842
  error estimate for blocks of size 2^( 5) =       0.000462532890
  error estimate for blocks of size 2^( 6) =       0.000470458284
  error estimate for blocks of size 2^( 7) =       0.000474490630

      target function =                  N/A
              le_mean =     -16.906072550908
             les_mean =     286.155741809904
             stat err =       0.000464722162
             autocorr =       1.268702355919
              std dev =       0.583483404694
             le_variance =       0.340452883553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697585
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697585
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412585072
  error estimate for blocks of size 2^( 2) =       0.000425362913
  error estimate for blocks of size 2^( 3) =       0.000438742102
  error estimate for blocks of size 2^( 4) =       0.000451406842
  error estimate for blocks of size 2^( 5) =       0.000462532890
  error estimate for blocks of size 2^( 6) =       0.000470458284
  error estimate for blocks of size 2^( 7) =       0.000474490630

      target function =                  N/A
              le_mean =     -16.906072550908
             les_mean =     286.155741809902
             stat err =       0.000464722162
             autocorr =       1.268702355926
              std dev =       0.583483404692
             le_variance =       0.340452883551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697583
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340478697583
                                         uncertainty =       0.003744871311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412585072
  error estimate for blocks of size 2^( 2) =       0.000425362913
  error estimate for blocks of size 2^( 3) =       0.000438742102
  error estimate for blocks of size 2^( 4) =       0.000451406842
  error estimate for blocks of size 2^( 5) =       0.000462532890
  error estimate for blocks of size 2^( 6) =       0.000470458284
  error estimate for blocks of size 2^( 7) =       0.000474490630

      target function =                  N/A
              le_mean =     -16.906072550908
             les_mean =     286.155741809901
             stat err =       0.000464722162
             autocorr =       1.268702355917
              std dev =       0.583483404691
             le_variance =       0.340452883550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906072550908        initial
     2.3842e+07     2.3842e+08             1.3600e-11       -16.906072550908
     9.5367e+07     9.5367e+08             3.4001e-12       -16.906072550908  <--
     3.8147e+08     3.8147e+09             8.4958e-13       -16.906072550908

*****************************************************************************
Applying the update for shift_i =   9.5367e+07     and shift_s =   9.5367e+08
*****************************************************************************

  Execution time = 2.9653e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5860e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9333
    reference variance = 0.297211
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4442e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344314553279
                                         uncertainty =       0.010912024506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344314553279
                                         uncertainty =       0.010912024506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414980984
  error estimate for blocks of size 2^( 2) =       0.000427829153
  error estimate for blocks of size 2^( 3) =       0.000440615326
  error estimate for blocks of size 2^( 4) =       0.000452759607
  error estimate for blocks of size 2^( 5) =       0.000462937176
  error estimate for blocks of size 2^( 6) =       0.000473993432
  error estimate for blocks of size 2^( 7) =       0.000479341887

      target function =                  N/A
              le_mean =     -16.905748644647
             les_mean =     286.148755498179
             stat err =       0.000467258025
             autocorr =       1.267818679196
              std dev =       0.586871735897
             le_variance =       0.344418434395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574864465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748644647       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748644647       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748644647       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748644647       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748644647       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748644634       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748661322       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748640978       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.706577e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748644647       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748644647       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748644647       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748644647       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748651700       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748615934       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748571386       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748631016       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 4.266229e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748644647       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748644647       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748644647       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748690871       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748837429       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748449292       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748647778       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748582871       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 1.066645e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6237e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8446
    reference variance = 0.242958
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4726e-01
  Total weights = 2.0000e+06
  Execution time = 1.8606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038486
                                         uncertainty =       0.008447609953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038486
                                         uncertainty =       0.008447609953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416687661
  error estimate for blocks of size 2^( 2) =       0.000429342126
  error estimate for blocks of size 2^( 3) =       0.000442561507
  error estimate for blocks of size 2^( 4) =       0.000454520317
  error estimate for blocks of size 2^( 5) =       0.000465068140
  error estimate for blocks of size 2^( 6) =       0.000472492634
  error estimate for blocks of size 2^( 7) =       0.000479403472

      target function =                  N/A
              le_mean =     -16.905723232192
             les_mean =     286.150735044126
             stat err =       0.000467871141
             autocorr =       1.260756553038
              std dev =       0.589285341973
             le_variance =       0.347257214265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038496
                                         uncertainty =       0.008447609954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038496
                                         uncertainty =       0.008447609954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416687661
  error estimate for blocks of size 2^( 2) =       0.000429342126
  error estimate for blocks of size 2^( 3) =       0.000442561507
  error estimate for blocks of size 2^( 4) =       0.000454520317
  error estimate for blocks of size 2^( 5) =       0.000465068140
  error estimate for blocks of size 2^( 6) =       0.000472492634
  error estimate for blocks of size 2^( 7) =       0.000479403472

      target function =                  N/A
              le_mean =     -16.905723232192
             les_mean =     286.150735044139
             stat err =       0.000467871141
             autocorr =       1.260756553029
              std dev =       0.589285341982
             le_variance =       0.347257214275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038491
                                         uncertainty =       0.008447609954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038491
                                         uncertainty =       0.008447609954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416687661
  error estimate for blocks of size 2^( 2) =       0.000429342126
  error estimate for blocks of size 2^( 3) =       0.000442561507
  error estimate for blocks of size 2^( 4) =       0.000454520317
  error estimate for blocks of size 2^( 5) =       0.000465068140
  error estimate for blocks of size 2^( 6) =       0.000472492634
  error estimate for blocks of size 2^( 7) =       0.000479403472

      target function =                  N/A
              le_mean =     -16.905723232192
             les_mean =     286.150735044133
             stat err =       0.000467871141
             autocorr =       1.260756553032
              std dev =       0.589285341978
             le_variance =       0.347257214270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038486
                                         uncertainty =       0.008447609953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303038486
                                         uncertainty =       0.008447609953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416687661
  error estimate for blocks of size 2^( 2) =       0.000429342126
  error estimate for blocks of size 2^( 3) =       0.000442561507
  error estimate for blocks of size 2^( 4) =       0.000454520317
  error estimate for blocks of size 2^( 5) =       0.000465068140
  error estimate for blocks of size 2^( 6) =       0.000472492634
  error estimate for blocks of size 2^( 7) =       0.000479403472

      target function =                  N/A
              le_mean =     -16.905723232192
             les_mean =     286.150735044127
             stat err =       0.000467871141
             autocorr =       1.260756553040
              std dev =       0.589285341974
             le_variance =       0.347257214265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905723232192        initial
     2.3842e+07     2.3842e+08             1.7066e-11       -16.905723232192  <--
     9.5367e+07     9.5367e+08             4.2662e-12       -16.905723232192
     3.8147e+08     3.8147e+09             1.0666e-12       -16.905723232192

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 2.9910e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.209502
====================================================
  Execution time = 2.0673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336195583081
                                         uncertainty =       0.003091136079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336195583081
                                         uncertainty =       0.003091136079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409949322
  error estimate for blocks of size 2^( 2) =       0.000422469000
  error estimate for blocks of size 2^( 3) =       0.000435399381
  error estimate for blocks of size 2^( 4) =       0.000447543181
  error estimate for blocks of size 2^( 5) =       0.000457916084
  error estimate for blocks of size 2^( 6) =       0.000464375069
  error estimate for blocks of size 2^( 7) =       0.000469216649

      target function =                  N/A
              le_mean =     -16.906903423830
             les_mean =     286.179500107700
             stat err =       0.000459762746
             autocorr =       1.257787315817
              std dev =       0.579755890901
             le_variance =       0.336116893034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690690342383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903423830       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906903423830       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903423831       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906903425786       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906903425469       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906903423741       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906903424870       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906903423023       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.517056e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903423830       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906903423830       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903423830       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906903433618       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906903419828       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906903414721       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906903429232       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906903427524       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.379264e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903423830       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906903423830       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903423830       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906903451875       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906903462083       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906903446459       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906903416855       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906903423743       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.448155e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6188e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9869
    reference variance = 0.569985
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4450e-01
  Total weights = 2.0000e+06
  Execution time = 1.8670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404841
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404841
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415028437
  error estimate for blocks of size 2^( 2) =       0.000427677366
  error estimate for blocks of size 2^( 3) =       0.000440582246
  error estimate for blocks of size 2^( 4) =       0.000451843781
  error estimate for blocks of size 2^( 5) =       0.000462974430
  error estimate for blocks of size 2^( 6) =       0.000471995956
  error estimate for blocks of size 2^( 7) =       0.000480081010

      target function =                  N/A
              le_mean =     -16.905606791959
             les_mean =     286.144038039137
             stat err =       0.000466723794
             autocorr =       1.264632023461
              std dev =       0.586938844386
             le_variance =       0.344497207049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404858
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404858
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415028437
  error estimate for blocks of size 2^( 2) =       0.000427677366
  error estimate for blocks of size 2^( 3) =       0.000440582246
  error estimate for blocks of size 2^( 4) =       0.000451843781
  error estimate for blocks of size 2^( 5) =       0.000462974430
  error estimate for blocks of size 2^( 6) =       0.000471995956
  error estimate for blocks of size 2^( 7) =       0.000480081010

      target function =                  N/A
              le_mean =     -16.905606791959
             les_mean =     286.144038039164
             stat err =       0.000466723794
             autocorr =       1.264632023435
              std dev =       0.586938844400
             le_variance =       0.344497207066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404850
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404850
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415028437
  error estimate for blocks of size 2^( 2) =       0.000427677366
  error estimate for blocks of size 2^( 3) =       0.000440582246
  error estimate for blocks of size 2^( 4) =       0.000451843781
  error estimate for blocks of size 2^( 5) =       0.000462974430
  error estimate for blocks of size 2^( 6) =       0.000471995956
  error estimate for blocks of size 2^( 7) =       0.000480081010

      target function =                  N/A
              le_mean =     -16.905606791959
             les_mean =     286.144038039150
             stat err =       0.000466723794
             autocorr =       1.264632023445
              std dev =       0.586938844393
             le_variance =       0.344497207057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404843
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344399404843
                                         uncertainty =       0.009640462777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415028437
  error estimate for blocks of size 2^( 2) =       0.000427677366
  error estimate for blocks of size 2^( 3) =       0.000440582246
  error estimate for blocks of size 2^( 4) =       0.000451843781
  error estimate for blocks of size 2^( 5) =       0.000462974430
  error estimate for blocks of size 2^( 6) =       0.000471995956
  error estimate for blocks of size 2^( 7) =       0.000480081010

      target function =                  N/A
              le_mean =     -16.905606791959
             les_mean =     286.144038039139
             stat err =       0.000466723794
             autocorr =       1.264632023451
              std dev =       0.586938844387
             le_variance =       0.344497207050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905606791959        initial
     5.9605e+06     5.9605e+07             5.5171e-11       -16.905606791959  <--
     2.3842e+07     2.3842e+08             1.3793e-11       -16.905606791959
     9.5367e+07     9.5367e+08             3.4482e-12       -16.905606791959

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 3.0225e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.311312
====================================================
  Execution time = 2.0933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338888786913
                                         uncertainty =       0.005365136729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338888786913
                                         uncertainty =       0.005365136729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411651757
  error estimate for blocks of size 2^( 2) =       0.000424378907
  error estimate for blocks of size 2^( 3) =       0.000437077592
  error estimate for blocks of size 2^( 4) =       0.000449897096
  error estimate for blocks of size 2^( 5) =       0.000460613789
  error estimate for blocks of size 2^( 6) =       0.000467213660
  error estimate for blocks of size 2^( 7) =       0.000473538508

      target function =                  N/A
              le_mean =     -16.905915753036
             les_mean =     286.148901617291
             stat err =       0.000462815763
             autocorr =       1.264026962177
              std dev =       0.582163497639
             le_variance =       0.338914337983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591575304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915753036       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915753038       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905915753038       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905915753038       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905915753078       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905915752971       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905915752913       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905915753291       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.295376e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915753036       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915753037       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905915753037       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905915753037       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905915753037       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905915747605       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905915750603       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905915754775       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.738452e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915753036       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915753037       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905915753037       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905915753036       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905915753036       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905915759752       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905915778513       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905915750832       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.434593e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6532e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.171359
====================================================
  Execution time = 2.2684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3579e-01
  Total weights = 2.0000e+06
  Execution time = 1.8646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162561
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162561
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409750492
  error estimate for blocks of size 2^( 2) =       0.000423253597
  error estimate for blocks of size 2^( 3) =       0.000436576981
  error estimate for blocks of size 2^( 4) =       0.000448908789
  error estimate for blocks of size 2^( 5) =       0.000460270771
  error estimate for blocks of size 2^( 6) =       0.000468466722
  error estimate for blocks of size 2^( 7) =       0.000477267147

      target function =                  N/A
              le_mean =     -16.905558927840
             les_mean =     286.133713425655
             stat err =       0.000463728357
             autocorr =       1.280820710559
              std dev =       0.579474702548
             le_variance =       0.335790930894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162602
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162602
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409750492
  error estimate for blocks of size 2^( 2) =       0.000423253597
  error estimate for blocks of size 2^( 3) =       0.000436576981
  error estimate for blocks of size 2^( 4) =       0.000448908789
  error estimate for blocks of size 2^( 5) =       0.000460270771
  error estimate for blocks of size 2^( 6) =       0.000468466722
  error estimate for blocks of size 2^( 7) =       0.000477267147

      target function =                  N/A
              le_mean =     -16.905558927839
             les_mean =     286.133713425691
             stat err =       0.000463728357
             autocorr =       1.280820710476
              std dev =       0.579474702583
             le_variance =       0.335790930934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162581
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162581
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409750492
  error estimate for blocks of size 2^( 2) =       0.000423253597
  error estimate for blocks of size 2^( 3) =       0.000436576981
  error estimate for blocks of size 2^( 4) =       0.000448908789
  error estimate for blocks of size 2^( 5) =       0.000460270771
  error estimate for blocks of size 2^( 6) =       0.000468466722
  error estimate for blocks of size 2^( 7) =       0.000477267147

      target function =                  N/A
              le_mean =     -16.905558927840
             les_mean =     286.133713425673
             stat err =       0.000463728357
             autocorr =       1.280820710524
              std dev =       0.579474702566
             le_variance =       0.335790930914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162564
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335893162564
                                         uncertainty =       0.003341600873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409750492
  error estimate for blocks of size 2^( 2) =       0.000423253597
  error estimate for blocks of size 2^( 3) =       0.000436576981
  error estimate for blocks of size 2^( 4) =       0.000448908789
  error estimate for blocks of size 2^( 5) =       0.000460270771
  error estimate for blocks of size 2^( 6) =       0.000468466722
  error estimate for blocks of size 2^( 7) =       0.000477267147

      target function =                  N/A
              le_mean =     -16.905558927840
             les_mean =     286.133713425657
             stat err =       0.000463728357
             autocorr =       1.280820710557
              std dev =       0.579474702551
             le_variance =       0.335790930896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905558927840        initial  <--
     1.4901e+06     1.4901e+07             2.2954e-10       -16.905558927839
     5.9605e+06     5.9605e+07             5.7385e-11       -16.905558927840
     2.3842e+07     2.3842e+08             1.4346e-11       -16.905558927840

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1096
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.20624
====================================================
  Execution time = 2.1251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4865e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348711819062
                                         uncertainty =       0.010395049419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348711819062
                                         uncertainty =       0.010395049419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417520392
  error estimate for blocks of size 2^( 2) =       0.000430512994
  error estimate for blocks of size 2^( 3) =       0.000443564722
  error estimate for blocks of size 2^( 4) =       0.000455793737
  error estimate for blocks of size 2^( 5) =       0.000467181880
  error estimate for blocks of size 2^( 6) =       0.000474743456
  error estimate for blocks of size 2^( 7) =       0.000480366066

      target function =                  N/A
              le_mean =     -16.907076913414
             les_mean =     286.197896137170
             stat err =       0.000469521285
             autocorr =       1.264605851876
              std dev =       0.590463000868
             le_variance =       0.348646555394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690707691341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907076913414       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907076913414       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907076913414       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907076916318       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907076918440       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907076908427       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907076899332       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907076908059       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.570505e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907076913414       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907076913414       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907076913414       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907076913414       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907076938034       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907076961474       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907076970659       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907076914103       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 6.426179e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907076913414       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907076913414       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907076913414       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907076922857       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907076918867       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907076906978       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907077327980       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907076935149       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.606479e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7201e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9276
    reference variance = 0.215921
====================================================
  Execution time = 2.0538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3847e-01
  Total weights = 2.0000e+06
  Execution time = 1.8673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526755
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526755
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411380691
  error estimate for blocks of size 2^( 2) =       0.000424122601
  error estimate for blocks of size 2^( 3) =       0.000436979368
  error estimate for blocks of size 2^( 4) =       0.000449615766
  error estimate for blocks of size 2^( 5) =       0.000460163084
  error estimate for blocks of size 2^( 6) =       0.000468602961
  error estimate for blocks of size 2^( 7) =       0.000473379718

      target function =                  N/A
              le_mean =     -16.905674190347
             les_mean =     286.140287806991
             stat err =       0.000462940382
             autocorr =       1.266374989178
              std dev =       0.581780152700
             le_variance =       0.338468146076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526751
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526751
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411380691
  error estimate for blocks of size 2^( 2) =       0.000424122601
  error estimate for blocks of size 2^( 3) =       0.000436979368
  error estimate for blocks of size 2^( 4) =       0.000449615766
  error estimate for blocks of size 2^( 5) =       0.000460163084
  error estimate for blocks of size 2^( 6) =       0.000468602961
  error estimate for blocks of size 2^( 7) =       0.000473379718

      target function =                  N/A
              le_mean =     -16.905674190347
             les_mean =     286.140287806987
             stat err =       0.000462940382
             autocorr =       1.266374989170
              std dev =       0.581780152696
             le_variance =       0.338468146071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526753
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526753
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411380691
  error estimate for blocks of size 2^( 2) =       0.000424122601
  error estimate for blocks of size 2^( 3) =       0.000436979368
  error estimate for blocks of size 2^( 4) =       0.000449615766
  error estimate for blocks of size 2^( 5) =       0.000460163084
  error estimate for blocks of size 2^( 6) =       0.000468602961
  error estimate for blocks of size 2^( 7) =       0.000473379718

      target function =                  N/A
              le_mean =     -16.905674190347
             les_mean =     286.140287806989
             stat err =       0.000462940382
             autocorr =       1.266374989181
              std dev =       0.581780152698
             le_variance =       0.338468146073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526755
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338552526755
                                         uncertainty =       0.004260732173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411380691
  error estimate for blocks of size 2^( 2) =       0.000424122601
  error estimate for blocks of size 2^( 3) =       0.000436979368
  error estimate for blocks of size 2^( 4) =       0.000449615766
  error estimate for blocks of size 2^( 5) =       0.000460163084
  error estimate for blocks of size 2^( 6) =       0.000468602961
  error estimate for blocks of size 2^( 7) =       0.000473379718

      target function =                  N/A
              le_mean =     -16.905674190347
             les_mean =     286.140287806991
             stat err =       0.000462940382
             autocorr =       1.266374989175
              std dev =       0.581780152700
             le_variance =       0.338468146076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905674190347        initial
     1.4901e+07     1.4901e+08             2.5705e-11       -16.905674190347  <--
     5.9605e+07     5.9605e+08             6.4262e-12       -16.905674190347
     2.3842e+08     2.3842e+09             1.6065e-12       -16.905674190347

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.9938e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7221e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.565602
====================================================
  Execution time = 2.1483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3292e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333027562803
                                         uncertainty =       0.002799552417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333027562803
                                         uncertainty =       0.002799552417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407996828
  error estimate for blocks of size 2^( 2) =       0.000420339307
  error estimate for blocks of size 2^( 3) =       0.000433107307
  error estimate for blocks of size 2^( 4) =       0.000444306329
  error estimate for blocks of size 2^( 5) =       0.000453998041
  error estimate for blocks of size 2^( 6) =       0.000460768646
  error estimate for blocks of size 2^( 7) =       0.000466415626

      target function =                  N/A
              le_mean =     -16.906979703438
             les_mean =     286.178885349690
             stat err =       0.000456372161
             autocorr =       1.251194175964
              std dev =       0.576994647898
             le_variance =       0.332922823703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690697970344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906979703438       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906979703438       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906979703438       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906979703439       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906979702766       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906979704866       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906979701987       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906979706098       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 8.743250e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906979703438       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906979703438       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906979703438       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906979703533       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906979703438       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906979697791       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906979702231       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906979705882       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.185821e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906979703438       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906979703438       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906979703438       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906979703438       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906979714627       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906979695338       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906979711135       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906979755684       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 5.464507e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7204e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.39547
====================================================
  Execution time = 2.0675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3764e-01
  Total weights = 2.0000e+06
  Execution time = 1.8624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358174
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358174
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874294
  error estimate for blocks of size 2^( 2) =       0.000423662937
  error estimate for blocks of size 2^( 3) =       0.000436870579
  error estimate for blocks of size 2^( 4) =       0.000449482055
  error estimate for blocks of size 2^( 5) =       0.000460609557
  error estimate for blocks of size 2^( 6) =       0.000470094239
  error estimate for blocks of size 2^( 7) =       0.000478221037

      target function =                  N/A
              le_mean =     -16.905437199234
             les_mean =     286.131442100084
             stat err =       0.000464601722
             autocorr =       1.278626459818
              std dev =       0.581063999609
             le_variance =       0.337635371641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358173
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358173
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874294
  error estimate for blocks of size 2^( 2) =       0.000423662937
  error estimate for blocks of size 2^( 3) =       0.000436870579
  error estimate for blocks of size 2^( 4) =       0.000449482055
  error estimate for blocks of size 2^( 5) =       0.000460609557
  error estimate for blocks of size 2^( 6) =       0.000470094239
  error estimate for blocks of size 2^( 7) =       0.000478221037

      target function =                  N/A
              le_mean =     -16.905437199234
             les_mean =     286.131442100081
             stat err =       0.000464601722
             autocorr =       1.278626459794
              std dev =       0.581063999608
             le_variance =       0.337635371640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358173
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358173
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874294
  error estimate for blocks of size 2^( 2) =       0.000423662937
  error estimate for blocks of size 2^( 3) =       0.000436870579
  error estimate for blocks of size 2^( 4) =       0.000449482055
  error estimate for blocks of size 2^( 5) =       0.000460609557
  error estimate for blocks of size 2^( 6) =       0.000470094239
  error estimate for blocks of size 2^( 7) =       0.000478221037

      target function =                  N/A
              le_mean =     -16.905437199234
             les_mean =     286.131442100082
             stat err =       0.000464601722
             autocorr =       1.278626459796
              std dev =       0.581063999608
             le_variance =       0.337635371641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358174
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337350358174
                                         uncertainty =       0.005485288395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874294
  error estimate for blocks of size 2^( 2) =       0.000423662937
  error estimate for blocks of size 2^( 3) =       0.000436870579
  error estimate for blocks of size 2^( 4) =       0.000449482055
  error estimate for blocks of size 2^( 5) =       0.000460609557
  error estimate for blocks of size 2^( 6) =       0.000470094239
  error estimate for blocks of size 2^( 7) =       0.000478221037

      target function =                  N/A
              le_mean =     -16.905437199234
             les_mean =     286.131442100084
             stat err =       0.000464601722
             autocorr =       1.278626459809
              std dev =       0.581063999609
             le_variance =       0.337635371641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905437199234        initial  <--
     3.7253e+06     3.7253e+07             8.7433e-11       -16.905437199234
     1.4901e+07     1.4901e+08             2.1858e-11       -16.905437199234
     5.9605e+07     5.9605e+08             5.4645e-12       -16.905437199234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0504
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8797
    reference variance = 0.217848
====================================================
  Execution time = 2.0691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339189696807
                                         uncertainty =       0.005421588233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339189696807
                                         uncertainty =       0.005421588233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411898380
  error estimate for blocks of size 2^( 2) =       0.000424291913
  error estimate for blocks of size 2^( 3) =       0.000437583218
  error estimate for blocks of size 2^( 4) =       0.000449213111
  error estimate for blocks of size 2^( 5) =       0.000459023382
  error estimate for blocks of size 2^( 6) =       0.000465096637
  error estimate for blocks of size 2^( 7) =       0.000468417357

      target function =                  N/A
              le_mean =     -16.905341404874
             les_mean =     286.129888396838
             stat err =       0.000460437622
             autocorr =       1.249572434773
              std dev =       0.582512275538
             le_variance =       0.339320551152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534140487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905341404874       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905341404874       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905341404874       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905341404874       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905341405131       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905341406300       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905341430967       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905341391922       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 8.511338e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905341404874       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905341404874       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905341404874       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905341404874       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905341404877       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905341438857       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905341449711       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905341447384       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.127821e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905341404874       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905341404874       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905341404874       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905341404853       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905341380034       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905341945748       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905341315072       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905341502174       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 5.318794e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6197e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9316
    reference variance = 0.26613
====================================================
  Execution time = 2.0660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3815e-01
  Total weights = 2.0000e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454249
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454249
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411184593
  error estimate for blocks of size 2^( 2) =       0.000424223563
  error estimate for blocks of size 2^( 3) =       0.000436962183
  error estimate for blocks of size 2^( 4) =       0.000448863423
  error estimate for blocks of size 2^( 5) =       0.000460199273
  error estimate for blocks of size 2^( 6) =       0.000469476174
  error estimate for blocks of size 2^( 7) =       0.000477077451

      target function =                  N/A
              le_mean =     -16.906274960850
             les_mean =     286.160278421937
             stat err =       0.000463904080
             autocorr =       1.272866093258
              std dev =       0.581502828147
             le_variance =       0.338145539143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454252
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454252
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411184593
  error estimate for blocks of size 2^( 2) =       0.000424223563
  error estimate for blocks of size 2^( 3) =       0.000436962183
  error estimate for blocks of size 2^( 4) =       0.000448863423
  error estimate for blocks of size 2^( 5) =       0.000460199273
  error estimate for blocks of size 2^( 6) =       0.000469476174
  error estimate for blocks of size 2^( 7) =       0.000477077451

      target function =                  N/A
              le_mean =     -16.906274960850
             les_mean =     286.160278421941
             stat err =       0.000463904080
             autocorr =       1.272866093248
              std dev =       0.581502828150
             le_variance =       0.338145539146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454250
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454250
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411184593
  error estimate for blocks of size 2^( 2) =       0.000424223563
  error estimate for blocks of size 2^( 3) =       0.000436962183
  error estimate for blocks of size 2^( 4) =       0.000448863423
  error estimate for blocks of size 2^( 5) =       0.000460199273
  error estimate for blocks of size 2^( 6) =       0.000469476174
  error estimate for blocks of size 2^( 7) =       0.000477077451

      target function =                  N/A
              le_mean =     -16.906274960850
             les_mean =     286.160278421939
             stat err =       0.000463904080
             autocorr =       1.272866093255
              std dev =       0.581502828148
             le_variance =       0.338145539145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454249
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149454249
                                         uncertainty =       0.003327094139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411184593
  error estimate for blocks of size 2^( 2) =       0.000424223563
  error estimate for blocks of size 2^( 3) =       0.000436962183
  error estimate for blocks of size 2^( 4) =       0.000448863423
  error estimate for blocks of size 2^( 5) =       0.000460199273
  error estimate for blocks of size 2^( 6) =       0.000469476174
  error estimate for blocks of size 2^( 7) =       0.000477077451

      target function =                  N/A
              le_mean =     -16.906274960850
             les_mean =     286.160278421938
             stat err =       0.000463904080
             autocorr =       1.272866093263
              std dev =       0.581502828147
             le_variance =       0.338145539143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906274960850        initial
     3.7253e+07     3.7253e+08             8.5113e-12       -16.906274960850  <--
     1.4901e+08     1.4901e+09             2.1278e-12       -16.906274960850
     5.9605e+08     5.9605e+09             5.3188e-13       -16.906274960850

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 3.0092e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.220549
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333234132193
                                         uncertainty =       0.003540237098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333234132193
                                         uncertainty =       0.003540237098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408231072
  error estimate for blocks of size 2^( 2) =       0.000420797411
  error estimate for blocks of size 2^( 3) =       0.000433611300
  error estimate for blocks of size 2^( 4) =       0.000446507944
  error estimate for blocks of size 2^( 5) =       0.000456578246
  error estimate for blocks of size 2^( 6) =       0.000465075694
  error estimate for blocks of size 2^( 7) =       0.000469545437

      target function =                  N/A
              le_mean =     -16.905359966174
             les_mean =     286.124500634846
             stat err =       0.000459426830
             autocorr =       1.266544910347
              std dev =       0.577325917995
             le_variance =       0.333305215589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690535996617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905359966174       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905359966174       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905359966174       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905359966174       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905359960294       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905359970177       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905359975352       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905359978084       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.564640e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905359966174       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905359966174       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905359966174       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905359966174       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905359966174       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905359958610       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905359987542       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905359942556       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 8.911579e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905359966174       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905359966174       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905359966174       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905359966174       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905359966174       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905359975973       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905359842100       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905360052178       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.227840e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9938
    reference variance = 0.39186
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3579e-01
  Total weights = 2.0000e+06
  Execution time = 1.8651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839010
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839010
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409751857
  error estimate for blocks of size 2^( 2) =       0.000422010934
  error estimate for blocks of size 2^( 3) =       0.000435621372
  error estimate for blocks of size 2^( 4) =       0.000448245890
  error estimate for blocks of size 2^( 5) =       0.000459104432
  error estimate for blocks of size 2^( 6) =       0.000468977533
  error estimate for blocks of size 2^( 7) =       0.000472194827

      target function =                  N/A
              le_mean =     -16.906501664073
             les_mean =     286.165591517754
             stat err =       0.000462130670
             autocorr =       1.272001795792
              std dev =       0.579476633133
             le_variance =       0.335793168347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839032
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839032
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409751857
  error estimate for blocks of size 2^( 2) =       0.000422010934
  error estimate for blocks of size 2^( 3) =       0.000435621372
  error estimate for blocks of size 2^( 4) =       0.000448245890
  error estimate for blocks of size 2^( 5) =       0.000459104432
  error estimate for blocks of size 2^( 6) =       0.000468977533
  error estimate for blocks of size 2^( 7) =       0.000472194827

      target function =                  N/A
              le_mean =     -16.906501664073
             les_mean =     286.165591517776
             stat err =       0.000462130670
             autocorr =       1.272001795781
              std dev =       0.579476633152
             le_variance =       0.335793168369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839021
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839021
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409751857
  error estimate for blocks of size 2^( 2) =       0.000422010934
  error estimate for blocks of size 2^( 3) =       0.000435621372
  error estimate for blocks of size 2^( 4) =       0.000448245890
  error estimate for blocks of size 2^( 5) =       0.000459104432
  error estimate for blocks of size 2^( 6) =       0.000468977533
  error estimate for blocks of size 2^( 7) =       0.000472194827

      target function =                  N/A
              le_mean =     -16.906501664073
             les_mean =     286.165591517765
             stat err =       0.000462130670
             autocorr =       1.272001795782
              std dev =       0.579476633142
             le_variance =       0.335793168358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839011
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335743839011
                                         uncertainty =       0.004361717335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409751857
  error estimate for blocks of size 2^( 2) =       0.000422010934
  error estimate for blocks of size 2^( 3) =       0.000435621372
  error estimate for blocks of size 2^( 4) =       0.000448245890
  error estimate for blocks of size 2^( 5) =       0.000459104432
  error estimate for blocks of size 2^( 6) =       0.000468977533
  error estimate for blocks of size 2^( 7) =       0.000472194827

      target function =                  N/A
              le_mean =     -16.906501664073
             les_mean =     286.165591517755
             stat err =       0.000462130670
             autocorr =       1.272001795794
              std dev =       0.579476633134
             le_variance =       0.335793168348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906501664073        initial  <--
     9.3132e+06     9.3132e+07             3.5646e-11       -16.906501664073
     3.7253e+07     3.7253e+08             8.9116e-12       -16.906501664073
     1.4901e+08     1.4901e+09             2.2278e-12       -16.906501664073

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9249
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.265802
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3836e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338421110470
                                         uncertainty =       0.004335555826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338421110470
                                         uncertainty =       0.004335555826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411317352
  error estimate for blocks of size 2^( 2) =       0.000423902866
  error estimate for blocks of size 2^( 3) =       0.000435929772
  error estimate for blocks of size 2^( 4) =       0.000447501443
  error estimate for blocks of size 2^( 5) =       0.000457479667
  error estimate for blocks of size 2^( 6) =       0.000464892385
  error estimate for blocks of size 2^( 7) =       0.000469011550

      target function =                  N/A
              le_mean =     -16.905594173424
             les_mean =     286.137478115775
             stat err =       0.000459721261
             autocorr =       1.249209032319
              std dev =       0.581690577932
             le_variance =       0.338363928455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559417342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594173424       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905594173424       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905594173424       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905594173424       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905594198947       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905594174223       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905594176210       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905594126125       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.619201e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594173424       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905594173424       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905594173424       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905594282619       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905594115001       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905594410592       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905594152155       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905593906779       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 9.048432e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594173424       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905594173424       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905594173424       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905594145127       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593841272       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595730388       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905593943225       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905594892009       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 2.262275e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6105e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9167
    reference variance = 0.40257
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4287e-01
  Total weights = 2.0000e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257107
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257107
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414046754
  error estimate for blocks of size 2^( 2) =       0.000426576220
  error estimate for blocks of size 2^( 3) =       0.000439532062
  error estimate for blocks of size 2^( 4) =       0.000452047642
  error estimate for blocks of size 2^( 5) =       0.000461537922
  error estimate for blocks of size 2^( 6) =       0.000469002651
  error estimate for blocks of size 2^( 7) =       0.000470307772

      target function =                  N/A
              le_mean =     -16.906174661614
             les_mean =     286.161610945755
             stat err =       0.000463223997
             autocorr =       1.251651233219
              std dev =       0.585550534268
             le_variance =       0.342869428181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257110
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257110
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414046754
  error estimate for blocks of size 2^( 2) =       0.000426576220
  error estimate for blocks of size 2^( 3) =       0.000439532062
  error estimate for blocks of size 2^( 4) =       0.000452047642
  error estimate for blocks of size 2^( 5) =       0.000461537922
  error estimate for blocks of size 2^( 6) =       0.000469002651
  error estimate for blocks of size 2^( 7) =       0.000470307772

      target function =                  N/A
              le_mean =     -16.906174661614
             les_mean =     286.161610945757
             stat err =       0.000463223997
             autocorr =       1.251651233216
              std dev =       0.585550534270
             le_variance =       0.342869428184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257109
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257109
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414046754
  error estimate for blocks of size 2^( 2) =       0.000426576220
  error estimate for blocks of size 2^( 3) =       0.000439532062
  error estimate for blocks of size 2^( 4) =       0.000452047642
  error estimate for blocks of size 2^( 5) =       0.000461537922
  error estimate for blocks of size 2^( 6) =       0.000469002651
  error estimate for blocks of size 2^( 7) =       0.000470307772

      target function =                  N/A
              le_mean =     -16.906174661614
             les_mean =     286.161610945756
             stat err =       0.000463223997
             autocorr =       1.251651233224
              std dev =       0.585550534269
             le_variance =       0.342869428183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257108
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342949257108
                                         uncertainty =       0.004318780987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414046754
  error estimate for blocks of size 2^( 2) =       0.000426576220
  error estimate for blocks of size 2^( 3) =       0.000439532062
  error estimate for blocks of size 2^( 4) =       0.000452047642
  error estimate for blocks of size 2^( 5) =       0.000461537922
  error estimate for blocks of size 2^( 6) =       0.000469002651
  error estimate for blocks of size 2^( 7) =       0.000470307772

      target function =                  N/A
              le_mean =     -16.906174661614
             les_mean =     286.161610945755
             stat err =       0.000463223997
             autocorr =       1.251651233218
              std dev =       0.585550534268
             le_variance =       0.342869428181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906174661614        initial  <--
     9.3132e+07     9.3132e+08             3.6192e-12       -16.906174661614
     3.7253e+08     3.7253e+09             9.0484e-13       -16.906174661614
     1.4901e+09     1.4901e+10             2.2623e-13       -16.906174661614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.9127
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9655
    reference variance = 0.431495
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344365202392
                                         uncertainty =       0.005064412096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344365202392
                                         uncertainty =       0.005064412096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414921935
  error estimate for blocks of size 2^( 2) =       0.000427522615
  error estimate for blocks of size 2^( 3) =       0.000440356872
  error estimate for blocks of size 2^( 4) =       0.000452551306
  error estimate for blocks of size 2^( 5) =       0.000463022075
  error estimate for blocks of size 2^( 6) =       0.000472493578
  error estimate for blocks of size 2^( 7) =       0.000479174764

      target function =                  N/A
              le_mean =     -16.906118152491
             les_mean =     286.161151237486
             stat err =       0.000466810431
             autocorr =       1.265751104021
              std dev =       0.586788227268
             le_variance =       0.344320423660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611815249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118152491       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118152491       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118152491       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906117955236       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118152491       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118218108       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118219990       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906117582871       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 3.822046e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118152491       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118152491       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118152491       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118766745       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118996889       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116044108       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906117827036       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114921248       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 9.570024e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118152491       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118152491       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118152491       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118230275       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112016181       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127612372       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114236740       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906109083699       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906117257526       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 2.385758e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6338e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.20247
====================================================
  Execution time = 2.2822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3285e-01
  Total weights = 2.0000e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407954295
  error estimate for blocks of size 2^( 2) =       0.000420231320
  error estimate for blocks of size 2^( 3) =       0.000433066945
  error estimate for blocks of size 2^( 4) =       0.000445236721
  error estimate for blocks of size 2^( 5) =       0.000455831126
  error estimate for blocks of size 2^( 6) =       0.000463039490
  error estimate for blocks of size 2^( 7) =       0.000467210247

      target function =                  N/A
              le_mean =     -16.906356531104
             les_mean =     286.157744403359
             stat err =       0.000457829396
             autocorr =       1.259459855790
              std dev =       0.576934496275
             le_variance =       0.332853412992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407954295
  error estimate for blocks of size 2^( 2) =       0.000420231320
  error estimate for blocks of size 2^( 3) =       0.000433066945
  error estimate for blocks of size 2^( 4) =       0.000445236721
  error estimate for blocks of size 2^( 5) =       0.000455831126
  error estimate for blocks of size 2^( 6) =       0.000463039490
  error estimate for blocks of size 2^( 7) =       0.000467210247

      target function =                  N/A
              le_mean =     -16.906356531104
             les_mean =     286.157744403360
             stat err =       0.000457829396
             autocorr =       1.259459855793
              std dev =       0.576934496275
             le_variance =       0.332853412992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407954295
  error estimate for blocks of size 2^( 2) =       0.000420231320
  error estimate for blocks of size 2^( 3) =       0.000433066945
  error estimate for blocks of size 2^( 4) =       0.000445236721
  error estimate for blocks of size 2^( 5) =       0.000455831126
  error estimate for blocks of size 2^( 6) =       0.000463039490
  error estimate for blocks of size 2^( 7) =       0.000467210247

      target function =                  N/A
              le_mean =     -16.906356531104
             les_mean =     286.157744403360
             stat err =       0.000457829396
             autocorr =       1.259459855789
              std dev =       0.576934496275
             le_variance =       0.332853412992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332848964234
                                         uncertainty =       0.004121573650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407954295
  error estimate for blocks of size 2^( 2) =       0.000420231320
  error estimate for blocks of size 2^( 3) =       0.000433066945
  error estimate for blocks of size 2^( 4) =       0.000445236721
  error estimate for blocks of size 2^( 5) =       0.000455831126
  error estimate for blocks of size 2^( 6) =       0.000463039490
  error estimate for blocks of size 2^( 7) =       0.000467210247

      target function =                  N/A
              le_mean =     -16.906356531104
             les_mean =     286.157744403359
             stat err =       0.000457829396
             autocorr =       1.259459855790
              std dev =       0.576934496275
             le_variance =       0.332853412992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906356531104        initial  <--
     9.3132e+08     9.3132e+09             3.8220e-13       -16.906356531104
     3.7253e+09     3.7253e+10             9.5700e-14       -16.906356531104
     1.4901e+10     1.4901e+11             2.3858e-14       -16.906356531104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2331
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9267
    reference variance = 0.332591
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334279556413
                                         uncertainty =       0.003081208717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334279556413
                                         uncertainty =       0.003081208717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408792062
  error estimate for blocks of size 2^( 2) =       0.000421808322
  error estimate for blocks of size 2^( 3) =       0.000434556768
  error estimate for blocks of size 2^( 4) =       0.000447076824
  error estimate for blocks of size 2^( 5) =       0.000458284842
  error estimate for blocks of size 2^( 6) =       0.000468430231
  error estimate for blocks of size 2^( 7) =       0.000474891111

      target function =                  N/A
              le_mean =     -16.905978253093
             les_mean =     286.146322427580
             stat err =       0.000462170752
             autocorr =       1.278203515192
              std dev =       0.578119278896
             le_variance =       0.334221900631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597825309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978253093       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978253093       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978253093       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905978253093       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905978977722       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905979029743       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905978078936       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905977589778       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905978740882       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 4.888286e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978253093       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978253093       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978253093       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905978253093       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905978580377       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905978746389       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906020856691       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905967821838       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941072470       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905982249513       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905937983757       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906132438795       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905704215398       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905972496335       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907435246615       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906566173908       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907273657620       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905814108265       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907721687603       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903431884289       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911395771413       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.901617369985       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.903438793729       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.903937000860       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.898589495618       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.910291375917       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905802910274       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905800239311       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904996376568       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907277922969       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908688757157       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907374202871       residual = 3.26e-04           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.909690335594       residual = 2.38e-03           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 1.213390e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978253093       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978253093       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978253093       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905972594549       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906029144736       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906079479521       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941723202       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722603235       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905811246831       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904982777267       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905140817193       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903977967308       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908295151267       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906376908796       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904229972888       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.900271657283       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903820380678       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905286505456       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893034664170       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903920528477       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910780467501       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.920133502818       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.901674258648       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901469496480       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.921367042021       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.898731749068       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.929048712367       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.954389225229       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.896724602594       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908813771961       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.914501457672       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.911434290377       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.867345411961       residual = 2.10e-01           smallest_sin_value = 9.98e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 2.410730e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6528e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.307698
====================================================
  Execution time = 2.0850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3603e-01
  Total weights = 2.0000e+06
  Execution time = 1.8660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409897380
  error estimate for blocks of size 2^( 2) =       0.000422827238
  error estimate for blocks of size 2^( 3) =       0.000436133180
  error estimate for blocks of size 2^( 4) =       0.000448674281
  error estimate for blocks of size 2^( 5) =       0.000459378998
  error estimate for blocks of size 2^( 6) =       0.000466089354
  error estimate for blocks of size 2^( 7) =       0.000470664320

      target function =                  N/A
              le_mean =     -16.905554447283
             les_mean =     286.133802726193
             stat err =       0.000461201738
             autocorr =       1.265993822663
              std dev =       0.579682433876
             le_variance =       0.336031724144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409897380
  error estimate for blocks of size 2^( 2) =       0.000422827238
  error estimate for blocks of size 2^( 3) =       0.000436133180
  error estimate for blocks of size 2^( 4) =       0.000448674281
  error estimate for blocks of size 2^( 5) =       0.000459378998
  error estimate for blocks of size 2^( 6) =       0.000466089354
  error estimate for blocks of size 2^( 7) =       0.000470664320

      target function =                  N/A
              le_mean =     -16.905554447283
             les_mean =     286.133802726193
             stat err =       0.000461201738
             autocorr =       1.265993822662
              std dev =       0.579682433876
             le_variance =       0.336031724145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409897380
  error estimate for blocks of size 2^( 2) =       0.000422827238
  error estimate for blocks of size 2^( 3) =       0.000436133180
  error estimate for blocks of size 2^( 4) =       0.000448674281
  error estimate for blocks of size 2^( 5) =       0.000459378998
  error estimate for blocks of size 2^( 6) =       0.000466089354
  error estimate for blocks of size 2^( 7) =       0.000470664320

      target function =                  N/A
              le_mean =     -16.905554447283
             les_mean =     286.133802726193
             stat err =       0.000461201738
             autocorr =       1.265993822662
              std dev =       0.579682433876
             le_variance =       0.336031724145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056220876
                                         uncertainty =       0.003388301061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409897380
  error estimate for blocks of size 2^( 2) =       0.000422827238
  error estimate for blocks of size 2^( 3) =       0.000436133180
  error estimate for blocks of size 2^( 4) =       0.000448674281
  error estimate for blocks of size 2^( 5) =       0.000459378998
  error estimate for blocks of size 2^( 6) =       0.000466089354
  error estimate for blocks of size 2^( 7) =       0.000470664320

      target function =                  N/A
              le_mean =     -16.905554447283
             les_mean =     286.133802726193
             stat err =       0.000461201738
             autocorr =       1.265993822665
              std dev =       0.579682433876
             le_variance =       0.336031724145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905554447283        initial  <--
     9.3132e+09     9.3132e+10             4.8883e-14       -16.905554447283
     3.7253e+10     3.7253e+11             1.2134e-14       -16.905554447283
     1.4901e+11     1.4901e+12             2.4107e-15       -16.905554447283

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2786
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.2529
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334280212533
                                         uncertainty =       0.002669725967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334280212533
                                         uncertainty =       0.002669725967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408839122
  error estimate for blocks of size 2^( 2) =       0.000421818516
  error estimate for blocks of size 2^( 3) =       0.000434741430
  error estimate for blocks of size 2^( 4) =       0.000447105822
  error estimate for blocks of size 2^( 5) =       0.000459351188
  error estimate for blocks of size 2^( 6) =       0.000465813972
  error estimate for blocks of size 2^( 7) =       0.000470044409

      target function =                  N/A
              le_mean =     -16.906235374105
             les_mean =     286.155093212523
             stat err =       0.000460578848
             autocorr =       1.269121157471
              std dev =       0.578185830868
             le_variance =       0.334298855016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623537411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235374105       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906235374105       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906235374105       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906235374105       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200494992       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906306952743       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906230238112       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906299509677       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906169957587       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906204877765       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907407485972       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907575205553       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905360781993       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906303386664       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.900362802620       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907613102040       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.900017279371       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905859365997       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902923868156       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.900350641998       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903799384820       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905702608593       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.903351399194       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.915243107963       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903358538826       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.897157619578       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903605106959       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.899966741549       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906873264600       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.915994806365       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904666056067       residual = 9.37e-04           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.919782308811       residual = 2.58e-02           smallest_sin_value = 9.99e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 3.948352e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235374105       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906235374105       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906235374105       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906235374105       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906123929834       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905939795185       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904998885342       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910105906825       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903284772092       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905666914972       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.912451163932       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903167753147       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918834222019       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907880677728       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914013094628       residual = 8.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911950858508       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.902676661428       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.935229689013       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.916051743810       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.888454221720       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.924199276440       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.860123863290       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.923336397536       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.880953012768       residual = 8.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.917508239830       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914419460272       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.931933008081       residual = 8.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.860412074606       residual = 2.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.974160524728       residual = 5.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.848116980044       residual = 4.26e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.896859987958       residual = 1.48e-02           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 4.093177e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235374105       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906235374105       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906235374105       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905708462414       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.898121561904       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911489233131       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915215265434       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912563869521       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904211497443       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908428761815       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.889863248023       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907363460303       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.924192942608       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.936887084873       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.879924188939       residual = 8.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.742587220542       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.043205295688       residual = 2.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.787925229120       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.965309650152       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.943208342172       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.708238637317       residual = 5.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.932743376192       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.927823252819       residual = 8.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904149950433       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.141594160993       residual = 7.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.787908402135       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.701051228030       residual = 5.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.912602453897       residual = 6.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.935480956509       residual = 1.04e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.052961948911       residual = 3.09e+00           smallest_sin_value = 9.94e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 6.643726e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6395e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9637
    reference variance = 0.225901
====================================================
  Execution time = 2.0564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4341e-01
  Total weights = 2.0000e+06
  Execution time = 1.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414373113
  error estimate for blocks of size 2^( 2) =       0.000427214018
  error estimate for blocks of size 2^( 3) =       0.000440152039
  error estimate for blocks of size 2^( 4) =       0.000451600413
  error estimate for blocks of size 2^( 5) =       0.000462009448
  error estimate for blocks of size 2^( 6) =       0.000470096521
  error estimate for blocks of size 2^( 7) =       0.000475572263

      target function =                  N/A
              le_mean =     -16.906205909248
             les_mean =     286.163208227797
             stat err =       0.000464819661
             autocorr =       1.258304773129
              std dev =       0.586012076328
             le_variance =       0.343410153603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414373113
  error estimate for blocks of size 2^( 2) =       0.000427214018
  error estimate for blocks of size 2^( 3) =       0.000440152039
  error estimate for blocks of size 2^( 4) =       0.000451600413
  error estimate for blocks of size 2^( 5) =       0.000462009448
  error estimate for blocks of size 2^( 6) =       0.000470096521
  error estimate for blocks of size 2^( 7) =       0.000475572263

      target function =                  N/A
              le_mean =     -16.906205909248
             les_mean =     286.163208227797
             stat err =       0.000464819661
             autocorr =       1.258304773128
              std dev =       0.586012076328
             le_variance =       0.343410153603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414373113
  error estimate for blocks of size 2^( 2) =       0.000427214018
  error estimate for blocks of size 2^( 3) =       0.000440152039
  error estimate for blocks of size 2^( 4) =       0.000451600413
  error estimate for blocks of size 2^( 5) =       0.000462009448
  error estimate for blocks of size 2^( 6) =       0.000470096521
  error estimate for blocks of size 2^( 7) =       0.000475572263

      target function =                  N/A
              le_mean =     -16.906205909248
             les_mean =     286.163208227797
             stat err =       0.000464819661
             autocorr =       1.258304773129
              std dev =       0.586012076328
             le_variance =       0.343410153603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341834759066
                                         uncertainty =       0.006323633521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414373113
  error estimate for blocks of size 2^( 2) =       0.000427214018
  error estimate for blocks of size 2^( 3) =       0.000440152039
  error estimate for blocks of size 2^( 4) =       0.000451600413
  error estimate for blocks of size 2^( 5) =       0.000462009448
  error estimate for blocks of size 2^( 6) =       0.000470096521
  error estimate for blocks of size 2^( 7) =       0.000475572263

      target function =                  N/A
              le_mean =     -16.906205909248
             les_mean =     286.163208227797
             stat err =       0.000464819661
             autocorr =       1.258304773132
              std dev =       0.586012076328
             le_variance =       0.343410153603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906205909248        initial  <--
     9.3132e+10     9.3132e+11             3.9484e-15       -16.906205909248
     3.7253e+11     3.7253e+12             4.0932e-16       -16.906205909248
     1.4901e+12     1.4901e+13             6.6437e-17       -16.906205909248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9118
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8728
    reference variance = 0.203385
====================================================
  Execution time = 2.1224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4008e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340105882903
                                         uncertainty =       0.006348068940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340105882903
                                         uncertainty =       0.006348068940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412360889
  error estimate for blocks of size 2^( 2) =       0.000425213498
  error estimate for blocks of size 2^( 3) =       0.000438378470
  error estimate for blocks of size 2^( 4) =       0.000450170521
  error estimate for blocks of size 2^( 5) =       0.000459708533
  error estimate for blocks of size 2^( 6) =       0.000467216908
  error estimate for blocks of size 2^( 7) =       0.000473729766

      target function =                  N/A
              le_mean =     -16.904762744987
             les_mean =     286.111086299664
             stat err =       0.000462706432
             autocorr =       1.259088156612
              std dev =       0.583166361674
             le_variance =       0.340083005389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690476274499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762744987       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762744987       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904762744987       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904762744987       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904472105809       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904748534821       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903149215531       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903561261812       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.899818817791       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903027145673       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.901966519866       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904703447748       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905528602809       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908211396858       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911624537278       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909345674612       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.892458543127       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.964456407162       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.858006416078       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.949220357782       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.913824742989       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.898991554543       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.782809809644       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.829972273908       residual = 7.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.958865388460       residual = 3.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.888340871526       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.874700576331       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.948047051782       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.896256433609       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.909015995793       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.742537557548       residual = 3.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.050541858553       residual = 2.88e+00           smallest_sin_value = 9.95e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 2.021088e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762744987       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762744987       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904762744987       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904762744987       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904923399752       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403981999       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903679652641       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910900053900       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904830063766       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.890684349119       residual = 3.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923393802035       residual = 4.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.920416676851       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.939638547419       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.064412053844       residual = 3.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.045061064168       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.986927360802       residual = 8.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.915016106528       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.826074439386       residual = 9.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.934806879872       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.948695636549       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.764371245361       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.850953495330       residual = 5.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.010543479976       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.675805794824       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.941099255843       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.153857560019       residual = 8.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.209254227965       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.589567316158       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.960873028098       residual = 4.59e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.118930376777       residual = 6.22e+00           smallest_sin_value = 9.99e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 4.475066e-17

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904762744987       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762744987       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904762744987       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.895273948603       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.899495520853       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.015830770464       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.803588276358       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.754490584956       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.920935192751       residual = 4.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.959854427533       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.777812524220       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.798221984423       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.598445651574       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.287435985936       residual = 1.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.737317760614       residual = 3.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.816884242169       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.215942900096       residual = 6.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.693659722598       residual = 7.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.518397491230       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.844661671001       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.173840154786       residual = 8.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.978397107193       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.688253867007       residual = 8.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.397327861837       residual = 3.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -14.165870238369       residual = 9.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.409989924148       residual = 2.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.915591625856       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -15.284492528610       residual = 3.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.576971395668       residual = 5.13e+01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.040881789024       residual = 2.69e+00           smallest_sin_value = 9.97e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.250833505286       residual = 2.41e+01           smallest_sin_value = 9.97e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.556779878584       residual = 1.69e+01           smallest_sin_value = 9.93e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 1.118766e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6841e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.201446
====================================================
  Execution time = 2.0675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413088128
  error estimate for blocks of size 2^( 2) =       0.000425587740
  error estimate for blocks of size 2^( 3) =       0.000438523384
  error estimate for blocks of size 2^( 4) =       0.000450971310
  error estimate for blocks of size 2^( 5) =       0.000460541595
  error estimate for blocks of size 2^( 6) =       0.000466620434
  error estimate for blocks of size 2^( 7) =       0.000469862839

      target function =                  N/A
              le_mean =     -16.906031284401
             les_mean =     286.155177221243
             stat err =       0.000461999044
             autocorr =       1.250825502602
              std dev =       0.584194832873
             le_variance =       0.341283602755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413088128
  error estimate for blocks of size 2^( 2) =       0.000425587740
  error estimate for blocks of size 2^( 3) =       0.000438523384
  error estimate for blocks of size 2^( 4) =       0.000450971310
  error estimate for blocks of size 2^( 5) =       0.000460541595
  error estimate for blocks of size 2^( 6) =       0.000466620434
  error estimate for blocks of size 2^( 7) =       0.000469862839

      target function =                  N/A
              le_mean =     -16.906031284401
             les_mean =     286.155177221243
             stat err =       0.000461999044
             autocorr =       1.250825502602
              std dev =       0.584194832873
             le_variance =       0.341283602755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413088128
  error estimate for blocks of size 2^( 2) =       0.000425587740
  error estimate for blocks of size 2^( 3) =       0.000438523384
  error estimate for blocks of size 2^( 4) =       0.000450971310
  error estimate for blocks of size 2^( 5) =       0.000460541595
  error estimate for blocks of size 2^( 6) =       0.000466620434
  error estimate for blocks of size 2^( 7) =       0.000469862839

      target function =                  N/A
              le_mean =     -16.906031284401
             les_mean =     286.155177221243
             stat err =       0.000461999044
             autocorr =       1.250825502602
              std dev =       0.584194832873
             le_variance =       0.341283602755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341344416913
                                         uncertainty =       0.006676005662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413088128
  error estimate for blocks of size 2^( 2) =       0.000425587740
  error estimate for blocks of size 2^( 3) =       0.000438523384
  error estimate for blocks of size 2^( 4) =       0.000450971310
  error estimate for blocks of size 2^( 5) =       0.000460541595
  error estimate for blocks of size 2^( 6) =       0.000466620434
  error estimate for blocks of size 2^( 7) =       0.000469862839

      target function =                  N/A
              le_mean =     -16.906031284401
             les_mean =     286.155177221243
             stat err =       0.000461999044
             autocorr =       1.250825502602
              std dev =       0.584194832873
             le_variance =       0.341283602755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906031284401        initial  <--
     9.3132e+11     9.3132e+12             2.0211e-16       -16.906031284401
     3.7253e+12     3.7253e+13             4.4751e-17       -16.906031284401
     1.4901e+13     1.4901e+14             1.1188e-17       -16.906031284401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0629
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9605
    reference variance = 0.343898
====================================================
  Execution time = 2.1311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4030e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340339549376
                                         uncertainty =       0.003770981509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340339549376
                                         uncertainty =       0.003770981509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412490116
  error estimate for blocks of size 2^( 2) =       0.000425547013
  error estimate for blocks of size 2^( 3) =       0.000438622341
  error estimate for blocks of size 2^( 4) =       0.000451425537
  error estimate for blocks of size 2^( 5) =       0.000462420663
  error estimate for blocks of size 2^( 6) =       0.000470299598
  error estimate for blocks of size 2^( 7) =       0.000477750850

      target function =                  N/A
              le_mean =     -16.905518484064
             les_mean =     286.136851236265
             stat err =       0.000465474162
             autocorr =       1.273397709514
              std dev =       0.583349116214
             le_variance =       0.340296191387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551848406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518484064       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7013e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9655
    reference variance = 0.148972
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4931e-01
  Total weights = 2.0000e+06
  Execution time = 1.8667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417917198
  error estimate for blocks of size 2^( 2) =       0.000430658946
  error estimate for blocks of size 2^( 3) =       0.000443903275
  error estimate for blocks of size 2^( 4) =       0.000456636808
  error estimate for blocks of size 2^( 5) =       0.000467756086
  error estimate for blocks of size 2^( 6) =       0.000475849651
  error estimate for blocks of size 2^( 7) =       0.000482966872

      target function =                  N/A
              le_mean =     -16.905547747988
             les_mean =     286.146854053033
             stat err =       0.000470802354
             autocorr =       1.269102693493
              std dev =       0.591024168855
             le_variance =       0.349309568170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417917198
  error estimate for blocks of size 2^( 2) =       0.000430658946
  error estimate for blocks of size 2^( 3) =       0.000443903275
  error estimate for blocks of size 2^( 4) =       0.000456636808
  error estimate for blocks of size 2^( 5) =       0.000467756086
  error estimate for blocks of size 2^( 6) =       0.000475849651
  error estimate for blocks of size 2^( 7) =       0.000482966872

      target function =                  N/A
              le_mean =     -16.905547747988
             les_mean =     286.146854053033
             stat err =       0.000470802354
             autocorr =       1.269102693493
              std dev =       0.591024168855
             le_variance =       0.349309568170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417917198
  error estimate for blocks of size 2^( 2) =       0.000430658946
  error estimate for blocks of size 2^( 3) =       0.000443903275
  error estimate for blocks of size 2^( 4) =       0.000456636808
  error estimate for blocks of size 2^( 5) =       0.000467756086
  error estimate for blocks of size 2^( 6) =       0.000475849651
  error estimate for blocks of size 2^( 7) =       0.000482966872

      target function =                  N/A
              le_mean =     -16.905547747988
             les_mean =     286.146854053033
             stat err =       0.000470802354
             autocorr =       1.269102693493
              std dev =       0.591024168855
             le_variance =       0.349309568170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348974005631
                                         uncertainty =       0.011690816947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417917198
  error estimate for blocks of size 2^( 2) =       0.000430658946
  error estimate for blocks of size 2^( 3) =       0.000443903275
  error estimate for blocks of size 2^( 4) =       0.000456636808
  error estimate for blocks of size 2^( 5) =       0.000467756086
  error estimate for blocks of size 2^( 6) =       0.000475849651
  error estimate for blocks of size 2^( 7) =       0.000482966872

      target function =                  N/A
              le_mean =     -16.905547747988
             les_mean =     286.146854053033
             stat err =       0.000470802354
             autocorr =       1.269102693493
              std dev =       0.591024168855
             le_variance =       0.349309568170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905547747988        initial  <--
     9.3132e+12     9.3132e+13             0.0000e+00       -16.905547747988
     3.7253e+13     3.7253e+14             0.0000e+00       -16.905547747988
     1.4901e+14     1.4901e+15             0.0000e+00       -16.905547747988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8742
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9722
    reference variance = 0.270023
====================================================
  Execution time = 2.2924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334373222151
                                         uncertainty =       0.002684630804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334373222151
                                         uncertainty =       0.002684630804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408840026
  error estimate for blocks of size 2^( 2) =       0.000421451739
  error estimate for blocks of size 2^( 3) =       0.000434147043
  error estimate for blocks of size 2^( 4) =       0.000447380062
  error estimate for blocks of size 2^( 5) =       0.000458128260
  error estimate for blocks of size 2^( 6) =       0.000464950281
  error estimate for blocks of size 2^( 7) =       0.000470805412

      target function =                  N/A
              le_mean =     -16.906400118412
             les_mean =     286.160665131019
             stat err =       0.000460316004
             autocorr =       1.267667433535
              std dev =       0.578187110149
             le_variance =       0.334300334343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640011841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906400118412       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+13 is 1.187901e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906400118412       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+14 is 2.969754e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906400118412       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906400118412       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 7.424384e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8546e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.230328
====================================================
  Execution time = 2.0316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3750e-01
  Total weights = 2.0000e+06
  Execution time = 2.2053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410793639
  error estimate for blocks of size 2^( 2) =       0.000423537876
  error estimate for blocks of size 2^( 3) =       0.000436226931
  error estimate for blocks of size 2^( 4) =       0.000448306828
  error estimate for blocks of size 2^( 5) =       0.000458455769
  error estimate for blocks of size 2^( 6) =       0.000465350662
  error estimate for blocks of size 2^( 7) =       0.000470101239

      target function =                  N/A
              le_mean =     -16.906463429185
             les_mean =     286.166008341372
             stat err =       0.000460553625
             autocorr =       1.256935489969
              std dev =       0.580949935674
             le_variance =       0.337502827759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410793639
  error estimate for blocks of size 2^( 2) =       0.000423537876
  error estimate for blocks of size 2^( 3) =       0.000436226931
  error estimate for blocks of size 2^( 4) =       0.000448306828
  error estimate for blocks of size 2^( 5) =       0.000458455769
  error estimate for blocks of size 2^( 6) =       0.000465350662
  error estimate for blocks of size 2^( 7) =       0.000470101239

      target function =                  N/A
              le_mean =     -16.906463429185
             les_mean =     286.166008341372
             stat err =       0.000460553625
             autocorr =       1.256935489969
              std dev =       0.580949935674
             le_variance =       0.337502827759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410793639
  error estimate for blocks of size 2^( 2) =       0.000423537876
  error estimate for blocks of size 2^( 3) =       0.000436226931
  error estimate for blocks of size 2^( 4) =       0.000448306828
  error estimate for blocks of size 2^( 5) =       0.000458455769
  error estimate for blocks of size 2^( 6) =       0.000465350662
  error estimate for blocks of size 2^( 7) =       0.000470101239

      target function =                  N/A
              le_mean =     -16.906463429185
             les_mean =     286.166008341372
             stat err =       0.000460553625
             autocorr =       1.256935489969
              std dev =       0.580949935674
             le_variance =       0.337502827759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337584295630
                                         uncertainty =       0.006742204209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410793639
  error estimate for blocks of size 2^( 2) =       0.000423537876
  error estimate for blocks of size 2^( 3) =       0.000436226931
  error estimate for blocks of size 2^( 4) =       0.000448306828
  error estimate for blocks of size 2^( 5) =       0.000458455769
  error estimate for blocks of size 2^( 6) =       0.000465350662
  error estimate for blocks of size 2^( 7) =       0.000470101239

      target function =                  N/A
              le_mean =     -16.906463429185
             les_mean =     286.166008341372
             stat err =       0.000460553625
             autocorr =       1.256935489969
              std dev =       0.580949935674
             le_variance =       0.337502827759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906463429185        initial  <--
     9.3132e+13     9.3132e+14             1.1879e-18       -16.906463429185
     3.7253e+14     3.7253e+15             2.9698e-19       -16.906463429185
     1.4901e+15     1.4901e+16             7.4244e-20       -16.906463429185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7302
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9291e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9186
    reference variance = 0.182445
====================================================
  Execution time = 2.0450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5979e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359906146698
                                         uncertainty =       0.013030254078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359906146698
                                         uncertainty =       0.013030254078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424142957
  error estimate for blocks of size 2^( 2) =       0.000436743236
  error estimate for blocks of size 2^( 3) =       0.000449508928
  error estimate for blocks of size 2^( 4) =       0.000461487668
  error estimate for blocks of size 2^( 5) =       0.000471339907
  error estimate for blocks of size 2^( 6) =       0.000478867779
  error estimate for blocks of size 2^( 7) =       0.000484114309

      target function =                  N/A
              le_mean =     -16.905732175271
             les_mean =     286.163574698567
             stat err =       0.000473952416
             autocorr =       1.248662191554
              std dev =       0.599828722611
             le_variance =       0.359794496469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573217527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732175271       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732175271       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732175271       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732175271       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905732175271       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.666129618219       residual = 7.81e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.040439476623       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+15 is 2.798519e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905732175271       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905732175271       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6096e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.219416
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3956e-01
  Total weights = 2.0000e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043816
  error estimate for blocks of size 2^( 2) =       0.000424578197
  error estimate for blocks of size 2^( 3) =       0.000437335553
  error estimate for blocks of size 2^( 4) =       0.000449513400
  error estimate for blocks of size 2^( 5) =       0.000459684352
  error estimate for blocks of size 2^( 6) =       0.000467946723
  error estimate for blocks of size 2^( 7) =       0.000473435162

      target function =                  N/A
              le_mean =     -16.905681316920
             les_mean =     286.141620832113
             stat err =       0.000462644909
             autocorr =       1.260691353936
              std dev =       0.582717952891
             le_variance =       0.339560212622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043816
  error estimate for blocks of size 2^( 2) =       0.000424578197
  error estimate for blocks of size 2^( 3) =       0.000437335553
  error estimate for blocks of size 2^( 4) =       0.000449513400
  error estimate for blocks of size 2^( 5) =       0.000459684352
  error estimate for blocks of size 2^( 6) =       0.000467946723
  error estimate for blocks of size 2^( 7) =       0.000473435162

      target function =                  N/A
              le_mean =     -16.905681316920
             les_mean =     286.141620832113
             stat err =       0.000462644909
             autocorr =       1.260691353936
              std dev =       0.582717952891
             le_variance =       0.339560212622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043816
  error estimate for blocks of size 2^( 2) =       0.000424578197
  error estimate for blocks of size 2^( 3) =       0.000437335553
  error estimate for blocks of size 2^( 4) =       0.000449513400
  error estimate for blocks of size 2^( 5) =       0.000459684352
  error estimate for blocks of size 2^( 6) =       0.000467946723
  error estimate for blocks of size 2^( 7) =       0.000473435162

      target function =                  N/A
              le_mean =     -16.905681316920
             les_mean =     286.141620832113
             stat err =       0.000462644909
             autocorr =       1.260691353936
              std dev =       0.582717952891
             le_variance =       0.339560212622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339631777316
                                         uncertainty =       0.003464127247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043816
  error estimate for blocks of size 2^( 2) =       0.000424578197
  error estimate for blocks of size 2^( 3) =       0.000437335553
  error estimate for blocks of size 2^( 4) =       0.000449513400
  error estimate for blocks of size 2^( 5) =       0.000459684352
  error estimate for blocks of size 2^( 6) =       0.000467946723
  error estimate for blocks of size 2^( 7) =       0.000473435162

      target function =                  N/A
              le_mean =     -16.905681316920
             les_mean =     286.141620832113
             stat err =       0.000462644909
             autocorr =       1.260691353936
              std dev =       0.582717952891
             le_variance =       0.339560212622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905681316920        initial  <--
     9.3132e+14     9.3132e+15             0.0000e+00       -16.905681316920
     3.7253e+15     3.7253e+16             2.7985e-20       -16.905681316920
     1.4901e+16     1.4901e+17             0.0000e+00       -16.905681316920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7195
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093277e-01 1 1  ON 0
 uu_1                 1.425510e-01 1 1  ON 1
 uu_2                 4.102135e-02 1 1  ON 2
 uu_3                -2.135614e-02 1 1  ON 3
 uu_4                -6.669367e-02 1 1  ON 4
 uu_5                -1.013436e-01 1 1  ON 5
 uu_6                -1.284506e-01 1 1  ON 6
 uu_7                -1.417467e-01 1 1  ON 7
 uu_8                -1.335961e-01 1 1  ON 8
 uu_9                -1.050511e-01 1 1  ON 9
 ud_0                 4.482036e-01 1 1  ON 10
 ud_1                 1.827664e-01 1 1  ON 11
 ud_2                 6.290547e-02 1 1  ON 12
 ud_3                -7.758491e-03 1 1  ON 13
 ud_4                -6.501466e-02 1 1  ON 14
 ud_5                -1.070518e-01 1 1  ON 15
 ud_6                -1.350173e-01 1 1  ON 16
 ud_7                -1.521298e-01 1 1  ON 17
 ud_8                -1.529889e-01 1 1  ON 18
 ud_9                -1.433617e-01 1 1  ON 19
 eO_0                -7.602773e-01 1 1  ON 20
 eO_1                -4.397309e-01 1 1  ON 21
 eO_2                -2.161160e-02 1 1  ON 22
 eO_3                 2.988306e-01 1 1  ON 23
 eO_4                 5.254958e-01 1 1  ON 24
 eO_5                 4.878281e-01 1 1  ON 25
 eO_6                 2.599664e-01 1 1  ON 26
 eO_7                -4.072177e-02 1 1  ON 27
 eO_8                -2.216063e-01 1 1  ON 28
 eO_9                -8.672801e-02 1 1  ON 29
eH1_0                -2.451242e-01 1 1  ON 30
eH1_1                -1.455150e-01 1 1  ON 31
eH1_2                -9.862932e-02 1 1  ON 32
eH1_3                -4.477166e-02 1 1  ON 33
eH1_4                 3.406351e-03 1 1  ON 34
eH1_5                 3.809184e-02 1 1  ON 35
eH1_6                 9.666626e-02 1 1  ON 36
eH1_7                 1.541688e-01 1 1  ON 37
eH1_8                 1.774576e-01 1 1  ON 38
eH1_9                 6.824346e-02 1 1  ON 39
eH2_0                -2.428643e-01 1 1  ON 40
eH2_1                -1.431128e-01 1 1  ON 41
eH2_2                -9.652510e-02 1 1  ON 42
eH2_3                -4.249329e-02 1 1  ON 43
eH2_4                 5.715583e-03 1 1  ON 44
eH2_5                 4.026007e-02 1 1  ON 45
eH2_6                 9.939527e-02 1 1  ON 46
eH2_7                 1.552796e-01 1 1  ON 47
eH2_8                 1.829606e-01 1 1  ON 48
eH2_9                 5.788089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5821e+01 secs
  Total Execution time = 2.2890e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
