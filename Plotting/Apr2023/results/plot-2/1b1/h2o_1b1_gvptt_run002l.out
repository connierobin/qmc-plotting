--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0268.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 86103 MB
Rank =    1  Free Memory = 86094 MB
Rank =    2  Free Memory = 86092 MB
Rank =    3  Free Memory = 86092 MB
Rank =    4  Free Memory = 86092 MB
Rank =    5  Free Memory = 86092 MB
Rank =    6  Free Memory = 86092 MB
Rank =    7  Free Memory = 86092 MB
Rank =    8  Free Memory = 86092 MB
Rank =    9  Free Memory = 86092 MB
Rank =   10  Free Memory = 86092 MB
Rank =   11  Free Memory = 86092 MB
Rank =   12  Free Memory = 86092 MB
Rank =   13  Free Memory = 86092 MB
Rank =   14  Free Memory = 86092 MB
Rank =   15  Free Memory = 86092 MB
Rank =   16  Free Memory = 86092 MB
Rank =   17  Free Memory = 86092 MB
Rank =   18  Free Memory = 86092 MB
Rank =   19  Free Memory = 86092 MB
Rank =   20  Free Memory = 86092 MB
Rank =   21  Free Memory = 86092 MB
Rank =   22  Free Memory = 86092 MB
Rank =   23  Free Memory = 86092 MB
Rank =   24  Free Memory = 86092 MB
Rank =   25  Free Memory = 86092 MB
Rank =   26  Free Memory = 86092 MB
Rank =   27  Free Memory = 86092 MB
Rank =   28  Free Memory = 86092 MB
Rank =   29  Free Memory = 86092 MB
Rank =   30  Free Memory = 86092 MB
Rank =   31  Free Memory = 86092 MB
Rank =   32  Free Memory = 86092 MB
Rank =   33  Free Memory = 86092 MB
Rank =   34  Free Memory = 86092 MB
Rank =   35  Free Memory = 86092 MB
Rank =   36  Free Memory = 86092 MB
Rank =   37  Free Memory = 86092 MB
Rank =   38  Free Memory = 86092 MB
Rank =   39  Free Memory = 86092 MB
Rank =   40  Free Memory = 86188 MB
Rank =   41  Free Memory = 86188 MB
Rank =   42  Free Memory = 86188 MB
Rank =   43  Free Memory = 86188 MB
Rank =   44  Free Memory = 86188 MB
Rank =   45  Free Memory = 86188 MB
Rank =   46  Free Memory = 86188 MB
Rank =   47  Free Memory = 86188 MB
Rank =   48  Free Memory = 86188 MB
Rank =   49  Free Memory = 86188 MB
Rank =   50  Free Memory = 86188 MB
Rank =   51  Free Memory = 86188 MB
Rank =   52  Free Memory = 86188 MB
Rank =   53  Free Memory = 86188 MB
Rank =   54  Free Memory = 86188 MB
Rank =   55  Free Memory = 86188 MB
Rank =   56  Free Memory = 86188 MB
Rank =   57  Free Memory = 86188 MB
Rank =   58  Free Memory = 86188 MB
Rank =   59  Free Memory = 86188 MB
Rank =   60  Free Memory = 86188 MB
Rank =   61  Free Memory = 86188 MB
Rank =   62  Free Memory = 86188 MB
Rank =   63  Free Memory = 86188 MB
Rank =   64  Free Memory = 86188 MB
Rank =   65  Free Memory = 86188 MB
Rank =   66  Free Memory = 86188 MB
Rank =   67  Free Memory = 86188 MB
Rank =   68  Free Memory = 86188 MB
Rank =   69  Free Memory = 86188 MB
Rank =   70  Free Memory = 86188 MB
Rank =   71  Free Memory = 86188 MB
Rank =   72  Free Memory = 86188 MB
Rank =   73  Free Memory = 86188 MB
Rank =   74  Free Memory = 86188 MB
Rank =   75  Free Memory = 86188 MB
Rank =   76  Free Memory = 86188 MB
Rank =   77  Free Memory = 86188 MB
Rank =   78  Free Memory = 86188 MB
Rank =   79  Free Memory = 86188 MB
Rank =   80  Free Memory = 86191 MB
Rank =   81  Free Memory = 86191 MB
Rank =   82  Free Memory = 86191 MB
Rank =   83  Free Memory = 86191 MB
Rank =   84  Free Memory = 86191 MB
Rank =   85  Free Memory = 86191 MB
Rank =   86  Free Memory = 86191 MB
Rank =   87  Free Memory = 86191 MB
Rank =   88  Free Memory = 86191 MB
Rank =   89  Free Memory = 86191 MB
Rank =   90  Free Memory = 86191 MB
Rank =   91  Free Memory = 86191 MB
Rank =   92  Free Memory = 86191 MB
Rank =   93  Free Memory = 86191 MB
Rank =   94  Free Memory = 86191 MB
Rank =   95  Free Memory = 86191 MB
Rank =   96  Free Memory = 86191 MB
Rank =   97  Free Memory = 86191 MB
Rank =   98  Free Memory = 86191 MB
Rank =   99  Free Memory = 86191 MB
Rank =  100  Free Memory = 86191 MB
Rank =  101  Free Memory = 86191 MB
Rank =  102  Free Memory = 86191 MB
Rank =  103  Free Memory = 86191 MB
Rank =  104  Free Memory = 86191 MB
Rank =  105  Free Memory = 86191 MB
Rank =  106  Free Memory = 86191 MB
Rank =  107  Free Memory = 86191 MB
Rank =  108  Free Memory = 86191 MB
Rank =  109  Free Memory = 86191 MB
Rank =  110  Free Memory = 86191 MB
Rank =  111  Free Memory = 86191 MB
Rank =  112  Free Memory = 86191 MB
Rank =  113  Free Memory = 86191 MB
Rank =  114  Free Memory = 86191 MB
Rank =  115  Free Memory = 86191 MB
Rank =  116  Free Memory = 86191 MB
Rank =  117  Free Memory = 86191 MB
Rank =  118  Free Memory = 86191 MB
Rank =  119  Free Memory = 86191 MB
Rank =  120  Free Memory = 87565 MB
  Input file(s): opt_h2o_1b1_gvptt_run002l.xml 
Rank =  121  Free Memory = 87565 MB
Rank =  122  Free Memory = 87565 MB
Rank =  127  Free Memory = 87565 MB
Rank =  123  Free Memory = 87565 MB
Rank =  124  Free Memory = 87565 MB
Rank =  125  Free Memory = 87565 MB
Rank =  126  Free Memory = 87565 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002l.xml

  Project = H2O
  date    = 2023-04-09 18:38:35 PDT
  host    = n0265.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 155

  Range of prime numbers to use as seeds over processors and threads = 919-1867


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.088287e-01    1         1  ON     0
     uu_1                 1.421394e-01    1         1  ON     1
     uu_2                 4.085865e-02    1         1  ON     2
     uu_3                -2.127760e-02    1         1  ON     3
     uu_4                -6.583160e-02    1         1  ON     4
     uu_5                -9.968775e-02    1         1  ON     5
     uu_6                -1.260869e-01    1         1  ON     6
     uu_7                -1.389497e-01    1         1  ON     7
     uu_8                -1.311958e-01    1         1  ON     8
     uu_9                -1.014965e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.492740e-01    1         1  ON     0
     ud_1                 1.828397e-01    1         1  ON     1
     ud_2                 6.191140e-02    1         1  ON     2
     ud_3                -9.882894e-03    1         1  ON     3
     ud_4                -6.715984e-02    1         1  ON     4
     ud_5                -1.084819e-01    1         1  ON     5
     ud_6                -1.353600e-01    1         1  ON     6
     ud_7                -1.512096e-01    1         1  ON     7
     ud_8                -1.512118e-01    1         1  ON     8
     ud_9                -1.397322e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.653960e-01    1         1  ON     0
     eO_1                -4.432091e-01    1         1  ON     1
     eO_2                -2.003563e-02    1         1  ON     2
     eO_3                 3.023636e-01    1         1  ON     3
     eO_4                 5.268878e-01    1         1  ON     4
     eO_5                 4.858510e-01    1         1  ON     5
     eO_6                 2.552489e-01    1         1  ON     6
     eO_7                -4.703172e-02    1         1  ON     7
     eO_8                -2.180656e-01    1         1  ON     8
     eO_9                -7.687124e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.423444e-01    1         1  ON     0
     eH1_1                -1.422499e-01    1         1  ON     1
     eH1_2                -9.543944e-02    1         1  ON     2
     eH1_3                -4.174668e-02    1         1  ON     3
     eH1_4                 6.509188e-03    1         1  ON     4
     eH1_5                 4.070110e-02    1         1  ON     5
     eH1_6                 9.819769e-02    1         1  ON     6
     eH1_7                 1.506488e-01    1         1  ON     7
     eH1_8                 1.724042e-01    1         1  ON     8
     eH1_9                 5.742368e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.371710e-01    1         1  ON     0
     eH2_1                -1.378225e-01    1         1  ON     1
     eH2_2                -9.170119e-02    1         1  ON     2
     eH2_3                -3.778373e-02    1         1  ON     3
     eH2_4                 9.913179e-03    1         1  ON     4
     eH2_5                 4.331544e-02    1         1  ON     5
     eH2_6                 9.907932e-02    1         1  ON     6
     eH2_7                 1.498290e-01    1         1  ON     7
     eH2_8                 1.755320e-01    1         1  ON     8
     eH2_9                 4.436520e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.725161e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
[n0265.savio3:56982] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0265.savio3:56982] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7725e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 11.9701
====================================================
  Execution time = 2.0994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342486963292
                                         uncertainty =       0.004603795656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342486963292
                                         uncertainty =       0.004603795656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414259149
  error estimate for blocks of size 2^( 2) =       0.000426699296
  error estimate for blocks of size 2^( 3) =       0.000440090435
  error estimate for blocks of size 2^( 4) =       0.000453886825
  error estimate for blocks of size 2^( 5) =       0.000465642084
  error estimate for blocks of size 2^( 6) =       0.000475786510
  error estimate for blocks of size 2^( 7) =       0.000483806754

      target function =                  N/A
              le_mean =     -16.905739843303
             les_mean =     286.147260762994
             stat err =       0.000469780544
             autocorr =       1.286014409016
              std dev =       0.585850906944
             le_variance =       0.343221285167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690573984330e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905739843303       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737745371       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738106848       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905739061247       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905739893431       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905740342531       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905740103590       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905740199470       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905740153316       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905740336900       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.658565e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905739843303       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905739043435       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738997091       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905739205401       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905739628547       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905739572624       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905739608239       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905739546515       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.375626e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905739843303       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905739613121       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905739576257       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905739619546       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905739746351       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905739700256       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905739713777       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905739701581       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.001769e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6733e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.088465e-01                 1 1 ON  0
uu_1  1.422605e-01                 1 1 ON  1
uu_2  4.093725e-02                 1 1 ON  2
uu_3  -2.120511e-02                1 1 ON  3
uu_4  -6.582121e-02                1 1 ON  4
uu_5  -9.977605e-02                1 1 ON  5
uu_6  -1.262423e-01                1 1 ON  6
uu_7  -1.390284e-01                1 1 ON  7
uu_8  -1.313006e-01                1 1 ON  8
uu_9  -1.015203e-01                1 1 ON  9
ud_0  4.492102e-01                 1 1 ON  10
ud_1  1.829103e-01                 1 1 ON  11
ud_2  6.185348e-02                 1 1 ON  12
ud_3  -9.913976e-03                1 1 ON  13
ud_4  -6.714976e-02                1 1 ON  14
ud_5  -1.084229e-01                1 1 ON  15
ud_6  -1.352794e-01                1 1 ON  16
ud_7  -1.511338e-01                1 1 ON  17
ud_8  -1.512341e-01                1 1 ON  18
ud_9  -1.397796e-01                1 1 ON  19
eO_0  -7.654366e-01                1 1 ON  20
eO_1  -4.432316e-01                1 1 ON  21
eO_2  -2.006332e-02                1 1 ON  22
eO_3  3.023554e-01                 1 1 ON  23
eO_4  5.269502e-01                 1 1 ON  24
eO_5  4.860003e-01                 1 1 ON  25
eO_6  2.553656e-01                 1 1 ON  26
eO_7  -4.696043e-02                1 1 ON  27
eO_8  -2.182012e-01                1 1 ON  28
eO_9  -7.701021e-02                1 1 ON  29
eH1_0 -2.424792e-01                1 1 ON  30
eH1_1 -1.422138e-01                1 1 ON  31
eH1_2 -9.557020e-02                1 1 ON  32
eH1_3 -4.179684e-02                1 1 ON  33
eH1_4 6.431023e-03                 1 1 ON  34
eH1_5 4.075642e-02                 1 1 ON  35
eH1_6 9.820669e-02                 1 1 ON  36
eH1_7 1.506472e-01                 1 1 ON  37
eH1_8 1.725142e-01                 1 1 ON  38
eH1_9 5.759615e-02                 1 1 ON  39
eH2_0 -2.373547e-01                1 1 ON  40
eH2_1 -1.379429e-01                1 1 ON  41
eH2_2 -9.175677e-02                1 1 ON  42
eH2_3 -3.778936e-02                1 1 ON  43
eH2_4 9.902987e-03                 1 1 ON  44
eH2_5 4.322388e-02                 1 1 ON  45
eH2_6 9.904562e-02                 1 1 ON  46
eH2_7 1.499302e-01                 1 1 ON  47
eH2_8 1.756657e-01                 1 1 ON  48
eH2_9 4.460276e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9927
    reference variance = 0.246551
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3315e-01
  Total weights = 2.0000e+06
  Execution time = 1.9175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333289116111
                                         uncertainty =       0.004087781069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333289116111
                                         uncertainty =       0.004087781069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408160332
  error estimate for blocks of size 2^( 2) =       0.000420631539
  error estimate for blocks of size 2^( 3) =       0.000434043771
  error estimate for blocks of size 2^( 4) =       0.000446829188
  error estimate for blocks of size 2^( 5) =       0.000457769440
  error estimate for blocks of size 2^( 6) =       0.000465219529
  error estimate for blocks of size 2^( 7) =       0.000470656956

      target function =                  N/A
              le_mean =     -16.906420118358
             les_mean =     286.160230765303
             stat err =       0.000460118778
             autocorr =       1.270803277348
              std dev =       0.577225877340
             le_variance =       0.333189713471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333269314287
                                         uncertainty =       0.004087903194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333269314287
                                         uncertainty =       0.004087903194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148201
  error estimate for blocks of size 2^( 2) =       0.000420616146
  error estimate for blocks of size 2^( 3) =       0.000434021985
  error estimate for blocks of size 2^( 4) =       0.000446802728
  error estimate for blocks of size 2^( 5) =       0.000457739980
  error estimate for blocks of size 2^( 6) =       0.000465193213
  error estimate for blocks of size 2^( 7) =       0.000470639297

      target function =                  N/A
              le_mean =     -16.906420872835
             les_mean =     286.160236471603
             stat err =       0.000460093805
             autocorr =       1.270740864730
              std dev =       0.577208722008
             le_variance =       0.333169908762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333210846058
                                         uncertainty =       0.004087609291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333210846058
                                         uncertainty =       0.004087609291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408112405
  error estimate for blocks of size 2^( 2) =       0.000420582851
  error estimate for blocks of size 2^( 3) =       0.000433991649
  error estimate for blocks of size 2^( 4) =       0.000446774821
  error estimate for blocks of size 2^( 5) =       0.000457714193
  error estimate for blocks of size 2^( 6) =       0.000465168211
  error estimate for blocks of size 2^( 7) =       0.000470612784

      target function =                  N/A
              le_mean =     -16.906420567933
             les_mean =     286.160167722946
             stat err =       0.000460067502
             autocorr =       1.270818486361
              std dev =       0.577158097645
             le_variance =       0.333111469677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333273914232
                                         uncertainty =       0.004087742852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333273914232
                                         uncertainty =       0.004087742852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408151023
  error estimate for blocks of size 2^( 2) =       0.000420622173
  error estimate for blocks of size 2^( 3) =       0.000434033915
  error estimate for blocks of size 2^( 4) =       0.000446819033
  error estimate for blocks of size 2^( 5) =       0.000457759209
  error estimate for blocks of size 2^( 6) =       0.000465209910
  error estimate for blocks of size 2^( 7) =       0.000470648356

      target function =                  N/A
              le_mean =     -16.906420129668
             les_mean =     286.160215950225
             stat err =       0.000460109127
             autocorr =       1.270807929889
              std dev =       0.577212712925
             le_variance =       0.333174515962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906420118358        initial
     2.5000e-01     2.5000e+00             9.6586e-04       -16.906420872835  <--
     1.0000e+00     1.0000e+01             2.3756e-04       -16.906420567933
     4.0000e+00     4.0000e+01             6.0018e-05       -16.906420129668

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0061e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.090090e-01 1 1  ON 0
 uu_1                 1.424969e-01 1 1  ON 1
 uu_2                 4.111861e-02 1 1  ON 2
 uu_3                -2.105923e-02 1 1  ON 3
 uu_4                -6.580008e-02 1 1  ON 4
 uu_5                -9.996602e-02 1 1  ON 5
 uu_6                -1.265943e-01 1 1  ON 6
 uu_7                -1.392920e-01 1 1  ON 7
 uu_8                -1.316236e-01 1 1  ON 8
 uu_9                -1.015975e-01 1 1  ON 9
 ud_0                 4.491951e-01 1 1  ON 10
 ud_1                 1.829728e-01 1 1  ON 11
 ud_2                 6.180160e-02 1 1  ON 12
 ud_3                -9.963213e-03 1 1  ON 13
 ud_4                -6.713872e-02 1 1  ON 14
 ud_5                -1.083080e-01 1 1  ON 15
 ud_6                -1.351433e-01 1 1  ON 16
 ud_7                -1.509515e-01 1 1  ON 17
 ud_8                -1.512668e-01 1 1  ON 18
 ud_9                -1.399111e-01 1 1  ON 19
 eO_0                -7.655246e-01 1 1  ON 20
 eO_1                -4.433034e-01 1 1  ON 21
 eO_2                -2.012729e-02 1 1  ON 22
 eO_3                 3.022964e-01 1 1  ON 23
 eO_4                 5.271302e-01 1 1  ON 24
 eO_5                 4.864442e-01 1 1  ON 25
 eO_6                 2.557226e-01 1 1  ON 26
 eO_7                -4.674314e-02 1 1  ON 27
 eO_8                -2.186108e-01 1 1  ON 28
 eO_9                -7.743529e-02 1 1  ON 29
eH1_0                -2.428282e-01 1 1  ON 30
eH1_1                -1.422817e-01 1 1  ON 31
eH1_2                -9.588833e-02 1 1  ON 32
eH1_3                -4.192927e-02 1 1  ON 33
eH1_4                 6.249888e-03 1 1  ON 34
eH1_5                 4.085795e-02 1 1  ON 35
eH1_6                 9.823329e-02 1 1  ON 36
eH1_7                 1.506592e-01 1 1  ON 37
eH1_8                 1.728544e-01 1 1  ON 38
eH1_9                 5.812480e-02 1 1  ON 39
eH2_0                -2.378490e-01 1 1  ON 40
eH2_1                -1.382188e-01 1 1  ON 41
eH2_2                -9.195696e-02 1 1  ON 42
eH2_3                -3.786650e-02 1 1  ON 43
eH2_4                 9.804247e-03 1 1  ON 44
eH2_5                 4.298014e-02 1 1  ON 45
eH2_6                 9.893268e-02 1 1  ON 46
eH2_7                 1.502153e-01 1 1  ON 47
eH2_8                 1.760678e-01 1 1  ON 48
eH2_9                 4.533105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7119e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9463
    reference variance = 0.295442
====================================================
  Execution time = 2.1009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336554145710
                                         uncertainty =       0.003509335376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336554145710
                                         uncertainty =       0.003509335376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410173220
  error estimate for blocks of size 2^( 2) =       0.000423199985
  error estimate for blocks of size 2^( 3) =       0.000436696416
  error estimate for blocks of size 2^( 4) =       0.000448715582
  error estimate for blocks of size 2^( 5) =       0.000458914351
  error estimate for blocks of size 2^( 6) =       0.000464653223
  error estimate for blocks of size 2^( 7) =       0.000468439172

      target function =                  N/A
              le_mean =     -16.905790718042
             les_mean =     286.142243774210
             stat err =       0.000460180582
             autocorr =       1.258699252300
              std dev =       0.580072530120
             le_variance =       0.336484140200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579071804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790718042       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789217051       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905792694200       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905791816666       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905793820049       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905795514793       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905795536733       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905793873126       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905794941787       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905794930419       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905795682112       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905795976341       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905795915517       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.121924e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790718042       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789891952       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905791176914       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790522821       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905791702639       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905792040577       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905791327595       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905791577984       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905791684075       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905791764677       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.203977e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905790718042       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905790422857       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905790708031       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790453178       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790906415       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905790866342       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905790676439       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905790735487       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905790804537       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.402481e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6572e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.093142e-01 1 1  ON 0
 uu_1                 1.426410e-01 1 1  ON 1
 uu_2                 4.130815e-02 1 1  ON 2
 uu_3                -2.086722e-02 1 1  ON 3
 uu_4                -6.566534e-02 1 1  ON 4
 uu_5                -9.992136e-02 1 1  ON 5
 uu_6                -1.267368e-01 1 1  ON 6
 uu_7                -1.394323e-01 1 1  ON 7
 uu_8                -1.318417e-01 1 1  ON 8
 uu_9                -1.022102e-01 1 1  ON 9
 ud_0                 4.494831e-01 1 1  ON 10
 ud_1                 1.834266e-01 1 1  ON 11
 ud_2                 6.210567e-02 1 1  ON 12
 ud_3                -9.539403e-03 1 1  ON 13
 ud_4                -6.684856e-02 1 1  ON 14
 ud_5                -1.080303e-01 1 1  ON 15
 ud_6                -1.349787e-01 1 1  ON 16
 ud_7                -1.507990e-01 1 1  ON 17
 ud_8                -1.517456e-01 1 1  ON 18
 ud_9                -1.408315e-01 1 1  ON 19
 eO_0                -7.655738e-01 1 1  ON 20
 eO_1                -4.431874e-01 1 1  ON 21
 eO_2                -2.024039e-02 1 1  ON 22
 eO_3                 3.023137e-01 1 1  ON 23
 eO_4                 5.271959e-01 1 1  ON 24
 eO_5                 4.871633e-01 1 1  ON 25
 eO_6                 2.562812e-01 1 1  ON 26
 eO_7                -4.656831e-02 1 1  ON 27
 eO_8                -2.192280e-01 1 1  ON 28
 eO_9                -7.814771e-02 1 1  ON 29
eH1_0                -2.428802e-01 1 1  ON 30
eH1_1                -1.425749e-01 1 1  ON 31
eH1_2                -9.607881e-02 1 1  ON 32
eH1_3                -4.191917e-02 1 1  ON 33
eH1_4                 5.961438e-03 1 1  ON 34
eH1_5                 4.075503e-02 1 1  ON 35
eH1_6                 9.816704e-02 1 1  ON 36
eH1_7                 1.508145e-01 1 1  ON 37
eH1_8                 1.732757e-01 1 1  ON 38
eH1_9                 5.857941e-02 1 1  ON 39
eH2_0                -2.383306e-01 1 1  ON 40
eH2_1                -1.384483e-01 1 1  ON 41
eH2_2                -9.201494e-02 1 1  ON 42
eH2_3                -3.809489e-02 1 1  ON 43
eH2_4                 9.575178e-03 1 1  ON 44
eH2_5                 4.293992e-02 1 1  ON 45
eH2_6                 9.910207e-02 1 1  ON 46
eH2_7                 1.504138e-01 1 1  ON 47
eH2_8                 1.765217e-01 1 1  ON 48
eH2_9                 4.589606e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.215016
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4094e-01
  Total weights = 2.0000e+06
  Execution time = 1.9264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340946232930
                                         uncertainty =       0.004899570859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340946232930
                                         uncertainty =       0.004899570859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412913493
  error estimate for blocks of size 2^( 2) =       0.000425343764
  error estimate for blocks of size 2^( 3) =       0.000438233739
  error estimate for blocks of size 2^( 4) =       0.000450215306
  error estimate for blocks of size 2^( 5) =       0.000460653941
  error estimate for blocks of size 2^( 6) =       0.000468339675
  error estimate for blocks of size 2^( 7) =       0.000474211346

      target function =                  N/A
              le_mean =     -16.905888506956
             les_mean =     286.150061145131
             stat err =       0.000463355067
             autocorr =       1.259243398775
              std dev =       0.583947862411
             le_variance =       0.340995106015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340935666774
                                         uncertainty =       0.004899286646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340935666774
                                         uncertainty =       0.004899286646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412907032
  error estimate for blocks of size 2^( 2) =       0.000425323803
  error estimate for blocks of size 2^( 3) =       0.000438197736
  error estimate for blocks of size 2^( 4) =       0.000450162814
  error estimate for blocks of size 2^( 5) =       0.000460593140
  error estimate for blocks of size 2^( 6) =       0.000468273535
  error estimate for blocks of size 2^( 7) =       0.000474147820

      target function =                  N/A
              le_mean =     -16.905886841144
             les_mean =     286.149994150031
             stat err =       0.000463294327
             autocorr =       1.258952678153
              std dev =       0.583938725331
             le_variance =       0.340984434941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340845967033
                                         uncertainty =       0.004897339660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340845967033
                                         uncertainty =       0.004897339660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412852698
  error estimate for blocks of size 2^( 2) =       0.000425273716
  error estimate for blocks of size 2^( 3) =       0.000438155764
  error estimate for blocks of size 2^( 4) =       0.000450131831
  error estimate for blocks of size 2^( 5) =       0.000460564664
  error estimate for blocks of size 2^( 6) =       0.000468247467
  error estimate for blocks of size 2^( 7) =       0.000474125572

      target function =                  N/A
              le_mean =     -16.905887697767
             les_mean =     286.149933379474
             stat err =       0.000463267383
             autocorr =       1.259137606400
              std dev =       0.583861884698
             le_variance =       0.340894700403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340914412529
                                         uncertainty =       0.004899060746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340914412529
                                         uncertainty =       0.004899060746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412894206
  error estimate for blocks of size 2^( 2) =       0.000425323141
  error estimate for blocks of size 2^( 3) =       0.000438212401
  error estimate for blocks of size 2^( 4) =       0.000450193758
  error estimate for blocks of size 2^( 5) =       0.000460631213
  error estimate for blocks of size 2^( 6) =       0.000468316369
  error estimate for blocks of size 2^( 7) =       0.000474189445

      target function =                  N/A
              le_mean =     -16.905888056340
             les_mean =     286.150014053011
             stat err =       0.000463332696
             autocorr =       1.259239449343
              std dev =       0.583920585362
             le_variance =       0.340963250009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905888506956        initial  <--
     6.2500e-02     6.2500e-01             3.1219e-03       -16.905886841144
     2.5000e-01     2.5000e+00             9.2040e-04       -16.905887697767
     1.0000e+00     1.0000e+01             2.4025e-04       -16.905888056340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1819
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.090090e-01 1 1  ON 0
 uu_1                 1.424969e-01 1 1  ON 1
 uu_2                 4.111861e-02 1 1  ON 2
 uu_3                -2.105923e-02 1 1  ON 3
 uu_4                -6.580008e-02 1 1  ON 4
 uu_5                -9.996602e-02 1 1  ON 5
 uu_6                -1.265943e-01 1 1  ON 6
 uu_7                -1.392920e-01 1 1  ON 7
 uu_8                -1.316236e-01 1 1  ON 8
 uu_9                -1.015975e-01 1 1  ON 9
 ud_0                 4.491951e-01 1 1  ON 10
 ud_1                 1.829728e-01 1 1  ON 11
 ud_2                 6.180160e-02 1 1  ON 12
 ud_3                -9.963213e-03 1 1  ON 13
 ud_4                -6.713872e-02 1 1  ON 14
 ud_5                -1.083080e-01 1 1  ON 15
 ud_6                -1.351433e-01 1 1  ON 16
 ud_7                -1.509515e-01 1 1  ON 17
 ud_8                -1.512668e-01 1 1  ON 18
 ud_9                -1.399111e-01 1 1  ON 19
 eO_0                -7.655246e-01 1 1  ON 20
 eO_1                -4.433034e-01 1 1  ON 21
 eO_2                -2.012729e-02 1 1  ON 22
 eO_3                 3.022964e-01 1 1  ON 23
 eO_4                 5.271302e-01 1 1  ON 24
 eO_5                 4.864442e-01 1 1  ON 25
 eO_6                 2.557226e-01 1 1  ON 26
 eO_7                -4.674314e-02 1 1  ON 27
 eO_8                -2.186108e-01 1 1  ON 28
 eO_9                -7.743529e-02 1 1  ON 29
eH1_0                -2.428282e-01 1 1  ON 30
eH1_1                -1.422817e-01 1 1  ON 31
eH1_2                -9.588833e-02 1 1  ON 32
eH1_3                -4.192927e-02 1 1  ON 33
eH1_4                 6.249888e-03 1 1  ON 34
eH1_5                 4.085795e-02 1 1  ON 35
eH1_6                 9.823329e-02 1 1  ON 36
eH1_7                 1.506592e-01 1 1  ON 37
eH1_8                 1.728544e-01 1 1  ON 38
eH1_9                 5.812480e-02 1 1  ON 39
eH2_0                -2.378490e-01 1 1  ON 40
eH2_1                -1.382188e-01 1 1  ON 41
eH2_2                -9.195696e-02 1 1  ON 42
eH2_3                -3.786650e-02 1 1  ON 43
eH2_4                 9.804247e-03 1 1  ON 44
eH2_5                 4.298014e-02 1 1  ON 45
eH2_6                 9.893268e-02 1 1  ON 46
eH2_7                 1.502153e-01 1 1  ON 47
eH2_8                 1.760678e-01 1 1  ON 48
eH2_9                 4.533105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7017e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.315792
====================================================
  Execution time = 2.0648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345801671428
                                         uncertainty =       0.007831410798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345801671428
                                         uncertainty =       0.007831410798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415855736
  error estimate for blocks of size 2^( 2) =       0.000428986712
  error estimate for blocks of size 2^( 3) =       0.000441852710
  error estimate for blocks of size 2^( 4) =       0.000454329846
  error estimate for blocks of size 2^( 5) =       0.000465310862
  error estimate for blocks of size 2^( 6) =       0.000474491112
  error estimate for blocks of size 2^( 7) =       0.000478095319

      target function =                  N/A
              le_mean =     -16.906005690822
             les_mean =     286.158900230819
             stat err =       0.000468056785
             autocorr =       1.266810627383
              std dev =       0.588108821265
             le_variance =       0.345871985649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600569082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005690822       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006109385       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906007459391       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906007488997       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906007725429       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906008106517       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906007897379       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906007831588       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.019037e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005690822       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005819228       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006259551       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006297548       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906006319858       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006415982       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906006374693       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906006367119       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.012820e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005690822       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005724856       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005844117       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005857209       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005859844       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005884497       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005874313       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005872780       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.536875e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6261e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.090259e-01 1 1  ON 0
 uu_1                 1.424907e-01 1 1  ON 1
 uu_2                 4.112484e-02 1 1  ON 2
 uu_3                -2.107934e-02 1 1  ON 3
 uu_4                -6.579968e-02 1 1  ON 4
 uu_5                -1.000067e-01 1 1  ON 5
 uu_6                -1.266140e-01 1 1  ON 6
 uu_7                -1.392793e-01 1 1  ON 7
 uu_8                -1.316420e-01 1 1  ON 8
 uu_9                -1.016202e-01 1 1  ON 9
 ud_0                 4.492396e-01 1 1  ON 10
 ud_1                 1.829806e-01 1 1  ON 11
 ud_2                 6.177571e-02 1 1  ON 12
 ud_3                -9.988893e-03 1 1  ON 13
 ud_4                -6.711938e-02 1 1  ON 14
 ud_5                -1.083228e-01 1 1  ON 15
 ud_6                -1.351464e-01 1 1  ON 16
 ud_7                -1.509583e-01 1 1  ON 17
 ud_8                -1.512510e-01 1 1  ON 18
 ud_9                -1.399135e-01 1 1  ON 19
 eO_0                -7.655456e-01 1 1  ON 20
 eO_1                -4.433095e-01 1 1  ON 21
 eO_2                -2.009815e-02 1 1  ON 22
 eO_3                 3.022970e-01 1 1  ON 23
 eO_4                 5.271489e-01 1 1  ON 24
 eO_5                 4.864382e-01 1 1  ON 25
 eO_6                 2.557700e-01 1 1  ON 26
 eO_7                -4.670388e-02 1 1  ON 27
 eO_8                -2.186527e-01 1 1  ON 28
 eO_9                -7.748833e-02 1 1  ON 29
eH1_0                -2.428681e-01 1 1  ON 30
eH1_1                -1.423098e-01 1 1  ON 31
eH1_2                -9.588348e-02 1 1  ON 32
eH1_3                -4.190431e-02 1 1  ON 33
eH1_4                 6.207363e-03 1 1  ON 34
eH1_5                 4.081684e-02 1 1  ON 35
eH1_6                 9.821423e-02 1 1  ON 36
eH1_7                 1.506832e-01 1 1  ON 37
eH1_8                 1.729035e-01 1 1  ON 38
eH1_9                 5.818777e-02 1 1  ON 39
eH2_0                -2.379049e-01 1 1  ON 40
eH2_1                -1.382689e-01 1 1  ON 41
eH2_2                -9.195859e-02 1 1  ON 42
eH2_3                -3.788159e-02 1 1  ON 43
eH2_4                 9.774851e-03 1 1  ON 44
eH2_5                 4.295130e-02 1 1  ON 45
eH2_6                 9.891704e-02 1 1  ON 46
eH2_7                 1.502268e-01 1 1  ON 47
eH2_8                 1.761307e-01 1 1  ON 48
eH2_9                 4.543234e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9069
    reference variance = 0.185323
====================================================
  Execution time = 2.1529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4337e-01
  Total weights = 2.0000e+06
  Execution time = 2.1579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343124402583
                                         uncertainty =       0.004686879160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343124402583
                                         uncertainty =       0.004686879160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414320848
  error estimate for blocks of size 2^( 2) =       0.000427101006
  error estimate for blocks of size 2^( 3) =       0.000439695922
  error estimate for blocks of size 2^( 4) =       0.000450751754
  error estimate for blocks of size 2^( 5) =       0.000459600684
  error estimate for blocks of size 2^( 6) =       0.000465235764
  error estimate for blocks of size 2^( 7) =       0.000467017665

      target function =                  N/A
              le_mean =     -16.906040702513
             les_mean =     286.157535593840
             stat err =       0.000460651467
             autocorr =       1.236150482200
              std dev =       0.585938162671
             le_variance =       0.343323530474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343275679005
                                         uncertainty =       0.004689887065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343275679005
                                         uncertainty =       0.004689887065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414412279
  error estimate for blocks of size 2^( 2) =       0.000427187070
  error estimate for blocks of size 2^( 3) =       0.000439776933
  error estimate for blocks of size 2^( 4) =       0.000450828514
  error estimate for blocks of size 2^( 5) =       0.000459673901
  error estimate for blocks of size 2^( 6) =       0.000465308250
  error estimate for blocks of size 2^( 7) =       0.000467089588

      target function =                  N/A
              le_mean =     -16.906041799132
             les_mean =     286.157724216963
             stat err =       0.000460725063
             autocorr =       1.235999929270
              std dev =       0.586067466005
             le_variance =       0.343475074709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343222674860
                                         uncertainty =       0.004688628678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343222674860
                                         uncertainty =       0.004688628678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414380244
  error estimate for blocks of size 2^( 2) =       0.000427156825
  error estimate for blocks of size 2^( 3) =       0.000439748313
  error estimate for blocks of size 2^( 4) =       0.000450801049
  error estimate for blocks of size 2^( 5) =       0.000459647601
  error estimate for blocks of size 2^( 6) =       0.000465282120
  error estimate for blocks of size 2^( 7) =       0.000467063745

      target function =                  N/A
              le_mean =     -16.906041348809
             les_mean =     286.157655889175
             stat err =       0.000460698629
             autocorr =       1.236049193578
              std dev =       0.586022161055
             le_variance =       0.343421973247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343137490503
                                         uncertainty =       0.004687105413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343137490503
                                         uncertainty =       0.004687105413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414328759
  error estimate for blocks of size 2^( 2) =       0.000427108432
  error estimate for blocks of size 2^( 3) =       0.000439702881
  error estimate for blocks of size 2^( 4) =       0.000450758279
  error estimate for blocks of size 2^( 5) =       0.000459606884
  error estimate for blocks of size 2^( 6) =       0.000465241888
  error estimate for blocks of size 2^( 7) =       0.000467023751

      target function =                  N/A
              le_mean =     -16.906040783258
             les_mean =     286.157551434930
             stat err =       0.000460657701
             autocorr =       1.236136732696
              std dev =       0.585949350566
             le_variance =       0.343336641429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906040702513        initial
     6.2500e-01     6.2500e+00             4.0190e-04       -16.906041799132  <--
     2.5000e+00     2.5000e+01             1.0128e-04       -16.906041348809
     1.0000e+01     1.0000e+02             2.5369e-05       -16.906040783258

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.1276e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6986e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.831
    reference variance = 0.460371
====================================================
  Execution time = 2.0688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3269e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332639593900
                                         uncertainty =       0.002581892142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332639593900
                                         uncertainty =       0.002581892142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407855695
  error estimate for blocks of size 2^( 2) =       0.000420967709
  error estimate for blocks of size 2^( 3) =       0.000434059484
  error estimate for blocks of size 2^( 4) =       0.000445492971
  error estimate for blocks of size 2^( 5) =       0.000455765768
  error estimate for blocks of size 2^( 6) =       0.000463329000
  error estimate for blocks of size 2^( 7) =       0.000463986149

      target function =                  N/A
              le_mean =     -16.905538833504
             les_mean =     286.129935619890
             stat err =       0.000457143472
             autocorr =       1.256296020981
              std dev =       0.576795054700
             le_variance =       0.332692535126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553883350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538833504       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905538016874       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905538007318       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539933726       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905541477796       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905541577305       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905540161887       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905540357154       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905541060839       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905541369245       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905541296863       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905541251052       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.116587e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538833504       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905538463127       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905538361641       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539041660       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905539309105       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905539555012       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905539077422       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905539058855       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905539240199       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.144002e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905538833504       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905538717246       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905538671386       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905538854973       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905538882199       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905538937560       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905538854568       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905538837044       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.681880e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6299e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091738e-01 1 1  ON 0
 uu_1                 1.425566e-01 1 1  ON 1
 uu_2                 4.112909e-02 1 1  ON 2
 uu_3                -2.107061e-02 1 1  ON 3
 uu_4                -6.577803e-02 1 1  ON 4
 uu_5                -9.997000e-02 1 1  ON 5
 uu_6                -1.267185e-01 1 1  ON 6
 uu_7                -1.395681e-01 1 1  ON 7
 uu_8                -1.319093e-01 1 1  ON 8
 uu_9                -1.018007e-01 1 1  ON 9
 ud_0                 4.494324e-01 1 1  ON 10
 ud_1                 1.831137e-01 1 1  ON 11
 ud_2                 6.179012e-02 1 1  ON 12
 ud_3                -1.009033e-02 1 1  ON 13
 ud_4                -6.704879e-02 1 1  ON 14
 ud_5                -1.082967e-01 1 1  ON 15
 ud_6                -1.351513e-01 1 1  ON 16
 ud_7                -1.508685e-01 1 1  ON 17
 ud_8                -1.513645e-01 1 1  ON 18
 ud_9                -1.400974e-01 1 1  ON 19
 eO_0                -7.656962e-01 1 1  ON 20
 eO_1                -4.433617e-01 1 1  ON 21
 eO_2                -2.003635e-02 1 1  ON 22
 eO_3                 3.024307e-01 1 1  ON 23
 eO_4                 5.273528e-01 1 1  ON 24
 eO_5                 4.866231e-01 1 1  ON 25
 eO_6                 2.560051e-01 1 1  ON 26
 eO_7                -4.653706e-02 1 1  ON 27
 eO_8                -2.190367e-01 1 1  ON 28
 eO_9                -7.784539e-02 1 1  ON 29
eH1_0                -2.431324e-01 1 1  ON 30
eH1_1                -1.423671e-01 1 1  ON 31
eH1_2                -9.591350e-02 1 1  ON 32
eH1_3                -4.182135e-02 1 1  ON 33
eH1_4                 6.208596e-03 1 1  ON 34
eH1_5                 4.051479e-02 1 1  ON 35
eH1_6                 9.793315e-02 1 1  ON 36
eH1_7                 1.507429e-01 1 1  ON 37
eH1_8                 1.732333e-01 1 1  ON 38
eH1_9                 5.862098e-02 1 1  ON 39
eH2_0                -2.383426e-01 1 1  ON 40
eH2_1                -1.383891e-01 1 1  ON 41
eH2_2                -9.195811e-02 1 1  ON 42
eH2_3                -3.794482e-02 1 1  ON 43
eH2_4                 9.679307e-03 1 1  ON 44
eH2_5                 4.271503e-02 1 1  ON 45
eH2_6                 9.890850e-02 1 1  ON 46
eH2_7                 1.502309e-01 1 1  ON 47
eH2_8                 1.764359e-01 1 1  ON 48
eH2_9                 4.600539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.299249
====================================================
  Execution time = 2.0264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5652e-01
  Total weights = 2.0000e+06
  Execution time = 1.9096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356506592413
                                         uncertainty =       0.023959924087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356506592413
                                         uncertainty =       0.023959924087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422176036
  error estimate for blocks of size 2^( 2) =       0.000434462862
  error estimate for blocks of size 2^( 3) =       0.000447327159
  error estimate for blocks of size 2^( 4) =       0.000459738792
  error estimate for blocks of size 2^( 5) =       0.000469468506
  error estimate for blocks of size 2^( 6) =       0.000474456355
  error estimate for blocks of size 2^( 7) =       0.000478131289

      target function =                  N/A
              le_mean =     -16.906628466434
             les_mean =     286.190551134200
             stat err =       0.000470448736
             autocorr =       1.241759401171
              std dev =       0.597047075517
             le_variance =       0.356465210383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356658520081
                                         uncertainty =       0.023983761203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356658520081
                                         uncertainty =       0.023983761203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422265920
  error estimate for blocks of size 2^( 2) =       0.000434545900
  error estimate for blocks of size 2^( 3) =       0.000447400822
  error estimate for blocks of size 2^( 4) =       0.000459802411
  error estimate for blocks of size 2^( 5) =       0.000469521694
  error estimate for blocks of size 2^( 6) =       0.000474507914
  error estimate for blocks of size 2^( 7) =       0.000478187455

      target function =                  N/A
              le_mean =     -16.906627367282
             les_mean =     286.190665772847
             stat err =       0.000470504868
             autocorr =       1.241527026939
              std dev =       0.597174191539
             le_variance =       0.356617015040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356609908268
                                         uncertainty =       0.023979167291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356609908268
                                         uncertainty =       0.023979167291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422237148
  error estimate for blocks of size 2^( 2) =       0.000434519563
  error estimate for blocks of size 2^( 3) =       0.000447378444
  error estimate for blocks of size 2^( 4) =       0.000459783877
  error estimate for blocks of size 2^( 5) =       0.000469505650
  error estimate for blocks of size 2^( 6) =       0.000474492285
  error estimate for blocks of size 2^( 7) =       0.000478171125

      target function =                  N/A
              le_mean =     -16.906628007385
             les_mean =     286.190638820712
             stat err =       0.000470488234
             autocorr =       1.241608435754
              std dev =       0.597133501754
             le_variance =       0.356568418918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356518987858
                                         uncertainty =       0.023963898986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356518987858
                                         uncertainty =       0.023963898986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422183363
  error estimate for blocks of size 2^( 2) =       0.000434469639
  error estimate for blocks of size 2^( 3) =       0.000447333375
  error estimate for blocks of size 2^( 4) =       0.000459744215
  error estimate for blocks of size 2^( 5) =       0.000469472761
  error estimate for blocks of size 2^( 6) =       0.000474460385
  error estimate for blocks of size 2^( 7) =       0.000478135918

      target function =                  N/A
              le_mean =     -16.906628405525
             les_mean =     286.190561449015
             stat err =       0.000470453320
             autocorr =       1.241740495106
              std dev =       0.597057438403
             le_variance =       0.356477584752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906628466434        initial  <--
     1.5625e-01     1.5625e+00             1.1166e-03       -16.906627367282
     6.2500e-01     6.2500e+00             3.1440e-04       -16.906628007385
     2.5000e+00     2.5000e+01             8.6819e-05       -16.906628405525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7783
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6954e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9572
    reference variance = 0.321267
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5205e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352102308524
                                         uncertainty =       0.007064121746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352102308524
                                         uncertainty =       0.007064121746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419553978
  error estimate for blocks of size 2^( 2) =       0.000432081347
  error estimate for blocks of size 2^( 3) =       0.000445274881
  error estimate for blocks of size 2^( 4) =       0.000457439953
  error estimate for blocks of size 2^( 5) =       0.000468195503
  error estimate for blocks of size 2^( 6) =       0.000476440526
  error estimate for blocks of size 2^( 7) =       0.000480264036

      target function =                  N/A
              le_mean =     -16.905582168030
             les_mean =     286.150759344590
             stat err =       0.000470585005
             autocorr =       1.258057473446
              std dev =       0.593338925581
             le_variance =       0.352051080610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558216803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582168030       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581912394       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581823664       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905581897785       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905582067698       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905582089297       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905582073677       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905582124975       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.341351e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582168030       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905582097736       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905582071463       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905582082369       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905582120350       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905582132504       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905582128026       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905582140281       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.367138e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582168030       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905582150006       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905582143124       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905582145304       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905582154316       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905582157790       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905582156650       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905582159684       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.427612e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5989e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.090707e-01 1 1  ON 0
 uu_1                 1.424720e-01 1 1  ON 1
 uu_2                 4.111837e-02 1 1  ON 2
 uu_3                -2.111192e-02 1 1  ON 3
 uu_4                -6.581824e-02 1 1  ON 4
 uu_5                -1.000846e-01 1 1  ON 5
 uu_6                -1.266874e-01 1 1  ON 6
 uu_7                -1.392595e-01 1 1  ON 7
 uu_8                -1.316916e-01 1 1  ON 8
 uu_9                -1.016939e-01 1 1  ON 9
 ud_0                 4.493208e-01 1 1  ON 10
 ud_1                 1.830247e-01 1 1  ON 11
 ud_2                 6.173549e-02 1 1  ON 12
 ud_3                -1.004178e-02 1 1  ON 13
 ud_4                -6.708987e-02 1 1  ON 14
 ud_5                -1.083396e-01 1 1  ON 15
 ud_6                -1.351470e-01 1 1  ON 16
 ud_7                -1.509826e-01 1 1  ON 17
 ud_8                -1.512135e-01 1 1  ON 18
 ud_9                -1.399357e-01 1 1  ON 19
 eO_0                -7.656119e-01 1 1  ON 20
 eO_1                -4.433156e-01 1 1  ON 21
 eO_2                -2.003093e-02 1 1  ON 22
 eO_3                 3.023125e-01 1 1  ON 23
 eO_4                 5.272102e-01 1 1  ON 24
 eO_5                 4.864358e-01 1 1  ON 25
 eO_6                 2.559167e-01 1 1  ON 26
 eO_7                -4.657478e-02 1 1  ON 27
 eO_8                -2.187904e-01 1 1  ON 28
 eO_9                -7.766915e-02 1 1  ON 29
eH1_0                -2.430094e-01 1 1  ON 30
eH1_1                -1.424050e-01 1 1  ON 31
eH1_2                -9.587528e-02 1 1  ON 32
eH1_3                -4.186172e-02 1 1  ON 33
eH1_4                 6.096439e-03 1 1  ON 34
eH1_5                 4.068208e-02 1 1  ON 35
eH1_6                 9.815646e-02 1 1  ON 36
eH1_7                 1.507612e-01 1 1  ON 37
eH1_8                 1.730803e-01 1 1  ON 38
eH1_9                 5.840761e-02 1 1  ON 39
eH2_0                -2.381038e-01 1 1  ON 40
eH2_1                -1.384024e-01 1 1  ON 41
eH2_2                -9.198115e-02 1 1  ON 42
eH2_3                -3.793821e-02 1 1  ON 43
eH2_4                 9.683013e-03 1 1  ON 44
eH2_5                 4.286189e-02 1 1  ON 45
eH2_6                 9.886858e-02 1 1  ON 46
eH2_7                 1.502691e-01 1 1  ON 47
eH2_8                 1.763304e-01 1 1  ON 48
eH2_9                 4.576663e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8955
    reference variance = 0.627788
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3761e-01
  Total weights = 2.0000e+06
  Execution time = 1.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337658827822
                                         uncertainty =       0.002673349556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337658827822
                                         uncertainty =       0.002673349556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874164
  error estimate for blocks of size 2^( 2) =       0.000423832021
  error estimate for blocks of size 2^( 3) =       0.000437469892
  error estimate for blocks of size 2^( 4) =       0.000451687150
  error estimate for blocks of size 2^( 5) =       0.000465208028
  error estimate for blocks of size 2^( 6) =       0.000476427577
  error estimate for blocks of size 2^( 7) =       0.000480386028

      target function =                  N/A
              le_mean =     -16.905452772251
             les_mean =     286.131968422859
             stat err =       0.000468427196
             autocorr =       1.299770080702
              std dev =       0.581063814784
             le_variance =       0.337635156851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337586894165
                                         uncertainty =       0.002672869165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337586894165
                                         uncertainty =       0.002672869165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410830428
  error estimate for blocks of size 2^( 2) =       0.000423790347
  error estimate for blocks of size 2^( 3) =       0.000437429680
  error estimate for blocks of size 2^( 4) =       0.000451648635
  error estimate for blocks of size 2^( 5) =       0.000465171037
  error estimate for blocks of size 2^( 6) =       0.000476391517
  error estimate for blocks of size 2^( 7) =       0.000480348637

      target function =                  N/A
              le_mean =     -16.905452754987
             les_mean =     286.131895963999
             stat err =       0.000468389956
             autocorr =       1.299840137346
              std dev =       0.581001963590
             le_variance =       0.337563281696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613596612
                                         uncertainty =       0.002673056780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613596612
                                         uncertainty =       0.002673056780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410846663
  error estimate for blocks of size 2^( 2) =       0.000423805828
  error estimate for blocks of size 2^( 3) =       0.000437444612
  error estimate for blocks of size 2^( 4) =       0.000451662961
  error estimate for blocks of size 2^( 5) =       0.000465184824
  error estimate for blocks of size 2^( 6) =       0.000476404932
  error estimate for blocks of size 2^( 7) =       0.000480362671

      target function =                  N/A
              le_mean =     -16.905452754228
             les_mean =     286.131922617615
             stat err =       0.000468403847
             autocorr =       1.299814505364
              std dev =       0.581024922849
             le_variance =       0.337589960972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337652797856
                                         uncertainty =       0.002673310875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337652797856
                                         uncertainty =       0.002673310875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410870498
  error estimate for blocks of size 2^( 2) =       0.000423828529
  error estimate for blocks of size 2^( 3) =       0.000437466521
  error estimate for blocks of size 2^( 4) =       0.000451683925
  error estimate for blocks of size 2^( 5) =       0.000465204936
  error estimate for blocks of size 2^( 6) =       0.000476424558
  error estimate for blocks of size 2^( 7) =       0.000480382918

      target function =                  N/A
              le_mean =     -16.905452768684
             les_mean =     286.131962276949
             stat err =       0.000468424084
             autocorr =       1.299776009090
              std dev =       0.581058630041
             le_variance =       0.337629131545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905452772251        initial  <--
     1.5625e+00     1.5625e+01             1.3414e-04       -16.905452754987
     6.2500e+00     6.2500e+01             3.3671e-05       -16.905452754228
     2.5000e+01     2.5000e+02             8.4276e-06       -16.905452768684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7041
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6949e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8568
    reference variance = 0.335683
====================================================
  Execution time = 2.0571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350650481464
                                         uncertainty =       0.005772034940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350650481464
                                         uncertainty =       0.005772034940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418650691
  error estimate for blocks of size 2^( 2) =       0.000431333202
  error estimate for blocks of size 2^( 3) =       0.000444662887
  error estimate for blocks of size 2^( 4) =       0.000458140652
  error estimate for blocks of size 2^( 5) =       0.000470723245
  error estimate for blocks of size 2^( 6) =       0.000482054996
  error estimate for blocks of size 2^( 7) =       0.000491349996

      target function =                  N/A
              le_mean =     -16.905196911362
             les_mean =     286.136219239526
             stat err =       0.000475567222
             autocorr =       1.290387663131
              std dev =       0.592061485728
             le_variance =       0.350536802882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519691136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196911362       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196923569       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196933678       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196929400       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196933197       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196916189       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196924300       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196927719       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.355747e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196911362       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196914442       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196917006       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196915919       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196916742       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196912367       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196914329       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196915246       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.391550e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196911362       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196912133       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196912777       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196912504       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196912702       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196911600       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196912086       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196912319       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.480432e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6218e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.090673e-01 1 1  ON 0
 uu_1                 1.424778e-01 1 1  ON 1
 uu_2                 4.112032e-02 1 1  ON 2
 uu_3                -2.111921e-02 1 1  ON 3
 uu_4                -6.581993e-02 1 1  ON 4
 uu_5                -1.000956e-01 1 1  ON 5
 uu_6                -1.266785e-01 1 1  ON 6
 uu_7                -1.392556e-01 1 1  ON 7
 uu_8                -1.316899e-01 1 1  ON 8
 uu_9                -1.016828e-01 1 1  ON 9
 ud_0                 4.493268e-01 1 1  ON 10
 ud_1                 1.829992e-01 1 1  ON 11
 ud_2                 6.172835e-02 1 1  ON 12
 ud_3                -1.004333e-02 1 1  ON 13
 ud_4                -6.709493e-02 1 1  ON 14
 ud_5                -1.083410e-01 1 1  ON 15
 ud_6                -1.351580e-01 1 1  ON 16
 ud_7                -1.509826e-01 1 1  ON 17
 ud_8                -1.512007e-01 1 1  ON 18
 ud_9                -1.399157e-01 1 1  ON 19
 eO_0                -7.656093e-01 1 1  ON 20
 eO_1                -4.433196e-01 1 1  ON 21
 eO_2                -2.003103e-02 1 1  ON 22
 eO_3                 3.023019e-01 1 1  ON 23
 eO_4                 5.272073e-01 1 1  ON 24
 eO_5                 4.864269e-01 1 1  ON 25
 eO_6                 2.559083e-01 1 1  ON 26
 eO_7                -4.658594e-02 1 1  ON 27
 eO_8                -2.187751e-01 1 1  ON 28
 eO_9                -7.764616e-02 1 1  ON 29
eH1_0                -2.429902e-01 1 1  ON 30
eH1_1                -1.423771e-01 1 1  ON 31
eH1_2                -9.587722e-02 1 1  ON 32
eH1_3                -4.185399e-02 1 1  ON 33
eH1_4                 6.101781e-03 1 1  ON 34
eH1_5                 4.068986e-02 1 1  ON 35
eH1_6                 9.815349e-02 1 1  ON 36
eH1_7                 1.507543e-01 1 1  ON 37
eH1_8                 1.730530e-01 1 1  ON 38
eH1_9                 5.837848e-02 1 1  ON 39
eH2_0                -2.380759e-01 1 1  ON 40
eH2_1                -1.383972e-01 1 1  ON 41
eH2_2                -9.198453e-02 1 1  ON 42
eH2_3                -3.793464e-02 1 1  ON 43
eH2_4                 9.689349e-03 1 1  ON 44
eH2_5                 4.286662e-02 1 1  ON 45
eH2_6                 9.887338e-02 1 1  ON 46
eH2_7                 1.502632e-01 1 1  ON 47
eH2_8                 1.763198e-01 1 1  ON 48
eH2_9                 4.573614e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.270738
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.0000e+06
  Execution time = 1.9108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337533847499
                                         uncertainty =       0.003590759186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337533847499
                                         uncertainty =       0.003590759186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410780295
  error estimate for blocks of size 2^( 2) =       0.000423820012
  error estimate for blocks of size 2^( 3) =       0.000436511076
  error estimate for blocks of size 2^( 4) =       0.000448902477
  error estimate for blocks of size 2^( 5) =       0.000459961870
  error estimate for blocks of size 2^( 6) =       0.000466927248
  error estimate for blocks of size 2^( 7) =       0.000471298182

      target function =                  N/A
              le_mean =     -16.905203467698
             les_mean =     286.123385017112
             stat err =       0.000461772445
             autocorr =       1.263679156413
              std dev =       0.580931064411
             le_variance =       0.337480901598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524351038
                                         uncertainty =       0.003590750730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524351038
                                         uncertainty =       0.003590750730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410774515
  error estimate for blocks of size 2^( 2) =       0.000423814589
  error estimate for blocks of size 2^( 3) =       0.000436505987
  error estimate for blocks of size 2^( 4) =       0.000448897543
  error estimate for blocks of size 2^( 5) =       0.000459957144
  error estimate for blocks of size 2^( 6) =       0.000466922607
  error estimate for blocks of size 2^( 7) =       0.000471293567

      target function =                  N/A
              le_mean =     -16.905203372673
             les_mean =     286.123372307803
             stat err =       0.000461767715
             autocorr =       1.263688831521
              std dev =       0.580922890853
             le_variance =       0.337471405117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337528976873
                                         uncertainty =       0.003590754939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337528976873
                                         uncertainty =       0.003590754939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777331
  error estimate for blocks of size 2^( 2) =       0.000423817231
  error estimate for blocks of size 2^( 3) =       0.000436508466
  error estimate for blocks of size 2^( 4) =       0.000448899947
  error estimate for blocks of size 2^( 5) =       0.000459959447
  error estimate for blocks of size 2^( 6) =       0.000466924871
  error estimate for blocks of size 2^( 7) =       0.000471295820

      target function =                  N/A
              le_mean =     -16.905203418774
             les_mean =     286.123378492355
             stat err =       0.000461770021
             autocorr =       1.263684131941
              std dev =       0.580926872318
             le_variance =       0.337476030981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337533234619
                                         uncertainty =       0.003590758655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337533234619
                                         uncertainty =       0.003590758655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410779922
  error estimate for blocks of size 2^( 2) =       0.000423819662
  error estimate for blocks of size 2^( 3) =       0.000436510747
  error estimate for blocks of size 2^( 4) =       0.000448902159
  error estimate for blocks of size 2^( 5) =       0.000459961565
  error estimate for blocks of size 2^( 6) =       0.000466926949
  error estimate for blocks of size 2^( 7) =       0.000471297885

      target function =                  N/A
              le_mean =     -16.905203461521
             les_mean =     286.123384195393
             stat err =       0.000461772140
             autocorr =       1.263679782812
              std dev =       0.580930536914
             le_variance =       0.337480288719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905203467698        initial  <--
     1.5625e+01     1.5625e+02             1.3557e-05       -16.905203372673
     6.2500e+01     6.2500e+02             3.3916e-06       -16.905203418774
     2.5000e+02     2.5000e+03             8.4804e-07       -16.905203461521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8166
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6939e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.206019
====================================================
  Execution time = 2.0634e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338657180794
                                         uncertainty =       0.004687205929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338657180794
                                         uncertainty =       0.004687205929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411484537
  error estimate for blocks of size 2^( 2) =       0.000424370398
  error estimate for blocks of size 2^( 3) =       0.000437254831
  error estimate for blocks of size 2^( 4) =       0.000449386141
  error estimate for blocks of size 2^( 5) =       0.000458657413
  error estimate for blocks of size 2^( 6) =       0.000465114266
  error estimate for blocks of size 2^( 7) =       0.000471180083

      target function =                  N/A
              le_mean =     -16.906363422177
             les_mean =     286.163763041071
             stat err =       0.000461084476
             autocorr =       1.255607675363
              std dev =       0.581927012325
             le_variance =       0.338639047673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636342218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363422177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363429191       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363439453       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363441156       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363439873       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363441379       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363441362       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363440622       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.700192e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363422177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363423932       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363426499       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363426928       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363426606       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363426983       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363426979       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363426794       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.250837e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363422177       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363422616       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363423258       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363423365       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363423284       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363423379       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363423378       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363423331       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.062731e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6211e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.090693e-01 1 1  ON 0
 uu_1                 1.424781e-01 1 1  ON 1
 uu_2                 4.112139e-02 1 1  ON 2
 uu_3                -2.111957e-02 1 1  ON 3
 uu_4                -6.581958e-02 1 1  ON 4
 uu_5                -1.000958e-01 1 1  ON 5
 uu_6                -1.266765e-01 1 1  ON 6
 uu_7                -1.392540e-01 1 1  ON 7
 uu_8                -1.316920e-01 1 1  ON 8
 uu_9                -1.016837e-01 1 1  ON 9
 ud_0                 4.493287e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172719e-02 1 1  ON 12
 ud_3                -1.004157e-02 1 1  ON 13
 ud_4                -6.709364e-02 1 1  ON 14
 ud_5                -1.083421e-01 1 1  ON 15
 ud_6                -1.351566e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512015e-01 1 1  ON 18
 ud_9                -1.399170e-01 1 1  ON 19
 eO_0                -7.656075e-01 1 1  ON 20
 eO_1                -4.433205e-01 1 1  ON 21
 eO_2                -2.002965e-02 1 1  ON 22
 eO_3                 3.023022e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864249e-01 1 1  ON 25
 eO_6                 2.559068e-01 1 1  ON 26
 eO_7                -4.658720e-02 1 1  ON 27
 eO_8                -2.187745e-01 1 1  ON 28
 eO_9                -7.764492e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423759e-01 1 1  ON 31
eH1_2                -9.587641e-02 1 1  ON 32
eH1_3                -4.185252e-02 1 1  ON 33
eH1_4                 6.102297e-03 1 1  ON 34
eH1_5                 4.068921e-02 1 1  ON 35
eH1_6                 9.815446e-02 1 1  ON 36
eH1_7                 1.507542e-01 1 1  ON 37
eH1_8                 1.730503e-01 1 1  ON 38
eH1_9                 5.837534e-02 1 1  ON 39
eH2_0                -2.380740e-01 1 1  ON 40
eH2_1                -1.383946e-01 1 1  ON 41
eH2_2                -9.198376e-02 1 1  ON 42
eH2_3                -3.793354e-02 1 1  ON 43
eH2_4                 9.690781e-03 1 1  ON 44
eH2_5                 4.286502e-02 1 1  ON 45
eH2_6                 9.887264e-02 1 1  ON 46
eH2_7                 1.502627e-01 1 1  ON 47
eH2_8                 1.763180e-01 1 1  ON 48
eH2_9                 4.573338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.7975
    reference variance = 0.229798
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4229e-01
  Total weights = 2.0000e+06
  Execution time = 1.9006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162806135
                                         uncertainty =       0.004094038793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162806135
                                         uncertainty =       0.004094038793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413699320
  error estimate for blocks of size 2^( 2) =       0.000426578730
  error estimate for blocks of size 2^( 3) =       0.000439213757
  error estimate for blocks of size 2^( 4) =       0.000451394458
  error estimate for blocks of size 2^( 5) =       0.000461963948
  error estimate for blocks of size 2^( 6) =       0.000470020018
  error estimate for blocks of size 2^( 7) =       0.000475106406

      target function =                  N/A
              le_mean =     -16.905943667915
             les_mean =     286.153225386092
             stat err =       0.000464621207
             autocorr =       1.261329184399
              std dev =       0.585059188912
             le_variance =       0.342294254531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163220955
                                         uncertainty =       0.004094040039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163220955
                                         uncertainty =       0.004094040039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413699571
  error estimate for blocks of size 2^( 2) =       0.000426578961
  error estimate for blocks of size 2^( 3) =       0.000439213966
  error estimate for blocks of size 2^( 4) =       0.000451394654
  error estimate for blocks of size 2^( 5) =       0.000461964141
  error estimate for blocks of size 2^( 6) =       0.000470020207
  error estimate for blocks of size 2^( 7) =       0.000475106594

      target function =                  N/A
              le_mean =     -16.905943662103
             les_mean =     286.153225605582
             stat err =       0.000464621399
             autocorr =       1.261328692245
              std dev =       0.585059544426
             le_variance =       0.342294670524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163013538
                                         uncertainty =       0.004094039409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163013538
                                         uncertainty =       0.004094039409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413699446
  error estimate for blocks of size 2^( 2) =       0.000426578846
  error estimate for blocks of size 2^( 3) =       0.000439213861
  error estimate for blocks of size 2^( 4) =       0.000451394556
  error estimate for blocks of size 2^( 5) =       0.000461964045
  error estimate for blocks of size 2^( 6) =       0.000470020112
  error estimate for blocks of size 2^( 7) =       0.000475106500

      target function =                  N/A
              le_mean =     -16.905943665001
             les_mean =     286.153225495569
             stat err =       0.000464621303
             autocorr =       1.261328938228
              std dev =       0.585059366664
             le_variance =       0.342294462521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162832059
                                         uncertainty =       0.004094038870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162832059
                                         uncertainty =       0.004094038870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413699336
  error estimate for blocks of size 2^( 2) =       0.000426578745
  error estimate for blocks of size 2^( 3) =       0.000439213770
  error estimate for blocks of size 2^( 4) =       0.000451394471
  error estimate for blocks of size 2^( 5) =       0.000461963960
  error estimate for blocks of size 2^( 6) =       0.000470020030
  error estimate for blocks of size 2^( 7) =       0.000475106417

      target function =                  N/A
              le_mean =     -16.905943667550
             les_mean =     286.153225399763
             stat err =       0.000464621219
             autocorr =       1.261329153618
              std dev =       0.585059211130
             le_variance =       0.342294280528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905943667915        initial  <--
     1.5625e+02     1.5625e+03             1.7002e-06       -16.905943662103
     6.2500e+02     6.2500e+03             4.2508e-07       -16.905943665001
     2.5000e+03     2.5000e+04             1.0627e-07       -16.905943667550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2132
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.224207
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.5056e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450773907787
                                         uncertainty =       0.111076958057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450773907787
                                         uncertainty =       0.111076958057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474635310
  error estimate for blocks of size 2^( 2) =       0.000485661597
  error estimate for blocks of size 2^( 3) =       0.000497573403
  error estimate for blocks of size 2^( 4) =       0.000508142802
  error estimate for blocks of size 2^( 5) =       0.000518063672
  error estimate for blocks of size 2^( 6) =       0.000525382981
  error estimate for blocks of size 2^( 7) =       0.000529043907

      target function =                  N/A
              le_mean =     -16.906006434959
             les_mean =     286.263610708152
             stat err =       0.000520158340
             autocorr =       1.201022229182
              std dev =       0.671235692261
             le_variance =       0.450557354565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600643496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906006434959       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006435350       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006435857       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006436215       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906006436491       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006436422       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906006436339       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906006436372       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.433215e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906006434959       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006435056       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006435183       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006435278       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906006435349       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006435324       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906006435312       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906006435311       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.583064e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906006434959       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006434983       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006435015       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006435037       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906006435054       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006435047       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906006435034       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906006435033       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 8.957676e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6376e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112146e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266763e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172729e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658724e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764480e-02 1 1  ON 29
eH1_0                -2.429882e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587612e-02 1 1  ON 32
eH1_3                -4.185250e-02 1 1  ON 33
eH1_4                 6.102387e-03 1 1  ON 34
eH1_5                 4.068928e-02 1 1  ON 35
eH1_6                 9.815441e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837512e-02 1 1  ON 39
eH2_0                -2.380737e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198378e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690892e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9822
    reference variance = 0.231639
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3448e-01
  Total weights = 2.0000e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526106608
                                         uncertainty =       0.002746939837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526106608
                                         uncertainty =       0.002746939837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408952308
  error estimate for blocks of size 2^( 2) =       0.000421602157
  error estimate for blocks of size 2^( 3) =       0.000434273023
  error estimate for blocks of size 2^( 4) =       0.000446106900
  error estimate for blocks of size 2^( 5) =       0.000457430439
  error estimate for blocks of size 2^( 6) =       0.000464842597
  error estimate for blocks of size 2^( 7) =       0.000471235400

      target function =                  N/A
              le_mean =     -16.906071684035
             les_mean =     286.149743599245
             stat err =       0.000459903834
             autocorr =       1.264703537446
              std dev =       0.578345900617
             le_variance =       0.334483980760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526155593
                                         uncertainty =       0.002746940512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526155593
                                         uncertainty =       0.002746940512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408952338
  error estimate for blocks of size 2^( 2) =       0.000421602185
  error estimate for blocks of size 2^( 3) =       0.000434273050
  error estimate for blocks of size 2^( 4) =       0.000446106928
  error estimate for blocks of size 2^( 5) =       0.000457430466
  error estimate for blocks of size 2^( 6) =       0.000464842625
  error estimate for blocks of size 2^( 7) =       0.000471235428

      target function =                  N/A
              le_mean =     -16.906071683877
             les_mean =     286.149743642900
             stat err =       0.000459903862
             autocorr =       1.264703502757
              std dev =       0.578345942963
             le_variance =       0.334484029741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526131105
                                         uncertainty =       0.002746940174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526131105
                                         uncertainty =       0.002746940174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408952323
  error estimate for blocks of size 2^( 2) =       0.000421602171
  error estimate for blocks of size 2^( 3) =       0.000434273036
  error estimate for blocks of size 2^( 4) =       0.000446106914
  error estimate for blocks of size 2^( 5) =       0.000457430453
  error estimate for blocks of size 2^( 6) =       0.000464842611
  error estimate for blocks of size 2^( 7) =       0.000471235414

      target function =                  N/A
              le_mean =     -16.906071683956
             les_mean =     286.149743621077
             stat err =       0.000459903848
             autocorr =       1.264703520101
              std dev =       0.578345921794
             le_variance =       0.334484005255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526109670
                                         uncertainty =       0.002746939879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334526109670
                                         uncertainty =       0.002746939879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408952310
  error estimate for blocks of size 2^( 2) =       0.000421602158
  error estimate for blocks of size 2^( 3) =       0.000434273024
  error estimate for blocks of size 2^( 4) =       0.000446106902
  error estimate for blocks of size 2^( 5) =       0.000457430441
  error estimate for blocks of size 2^( 6) =       0.000464842599
  error estimate for blocks of size 2^( 7) =       0.000471235402

      target function =                  N/A
              le_mean =     -16.906071684025
             les_mean =     286.149743601974
             stat err =       0.000459903836
             autocorr =       1.264703535280
              std dev =       0.578345903264
             le_variance =       0.334483983822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906071684035        initial  <--
     1.5625e+03     1.5625e+04             1.4332e-07       -16.906071683877
     6.2500e+03     6.2500e+04             3.5831e-08       -16.906071683956
     2.5000e+04     2.5000e+05             8.9577e-09       -16.906071684025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6085
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9317
    reference variance = 0.338654
====================================================
  Execution time = 2.3738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345184635448
                                         uncertainty =       0.005898327301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345184635448
                                         uncertainty =       0.005898327301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415418053
  error estimate for blocks of size 2^( 2) =       0.000427896150
  error estimate for blocks of size 2^( 3) =       0.000440655164
  error estimate for blocks of size 2^( 4) =       0.000453540410
  error estimate for blocks of size 2^( 5) =       0.000464564270
  error estimate for blocks of size 2^( 6) =       0.000471143858
  error estimate for blocks of size 2^( 7) =       0.000475023281

      target function =                  N/A
              le_mean =     -16.905962609447
             les_mean =     286.156715896847
             stat err =       0.000466067955
             autocorr =       1.258716006357
              std dev =       0.587489844517
             le_variance =       0.345144317411


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596260945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962609447       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962609474       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962609490       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962609494       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962609502       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962609503       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962609505       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962609505       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.017545e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962609447       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962609453       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962609457       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962609456       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962609418       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962609450       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962609443       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962609479       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 5.043902e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962609447       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962609448       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962609449       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962609528       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962609450       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962609431       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962609444       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962609501       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.260978e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9372e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266763e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185249e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690898e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9281
    reference variance = 0.251488
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4135e-01
  Total weights = 2.0000e+06
  Execution time = 1.9031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457733489
                                         uncertainty =       0.004295138211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457733489
                                         uncertainty =       0.004295138211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413128765
  error estimate for blocks of size 2^( 2) =       0.000425276522
  error estimate for blocks of size 2^( 3) =       0.000438330954
  error estimate for blocks of size 2^( 4) =       0.000450066515
  error estimate for blocks of size 2^( 5) =       0.000460049759
  error estimate for blocks of size 2^( 6) =       0.000469620888
  error estimate for blocks of size 2^( 7) =       0.000473082889

      target function =                  N/A
              le_mean =     -16.905522316699
             les_mean =     286.138035382057
             stat err =       0.000463205013
             autocorr =       1.257116806915
              std dev =       0.584252301928
             le_variance =       0.341350752308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457740767
                                         uncertainty =       0.004295138358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457740767
                                         uncertainty =       0.004295138358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413128769
  error estimate for blocks of size 2^( 2) =       0.000425276526
  error estimate for blocks of size 2^( 3) =       0.000438330958
  error estimate for blocks of size 2^( 4) =       0.000450066519
  error estimate for blocks of size 2^( 5) =       0.000460049762
  error estimate for blocks of size 2^( 6) =       0.000469620892
  error estimate for blocks of size 2^( 7) =       0.000473082893

      target function =                  N/A
              le_mean =     -16.905522316695
             les_mean =     286.138035389187
             stat err =       0.000463205017
             autocorr =       1.257116800186
              std dev =       0.584252308150
             le_variance =       0.341350759578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457737128
                                         uncertainty =       0.004295138285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457737128
                                         uncertainty =       0.004295138285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413128767
  error estimate for blocks of size 2^( 2) =       0.000425276524
  error estimate for blocks of size 2^( 3) =       0.000438330956
  error estimate for blocks of size 2^( 4) =       0.000450066517
  error estimate for blocks of size 2^( 5) =       0.000460049760
  error estimate for blocks of size 2^( 6) =       0.000469620890
  error estimate for blocks of size 2^( 7) =       0.000473082891

      target function =                  N/A
              le_mean =     -16.905522316697
             les_mean =     286.138035385622
             stat err =       0.000463205015
             autocorr =       1.257116803552
              std dev =       0.584252305039
             le_variance =       0.341350755943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457733944
                                         uncertainty =       0.004295138221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457733944
                                         uncertainty =       0.004295138221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413128765
  error estimate for blocks of size 2^( 2) =       0.000425276523
  error estimate for blocks of size 2^( 3) =       0.000438330955
  error estimate for blocks of size 2^( 4) =       0.000450066516
  error estimate for blocks of size 2^( 5) =       0.000460049759
  error estimate for blocks of size 2^( 6) =       0.000469620888
  error estimate for blocks of size 2^( 7) =       0.000473082889

      target function =                  N/A
              le_mean =     -16.905522316699
             les_mean =     286.138035382502
             stat err =       0.000463205013
             autocorr =       1.257116806487
              std dev =       0.584252302317
             le_variance =       0.341350752763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905522316699        initial  <--
     1.5625e+04     1.5625e+05             2.0175e-08       -16.905522316695
     6.2500e+04     6.2500e+05             5.0439e-09       -16.905522316697
     2.5000e+05     2.5000e+06             1.2610e-09       -16.905522316699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5082
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.215035
====================================================
  Execution time = 2.0894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336697736198
                                         uncertainty =       0.002777702757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336697736198
                                         uncertainty =       0.002777702757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331955
  error estimate for blocks of size 2^( 2) =       0.000423169500
  error estimate for blocks of size 2^( 3) =       0.000436064774
  error estimate for blocks of size 2^( 4) =       0.000448835548
  error estimate for blocks of size 2^( 5) =       0.000459864372
  error estimate for blocks of size 2^( 6) =       0.000467053266
  error estimate for blocks of size 2^( 7) =       0.000472899147

      target function =                  N/A
              le_mean =     -16.905413440536
             les_mean =     286.129748053934
             stat err =       0.000462163083
             autocorr =       1.268585737939
              std dev =       0.580297016075
             le_variance =       0.336744626866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690541344054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905413440536       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905413440534       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905413440535       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905413440534       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905413440531       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905413440546       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905413440489       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905413440332       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.566548e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905413440536       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905413440535       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905413440535       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905413440459       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905413440594       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905413440535       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905413440474       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905413440149       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.916372e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905413440536       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905413440535       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905413440536       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905413439393       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905413440676       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905413441892       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905413440021       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905413439264       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 9.790928e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6540e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.300629
====================================================
  Execution time = 2.0001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4295e-01
  Total weights = 2.0000e+06
  Execution time = 1.9022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016507072
                                         uncertainty =       0.006196057358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016507072
                                         uncertainty =       0.006196057358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414097750
  error estimate for blocks of size 2^( 2) =       0.000426797919
  error estimate for blocks of size 2^( 3) =       0.000439204849
  error estimate for blocks of size 2^( 4) =       0.000451034752
  error estimate for blocks of size 2^( 5) =       0.000461496708
  error estimate for blocks of size 2^( 6) =       0.000469922313
  error estimate for blocks of size 2^( 7) =       0.000473521291

      target function =                  N/A
              le_mean =     -16.905995277590
             les_mean =     286.155630047541
             stat err =       0.000463993766
             autocorr =       1.255505298933
              std dev =       0.585622654214
             le_variance =       0.342953893128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016505759
                                         uncertainty =       0.006196057326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016505759
                                         uncertainty =       0.006196057326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414097749
  error estimate for blocks of size 2^( 2) =       0.000426797918
  error estimate for blocks of size 2^( 3) =       0.000439204848
  error estimate for blocks of size 2^( 4) =       0.000451034752
  error estimate for blocks of size 2^( 5) =       0.000461496707
  error estimate for blocks of size 2^( 6) =       0.000469922312
  error estimate for blocks of size 2^( 7) =       0.000473521291

      target function =                  N/A
              le_mean =     -16.905995277592
             les_mean =     286.155630046288
             stat err =       0.000463993766
             autocorr =       1.255505300131
              std dev =       0.585622653093
             le_variance =       0.342953891816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016506415
                                         uncertainty =       0.006196057342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016506415
                                         uncertainty =       0.006196057342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414097750
  error estimate for blocks of size 2^( 2) =       0.000426797918
  error estimate for blocks of size 2^( 3) =       0.000439204848
  error estimate for blocks of size 2^( 4) =       0.000451034752
  error estimate for blocks of size 2^( 5) =       0.000461496708
  error estimate for blocks of size 2^( 6) =       0.000469922313
  error estimate for blocks of size 2^( 7) =       0.000473521291

      target function =                  N/A
              le_mean =     -16.905995277591
             les_mean =     286.155630046914
             stat err =       0.000463993766
             autocorr =       1.255505299540
              std dev =       0.585622653653
             le_variance =       0.342953892472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016506990
                                         uncertainty =       0.006196057356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016506990
                                         uncertainty =       0.006196057356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414097750
  error estimate for blocks of size 2^( 2) =       0.000426797919
  error estimate for blocks of size 2^( 3) =       0.000439204849
  error estimate for blocks of size 2^( 4) =       0.000451034752
  error estimate for blocks of size 2^( 5) =       0.000461496708
  error estimate for blocks of size 2^( 6) =       0.000469922313
  error estimate for blocks of size 2^( 7) =       0.000473521291

      target function =                  N/A
              le_mean =     -16.905995277590
             les_mean =     286.155630047463
             stat err =       0.000463993766
             autocorr =       1.255505299015
              std dev =       0.585622654144
             le_variance =       0.342953893046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905995277590        initial
     1.5625e+05     1.5625e+06             1.5665e-09       -16.905995277592  <--
     6.2500e+05     6.2500e+06             3.9164e-10       -16.905995277591
     2.5000e+06     2.5000e+07             9.7909e-11       -16.905995277590

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 2.9568e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.325382
====================================================
  Execution time = 2.1315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339045496637
                                         uncertainty =       0.002878266281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339045496637
                                         uncertainty =       0.002878266281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411819859
  error estimate for blocks of size 2^( 2) =       0.000425002515
  error estimate for blocks of size 2^( 3) =       0.000438507042
  error estimate for blocks of size 2^( 4) =       0.000451191789
  error estimate for blocks of size 2^( 5) =       0.000461545568
  error estimate for blocks of size 2^( 6) =       0.000469300181
  error estimate for blocks of size 2^( 7) =       0.000473042357

      target function =                  N/A
              le_mean =     -16.905079276540
             les_mean =     286.120896368931
             stat err =       0.000463769974
             autocorr =       1.268208570143
              std dev =       0.582401229754
             le_variance =       0.339191192420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690507927654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905079276540       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905079276542       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905079276559       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905079276569       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905079276568       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905079276588       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905079276563       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905079276572       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.008174e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905079276540       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905079276541       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905079276545       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905079276546       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905079276617       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905079276521       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905079276670       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905079276430       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.252044e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905079276540       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905079276540       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905079276541       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905079276590       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905079276542       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905079276545       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905079276534       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905079276044       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.130110e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6874e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.0108
    reference variance = 0.333515
====================================================
  Execution time = 2.0460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.0000e+06
  Execution time = 1.8982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151998132
                                         uncertainty =       0.003492799447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151998132
                                         uncertainty =       0.003492799447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412404088
  error estimate for blocks of size 2^( 2) =       0.000424865498
  error estimate for blocks of size 2^( 3) =       0.000438067731
  error estimate for blocks of size 2^( 4) =       0.000450410913
  error estimate for blocks of size 2^( 5) =       0.000460797033
  error estimate for blocks of size 2^( 6) =       0.000467334496
  error estimate for blocks of size 2^( 7) =       0.000470271202

      target function =                  N/A
              le_mean =     -16.905604806257
             les_mean =     286.139627958821
             stat err =       0.000462203411
             autocorr =       1.256088874702
              std dev =       0.583227454388
             le_variance =       0.340154263552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151997486
                                         uncertainty =       0.003492799415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151997486
                                         uncertainty =       0.003492799415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412404088
  error estimate for blocks of size 2^( 2) =       0.000424865498
  error estimate for blocks of size 2^( 3) =       0.000438067731
  error estimate for blocks of size 2^( 4) =       0.000450410913
  error estimate for blocks of size 2^( 5) =       0.000460797032
  error estimate for blocks of size 2^( 6) =       0.000467334495
  error estimate for blocks of size 2^( 7) =       0.000470271202

      target function =                  N/A
              le_mean =     -16.905604806256
             les_mean =     286.139627958124
             stat err =       0.000462203411
             autocorr =       1.256088874994
              std dev =       0.583227453837
             le_variance =       0.340154262909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151997809
                                         uncertainty =       0.003492799431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151997809
                                         uncertainty =       0.003492799431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412404088
  error estimate for blocks of size 2^( 2) =       0.000424865498
  error estimate for blocks of size 2^( 3) =       0.000438067731
  error estimate for blocks of size 2^( 4) =       0.000450410913
  error estimate for blocks of size 2^( 5) =       0.000460797033
  error estimate for blocks of size 2^( 6) =       0.000467334495
  error estimate for blocks of size 2^( 7) =       0.000470271202

      target function =                  N/A
              le_mean =     -16.905604806256
             les_mean =     286.139627958473
             stat err =       0.000462203411
             autocorr =       1.256088874851
              std dev =       0.583227454112
             le_variance =       0.340154263231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151998091
                                         uncertainty =       0.003492799445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340151998091
                                         uncertainty =       0.003492799445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412404088
  error estimate for blocks of size 2^( 2) =       0.000424865498
  error estimate for blocks of size 2^( 3) =       0.000438067731
  error estimate for blocks of size 2^( 4) =       0.000450410913
  error estimate for blocks of size 2^( 5) =       0.000460797033
  error estimate for blocks of size 2^( 6) =       0.000467334496
  error estimate for blocks of size 2^( 7) =       0.000470271202

      target function =                  N/A
              le_mean =     -16.905604806257
             les_mean =     286.139627958778
             stat err =       0.000462203411
             autocorr =       1.256088874721
              std dev =       0.583227454353
             le_variance =       0.340154263512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905604806257        initial  <--
     3.9062e+04     3.9062e+05             5.0082e-09       -16.905604806256
     1.5625e+05     1.5625e+06             1.2520e-09       -16.905604806256
     6.2500e+05     6.2500e+06             3.1301e-10       -16.905604806257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9780
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8302
    reference variance = 0.335318
====================================================
  Execution time = 2.0965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4969e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349615180759
                                         uncertainty =       0.007779173358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349615180759
                                         uncertainty =       0.007779173358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418146636
  error estimate for blocks of size 2^( 2) =       0.000430425980
  error estimate for blocks of size 2^( 3) =       0.000443422767
  error estimate for blocks of size 2^( 4) =       0.000455189767
  error estimate for blocks of size 2^( 5) =       0.000465408351
  error estimate for blocks of size 2^( 6) =       0.000472415147
  error estimate for blocks of size 2^( 7) =       0.000475903062

      target function =                  N/A
              le_mean =     -16.905781833820
             les_mean =     286.155152455610
             stat err =       0.000467229082
             autocorr =       1.248540170931
              std dev =       0.591348643139
             le_variance =       0.349693217742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578183382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781833820       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905781833820       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905781833820       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905781833820       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905781833790       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905781833941       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905781833712       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905781833608       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.060113e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781833820       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905781833820       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905781833820       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905781833820       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905781833291       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905781834225       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905781833060       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905781832700       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.265027e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781833820       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905781833820       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905781833820       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905781833823       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905781832654       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905781833739       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905781833942       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905781843591       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 3.162618e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6539e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8445
    reference variance = 0.26819
====================================================
  Execution time = 2.0422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3908e-01
  Total weights = 2.0000e+06
  Execution time = 1.9022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650863
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650863
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752087
  error estimate for blocks of size 2^( 2) =       0.000424147087
  error estimate for blocks of size 2^( 3) =       0.000436933043
  error estimate for blocks of size 2^( 4) =       0.000448547879
  error estimate for blocks of size 2^( 5) =       0.000458324079
  error estimate for blocks of size 2^( 6) =       0.000463887066
  error estimate for blocks of size 2^( 7) =       0.000467394153

      target function =                  N/A
              le_mean =     -16.906166648839
             les_mean =     286.157550150821
             stat err =       0.000459538294
             autocorr =       1.245580492278
              std dev =       0.582305385567
             le_variance =       0.339079562061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650943
                                         uncertainty =       0.003923326161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650943
                                         uncertainty =       0.003923326161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752087
  error estimate for blocks of size 2^( 2) =       0.000424147087
  error estimate for blocks of size 2^( 3) =       0.000436933043
  error estimate for blocks of size 2^( 4) =       0.000448547879
  error estimate for blocks of size 2^( 5) =       0.000458324079
  error estimate for blocks of size 2^( 6) =       0.000463887066
  error estimate for blocks of size 2^( 7) =       0.000467394153

      target function =                  N/A
              le_mean =     -16.906166648839
             les_mean =     286.157550150900
             stat err =       0.000459538294
             autocorr =       1.245580492144
              std dev =       0.582305385636
             le_variance =       0.339079562140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650903
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650903
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752087
  error estimate for blocks of size 2^( 2) =       0.000424147087
  error estimate for blocks of size 2^( 3) =       0.000436933043
  error estimate for blocks of size 2^( 4) =       0.000448547879
  error estimate for blocks of size 2^( 5) =       0.000458324079
  error estimate for blocks of size 2^( 6) =       0.000463887066
  error estimate for blocks of size 2^( 7) =       0.000467394153

      target function =                  N/A
              le_mean =     -16.906166648839
             les_mean =     286.157550150861
             stat err =       0.000459538294
             autocorr =       1.245580492206
              std dev =       0.582305385601
             le_variance =       0.339079562100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650868
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339183650868
                                         uncertainty =       0.003923326162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752087
  error estimate for blocks of size 2^( 2) =       0.000424147087
  error estimate for blocks of size 2^( 3) =       0.000436933043
  error estimate for blocks of size 2^( 4) =       0.000448547879
  error estimate for blocks of size 2^( 5) =       0.000458324079
  error estimate for blocks of size 2^( 6) =       0.000463887066
  error estimate for blocks of size 2^( 7) =       0.000467394153

      target function =                  N/A
              le_mean =     -16.906166648839
             les_mean =     286.157550150826
             stat err =       0.000459538294
             autocorr =       1.245580492265
              std dev =       0.582305385571
             le_variance =       0.339079562065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906166648839        initial  <--
     3.9062e+05     3.9062e+06             5.0601e-10       -16.906166648839
     1.5625e+06     1.5625e+07             1.2650e-10       -16.906166648839
     6.2500e+06     6.2500e+07             3.1626e-11       -16.906166648839

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9235
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.245461
====================================================
  Execution time = 2.1073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338178272846
                                         uncertainty =       0.003982502706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338178272846
                                         uncertainty =       0.003982502706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411135959
  error estimate for blocks of size 2^( 2) =       0.000424334737
  error estimate for blocks of size 2^( 3) =       0.000437650031
  error estimate for blocks of size 2^( 4) =       0.000449622498
  error estimate for blocks of size 2^( 5) =       0.000459522628
  error estimate for blocks of size 2^( 6) =       0.000468053123
  error estimate for blocks of size 2^( 7) =       0.000473108394

      target function =                  N/A
              le_mean =     -16.905095356915
             les_mean =     286.120314411273
             stat err =       0.000462576661
             autocorr =       1.265891567857
              std dev =       0.581434049511
             le_variance =       0.338065553930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509535691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905095356915       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905095356915       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905095356915       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905095356435       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905095357210       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905095357968       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905095357814       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905095337738       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.069029e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905095356915       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905095356915       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905095356915       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905095357075       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905095368495       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905095363198       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905095362485       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905095348962       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.517279e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905095356915       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905095356915       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905095356915       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905095356915       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905095357830       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905095360107       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905095343111       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905095384839       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 3.793132e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6698e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.322419
====================================================
  Execution time = 2.0238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4410e-01
  Total weights = 2.0000e+06
  Execution time = 1.9051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006398
                                         uncertainty =       0.006849191183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006398
                                         uncertainty =       0.006849191183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414791727
  error estimate for blocks of size 2^( 2) =       0.000427364063
  error estimate for blocks of size 2^( 3) =       0.000440191306
  error estimate for blocks of size 2^( 4) =       0.000452151041
  error estimate for blocks of size 2^( 5) =       0.000464170981
  error estimate for blocks of size 2^( 6) =       0.000472503857
  error estimate for blocks of size 2^( 7) =       0.000476443282

      target function =                  N/A
              le_mean =     -16.905707743354
             les_mean =     286.147058484942
             stat err =       0.000466317290
             autocorr =       1.263871341473
              std dev =       0.586604085642
             le_variance =       0.344104353291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006364
                                         uncertainty =       0.006849191181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006364
                                         uncertainty =       0.006849191181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414791727
  error estimate for blocks of size 2^( 2) =       0.000427364063
  error estimate for blocks of size 2^( 3) =       0.000440191306
  error estimate for blocks of size 2^( 4) =       0.000452151041
  error estimate for blocks of size 2^( 5) =       0.000464170981
  error estimate for blocks of size 2^( 6) =       0.000472503857
  error estimate for blocks of size 2^( 7) =       0.000476443282

      target function =                  N/A
              le_mean =     -16.905707743354
             les_mean =     286.147058484920
             stat err =       0.000466317290
             autocorr =       1.263871341492
              std dev =       0.586604085612
             le_variance =       0.344104353257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006381
                                         uncertainty =       0.006849191182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006381
                                         uncertainty =       0.006849191182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414791727
  error estimate for blocks of size 2^( 2) =       0.000427364063
  error estimate for blocks of size 2^( 3) =       0.000440191306
  error estimate for blocks of size 2^( 4) =       0.000452151041
  error estimate for blocks of size 2^( 5) =       0.000464170981
  error estimate for blocks of size 2^( 6) =       0.000472503857
  error estimate for blocks of size 2^( 7) =       0.000476443282

      target function =                  N/A
              le_mean =     -16.905707743354
             les_mean =     286.147058484931
             stat err =       0.000466317290
             autocorr =       1.263871341480
              std dev =       0.586604085627
             le_variance =       0.344104353274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006396
                                         uncertainty =       0.006849191183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343789006396
                                         uncertainty =       0.006849191183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414791727
  error estimate for blocks of size 2^( 2) =       0.000427364063
  error estimate for blocks of size 2^( 3) =       0.000440191306
  error estimate for blocks of size 2^( 4) =       0.000452151041
  error estimate for blocks of size 2^( 5) =       0.000464170981
  error estimate for blocks of size 2^( 6) =       0.000472503857
  error estimate for blocks of size 2^( 7) =       0.000476443282

      target function =                  N/A
              le_mean =     -16.905707743354
             les_mean =     286.147058484941
             stat err =       0.000466317290
             autocorr =       1.263871341466
              std dev =       0.586604085640
             le_variance =       0.344104353289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905707743354        initial
     3.9062e+06     3.9062e+07             6.0690e-11       -16.905707743354  <--
     1.5625e+07     1.5625e+08             1.5173e-11       -16.905707743354
     6.2500e+07     6.2500e+08             3.7931e-12       -16.905707743354

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 2.9753e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9249
    reference variance = 0.228302
====================================================
  Execution time = 3.0123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335482761114
                                         uncertainty =       0.002171707214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335482761114
                                         uncertainty =       0.002171707214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409519469
  error estimate for blocks of size 2^( 2) =       0.000422866401
  error estimate for blocks of size 2^( 3) =       0.000436238159
  error estimate for blocks of size 2^( 4) =       0.000448873625
  error estimate for blocks of size 2^( 5) =       0.000459163106
  error estimate for blocks of size 2^( 6) =       0.000467752543
  error estimate for blocks of size 2^( 7) =       0.000473479984

      target function =                  N/A
              le_mean =     -16.905978858828
             les_mean =     286.147533399027
             stat err =       0.000462317315
             autocorr =       1.274474674438
              std dev =       0.579147987654
             le_variance =       0.335412391604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597885883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978858828       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978858828       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978858828       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905978858828       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905978859924       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905978858469       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905978859688       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905978858753       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.757366e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978858828       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978858828       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978858828       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905978858828       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905978858828       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905978855501       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905978858335       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905978858960       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.893411e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905978858828       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905978858828       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905978858828       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905978858828       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905978858703       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905978856482       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905978859357       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905978862884       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.723355e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5713e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9161
    reference variance = 0.266653
====================================================
  Execution time = 2.0238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3392e-01
  Total weights = 2.0000e+06
  Execution time = 1.8802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226739
                                         uncertainty =       0.002874602573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226739
                                         uncertainty =       0.002874602573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607385
  error estimate for blocks of size 2^( 2) =       0.000421604749
  error estimate for blocks of size 2^( 3) =       0.000434014705
  error estimate for blocks of size 2^( 4) =       0.000445511748
  error estimate for blocks of size 2^( 5) =       0.000455249309
  error estimate for blocks of size 2^( 6) =       0.000462072769
  error estimate for blocks of size 2^( 7) =       0.000466049851

      target function =                  N/A
              le_mean =     -16.905333176017
             les_mean =     286.124209614715
             stat err =       0.000457220919
             autocorr =       1.252102153222
              std dev =       0.577858105021
             le_variance =       0.333919989539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226751
                                         uncertainty =       0.002874602577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226751
                                         uncertainty =       0.002874602577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607385
  error estimate for blocks of size 2^( 2) =       0.000421604749
  error estimate for blocks of size 2^( 3) =       0.000434014705
  error estimate for blocks of size 2^( 4) =       0.000445511748
  error estimate for blocks of size 2^( 5) =       0.000455249309
  error estimate for blocks of size 2^( 6) =       0.000462072769
  error estimate for blocks of size 2^( 7) =       0.000466049851

      target function =                  N/A
              le_mean =     -16.905333176018
             les_mean =     286.124209614773
             stat err =       0.000457220919
             autocorr =       1.252102153174
              std dev =       0.577858105032
             le_variance =       0.333919989551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226745
                                         uncertainty =       0.002874602575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226745
                                         uncertainty =       0.002874602575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607385
  error estimate for blocks of size 2^( 2) =       0.000421604749
  error estimate for blocks of size 2^( 3) =       0.000434014705
  error estimate for blocks of size 2^( 4) =       0.000445511748
  error estimate for blocks of size 2^( 5) =       0.000455249309
  error estimate for blocks of size 2^( 6) =       0.000462072769
  error estimate for blocks of size 2^( 7) =       0.000466049851

      target function =                  N/A
              le_mean =     -16.905333176018
             les_mean =     286.124209614744
             stat err =       0.000457220919
             autocorr =       1.252102153194
              std dev =       0.577858105027
             le_variance =       0.333919989545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226739
                                         uncertainty =       0.002874602573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333988226739
                                         uncertainty =       0.002874602573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607385
  error estimate for blocks of size 2^( 2) =       0.000421604749
  error estimate for blocks of size 2^( 3) =       0.000434014705
  error estimate for blocks of size 2^( 4) =       0.000445511748
  error estimate for blocks of size 2^( 5) =       0.000455249309
  error estimate for blocks of size 2^( 6) =       0.000462072769
  error estimate for blocks of size 2^( 7) =       0.000466049851

      target function =                  N/A
              le_mean =     -16.905333176017
             les_mean =     286.124209614719
             stat err =       0.000457220919
             autocorr =       1.252102153218
              std dev =       0.577858105022
             le_variance =       0.333919989540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905333176017        initial
     9.7656e+05     9.7656e+06             2.7574e-10       -16.905333176018  <--
     3.9062e+06     3.9062e+07             6.8934e-11       -16.905333176018
     1.5625e+07     1.5625e+08             1.7234e-11       -16.905333176017

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9695e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5509e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.219288
====================================================
  Execution time = 2.1431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353072537767
                                         uncertainty =       0.013173631075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353072537767
                                         uncertainty =       0.013173631075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420125931
  error estimate for blocks of size 2^( 2) =       0.000432377295
  error estimate for blocks of size 2^( 3) =       0.000445210446
  error estimate for blocks of size 2^( 4) =       0.000456031586
  error estimate for blocks of size 2^( 5) =       0.000466813809
  error estimate for blocks of size 2^( 6) =       0.000474814890
  error estimate for blocks of size 2^( 7) =       0.000479848860

      target function =                  N/A
              le_mean =     -16.905744439731
             les_mean =     286.157206480046
             stat err =       0.000469377286
             autocorr =       1.248202834286
              std dev =       0.594147788892
             le_variance =       0.353011595046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574443973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744439731       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744439731       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744439737       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744439746       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744439736       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744439585       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744439595       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744439815       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.033755e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744439731       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744439731       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744439733       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744439733       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744439729       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744436315       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744439656       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744439492       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.584388e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744439731       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744439731       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744439732       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744438776       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905744440250       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744439699       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744437527       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744439485       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.460973e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7061e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.245093
====================================================
  Execution time = 2.0705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3936e-01
  Total weights = 2.0000e+06
  Execution time = 1.8883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190507
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190507
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411920031
  error estimate for blocks of size 2^( 2) =       0.000425332664
  error estimate for blocks of size 2^( 3) =       0.000439052363
  error estimate for blocks of size 2^( 4) =       0.000451813028
  error estimate for blocks of size 2^( 5) =       0.000462851213
  error estimate for blocks of size 2^( 6) =       0.000471574955
  error estimate for blocks of size 2^( 7) =       0.000476103830

      target function =                  N/A
              le_mean =     -16.905859626781
             les_mean =     286.147445774222
             stat err =       0.000465585756
             autocorr =       1.277537181559
              std dev =       0.582542894106
             le_variance =       0.339356223473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190439
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190439
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411920031
  error estimate for blocks of size 2^( 2) =       0.000425332664
  error estimate for blocks of size 2^( 3) =       0.000439052363
  error estimate for blocks of size 2^( 4) =       0.000451813028
  error estimate for blocks of size 2^( 5) =       0.000462851213
  error estimate for blocks of size 2^( 6) =       0.000471574955
  error estimate for blocks of size 2^( 7) =       0.000476103830

      target function =                  N/A
              le_mean =     -16.905859626782
             les_mean =     286.147445774168
             stat err =       0.000465585756
             autocorr =       1.277537181554
              std dev =       0.582542894047
             le_variance =       0.339356223405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190473
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190473
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411920031
  error estimate for blocks of size 2^( 2) =       0.000425332664
  error estimate for blocks of size 2^( 3) =       0.000439052363
  error estimate for blocks of size 2^( 4) =       0.000451813028
  error estimate for blocks of size 2^( 5) =       0.000462851213
  error estimate for blocks of size 2^( 6) =       0.000471574955
  error estimate for blocks of size 2^( 7) =       0.000476103830

      target function =                  N/A
              le_mean =     -16.905859626781
             les_mean =     286.147445774195
             stat err =       0.000465585756
             autocorr =       1.277537181557
              std dev =       0.582542894076
             le_variance =       0.339356223439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190503
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339400190503
                                         uncertainty =       0.003614852691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411920031
  error estimate for blocks of size 2^( 2) =       0.000425332664
  error estimate for blocks of size 2^( 3) =       0.000439052363
  error estimate for blocks of size 2^( 4) =       0.000451813028
  error estimate for blocks of size 2^( 5) =       0.000462851213
  error estimate for blocks of size 2^( 6) =       0.000471574955
  error estimate for blocks of size 2^( 7) =       0.000476103830

      target function =                  N/A
              le_mean =     -16.905859626781
             les_mean =     286.147445774219
             stat err =       0.000465585756
             autocorr =       1.277537181554
              std dev =       0.582542894102
             le_variance =       0.339356223469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905859626781        initial
     2.4414e+05     2.4414e+06             1.0338e-09       -16.905859626782  <--
     9.7656e+05     9.7656e+06             2.5844e-10       -16.905859626781
     3.9062e+06     3.9062e+07             6.4610e-11       -16.905859626781

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 3.0202e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9455
    reference variance = 0.196583
====================================================
  Execution time = 2.0718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4299e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342328595507
                                         uncertainty =       0.004887280387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342328595507
                                         uncertainty =       0.004887280387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414119326
  error estimate for blocks of size 2^( 2) =       0.000426983631
  error estimate for blocks of size 2^( 3) =       0.000439769977
  error estimate for blocks of size 2^( 4) =       0.000451104176
  error estimate for blocks of size 2^( 5) =       0.000459674743
  error estimate for blocks of size 2^( 6) =       0.000466850303
  error estimate for blocks of size 2^( 7) =       0.000471159896

      target function =                  N/A
              le_mean =     -16.906384982318
             les_mean =     286.168842631714
             stat err =       0.000462197279
             autocorr =       1.245672197788
              std dev =       0.585653167735
             le_variance =       0.342989632878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638498232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384982318       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384982316       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384982308       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384982302       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384982306       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384982306       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384982281       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384982258       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.392975e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384982318       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384982317       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384982315       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384982192       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384982310       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384982237       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384982349       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384982305       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 8.482439e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384982318       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384982317       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384982317       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384982129       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384982147       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384982572       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384982096       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384982307       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.120610e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6354e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185249e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.169476
====================================================
  Execution time = 2.0012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4330e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697256
                                         uncertainty =       0.004567584453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697256
                                         uncertainty =       0.004567584453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414305439
  error estimate for blocks of size 2^( 2) =       0.000426809183
  error estimate for blocks of size 2^( 3) =       0.000439814995
  error estimate for blocks of size 2^( 4) =       0.000451249242
  error estimate for blocks of size 2^( 5) =       0.000461074628
  error estimate for blocks of size 2^( 6) =       0.000468088655
  error estimate for blocks of size 2^( 7) =       0.000471463821

      target function =                  N/A
              le_mean =     -16.906170410959
             les_mean =     286.161895786330
             stat err =       0.000462969087
             autocorr =       1.248713241219
              std dev =       0.585916370832
             le_variance =       0.343297993609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202698151
                                         uncertainty =       0.004567584473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202698151
                                         uncertainty =       0.004567584473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414305440
  error estimate for blocks of size 2^( 2) =       0.000426809183
  error estimate for blocks of size 2^( 3) =       0.000439814995
  error estimate for blocks of size 2^( 4) =       0.000451249243
  error estimate for blocks of size 2^( 5) =       0.000461074629
  error estimate for blocks of size 2^( 6) =       0.000468088655
  error estimate for blocks of size 2^( 7) =       0.000471463821

      target function =                  N/A
              le_mean =     -16.906170410945
             les_mean =     286.161895786773
             stat err =       0.000462969087
             autocorr =       1.248713240468
              std dev =       0.585916371596
             le_variance =       0.343297994504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697703
                                         uncertainty =       0.004567584463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697703
                                         uncertainty =       0.004567584463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414305439
  error estimate for blocks of size 2^( 2) =       0.000426809183
  error estimate for blocks of size 2^( 3) =       0.000439814995
  error estimate for blocks of size 2^( 4) =       0.000451249243
  error estimate for blocks of size 2^( 5) =       0.000461074629
  error estimate for blocks of size 2^( 6) =       0.000468088655
  error estimate for blocks of size 2^( 7) =       0.000471463821

      target function =                  N/A
              le_mean =     -16.906170410952
             les_mean =     286.161895786552
             stat err =       0.000462969087
             autocorr =       1.248713240852
              std dev =       0.585916371214
             le_variance =       0.343297994057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697312
                                         uncertainty =       0.004567584455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343202697312
                                         uncertainty =       0.004567584455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414305439
  error estimate for blocks of size 2^( 2) =       0.000426809183
  error estimate for blocks of size 2^( 3) =       0.000439814995
  error estimate for blocks of size 2^( 4) =       0.000451249242
  error estimate for blocks of size 2^( 5) =       0.000461074628
  error estimate for blocks of size 2^( 6) =       0.000468088655
  error estimate for blocks of size 2^( 7) =       0.000471463821

      target function =                  N/A
              le_mean =     -16.906170410958
             les_mean =     286.161895786358
             stat err =       0.000462969087
             autocorr =       1.248713241164
              std dev =       0.585916370880
             le_variance =       0.343297993665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906170410959        initial  <--
     6.1035e+04     6.1035e+05             3.3930e-09       -16.906170410945
     2.4414e+05     2.4414e+06             8.4824e-10       -16.906170410952
     9.7656e+05     9.7656e+06             2.1206e-10       -16.906170410958

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4730
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8204
    reference variance = 0.179014
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342257029934
                                         uncertainty =       0.004233313314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342257029934
                                         uncertainty =       0.004233313314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414198425
  error estimate for blocks of size 2^( 2) =       0.000427271361
  error estimate for blocks of size 2^( 3) =       0.000440146095
  error estimate for blocks of size 2^( 4) =       0.000452735406
  error estimate for blocks of size 2^( 5) =       0.000463872933
  error estimate for blocks of size 2^( 6) =       0.000470748339
  error estimate for blocks of size 2^( 7) =       0.000476771087

      target function =                  N/A
              le_mean =     -16.905788223042
             les_mean =     286.148795941960
             stat err =       0.000466031941
             autocorr =       1.265943957864
              std dev =       0.585765030700
             le_variance =       0.343120671191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578822304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788223042       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788223041       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788223042       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788222671       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788223067       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788223174       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788223388       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788223031       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.228939e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788223042       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788223041       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788223042       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788223042       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788222428       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788223041       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788223191       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788224050       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.057234e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788223042       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788223041       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788223042       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788220213       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788222674       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788216880       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788219243       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788207599       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.643076e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8238
    reference variance = 0.212704
====================================================
  Execution time = 2.0159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4569e-01
  Total weights = 2.0000e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351919
                                         uncertainty =       0.005243991800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351919
                                         uncertainty =       0.005243991800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415747821
  error estimate for blocks of size 2^( 2) =       0.000428541385
  error estimate for blocks of size 2^( 3) =       0.000441603462
  error estimate for blocks of size 2^( 4) =       0.000453745732
  error estimate for blocks of size 2^( 5) =       0.000464263790
  error estimate for blocks of size 2^( 6) =       0.000473761523
  error estimate for blocks of size 2^( 7) =       0.000480321146

      target function =                  N/A
              le_mean =     -16.904799648874
             les_mean =     286.117943496684
             stat err =       0.000468023048
             autocorr =       1.267285651201
              std dev =       0.587956206674
             le_variance =       0.345692500966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793352071
                                         uncertainty =       0.005243991802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793352071
                                         uncertainty =       0.005243991802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415747821
  error estimate for blocks of size 2^( 2) =       0.000428541385
  error estimate for blocks of size 2^( 3) =       0.000441603462
  error estimate for blocks of size 2^( 4) =       0.000453745732
  error estimate for blocks of size 2^( 5) =       0.000464263790
  error estimate for blocks of size 2^( 6) =       0.000473761523
  error estimate for blocks of size 2^( 7) =       0.000480321146

      target function =                  N/A
              le_mean =     -16.904799648875
             les_mean =     286.117943496886
             stat err =       0.000468023048
             autocorr =       1.267285651061
              std dev =       0.587956206803
             le_variance =       0.345692501118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351995
                                         uncertainty =       0.005243991801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351995
                                         uncertainty =       0.005243991801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415747821
  error estimate for blocks of size 2^( 2) =       0.000428541385
  error estimate for blocks of size 2^( 3) =       0.000441603462
  error estimate for blocks of size 2^( 4) =       0.000453745732
  error estimate for blocks of size 2^( 5) =       0.000464263790
  error estimate for blocks of size 2^( 6) =       0.000473761523
  error estimate for blocks of size 2^( 7) =       0.000480321146

      target function =                  N/A
              le_mean =     -16.904799648875
             les_mean =     286.117943496785
             stat err =       0.000468023048
             autocorr =       1.267285651121
              std dev =       0.587956206738
             le_variance =       0.345692501042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351928
                                         uncertainty =       0.005243991800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345793351928
                                         uncertainty =       0.005243991800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415747821
  error estimate for blocks of size 2^( 2) =       0.000428541385
  error estimate for blocks of size 2^( 3) =       0.000441603462
  error estimate for blocks of size 2^( 4) =       0.000453745732
  error estimate for blocks of size 2^( 5) =       0.000464263790
  error estimate for blocks of size 2^( 6) =       0.000473761523
  error estimate for blocks of size 2^( 7) =       0.000480321146

      target function =                  N/A
              le_mean =     -16.904799648874
             les_mean =     286.117943496697
             stat err =       0.000468023048
             autocorr =       1.267285651188
              std dev =       0.587956206682
             le_variance =       0.345692500976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904799648874        initial
     6.1035e+05     6.1035e+06             4.2289e-10       -16.904799648875  <--
     2.4414e+06     2.4414e+07             1.0572e-10       -16.904799648875
     9.7656e+06     9.7656e+07             2.6431e-11       -16.904799648874

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 2.9653e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8096
    reference variance = 0.201201
====================================================
  Execution time = 2.0723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241319674
                                         uncertainty =       0.002763912457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241319674
                                         uncertainty =       0.002763912457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409142630
  error estimate for blocks of size 2^( 2) =       0.000421839657
  error estimate for blocks of size 2^( 3) =       0.000435297809
  error estimate for blocks of size 2^( 4) =       0.000448097412
  error estimate for blocks of size 2^( 5) =       0.000457184604
  error estimate for blocks of size 2^( 6) =       0.000465035305
  error estimate for blocks of size 2^( 7) =       0.000467989952

      target function =                  N/A
              le_mean =     -16.906002822165
             les_mean =     286.147726639227
             stat err =       0.000459576818
             autocorr =       1.261730968335
              std dev =       0.578615056479
             le_variance =       0.334795383584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600282216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002822165       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002822163       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002822162       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002822160       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002822181       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002822165       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002822255       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002822163       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.241117e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002822165       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002822164       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002822164       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002822459       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002822165       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002821997       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002822001       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002821833       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.102793e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002822165       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002822165       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002822165       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002821524       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002820873       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002822539       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002822068       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002823680       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 7.756978e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6238e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764478e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102403e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9397
    reference variance = 0.198399
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5206e-01
  Total weights = 2.0000e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635235
                                         uncertainty =       0.020927678533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635235
                                         uncertainty =       0.020927678533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419561085
  error estimate for blocks of size 2^( 2) =       0.000432355557
  error estimate for blocks of size 2^( 3) =       0.000445430291
  error estimate for blocks of size 2^( 4) =       0.000457456030
  error estimate for blocks of size 2^( 5) =       0.000468413296
  error estimate for blocks of size 2^( 6) =       0.000476954428
  error estimate for blocks of size 2^( 7) =       0.000483755017

      target function =                  N/A
              le_mean =     -16.905238458315
             les_mean =     286.139150164206
             stat err =       0.000471644693
             autocorr =       1.263686960647
              std dev =       0.593348976366
             le_variance =       0.352063007754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052634774
                                         uncertainty =       0.020927678451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052634774
                                         uncertainty =       0.020927678451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419561085
  error estimate for blocks of size 2^( 2) =       0.000432355556
  error estimate for blocks of size 2^( 3) =       0.000445430291
  error estimate for blocks of size 2^( 4) =       0.000457456029
  error estimate for blocks of size 2^( 5) =       0.000468413296
  error estimate for blocks of size 2^( 6) =       0.000476954428
  error estimate for blocks of size 2^( 7) =       0.000483755017

      target function =                  N/A
              le_mean =     -16.905238458320
             les_mean =     286.139150163933
             stat err =       0.000471644692
             autocorr =       1.263686961085
              std dev =       0.593348975977
             le_variance =       0.352063007293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635004
                                         uncertainty =       0.020927678492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635004
                                         uncertainty =       0.020927678492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419561085
  error estimate for blocks of size 2^( 2) =       0.000432355556
  error estimate for blocks of size 2^( 3) =       0.000445430291
  error estimate for blocks of size 2^( 4) =       0.000457456029
  error estimate for blocks of size 2^( 5) =       0.000468413296
  error estimate for blocks of size 2^( 6) =       0.000476954428
  error estimate for blocks of size 2^( 7) =       0.000483755017

      target function =                  N/A
              le_mean =     -16.905238458318
             les_mean =     286.139150164069
             stat err =       0.000471644693
             autocorr =       1.263686960872
              std dev =       0.593348976171
             le_variance =       0.352063007524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635206
                                         uncertainty =       0.020927678528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352052635206
                                         uncertainty =       0.020927678528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419561085
  error estimate for blocks of size 2^( 2) =       0.000432355557
  error estimate for blocks of size 2^( 3) =       0.000445430291
  error estimate for blocks of size 2^( 4) =       0.000457456030
  error estimate for blocks of size 2^( 5) =       0.000468413296
  error estimate for blocks of size 2^( 6) =       0.000476954428
  error estimate for blocks of size 2^( 7) =       0.000483755017

      target function =                  N/A
              le_mean =     -16.905238458315
             les_mean =     286.139150164189
             stat err =       0.000471644693
             autocorr =       1.263686960665
              std dev =       0.593348976342
             le_variance =       0.352063007726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905238458315        initial
     1.5259e+05     1.5259e+06             1.2411e-09       -16.905238458320  <--
     6.1035e+05     6.1035e+06             3.1028e-10       -16.905238458318
     2.4414e+06     2.4414e+07             7.7570e-11       -16.905238458315

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 2.9863e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8669
    reference variance = 0.215448
====================================================
  Execution time = 2.0604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4787e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347927446564
                                         uncertainty =       0.004903085204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347927446564
                                         uncertainty =       0.004903085204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417055180
  error estimate for blocks of size 2^( 2) =       0.000429370065
  error estimate for blocks of size 2^( 3) =       0.000442458390
  error estimate for blocks of size 2^( 4) =       0.000455382127
  error estimate for blocks of size 2^( 5) =       0.000465523215
  error estimate for blocks of size 2^( 6) =       0.000472675987
  error estimate for blocks of size 2^( 7) =       0.000474664507

      target function =                  N/A
              le_mean =     -16.905405477497
             les_mean =     286.140604231548
             stat err =       0.000467061459
             autocorr =       1.254183327149
              std dev =       0.589805092299
             le_variance =       0.347870046902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540547750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905405477497       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405477524       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405477542       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405477495       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405477533       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905405477551       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405477533       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405477546       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.128268e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905405477497       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405477504       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405477508       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405477440       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405477507       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905405477441       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405477447       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405477508       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.532070e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905405477497       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405477499       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405477500       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405477499       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405477557       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905405478177       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405477482       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405477102       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.830174e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6230e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172729e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690899e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.277026
====================================================
  Execution time = 2.2319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4741e-01
  Total weights = 2.0000e+06
  Execution time = 1.8688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364965423
                                         uncertainty =       0.004766091825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364965423
                                         uncertainty =       0.004766091825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416779413
  error estimate for blocks of size 2^( 2) =       0.000429851944
  error estimate for blocks of size 2^( 3) =       0.000442564354
  error estimate for blocks of size 2^( 4) =       0.000454628532
  error estimate for blocks of size 2^( 5) =       0.000464657354
  error estimate for blocks of size 2^( 6) =       0.000472295524
  error estimate for blocks of size 2^( 7) =       0.000477848145

      target function =                  N/A
              le_mean =     -16.905769621183
             les_mean =     286.152456468557
             stat err =       0.000467357389
             autocorr =       1.257435478677
              std dev =       0.589415097989
             le_variance =       0.347410157738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364969117
                                         uncertainty =       0.004766091774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364969117
                                         uncertainty =       0.004766091774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416779415
  error estimate for blocks of size 2^( 2) =       0.000429851946
  error estimate for blocks of size 2^( 3) =       0.000442564356
  error estimate for blocks of size 2^( 4) =       0.000454628534
  error estimate for blocks of size 2^( 5) =       0.000464657356
  error estimate for blocks of size 2^( 6) =       0.000472295526
  error estimate for blocks of size 2^( 7) =       0.000477848147

      target function =                  N/A
              le_mean =     -16.905769621170
             les_mean =     286.152456471794
             stat err =       0.000467357391
             autocorr =       1.257435476702
              std dev =       0.589415101123
             le_variance =       0.347410161432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364967270
                                         uncertainty =       0.004766091800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364967270
                                         uncertainty =       0.004766091800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416779414
  error estimate for blocks of size 2^( 2) =       0.000429851945
  error estimate for blocks of size 2^( 3) =       0.000442564355
  error estimate for blocks of size 2^( 4) =       0.000454628533
  error estimate for blocks of size 2^( 5) =       0.000464657355
  error estimate for blocks of size 2^( 6) =       0.000472295525
  error estimate for blocks of size 2^( 7) =       0.000477848146

      target function =                  N/A
              le_mean =     -16.905769621177
             les_mean =     286.152456470176
             stat err =       0.000467357390
             autocorr =       1.257435477692
              std dev =       0.589415099556
             le_variance =       0.347410159585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364965654
                                         uncertainty =       0.004766091822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347364965654
                                         uncertainty =       0.004766091822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416779413
  error estimate for blocks of size 2^( 2) =       0.000429851944
  error estimate for blocks of size 2^( 3) =       0.000442564354
  error estimate for blocks of size 2^( 4) =       0.000454628532
  error estimate for blocks of size 2^( 5) =       0.000464657354
  error estimate for blocks of size 2^( 6) =       0.000472295524
  error estimate for blocks of size 2^( 7) =       0.000477848145

      target function =                  N/A
              le_mean =     -16.905769621182
             les_mean =     286.152456468760
             stat err =       0.000467357389
             autocorr =       1.257435478553
              std dev =       0.589415098185
             le_variance =       0.347410157969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905769621183        initial  <--
     3.8147e+04     3.8147e+05             6.1283e-09       -16.905769621170
     1.5259e+05     1.5259e+06             1.5321e-09       -16.905769621177
     6.1035e+05     6.1035e+06             3.8302e-10       -16.905769621182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7826
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8608
    reference variance = 0.389476
====================================================
  Execution time = 2.0666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334358911901
                                         uncertainty =       0.004090096715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334358911901
                                         uncertainty =       0.004090096715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408827770
  error estimate for blocks of size 2^( 2) =       0.000421769258
  error estimate for blocks of size 2^( 3) =       0.000434845233
  error estimate for blocks of size 2^( 4) =       0.000447551254
  error estimate for blocks of size 2^( 5) =       0.000458637436
  error estimate for blocks of size 2^( 6) =       0.000466568610
  error estimate for blocks of size 2^( 7) =       0.000472172347

      target function =                  N/A
              le_mean =     -16.905524416716
             les_mean =     286.131035927850
             stat err =       0.000461232412
             autocorr =       1.272796174420
              std dev =       0.578169776808
             le_variance =       0.334280290814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690552441672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524416716       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524416716       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524416714       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524416718       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524416692       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524416665       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524416850       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524416912       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.571978e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524416716       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524416716       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524416715       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524416715       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524416715       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524417097       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524417044       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524416738       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.392995e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524416716       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524416716       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524416716       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524416716       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524415428       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524417941       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524415822       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524418022       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.482483e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6200e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8896
    reference variance = 0.473093
====================================================
  Execution time = 2.0265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4033e-01
  Total weights = 2.0000e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354086
                                         uncertainty =       0.004671272036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354086
                                         uncertainty =       0.004671272036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412511687
  error estimate for blocks of size 2^( 2) =       0.000425480337
  error estimate for blocks of size 2^( 3) =       0.000439003907
  error estimate for blocks of size 2^( 4) =       0.000451884293
  error estimate for blocks of size 2^( 5) =       0.000462986450
  error estimate for blocks of size 2^( 6) =       0.000470765001
  error estimate for blocks of size 2^( 7) =       0.000477650667

      target function =                  N/A
              le_mean =     -16.905308702717
             les_mean =     286.129793947080
             stat err =       0.000465821603
             autocorr =       1.275166037292
              std dev =       0.583379621749
             le_variance =       0.340331783072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354359
                                         uncertainty =       0.004671272040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354359
                                         uncertainty =       0.004671272040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412511687
  error estimate for blocks of size 2^( 2) =       0.000425480337
  error estimate for blocks of size 2^( 3) =       0.000439003907
  error estimate for blocks of size 2^( 4) =       0.000451884293
  error estimate for blocks of size 2^( 5) =       0.000462986450
  error estimate for blocks of size 2^( 6) =       0.000470765001
  error estimate for blocks of size 2^( 7) =       0.000477650667

      target function =                  N/A
              le_mean =     -16.905308702716
             les_mean =     286.129793947313
             stat err =       0.000465821603
             autocorr =       1.275166036881
              std dev =       0.583379621983
             le_variance =       0.340331783345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354222
                                         uncertainty =       0.004671272038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354222
                                         uncertainty =       0.004671272038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412511687
  error estimate for blocks of size 2^( 2) =       0.000425480337
  error estimate for blocks of size 2^( 3) =       0.000439003907
  error estimate for blocks of size 2^( 4) =       0.000451884293
  error estimate for blocks of size 2^( 5) =       0.000462986450
  error estimate for blocks of size 2^( 6) =       0.000470765001
  error estimate for blocks of size 2^( 7) =       0.000477650667

      target function =                  N/A
              le_mean =     -16.905308702717
             les_mean =     286.129793947197
             stat err =       0.000465821603
             autocorr =       1.275166037083
              std dev =       0.583379621866
             le_variance =       0.340331783209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354103
                                         uncertainty =       0.004671272036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380354103
                                         uncertainty =       0.004671272036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412511687
  error estimate for blocks of size 2^( 2) =       0.000425480337
  error estimate for blocks of size 2^( 3) =       0.000439003907
  error estimate for blocks of size 2^( 4) =       0.000451884293
  error estimate for blocks of size 2^( 5) =       0.000462986450
  error estimate for blocks of size 2^( 6) =       0.000470765001
  error estimate for blocks of size 2^( 7) =       0.000477650667

      target function =                  N/A
              le_mean =     -16.905308702717
             les_mean =     286.129793947095
             stat err =       0.000465821603
             autocorr =       1.275166037271
              std dev =       0.583379621764
             le_variance =       0.340331783089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905308702717        initial  <--
     3.8147e+05     3.8147e+06             5.5720e-10       -16.905308702716
     1.5259e+06     1.5259e+07             1.3930e-10       -16.905308702717
     6.1035e+06     6.1035e+07             3.4825e-11       -16.905308702717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7454
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9281
    reference variance = 0.155037
====================================================
  Execution time = 2.1026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339447639885
                                         uncertainty =       0.003459424552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339447639885
                                         uncertainty =       0.003459424552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411962579
  error estimate for blocks of size 2^( 2) =       0.000424422124
  error estimate for blocks of size 2^( 3) =       0.000436766845
  error estimate for blocks of size 2^( 4) =       0.000448173547
  error estimate for blocks of size 2^( 5) =       0.000456918246
  error estimate for blocks of size 2^( 6) =       0.000464638455
  error estimate for blocks of size 2^( 7) =       0.000468064980

      target function =                  N/A
              le_mean =     -16.906328606249
             les_mean =     286.163373104988
             stat err =       0.000459448807
             autocorr =       1.243823393321
              std dev =       0.582603065751
             le_variance =       0.339426332222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632860625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328606249       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906328606249       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906328606249       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906328606249       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906328606249       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906328606056       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906328607605       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328603831       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.097586e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328606249       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906328606249       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906328606249       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906328606249       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906328606960       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906328603013       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906328600240       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328621077       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.774438e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328606249       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906328606249       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906328606249       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906328591006       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906328533501       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906328628787       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906328672654       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328642145       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 4.434935e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6545e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.215806
====================================================
  Execution time = 2.0708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4348e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224685
                                         uncertainty =       0.008582671301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224685
                                         uncertainty =       0.008582671301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414413263
  error estimate for blocks of size 2^( 2) =       0.000426990149
  error estimate for blocks of size 2^( 3) =       0.000439561233
  error estimate for blocks of size 2^( 4) =       0.000452016012
  error estimate for blocks of size 2^( 5) =       0.000463665817
  error estimate for blocks of size 2^( 6) =       0.000473012302
  error estimate for blocks of size 2^( 7) =       0.000477001897

      target function =                  N/A
              le_mean =     -16.906605978190
             les_mean =     286.176802234454
             stat err =       0.000466424007
             autocorr =       1.266760463111
              std dev =       0.586068856397
             le_variance =       0.343476704439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224668
                                         uncertainty =       0.008582671300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224668
                                         uncertainty =       0.008582671300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414413263
  error estimate for blocks of size 2^( 2) =       0.000426990149
  error estimate for blocks of size 2^( 3) =       0.000439561232
  error estimate for blocks of size 2^( 4) =       0.000452016012
  error estimate for blocks of size 2^( 5) =       0.000463665817
  error estimate for blocks of size 2^( 6) =       0.000473012302
  error estimate for blocks of size 2^( 7) =       0.000477001897

      target function =                  N/A
              le_mean =     -16.906605978190
             les_mean =     286.176802234444
             stat err =       0.000466424007
             autocorr =       1.266760463125
              std dev =       0.586068856382
             le_variance =       0.343476704421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224676
                                         uncertainty =       0.008582671300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224676
                                         uncertainty =       0.008582671300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414413263
  error estimate for blocks of size 2^( 2) =       0.000426990149
  error estimate for blocks of size 2^( 3) =       0.000439561232
  error estimate for blocks of size 2^( 4) =       0.000452016012
  error estimate for blocks of size 2^( 5) =       0.000463665817
  error estimate for blocks of size 2^( 6) =       0.000473012302
  error estimate for blocks of size 2^( 7) =       0.000477001897

      target function =                  N/A
              le_mean =     -16.906605978190
             les_mean =     286.176802234449
             stat err =       0.000466424007
             autocorr =       1.266760463109
              std dev =       0.586068856390
             le_variance =       0.343476704430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224684
                                         uncertainty =       0.008582671301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343552224684
                                         uncertainty =       0.008582671301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414413263
  error estimate for blocks of size 2^( 2) =       0.000426990149
  error estimate for blocks of size 2^( 3) =       0.000439561233
  error estimate for blocks of size 2^( 4) =       0.000452016012
  error estimate for blocks of size 2^( 5) =       0.000463665817
  error estimate for blocks of size 2^( 6) =       0.000473012302
  error estimate for blocks of size 2^( 7) =       0.000477001897

      target function =                  N/A
              le_mean =     -16.906605978190
             les_mean =     286.176802234454
             stat err =       0.000466424007
             autocorr =       1.266760463113
              std dev =       0.586068856396
             le_variance =       0.343476704438


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906605978190        initial
     3.8147e+06     3.8147e+07             7.0976e-11       -16.906605978190  <--
     1.5259e+07     1.5259e+08             1.7744e-11       -16.906605978190
     6.1035e+07     6.1035e+08             4.4349e-12       -16.906605978190

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 3.0159e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9603
    reference variance = 0.253932
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336394918605
                                         uncertainty =       0.003082252928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336394918605
                                         uncertainty =       0.003082252928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410088273
  error estimate for blocks of size 2^( 2) =       0.000422925330
  error estimate for blocks of size 2^( 3) =       0.000435925658
  error estimate for blocks of size 2^( 4) =       0.000448132378
  error estimate for blocks of size 2^( 5) =       0.000458472323
  error estimate for blocks of size 2^( 6) =       0.000465155425
  error estimate for blocks of size 2^( 7) =       0.000468086769

      target function =                  N/A
              le_mean =     -16.906094800550
             les_mean =     286.152386020079
             stat err =       0.000459961724
             autocorr =       1.258023303103
              std dev =       0.579952397229
             le_variance =       0.336344783052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609480055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094800550       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094800551       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094800552       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094800551       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094801003       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094799947       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094800594       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094800638       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.047096e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094800550       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094800551       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094800551       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094800288       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094800665       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094803887       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094798232       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094795845       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 5.117744e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094800550       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094800551       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094800551       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094802610       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094800551       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094798447       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094803670       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094793579       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.279428e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5881e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8203
    reference variance = 0.497686
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3545e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451563
                                         uncertainty =       0.003752470143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451563
                                         uncertainty =       0.003752470143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409541754
  error estimate for blocks of size 2^( 2) =       0.000422195439
  error estimate for blocks of size 2^( 3) =       0.000435034773
  error estimate for blocks of size 2^( 4) =       0.000447122558
  error estimate for blocks of size 2^( 5) =       0.000455834208
  error estimate for blocks of size 2^( 6) =       0.000461822858
  error estimate for blocks of size 2^( 7) =       0.000468914963

      target function =                  N/A
              le_mean =     -16.905200683505
             les_mean =     286.121258879199
             stat err =       0.000458423647
             autocorr =       1.252961281141
              std dev =       0.579179503558
             le_variance =       0.335448897342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451707
                                         uncertainty =       0.003752470147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451707
                                         uncertainty =       0.003752470147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409541755
  error estimate for blocks of size 2^( 2) =       0.000422195439
  error estimate for blocks of size 2^( 3) =       0.000435034773
  error estimate for blocks of size 2^( 4) =       0.000447122558
  error estimate for blocks of size 2^( 5) =       0.000455834208
  error estimate for blocks of size 2^( 6) =       0.000461822858
  error estimate for blocks of size 2^( 7) =       0.000468914963

      target function =                  N/A
              le_mean =     -16.905200683504
             les_mean =     286.121258879301
             stat err =       0.000458423647
             autocorr =       1.252961281018
              std dev =       0.579179503682
             le_variance =       0.335448897485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451635
                                         uncertainty =       0.003752470145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451635
                                         uncertainty =       0.003752470145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409541755
  error estimate for blocks of size 2^( 2) =       0.000422195439
  error estimate for blocks of size 2^( 3) =       0.000435034773
  error estimate for blocks of size 2^( 4) =       0.000447122558
  error estimate for blocks of size 2^( 5) =       0.000455834208
  error estimate for blocks of size 2^( 6) =       0.000461822858
  error estimate for blocks of size 2^( 7) =       0.000468914963

      target function =                  N/A
              le_mean =     -16.905200683504
             les_mean =     286.121258879250
             stat err =       0.000458423647
             autocorr =       1.252961281080
              std dev =       0.579179503620
             le_variance =       0.335448897414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451572
                                         uncertainty =       0.003752470143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301451572
                                         uncertainty =       0.003752470143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409541754
  error estimate for blocks of size 2^( 2) =       0.000422195439
  error estimate for blocks of size 2^( 3) =       0.000435034773
  error estimate for blocks of size 2^( 4) =       0.000447122558
  error estimate for blocks of size 2^( 5) =       0.000455834208
  error estimate for blocks of size 2^( 6) =       0.000461822858
  error estimate for blocks of size 2^( 7) =       0.000468914963

      target function =                  N/A
              le_mean =     -16.905200683505
             les_mean =     286.121258879205
             stat err =       0.000458423647
             autocorr =       1.252961281131
              std dev =       0.579179503566
             le_variance =       0.335448897351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905200683505        initial  <--
     9.5367e+05     9.5367e+06             2.0471e-10       -16.905200683504
     3.8147e+06     3.8147e+07             5.1177e-11       -16.905200683504
     1.5259e+07     1.5259e+08             1.2794e-11       -16.905200683505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1314
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6143e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8286
    reference variance = 0.273965
====================================================
  Execution time = 2.0740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4018e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340190195612
                                         uncertainty =       0.004144340785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340190195612
                                         uncertainty =       0.004144340785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421451
  error estimate for blocks of size 2^( 2) =       0.000425495151
  error estimate for blocks of size 2^( 3) =       0.000438965970
  error estimate for blocks of size 2^( 4) =       0.000451196639
  error estimate for blocks of size 2^( 5) =       0.000462724909
  error estimate for blocks of size 2^( 6) =       0.000471618773
  error estimate for blocks of size 2^( 7) =       0.000475683277

      target function =                  N/A
              le_mean =     -16.906793662049
             les_mean =     286.179854666883
             stat err =       0.000465305900
             autocorr =       1.272900997500
              std dev =       0.583252008895
             le_variance =       0.340182905880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679366205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906793662049       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906793662049       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906793662049       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906793659577       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906793657640       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906793666389       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906793662066       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906793662163       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.144687e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906793662049       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906793662049       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906793662049       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906793662049       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906793662049       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906793672889       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906793664956       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906793666772       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.361667e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906793662049       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906793662049       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906793662049       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906793662049       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906793751784       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906793933769       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906793575060       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906793573930       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.340282e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6284e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9561
    reference variance = 0.34643
====================================================
  Execution time = 2.0189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3907e-01
  Total weights = 2.0000e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681420
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681420
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411746238
  error estimate for blocks of size 2^( 2) =       0.000425020408
  error estimate for blocks of size 2^( 3) =       0.000438547996
  error estimate for blocks of size 2^( 4) =       0.000451814553
  error estimate for blocks of size 2^( 5) =       0.000464058689
  error estimate for blocks of size 2^( 6) =       0.000475698557
  error estimate for blocks of size 2^( 7) =       0.000482772393

      target function =                  N/A
              le_mean =     -16.905665443018
             les_mean =     286.140593831196
             stat err =       0.000468586048
             autocorr =       1.295148081168
              std dev =       0.582297114433
             le_variance =       0.339069929477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681409
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681409
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411746238
  error estimate for blocks of size 2^( 2) =       0.000425020408
  error estimate for blocks of size 2^( 3) =       0.000438547996
  error estimate for blocks of size 2^( 4) =       0.000451814552
  error estimate for blocks of size 2^( 5) =       0.000464058689
  error estimate for blocks of size 2^( 6) =       0.000475698557
  error estimate for blocks of size 2^( 7) =       0.000482772393

      target function =                  N/A
              le_mean =     -16.905665443018
             les_mean =     286.140593831179
             stat err =       0.000468586048
             autocorr =       1.295148081174
              std dev =       0.582297114423
             le_variance =       0.339069929466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681414
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681414
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411746238
  error estimate for blocks of size 2^( 2) =       0.000425020408
  error estimate for blocks of size 2^( 3) =       0.000438547996
  error estimate for blocks of size 2^( 4) =       0.000451814552
  error estimate for blocks of size 2^( 5) =       0.000464058689
  error estimate for blocks of size 2^( 6) =       0.000475698557
  error estimate for blocks of size 2^( 7) =       0.000482772393

      target function =                  N/A
              le_mean =     -16.905665443018
             les_mean =     286.140593831187
             stat err =       0.000468586048
             autocorr =       1.295148081175
              std dev =       0.582297114428
             le_variance =       0.339069929471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681419
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339152681419
                                         uncertainty =       0.003187868795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411746238
  error estimate for blocks of size 2^( 2) =       0.000425020408
  error estimate for blocks of size 2^( 3) =       0.000438547996
  error estimate for blocks of size 2^( 4) =       0.000451814553
  error estimate for blocks of size 2^( 5) =       0.000464058689
  error estimate for blocks of size 2^( 6) =       0.000475698557
  error estimate for blocks of size 2^( 7) =       0.000482772393

      target function =                  N/A
              le_mean =     -16.905665443018
             les_mean =     286.140593831195
             stat err =       0.000468586048
             autocorr =       1.295148081169
              std dev =       0.582297114432
             le_variance =       0.339069929476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905665443018        initial  <--
     9.5367e+06     9.5367e+07             2.1447e-11       -16.905665443018
     3.8147e+07     3.8147e+08             5.3617e-12       -16.905665443018
     1.5259e+08     1.5259e+09             1.3403e-12       -16.905665443018

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6729
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9072
    reference variance = 0.204482
====================================================
  Execution time = 2.0490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3664e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336622021582
                                         uncertainty =       0.002469947693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336622021582
                                         uncertainty =       0.002469947693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410269674
  error estimate for blocks of size 2^( 2) =       0.000423400715
  error estimate for blocks of size 2^( 3) =       0.000437667780
  error estimate for blocks of size 2^( 4) =       0.000451238085
  error estimate for blocks of size 2^( 5) =       0.000463039046
  error estimate for blocks of size 2^( 6) =       0.000474070841
  error estimate for blocks of size 2^( 7) =       0.000479052261

      target function =                  N/A
              le_mean =     -16.906353254182
             les_mean =     286.161422598109
             stat err =       0.000466850058
             autocorr =       1.294839684546
              std dev =       0.580208937579
             le_variance =       0.336642411247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635325418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353254182       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906353254182       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906353254182       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906353328571       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906353158240       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906353271343       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353144759       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353249895       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.734719e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353254182       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906353254182       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906353254182       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906353317602       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906353315925       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906353275181       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353820511       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353258642       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.841662e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353254182       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906353254182       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906353254182       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906353254182       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906353121900       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906352029891       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906355112893       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906352390617       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.711621e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6043e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9176
    reference variance = 0.236796
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3927e-01
  Total weights = 2.0000e+06
  Execution time = 2.2213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864895
  error estimate for blocks of size 2^( 2) =       0.000425015551
  error estimate for blocks of size 2^( 3) =       0.000438551442
  error estimate for blocks of size 2^( 4) =       0.000450922473
  error estimate for blocks of size 2^( 5) =       0.000462196260
  error estimate for blocks of size 2^( 6) =       0.000469444674
  error estimate for blocks of size 2^( 7) =       0.000477779823

      target function =                  N/A
              le_mean =     -16.906021377219
             les_mean =     286.152824020685
             stat err =       0.000465085807
             autocorr =       1.275136332134
              std dev =       0.582464920249
             le_variance =       0.339265383321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864895
  error estimate for blocks of size 2^( 2) =       0.000425015551
  error estimate for blocks of size 2^( 3) =       0.000438551442
  error estimate for blocks of size 2^( 4) =       0.000450922473
  error estimate for blocks of size 2^( 5) =       0.000462196260
  error estimate for blocks of size 2^( 6) =       0.000469444674
  error estimate for blocks of size 2^( 7) =       0.000477779823

      target function =                  N/A
              le_mean =     -16.906021377219
             les_mean =     286.152824020686
             stat err =       0.000465085807
             autocorr =       1.275136332130
              std dev =       0.582464920250
             le_variance =       0.339265383322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864895
  error estimate for blocks of size 2^( 2) =       0.000425015551
  error estimate for blocks of size 2^( 3) =       0.000438551442
  error estimate for blocks of size 2^( 4) =       0.000450922473
  error estimate for blocks of size 2^( 5) =       0.000462196260
  error estimate for blocks of size 2^( 6) =       0.000469444674
  error estimate for blocks of size 2^( 7) =       0.000477779823

      target function =                  N/A
              le_mean =     -16.906021377219
             les_mean =     286.152824020686
             stat err =       0.000465085807
             autocorr =       1.275136332137
              std dev =       0.582464920250
             le_variance =       0.339265383322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339120321801
                                         uncertainty =       0.003999385796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411864895
  error estimate for blocks of size 2^( 2) =       0.000425015551
  error estimate for blocks of size 2^( 3) =       0.000438551442
  error estimate for blocks of size 2^( 4) =       0.000450922473
  error estimate for blocks of size 2^( 5) =       0.000462196260
  error estimate for blocks of size 2^( 6) =       0.000469444674
  error estimate for blocks of size 2^( 7) =       0.000477779823

      target function =                  N/A
              le_mean =     -16.906021377219
             les_mean =     286.152824020685
             stat err =       0.000465085807
             autocorr =       1.275136332132
              std dev =       0.582464920250
             le_variance =       0.339265383321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906021377219        initial
     9.5367e+07     9.5367e+08             2.7347e-12       -16.906021377219  <--
     3.8147e+08     3.8147e+09             6.8417e-13       -16.906021377219
     1.5259e+09     1.5259e+10             1.7116e-13       -16.906021377219

*****************************************************************************
Applying the update for shift_i =   9.5367e+07     and shift_s =   9.5367e+08
*****************************************************************************

  Execution time = 3.0581e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8584
    reference variance = 0.623329
====================================================
  Execution time = 2.0876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3636e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336303255646
                                         uncertainty =       0.003441901134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336303255646
                                         uncertainty =       0.003441901134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410096894
  error estimate for blocks of size 2^( 2) =       0.000422709582
  error estimate for blocks of size 2^( 3) =       0.000435170375
  error estimate for blocks of size 2^( 4) =       0.000447116633
  error estimate for blocks of size 2^( 5) =       0.000456925594
  error estimate for blocks of size 2^( 6) =       0.000464282278
  error estimate for blocks of size 2^( 7) =       0.000469635230

      target function =                  N/A
              le_mean =     -16.905706835209
             les_mean =     286.139282354331
             stat err =       0.000459489934
             autocorr =       1.255391095297
              std dev =       0.579964588984
             le_variance =       0.336358924475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570683521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706835209       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706835209       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706835209       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706844515       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706838781       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706844565       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706835083       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706837231       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.057091e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706835209       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706835209       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706835209       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706894330       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706829086       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706831384       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706821996       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706932046       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.642640e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706835209       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706835209       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706835209       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706920476       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905707113933       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706656974       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706835815       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706983543       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.606424e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6621e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8421
    reference variance = 0.480494
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3145e-01
  Total weights = 2.0000e+06
  Execution time = 1.8675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090565
  error estimate for blocks of size 2^( 2) =       0.000419396542
  error estimate for blocks of size 2^( 3) =       0.000432606702
  error estimate for blocks of size 2^( 4) =       0.000443932287
  error estimate for blocks of size 2^( 5) =       0.000453922059
  error estimate for blocks of size 2^( 6) =       0.000459879279
  error estimate for blocks of size 2^( 7) =       0.000464048100

      target function =                  N/A
              le_mean =     -16.906045381142
             les_mean =     286.145815720029
             stat err =       0.000455445431
             autocorr =       1.251672253416
              std dev =       0.575712998382
             le_variance =       0.331445456506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090565
  error estimate for blocks of size 2^( 2) =       0.000419396542
  error estimate for blocks of size 2^( 3) =       0.000432606702
  error estimate for blocks of size 2^( 4) =       0.000443932287
  error estimate for blocks of size 2^( 5) =       0.000453922059
  error estimate for blocks of size 2^( 6) =       0.000459879279
  error estimate for blocks of size 2^( 7) =       0.000464048100

      target function =                  N/A
              le_mean =     -16.906045381142
             les_mean =     286.145815720029
             stat err =       0.000455445431
             autocorr =       1.251672253419
              std dev =       0.575712998382
             le_variance =       0.331445456506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090565
  error estimate for blocks of size 2^( 2) =       0.000419396542
  error estimate for blocks of size 2^( 3) =       0.000432606702
  error estimate for blocks of size 2^( 4) =       0.000443932287
  error estimate for blocks of size 2^( 5) =       0.000453922059
  error estimate for blocks of size 2^( 6) =       0.000459879279
  error estimate for blocks of size 2^( 7) =       0.000464048100

      target function =                  N/A
              le_mean =     -16.906045381142
             les_mean =     286.145815720029
             stat err =       0.000455445431
             autocorr =       1.251672253406
              std dev =       0.575712998382
             le_variance =       0.331445456506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331265946433
                                         uncertainty =       0.002478068082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090565
  error estimate for blocks of size 2^( 2) =       0.000419396542
  error estimate for blocks of size 2^( 3) =       0.000432606702
  error estimate for blocks of size 2^( 4) =       0.000443932287
  error estimate for blocks of size 2^( 5) =       0.000453922059
  error estimate for blocks of size 2^( 6) =       0.000459879279
  error estimate for blocks of size 2^( 7) =       0.000464048100

      target function =                  N/A
              le_mean =     -16.906045381142
             les_mean =     286.145815720029
             stat err =       0.000455445431
             autocorr =       1.251672253418
              std dev =       0.575712998382
             le_variance =       0.331445456506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906045381142        initial  <--
     2.3842e+07     2.3842e+08             1.0571e-11       -16.906045381142
     9.5367e+07     9.5367e+08             2.6426e-12       -16.906045381142
     3.8147e+08     3.8147e+09             6.6064e-13       -16.906045381142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7078
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8602
    reference variance = 0.669235
====================================================
  Execution time = 2.0970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340544196280
                                         uncertainty =       0.003605901902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340544196280
                                         uncertainty =       0.003605901902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412675054
  error estimate for blocks of size 2^( 2) =       0.000425073205
  error estimate for blocks of size 2^( 3) =       0.000438175102
  error estimate for blocks of size 2^( 4) =       0.000451029185
  error estimate for blocks of size 2^( 5) =       0.000462018272
  error estimate for blocks of size 2^( 6) =       0.000468802039
  error estimate for blocks of size 2^( 7) =       0.000472489950

      target function =                  N/A
              le_mean =     -16.905576412327
             les_mean =     286.139115063092
             stat err =       0.000463584862
             autocorr =       1.261949738227
              std dev =       0.583610658192
             le_variance =       0.340601400355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557641233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905576412327       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905576412327       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905576412327       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905576403221       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905576420051       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905576412327       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905576460108       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905576416491       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.177558e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905576412327       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905576412327       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905576412327       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905576306766       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905576174488       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905576332031       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905576136741       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905576524547       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.944198e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905576412327       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905576412327       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905576412327       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905576412327       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905578668760       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577357709       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905576347026       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905576821345       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 7.356894e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194917 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6519e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9384
    reference variance = 0.33763
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3949e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412000416
  error estimate for blocks of size 2^( 2) =       0.000425443589
  error estimate for blocks of size 2^( 3) =       0.000438743575
  error estimate for blocks of size 2^( 4) =       0.000451577028
  error estimate for blocks of size 2^( 5) =       0.000462262063
  error estimate for blocks of size 2^( 6) =       0.000471487960
  error estimate for blocks of size 2^( 7) =       0.000477782313

      target function =                  N/A
              le_mean =     -16.905939419452
             les_mean =     286.150276169471
             stat err =       0.000465777341
             autocorr =       1.278089909398
              std dev =       0.582656575561
             le_variance =       0.339488685045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412000416
  error estimate for blocks of size 2^( 2) =       0.000425443589
  error estimate for blocks of size 2^( 3) =       0.000438743575
  error estimate for blocks of size 2^( 4) =       0.000451577028
  error estimate for blocks of size 2^( 5) =       0.000462262063
  error estimate for blocks of size 2^( 6) =       0.000471487960
  error estimate for blocks of size 2^( 7) =       0.000477782313

      target function =                  N/A
              le_mean =     -16.905939419452
             les_mean =     286.150276169471
             stat err =       0.000465777341
             autocorr =       1.278089909408
              std dev =       0.582656575562
             le_variance =       0.339488685045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412000416
  error estimate for blocks of size 2^( 2) =       0.000425443589
  error estimate for blocks of size 2^( 3) =       0.000438743575
  error estimate for blocks of size 2^( 4) =       0.000451577028
  error estimate for blocks of size 2^( 5) =       0.000462262063
  error estimate for blocks of size 2^( 6) =       0.000471487960
  error estimate for blocks of size 2^( 7) =       0.000477782313

      target function =                  N/A
              le_mean =     -16.905939419452
             les_mean =     286.150276169471
             stat err =       0.000465777341
             autocorr =       1.278089909405
              std dev =       0.582656575561
             le_variance =       0.339488685045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549414771
                                         uncertainty =       0.005362287194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412000416
  error estimate for blocks of size 2^( 2) =       0.000425443589
  error estimate for blocks of size 2^( 3) =       0.000438743575
  error estimate for blocks of size 2^( 4) =       0.000451577028
  error estimate for blocks of size 2^( 5) =       0.000462262063
  error estimate for blocks of size 2^( 6) =       0.000471487960
  error estimate for blocks of size 2^( 7) =       0.000477782313

      target function =                  N/A
              le_mean =     -16.905939419452
             les_mean =     286.150276169471
             stat err =       0.000465777341
             autocorr =       1.278089909398
              std dev =       0.582656575561
             le_variance =       0.339488685045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905939419452        initial  <--
     2.3842e+08     2.3842e+09             1.1776e-12       -16.905939419452
     9.5367e+08     9.5367e+09             2.9442e-13       -16.905939419452
     3.8147e+09     3.8147e+10             7.3569e-14       -16.905939419452

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7584
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0045e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9396
    reference variance = 0.229338
====================================================
  Execution time = 2.0345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350060676617
                                         uncertainty =       0.008263011844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350060676617
                                         uncertainty =       0.008263011844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418336152
  error estimate for blocks of size 2^( 2) =       0.000431219328
  error estimate for blocks of size 2^( 3) =       0.000444592376
  error estimate for blocks of size 2^( 4) =       0.000457020838
  error estimate for blocks of size 2^( 5) =       0.000467882141
  error estimate for blocks of size 2^( 6) =       0.000475051343
  error estimate for blocks of size 2^( 7) =       0.000482819104

      target function =                  N/A
              le_mean =     -16.906227506268
             les_mean =     286.170538590894
             stat err =       0.000470693357
             autocorr =       1.265975621245
              std dev =       0.591616659842
             le_variance =       0.350010272203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622750627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906227506268       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906227506268       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906227506268       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906227659202       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906227731394       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906226941226       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906226895745       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906227561164       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 9.094872e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906227506268       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906227506268       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906227506268       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906227506268       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906227241319       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906232558111       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224487723       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906218452268       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906224660464       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 2.262024e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906227506268       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906227506268       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906227506268       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906209559004       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906227506268       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906254713835       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906228506804       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906228310646       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906086822291       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905930642431       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906053150020       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907414291388       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905476634614       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905956568499       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906135312607       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906885306313       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905593977690       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907546673480       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903389726696       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904887300981       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905055297246       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.911698314848       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906317566707       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906423447870       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.902476399475       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904194923948       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.901150791598       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.902285988969       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907691968697       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906505829880       residual = 1.26e-05           smallest_sin_value = 9.98e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.907298659907       residual = 3.16e-04           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.914837151455       residual = 9.90e-03           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.906111666110       residual = 2.32e-05           smallest_sin_value = 9.96e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 5.700130e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5864e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8401
    reference variance = 0.310572
====================================================
  Execution time = 2.0062e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3457e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409003637
  error estimate for blocks of size 2^( 2) =       0.000422196095
  error estimate for blocks of size 2^( 3) =       0.000435239894
  error estimate for blocks of size 2^( 4) =       0.000447513294
  error estimate for blocks of size 2^( 5) =       0.000458005130
  error estimate for blocks of size 2^( 6) =       0.000467677491
  error estimate for blocks of size 2^( 7) =       0.000473640131

      target function =                  N/A
              le_mean =     -16.905712759441
             les_mean =     286.137691687698
             stat err =       0.000461709012
             autocorr =       1.274331335283
              std dev =       0.578418490577
             le_variance =       0.334567950241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409003637
  error estimate for blocks of size 2^( 2) =       0.000422196095
  error estimate for blocks of size 2^( 3) =       0.000435239894
  error estimate for blocks of size 2^( 4) =       0.000447513294
  error estimate for blocks of size 2^( 5) =       0.000458005130
  error estimate for blocks of size 2^( 6) =       0.000467677491
  error estimate for blocks of size 2^( 7) =       0.000473640131

      target function =                  N/A
              le_mean =     -16.905712759441
             les_mean =     286.137691687698
             stat err =       0.000461709012
             autocorr =       1.274331335277
              std dev =       0.578418490577
             le_variance =       0.334567950241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409003637
  error estimate for blocks of size 2^( 2) =       0.000422196095
  error estimate for blocks of size 2^( 3) =       0.000435239894
  error estimate for blocks of size 2^( 4) =       0.000447513294
  error estimate for blocks of size 2^( 5) =       0.000458005130
  error estimate for blocks of size 2^( 6) =       0.000467677491
  error estimate for blocks of size 2^( 7) =       0.000473640131

      target function =                  N/A
              le_mean =     -16.905712759441
             les_mean =     286.137691687698
             stat err =       0.000461709012
             autocorr =       1.274331335276
              std dev =       0.578418490577
             le_variance =       0.334567950241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334577042972
                                         uncertainty =       0.003004445026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409003637
  error estimate for blocks of size 2^( 2) =       0.000422196095
  error estimate for blocks of size 2^( 3) =       0.000435239894
  error estimate for blocks of size 2^( 4) =       0.000447513294
  error estimate for blocks of size 2^( 5) =       0.000458005130
  error estimate for blocks of size 2^( 6) =       0.000467677491
  error estimate for blocks of size 2^( 7) =       0.000473640131

      target function =                  N/A
              le_mean =     -16.905712759441
             les_mean =     286.137691687698
             stat err =       0.000461709012
             autocorr =       1.274331335282
              std dev =       0.578418490577
             le_variance =       0.334567950241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905712759441        initial  <--
     2.3842e+09     2.3842e+10             9.0949e-14       -16.905712759441
     9.5367e+09     9.5367e+10             2.2620e-14       -16.905712759441
     3.8147e+10     3.8147e+11             5.7001e-15       -16.905712759441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5577
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.246546
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3920e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220449179
                                         uncertainty =       0.003945085918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220449179
                                         uncertainty =       0.003945085918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411823616
  error estimate for blocks of size 2^( 2) =       0.000424501522
  error estimate for blocks of size 2^( 3) =       0.000437546354
  error estimate for blocks of size 2^( 4) =       0.000449848256
  error estimate for blocks of size 2^( 5) =       0.000461648906
  error estimate for blocks of size 2^( 6) =       0.000469187512
  error estimate for blocks of size 2^( 7) =       0.000474947469

      target function =                  N/A
              le_mean =     -16.904714278298
             les_mean =     286.108562043498
             stat err =       0.000463908036
             autocorr =       1.268940603721
              std dev =       0.582406543746
             le_variance =       0.339197382198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690471427830e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904714278298       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904714278298       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904714278298       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904716043928       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904720838381       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904708383240       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904716033958       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904726510711       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904724716253       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904820514048       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904726503790       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904725053790       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904706631596       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904639703155       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904777587019       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904405044840       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904321146725       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903629466970       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903688121554       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904012821970       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903427706025       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904127793567       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904401869436       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907102501610       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905807523106       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905699507076       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906967067032       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905444585775       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905371794080       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.902811499820       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.903532671839       residual = 2.07e-04           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.907622719163       residual = 1.23e-03           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 9.885302e-15

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904714278298       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904714278298       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904714278298       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904721170305       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904714262133       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904713228055       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904727767306       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904740586460       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904551125598       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905266726715       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905160143385       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904635123387       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905229203746       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904196517320       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.902600075932       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904702220643       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907382515266       residual = 9.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908437463716       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.896890447576       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.895678031125       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910326534254       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902934311430       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906934504051       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.920949750666       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904123897735       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.890991611063       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.894924416147       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909819885109       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.892888550863       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908689271452       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904740723250       residual = 2.86e-04           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.891843595430       residual = 2.49e-02           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.323632e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904714278298       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904714278298       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904714278298       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904737297077       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904714278298       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905062816906       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903672726711       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907196908442       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903960334794       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904020481266       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908652204855       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.902638057428       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904413022467       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902792858890       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.930155656435       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.954207997531       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.900351615024       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.862997504252       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.894765934705       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.862447010132       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911054723729       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.920977582224       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.914452715903       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901413760780       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.884781672366       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.896693793426       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.881468503348       residual = 7.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.889981076894       residual = 3.37e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.879725638120       residual = 8.57e-02           smallest_sin_value = 9.95e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.811426e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.200906
====================================================
  Execution time = 2.0002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3626e-01
  Total weights = 2.0000e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410037019
  error estimate for blocks of size 2^( 2) =       0.000422739577
  error estimate for blocks of size 2^( 3) =       0.000436519185
  error estimate for blocks of size 2^( 4) =       0.000449170188
  error estimate for blocks of size 2^( 5) =       0.000461301037
  error estimate for blocks of size 2^( 6) =       0.000469254956
  error estimate for blocks of size 2^( 7) =       0.000475704337

      target function =                  N/A
              le_mean =     -16.904875221957
             les_mean =     286.111066816511
             stat err =       0.000463857630
             autocorr =       1.279744502137
              std dev =       0.579879914042
             le_variance =       0.336260714709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410037019
  error estimate for blocks of size 2^( 2) =       0.000422739577
  error estimate for blocks of size 2^( 3) =       0.000436519185
  error estimate for blocks of size 2^( 4) =       0.000449170188
  error estimate for blocks of size 2^( 5) =       0.000461301037
  error estimate for blocks of size 2^( 6) =       0.000469254956
  error estimate for blocks of size 2^( 7) =       0.000475704337

      target function =                  N/A
              le_mean =     -16.904875221957
             les_mean =     286.111066816511
             stat err =       0.000463857630
             autocorr =       1.279744502135
              std dev =       0.579879914042
             le_variance =       0.336260714709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410037019
  error estimate for blocks of size 2^( 2) =       0.000422739577
  error estimate for blocks of size 2^( 3) =       0.000436519185
  error estimate for blocks of size 2^( 4) =       0.000449170188
  error estimate for blocks of size 2^( 5) =       0.000461301037
  error estimate for blocks of size 2^( 6) =       0.000469254956
  error estimate for blocks of size 2^( 7) =       0.000475704337

      target function =                  N/A
              le_mean =     -16.904875221957
             les_mean =     286.111066816511
             stat err =       0.000463857630
             autocorr =       1.279744502135
              std dev =       0.579879914042
             le_variance =       0.336260714709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336239133589
                                         uncertainty =       0.002984972408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410037019
  error estimate for blocks of size 2^( 2) =       0.000422739577
  error estimate for blocks of size 2^( 3) =       0.000436519185
  error estimate for blocks of size 2^( 4) =       0.000449170188
  error estimate for blocks of size 2^( 5) =       0.000461301037
  error estimate for blocks of size 2^( 6) =       0.000469254956
  error estimate for blocks of size 2^( 7) =       0.000475704337

      target function =                  N/A
              le_mean =     -16.904875221957
             les_mean =     286.111066816511
             stat err =       0.000463857630
             autocorr =       1.279744502140
              std dev =       0.579879914042
             le_variance =       0.336260714709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904875221957        initial  <--
     2.3842e+10     2.3842e+11             9.8853e-15       -16.904875221957
     9.5367e+10     9.5367e+11             2.3236e-15       -16.904875221957
     3.8147e+11     3.8147e+12             4.8114e-16       -16.904875221957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4977
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8873
    reference variance = 0.198895
====================================================
  Execution time = 2.2014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338264095935
                                         uncertainty =       0.003174837708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338264095935
                                         uncertainty =       0.003174837708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411248293
  error estimate for blocks of size 2^( 2) =       0.000424361356
  error estimate for blocks of size 2^( 3) =       0.000438035121
  error estimate for blocks of size 2^( 4) =       0.000451237807
  error estimate for blocks of size 2^( 5) =       0.000462670646
  error estimate for blocks of size 2^( 6) =       0.000470545927
  error estimate for blocks of size 2^( 7) =       0.000477128527

      target function =                  N/A
              le_mean =     -16.905427792518
             les_mean =     286.131738996510
             stat err =       0.000465395727
             autocorr =       1.280668021396
              std dev =       0.581592913971
             le_variance =       0.338250317581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542779252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905427792518       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905427792518       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905427792518       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905408725011       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905488783252       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905268011213       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904872672629       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904768981655       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905008724722       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.900171666184       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.901316298163       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906383734202       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.887663088735       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.888955016891       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.899104369173       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907003911447       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907880908478       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.914033332204       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.897048149941       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911965992636       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.916490961001       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902825373895       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911707344116       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.916928032419       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.892611361727       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893220793013       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903640065273       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.872048922546       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.922298141691       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.885988729449       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.915781218423       residual = 1.29e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.899192743058       residual = 5.90e-03           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 7.933148e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905427792518       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905427792518       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905427792518       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905427792518       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8076e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.219185
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3378e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408521033
  error estimate for blocks of size 2^( 2) =       0.000421642249
  error estimate for blocks of size 2^( 3) =       0.000435117455
  error estimate for blocks of size 2^( 4) =       0.000446886878
  error estimate for blocks of size 2^( 5) =       0.000457119939
  error estimate for blocks of size 2^( 6) =       0.000465272342
  error estimate for blocks of size 2^( 7) =       0.000472502055

      target function =                  N/A
              le_mean =     -16.906514053909
             les_mean =     286.163996156536
             stat err =       0.000460445304
             autocorr =       1.270361294043
              std dev =       0.577735985048
             le_variance =       0.333778868419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408521033
  error estimate for blocks of size 2^( 2) =       0.000421642249
  error estimate for blocks of size 2^( 3) =       0.000435117455
  error estimate for blocks of size 2^( 4) =       0.000446886878
  error estimate for blocks of size 2^( 5) =       0.000457119939
  error estimate for blocks of size 2^( 6) =       0.000465272342
  error estimate for blocks of size 2^( 7) =       0.000472502055

      target function =                  N/A
              le_mean =     -16.906514053909
             les_mean =     286.163996156536
             stat err =       0.000460445304
             autocorr =       1.270361294045
              std dev =       0.577735985048
             le_variance =       0.333778868419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408521033
  error estimate for blocks of size 2^( 2) =       0.000421642249
  error estimate for blocks of size 2^( 3) =       0.000435117455
  error estimate for blocks of size 2^( 4) =       0.000446886878
  error estimate for blocks of size 2^( 5) =       0.000457119939
  error estimate for blocks of size 2^( 6) =       0.000465272342
  error estimate for blocks of size 2^( 7) =       0.000472502055

      target function =                  N/A
              le_mean =     -16.906514053909
             les_mean =     286.163996156536
             stat err =       0.000460445304
             autocorr =       1.270361294043
              std dev =       0.577735985048
             le_variance =       0.333778868419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746245681
                                         uncertainty =       0.003033119444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408521033
  error estimate for blocks of size 2^( 2) =       0.000421642249
  error estimate for blocks of size 2^( 3) =       0.000435117455
  error estimate for blocks of size 2^( 4) =       0.000446886878
  error estimate for blocks of size 2^( 5) =       0.000457119939
  error estimate for blocks of size 2^( 6) =       0.000465272342
  error estimate for blocks of size 2^( 7) =       0.000472502055

      target function =                  N/A
              le_mean =     -16.906514053909
             les_mean =     286.163996156536
             stat err =       0.000460445304
             autocorr =       1.270361294043
              std dev =       0.577735985048
             le_variance =       0.333778868419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906514053909        initial  <--
     2.3842e+11     2.3842e+12             7.9331e-16       -16.906514053909
     9.5367e+11     9.5367e+12             0.0000e+00       -16.906514053909
     3.8147e+12     3.8147e+13             0.0000e+00       -16.906514053909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6572
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8024
    reference variance = 0.218953
====================================================
  Execution time = 2.0460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9050e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.390620859171
                                         uncertainty =       0.035723392322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.390620859171
                                         uncertainty =       0.035723392322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441873806
  error estimate for blocks of size 2^( 2) =       0.000453395220
  error estimate for blocks of size 2^( 3) =       0.000465867086
  error estimate for blocks of size 2^( 4) =       0.000476868729
  error estimate for blocks of size 2^( 5) =       0.000487153241
  error estimate for blocks of size 2^( 6) =       0.000492860680
  error estimate for blocks of size 2^( 7) =       0.000496970267

      target function =                  N/A
              le_mean =     -16.906213359832
             les_mean =     286.210554893716
             stat err =       0.000488463229
             autocorr =       1.221988834274
              std dev =       0.624903929272
             le_variance =       0.390504920820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621335983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213359832       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6106e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.283682
====================================================
  Execution time = 2.0034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5417e-01
  Total weights = 2.0000e+06
  Execution time = 1.8732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420816047
  error estimate for blocks of size 2^( 2) =       0.000433855453
  error estimate for blocks of size 2^( 3) =       0.000446993331
  error estimate for blocks of size 2^( 4) =       0.000460317361
  error estimate for blocks of size 2^( 5) =       0.000471888363
  error estimate for blocks of size 2^( 6) =       0.000479857396
  error estimate for blocks of size 2^( 7) =       0.000486723351

      target function =                  N/A
              le_mean =     -16.905171818627
             les_mean =     286.139006330263
             stat err =       0.000474696618
             autocorr =       1.272470405863
              std dev =       0.595123760273
             le_variance =       0.354172290041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420816047
  error estimate for blocks of size 2^( 2) =       0.000433855453
  error estimate for blocks of size 2^( 3) =       0.000446993331
  error estimate for blocks of size 2^( 4) =       0.000460317361
  error estimate for blocks of size 2^( 5) =       0.000471888363
  error estimate for blocks of size 2^( 6) =       0.000479857396
  error estimate for blocks of size 2^( 7) =       0.000486723351

      target function =                  N/A
              le_mean =     -16.905171818627
             les_mean =     286.139006330263
             stat err =       0.000474696618
             autocorr =       1.272470405863
              std dev =       0.595123760273
             le_variance =       0.354172290041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420816047
  error estimate for blocks of size 2^( 2) =       0.000433855453
  error estimate for blocks of size 2^( 3) =       0.000446993331
  error estimate for blocks of size 2^( 4) =       0.000460317361
  error estimate for blocks of size 2^( 5) =       0.000471888363
  error estimate for blocks of size 2^( 6) =       0.000479857396
  error estimate for blocks of size 2^( 7) =       0.000486723351

      target function =                  N/A
              le_mean =     -16.905171818627
             les_mean =     286.139006330263
             stat err =       0.000474696618
             autocorr =       1.272470405863
              std dev =       0.595123760273
             le_variance =       0.354172290041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354197235764
                                         uncertainty =       0.012833041653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420816047
  error estimate for blocks of size 2^( 2) =       0.000433855453
  error estimate for blocks of size 2^( 3) =       0.000446993331
  error estimate for blocks of size 2^( 4) =       0.000460317361
  error estimate for blocks of size 2^( 5) =       0.000471888363
  error estimate for blocks of size 2^( 6) =       0.000479857396
  error estimate for blocks of size 2^( 7) =       0.000486723351

      target function =                  N/A
              le_mean =     -16.905171818627
             les_mean =     286.139006330263
             stat err =       0.000474696618
             autocorr =       1.272470405863
              std dev =       0.595123760273
             le_variance =       0.354172290041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905171818627        initial  <--
     2.3842e+12     2.3842e+13             0.0000e+00       -16.905171818627
     9.5367e+12     9.5367e+13             0.0000e+00       -16.905171818627
     3.8147e+13     3.8147e+14             0.0000e+00       -16.905171818627

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5222
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 0.216151
====================================================
  Execution time = 2.1310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340350453020
                                         uncertainty =       0.006377843489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340350453020
                                         uncertainty =       0.006377843489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412533842
  error estimate for blocks of size 2^( 2) =       0.000425386331
  error estimate for blocks of size 2^( 3) =       0.000438472447
  error estimate for blocks of size 2^( 4) =       0.000450587748
  error estimate for blocks of size 2^( 5) =       0.000462105778
  error estimate for blocks of size 2^( 6) =       0.000471314359
  error estimate for blocks of size 2^( 7) =       0.000477676908

      target function =                  N/A
              le_mean =     -16.905301142877
             les_mean =     286.129574902602
             stat err =       0.000465421198
             autocorr =       1.272838072268
              std dev =       0.583410954148
             le_variance =       0.340368341419


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530114288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905301142877       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905301142877       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905301142877       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913450947904       residual = 8.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904581892781       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.887799315566       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.883568290155       residual = 8.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.884557320633       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.693238284274       residual = 5.85e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.815233588247       residual = 9.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.518711976344       residual = 1.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.243114536262       residual = 1.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -15.545553127989       residual = 2.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.353940104091       residual = 2.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.873387405099       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.805911013639       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.294909674260       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.216763145315       residual = 7.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -15.380869018688       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.788613791141       residual = 9.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.659767459528       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -14.085104432285       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.468663513904       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -15.520173188895       residual = 2.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.674909491388       residual = 9.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.467733631577       residual = 7.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.126920646708       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216845100832       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -15.362291857756       residual = 4.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -14.238781495180       residual = 8.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -13.774431244332       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -18.066987864987       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.630173005500       residual = 4.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -21.448419202694       residual = 2.70e+03           smallest_sin_value = 9.97e-01
davidson iteration   34:   krylov dim =  35   energy =     -19.176810784306       residual = 7.13e+02           smallest_sin_value = 9.96e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 2.102778e-18

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905301142877       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905301142877       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905301142877       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.888349171770       residual = 3.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923590007455       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.962495851519       residual = 6.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.676360857814       residual = 6.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.524485515537       residual = 3.54e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.125652936666       residual = 8.27e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -18.387279577987       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.389619959936       residual = 3.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -19.357075268603       residual = 7.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.296474816326       residual = 8.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -11.290188419089       residual = 4.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -24.555678620711       residual = 7.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.671619104437       residual = 4.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -10.122970305019       residual = 6.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =      -8.242025737098       residual = 9.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.442164588494       residual = 4.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -12.046241659652       residual = 3.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -15.598109025389       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.647823610597       residual = 2.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -19.387320385836       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.725861428853       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 5.256944e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905301142877       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905301142877       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6884e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8605
    reference variance = 0.234346
====================================================
  Execution time = 2.0379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3400e-01
  Total weights = 2.0000e+06
  Execution time = 1.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408659245
  error estimate for blocks of size 2^( 2) =       0.000421345348
  error estimate for blocks of size 2^( 3) =       0.000433940839
  error estimate for blocks of size 2^( 4) =       0.000445311066
  error estimate for blocks of size 2^( 5) =       0.000454366591
  error estimate for blocks of size 2^( 6) =       0.000461890273
  error estimate for blocks of size 2^( 7) =       0.000465634591

      target function =                  N/A
              le_mean =     -16.906230813295
             les_mean =     286.154644902157
             stat err =       0.000456800630
             autocorr =       1.249484097280
              std dev =       0.577931446414
             le_variance =       0.334004756754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408659245
  error estimate for blocks of size 2^( 2) =       0.000421345348
  error estimate for blocks of size 2^( 3) =       0.000433940839
  error estimate for blocks of size 2^( 4) =       0.000445311066
  error estimate for blocks of size 2^( 5) =       0.000454366591
  error estimate for blocks of size 2^( 6) =       0.000461890273
  error estimate for blocks of size 2^( 7) =       0.000465634591

      target function =                  N/A
              le_mean =     -16.906230813295
             les_mean =     286.154644902157
             stat err =       0.000456800630
             autocorr =       1.249484097280
              std dev =       0.577931446414
             le_variance =       0.334004756754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408659245
  error estimate for blocks of size 2^( 2) =       0.000421345348
  error estimate for blocks of size 2^( 3) =       0.000433940839
  error estimate for blocks of size 2^( 4) =       0.000445311066
  error estimate for blocks of size 2^( 5) =       0.000454366591
  error estimate for blocks of size 2^( 6) =       0.000461890273
  error estimate for blocks of size 2^( 7) =       0.000465634591

      target function =                  N/A
              le_mean =     -16.906230813295
             les_mean =     286.154644902157
             stat err =       0.000456800630
             autocorr =       1.249484097280
              std dev =       0.577931446414
             le_variance =       0.334004756754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051492003
                                         uncertainty =       0.003859131022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408659245
  error estimate for blocks of size 2^( 2) =       0.000421345348
  error estimate for blocks of size 2^( 3) =       0.000433940839
  error estimate for blocks of size 2^( 4) =       0.000445311066
  error estimate for blocks of size 2^( 5) =       0.000454366591
  error estimate for blocks of size 2^( 6) =       0.000461890273
  error estimate for blocks of size 2^( 7) =       0.000465634591

      target function =                  N/A
              le_mean =     -16.906230813295
             les_mean =     286.154644902157
             stat err =       0.000456800630
             autocorr =       1.249484097280
              std dev =       0.577931446414
             le_variance =       0.334004756754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906230813295        initial  <--
     2.3842e+13     2.3842e+14             2.1028e-18       -16.906230813295
     9.5367e+13     9.5367e+14             5.2569e-19       -16.906230813295
     3.8147e+14     3.8147e+15             0.0000e+00       -16.906230813295

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8346
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8381
    reference variance = 0.173971
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338460006746
                                         uncertainty =       0.003148032758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338460006746
                                         uncertainty =       0.003148032758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411362193
  error estimate for blocks of size 2^( 2) =       0.000423842372
  error estimate for blocks of size 2^( 3) =       0.000436688910
  error estimate for blocks of size 2^( 4) =       0.000447957330
  error estimate for blocks of size 2^( 5) =       0.000457828517
  error estimate for blocks of size 2^( 6) =       0.000464011407
  error estimate for blocks of size 2^( 7) =       0.000467319388

      target function =                  N/A
              le_mean =     -16.905825009219
             les_mean =     286.145356781132
             stat err =       0.000459279160
             autocorr =       1.246535727206
              std dev =       0.581753992689
             le_variance =       0.338437708009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582500922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905825009219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5807e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.256967
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827003
  error estimate for blocks of size 2^( 2) =       0.000423432071
  error estimate for blocks of size 2^( 3) =       0.000436333597
  error estimate for blocks of size 2^( 4) =       0.000448333867
  error estimate for blocks of size 2^( 5) =       0.000457288144
  error estimate for blocks of size 2^( 6) =       0.000464434398
  error estimate for blocks of size 2^( 7) =       0.000468443607

      target function =                  N/A
              le_mean =     -16.906122591640
             les_mean =     286.154538567237
             stat err =       0.000459625004
             autocorr =       1.251668523374
              std dev =       0.580997119155
             le_variance =       0.337557652466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827003
  error estimate for blocks of size 2^( 2) =       0.000423432071
  error estimate for blocks of size 2^( 3) =       0.000436333597
  error estimate for blocks of size 2^( 4) =       0.000448333867
  error estimate for blocks of size 2^( 5) =       0.000457288144
  error estimate for blocks of size 2^( 6) =       0.000464434398
  error estimate for blocks of size 2^( 7) =       0.000468443607

      target function =                  N/A
              le_mean =     -16.906122591640
             les_mean =     286.154538567237
             stat err =       0.000459625004
             autocorr =       1.251668523374
              std dev =       0.580997119155
             le_variance =       0.337557652466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827003
  error estimate for blocks of size 2^( 2) =       0.000423432071
  error estimate for blocks of size 2^( 3) =       0.000436333597
  error estimate for blocks of size 2^( 4) =       0.000448333867
  error estimate for blocks of size 2^( 5) =       0.000457288144
  error estimate for blocks of size 2^( 6) =       0.000464434398
  error estimate for blocks of size 2^( 7) =       0.000468443607

      target function =                  N/A
              le_mean =     -16.906122591640
             les_mean =     286.154538567237
             stat err =       0.000459625004
             autocorr =       1.251668523374
              std dev =       0.580997119155
             le_variance =       0.337557652466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493855088
                                         uncertainty =       0.003494152702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827003
  error estimate for blocks of size 2^( 2) =       0.000423432071
  error estimate for blocks of size 2^( 3) =       0.000436333597
  error estimate for blocks of size 2^( 4) =       0.000448333867
  error estimate for blocks of size 2^( 5) =       0.000457288144
  error estimate for blocks of size 2^( 6) =       0.000464434398
  error estimate for blocks of size 2^( 7) =       0.000468443607

      target function =                  N/A
              le_mean =     -16.906122591640
             les_mean =     286.154538567237
             stat err =       0.000459625004
             autocorr =       1.251668523374
              std dev =       0.580997119155
             le_variance =       0.337557652466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906122591640        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -16.906122591640
     9.5367e+14     9.5367e+15             0.0000e+00       -16.906122591640
     3.8147e+15     3.8147e+16             0.0000e+00       -16.906122591640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6387
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9385
    reference variance = 0.178053
====================================================
  Execution time = 2.0505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3234e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332452496180
                                         uncertainty =       0.002853535860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332452496180
                                         uncertainty =       0.002853535860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407640257
  error estimate for blocks of size 2^( 2) =       0.000420551101
  error estimate for blocks of size 2^( 3) =       0.000433265655
  error estimate for blocks of size 2^( 4) =       0.000444949340
  error estimate for blocks of size 2^( 5) =       0.000455197942
  error estimate for blocks of size 2^( 6) =       0.000464586758
  error estimate for blocks of size 2^( 7) =       0.000469283470

      target function =                  N/A
              le_mean =     -16.906201027513
             les_mean =     286.151974174519
             stat err =       0.000458504378
             autocorr =       1.265123257891
              std dev =       0.576490379799
             le_variance =       0.332341158000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620102751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906201027513       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6028e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.311621
====================================================
  Execution time = 1.9923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4139e-01
  Total weights = 2.0000e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413153498
  error estimate for blocks of size 2^( 2) =       0.000426078558
  error estimate for blocks of size 2^( 3) =       0.000438889928
  error estimate for blocks of size 2^( 4) =       0.000450483632
  error estimate for blocks of size 2^( 5) =       0.000461868655
  error estimate for blocks of size 2^( 6) =       0.000470959857
  error estimate for blocks of size 2^( 7) =       0.000473570193

      target function =                  N/A
              le_mean =     -16.905304284827
             les_mean =     286.130704417333
             stat err =       0.000464220584
             autocorr =       1.262484109126
              std dev =       0.584287279876
             le_variance =       0.341391625425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413153498
  error estimate for blocks of size 2^( 2) =       0.000426078558
  error estimate for blocks of size 2^( 3) =       0.000438889928
  error estimate for blocks of size 2^( 4) =       0.000450483632
  error estimate for blocks of size 2^( 5) =       0.000461868655
  error estimate for blocks of size 2^( 6) =       0.000470959857
  error estimate for blocks of size 2^( 7) =       0.000473570193

      target function =                  N/A
              le_mean =     -16.905304284827
             les_mean =     286.130704417333
             stat err =       0.000464220584
             autocorr =       1.262484109126
              std dev =       0.584287279876
             le_variance =       0.341391625425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413153498
  error estimate for blocks of size 2^( 2) =       0.000426078558
  error estimate for blocks of size 2^( 3) =       0.000438889928
  error estimate for blocks of size 2^( 4) =       0.000450483632
  error estimate for blocks of size 2^( 5) =       0.000461868655
  error estimate for blocks of size 2^( 6) =       0.000470959857
  error estimate for blocks of size 2^( 7) =       0.000473570193

      target function =                  N/A
              le_mean =     -16.905304284827
             les_mean =     286.130704417333
             stat err =       0.000464220584
             autocorr =       1.262484109126
              std dev =       0.584287279876
             le_variance =       0.341391625425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396567614
                                         uncertainty =       0.007475288679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413153498
  error estimate for blocks of size 2^( 2) =       0.000426078558
  error estimate for blocks of size 2^( 3) =       0.000438889928
  error estimate for blocks of size 2^( 4) =       0.000450483632
  error estimate for blocks of size 2^( 5) =       0.000461868655
  error estimate for blocks of size 2^( 6) =       0.000470959857
  error estimate for blocks of size 2^( 7) =       0.000473570193

      target function =                  N/A
              le_mean =     -16.905304284827
             les_mean =     286.130704417333
             stat err =       0.000464220584
             autocorr =       1.262484109126
              std dev =       0.584287279876
             le_variance =       0.341391625425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905304284827        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -16.905304284827
     9.5367e+15     9.5367e+16             0.0000e+00       -16.905304284827
     3.8147e+16     3.8147e+17             0.0000e+00       -16.905304284827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4119
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 0.417245
====================================================
  Execution time = 2.0224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342070719199
                                         uncertainty =       0.005179751323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342070719199
                                         uncertainty =       0.005179751323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556261
  error estimate for blocks of size 2^( 2) =       0.000426253523
  error estimate for blocks of size 2^( 3) =       0.000440010880
  error estimate for blocks of size 2^( 4) =       0.000452153183
  error estimate for blocks of size 2^( 5) =       0.000461000741
  error estimate for blocks of size 2^( 6) =       0.000469508819
  error estimate for blocks of size 2^( 7) =       0.000474510521

      target function =                  N/A
              le_mean =     -16.906256337450
             les_mean =     286.163560737760
             stat err =       0.000464293316
             autocorr =       1.260421097603
              std dev =       0.584856872420
             le_variance =       0.342057561217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625633745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256337450       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5896e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.503245
====================================================
  Execution time = 2.2388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3517e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369847
  error estimate for blocks of size 2^( 2) =       0.000422508607
  error estimate for blocks of size 2^( 3) =       0.000435855543
  error estimate for blocks of size 2^( 4) =       0.000447563100
  error estimate for blocks of size 2^( 5) =       0.000458446975
  error estimate for blocks of size 2^( 6) =       0.000466145025
  error estimate for blocks of size 2^( 7) =       0.000470423523

      target function =                  N/A
              le_mean =     -16.905894508191
             les_mean =     286.144436297273
             stat err =       0.000460644656
             autocorr =       1.266194356650
              std dev =       0.578936389229
             le_variance =       0.335167342774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369847
  error estimate for blocks of size 2^( 2) =       0.000422508607
  error estimate for blocks of size 2^( 3) =       0.000435855543
  error estimate for blocks of size 2^( 4) =       0.000447563100
  error estimate for blocks of size 2^( 5) =       0.000458446975
  error estimate for blocks of size 2^( 6) =       0.000466145025
  error estimate for blocks of size 2^( 7) =       0.000470423523

      target function =                  N/A
              le_mean =     -16.905894508191
             les_mean =     286.144436297273
             stat err =       0.000460644656
             autocorr =       1.266194356650
              std dev =       0.578936389229
             le_variance =       0.335167342774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369847
  error estimate for blocks of size 2^( 2) =       0.000422508607
  error estimate for blocks of size 2^( 3) =       0.000435855543
  error estimate for blocks of size 2^( 4) =       0.000447563100
  error estimate for blocks of size 2^( 5) =       0.000458446975
  error estimate for blocks of size 2^( 6) =       0.000466145025
  error estimate for blocks of size 2^( 7) =       0.000470423523

      target function =                  N/A
              le_mean =     -16.905894508191
             les_mean =     286.144436297273
             stat err =       0.000460644656
             autocorr =       1.266194356650
              std dev =       0.578936389229
             le_variance =       0.335167342774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335229498302
                                         uncertainty =       0.002516725718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369847
  error estimate for blocks of size 2^( 2) =       0.000422508607
  error estimate for blocks of size 2^( 3) =       0.000435855543
  error estimate for blocks of size 2^( 4) =       0.000447563100
  error estimate for blocks of size 2^( 5) =       0.000458446975
  error estimate for blocks of size 2^( 6) =       0.000466145025
  error estimate for blocks of size 2^( 7) =       0.000470423523

      target function =                  N/A
              le_mean =     -16.905894508191
             les_mean =     286.144436297273
             stat err =       0.000460644656
             autocorr =       1.266194356650
              std dev =       0.578936389229
             le_variance =       0.335167342774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905894508191        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -16.905894508191
     9.5367e+16     9.5367e+17             0.0000e+00       -16.905894508191
     3.8147e+17     3.8147e+18             0.0000e+00       -16.905894508191

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9251
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0002
    reference variance = 0.333761
====================================================
  Execution time = 2.0146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3950e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554390177
                                         uncertainty =       0.004823221850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554390177
                                         uncertainty =       0.004823221850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412009522
  error estimate for blocks of size 2^( 2) =       0.000424791653
  error estimate for blocks of size 2^( 3) =       0.000437690044
  error estimate for blocks of size 2^( 4) =       0.000449225502
  error estimate for blocks of size 2^( 5) =       0.000459520481
  error estimate for blocks of size 2^( 6) =       0.000466644281
  error estimate for blocks of size 2^( 7) =       0.000471647623

      target function =                  N/A
              le_mean =     -16.905948878492
             les_mean =     286.150611004084
             stat err =       0.000461759472
             autocorr =       1.256079476963
              std dev =       0.582669453175
             le_variance =       0.339503691663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594887849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905948878492       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5701e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8272
    reference variance = 0.201466
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.0000e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589085
  error estimate for blocks of size 2^( 2) =       0.000427361858
  error estimate for blocks of size 2^( 3) =       0.000440607762
  error estimate for blocks of size 2^( 4) =       0.000453426506
  error estimate for blocks of size 2^( 5) =       0.000463666181
  error estimate for blocks of size 2^( 6) =       0.000474091535
  error estimate for blocks of size 2^( 7) =       0.000480715580

      target function =                  N/A
              le_mean =     -16.904738804779
             les_mean =     286.113962104026
             stat err =       0.000467974950
             autocorr =       1.274117516936
              std dev =       0.586317506228
             le_variance =       0.343768218109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589085
  error estimate for blocks of size 2^( 2) =       0.000427361858
  error estimate for blocks of size 2^( 3) =       0.000440607762
  error estimate for blocks of size 2^( 4) =       0.000453426506
  error estimate for blocks of size 2^( 5) =       0.000463666181
  error estimate for blocks of size 2^( 6) =       0.000474091535
  error estimate for blocks of size 2^( 7) =       0.000480715580

      target function =                  N/A
              le_mean =     -16.904738804779
             les_mean =     286.113962104026
             stat err =       0.000467974950
             autocorr =       1.274117516936
              std dev =       0.586317506228
             le_variance =       0.343768218109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589085
  error estimate for blocks of size 2^( 2) =       0.000427361858
  error estimate for blocks of size 2^( 3) =       0.000440607762
  error estimate for blocks of size 2^( 4) =       0.000453426506
  error estimate for blocks of size 2^( 5) =       0.000463666181
  error estimate for blocks of size 2^( 6) =       0.000474091535
  error estimate for blocks of size 2^( 7) =       0.000480715580

      target function =                  N/A
              le_mean =     -16.904738804779
             les_mean =     286.113962104026
             stat err =       0.000467974950
             autocorr =       1.274117516936
              std dev =       0.586317506228
             le_variance =       0.343768218109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822149662
                                         uncertainty =       0.004841492651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589085
  error estimate for blocks of size 2^( 2) =       0.000427361858
  error estimate for blocks of size 2^( 3) =       0.000440607762
  error estimate for blocks of size 2^( 4) =       0.000453426506
  error estimate for blocks of size 2^( 5) =       0.000463666181
  error estimate for blocks of size 2^( 6) =       0.000474091535
  error estimate for blocks of size 2^( 7) =       0.000480715580

      target function =                  N/A
              le_mean =     -16.904738804779
             les_mean =     286.113962104026
             stat err =       0.000467974950
             autocorr =       1.274117516936
              std dev =       0.586317506228
             le_variance =       0.343768218109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904738804779        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -16.904738804779
     9.5367e+17     9.5367e+18             0.0000e+00       -16.904738804779
     3.8147e+18     3.8147e+19             0.0000e+00       -16.904738804779

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6316
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.182841
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349652024680
                                         uncertainty =       0.011279783037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349652024680
                                         uncertainty =       0.011279783037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418124808
  error estimate for blocks of size 2^( 2) =       0.000430904780
  error estimate for blocks of size 2^( 3) =       0.000444063691
  error estimate for blocks of size 2^( 4) =       0.000455903559
  error estimate for blocks of size 2^( 5) =       0.000466686385
  error estimate for blocks of size 2^( 6) =       0.000475659857
  error estimate for blocks of size 2^( 7) =       0.000482526026

      target function =                  N/A
              le_mean =     -16.905725889623
             les_mean =     286.153224390551
             stat err =       0.000470193957
             autocorr =       1.264568077225
              std dev =       0.591317774382
             le_variance =       0.349656710301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572588962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725889623       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725889623       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725889624       residual = 5.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -19.897959252931       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725889623       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725889623       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725889625       residual = 5.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905725889626       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725889623       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725889623       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725889622       residual = 5.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5858e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9123
    reference variance = 0.203615
====================================================
  Execution time = 2.0024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4234e-01
  Total weights = 2.0000e+06
  Execution time = 1.8691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413724842
  error estimate for blocks of size 2^( 2) =       0.000426450115
  error estimate for blocks of size 2^( 3) =       0.000439208283
  error estimate for blocks of size 2^( 4) =       0.000451081708
  error estimate for blocks of size 2^( 5) =       0.000461461735
  error estimate for blocks of size 2^( 6) =       0.000468951021
  error estimate for blocks of size 2^( 7) =       0.000473903324

      target function =                  N/A
              le_mean =     -16.904503639973
             les_mean =     286.104579631867
             stat err =       0.000463849447
             autocorr =       1.256987299932
              std dev =       0.585095282126
             le_variance =       0.342336489166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413724842
  error estimate for blocks of size 2^( 2) =       0.000426450115
  error estimate for blocks of size 2^( 3) =       0.000439208283
  error estimate for blocks of size 2^( 4) =       0.000451081708
  error estimate for blocks of size 2^( 5) =       0.000461461735
  error estimate for blocks of size 2^( 6) =       0.000468951021
  error estimate for blocks of size 2^( 7) =       0.000473903324

      target function =                  N/A
              le_mean =     -16.904503639973
             les_mean =     286.104579631867
             stat err =       0.000463849447
             autocorr =       1.256987299932
              std dev =       0.585095282126
             le_variance =       0.342336489166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413724842
  error estimate for blocks of size 2^( 2) =       0.000426450115
  error estimate for blocks of size 2^( 3) =       0.000439208283
  error estimate for blocks of size 2^( 4) =       0.000451081708
  error estimate for blocks of size 2^( 5) =       0.000461461735
  error estimate for blocks of size 2^( 6) =       0.000468951021
  error estimate for blocks of size 2^( 7) =       0.000473903324

      target function =                  N/A
              le_mean =     -16.904503639973
             les_mean =     286.104579631867
             stat err =       0.000463849447
             autocorr =       1.256987299932
              std dev =       0.585095282126
             le_variance =       0.342336489166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342336055567
                                         uncertainty =       0.005843529261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413724842
  error estimate for blocks of size 2^( 2) =       0.000426450115
  error estimate for blocks of size 2^( 3) =       0.000439208283
  error estimate for blocks of size 2^( 4) =       0.000451081708
  error estimate for blocks of size 2^( 5) =       0.000461461735
  error estimate for blocks of size 2^( 6) =       0.000468951021
  error estimate for blocks of size 2^( 7) =       0.000473903324

      target function =                  N/A
              le_mean =     -16.904503639973
             les_mean =     286.104579631867
             stat err =       0.000463849447
             autocorr =       1.256987299932
              std dev =       0.585095282126
             le_variance =       0.342336489166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904503639973        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -16.904503639973
     9.5367e+18     9.5367e+19             0.0000e+00       -16.904503639973
     3.8147e+19     3.8147e+20             0.0000e+00       -16.904503639973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4766
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0259
    reference variance = 1.31064
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4931e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349333815854
                                         uncertainty =       0.011746789005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349333815854
                                         uncertainty =       0.011746789005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417917011
  error estimate for blocks of size 2^( 2) =       0.000430566545
  error estimate for blocks of size 2^( 3) =       0.000443832625
  error estimate for blocks of size 2^( 4) =       0.000456364917
  error estimate for blocks of size 2^( 5) =       0.000468858286
  error estimate for blocks of size 2^( 6) =       0.000478416158
  error estimate for blocks of size 2^( 7) =       0.000483093502

      target function =                  N/A
              le_mean =     -16.905733419787
             les_mean =     286.153131541882
             stat err =       0.000471683216
             autocorr =       1.273857205248
              std dev =       0.591023904458
             le_variance =       0.349309255641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573341979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733419787       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733419787       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733419787       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733419787       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905733419787       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905733419787       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 1.558105e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733419787       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733419787       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905733419787       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905733419787       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905733419815       residual = 2.95e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 3.895263e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6346e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.7666
    reference variance = 0.483743
====================================================
  Execution time = 2.1389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3802e-01
  Total weights = 2.0000e+06
  Execution time = 1.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411105700
  error estimate for blocks of size 2^( 2) =       0.000423718718
  error estimate for blocks of size 2^( 3) =       0.000437102639
  error estimate for blocks of size 2^( 4) =       0.000450918358
  error estimate for blocks of size 2^( 5) =       0.000462072878
  error estimate for blocks of size 2^( 6) =       0.000470955403
  error estimate for blocks of size 2^( 7) =       0.000475462035

      target function =                  N/A
              le_mean =     -16.905521551890
             les_mean =     286.134674565430
             stat err =       0.000464852168
             autocorr =       1.278564747181
              std dev =       0.581391256412
             le_variance =       0.338015793032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411105700
  error estimate for blocks of size 2^( 2) =       0.000423718718
  error estimate for blocks of size 2^( 3) =       0.000437102639
  error estimate for blocks of size 2^( 4) =       0.000450918358
  error estimate for blocks of size 2^( 5) =       0.000462072878
  error estimate for blocks of size 2^( 6) =       0.000470955403
  error estimate for blocks of size 2^( 7) =       0.000475462035

      target function =                  N/A
              le_mean =     -16.905521551890
             les_mean =     286.134674565430
             stat err =       0.000464852168
             autocorr =       1.278564747181
              std dev =       0.581391256412
             le_variance =       0.338015793032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411105700
  error estimate for blocks of size 2^( 2) =       0.000423718718
  error estimate for blocks of size 2^( 3) =       0.000437102639
  error estimate for blocks of size 2^( 4) =       0.000450918358
  error estimate for blocks of size 2^( 5) =       0.000462072878
  error estimate for blocks of size 2^( 6) =       0.000470955403
  error estimate for blocks of size 2^( 7) =       0.000475462035

      target function =                  N/A
              le_mean =     -16.905521551890
             les_mean =     286.134674565430
             stat err =       0.000464852168
             autocorr =       1.278564747181
              std dev =       0.581391256412
             le_variance =       0.338015793032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338045517825
                                         uncertainty =       0.003935226033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411105700
  error estimate for blocks of size 2^( 2) =       0.000423718718
  error estimate for blocks of size 2^( 3) =       0.000437102639
  error estimate for blocks of size 2^( 4) =       0.000450918358
  error estimate for blocks of size 2^( 5) =       0.000462072878
  error estimate for blocks of size 2^( 6) =       0.000470955403
  error estimate for blocks of size 2^( 7) =       0.000475462035

      target function =                  N/A
              le_mean =     -16.905521551890
             les_mean =     286.134674565430
             stat err =       0.000464852168
             autocorr =       1.278564747181
              std dev =       0.581391256412
             le_variance =       0.338015793032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905521551890        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -16.905521551890
     9.5367e+19     9.5367e+20             1.5581e-24       -16.905521551890
     3.8147e+20     3.8147e+21             3.8953e-25       -16.905521551890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8762
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.198266
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336704220916
                                         uncertainty =       0.003463413649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336704220916
                                         uncertainty =       0.003463413649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410363229
  error estimate for blocks of size 2^( 2) =       0.000423166987
  error estimate for blocks of size 2^( 3) =       0.000436341116
  error estimate for blocks of size 2^( 4) =       0.000449111043
  error estimate for blocks of size 2^( 5) =       0.000459847873
  error estimate for blocks of size 2^( 6) =       0.000467288985
  error estimate for blocks of size 2^( 7) =       0.000470892092

      target function =                  N/A
              le_mean =     -16.905241908446
             les_mean =     286.123999774485
             stat err =       0.000461784998
             autocorr =       1.266317948838
              std dev =       0.580341244275
             le_variance =       0.336795959807


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690524190845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241908446       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241908446       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241908446       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241908446       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 2.219535e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241908446       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241908446       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241908446       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 5.548837e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241908446       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241908446       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241908446       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241908446       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 1.387209e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5971e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 0.239789
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3563e-01
  Total weights = 2.0000e+06
  Execution time = 1.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409652697
  error estimate for blocks of size 2^( 2) =       0.000421860705
  error estimate for blocks of size 2^( 3) =       0.000434582294
  error estimate for blocks of size 2^( 4) =       0.000446538650
  error estimate for blocks of size 2^( 5) =       0.000455838956
  error estimate for blocks of size 2^( 6) =       0.000464217393
  error estimate for blocks of size 2^( 7) =       0.000467866641

      target function =                  N/A
              le_mean =     -16.906430903948
             les_mean =     286.163036406329
             stat err =       0.000458615410
             autocorr =       1.253330620376
              std dev =       0.579336399825
             le_variance =       0.335630664163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409652697
  error estimate for blocks of size 2^( 2) =       0.000421860705
  error estimate for blocks of size 2^( 3) =       0.000434582294
  error estimate for blocks of size 2^( 4) =       0.000446538650
  error estimate for blocks of size 2^( 5) =       0.000455838956
  error estimate for blocks of size 2^( 6) =       0.000464217393
  error estimate for blocks of size 2^( 7) =       0.000467866641

      target function =                  N/A
              le_mean =     -16.906430903948
             les_mean =     286.163036406329
             stat err =       0.000458615410
             autocorr =       1.253330620376
              std dev =       0.579336399825
             le_variance =       0.335630664163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409652697
  error estimate for blocks of size 2^( 2) =       0.000421860705
  error estimate for blocks of size 2^( 3) =       0.000434582294
  error estimate for blocks of size 2^( 4) =       0.000446538650
  error estimate for blocks of size 2^( 5) =       0.000455838956
  error estimate for blocks of size 2^( 6) =       0.000464217393
  error estimate for blocks of size 2^( 7) =       0.000467866641

      target function =                  N/A
              le_mean =     -16.906430903948
             les_mean =     286.163036406329
             stat err =       0.000458615410
             autocorr =       1.253330620376
              std dev =       0.579336399825
             le_variance =       0.335630664163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335660733274
                                         uncertainty =       0.003595744016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409652697
  error estimate for blocks of size 2^( 2) =       0.000421860705
  error estimate for blocks of size 2^( 3) =       0.000434582294
  error estimate for blocks of size 2^( 4) =       0.000446538650
  error estimate for blocks of size 2^( 5) =       0.000455838956
  error estimate for blocks of size 2^( 6) =       0.000464217393
  error estimate for blocks of size 2^( 7) =       0.000467866641

      target function =                  N/A
              le_mean =     -16.906430903948
             les_mean =     286.163036406329
             stat err =       0.000458615410
             autocorr =       1.253330620376
              std dev =       0.579336399825
             le_variance =       0.335630664163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430903948        initial  <--
     2.3842e+20     2.3842e+21             2.2195e-25       -16.906430903948
     9.5367e+20     9.5367e+21             5.5488e-26       -16.906430903948
     3.8147e+21     3.8147e+22             1.3872e-26       -16.906430903948

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9823
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6016e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9941
    reference variance = 0.20423
====================================================
  Execution time = 2.0356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3602e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336156839940
                                         uncertainty =       0.003541745232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336156839940
                                         uncertainty =       0.003541745232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409890269
  error estimate for blocks of size 2^( 2) =       0.000423046309
  error estimate for blocks of size 2^( 3) =       0.000435837784
  error estimate for blocks of size 2^( 4) =       0.000448201087
  error estimate for blocks of size 2^( 5) =       0.000459423686
  error estimate for blocks of size 2^( 6) =       0.000466995916
  error estimate for blocks of size 2^( 7) =       0.000472060874

      target function =                  N/A
              le_mean =     -16.906207644007
             les_mean =     286.155876800172
             stat err =       0.000461670391
             autocorr =       1.268612033514
              std dev =       0.579672378061
             le_variance =       0.336020065887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620764401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906207644007       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+21 is 2.090192e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906207644007       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 5.225481e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906207644007       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906207644007       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 1.306370e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5842e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8966
    reference variance = 0.29679
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4352e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414436810
  error estimate for blocks of size 2^( 2) =       0.000427012783
  error estimate for blocks of size 2^( 3) =       0.000439984441
  error estimate for blocks of size 2^( 4) =       0.000452777384
  error estimate for blocks of size 2^( 5) =       0.000463784919
  error estimate for blocks of size 2^( 6) =       0.000472079486
  error estimate for blocks of size 2^( 7) =       0.000478407238

      target function =                  N/A
              le_mean =     -16.906327234376
             les_mean =     286.167416123729
             stat err =       0.000466762257
             autocorr =       1.268454275168
              std dev =       0.586102158054
             le_variance =       0.343515739676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414436810
  error estimate for blocks of size 2^( 2) =       0.000427012783
  error estimate for blocks of size 2^( 3) =       0.000439984441
  error estimate for blocks of size 2^( 4) =       0.000452777384
  error estimate for blocks of size 2^( 5) =       0.000463784919
  error estimate for blocks of size 2^( 6) =       0.000472079486
  error estimate for blocks of size 2^( 7) =       0.000478407238

      target function =                  N/A
              le_mean =     -16.906327234376
             les_mean =     286.167416123729
             stat err =       0.000466762257
             autocorr =       1.268454275168
              std dev =       0.586102158054
             le_variance =       0.343515739676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414436810
  error estimate for blocks of size 2^( 2) =       0.000427012783
  error estimate for blocks of size 2^( 3) =       0.000439984441
  error estimate for blocks of size 2^( 4) =       0.000452777384
  error estimate for blocks of size 2^( 5) =       0.000463784919
  error estimate for blocks of size 2^( 6) =       0.000472079486
  error estimate for blocks of size 2^( 7) =       0.000478407238

      target function =                  N/A
              le_mean =     -16.906327234376
             les_mean =     286.167416123729
             stat err =       0.000466762257
             autocorr =       1.268454275168
              std dev =       0.586102158054
             le_variance =       0.343515739676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343517500988
                                         uncertainty =       0.005404906380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414436810
  error estimate for blocks of size 2^( 2) =       0.000427012783
  error estimate for blocks of size 2^( 3) =       0.000439984441
  error estimate for blocks of size 2^( 4) =       0.000452777384
  error estimate for blocks of size 2^( 5) =       0.000463784919
  error estimate for blocks of size 2^( 6) =       0.000472079486
  error estimate for blocks of size 2^( 7) =       0.000478407238

      target function =                  N/A
              le_mean =     -16.906327234376
             les_mean =     286.167416123729
             stat err =       0.000466762257
             autocorr =       1.268454275168
              std dev =       0.586102158054
             le_variance =       0.343515739676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906327234376        initial  <--
     2.3842e+21     2.3842e+22             2.0902e-26       -16.906327234376
     9.5367e+21     9.5367e+22             5.2255e-27       -16.906327234376
     3.8147e+22     3.8147e+23             1.3064e-27       -16.906327234376

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7203
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.174159
====================================================
  Execution time = 2.1457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4935e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349240548349
                                         uncertainty =       0.007379548712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349240548349
                                         uncertainty =       0.007379548712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417939247
  error estimate for blocks of size 2^( 2) =       0.000430481994
  error estimate for blocks of size 2^( 3) =       0.000443729882
  error estimate for blocks of size 2^( 4) =       0.000455313782
  error estimate for blocks of size 2^( 5) =       0.000465563550
  error estimate for blocks of size 2^( 6) =       0.000474377074
  error estimate for blocks of size 2^( 7) =       0.000477273200

      target function =                  N/A
              le_mean =     -16.905871062720
             les_mean =     286.157822643016
             stat err =       0.000468131902
             autocorr =       1.254614099820
              std dev =       0.591055351365
             le_variance =       0.349346428377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587106272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871062720       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7014e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8422
    reference variance = 0.277409
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4197e-01
  Total weights = 2.0000e+06
  Execution time = 1.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413501343
  error estimate for blocks of size 2^( 2) =       0.000426174078
  error estimate for blocks of size 2^( 3) =       0.000439479546
  error estimate for blocks of size 2^( 4) =       0.000451311182
  error estimate for blocks of size 2^( 5) =       0.000460483978
  error estimate for blocks of size 2^( 6) =       0.000468310222
  error estimate for blocks of size 2^( 7) =       0.000473338170

      target function =                  N/A
              le_mean =     -16.905538621370
             les_mean =     286.139202628174
             stat err =       0.000463360888
             autocorr =       1.255697117207
              std dev =       0.584779206659
             le_variance =       0.341966720541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413501343
  error estimate for blocks of size 2^( 2) =       0.000426174078
  error estimate for blocks of size 2^( 3) =       0.000439479546
  error estimate for blocks of size 2^( 4) =       0.000451311182
  error estimate for blocks of size 2^( 5) =       0.000460483978
  error estimate for blocks of size 2^( 6) =       0.000468310222
  error estimate for blocks of size 2^( 7) =       0.000473338170

      target function =                  N/A
              le_mean =     -16.905538621370
             les_mean =     286.139202628174
             stat err =       0.000463360888
             autocorr =       1.255697117207
              std dev =       0.584779206659
             le_variance =       0.341966720541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413501343
  error estimate for blocks of size 2^( 2) =       0.000426174078
  error estimate for blocks of size 2^( 3) =       0.000439479546
  error estimate for blocks of size 2^( 4) =       0.000451311182
  error estimate for blocks of size 2^( 5) =       0.000460483978
  error estimate for blocks of size 2^( 6) =       0.000468310222
  error estimate for blocks of size 2^( 7) =       0.000473338170

      target function =                  N/A
              le_mean =     -16.905538621370
             les_mean =     286.139202628174
             stat err =       0.000463360888
             autocorr =       1.255697117207
              std dev =       0.584779206659
             le_variance =       0.341966720541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341930220322
                                         uncertainty =       0.005553135884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413501343
  error estimate for blocks of size 2^( 2) =       0.000426174078
  error estimate for blocks of size 2^( 3) =       0.000439479546
  error estimate for blocks of size 2^( 4) =       0.000451311182
  error estimate for blocks of size 2^( 5) =       0.000460483978
  error estimate for blocks of size 2^( 6) =       0.000468310222
  error estimate for blocks of size 2^( 7) =       0.000473338170

      target function =                  N/A
              le_mean =     -16.905538621370
             les_mean =     286.139202628174
             stat err =       0.000463360888
             autocorr =       1.255697117207
              std dev =       0.584779206659
             le_variance =       0.341966720541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905538621370        initial  <--
     2.3842e+22     2.3842e+23             0.0000e+00       -16.905538621370
     9.5367e+22     9.5367e+23             0.0000e+00       -16.905538621370
     3.8147e+23     3.8147e+24             0.0000e+00       -16.905538621370

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6268
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.090692e-01 1 1  ON 0
 uu_1                 1.424780e-01 1 1  ON 1
 uu_2                 4.112147e-02 1 1  ON 2
 uu_3                -2.111963e-02 1 1  ON 3
 uu_4                -6.581937e-02 1 1  ON 4
 uu_5                -1.000957e-01 1 1  ON 5
 uu_6                -1.266762e-01 1 1  ON 6
 uu_7                -1.392537e-01 1 1  ON 7
 uu_8                -1.316921e-01 1 1  ON 8
 uu_9                -1.016838e-01 1 1  ON 9
 ud_0                 4.493288e-01 1 1  ON 10
 ud_1                 1.829987e-01 1 1  ON 11
 ud_2                 6.172728e-02 1 1  ON 12
 ud_3                -1.004149e-02 1 1  ON 13
 ud_4                -6.709348e-02 1 1  ON 14
 ud_5                -1.083422e-01 1 1  ON 15
 ud_6                -1.351565e-01 1 1  ON 16
 ud_7                -1.509817e-01 1 1  ON 17
 ud_8                -1.512016e-01 1 1  ON 18
 ud_9                -1.399171e-01 1 1  ON 19
 eO_0                -7.656072e-01 1 1  ON 20
 eO_1                -4.433207e-01 1 1  ON 21
 eO_2                -2.002962e-02 1 1  ON 22
 eO_3                 3.023020e-01 1 1  ON 23
 eO_4                 5.272076e-01 1 1  ON 24
 eO_5                 4.864248e-01 1 1  ON 25
 eO_6                 2.559067e-01 1 1  ON 26
 eO_7                -4.658725e-02 1 1  ON 27
 eO_8                -2.187744e-01 1 1  ON 28
 eO_9                -7.764479e-02 1 1  ON 29
eH1_0                -2.429881e-01 1 1  ON 30
eH1_1                -1.423758e-01 1 1  ON 31
eH1_2                -9.587614e-02 1 1  ON 32
eH1_3                -4.185248e-02 1 1  ON 33
eH1_4                 6.102402e-03 1 1  ON 34
eH1_5                 4.068930e-02 1 1  ON 35
eH1_6                 9.815442e-02 1 1  ON 36
eH1_7                 1.507540e-01 1 1  ON 37
eH1_8                 1.730501e-01 1 1  ON 38
eH1_9                 5.837509e-02 1 1  ON 39
eH2_0                -2.380736e-01 1 1  ON 40
eH2_1                -1.383943e-01 1 1  ON 41
eH2_2                -9.198377e-02 1 1  ON 42
eH2_3                -3.793344e-02 1 1  ON 43
eH2_4                 9.690900e-03 1 1  ON 44
eH2_5                 4.286513e-02 1 1  ON 45
eH2_6                 9.887253e-02 1 1  ON 46
eH2_7                 1.502626e-01 1 1  ON 47
eH2_8                 1.763177e-01 1 1  ON 48
eH2_9                 4.573296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6648e+01 secs
  Total Execution time = 2.3180e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
